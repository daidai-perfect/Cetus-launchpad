import{a as Te,r as x,s as jt,m as p,A as le,b as st,e as Re,l as kt,o as A,f as D,h as t,i as E,q as St,I as Ve,M as At,p as Ye,k as Qe,u as ee,x as q,j as ve,w as re,P as $t,N as wt,G as ae,F as it,E as at,B as Ke,c as he,$ as Ft,z as xt,y as _t,fg as Ut,L as Dt,fi as Et,D as Tt,Y as zt,C as Wt,O as Xt}from"./entry.92a44973.js";/* empty css              */import{u as Ct}from"./useCurrentPosition.4f9ab7ac.js";import{u as Ze}from"./pool.8bdf5f5c.js";import{u as Ht}from"./token.315c02f4.js";import{u as lt,b as pe,C as Nt,o as ft,T as pt,n as Vt,m as Gt}from"./index.67028433.js";import{c as de,g as Jt,n as Yt,d as Be,o as Qt,b as Ge,a as ie,h as Pe,p as Je,i as ct}from"./common.99f6d7f1.js";import{a as gt,u as qe,b as Ee,h as Kt,c as Zt}from"./index.10ebf49c.js";import{u as eo}from"./usePoolList.2fee8ab4.js";import{_ as to}from"./back.7f5aa24f.js";import{I as oo}from"./icon-slippage.2f45f17d.js";import{I as no}from"./icon-refresh.17387a9f.js";/* empty css              */import{s as nt,m as io,l as ao,b as so,a as lo}from"./transform.c672907f.js";import"./decimal.a2826370.js";import{D as J}from"./decimal.765d8738.js";import{l as uo,a as ro}from"./linearClosed.d07a7d12.js";import{C as Ie}from"./coin-img-warning.efeac0c8.js";import{N as qt,I as yt}from"./input-lock.601feb2c.js";import{P as Lt}from"./pos-current-price.cc091ebd.js";import{N as co}from"./sui-position-range.15ad534e.js";import{s as ht}from"./formatter.ba8e3cbb.js";import{u as vo}from"./useRate.0f0a39c1.js";import{u as mo}from"./useSDK.f5ab4705.js";import{S as Ot}from"./select-tab.c941830c.js";import{T as dt}from"./token-input-block.e8e3f592.js";/* empty css              */import{u as Bt}from"./notifi.f8ba976a.js";/* empty css              */import{i as Rt}from"./import-icon.de3e6c66.js";import{_ as fo}from"./apr-tips.ab5bf4f3.js";import{u as _o}from"./farms.57548994.js";import"./usePositionList.3c5b4cbe.js";import"./useToken.ab6b508c.js";import"./fetchFun.ff4aae28.js";import"./swap-setting.74ff8a65.js";/* empty css              */import"./icon-error_2x.c748b661.js";import"./coin-img.583f1db5.js";import"./lock.35e1d915.js";import"./index.d50865f3.js";import"./token-dropdown-select.fd86c71b.js";import"./useDebounceFunction.f060e7a2.js";import"./useWhale.2f03f19c.js";import"./icon_fee_2x.0ae0d6d3.js";import"./icon_rewards_2x.35ce3e8a.js";const po=Te({components:{IconSlippage:oo,IconRefresh:no},props:{poolInfo:{type:Object,default:()=>({})}},setup(e,j){const h=x(!1),V=x(null),L=x(0),n=x(20),l=gt(),b=qe(),O=x(!1);jt(()=>{clearInterval(V.value)});const d=()=>{V.value=setInterval(()=>{var W;O.value||L.value<n.value&&(L.value+=1,L.value===n.value&&((W=e==null?void 0:e.poolInfo)!=null&&W.poolAddress&&l.updateCurrentPools(e.poolInfo.poolAddress,b.chainName),L.value=0))},1e3)},f=p(()=>b.slippage),a=()=>{j.emit("clearAll")},s=x(!1),c=()=>{L.value=0,s.value=!0,j.emit("clickRefresh"),setTimeout(()=>{s.value=!1},1e3)};le(()=>e.poolInfo,W=>{W&&!V.value&&d()},{immediate:!0});const k=st(),T=p(()=>b.chainName);return{clickRefresh:c,isShowSwapSetting:h,countdown:L,autoRefreshTime:n,slippage:f,clearAll:a,checkNullObj:de,router:k,loading:O,chainName:T,refresh:s}}});const ho={class:"new-position-title"},go={class:"left"},bo={class:"right"};function ko(e,j,h,V,L,n){const l=to,b=kt("IconSlippage"),O=kt("IconRefresh");return A(),D("div",ho,[t("div",go,[E(l)]),t("div",bo,[E(b),E(O,{refresh:e.refresh,onClickRefresh:e.clickRefresh},null,8,["refresh","onClickRefresh"])])])}const wo=Re(po,[["render",ko],["__scopeId","data-v-5e7ee742"]]);function Pt(e,j,h){const V=new J(10).pow(j-h);return new J(1.0001).pow(e).mul(V)}const yo=Te({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,coinA:{decimal:6},coinB:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,j){const h=x(1),V=x(""),L=x(""),n=p(()=>{var o,w,m;return a.sqrtPriceX64ToPrice((o=e.poolInfo)==null?void 0:o.current_sqrt_price,(w=e.poolInfo)==null?void 0:w.coinA.decimals,(m=e.poolInfo)==null?void 0:m.coinB.decimals).toString()}),l=p(()=>{let o=0;return e.direction?o=(Number(e.minPrice)/Number(n.value)-1)*100:o=(Number(e.minPrice)/Number(1/Number(n.value))-1)*100,o=o>0&&o<.1?.1:o,o=o<0&&o>-.1?-.1:o,o}),b=p(()=>{let o=0;return e.direction?o=(Number(e.maxPrice)/Number(n.value)-1)*100:o=(Number(e.maxPrice)/Number(1/Number(n.value))-1)*100,o=o>0&&o<.1?.1:o,o=o<0&&o>-.1?-.1:o,o}),O=qe(),d=p(()=>O),f=p(()=>d.value.chainName?Ee(d.value.chainName):{}),{TickMath:a,getNearestTickByTick:s}=f.value,c=()=>{const o=h.value/2;h.value=o,W(e.poolInfo,o)},k=()=>{const o=h.value*2;h.value=o,W(e.poolInfo,o)},T=(o=[])=>{let w=6;const m=Math.abs(Number(o[0])-Number(o[o.length-1]));return m>=6?w=0:m>=1?w=1:m>=.1?w=2:m>=.01?w=3:m>=.001?w=4:m>=1e-4?w=5:m>=1e-5?w=6:m>=1e-6?w=7:m>=1e-7&&(w=8),w},W=(o,w=1)=>{if(o&&o.coinA&&!e.chartLoading&&e.minPrice&&e.maxPrice){const m=Number(e.poolInfo.current_tick_index);let I=m+100*w,i=m-100*w,Q,B;if(e.maxPrice==="âˆž")B=f.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?B=a.priceToTickIndex(new J(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):B=a.priceToTickIndex(new J(1).div(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{B=443636}if(e.minPrice==="0")Q=f.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?Q=a.priceToTickIndex(new J(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):Q=a.priceToTickIndex(new J(1).div(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{Q=-443636}let H=0;if(e.currentPriceTab!=="full range"){if(m>=Q&&m<=B){const v=m-Q,te=B-m;H=Math.max(Math.abs(v),Math.abs(te))}else m<Q?H=Math.abs(B-m):H=Math.abs(m-Q);I=m+H+20*w,i=m-H-20*w}else{const v=(Math.abs(m)>5e3,2e4);I=m+v*w,i=m-v*w}i<-443636&&(i=-443636),I>443636&&(I=443636);const M=new J(o.poolLiquidity).div(Math.pow(10,8)).toString(),_=e.tickList,C=[],y=[];let U={};for(let v=0;v<_.length;v++){if(U=_[v],U.index<=m&&U.index>=i){if(C.length<1&&v!==0){const te=_[v-1];C.unshift({...te,index:i})}C.unshift(U)}else if(U.index>m&&U.index<=I&&(y.push(U),C.length<1&&v!==0)){const te=_[v-1];C.push({...te,index:i})}if(U.index>I){const te=_[v];if(y.push({...te,index:I}),C.length<1&&v!==0){const oe=_[v-1];C.push({...oe,index:i})}break}}let K="0";for(let v=C.length-1;v>=0;v--)K=new J(K).plus(new J(C[v].liquidityNet.toString()).div(Math.pow(10,8))).toString(),C[v].liquityAmount=K;let X=M;for(let v=0;v<y.length;v++)X=new J(X).plus(new J(y[v].liquidityNet.toString()).div(Math.pow(10,8))).toString(),y[v].liquityAmount=X;let S=[];const u=_&&_.length>0?{index:m,liquityAmount:Number(M)}:{index:m,liquityAmount:0};(C.length>0||y.length>0)&&(S=[...C.reverse(),u,...y],e.direction||(S=S.reverse()));const Z=[];_.forEach(v=>{Z.push({...v,liquidityGross:v.liquidityGross.toString(),liquidityNet:v.liquidityNet.toString()})}),R(S,i,I,Q,B,m)}};let F=x(!0);St(()=>{document.body.clientWidth<750?F.value=!1:F.value=!0,window.onresize=()=>{document.body.clientWidth<750?F.value=!1:F.value=!0,W(e.poolInfo,h.value)}});const R=(o,w,m,I,i,Q)=>{let B,H;e.direction?(B=e.before7dContractPriceLowest?a.priceToTickIndex(new J(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",H=e.before7dContractPriceHighest?a.priceToTickIndex(new J(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):""):(B=e.before7dContractPriceLowest?a.priceToTickIndex(new J(1).div(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",H=e.before7dContractPriceHighest?a.priceToTickIndex(new J(1).div(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"");const M={top:30,right:35,bottom:20,left:55};let _,C;F.value?(_=590-M.left-M.right,C=205-M.top-M.bottom):(_=340-M.left-M.right,C=205-M.top-M.bottom);const y=m-w,U=parseInt(String(y/4));let K=[w+U/4,w+U,w+2*U,m-U,m-U/4];const X=w,S=m,u=_/(S-X);e.currentPriceTab==="full range"&&(K=[w,w+2*U,m]);const Z=K.map(N=>e.direction?Pt(N,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString():new J(1).div(Pt(N,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)).toString());T(Z),nt("#chart").selectAll("*").remove();const v=nt("#chart").attr("width",_+M.left+M.right).attr("height",C+M.top+M.bottom).append("g").attr("transform",`translate(${M.left},${M.right})`),te=io(o,function(N){return Number(Math.abs(N.liquityAmount))})||0,oe=ao().range([0,C]).domain([te,0]);so().rangeRound([0,_]).padding(.1);const me=v.append("g").attr("id","barsBox").selectAll("rect").data(o).enter().append("rect");d.value.theme=="default"?me.attr("x",function(N,z){return z===0?0:e.direction?Math.abs(N.index-X)*u:Math.abs(S-N.index)*u}).attr("y",function(N,z){return e.direction?z===o.length-1?0:oe(N.liquityAmount):z===o.length-1?0:oe(o[z+1].liquityAmount)}).attr("width",function(N,z){return z===0&&o.length===1&&N.liquityAmount>0?_:(e.direction,z!==o.length-1?Math.abs(o[z+1].index-N.index)*u:0)}).attr("height",function(N,z){return z===0&&o.length===1&&N.liquityAmount>0?C:e.direction?z===o.length-1?0:C-oe(N.liquityAmount):z===o.length-1?0:C-oe(o[z+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):me.attr("x",function(N,z){return z===0?0:e.direction?Math.abs(N.index-X)*u:Math.abs(S-N.index)*u}).attr("y",function(N,z){return e.direction?z===o.length-1?0:oe(Math.abs(N.liquityAmount)):z===o.length-1?0:oe(Math.abs(o[z+1].liquityAmount))}).attr("width",function(N,z){return z===0&&o.length===1&&N.liquityAmount>0?_:(e.direction,z!==o.length-1?Math.abs(o[z+1].index-N.index)*u:0)}).attr("height",function(N,z){if(z===0&&o.length===1&&N.liquityAmount>0)return C;if(e.direction)return z===o.length-1?0:Number(N.liquityAmount)?C-oe(Math.abs(N.liquityAmount)):0;{if(z===o.length-1)return 0;const $e=C-oe(Math.abs(o[z+1].liquityAmount));return Number(o[z+1].liquityAmount)?$e:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const se=v.append("g");se.append("line").attr("x1",0).attr("y1",155).attr("x2",_).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),se.append("g");let Se=0;e.direction?Se=Math.abs(Q-X)*u:Se=Math.abs(Q-S)*u,(d.value.theme=="default"?v.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):v.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+Se+", 0)"),nt("#triangle").attr("width",8).attr("height",4);let Le=[[0,0],[4,4],[8,0]],be=uo().x(function(N){return N[0]}).y(function(N){return N[1]}).curve(ro);const Xe=Se-4;v.append("path").attr("d",be(Le)).style("fill",d.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+Xe+", 0)");let fe,ke,Ce,Ae;e.direction?(fe=I<X?-100:parseInt(String(Math.abs(I-X)*u)),ke=i<X?-100:parseInt(String(Math.abs(i-X)*u)),Ce=B<X?-100:Math.abs(B-X)*u,Ae=H<X?-100:Math.abs(H-X)*u):(ke=I<X?-100:Math.abs(S-I)*u,fe=i<X?-100:Math.abs(S-i)*u,Ae=B<X?-100:Math.abs(S-B)*u,Ce=H<X?-100:Math.abs(S-H)*u),e.minPrice==="0"&&(fe=0),e.maxPrice==="âˆž"&&(ke=_),F.value?V.value=_-fe+60+"px":V.value=_-fe+52+"px",L.value=ke+74+"px",B&&Ce<_&&v.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ce+", 0)"),H&&Ae<_&&v.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ae+", 0)");const Me=lo().extent([[0,0],[_,C]]).handleSize(30).on("end",He);v.append("g").attr("class","brush").call(Me).call(Me.move,[fe,ke]);function He(N){if(!N.sourceEvent||!N.selection)return;F.value?V.value=_-N.selection[0]+60+"px":V.value=_-N.selection[0]+52+"px",L.value=N.selection[1]+74+"px";let z,$e,g=0,$=0;e.direction?(g=s(parseInt(String(N.selection[0]/u+X)),Number(e.poolInfo.tickSpacing)),z=a.tickIndexToPrice(g,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),$=s(parseInt(String(N.selection[1]/u+X)),Number(e.poolInfo.tickSpacing)),$e=a.tickIndexToPrice($,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()):($=s(S-N.selection[0]/u,Number(e.poolInfo.tickSpacing)),z=1/a.tickIndexToPrice($,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),g=s(S-N.selection[1]/u,Number(e.poolInfo.tickSpacing)),$e=1/a.tickIndexToPrice(g,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()),j.emit("onChangeMinPrice",String(Be(String(z),6))),j.emit("onChangeMaxPrice",String(Be(String($e),6)))}d.value.theme=="default"?nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):nt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};x(""),le(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([o,w,m,I,i])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1125 ~ dataProcessing ~ poolInfo:",o),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ tickList:",i),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ currentPriceTab:",I),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ maxPrice:",m),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ minPrice:",w),o&&w&&m&&I&&i&&i.length>0&&(I!=="Custom"&&console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1131 ~ dataProcessing ~ dataProcessing:"),W(o,h.value))},{immediate:!0});const r=x(!0);return le(()=>e.chartLoading,(o,w)=>{o!==w&&(r.value=o)},{immediate:!0,deep:!0}),{store:d,loading:r,zoomOut:c,zoomIn:k,rangeSizeLower:l,rangeSizeUpper:b,rangeSizeLowerPosition:V,rangeSizeUpperPosition:L,decimalFormat:Jt,numberformat:Yt}}});const Po=e=>(Ye("data-v-70d71659"),e=e(),Qe(),e),Io={class:"chart-box"},So={class:"chart"},Ao=Po(()=>t("svg",{id:"chart"},null,-1)),$o=[Ao];function xo(e,j,h,V,L,n){return A(),D("div",Io,[Ve(t("div",So,$o,512),[[At,!e.loading]])])}const To=Re(yo,[["render",xo],["__scopeId","data-v-70d71659"]]),ut=e=>(Ye("data-v-7b2bc3df"),e=e(),Qe(),e),Co={class:"new-position-info"},No={class:"pool-info"},qo={class:"info"},Lo={class:"coin-logo"},Oo={class:"name-fee"},Bo={class:"name-copy"},Ro=["href"],Mo=ut(()=>t("use",{"xlink:href":"#icon-icon_copy2"},null,-1)),jo=[Mo],Fo={class:"pool-fee"},Uo=ut(()=>t("span",null,"Fee tier",-1)),Do={class:"price-info"},Eo={class:"price-and-chart"},zo={class:"top"},Wo={class:"position-range position-range-warp"},Xo=ut(()=>t("span",{class:"position-range-title"}," Position Range ",-1)),Ho={class:"bottom"},Vo=ut(()=>t("div",{class:"chat-mask"},null,-1)),Go={class:"lever"},Jo={class:"lever-title"},Yo=ut(()=>t("div",{class:"tit"},[t("span",null," Leverage "),t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon_tips"})])],-1)),Qo={class:"lever-text"},Ko=Te({__name:"sui-position-info",setup(e){const j=Ze(),h=p(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:643 ~ currentPositionInfo ~ suiPoolStore.currentPositionInfo:",j.currentPositionInfo),j.currentPositionInfo)),V=p(()=>j.poolsObj),L=qe(),n=p(()=>L.currentExplorer);x(!0);const l=(a,s)=>a!=="0"&&s!=="âˆž"?Ge(1/(1-Number((a/s)**.25)),2)+"x":"1x",b=p(()=>{var a,s,c;return(a=h==null?void 0:h.value)!=null&&a.minPrice&&h.value.maxPrice?l((s=h==null?void 0:h.value)==null?void 0:s.minPrice,(c=h==null?void 0:h.value)==null?void 0:c.maxPrice):"--"}),O=Ee("Sui"),d=x([]),f=async a=>{const{list:s}=await O.getTicks(a),c=s?O.getTickDataFromUrlData(s):[];console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:593 ~ resetTickList ~ list:",c),d.value=c};return le(()=>[h.value,V.value],([a,s])=>{a&&!de(a)&&s&&!de(s)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:417 ~ poolsObj:",s),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:418 ~ newValue:",a),f(s[a.pool]))},{immediate:!0}),(a,s)=>{var k,T,W,F,R,r,o;const c=$t;return A(),D("div",Co,[t("div",No,[t("div",qo,[t("div",Lo,[E(Ie,{"token-info":(k=h.value)==null?void 0:k.coinA},null,8,["token-info"]),E(Ie,{"token-info":(T=h.value)==null?void 0:T.coinB},null,8,["token-info"])]),t("div",Oo,[t("div",Bo,[t("a",{class:"position-name",href:ee(Qt)(n.value,"nftAddress",(W=h.value)==null?void 0:W.nftHash),target:"_blank"},q((F=h.value)==null?void 0:F.positionName),9,Ro),(A(),D("svg",{class:"copy-icon","aria-hidden":"true",onClick:s[0]||(s[0]=w=>{var m;return ee(L).copy((m=h.value)==null?void 0:m.nftHash)})},jo))]),t("div",Fo,[Uo,ve(" "+q((R=h.value)==null?void 0:R.feeRate),1)])])]),E(qt,{"position-info":h.value},null,8,["position-info"])]),t("div",Do,[t("div",Eo,[t("div",zo,[E(Lt,{"pool-info":h.value},null,8,["pool-info"]),t("div",Wo,[Xo,E(co,{"position-info":h.value},null,8,["position-info"])])]),t("div",Ho,[E(To,{"pool-info":h.value,"tick-list":d.value,"min-price":(r=h.value)==null?void 0:r.minPrice,"max-price":(o=h.value)==null?void 0:o.maxPrice,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),Vo,t("div",Go,[t("div",Jo,[E(c,{"overlay-class-name":"lever-tooltip ant-tooltip-text-color"},{title:re(()=>[ve("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:re(()=>[Yo]),_:1})]),t("div",Qo,q(b.value),1)])])])])])}}});const Zo=Re(Ko,[["__scopeId","data-v-7b2bc3df"]]),et=e=>(Ye("data-v-4e4aa12e"),e=e(),Qe(),e),en={class:"liquidity-card-box"},tn={class:"liquidity-title"},on={class:"liquidity-usd"},nn=et(()=>t("span",null,"Liquidity",-1)),an={class:"liquidity-ratio"},sn={class:"coin-ratio"},ln={class:"coin-a-ratio"},un={class:"coin-b-ratio"},rn={class:"ratio-progress"},cn={class:"base-quote-num"},dn={class:"base-coin-num"},vn=et(()=>t("span",null,"Base",-1)),mn={class:"token-amount"},fn={key:0,class:"after"},_n={class:"quote-coin-num"},pn=et(()=>t("span",null,"Quote",-1)),hn={class:"token-amount"},gn={key:0,class:"after"},bn={class:"pending-yield"},kn={class:"left"},wn=et(()=>t("div",{class:"pending-yield-title"},"Pending Yield",-1)),yn={key:0,class:"after"},Pn={class:"right"},In={class:"fees-rewards"},Sn={class:"fees-rewards-item"},An=et(()=>t("span",null,"Fees",-1)),$n={class:"token-amount"},xn={key:0,class:"after"},Tn=et(()=>t("span",null,"Mining Rewards",-1)),Cn={class:"token-amount"},Nn={key:0,class:"after"},qn=Te({__name:"sui-position-liquidity",setup(e){const j=qe(),h=lt(),V=p(()=>h),L=Ze(),n=p(()=>L.currentPositionInfo),l=p(()=>{var I;return L.positionPendingFees[(I=n==null?void 0:n.value)==null?void 0:I.positionId]}),b=p(()=>{var I;return L.positionPendingRewards[(I=n==null?void 0:n.value)==null?void 0:I.positionId]}),O=p(()=>{var i,Q,B,H;let I=Pe(0);return(i=l==null?void 0:l.value)!=null&&i.feesAmountUSD&&(I=I.add((Q=l.value)==null?void 0:Q.feesAmountUSD)),(B=b==null?void 0:b.value)!=null&&B.rewardsAmount&&(I=I.add((H=b.value)==null?void 0:H.rewardsAmount)),I.toNumber()}),d=x(!1),{setIsShowSuccess:f,setIsShowRejected:a,setIsShowWaiting:s,setTransactionDesc:c,setTransactionTxid:k}=j,T=Ee("Sui"),{getCurrentPosition:W}=Ct(),F=async()=>{var i,Q;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1233 ~ claimFeesAndRewards ~ currentPositionInfo.value:",n.value),d.value=!0;let I={coinTypeA:n.value.defaultCoinaAddress,coinTypeB:n.value.defaultCoinbAddress,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:n.value.pool,pos_index:n.value.positionIndex,rewarder_nums:b.value.rewarderAmountOwed.length,collect_fee:!0};I.coinTypeC=b.value.rewarderAmountOwed[0]?b.value.rewarderAmountOwed[0].tokenInfo.address:"",I.coinTypeD=b.value.rewarderAmountOwed[1]?b.value.rewarderAmountOwed[1].tokenInfo.address:"",I.coinTypeE=b.value.rewarderAmountOwed[2]?b.value.rewarderAmountOwed[2].tokenInfo.address:"",s(!0),c();try{let B;I.pos_index=n.value.pos_object_id;const H=await T.getCollectRewarderTransactionPayload(I,n.value),M=await T.signAndExecuteTransactionBlock(V.value.currentWallet,H.txb,H.payloadParams);if(B=T.handleTx(M),B&&B.hash){k(B.hash),s(!1),f(!0);const _={title:"Claim",desc:"",hash:B.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};_.res=B.res,T.showTransitionPending(_),await T.watchTransaction(_)&&(W((i=n==null?void 0:n.value)==null?void 0:i.positionId,(Q=n==null?void 0:n.value)==null?void 0:Q.positionSource),setTimeout(()=>{T.getAccount(V.value.address),d.value=!1},3e3))}else console.log("0310###toClaimRewards###else###"),s(!1),a(!0),d.value=!1}catch(B){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1225 ~ claimFeesAndRewards ~ error:",B),s(!1),a(!0),d.value=!1}},R=p(()=>L.positionDetailCurrentTab),r=p(()=>L.positionActionFromCoinAmount),o=p(()=>L.positionActionToCoinAmount),w=p(()=>{if(R.value=="increase")return r.value>0?Pe(n.value.coinaAmount).add(Pe(r.value)).toString():"";if(r.value>0){const I=Pe(n.value.coinaAmount).minus(Pe(r.value)).toString();return I<0?"0":I}else return""}),m=p(()=>{if(R.value=="increase")return o.value>0?Pe(n.value.coinbAmount).add(Pe(o.value)).toString():"";if(o.value>0){const I=Pe(n.value.coinbAmount).minus(Pe(o.value)).toString();return I<0?"0":I}else return""});return(I,i)=>{var B,H,M,_,C,y,U,K,X,S,u,Z,v,te,oe,ge,me;const Q=Ke;return A(),D("div",en,[t("div",tn,[t("div",on,[nn,t("div",null,"$"+q((B=n.value)==null?void 0:B.positionAmountUSD),1)]),t("div",an,[t("div",sn,[t("div",ln,[E(Ie,{"token-info":(H=n.value)==null?void 0:H.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,q((_=(M=n.value)==null?void 0:M.coinA)==null?void 0:_.symbol),1),t("span",null,q((C=n.value)==null?void 0:C.fromPercent)+"%",1)]),t("div",un,[E(Ie,{"token-info":(y=n.value)==null?void 0:y.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,q((K=(U=n.value)==null?void 0:U.coinB)==null?void 0:K.symbol),1),t("span",null,q((X=n.value)==null?void 0:X.toPercent)+"%",1)])]),t("div",rn,[t("div",{class:"from-percent",style:wt({width:((S=n.value)==null?void 0:S.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:wt({width:((u=n.value)==null?void 0:u.toPercent)+"%"})},null,4)])])]),t("div",cn,[t("div",dn,[vn,t("div",mn,[E(Ie,{"token-info":(Z=n.value)==null?void 0:Z.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,q(ee(ie)(ee(Be)((v=n.value)==null?void 0:v.coinaAmount))),1)]),w.value?(A(),D("div",fn,q(ee(ie)(w.value))+" after ",1)):ae("",!0)]),t("div",_n,[pn,t("div",hn,[E(Ie,{"token-info":(te=n.value)==null?void 0:te.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,q(ee(ie)(ee(Be)((oe=n.value)==null?void 0:oe.coinbAmount))),1)]),m.value?(A(),D("div",gn,q(ee(ie)(m.value))+" after ",1)):ae("",!0)])]),t("div",bn,[t("div",kn,[wn,t("div",null,[ve(" $"+q(O.value>0&&O.value<.01?"<0.01":ee(ie)(O.value,2))+" ",1),O.value>0?(A(),D("span",yn,"$0 after")):ae("",!0)])]),t("div",Pn,[E(Q,{class:"claim-all",loading:d.value,disabled:d.value||O.value==0,onClick:F},{default:re(()=>[ve("Claim")]),_:1},8,["loading","disabled"])])]),t("div",In,[t("div",Sn,[(A(!0),D(it,null,at((ge=l.value)==null?void 0:ge.feesList,se=>(A(),D("div",{key:se},[An,t("div",$n,[E(Ie,{"token-info":se.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,q(ee(ht)(se.amount,"",se.tokenInfo.decimals)),1)]),(w.value||m.value)&&!ee(de)(n.value)?(A(),D("div",xn," 0 after ")):ae("",!0)]))),128)),(A(!0),D(it,null,at((me=b.value)==null?void 0:me.rewarderAmountOwed,se=>(A(),D("div",{key:se},[Tn,t("div",Cn,[E(Ie,{"token-info":se.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,q(ee(ht)(se.amount,"",se.tokenInfo.decimals)),1)]),(w.value||m.value)&&!ee(de)(n.value)?(A(),D("div",Nn," 0 after ")):ae("",!0)]))),128))])])])}}});const It=Re(qn,[["__scopeId","data-v-4e4aa12e"]]);function Ln(){const e=Ze();p(()=>e.currentPositionInfo);const j=qe(),h=p(()=>j.slippage),{getTransactionBlock:V}=Kt("Sui"),L=mo(),n=(b,O,d,f,a,s,c=0,k=0)=>{const T=new pe(b),W=!0,{coinAmountA:F,coinAmountB:R}=Nt.estLiquidityAndcoinAmountFromOneAmounts(d,f,T,O,W,ft(h.value).div(100).toNumber(),new pe(a)),r=s?k:c,o=s?c:k;return{tokenMaxA:s?Je(R.toString(),o):Je(F.toString(),r),tokenMaxB:s?Je(F.toString(),r):Je(R.toString(),o),tokenMaxAOrigin:s?R.toString():F.toString(),tokenMaxBorigin:s?F.toString():R.toString()}};return{preAdd:n,getAddLiquidityTransactionPayload:async(b,O,d,f,a,s,c="",k="")=>{const T=await L.clmmSdk.Pool.getPool(a),{coinTypeA:W,coinTypeB:F}=T;console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:69 ~ getAddLiquidityTransactionPayload ~ contratcPoolInfo:",T);const R=pt.sqrtPriceX64ToTickIndex(new pe(T.current_sqrt_price));let r,o;if(R>=d&&R<=f){const{tokenMaxAOrigin:B,tokenMaxBorigin:H}=n(b,O,d,f,T.current_sqrt_price,s);console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:91 ~ getAddLiquidityTransactionPayload ~ tokenMaxBorigin:",H),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:91 ~ getAddLiquidityTransactionPayload ~ tokenMaxAOrigin:",B),r=O?b:s?H:B,o=O?s?B:H:b}else R>f?(r=0,o=b):R<d&&(r=b,o=0);let w=[];if(c){const{rewarder_infos:B}=T;w=B.map(H=>H.coinAddress)}const m={coinTypeA:W,coinTypeB:F,amount_a:r,amount_b:o,pool_id:a,fix_amount_a:O,slippage:ft(h.value).div(100).toNumber(),is_open:!c,tick_lower:d,tick_upper:f,collect_fee:!!c,rewarder_coin_types:w,pos_id:k};console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:98 ~ getAddLiquidityTransactionPayload ~ parameter:",m);const I={slippage:ft(h.value).div(100).toNumber(),curSqrtPrice:new pe(T.current_sqrt_price)},i=await L.clmmSdk.Position.createAddLiquidityFixTokenPayload(m,I),Q={action:c?"IncreaseLiquidity":"",txbParams:{parameter:m,gasEstimateArg:I}};return{txb:V(i),payloadParams:Q}}}}const vt=e=>(Ye("data-v-bb768f60"),e=e(),Qe(),e),On=vt(()=>t("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Bn={class:"modal-content"},Rn={class:"pool-info"},Mn={class:"left"},jn={class:"pool-name"},Fn={class:"right"},Un={class:"coin-info"},Dn={class:"from-coin-info"},En={class:"left"},zn={class:"coin-amount"},Wn={class:"coin-symbol"},Xn={class:"right"},Hn={class:"to-coin-info"},Vn={class:"left"},Gn={class:"coin-amount"},Jn={class:"coin-symbol"},Yn={class:"right"},Qn={class:"select-range"},Kn=vt(()=>t("div",{class:"select-range-title"},"Selected Range",-1)),Zn={class:"price-conent"},ei={class:"current-price"},ti={class:"price-range-block-content"},oi={class:"price-range-block"},ni={class:"price-item"},ii={class:"title"},ai={class:"price"},si={key:0,class:"text"},li={key:1,class:"text"},ui={class:"price-item"},ri={class:"title"},ci={class:"price"},di={key:0,class:"text"},vi={key:1,class:"text"},mi={class:"modal-block"},fi=vt(()=>t("div",{class:"label"},"Deposit Ratio",-1)),_i={class:"text"},pi={class:"modal-block"},hi=vt(()=>t("div",{class:"label"},"Total Amount",-1)),gi={class:"text"},bi=Te({__name:"increase-liquidity-modal",props:{fromCoinAmount:{type:String,default:"1245566.008946"},toCoinAmount:{type:String,default:"11111111111"},fixedFromCoin:{type:Boolean,default:!0},showFromCoinLock:{type:Boolean,default:!1},showToCoinLock:{type:Boolean,default:!1},positionTotalAmount:{type:Number,default:0},currentPositionInfo:{type:Object,default:()=>({})},totalAmount:{type:String,default:""}},emits:["toAdd"],setup(e,{emit:j}){const h=j,V=x(!0),L=()=>{h("toAdd")};return(n,l)=>{const b=Ke;return A(),he(ee(Ft),{width:"440px",visible:!0,footer:null,title:"Increase",onCancel:l[0]||(l[0]=O=>n.$emit("onClose"))},{closeIcon:re(()=>[On]),default:re(()=>{var O,d,f,a,s,c;return[t("div",Bn,[t("div",Rn,[t("div",Mn,[E(Ie,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),E(Ie,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),t("div",jn,[t("span",null,q(e.currentPositionInfo.coinA.symbol)+"Â -Â ",1),t("span",null,q(e.currentPositionInfo.coinB.symbol),1)])]),t("div",Fn,[ve(" Fee tier "),t("span",null,q(e.currentPositionInfo.feeRate),1)])]),t("div",Un,[t("div",Dn,[t("div",En,[t("div",zn,q(ee(ie)(e.fromCoinAmount)||0),1),t("div",Wn,q(e.currentPositionInfo.coinA.symbol),1)]),t("div",Xn,[E(Ie,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])]),t("div",Hn,[t("div",Vn,[t("div",Gn,q(ee(ie)(e.toCoinAmount)||0),1),t("div",Jn,q(e.currentPositionInfo.coinB.symbol),1)]),t("div",Yn,[E(Ie,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])])]),t("div",Qn,[Kn,E(qt,{"position-info":e.currentPositionInfo},null,8,["position-info"])]),t("div",Zn,[t("div",ei,[E(Lt,{"pool-info":e.currentPositionInfo},null,8,["pool-info"])]),t("div",ti,[t("div",oi,[t("div",ni,[t("div",ii,q(n.$t("common.minPrice")),1),t("p",ai,q(e.currentPositionInfo.minPrice),1),V.value?(A(),D("div",si,q(e.currentPositionInfo.coinB.symbol)+" per "+q(e.currentPositionInfo.coinA.symbol),1)):(A(),D("div",li,q(e.currentPositionInfo.coinA.symbol)+" per "+q(e.currentPositionInfo.coinB.symbol),1))]),t("div",ui,[t("div",ri,q(n.$t("common.maxPrice")),1),t("p",ci,q(e.currentPositionInfo.maxPrice),1),V.value?(A(),D("div",di,q(e.currentPositionInfo.coinB.symbol)+" per "+q(e.currentPositionInfo.coinA.symbol),1)):(A(),D("div",vi,q(e.currentPositionInfo.coinA.symbol)+" per "+q(e.currentPositionInfo.coinB.symbol),1))])])])]),t("div",mi,[fi,t("div",_i,q((O=e.currentPositionInfo)==null?void 0:O.fromPercent)+"% "+q((f=(d=e.currentPositionInfo)==null?void 0:d.coinA)==null?void 0:f.symbol)+" / "+q((a=e.currentPositionInfo)==null?void 0:a.toPercent)+"% "+q((c=(s=e.currentPositionInfo)==null?void 0:s.coinB)==null?void 0:c.symbol),1)]),t("div",pi,[hi,t("div",gi,q(e.totalAmount),1)]),E(b,{class:"big-btn",onClick:L},{default:re(()=>[ve(q("Increase Liquidity"))]),_:1})])]}),_:1})}}});const ki=Re(bi,[["__scopeId","data-v-bb768f60"]]),wi={class:"new-position-asset-add-box"},yi={class:"add-or-remove"},Pi={class:"tab-box"},Ii={key:0,class:"from-lock"},Si={key:1,class:"to-lock"},Ai={key:2,class:"new-sui-exchange to-add-logo"},$i=t("div",{class:"exchange-new"},[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_add1"})])],-1),xi=[$i],Ti={class:"amount-btn"},Ci={key:2,class:"total-amount"},Ni=t("span",null,"Total Amount",-1),qi=Te({__name:"sui-position-asset-add",setup(e){const j=x(!0),h=x(!1),V=[{name:"Increase",logo:""},{name:"Remove",logo:""}],{t:L}=xt(),{getTokenRatePrice:n}=vo(),l=lt(),b=p(()=>l),O=Ze(),d=p(()=>O.currentPositionInfo),f=qe();p(()=>f.slippage);const a=x(),s=x(),c=x(),k=x(),T=x(!0),W=p(()=>b.value.assets&&a.value&&b.value.assets[a.value.address]?Je(b.value.assets[a.value.address].balance,a.value.decimals):0),F=p(()=>b.value.assets&&s.value&&b.value.assets[s.value.address]?Je(b.value.assets[s.value.address].balance,s.value.decimals):0),R=p(()=>d.value.isResever),r=x(),o=x(),{preAdd:w,getAddLiquidityTransactionPayload:m}=Ln(),I=()=>{var be;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:1021 ~ updateAmounts ~ updateAmounts:"),!d.value||!c.value&&!k.value)return;const S=T.value?c.value:k.value,u=T.value?a.value.decimals:s.value.decimals,Z=Pe(S).mul(J.pow(10,u)).toString(),v=(be=d.value)!=null&&be.isReverse?!T.value:T.value,te=d.value.tickLowerIndex,oe=d.value.tickUpperIndex,ge=d.value.current_sqrt_price,me=a.value.decimals,se=s.value.decimals,Se=d.value.isReverse,{tokenMaxA:We,tokenMaxB:Le}=w(Z,v,te,oe,ge,Se,me,se);console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:859 ~ updateAmounts ~ tokenMaxA, tokenMaxB:",We,Le),T.value?k.value=Le:c.value=We,O.setPositionActionAmount({fromCoinAmount:c,toCoinAmount:k})};le(()=>d.value,S=>{if(S&&!de(S)){a.value=S.coinA,s.value=S.coinB,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:872 ~ newVal:",S);const{tickLowerIndex:u,tickUpperIndex:Z,current_tick_index:v,maxPrice:te}=S;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:882 ~ currentTick,tickLower,tickUpper:",v,u,Z),te=="âˆž"||v>=u&&v<Z?(r.value=!1,o.value=!1):v>=Z?(c.value="",r.value=!0,o.value=!1):v<u?(r.value=!1,o.value=!0,k.value=""):(r.value=!0,c.value="",o.value=!0,k.value=""),I()}},{immediate:!0}),le(c,(S,u)=>{S&&I(),S==""&&(k.value="")}),le(k,(S,u)=>{S&&I(),S==""&&(c.value="")});const i=p(()=>{var Z,v,te,oe;const S=n((Z=a==null?void 0:a.value)==null?void 0:Z.address,c==null?void 0:c.value,(v=a==null?void 0:a.value)==null?void 0:v.decimals),u=n((te=s==null?void 0:s.value)==null?void 0:te.address,k==null?void 0:k.value,(oe=s==null?void 0:s.value)==null?void 0:oe.decimals);if(S!=="--"&&u!=="--"){const ge=Pe(S).add(u);return ht(ge.toString())}return"--"}),Q=p(()=>{const S=Number(c.value)>Number(W.value),u=Number(k.value)>Number(F.value);return!c.value&&!k.value?L("button.enterAmount"):S?L("button.insufficientBalance",{name:a.value.symbol}):u?L("button.insufficientBalance",{name:s.value.symbol}):L("newAdd.addMore")}),B=p(()=>{const S=Number(c.value)>Number(W.value),u=Number(k.value)>Number(F.value);return!!(!c.value&&!k.value||S||u)}),H=x(!1),M=x(!1),{setTransactionTxid:_,setTransactionDesc:C,setIsShowWaiting:y,setIsShowRejected:U}=f,K=Ee("Sui"),X=async()=>{var be,Xe,fe,ke,Ce,Ae,Me,He,N,z,$e,g,$;H.value=!1,M.value=!0,_("");const S=r.value?"":`${c.value} ${(be=a.value)==null?void 0:be.symbol}`,u=o.value?"":`${k.value} ${(Xe=s.value)==null?void 0:Xe.symbol}`;C(L("tips.increaseLiquiditySuccess",{from:R.value?u:S,and:!r.value&&!o.value?"and":"",to:R.value?S:u})),y(!0);const Z=T.value?c.value:k.value,v=T.value?a.value.decimals:s.value.decimals,te=Pe(Z).mul(J.pow(10,v)).toString(),oe=(fe=d.value)!=null&&fe.isReverse?!T.value:T.value,ge=d.value.tickLowerIndex,me=d.value.tickUpperIndex,se=d.value.isReverse,Se=d.value.pool,We=d.value.positionIndex,Le=d.value.positionId;try{const P=await m(te,oe,ge,me,Se,se,We,Le);let Y;const G=await K.signAndExecuteTransactionBlock(b.value.currentWallet,P==null?void 0:P.txb,P==null?void 0:P.payloadParams);if(Y=K.handleTx(G),console.log("toAdd###tx###",Y),Y&&Y.hash){_(Y.hash),y(!1),setIsShowSuccess(!0);const ne={title:"Supplied",desc:L("tips.addLiquiditySuccessText",{from:r.value?"":`${R.value?k.value:c.value} ${R.value?(Ce=s==null?void 0:s.value)==null?void 0:Ce.symbol:(ke=a.value)==null?void 0:ke.symbol}`,and:!r.value&&!o.value?"and":"",to:o.value?"":`${R.value?c.value:k.value} ${R.value?(Me=a==null?void 0:a.value)==null?void 0:Me.symbol:(Ae=s.value)==null?void 0:Ae.symbol}`}),hash:Y.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:R.value?`${(N=s.value)==null?void 0:N.address}`:`${(He=a.value)==null?void 0:He.address}`,numa:R.value?`- ${k.value}`:`- ${c.value}`,logoa:R.value?pools.value.tokensObj&&s.value&&s.value.address&&pools.value.tokensObj[s.value.address]&&pools.value.tokensObj[s.value.address].logoURI:pools.value.tokensObj&&a.value&&a.value.address&&pools.value.tokensObj[a.value.address]&&pools.value.tokensObj[a.value.address].logoURI,tokenb:R.value?`${($e=a.value)==null?void 0:$e.address}`:`${(z=s.value)==null?void 0:z.address}`,numb:R.value?`- ${c.value}`:`- ${k.value}`,logob:R.value?pools.value.tokensObj&&a.value&&a.value.address&&pools.value.tokensObj[a.value.address]&&pools.value.tokensObj[a.value.address].logoURI:pools.value.tokensObj&&s.value&&s.value.address&&pools.value.tokensObj[s.value.address]&&pools.value.tokensObj[s.value.address].logoURI},text:`Deopsit ${r.value?"":`${c.value} ${(g=a.value)==null?void 0:g.symbol}`} ${!r.value&&!o.value?"and":""} ${o.value?"":`${k.value} ${($=s.value)==null?void 0:$.symbol}`}`};chainName.value!=="Aptos"&&(ne.res=Y.res),K.value.showTransitionPending(ne),await K.value.watchTransaction(ne)&&setTimeout(()=>{ctx.emit("getDetails"),K.value.getAccount(b.value.address)},1e3),setPositiomNum()}else y(!1),U(!0);c.value="",k.value="",M.value=!1}catch(P){c.value="",k.value="",console.log("addError###",P),M.value=!1,y(!1),U(!0)}};return(S,u)=>{const Z=Ke;return A(),D("div",wi,[t("div",yi,[t("div",Pi,[E(ee(Ot),{"tab-list":V,"current-tab":"Increase",onOnClick:u[0]||(u[0]=v=>{v.name=="Remove"&&ee(O).setPositionDetailCurrentTab("remove")})})]),t("div",{class:_t(["card-container",[j.value?"input-block-add-top":"",h.value?"input-block-add-bottom":""]])},[E(dt,{modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=v=>c.value=v),"input-value":c.value,"token-info":a.value||null,"has-arrow":!1,onOnInput:u[2]||(u[2]=v=>{c.value=v}),onOnFocus:u[3]||(u[3]=()=>{T.value=!0,j.value=!0,h.value=!1})},null,8,["modelValue","input-value","token-info"]),E(dt,{modelValue:k.value,"onUpdate:modelValue":u[4]||(u[4]=v=>k.value=v),"input-value":k.value,"token-info":s.value||null,"has-arrow":!1,onOnInput:u[5]||(u[5]=v=>{k.value=v}),onOnFocus:u[6]||(u[6]=()=>{T.value=!1,j.value=!1,h.value=!0})},null,8,["modelValue","input-value","token-info"]),r.value?(A(),D("div",Ii,[E(yt,{"from-coin":a.value,"to-coin":s.value},null,8,["from-coin","to-coin"])])):ae("",!0),o.value?(A(),D("div",Si,[E(yt,{"from-coin":a.value,"to-coin":s.value},null,8,["from-coin","to-coin"])])):ae("",!0),!r.value&&!o.value?(A(),D("div",Ai,xi)):ae("",!0)],2)]),t("div",Ti,[b.value.connected?(A(),he(Z,{key:0,class:"big-btn liquidity-btn",disabled:B.value,loading:S.actionLoading,onClick:u[7]||(u[7]=v=>H.value=!0)},{default:re(()=>[t("span",null,q(Q.value),1)]),_:1},8,["disabled","loading"])):(A(),he(Z,{key:1,class:"big-btn",onClick:u[8]||(u[8]=v=>b.value.connected?H.value=!0:b.value.setIsShowWalletModal(!0))},{default:re(()=>[t("span",null,q(S.$t("button.connectWallet")),1)]),_:1})),b.value.connected?(A(),D("div",Ci,[Ni,t("span",null,q(i.value),1)])):ae("",!0)]),H.value?(A(),he(ki,{key:0,"current-position-info":d.value,"show-from-coin-lock":r.value,"show-to-coin-lock":o.value,"from-coin-amount":c.value,"to-coin-amount":k.value,"total-amount":i.value,onOnClose:u[9]||(u[9]=v=>H.value=!1),onToAdd:X},null,8,["current-position-info","show-from-coin-lock","show-to-coin-lock","from-coin-amount","to-coin-amount","total-amount"])):ae("",!0)])}}});const Li={class:"new-position-asset-remove-box"},Oi={class:"add-or-remove"},Bi={class:"tab-box"},Ri={key:0,class:"assets-card-mask-from"},Mi={key:1,class:"assets-card-mask-to"},ji={class:"remove-ratio"},Fi=t("div",{class:"remove-ratio-title"},"Amount",-1),Ui={class:"remove-ratio-select"},Di={key:0,class:"ratio"},Ei={key:1,class:"ratio"},zi={class:"ratio-list"},Wi=["onClick"],Xi=Te({__name:"sui-position-asset-remove",setup(e){const j=x(!0),h=x(!1),V=[{name:"Increase",logo:""},{name:"Remove",logo:""}],L=Ze(),n=x(""),l=x(""),b=qe(),O=p(()=>b);p(()=>O.value.theme);const d=gt(),f=p(()=>d),a=x(!1),s=x(!1),c=x(!0),k=p(()=>O.value.chainName),T=p(()=>k.value?Ee(k.value):{}),W=lt(),F=p(()=>W),R=p(()=>O.value.slippage),r=x(),o=x(),w=p(()=>{var g,$;return($=(g=i.value)==null?void 0:g.poolInfo)==null?void 0:$.needReverse}),m=p(()=>{var g;return Be(i==null?void 0:i.value.amountA,(g=i==null?void 0:i.value.token_a)==null?void 0:g.decimals)}),I=p(()=>{var g;return Be(i==null?void 0:i.value.amountB,(g=i==null?void 0:i.value.token_b)==null?void 0:g.decimals)}),i=x({}),Q=x(!0),B=x({}),H=x(),M=x(),_=x(!0),C=()=>{var tt;if(_.value||!i.value||!n.value&&!l.value||Number(n.value)>Number(m.value)||Number(l.value)>Number(I.value))return;if(n.value==m.value&&l.value==I.value){y.value=100,K({value:1}),_.value=!0;return}const{TickMath:g,TickUtil:$}=T.value;let P=i.value.minPrice,Y=i.value.maxPrice.indexOf("+")>0?"âˆž":i.value.maxPrice,G=Number(i.value.tick_lower_index),ne=Number(i.value.tick_upper_index);const _e=Number(i.value.current_tick_index);let ce,we,je=Number(P).toString(),Fe=i.value.maxPrice.indexOf("+")>0||i.value.maxPrice==="âˆž"?"âˆž":Number(Y);if(je=="0"&&Fe=="âˆž"?(G=Number(i.value.tick_lower_index),ne=Number(i.value.tick_upper_index)):(ce=g.priceToSqrtPriceX64(new J(P),r.value.decimals,o.value.decimals),we=g.priceToSqrtPriceX64(new J(Y),r.value.decimals,o.value.decimals)),H.value=G,M.value=ne,Y!=="âˆž"&&G>=ne){a.value=!0,n.value="",s.value=!0,l.value="";return}if(Y=="âˆž"||_e>=G&&_e<ne){a.value=!1,s.value=!1;let ye;if(n.value||l.value){if(c.value){const Ne=new J(n.value).mul(Math.pow(10,r.value.decimals)).toString();ye=new pe(Ne)}else{const Ne=new J(l.value).mul(Math.pow(10,o.value.decimals)).toString();ye=new pe(Ne)}const{liquidityAmount:Oe,tokenMaxA:Ue,tokenMaxB:De,tokenMaxAOrigin:rt,tokenMaxBOrigin:ue}=T.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:o.value,lowerTick:G,upperTick:ne,coinAmount:ye,iscoinA:Q.value?c.value:!c.value,roundUp:k.value!="Sui",slippage:Number(R.value)/100,curSqrtPrice:new pe(i.value.current_sqrt_price)});B.value={liquidityAmount:Oe,tokenMaxA:Ue,tokenMaxB:De,tokenMaxAOrigin:rt,tokenMaxBOrigin:ue},Q.value?c.value?l.value=Number(De)>0?De:"":n.value=Number(Ue)>0?Ue:"":c.value?l.value=Ue:n.value=De}}else if(_e>=ne){if(n.value="",a.value=!0,s.value=!1,n.value||l.value){let ye;const Oe=new J(l.value).mul(Math.pow(10,(tt=o.value)==null?void 0:tt.decimals)).toString();ye=new pe(Oe),B.value={liquidityAmount:Vt(ce,we,ye),tokenMaxA:0,tokenMaxB:l.value}}}else if(_e<G){if(a.value=!1,s.value=!0,l.value="",n.value||l.value){let ye;const Oe=new J(n.value).mul(Math.pow(10,r.value.decimals)).toString();ye=new pe(Oe),B.value={liquidityAmount:Gt(ce,we,ye),tokenMaxA:n.value,tokenMaxB:0}}}else a.value=!0,s.value=!0;_.value=!1,y.value=new J(B.value.liquidityAmount.toString()).div(i.value.liquidity).mul(100).toNumber().toFixed(2),U.value=B.value.liquidityAmount,d.setPositionActionAmount({fromCoinAmount:n,toCoinAmount:l})},y=x(0),U=x("0"),K=g=>{if(console.log("setPercent isSlider.value: ",_.value),!_.value)return;_.value=!0;const $=i.value.token_a.decimals,P=i.value.token_b.decimals,Y=i.value.tick_lower_index,G=i.value.tick_upper_index,ne=pt.tickIndexToSqrtPriceX64(Y),_e=pt.tickIndexToSqrtPriceX64(G);let ce="";g.value!==1?ce=new J(i.value.liquidity).mul(g.value).toString():ce=i.value.liquidity,ce=Ge(ce,0)||"0",U.value=ce;const we=Nt.getCoinAmountFromLiquidity(new pe(ce),new pe(i.value.current_sqrt_price),ne,_e,k.value!="Sui"),je=new J(we.coinA.toString()).div(Math.pow(10,$)).toString(),Fe=new J(we.coinB.toString()).div(Math.pow(10,P)).toString();n.value=Number(je)>0?je:"",l.value=Number(Fe)>0?Fe:"",d.setPositionActionAmount({fromCoinAmount:n,toCoinAmount:l})};le(()=>f.value.currentPositionInfo,g=>{if(g&&!de(g)){i.value=g,r.value=i.value.token_a,o.value=i.value.token_b,K({value:y.value/100});let $=Number(i.value.tick_lower_index),P=Number(i.value.tick_upper_index);const Y=Number(i.value.current_tick_index);(g.maxPrice.indexOf("+")>0||g.maxPrice==="âˆž"?"âˆž":g.maxPrice)=="âˆž"||Y>=$&&Y<P?(a.value=!1,s.value=!1):Y>=P?(n.value="",a.value=!0,s.value=!1):Y<$?(a.value=!1,s.value=!0,l.value=""):(a.value=!0,n.value="",s.value=!0,l.value=""),C()}},{immediate:!0}),le(n,(g,$)=>{g&&C(),g==""&&(l.value="",y.value=0)}),le(l,(g,$)=>{g&&C(),g==""&&(n.value="",y.value=0)});const X=p(()=>f.value.RATES);p(()=>{var ne,_e,ce,we;const g=((_e=X.value[(ne=r.value)==null?void 0:ne.address])==null?void 0:_e.price)||0,$=((we=X.value[(ce=o.value)==null?void 0:ce.address])==null?void 0:we.price)||0,P=new J(g).mul(new J(n.value||0)),Y=new J($).mul(new J(l.value||0)),G=P.add(Y);return ie(G.toString(),2)});const S=x(!1),{t:u,locale:Z}=xt(),v=p(()=>{const g=Number(n.value)>Number(m.value),$=Number(l.value)>Number(I.value);return!n.value&&!l.value?u("button.enterAmount"):g||$?"Invalid Amount":u("button.remove")}),te=p(()=>{const g=Number(n.value)>Number(m.value),$=Number(l.value)>Number(I.value);return!!(!n.value&&!l.value||g||$)}),{setIsShowSuccess:oe,setIsShowRejected:ge,setIsShowWaiting:me,setTransactionDesc:se,setTransactionTxid:Se,setPositiomNum:We,setTransactionDescText:Le}=b,be=x(!1);le(y,Ut((g,$)=>{g!==$&&(Number(g)>100?y.value=100:g&&i.value?(y.value=g,K({value:y.value/100})):(n.value="",l.value=""))},300)),le(R,g=>{g&&i.value&&K({value:y.value/100})});const Xe=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],fe=Bt(),ke=p(()=>fe),Ce=p(()=>ke.value.status),Ae=x(!1),Me=g=>{g.sources.forEach(P=>{const{pool_address:Y,position_index:G}=JSON.parse(P.blockchainAddress);Y==i.value.poolAddress&&Number(G)==Number(i.value.index)&&(Ae.value=!0)})},He=async()=>{await fe.getSources();let g;ke.value.allSources.forEach($=>{const{pool_address:P,position_index:Y}=JSON.parse($.blockchainAddress);P==i.value.poolAddress&&Y==i.value.index&&(g=$.id)}),fe.deleteSource(g)};le(()=>[ke.value.sourceGroups,i.value],([g,$])=>{g&&g.sources&&g.sources.length>0&&$&&!de($)&&Me(g)},{immediate:!0,deep:!0});const N=st(),z=Dt(),$e=async()=>{var G,ne,_e,ce,we,je,Fe,tt,ye,Oe,Ue,De,rt;be.value=!0,Se("");const g=ie(n.value,r.value.decimals)==0?"":`${Be(n.value,r.value.decimals)} ${r.value.symbol}`,$=ie(l.value,o.value.decimals)==0?"":`${Be(l.value,o.value.decimals)} ${o.value.symbol}`;se(u("tips.removeLiquidiyText",{from:w.value?$:g,and:ie(n.value,r.value.decimals)==0||ie(l.value,o.value.decimals)==0?"":"and",to:w.value?g:$})),me(!0);const P=i.value.poolInfo.rewarder_infos,Y=P&&P.length>0&&k.value=="Sui"||P&&P.length>0&&y.value==100?u("modal.removeLiquidityText1"):u("modal.removeLiquidityText2");Le(Y);try{let ue={};ue={pool:{...i.value.poolInfo,coinA:i.value.token_a,coinB:i.value.token_b},coinTypeA:i.value.poolInfo.coinTypeA,coinTypeB:i.value.poolInfo.coinTypeB,position:i.value,delta_liquidity:y.value==100?new pe(i.value.liquidity):new pe(Ge(U.value,0)),slippage:Number(R.value),rewards_num:P.length,positionInfo:i.value},ue.coinTypeC=P[0]?P[0].coinAddress:"",ue.coinTypeD=P[1]?P[1].coinAddress:"",ue.coinTypeE=P[2]?P[2].coinAddress:"";const Ne=await T.value.getRemoveLiquidityTransactionPayload(ue);let xe;if(k.value==="Aptos")xe=await F.value.currentWallet.signAndSubmitTransaction(Ne);else{const ot=await T.value.signAndExecuteTransactionBlock(F.value.currentWallet,Ne.txb,Ne==null?void 0:Ne.payloadParams);xe=T.value.handleTx(ot),console.log("0331###remove###tx####",xe)}if(xe&&xe.hash){Se(xe.hash),me(!1),oe(!0);const ot={title:u("common.removeLiquidity"),desc:"",hash:xe.hash,descTransactions:`Remove ${n.value} ${(G=r.value)==null?void 0:G.symbol} and ${l.value} ${(ne=o.value)==null?void 0:ne.symbol} 
             from the pool`,sender:F.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:w.value?`${(ce=o.value)==null?void 0:ce.address}`:`${(_e=r.value)==null?void 0:_e.address}`,numa:w.value?`+ ${l.value}`:`+ ${n.value}`,logoa:w.value?f.value.tokensObj&&o.value&&o.value.address&&f.value.tokensObj[o.value.address]&&f.value.tokensObj[o.value.address].logoURI:f.value.tokensObj&&r.value&&r.value.address&&f.value.tokensObj[r.value.address]&&f.value.tokensObj[r.value.address].logoURI,tokenb:w.value?`${(we=r.value)==null?void 0:we.address}`:`${(je=o.value)==null?void 0:je.address}`,numb:w.value?`+ ${n.value}`:`+ ${l.value}`,logob:w.value?f.value.tokensObj&&r.value&&r.value.address&&f.value.tokensObj[r.value.address]&&f.value.tokensObj[r.value.address].logoURI:f.value.tokensObj&&o.value&&o.value.address&&f.value.tokensObj[o.value.address]&&f.value.tokensObj[o.value.address].logoURI},text:`Withdraw ${n.value} ${(Fe=r.value)==null?void 0:Fe.symbol} and ${l.value} ${(tt=o.value)==null?void 0:tt.symbol}`};k.value!=="Aptos"&&(ot.res=xe.res),T.value.showTransitionPending(ot);const bt=await T.value.watchTransaction(ot);if(P.value&&P.value.length>0&&(Number((ye=P[0])==null?void 0:ye.amount)!==0||ue.coinTypeD&&Number((Oe=P[1])==null?void 0:Oe.amount)!==0||ue.coinTypeE&&Number((Ue=P[2])==null?void 0:Ue.amount)!==0)){const mt={title:u("common.removeLiquidity"),desc:"",hash:xe.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:P[0].symbol,numa:`+ ${Number(P[0].amount)}`,logoa:f.value.tokensObj&&P[0]&&P[0].address&&f.value.tokensObj[P[0].address]&&f.value.tokensObj[P[0].address].logoURI,tokenb:ue.coinTypeD?P[1].symbol:"",numb:ue.coinTypeD?`+ ${Number(P[1].amount)}`:"",logob:ue.coinTypeD?f.value.tokensObj&&P[1]&&P[1].address&&f.value.tokensObj[P[1].address]&&f.value.tokensObj[P[1].address].logoURI:"",tokenc:ue.coinTypeE?P[2].symbol:"",numc:ue.coinTypeE?`+ ${Number(P[2].amount)}`:"",logoc:ue.coinTypeE?f.value.tokensObj&&P[2]&&P[2].address&&f.value.tokensObj[P[2].address]&&f.value.tokensObj[P[2].address].logoURI:""},text:`Withdraw ${n.value} ${(De=r.value)==null?void 0:De.symbol} and ${l.value} ${(rt=o.value)==null?void 0:rt.symbol}`},Mt=await T.value.setTransations(mt)}if(ct(i.value.feeOwedA,i.value.token_a.decimals)!==0||ct(i.value.feeOwedB,i.value.token_b.decimals)!==0){const mt={title:"Claim",desc:"",hash:xe.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${i.value.token_a.symbol}`,numa:ie(i.value.feeOwedA,i.value.token_a.decimals)==0?"":`+ ${ct(i.value.feeOwedA,i.value.token_a.decimals)}`,logoa:ie(i.value.feeOwedA,i.value.token_a.decimals)==0?"":f.value.tokensObj&&i.value&&i.value.token_a.address&&f.value.tokensObj[i.value.token_a.address]&&f.value.tokensObj[i.value.token_a.address].logoURI,tokenb:`${i.value.token_b.symbol}`,numb:ie(i.value.feeOwedB,i.value.token_b.decimals)==0?"":`+ ${ct(i.value.feeOwedB,i.value.token_b.decimals)}`,logob:ie(i.value.feeOwedB,i.value.token_b.decimals)==0?"":f.value.tokensObj&&i.value&&i.value.token_b.address&&f.value.tokensObj[i.value.token_b.address]&&f.value.tokensObj[i.value.token_b.address].logoURI}},Mt=await T.value.setTransations(mt)}bt&&Number(y.value)==100&&Ce.value=="authenticated"&&Ae.value&&(await fe.subscribePosition({pool_address:i.value.poolAddress,position_index:i.value.index},i.value.nftHash,!1),He()),bt&&(n.value="",l.value="",setTimeout(()=>{Number(y.value)!==100&&ctx.emit("getDetails")},3e3),setTimeout(()=>{Number(y.value)!==100&&ctx.emit("getDetails")},6e3),Number(y.value)==100&&z.name=="new-position-detail"&&(k.value==="Aptos"?N.push("/position"):N.push("/pool/position")),y.value=0)}else me(!1),ge(!0);be.value=!1}catch(ue){console.log("Remove error",ue),be.value=!1,me(!1),ge(!0)}};return(g,$)=>{const P=Et,Y=Ke;return A(),D("div",Li,[t("div",Oi,[t("div",Bi,[E(ee(Ot),{"tab-list":V,"current-tab":"Remove",onOnClick:$[0]||($[0]=G=>{G.name=="Increase"&&ee(L).setPositionDetailCurrentTab("increase")})})]),t("div",{class:_t(["card-container",[j.value?"input-block-add-top":"",h.value?"input-block-add-bottom":""]])},[E(dt,{modelValue:n.value,"onUpdate:modelValue":$[1]||($[1]=G=>n.value=G),"input-value":n.value,"token-info":r.value||null,"has-arrow":!1,"have-half":!1,onOnInput:$[2]||($[2]=G=>{n.value=G,c.value=!0,_.value=!1}),onOnFocus:$[3]||($[3]=()=>{j.value=!0,h.value=!1})},null,8,["modelValue","input-value","token-info"]),E(dt,{modelValue:l.value,"onUpdate:modelValue":$[4]||($[4]=G=>l.value=G),"input-value":l.value,"token-info":o.value||null,"has-arrow":!1,"have-half":!1,onOnInput:$[5]||($[5]=G=>{l.value=G,c.value=!1,_.value=!1}),onOnFocus:$[6]||($[6]=()=>{j.value=!1,h.value=!0})},null,8,["modelValue","input-value","token-info"]),m.value==0?(A(),D("div",Ri)):ae("",!0),I.value==0?(A(),D("div",Mi)):ae("",!0)],2),t("div",ji,[Fi,t("div",Ui,[Number(m.value)>=Number(n.value)&&Number(I.value)>=Number(l.value)?(A(),D("div",Di,q(y.value>0&&Number(ee(Ge)(y.value,2))<.01?"<0.01":ee(Ge)(y.value,2))+"% ",1)):(A(),D("div",Ei," -- ")),t("div",zi,[(A(),D(it,null,at(Xe,(G,ne)=>t("div",{key:ne,class:_t(["ratio-item",y.value==G.value?"ratio-item-active":""]),onClick:()=>{_.value=!0,y.value=G.value}},q(G.name),11,Wi)),64))])]),E(P,{value:y.value,"onUpdate:value":$[7]||($[7]=G=>y.value=G)},null,8,["value"])])]),F.value.connected?(A(),he(Y,{key:0,class:"big-btn liquidity-btn",loading:be.value,disabled:te.value,onClick:$e},{default:re(()=>[t("span",null,q(v.value),1)]),_:1},8,["loading","disabled"])):(A(),he(Y,{key:1,class:"big-btn",onClick:$[8]||($[8]=G=>F.value.connected?S.value=!0:F.value.setIsShowWalletModal(!0))},{default:re(()=>[t("span",null,q(g.$t("button.connectWallet")),1)]),_:1}))])}}});const Hi=Te({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const j=Bt(),h=p(()=>j),V=p(()=>h.value.status),L=qe(),n=x(!1);le(()=>V.value,d=>{d=="authenticated",n.value=!1},{immediate:!0});const l=x(!1),b=async()=>{l.value=!l.value;const d={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},f=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await j.subscribePosition(d,f,l.value)}catch{l.value=!l.value}},O=d=>{const f=d.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",f),l.value=f.some(a=>JSON.parse(a.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(a.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return st(),le(()=>[h.value.sourceGroups,e.positionInfo],([d,f])=>{l.value=!1,d&&d.length>0&&d[0]&&f&&!de(f)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),O(d[0]))},{immediate:!0,deep:!0}),{importIcon:Rt,isShowSetUp:n,changeSwitch:b,checked:l,notifiStatus:V,store:L}}});const Vi=e=>(Ye("data-v-758cc786"),e=e(),Qe(),e),Gi={class:"range-alerts"},Ji={class:"range-alerts-top"},Yi={class:"title"},Qi=Vi(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),Ki={key:1,class:"h5-switch-box"},Zi={class:"range-alerts-bottom"},ea={key:0,class:"pc-switch-box"};function ta(e,j,h,V,L,n){const l=Ke,b=zt;return A(),D("div",Gi,[t("div",Ji,[t("div",Yi,[Qi,e.isShowSetUp||e.notifiStatus!=="authenticated"?(A(),he(l,{key:0,class:"range-alerts-button",onClick:j[0]||(j[0]=Tt(O=>e.store.setIsShowNotifi(!0),["stop"]))},{default:re(()=>[ve(" Set up ")]),_:1})):ae("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(A(),D("div",Ki,[E(b,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ae("",!0)])]),t("div",Zi,[ve(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(A(),D("div",ea,[E(b,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ae("",!0)])])}const oa=Re(Hi,[["render",ta],["__scopeId","data-v-758cc786"]]),na=Te({setup(){const e=gt(),j=p(()=>e),h=_o(),V=p(()=>h),L=st(),n=p(()=>j.value.currentPositionInfo),l=x(),b=M=>{var _;return((_=j.value.tokensObj[M])==null?void 0:_.logo_url)||Rt("/image/coins/sui-unknown.png")},O=Zt("Sui"),d=x(),f=async M=>{d.value=0;try{const _=await O.calculateFarmingRewards([{pool_id:M.pool_id,position_nft_id:M.id}]),C=[];let y=new J(0);_[M.id].forEach((U,K)=>{var u;const X=(u=j.value.tokensObj[U.rewarder_type])==null?void 0:u.decimals;let S=new J(U.rewarder_amount).div(Math.pow(10,X)).toString();Number(S)>0&&s.value.rewarders[K]&&(y=y.add(S),C.push({...U,rewarderAmount:S,rewarderAmountPer:S}))}),d.value=y,l.value=C}catch(_){console.log(_,"getRewarder")}},a=p(()=>V.value.farmsPoolObj),s=p(()=>a.value[n.value.poolAddress]);le(()=>[n.value,a.value,s.value],([M,_,C])=>{var y;!de(M)&&M.positionSource=="farming"&&!de(C)?f(M):!de(_)&&!de(M)&&(l.value=(y=_[M.poolAddress])==null?void 0:y.rewarders)},{immediate:!0});const c=lt(),k=p(()=>c),T=qe(),W=Ee("Sui"),{setIsShowSuccess:F,setIsShowRejected:R,setIsShowWaiting:r,setTransactionDesc:o,setTransactionTxid:w}=T,m=x(!1),I=async()=>{m.value=!0,w(""),o("Claim rewards"),r(!0);const M={pool_id:n.value.pool_id,position_nft_id:n.value.id};try{const _=await O.harvestFarms(M),C=await W.signAndExecuteTransactionBlock(k.value.currentWallet,_.txb,_.payloadParams);console.log("0221###sui swap res###",C);let y=W.handleTx(C);if(y&&y.hash){w(y.hash),r(!1),F(!0);let U={title:"Claim",res:y.res,hash:y.hash};W.showTransitionPending(U),await W.watchTransaction(U)&&setTimeout(()=>{f(n.value),W.getAccount(k.value.address)},2e3)}else r(!1),R(!0);m.value=!1}catch(_){console.log("farmsDeposit error",_),r(!1),R(!0),m.value=!1}},i=async()=>{m.value=!0,w(""),o(`Unstake ${n.value.name}`),r(!0);const M=n.value.pool_id,_=n.value.id;try{const C=await O.farmsWithdraw(M,_),y=await W.signAndExecuteTransactionBlock(k.value.currentWallet,C.txb,C.payloadParams);console.log("0221###sui swap res###",y);let U=W.handleTx(y);if(U&&U.hash){w(U.hash),r(!1),F(!0);let K={res:U.res,title:"Unstake",hash:U.hash};W.showTransitionPending(K),await W.watchTransaction(K)&&setTimeout(()=>{L.replace(`/new-position-detail?token=${n.value.tokenName}&address=${n.value.clmm_pool_id}&pos=${n.value.clmm_position_id}`),j.value.setCurrentPositionInfo(n.value.clmm_pool_id,"",n.value.tokenName,"Sui",n.value.clmm_position_id),d.value=0,m.value=!1},2e3)}else r(!1),R(!0)}catch(C){console.log("farmsDeposit error",C),r(!1),R(!0),m.value=!1}},Q=async()=>{m.value=!0,w(""),o(`Stake ${n.value.name}`),r(!0);const M={clmm_pool_id:n.value.poolAddress,clmm_position_id:n.value.pos_object_id,coinTypeA:n.value.coin_type_a,coinTypeB:n.value.coin_type_b},_=a.value[n.value.poolAddress].id;try{const C=await O.farmsDeposit(M,_),y=await W.signAndExecuteTransactionBlock(k.value.currentWallet,C.txb,C.payloadParams);console.log("0221###sui swap res###",y);let U=W.handleTx(y);if(U&&U.hash){w(U.hash),r(!1),F(!0);let K={res:U.res,title:"Staked",hash:U.hash};W.showTransitionPending(K);const X=await W.watchTransaction(K,!0);let S;X!=null&&X.status&&setTimeout(async()=>{var u,Z;(Z=(u=X==null?void 0:X.res)==null?void 0:u.events)==null||Z.forEach(v=>{v.type.indexOf("::pool::DepositEvent")>-1&&(S=v.parsedJson.wrapped_position_id)}),L.replace(`/new-position-detail?position_nft_id=${S}&positionSource=farming`),await j.value.setCurrentPositionInfo("","","","Sui",S,"farming"),m.value=!1},2e3)}else r(!1),R(!0)}catch(C){console.log("farmsDeposit error",C),r(!1),R(!0),m.value=!1}},B=p(()=>T),H=p(()=>B.value.addressLpTokens);return{getCoinIcon:b,rewardList:l,sFixD:Ge,addCommom:ie,claim:I,unStake:i,loading:m,totalRewardAmount:d,currentPositionInfo:n,stake:Q,farmsPoolObj:a,addressLpTokens:H,farmsPoolInfo:s}}});const ze=e=>(Ye("data-v-8a2c6b44"),e=e(),Qe(),e),ia={key:0,class:"farms-position-detail-box"},aa={class:"farms-top"},sa=ze(()=>t("div",{class:"left"},[t("div",{class:"title"},"Farming"),t("div",{class:"desc"},"Stake Position to Earn")],-1)),la={class:"right"},ua={class:"apr"},ra={class:"apr-tips-box"},ca=ze(()=>t("span",null,"View",-1)),da=ze(()=>t("svg",{class:"arrow-icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_arrow"})],-1)),va=[ca,da],ma={class:"farms-bottom"},fa=ze(()=>t("div",{class:"title"},"Farming Rewards",-1)),_a={key:0,class:"reward-list"},pa={key:0,class:"rewards-item-bg"},ha={class:"rewards-item-box"},ga={alt:""},ba={key:1},ka={class:"rewards-item-bg"},wa={class:"rewards-item-box"},ya={alt:""},Pa=ze(()=>t("span",null,"0",-1)),Ia={key:1,class:"reward-list"},Sa={key:0,class:"rewards-item-bg"},Aa={class:"rewards-item-box"},$a={alt:""},xa=ze(()=>t("span",null,"0",-1)),Ta={key:1},Ca={class:"rewards-item-bg"},Na={class:"rewards-item-box"},qa={alt:""},La=ze(()=>t("span",null,"0",-1)),Oa={class:"actions-box"};function Ba(e,j,h,V,L,n){var f,a,s;const l=fo,b=Ke,O=$t,d=Wt("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(A(),D("div",ia,[t("div",aa,[sa,t("div",la,[t("div",ua,[ve(" APRÂ  "),t("span",null,[ve(q(("addCommom"in e?e.addCommom:ee(ie))(((f=e.farmsPoolInfo)==null?void 0:f.total_apr)*100,2))+"%Â  ",1),t("div",ra,[E(l,{"l-item":e.farmsPoolInfo,"rewarder-info":(s=(a=e.farmsPoolInfo)==null?void 0:a.rewarder)==null?void 0:s.rewardList},null,8,["l-item","rewarder-info"])])])]),t("div",{class:"view",onClick:j[0]||(j[0]=c=>e.$router.push("/farms"))},va)])]),t("div",ma,[fa,e.rewardList&&e.rewardList.length>0?(A(),D("div",_a,[(A(!0),D(it,null,at(e.rewardList,c=>(A(),D("div",{key:c,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(A(),D("div",pa,[t("div",ha,[Ve(t("img",ga,null,512),[[d,e.getCoinIcon(c.rewarder_type)]]),t("span",null,q(("addCommom"in e?e.addCommom:ee(ie))(c.rewarderAmount||0)),1)])])):(A(),D("div",ba,[t("div",ka,[t("div",wa,[Ve(t("img",ya,null,512),[[d,e.getCoinIcon(c.reward_coin)]]),Pa])])]))]))),128))])):(A(),D("div",Ia,[(A(!0),D(it,null,at(e.currentPositionInfo.rewards,c=>(A(),D("div",{key:c,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(A(),D("div",Sa,[t("div",Aa,[Ve(t("img",$a,null,512),[[d,e.getCoinIcon(c.rewarder_type)]]),xa])])):(A(),D("div",Ta,[t("div",Ca,[t("div",Na,[Ve(t("img",qa,null,512),[[d,e.getCoinIcon(c.reward_coin)]]),La])])]))]))),128))])),t("div",Oa,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(A(),he(b,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:re(()=>[ve("Unstake")]),_:1},8,["loading","onClick"])):ae("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(A(),he(O,{key:1},{title:re(()=>[ve("Farming rewards are only available for active positions.")]),default:re(()=>[E(b,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:re(()=>[ve("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(A(),he(b,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:re(()=>[ve("Stake")]),_:1},8,["loading","onClick"])):ae("",!0),E(b,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Tt(e.claim,["stop"])},{default:re(()=>[ve("Claim")]),_:1},8,["loading","disabled","onClick"])])])])):ae("",!0)}const Ra=Re(na,[["render",Ba],["__scopeId","data-v-8a2c6b44"]]),Ma={class:"new-position-detail"},ja={class:"new-position-content"},Fa={class:"left"},Ua={class:"right"},Da={class:"loading-global"},Ea=Te({__name:"new-position-detail-sui",setup(e){const j=st(),{getCurrentPosition:h}=Ct(),{getPoolList:V}=eo(),L=x(),n=x();St(()=>{L.value=j.currentRoute.value.query.id||"",n.value=j.currentRoute.value.query.positionSource||""});const l=Ze(),b=p(()=>l.poolsObj),O=Ht(),d=p(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:293 ~ allTokensObj ~ suiTokenStore.allTokensObj:",O.allTokensObj),O.allTokensObj));le(()=>d.value,F=>{F&&!de(F)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:298 ~ watch ~ getPoolList:"),V())},{immediate:!0}),le(()=>[b.value,d.value,L.value,n.value],([F,R,r,o])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ positionSource:",o),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ routerId:",r),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ allTokensObj:",R),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ poolsObj:",F),F&&!de(F)&&R&&!de(R)&&r&&o&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:38 ~ getCurrentPosition:"),h(r,o))},{immediate:!0});const f=lt(),a=p(()=>f),s=Ee("Sui"),c=()=>{h(L.value,n.value),a.value.address&&s.getAccount(a.value.address)},k=p(()=>l.currentPositionLoading),T=p(()=>l.currentPositionInfo),W=p(()=>l.positionDetailCurrentTab);return(F,R)=>{const r=Xt;return A(),D("div",Ma,[E(wo,{onClickRefresh:c}),t("div",ja,[t("div",Fa,[E(Zo),E(It,{class:"pc-module",onGetDetails:F.getDetails},null,8,["onGetDetails"])]),t("div",Ua,[W.value=="increase"?(A(),he(qi,{key:0,onGetDetails:F.getDetails},null,8,["onGetDetails"])):(A(),he(Xi,{key:1,onGetDetails:F.getDetails},null,8,["onGetDetails"])),E(It,{class:"h5-module",onGetDetails:F.getDetails},null,8,["onGetDetails"]),E(Ra),T.value&&T.value.minPrice!=="0"&&T.value.maxPrice!=="âˆž"?(A(),he(oa,{key:2,"position-info":T.value},null,8,["position-info"])):ae("",!0)])]),Ve(t("div",Da,[E(r)],512),[[At,k.value]])])}}});const Bs=Re(Ea,[["__scopeId","data-v-d82de158"]]);export{Bs as default};
