import{e as ze,b as X,d as ce,c as re,h as Te,Z as po,s as Ie,u as Ke,g as ve,q as fo,i as je,k as Ve}from"./index.694cb687.js";import{a5 as Lo,m as o,r as U,D as ae,y as oo,a as de,o as f,c as Z,w as se,L as Ye,h as n,f as P,i as G,F as He,s as Ge,v as j,x as K,p as he,k as ge,e as me,M as oe,z as fe,j as _e,S as Je,u as ne,K as Uo,Y as Eo,B as to,C as jo,W as Do,l as Xe,a4 as qo,I as Wo,H as Vo,a1 as zo,b as ho,a7 as Ho}from"./entry.969cd3b1.js";import"./index.d1735250.js";import{a as Se,o as go,u as Re,b as wo,p as So,j as Co}from"./pool.ce255c47.js";import{u as ko,C as no,R as Go,e as Ko,c as Ee,A as Yo,a as Jo,_ as Xo,b as Zo,d as Qo}from"./confetti.module.77bf46a2.js";import{u as bo}from"./useToken.6c5461d3.js";import{D as M}from"./decimal.0bdeb344.js";/* empty css              */import{C as so}from"./coin-img.4f9414df.js";import{_ as xo}from"./refresh-icon.69a0c089.js";import{_ as et}from"./swap-setting.a5d63e16.js";/* empty css              */import{_ as ot}from"./coin-select.89b3eef3.js";import{_ as tt}from"./token-warning-modal.a1fe14c5.js";/* empty css              */import{T as yo}from"./token-warning-new.03d43915.js";import{u as nt}from"./useDebounceFunction.35414d9d.js";import{u as ao}from"./token.93418b41.js";import{i as st}from"./install.754eb403.js";import{U as at}from"./underline-tab.dca8c49e.js";import"./fetchFun.3536bfb9.js";/* empty css              */import"./icon-error_2x.9c229065.js";import"./import-icon.de3e6c66.js";/* empty css              */import"./token-warning_2x.5e57fa7a.js";import"./img-no-Positions_2x.8de9c28a.js";import"./img-no-Positions_2x.dd80ad03.js";import"./icon-selected_3x.09e9a6f0.js";import"./limit-beta.54bdb33b.js";const ue=Lo("useSuiSwapStore",{state:()=>({fromCoin:{},toCoin:{},fromCoinAmount:"",toCoinAmount:"",fixedFromCoin:!0,oneFromAmount:"",oneToAmount:"",minimumReceived:"",maximumSold:"",isSwapping:!1,swapPoolInfo:{},suiPreSwapData:{},swapRouterLoading:!1,notFoundRouter:!1,isRouterProgress:!1,refresh:!0,routerPool:[],routerSwap:[],insufficientLiquidity:!1,countdown:0,isSwapConfirmModal:!1,plusChecked:localStorage.getItem("plusChecked")||"close"}),actions:{setFromCoin(e){this.fromCoin=e},setFromCoinAmount(e){console.log("ðŸš€ ~ setFromCoinAmount ~ data:",e),this.fromCoinAmount=e},setToCoin(e){this.toCoin=e},setToCoinAmount(e){this.toCoinAmount=e},setFixedFromCoin(e){this.fixedFromCoin=e},setPlusChecked(e){this.plusChecked=e},setOneFromAmount(e){this.oneFromAmount=e},setOneToAmount(e){this.oneToAmount=e},setIsSwapping(e){this.isSwapping=e},setSwapPoolInfo(e){this.swapPoolInfo=e},setSuiPreSwapData(e){this.suiPreSwapData=e},setSwapRouterLoading(e){this.swapRouterLoading=e},setNotFoundRouter(e){this.notFoundRouter=e},setIsRouterProgress(e){this.isRouterProgress=e},setRouterPool(e){this.routerPool=e},setRouterSwap(e){this.routerSwap=e},setInsufficientLiquidity(e){this.insufficientLiquidity=e},setCountdown(e){this.countdown=e},setRefresh(e){this.refresh=e},setIsSwapConfirmModal(e){this.isSwapConfirmModal=e},setMinimumReceived(e){this.minimumReceived=e},setMaximumSold(e){this.maximumSold=e}}});function eo(e,t=500){let p=null;return function(...s){clearTimeout(p),p=setTimeout(()=>{e.call(this,...s)},t)}}function _o(){const e=Se(),t=o(()=>e);console.log(1313);const p=ue(),s=o(()=>p),{setIsRouterProgress:c,setInsufficientLiquidity:w,setIsSwapping:i,setOneFromAmount:l,setOneToAmount:r,setSwapRouterLoading:a,setNotFoundRouter:S,setSuiPreSwapData:g,setRouterPool:u,setFromCoinAmount:$,setToCoinAmount:b,setCountdown:_,setMinimumReceived:A,setMaximumSold:F}=p,I=o(()=>s.value.swapPoolInfo),D=o(()=>s.value.fromCoin),h=o(()=>s.value.toCoin),d=o(()=>s.value.fromCoinAmount),k=o(()=>s.value.toCoinAmount),C=o(()=>s.value.fixedFromCoin),B=o(()=>s.value.isRouterProgress),v=o(()=>s.value.routerSwap),N=o(()=>t.value.slippage),E=o(()=>ko()),O=U(0),q=async m=>{var y,R;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1954 ~ getSuiAmount ~ getSuiAmount:"),c(!0),w(!1),D.value&&h.value&&(Number(d.value)>0&&C.value||Number(k.value)>0&&!C.value)){console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1954 ~ getSuiAmount ~ getSuiAmount:1"),(!d.value&&k.value||d.value&&!k.value)&&i(!0),l(""),r(""),a(!0),S(!1);let L;I.value&&(L=D.value.address===I.value.coinA.address&&h.value.address===I.value.coinB.address?0:1);try{let T;if(C.value){const we=new M(d.value).mul(Math.pow(10,D.value.decimals)).toString();T=new ze(we)}else{const we=new M(k.value).mul(Math.pow(10,h.value.decimals)).toString();T=new ze(we)}const W=Number(N.value)/100,Y=I.value?{poolAddresses:v.value,coinTypeA:I.value.coin_a_address,coinTypeB:I.value.coin_b_address,decimalsA:I.value.coinA.decimals,decimalsB:I.value.coinB.decimals,a2b:L==0,byAmountIn:C.value,amount:T.toString()}:"";console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1827 ~ setup ~ fromCoin:",D),console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1827 ~ setup ~ toCoin:",h),console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1827 ~ setup ~ coinAmount:",T),console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1827 ~ setup ~ fixedFromCoin.value:",C.value);const z=O.value+1;O.value=z;const V=await((y=E==null?void 0:E.value)==null?void 0:y.getFindRouter(D,h,T.toString(),C.value,W,I.value?Y:"",z));if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1827 ~ setup ~ swapRouter:",V),console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1827 ~ setup ~ swapRouter JSON:",JSON.stringify(V,null,2)),O.value!==(V==null?void 0:V.id)){a(!1),c(!1),i(!1),g({}),u([]),C.value?b(""):$("");return}if(V!=null&&V.insufficientLiquidity){w(!0),a(!1),c(!1),i(!1),g({}),u([]),C.value?b(""):$("");return}if(!V||!(V!=null&&V.routes)||((R=V==null?void 0:V.routes)==null?void 0:R.length)==0){i(!1),S(!0),a(!1),c(!1),g({}),u([]),d.value?b(""):$("");return}if(V.fromCoinAddress!==D.value.address||V.toCoinAddress!==h.value.address){console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1861 ~ getSuiAmount ~",V.fromCoinAddress!==D.value.address||V.toCoinAddress!==h.value.address),g({}),u([]);return}if(V){if(g(V),u(V.routes),w(!1),C.value){if(d.value){const $e=new M(V.amountOut).div(new M(Math.pow(10,h.value.decimals))).toString();b($e)}}else if(k.value){const $e=new M(V.amountIn).div(new M(Math.pow(10,D.value.decimals))).toString();$($e)}console.log(k.value,"###toCoinAmount.value");const we=X(ce(new M(d.value).div(new M(k.value).toString()),D.value.decimals));l(we);const Ce=X(ce(new M(k.value).div(d.value).toString(),h.value.decimals));r(Ce),i(!1),S(!1),a(!1)}else i(!1),S(!0),a(!1)}catch(T){console.log("pre swap error2",T),i(!1),a(!1),c(!1)}}else C.value?b(""):$(""),i(!1),a(!1);c(!1),console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1926 ~ getSuiAmount ~ isRouterProgress.value:",B.value)};return ae(d,(m,y)=>{console.log("ðŸš€ ~ newVal123131:",m),m&&Number(m)!==0&&C.value&&(_(0),eo(q(),800)),m==""&&C.value&&b("")}),ae(k,(m,y)=>{m&&Number(m)!==0&&!C.value&&(_(0),eo(q(),800)),m==""&&!C.value&&$("")}),ae(()=>[D.value,h.value],([m,y])=>{!re(m)&&!re(y)&&(_(0),eo(q(C.value?d.value:k.value)))},{immediate:!0,deep:!0}),ae(()=>[d.value,k.value,D.value,h.value,C.value,N.value],([m,y,R,L,T,W])=>{if(m&&y&&R&&L&&W)if(T){const Y=new M(y).mul(new M(W/100));A(new M(y).sub(Y).toString())}else{const Y=new M(m).mul(new M(W/100));F(new M(m).add(Y).toString())}},{immediate:!0}),{getSuiAmount:q}}function it(){const e=ue(),{getToken:t}=bo(),{getSuiAmount:p}=_o(),{setCountdown:s}=e,c=U(0),w=U([]),i=o(()=>e),l=o(()=>i.value.fixedFromCoin),r=o(()=>i.value.fromCoinAmount),a=o(()=>i.value.toCoinAmount),S=o(()=>i.value.fromCoin),g=o(()=>i.value.toCoin),u=o(()=>i.value.suiPreSwapData),$=Se(),b=U(!1),_=go(),A=o(()=>_),F=o(()=>$.isShowRouterModal),I=o(()=>A.value.isInitRouter);oo(()=>{window.addEventListener("updateSwapParams",d=>{b.value=!b.value})});const D=U(""),h=async d=>{var k,C,B,v,N,E;if(((k=d==null?void 0:d.routes)==null?void 0:k.length)===1)if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap-info.vue:462 ~ getOnlyOneRouteText ~ suiPreSwapData?.routes:",d==null?void 0:d.routes),((v=(B=(C=d==null?void 0:d.routes)==null?void 0:C[0])==null?void 0:B.path)==null?void 0:v.length)>1){const O=[S==null?void 0:S.value.symbol],q=(E=(N=d==null?void 0:d.routes)==null?void 0:N[0])==null?void 0:E.path;for(let m=0;m<q.length;m++){const y=q[m];console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap-info.vue:467 ~ getOnlyOneRouteText ~ path[i]:",q[m]);const R=await t(y==null?void 0:y.target);O.push(R==null?void 0:R.symbol)}D.value=O==null?void 0:O.join(" > ")}else D.value=`${S==null?void 0:S.value.symbol} > ${g==null?void 0:g.value.symbol}`};return ae(()=>u.value,async d=>{var k;if(d&&!re(d)){const C=[];(k=d==null?void 0:d.routes)==null||k.forEach(B=>{B==null||B.path.forEach(async v=>{C.push(v.provider)})}),w.value=Array.from(new Set(C)),c.value=w.value.length,h(d)}},{immediate:!0}),ae(()=>b.value,d=>{(Number(r.value)>0||Number(a.value)>0)&&p(l.value?r.value:a.value)},{immediate:!0}),ae(()=>I.value,d=>{d||(s(0),p(l.value?r.value:a.value))},{immediate:!0}),{onlyOneRouteText:D,sourcesArr:w,refreshSwapRouter:b,isShowRouterModal:F}}const Ze=e=>(he("data-v-26ab6b7a"),e=e(),ge(),e),rt={class:"price-impact-tips"},lt=Ze(()=>n("div",{class:"text"}," The difference between the market price and estimated price due to trade size. ",-1)),ut={class:"market-price-rate"},ct=Ze(()=>n("div",null,"Market Price Rate",-1)),dt={key:0},mt={key:1,class:"price-unknown"},pt={key:0,class:"market-price-sources"},vt=Ze(()=>n("span",null,"Market price sources:",-1)),ft=Ze(()=>n("svg",{class:"icon tips-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_tips"})],-1)),ht=de({__name:"swap-price-impact-tooltip",props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},marketPriceSource:{type:Object,default:()=>({})},marketPriceA2B:{type:Object,default:()=>({})},marketPriceA2BReverse:{type:Object,default:()=>({})},impact:{type:String,defualt:"",requires:!0}},setup(e){return(t,p)=>{const s=Ye;return f(),Z(s,{"overlay-class-name":"price-impact-tooltip","open(v-model)":!0},{title:se(()=>[n("div",rt,[lt,n("div",ut,[ct,e.impact!=="Incalculable"?(f(),P("div",dt,[G(no,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"one-to-amount":e.marketPriceA2B,"one-from-amount":e.marketPriceA2BReverse},null,8,["from-coin","to-coin","one-to-amount","one-from-amount"])])):(f(),P("div",mt,"Price is unknown"))]),e.marketPriceSource&&e.marketPriceSource.length>0&&e.impact!=="Incalculable"?(f(),P("div",pt,[vt,(f(!0),P(He,null,Ge(e.marketPriceSource,c=>(f(),P("span",{key:c==null?void 0:c.name},j(c==null?void 0:c.name),1))),128))])):K("",!0)])]),default:se(()=>[ft]),_:1})}}});const gt=me(ht,[["__scopeId","data-v-26ab6b7a"]]);function $o(){const e=Re(),t=o(()=>e),p=U([]),s=U(),c=U(),w=_=>{switch(_){case"pyth":return{name:"Pyth Network",logo:"/image/logo_pyth.png"};case"coingecko":return{name:"CoinGecko",logo:"/image/logo_CoinGecko@2x.png"};case"birdeye":return{name:"Birdeye",logo:"/image/birdeye-logo.png"};case"Cetus":return{name:"Cetus",logo:"/sui-image/logo_cetus@2x.png"}}},i=ue(),l=o(()=>i),r=o(()=>l.value.fromCoin),a=o(()=>l.value.toCoin),S=o(()=>l.value.fromCoin),g=o(()=>l.value.toCoin),u=o(()=>l.value.suiPreSwapData),$=o(()=>{var _,A,F,I,D,h,d,k,C,B,v,N,E,O;try{if((_=r==null?void 0:r.value)!=null&&_.address&&((A=a==null?void 0:a.value)!=null&&A.address)&&(u!=null&&u.value)&&!re(u==null?void 0:u.value)){const q=Te((F=u==null?void 0:u.value)==null?void 0:F.amountIn).div(Math.pow(10,(I=r.value)==null?void 0:I.decimals)),m=Te((D=u==null?void 0:u.value)==null?void 0:D.amountOut).div(Math.pow(10,(h=a.value)==null?void 0:h.decimals)),y=Te(m).div(q);console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:2259 ~ suiPriceImpact ~ currentSwapRate:",y==null?void 0:y.toString());const R=(C=(d=t==null?void 0:t.value)==null?void 0:d.RATES)==null?void 0:C[(k=r==null?void 0:r.value)==null?void 0:k.address];console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:2259 ~ suiPriceImpact ~ fromCoinRate:",R);const L=(N=(B=t==null?void 0:t.value)==null?void 0:B.RATES)==null?void 0:N[(v=a==null?void 0:a.value)==null?void 0:v.address];if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:2259 ~ suiPriceImpact ~ toCoinRate:",L),!(R!=null&&R.price)||!(L!=null&&L.price)||Te(R==null?void 0:R.price).lte(0)||Te(L==null?void 0:L.price).lte(0))throw Error("rate invalid");const T=Te(R==null?void 0:R.price).div(L==null?void 0:L.price);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:2259 ~ suiPriceImpact ~ marketRate:",T==null?void 0:T.toString()),y.gt(T)){const W=y.minus(T).div(y).mul(100);return po((E=W==null?void 0:W.negated())==null?void 0:E.toString(),2)}else{const W=y.minus(T).div(y).mul(100);return po((O=W==null?void 0:W.abs())==null?void 0:O.toString(),2)}}return}catch(q){return console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:2271 ~ suiPriceImpact ~ error:",q),"Incalculable"}}),b=_=>{var h,d,k,C;const A=((h=_[r==null?void 0:r.value.address])==null?void 0:h.price)||0,F=((d=_[a==null?void 0:a.value.address])==null?void 0:d.price)||0,I=(k=_[r==null?void 0:r.value.address])==null?void 0:k.market,D=(C=_[a==null?void 0:a.value.address])==null?void 0:C.market;s.value=ce(new M(A).div(new M(F)).toString(),a==null?void 0:a.value.decimals),c.value=ce(new M(F).div(new M(A)).toString(),r==null?void 0:r.value.decimals),p.value=I==D?[w(I)]:[w(I),w(D)],console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap-info.vue:725 ~ getTokenMarketPrice ~ marketPriceA2B.value:",s.value,c.value,p.value)};return ae(()=>[t.value.RATES,S.value,g.value,r.value,a.value],([_])=>{_&&!re(_)&&b(_)},{immediate:!0}),{getTokenMarketPrice:b,marketPriceSource:p,marketPriceA2B:s,marketPriceA2BReverse:c,suiPriceImpact:$}}const wt=de({components:{PriceImpactTooltip:gt},setup(){const{suiPriceImpact:e,marketPriceSource:t,marketPriceA2B:p,marketPriceA2BReverse:s}=$o(),c=ue(),w=o(()=>c),i=o(()=>w.value.fromCoin),l=o(()=>w.value.toCoin),r=o(()=>w.value.swapRouterLoading),a=o(()=>{var S;return Number(e.value)>0&&Number(e.value)<.01?"<0.01":Number(e.value)>100?">100":Number(e.value)>0?`-${e.value}`:`+${(S=e.value)==null?void 0:S.replace("-","")}`});return{marketPriceA2B:p,marketPriceA2BReverse:s,showImpact:a,impact:e,marketPriceSource:t,fromCoin:i,toCoin:l,swapRouterLoading:r}}});const St=e=>(he("data-v-a9619c4b"),e=e(),ge(),e),Ct={class:"swap-show-info-impact"},kt={class:"label"},bt=St(()=>n("span",null,"Price Impact",-1)),yt={key:0,class:"text impact-w"},_t=["src"];function $t(e,t,p,s,c,w){const i=oe("PriceImpactTooltip"),l=Je;return f(),P("div",Ct,[n("div",kt,[bt,G(i,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"market-price-source":e.marketPriceSource,"market-price-a2-b":e.marketPriceA2B,"market-price-a2-b-reverse":e.marketPriceA2BReverse,impact:e.impact},null,8,["from-coin","to-coin","market-price-source","market-price-a2-b","market-price-a2-b-reverse","impact"])]),!e.swapRouterLoading&&e.impact==="Incalculable"?(f(),P("div",yt,j(e.impact),1)):e.swapRouterLoading?(f(),Z(l,{key:2,paragraph:!1,active:""})):(f(),P("div",{key:1,class:fe(["text",e.impact<10?"impact-s":e.impact<30&&e.impact>=10?"impact-w":"impact-e"])},[_e(j(e.showImpact)+"% ",1),(f(!0),P(He,null,Ge(e.marketPriceSource,r=>(f(),P("img",{key:r,src:r==null?void 0:r.logo},null,8,_t))),128))],2))])}const Io=me(wt,[["render",$t],["__scopeId","data-v-a9619c4b"]]),It=de({components:{CurrentPrice:no,RouterModal:Go,ShowInfoImpact:Io},setup(){const e=U(!1),{sourcesArr:t,onlyOneRouteText:p}=it(),s=Se(),c=o(()=>s),w=ue(),i=o(()=>w),l=o(()=>i.value.fromCoin),r=o(()=>i.value.toCoin),a=o(()=>i.value.fromCoinAmount),S=o(()=>i.value.toCoinAmount),g=o(()=>i.value.oneToAmount),u=o(()=>i.value.oneFromAmount),$=o(()=>i.value.fixedFromCoin),b=o(()=>i.value.swapRouterLoading),_=o(()=>i.value.insufficientLiquidity),A=o(()=>i.value.suiPreSwapData),F=o(()=>c.value.isShowRouterModal),I=o(()=>i.value.minimumReceived),D=o(()=>i.value.maximumSold),h=o(()=>c.value.liquiditySourceObj);return{store:s,onlyOneRouteText:p,liquiditySourceObj:h,sourcesArr:t,minimumReceived:I,maximumSold:D,toCoinAmount:S,fromCoinAmount:a,suiPreSwapData:A,isShowRouterModal:F,indexStore:c,insufficientLiquidity:_,fixedFromCoin:$,isOpen:e,fromCoin:l,toCoin:r,oneToAmount:g,oneFromAmount:u,swapRouterLoading:b}}});const io=e=>(he("data-v-65c993d3"),e=e(),ge(),e),At={key:0,class:"show-info"},Tt={class:"price-box"},Rt={class:"price"},Pt=io(()=>n("use",{"xlink:href":"#icon-icon_on"},null,-1)),Ft=[Pt],Mt={key:0,class:"impact"},Nt={class:"trade-block"},Bt={class:"label"},Ot={key:0,class:"text"},Lt={key:0,class:"trade-block"},Ut=io(()=>n("div",{class:"label"},"Auto Router",-1)),Et={key:0,class:"text text-box"},jt=["src","alt"],Dt={key:1,class:"text text-box"},qt=["src","alt"],Wt=io(()=>n("svg",{class:"icon route-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_expand"})],-1));function Vt(e,t,p,s,c,w){var S,g;const i=oe("CurrentPrice"),l=oe("ShowInfoImpact"),r=Je,a=oe("RouterModal");return e.fromCoin&&e.toCoin&&e.fromCoinAmount&&e.toCoinAmount?(f(),P("div",At,[n("div",Tt,[n("div",Rt,[G(i,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"one-to-amount":e.oneToAmount,"one-from-amount":e.oneFromAmount},null,8,["from-coin","to-coin","one-to-amount","one-from-amount"]),(f(),P("svg",{"aria-hidden":"true",class:fe(["dropdown-icon",{open:e.isOpen}]),onClick:t[0]||(t[0]=u=>e.isOpen=!e.isOpen)},Ft,2))]),e.isOpen?(f(),P("div",Mt,[G(l)])):K("",!0)]),n("div",Nt,[n("div",Bt,j(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swapRouterLoading?(f(),Z(r,{key:1,paragraph:!1,active:""})):(f(),P("div",Ot,j(e.fixedFromCoin?("addCommom"in e?e.addCommom:ne(X))(("sFixD"in e?e.sFixD:ne(Ie))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:ne(X))(("sFixD"in e?e.sFixD:ne(Ie))(e.maximumSold,e.fromCoin.decimals)))+" "+j(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),e.insufficientLiquidity?K("",!0):(f(),P("div",Lt,[Ut,e.swapRouterLoading?(f(),Z(r,{key:1,paragraph:!1,active:""})):(f(),P("div",{key:0,class:"text text-bg",onClick:t[1]||(t[1]=Uo(u=>e.store.setIsShowRouterModal(!e.isShowRouterModal),["stop"]))},[!e.swapRouterLoading&&e.suiPreSwapData&&e.suiPreSwapData.routes&&e.suiPreSwapData.routes.length==1?(f(),P("div",Et,[n("span",null,j(e.onlyOneRouteText),1),(f(!0),P(He,null,Ge(e.sourcesArr,u=>{var $,b;return f(),P("img",{key:u,src:(b=($=e.liquiditySourceObj)==null?void 0:$[u])==null?void 0:b.logo,alt:u},null,8,jt)}),128))])):e.swapRouterLoading?K("",!0):(f(),P("div",Dt,[_e(j((g=(S=e.suiPreSwapData)==null?void 0:S.routes)==null?void 0:g.length)+" Streams ",1),(f(!0),P(He,null,Ge(e.sourcesArr,u=>{var $,b;return f(),P("img",{key:u,src:(b=($=e.liquiditySourceObj)==null?void 0:$[u])==null?void 0:b.logo,alt:u},null,8,qt)}),128))])),Wt]))])),e.isShowRouterModal?(f(),Z(a,{key:1,"sui-pre-swapdata":e.suiPreSwapData,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,onOnClose:t[2]||(t[2]=u=>e.store.setIsShowRouterModal(!1))},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount"])):K("",!0)])):K("",!0)}const Ao=me(It,[["render",Vt],["__scopeId","data-v-65c993d3"]]),zt=de({components:{Modal:Eo,CoinImg:so,CurrentPrice:no,ShowInfoImpact:Io},props:{isShowAccept:{type:Boolean,default:!1}},setup(e,t){const p=Re(),s=o(()=>p),c=Se(),w=o(()=>c),i=U(!1),l=o(()=>w.value.chainName),r=async()=>{t.emit("to-swap")},a=U(0),{suiPriceImpact:S}=$o(),g=ue(),u=o(()=>g),$=o(()=>w.value.slippage),b=o(()=>u.value.minimumReceived),_=o(()=>u.value.maximumSold),A=o(()=>u.value.fromCoin),F=o(()=>u.value.toCoin),I=o(()=>u.value.fromCoinAmount),D=o(()=>u.value.toCoinAmount),h=o(()=>u.value.oneFromAmount),d=o(()=>u.value.oneToAmount),k=o(()=>u.value.fixedFromCoin),C=o(()=>u.value.swapRouterLoading),B=U(""),v=o(()=>{var m,y,R,L,T,W,Y,z;return(y=(m=s==null?void 0:s.value)==null?void 0:m.tokensObj[A==null?void 0:A.value.address])!=null&&y.pyth_id&&((L=(R=s==null?void 0:s.value)==null?void 0:R.tokensObj[A==null?void 0:A.value.address])==null?void 0:L.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(W=(T=s==null?void 0:s.value)==null?void 0:T.tokensObj[A==null?void 0:A.value.address])!=null&&W.coingecko_id?"coingecko":(z=(Y=s==null?void 0:s.value)==null?void 0:Y.tokensObj[A==null?void 0:A.value.address])!=null&&z.birdeyeid?"birdeye":null}),N=o(()=>{var m,y,R,L,T,W,Y,z;return(y=(m=s==null?void 0:s.value)==null?void 0:m.tokensObj[F==null?void 0:F.value.address])!=null&&y.pyth_id&&((L=(R=s==null?void 0:s.value)==null?void 0:R.tokensObj[F==null?void 0:F.value.address])==null?void 0:L.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(W=(T=s==null?void 0:s.value)==null?void 0:T.tokensObj[F==null?void 0:F.value.address])!=null&&W.coingecko_id?"coingecko":(z=(Y=s==null?void 0:s.value)==null?void 0:Y.tokensObj[F==null?void 0:F.value.address])!=null&&z.birdeyeid?"birdeye":null}),E=async()=>{var R;const m=s.value.tokenExternalPriceObj[A==null?void 0:A.value.address],y=s.value.tokenExternalPriceObj[(R=F.value)==null?void 0:R.valaddress];if(m&&y){const L=new M(m).div(new M(y)),T=new M(d.value.replace(new RegExp(/,/g),"")).sub(L).div(L).mul(100);let W=Math.abs(Ie(T,2));L.toNumber()<Number(d.value.replace(new RegExp(/,/g),""))?B.value="":B.value=T>0&&T<=.01?"0.01":W}else B.value=""},O=m=>{if(m<5)return"color-s";if(m>=5&&m<10)return"color-w";if(m>=10)return"color-e"};ae(()=>[d.value,s.value.tokenExternalPriceObj,l.value],([m,y,R])=>{m&&y&&!re(y)&&E()},{immediate:!0,deep:!0});const q=U(!1);return{impact:S,fromCoin:A,toCoin:F,fromCoinAmount:I,toCoinAmount:D,oneFromAmount:h,oneToAmount:d,slippage:$,fixedFromCoin:k,swapRouterLoading:C,addCommom:X,sFixD:Ie,rateChange:i,chainName:l,clickNextBtn:r,pathLength:a,maximumSold:_,minimumReceived:b,decimalUi:ce,getTextColor:O,priceExangeRate:B,formCoinMarket:v,toCoinMarket:N,readWithin:q}}});const Pe=e=>(he("data-v-ad16b751"),e=e(),ge(),e),Ht=Pe(()=>n("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Gt={class:"new-swap-contnet"},Kt={class:"coin-info"},Yt={class:"from-coin-info"},Jt={class:"left"},Xt={class:"coin-amount"},Zt={class:"coin-symbol"},Qt={class:"right"},xt={class:"to-coin-info"},en={class:"left"},on={class:"coin-amount"},tn={class:"coin-symbol"},nn={class:"right"},sn=Pe(()=>n("div",{class:"to-swap-logo"},null,-1)),an={class:"coin-rate"},rn={key:0,class:"price-impact"},ln=Pe(()=>n("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),un=[ln],cn=Pe(()=>n("br",null,null,-1)),dn={class:"bottom"},mn={class:"induction"},pn={class:"item"},vn={class:"induction-text"},fn={class:"induction-value"},hn={class:"item"},gn={class:"induction-text"},wn={class:"induction-value"},Sn={class:"item"},Cn={key:0,class:"within-desc"},kn=Pe(()=>n("div",{class:"within-top"},[n("img",{src:Ko,alt:""}),n("span",null,"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?")],-1)),bn={class:"within-bottom"},yn={key:0,class:"price-updated"},_n=Pe(()=>n("span",null,"Price updated",-1));function $n(e,t,p,s,c,w){const i=oe("CoinImg"),l=oe("CurrentPrice"),r=oe("ShowInfoImpact"),a=to,S=oe("Modal");return f(),Z(S,{width:"440px",visible:!0,footer:null,title:e.$t("button.swap"),class:"add-liquidity-modal",onCancel:t[4]||(t[4]=g=>e.$emit("on-close"))},{closeIcon:se(()=>[Ht]),default:se(()=>{var g,u,$,b;return[n("div",Gt,[n("div",Kt,[n("div",Yt,[n("div",Jt,[n("div",Xt,j(e.fromCoinAmount&&("addCommom"in e?e.addCommom:ne(X))(e.fromCoinAmount)),1),n("div",Zt,j(e.fromCoin&&e.fromCoin.symbol),1)]),n("div",Qt,[(g=e.fromCoin)!=null&&g.address?(f(),Z(i,{key:0,url:(u=e.fromCoin)==null?void 0:u.logoURI,size:"28px"},null,8,["url"])):K("",!0)])]),n("div",xt,[n("div",en,[n("div",on,j(e.toCoinAmount&&("addCommom"in e?e.addCommom:ne(X))(e.toCoinAmount)),1),n("div",tn,j(e.toCoin&&e.toCoin.symbol),1)]),n("div",nn,[($=e.toCoin)!=null&&$.address?(f(),Z(i,{key:0,url:(b=e.toCoin)==null?void 0:b.logoURI,size:"28px"},null,8,["url"])):K("",!0)]),sn]),n("div",an,[G(l,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"one-to-amount":e.oneToAmount,"one-from-amount":e.oneFromAmount},null,8,["from-coin","to-coin","one-to-amount","one-from-amount"]),e.impact>=10&&e.fromCoinAmount&&e.toCoinAmount&&!e.swapLoading?(f(),P("div",rn,[(f(),P("svg",{class:fe(["icon warning-icon",e.impact>=10&&e.impact<30?"impact-w":e.impact>=30?"impact-e":""]),"ria-hidden":"true"},un,2)),n("span",{class:fe(["pc-impact-tips",e.impact>=10&&e.impact<30?"impact-w":e.impact>=30?"impact-e":""])},"Price Impact Alert. Be cautious before submitting your order.",2),n("span",{class:fe(["h5-impact-tips",e.impact>=10&&e.impact<30?"impact-w":e.impact>=30?"impact-e":""])},[_e("Price Impact Alert."),cn,_e(" Be cautious before submitting your order.")],2)])):K("",!0)])]),n("div",dn,[n("div",mn,[n("div",pn,[n("div",vn,j(e.$t("modal.slippageTolerance")),1),n("div",fn,j(e.slippage)+"%",1)]),n("div",hn,[n("div",gn,j(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),n("div",wn,j(e.fixedFromCoin?("addCommom"in e?e.addCommom:ne(X))(("sFixD"in e?e.sFixD:ne(Ie))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:ne(X))(("sFixD"in e?e.sFixD:ne(Ie))(e.maximumSold,e.fromCoin.decimals)))+" "+j(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),n("div",Sn,[G(r)])])]),e.priceExangeRate&&Number(e.priceExangeRate)>10?(f(),P("div",Cn,[kn,n("div",bn,[n("div",{class:fe(["within-btn",e.readWithin?"within-btn-active":""]),onClick:t[0]||(t[0]=_=>e.readWithin=!0)}," Yes, please continue. ",2),n("div",{class:"within-btn",onClick:t[1]||(t[1]=_=>e.$emit("on-close"))},"No, cancel it.")])])):K("",!0)]),e.isShowAccept?(f(),P("div",yn,[_n,G(a,{class:"accept-btn",loading:e.swapLoading,onClick:t[2]||(t[2]=_=>e.$emit("accept"))},{default:se(()=>[_e("Accept")]),_:1},8,["loading"])])):e.chainName=="Sui"?(f(),Z(a,{key:1,class:"big-btn swap-confirm-btn",disabled:Number(e.priceExangeRate)>10&&!e.readWithin,onClick:t[3]||(t[3]=_=>e.clickNextBtn())},{default:se(()=>[_e(j(e.$t("button.confirmSwap")),1)]),_:1},8,["disabled"])):K("",!0)]}),_:1},8,["title"])}const To=me(zt,[["render",$n],["__scopeId","data-v-ad16b751"]]);function In(){const e=ue(),t=o(()=>e),p=Ke(),s=o(()=>p),c=Re(),w=o(()=>c),i=o(()=>v.chainName),{getSuiAmount:l}=_o(),{setToCoinAmount:r,setFromCoinAmount:a}=e,{setCountdown:S,setRefresh:g}=e,u=U(20),$=U(null),b=o(()=>t.value.countdown),_=o(()=>t.value.refresh),A=o(()=>t.value.isRouterProgress),F=o(()=>ve&&ve[i.value]&&ve[i.value].hasRouter),I=o(()=>t.value.swapPoolInfo),D=o(()=>t.value.fixedFromCoin),h=o(()=>t.value.fromCoinAmount),d=o(()=>t.value.toCoinAmount),k=o(()=>t.value.isSwapConfirmModal),C=U(!1),B=o(()=>v.includeRoutes),v=Se(),N=o(()=>v.liquiditySourceList),E=o(()=>i.value?wo(i.value):{}),O=T=>{T&&T.length>0?T.every(Y=>Y.name=="Cetus"?!0:Y.status==="close")?e.setPlusChecked("close"):e.setPlusChecked("open"):e.setPlusChecked("close"),C.value=!1},q=T=>{e.setPlusChecked(e.plusChecked=="open"?"close":"open"),localStorage.setItem("plusChecked",e.plusChecked);const W=B.value,Y=N.value;Y.forEach(z=>{T?z.status="open":z.name!=="Cetus"?z.status="close":z.status="open"}),v.setAggregatorSetting(Y,W)},m=()=>{const T=window.innerWidth,W=window.innerHeight,Y=document.getElementById("plusModeSwitch"),z=Y==null?void 0:Y.getBoundingClientRect(),V=z==null?void 0:z.left,we=z==null?void 0:z.top,Ce=2,$e=Ee.shapeFromText({text:"ðŸŸ¢",scalar:Ce}),De=Ee.shapeFromText({text:"ðŸ”µ",scalar:Ce}),Qe=Ee.shapeFromText({text:"ðŸ’š",scalar:Ce}),ke=Ee.shapeFromText({text:"ðŸ’™",scalar:Ce});Ee({particleCount:40,spread:60,shapes:[$e,De,Qe,ke],scalar:Ce,origin:{x:V/T,y:we*1.2/W}})},y=T=>{a(""),r(""),T&&m(),q(T),setTimeout(()=>{l()},500)},R=()=>{var T,W,Y;_.value||!I.value&&!F.value||(clearInterval($.value),S(0),g(!0),A.value||l(D.value?h.value:d.value),s.value.address&&E.value.getAccount(s.value.address),setTimeout(()=>{g(!1),L()},1e3),(!((T=w==null?void 0:w.value)!=null&&T.RATES)||re((W=w==null?void 0:w.value)==null?void 0:W.RATES))&&((Y=w==null?void 0:w.value)==null||Y.setRates("Sui")))},L=()=>{$.value=setInterval(()=>{if(g(!1),b.value<u.value){const T=b.value+1;S(T),b.value===u.value&&(k.value||R(),S(0),g(!0))}},1e3)};return{setMarketTimer:L,clickRefresh:R,marketTimer:$,autoRefreshTime:u,isShowAggregatorModal:C,clickChecked:q,modalConfirm:O,handleSwitchPlusMode:y}}const An=de({components:{AggregatorSettingModal:Yo},setup(){const e=Se(),t=ue(),p=o(()=>t),{isShowAggregatorModal:s,handleSwitchPlusMode:c,setMarketTimer:w,autoRefreshTime:i,clickRefresh:l,marketTimer:r}=In(),a=o(()=>p.value.countdown),S=o(()=>p.value.refresh),g=o(()=>e.slippage);let u=U(!1);return oo(()=>{w()}),jo(()=>{clearInterval(r.value)}),{slippage:g,countdown:a,refresh:S,isShowAggregatorModal:s,handleSwitchPlusMode:c,suiSwapStore:t,clickRefresh:l,isShowSwapSetting:u,autoRefreshTime:i,marketTimer:r}}});const Fe=e=>(he("data-v-09835e43"),e=e(),ge(),e),Tn={class:"plus-setting-container"},Rn={class:"plus-setting"},Pn=Fe(()=>n("div",{class:"price-reference-text"}," The Plus Mode will aggregate external liquidity sources ",-1)),Fn={class:fe("icon-bg plus-switch")},Mn=Fe(()=>n("p",null,[n("span",null,"Plus Mode")],-1)),Nn={class:"sui-setting-box"},Bn=Fe(()=>n("div",{class:"new-style-tooltip-text"},"Swap Settings",-1)),On=Fe(()=>n("div",{class:"icon-bg"},[n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon_set"})])],-1)),Ln=Fe(()=>n("div",{class:"new-style-tooltip-text"},"Slippage Settings",-1)),Un={class:"icon-bg"},En=Fe(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_verticalslider"})],-1)),jn={class:"icon-bg"};function Dn(e,t,p,s,c,w){const i=Do,l=Ye,r=xo,a=et,S=oe("AggregatorSettingModal");return f(),P("div",Tn,[n("div",Rn,[G(l,{"overlay-class-name":"price-impact-tooltip"},{title:se(()=>[Pn]),default:se(()=>[n("div",Fn,[Mn,G(i,{id:"plusModeSwitch",checked:e.suiSwapStore.plusChecked=="open",onClick:t[0]||(t[0]=g=>{e.handleSwitchPlusMode(g)})},null,8,["checked"])])]),_:1}),n("div",Nn,[n("div",{class:"aggregator-setting",onClick:t[1]||(t[1]=g=>e.isShowAggregatorModal=!0)},[G(l,{"overlay-class-name":"new-style-tooltip"},{title:se(()=>[Bn]),default:se(()=>[On]),_:1})]),G(l,{"overlay-class-name":"new-style-tooltip"},{title:se(()=>[Ln]),default:se(()=>[n("div",{class:"slippage-icon",onClick:t[2]||(t[2]=g=>e.isShowSwapSetting=!0)},[n("div",Un,[En,n("span",null,j(e.slippage)+"%",1)])])]),_:1}),n("div",jn,[G(r,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])])]),e.isShowSwapSetting?(f(),Z(a,{key:0,onOnClose:t[3]||(t[3]=g=>e.isShowSwapSetting=!1)})):K("",!0),e.isShowAggregatorModal?(f(),Z(S,{key:1,onClose:t[4]||(t[4]=g=>e.isShowAggregatorModal=!1),onModalConfirm:t[5]||(t[5]=g=>{e.modalConfirm(g)})})):K("",!0)])}const qn=me(An,[["render",Dn],["__scopeId","data-v-09835e43"]]),Wn=de({components:{TokenWarningNew:yo,CoinImg:so},props:{tokenInfo:{type:Object,default:null},hasArrow:{type:Boolean,default:!0},hasOpcity:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},setup(e,t){const{t:p,locale:s}=Xe(),c=o(()=>{var l,r;return((l=e.tokenInfo)==null?void 0:l.labels)&&((r=e.tokenInfo)==null?void 0:r.labels[0])||""}),w=o(()=>{var l;return(l=e.tokenInfo)==null?void 0:l.decimals});return{currentIcon:o(()=>{var l,r;return((l=e.tokenInfo)==null?void 0:l.logo_url)||((r=e.tokenInfo)==null?void 0:r.logoURI)||""}),coinLabels:c,t:p,coinDecimals:w}}});const Vn=e=>(he("data-v-a1d941b3"),e=e(),ge(),e),zn={key:0,class:"show-token"},Hn={class:"name-labels"},Gn={class:"name"},Kn={key:0,class:"labels"},Yn={key:1,class:"loading-token"},Jn={key:2,class:"icon","aria-hidden":"true"},Xn=Vn(()=>n("use",{"xlink:href":"#icon-icon_on"},null,-1)),Zn=[Xn];function Qn(e,t,p,s,c,w){var S,g;const i=oe("CoinImg"),l=oe("TokenWarningNew"),r=qo,a=Je;return f(),P("div",{class:fe(["token-dropdown-select",[e.hasArrow?"":"nohands",e.hasOpcity&&!e.isLoading?"left-opcity":""].join(" ")]),onClick:t[0]||(t[0]=u=>e.hasArrow&&!e.isLoading?e.$emit("onSelect"):"")},[e.isLoading?(f(),P("div",Yn,[G(r,{size:"small",paragraph:!1}),G(a,{loading:!0,class:"loading-token-skeleton",active:"",paragraph:!1})])):(f(),P("div",zn,[(S=e.tokenInfo)!=null&&S.address?(f(),Z(i,{key:0,url:e.currentIcon,size:"28px"},null,8,["url"])):K("",!0),G(l,{token:e.tokenInfo,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"0px"}},null,8,["token"]),n("div",Hn,[n("p",Gn,j(e.tokenInfo?(g=e.tokenInfo)==null?void 0:g.symbol:e.$t("modal.selectTokenModalTitle")),1),e.coinLabels?(f(),P("p",Kn,j(e.coinLabels),1)):K("",!0)])])),e.hasArrow?(f(),P("svg",Jn,Zn)):K("",!0)],2)}const xn=me(Wn,[["render",Qn],["__scopeId","data-v-a1d941b3"]]);function vo(e){const t=[];let p=e.indexOf(",");for(;p!==-1;)t.push(p),p=e.indexOf(",",p+1);return t}const es=de({components:{TokenDropdownSelect:xn},props:{titleText:{type:String,default:""},inputValue:{type:String,default:""},inputDisabled:{type:Boolean,default:!1},tokenInfo:{type:Object,default:null},havemax:{type:Boolean,default:!0},havehalf:{type:Boolean,default:!0},hasArrow:{type:Boolean,default:!0},importPage:{type:String,default:""},isShowAmountPrice:{type:Boolean,default:!0},assetsLoading:{type:Boolean,default:!1},inputLoading:{type:Boolean,default:!1}},setup(e,t){const{t:p,locale:s}=Xe(),c=o(()=>{var h,d,k;return $.value.assets&&e.tokenInfo&&$.value.assets[(h=e.tokenInfo)==null?void 0:h.address]?So($.value.assets[(d=e.tokenInfo)==null?void 0:d.address].balance,(k=e.tokenInfo)==null?void 0:k.decimals):0}),w=o(()=>new M(Number(c.value)).div(2)),i=U(""),l=()=>{var h;if(c.value){const d=Number(c.value)>0?((h=e.tokenInfo)==null?void 0:h.symbol)=="SUI"?new M(Number(c.value)).sub(new M(.05)).lt(new M(0))?"0":new M(Number(c.value)).sub(new M(.05)).toString():String(c.value):"";i.value=d,a(d)}},r=()=>{var h;if(c.value){const d=Number(c.value)>0?Ie(new M(Number(c.value)).div(2).toString(),(h=e.tokenInfo)==null?void 0:h.decimals).toString():"";i.value=d,a(d)}},a=nt(h=>{t.emit("onInput",h),t.emit("onInputLoading",!1)},500),S=h=>{const d=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${(I==null?void 0:I.value)&&(I==null?void 0:I.value)}})?).*$`),k=h.target.value.replace(/,/g,"").replace(d,"$1");k>0&&t.emit("onInputLoading",!0),a(k)},g=h=>{var q;const d=h.target.selectionStart,k=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${(I==null?void 0:I.value)&&(I==null?void 0:I.value)}})?).*$`);console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ event.target.value:",h.target.value);let C=h.target.value.replace(/,/g,"").replace(k,"$1");console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ value:",C),console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ event.inputType:",h.inputType);let B=C.includes(".")&&String(X(C))==="0"?C:String(X(C));const v=vo(h.target.value),N=vo(B),E=N.length-v.length;let O=d+E;if((q=h==null?void 0:h.inputType)!=null&&q.includes("delete")&&E>0&&d===N[N.length-1]){const m=h.target.value.slice(0,d-1)+h.target.value.slice(d);B=String(X(m.replace(/,/g,""))),O=O-2}console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ fValue:",B),i.value=B||"",setTimeout(()=>{try{h.target.setSelectionRange(O<0?0:O,O<0?0:O)}catch(m){console.log("ðŸš€ ~ file: assets-card.vue:307 ~ setTimeout ~ error:",m)}},0)};ae(()=>e.inputValue,h=>{const d=String(X(h));d!==i.value&&(i.value=d)},{immediate:!0});const u=Ke(),$=o(()=>u),b=Re(),_=o(()=>b);let A={};ae(()=>_.value.RATES,h=>{h&&(A=h)},{immediate:!0});const F=o(()=>{var k,C;const h=A&&A[(k=e.tokenInfo)==null?void 0:k.address]&&A[(C=e.tokenInfo)==null?void 0:C.address].price||0,d=new M(e.inputValue||0).mul(h).toNumber();return h<=0?0:d>0&&d<.01?"<$0.01":je(d,2)}),I=o(()=>{var h;return(h=e.tokenInfo)==null?void 0:h.decimals}),D=o(()=>_.value.isTokenLoading);return{balance:c,isTokenLoading:D,halfBalance:w,t:p,addCommom:X,wallet:$,inputChange:S,amountPirce:F,coinDecimals:I,formatNumber:fo,formattedValue:i,handleInput:g,maxBtnSelect:l,halfBtnSelect:r}}});const os=e=>(he("data-v-b547945b"),e=e(),ge(),e),ts={class:"token-input-block"},ns={class:"title"},ss={class:"card-top"},as={class:"card-bottom"},is={class:"left"},rs={key:0,class:"amount-price"},ls={key:1},us={class:"right"},cs={class:"balance"},ds=os(()=>n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_wallet1"})],-1)),ms={key:1};function ps(e,t,p,s,c,w){var S,g;const i=Wo,l=Je,r=oe("TokenDropdownSelect"),a=to;return f(),P("div",ts,[n("div",ns,j(e.titleText),1),n("div",ss,[e.inputLoading?(f(),Z(l,{key:1,class:"input-loading-skeleton",loading:!0,size:"large",active:"",paragraph:!1})):(f(),Z(i,{key:0,value:e.inputValue=="InsufficientLiquidity"?"":e.formattedValue,placeholder:"0.0",disabled:e.inputDisabled,onChange:e.inputChange,onInput:e.handleInput,onFocus:t[0]||(t[0]=u=>e.$emit("onFocus"))},null,8,["value","disabled","onChange","onInput"])),G(r,{"token-info":e.tokenInfo,"has-opcity":!0,"is-loading":e.isTokenLoading,onOnSelect:t[1]||(t[1]=u=>e.$emit("onSelect"))},null,8,["token-info","is-loading"])]),n("div",as,[n("div",is,[e.inputValue&&e.amountPirce!="--"&&(Number(e.amountPirce)>0||e.amountPirce=="<$0.01")&&e.isShowAmountPrice&&!e.inputLoading?(f(),P("div",rs,j(e.amountPirce!=="<$0.01"?`$${("formatNumber"in e?e.formatNumber:ne(fo))(e.amountPirce)}`:`${e.amountPirce}`),1)):(f(),P("div",ls,[e.inputLoading?(f(),Z(l,{key:0,class:"rate-loading-skeleton",loading:!0,size:"large",active:"",paragraph:!1})):K("",!0)]))]),n("div",us,[n("span",cs,[ds,e.assetsLoading?(f(),Z(l,{key:0,class:"token-loading-skeleton",loading:!0,active:"",paragraph:!1})):(f(),P("span",ms,j(e.wallet.connected?("addCommom"in e?e.addCommom:ne(X))(e.balance,e.coinDecimals):"0"),1))]),e.havehalf&&e.wallet.connected?(f(),Z(a,{key:0,disabled:!((S=e.tokenInfo)!=null&&S.name)||("addCommom"in e?e.addCommom:ne(X))(e.halfBalance,e.coinDecimals)==0,class:"max-btn half-btn",onClick:t[2]||(t[2]=u=>e.halfBtnSelect())},{default:se(()=>[_e("HALF")]),_:1},8,["disabled"])):K("",!0),e.havemax&&e.wallet.connected?(f(),Z(a,{key:1,disabled:!((g=e.tokenInfo)!=null&&g.name)||("addCommom"in e?e.addCommom:ne(X))(e.balance,e.coinDecimals)==0,class:"max-btn",onClick:t[3]||(t[3]=u=>e.maxBtnSelect())},{default:se(()=>[_e("MAX")]),_:1},8,["disabled"])):K("",!0)])])])}const vs=me(es,[["render",ps],["__scopeId","data-v-b547945b"]]),fs=de({components:{TokenInputBlock:vs},setup(){const e=U(!0),t=U(!1),p=ue(),s=o(()=>p),c=Se();o(()=>c);const{setFromCoin:w,setToCoin:i,setFixedFromCoin:l,setFromCoinAmount:r,setToCoinAmount:a}=s.value,S=U("fromCoin"),g=U(""),u=U(""),$=U(!1),b=o(()=>s.value.fromCoin),_=o(()=>s.value.toCoin),A=o(()=>s.value.fromCoinAmount),F=o(()=>s.value.toCoinAmount),I=o(()=>s.value.fixedFromCoin),D=o(()=>s.value.swapRouterLoading),h=o(()=>s.value.plusChecked);let d=U(!1);function k(){const m=b.value;w(_.value),i(m),d.value=!0,h.value=="open"?l(!0):l(!I.value),I.value?(r(F.value),a("")):(a(A.value),r("")),setTimeout(()=>{d.value=!1},300)}const C=m=>{var y,R,L,T;S.value=m,m==="fromCoin"?(g.value=((y=_.value)==null?void 0:y.address)||"",u.value=((R=b.value)==null?void 0:R.address)||""):(g.value=((L=b.value)==null?void 0:L.address)||"",u.value=((T=_.value)==null?void 0:T.address)||""),$.value=!0},B=U({}),v=U({}),N=m=>{S.value==="fromCoin"?(B.value=m,q(m)):(v.value=m,q(m))},E=U(!1),O=()=>{v.value={},B.value={},E.value=!1},q=m=>{const y=c.importTokenListObj;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1499 ~ getTokenSource ~ !importTokenListObj?.hasOwnProperty(token?.address):",!(y!=null&&y.hasOwnProperty(m==null?void 0:m.address))),m!=null&&m.isSelfBuilt&&!(y!=null&&y.hasOwnProperty(m==null?void 0:m.address)))E.value=!0;else{if(S.value==="fromCoin"){_.value&&m.address.toLowerCase()===(_==null?void 0:_.value.address.toLowerCase())&&i(null),w(m);const R=Number(A.value)>0?ce(A.value,m==null?void 0:m.decimals):"";r(R)}else{b.value&&m.address.toLowerCase()===(b==null?void 0:b.value.address.toLowerCase())&&w(null),i(m);const R=Number(F.value)>0?ce(F.value,m==null?void 0:m.decimals):"";a(R)}O()}};return{fixedFromCoin:I,swapRouterLoading:D,onCoinSelect:N,existingCoins:g,lastSelectCoin:u,currentCoinKey:S,showCoinSelect:$,openCoinSelect:C,warningToCoin:v,warningFromCoin:B,isAddCardTopPadding:e,isAddCardBottomPadding:t,suiSwapStore:p,clickExchange:k,closeTokenWarning:O,isShowTokenWarning:E,getTokenSource:q,change:d,fromCoin:b,toCoin:_,fromCoinAmount:A,toCoinAmount:F}}});const Ro=e=>(he("data-v-ce82e847"),e=e(),ge(),e),hs={class:"input-block-container"},gs=Ro(()=>n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_swap1"})],-1)),ws=Ro(()=>n("svg",{class:"icon icon-swap","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-tx_swap1"})],-1)),Ss=[gs,ws];function Cs(e,t,p,s,c,w){const i=oe("TokenInputBlock"),l=ot,r=tt;return f(),P("div",hs,[n("div",{class:fe(["asset-card-box",[e.suiSwapStore.plusChecked=="open"?"toInputBlockDisabled input-block-add-top":"",e.isAddCardTopPadding?"input-block-add-top":"",e.isAddCardBottomPadding&&e.suiSwapStore.plusChecked!=="open"?"input-block-add-bottom":""]])},[G(i,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[0]||(t[0]=a=>e.fromCoinAmount=a),"title-text":"You pay","input-value":e.fromCoinAmount,"token-info":e.fromCoin||null,"input-loading":!e.fixedFromCoin&&e.swapRouterLoading,onOnInput:t[1]||(t[1]=a=>{e.suiSwapStore.setFromCoinAmount(a),e.suiSwapStore.setFixedFromCoin(!0)}),onOnFocus:t[2]||(t[2]=()=>{e.suiSwapStore.setFixedFromCoin(!0),e.isAddCardTopPadding=!0,e.isAddCardBottomPadding=!1}),onOnSelect:t[3]||(t[3]=a=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","token-info","input-loading"]),G(i,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[4]||(t[4]=a=>e.toCoinAmount=a),"title-text":"You receive","input-value":e.toCoinAmount,"token-info":e.toCoin||null,"input-disabled":e.suiSwapStore.plusChecked=="open",havemax:!1,havehalf:!1,"input-loading":!e.fixedFromCoin&&e.swapRouterLoading,onOnInput:t[5]||(t[5]=a=>{e.suiSwapStore.setToCoinAmount(a),e.suiSwapStore.setFixedFromCoin(!1)}),onOnFocus:t[6]||(t[6]=()=>{e.suiSwapStore.setFixedFromCoin(!1),e.isAddCardTopPadding=!1,e.isAddCardBottomPadding=!0}),onOnSelect:t[7]||(t[7]=a=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","token-info","input-disabled","input-loading"]),n("div",{class:"exchange",onClick:t[8]||(t[8]=(...a)=>e.clickExchange&&e.clickExchange(...a))},Ss)],2),e.showCoinSelect?(f(),Z(l,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,"have-import-btn":!0,onOnSelect:e.onCoinSelect,onOnClose:t[9]||(t[9]=a=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):K("",!0),e.isShowTokenWarning?(f(),Z(r,{key:1,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,"is-import-modal":!0,onClose:e.closeTokenWarning,onClickContinue:e.getTokenSource},null,8,["from-coin","to-coin","onClose","onClickContinue"])):K("",!0)])}const ks=me(fs,[["render",Cs],["__scopeId","data-v-ce82e847"]]);function bs(){const e=ue(),t=o(()=>e),p=o(()=>t.value.fromCoin),s=o(()=>t.value.toCoin),{allTokensObj:c}=ao(),w=o(()=>p.value.logoURI),i=o(()=>s.value.logoURI),l=o(()=>p.value&&p.value.address||null),r=o(()=>s.value&&s.value.address||null),a=o(()=>{var g,u,$,b,_,A,F,I;return console.log("ðŸš€ðŸš€ðŸš€ ~ file: swap.vue:1222 ~ formCoinMarket ~ allTokensObj:",c),(u=c[(g=p==null?void 0:p.value)==null?void 0:g.address])!=null&&u.pyth_id&&((b=c[($=p==null?void 0:p.value)==null?void 0:$.address])==null?void 0:b.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(A=c[(_=p==null?void 0:p.value)==null?void 0:_.address])!=null&&A.coingecko_id?"coingecko":(I=c[(F=p==null?void 0:p.value)==null?void 0:F.address])!=null&&I.birdeyeid?"birdeye":null}),S=o(()=>{var g,u,$,b,_,A,F,I;return(u=c[(g=s==null?void 0:s.value)==null?void 0:g.address])!=null&&u.pyth_id&&((b=c[($=s==null?void 0:s.value)==null?void 0:$.address])==null?void 0:b.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(A=c[(_=s==null?void 0:s.value)==null?void 0:_.address])!=null&&A.coingecko_id?"coingecko":(I=c[(F=s==null?void 0:s.value)==null?void 0:F.address])!=null&&I.birdeyeid?"birdeye":null});return{formCoinId:l,toCoinId:r,formCoinMarket:a,toCoinMarket:S,fromCoinUrl:w,toCoinUrl:i}}const ys=de({components:{TokenWarningNew:yo,CoinImg:so},props:{tokenInfo:{type:Object,default:null},isHaveLabel:{type:Boolean,default:!1},justifyContent:{type:String,default:"flex-end"}},setup(e,t){const{t:p,locale:s}=Xe(),c=o(()=>{var i;return(i=e.tokenInfo)==null?void 0:i.decimals});return{currentIcon:o(()=>{var i,l;return((i=e.tokenInfo)==null?void 0:i.logo_url)||((l=e.tokenInfo)==null?void 0:l.logoURI)||""}),t:p,coinDecimals:c}}});const _s={class:"coin-pair-container"},$s={class:"logo-token-warning"},Is={class:"symbol-label-name"},As={class:"symbol-label"},Ts={class:"symbol"},Rs={class:"name"};function Ps(e,t,p,s,c,w){var r,a,S,g,u,$,b;const i=oe("CoinImg"),l=oe("TokenWarningNew");return f(),P("div",_s,[n("div",{class:"show-token",style:Vo({justifyContent:e.justifyContent})},[n("div",$s,[(r=e.tokenInfo)!=null&&r.address?(f(),Z(i,{key:0,url:e.currentIcon,size:"36px"},null,8,["url"])):K("",!0),G(l,{token:e.tokenInfo,"style-params":{width:"16px",height:"16px"}},null,8,["token"])]),n("div",Is,[n("div",As,[n("p",Ts,j(e.tokenInfo?(a=e.tokenInfo)==null?void 0:a.symbol:e.$t("modal.selectTokenModalTitle")),1),e.isHaveLabel&&((S=e.tokenInfo)!=null&&S.labels)&&((g=e.tokenInfo)!=null&&g.labels[0])?(f(),P("div",{key:0,class:fe(["label",(u=e.tokenInfo)==null?void 0:u.labels[0]])},j(($=e.tokenInfo)==null?void 0:$.labels[0]),3)):K("",!0)]),n("p",Rs,j((b=e.tokenInfo)==null?void 0:b.name),1)])],4)])}const Fs=me(ys,[["render",Ps],["__scopeId","data-v-d90e2ce2"]]),Ms=de({components:{CoinSingle:Fs},props:{coin:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},id:{type:String,default:""},market:{type:String,default:""}},setup(e){const t=o(()=>r.value.currentExplorer),{$echarts:p}=zo(),s=go();let c=null,w;const i=U(!0),l=Se(),r=o(()=>l),a=o(()=>r.value.chainName),S=o(()=>ve[a.value]),g=Re();o(()=>g);const{allTokensObj:u}=ao(),$=(k,C,B)=>{w={xAxis:{type:"category",boundaryGap:!1,show:!1,data:C},yAxis:{type:"value",show:!1,min:function(v){return v.min-v.min*.1},max:function(v){return v.max+v.max*.1}},grid:{top:1,right:1,bottom:1,left:1},tooltip:{trigger:"axis",borderWidth:0,padding:0,backgroundColor:"transparent",axisPointer:{lineStyle:{color:r.value.chainName=="Aptos"?"#68FFD8":"#76C8FF"}},formatter:function(v){return`<div class="chart-tip">
              <div>${v&&v[0]&&v[0].name}</div>
              <div>$${ce(v&&v[0]&&v[0].value,4)}</div>
            </chart-tip>`}},color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:r.value.chainName=="Aptos"?"#0C4535":"#2E546D"},{offset:1,color:r.value.chainName=="Aptos"?"#151817":"#1B1B1B"}]},series:[{data:k,type:"line",showSymbol:!1,areaStyle:{},lineStyle:{color:r.value.chainName=="Aptos"?"#68FFD8":"#76C8FF",width:2,type:"solid"}}]},w&&c.clear(),w&&c.setOption(w,!0),c.resize(),i.value=!1},b=U(""),_=U(""),A=async k=>{var q,m,y;const C=[],B=[],{price:v,daily_rate:N}=await Jo(k,e.market);g.setTokenExternalPrice(e.coin.address,(q=v[v.length-1])==null?void 0:q.price),b.value=N;const E=v&&v.length>=1&&v[v.length-1].price;_.value=E,s.setCurrentCoinPairRate({[k]:E}),a.value==="Aptos"?v.forEach(R=>{C.push(R.price);const L=Ve(Number(R.timestamp),"MD"),T=Ve(Number(R.timestamp),"HM");B.push(L+" "+T)}):v.forEach(R=>{C.push(R.price);const L=Ve(new M(R.timestamp).mul(1e3).toNumber(),"MD"),T=Ve(new M(R.timestamp).mul(1e3).toNumber(),"HM");B.push(L+" "+T)});let O=document.getElementById(`main${(m=e.coin)==null?void 0:m.name}`);c=p.init(O),p.use([st]),$(C,B,(y=e.coin)==null?void 0:y.name)};ae(()=>e.id,(k,C)=>{k&&(b.value="",_.value="",setTimeout(()=>{A(k)},1e3))},{immediate:!0});const F=U(""),I=U(""),D=U(""),h=U("");ae(()=>[u,e.coin],([k,C])=>{var B,v;k&&C&&k[C.address]&&(I.value=((B=k[C.address])==null?void 0:B.labels)&&((v=k[C.address])==null?void 0:v.labels[0]),F.value=k[C.address].name,D.value=k[C.address].symbol,h.value=k[C.address].address)},{immediate:!0,deep:!0}),ae(()=>e.refresh,k=>{k&&A(e.id)});const d=o(()=>r.value.theme);return{currentExplorer:t,getExplorerUrl:Co,theme:d,store:l,fixD:je,config:S,price_rate_24h:b,nowPrice:_,coinName:F,coinLabels:I,coinSymbol:D,address:h,decimalUi:ce,addCommom:X}}});const Po=e=>(he("data-v-0d5aec5c"),e=e(),ge(),e),Ns={class:"price-token-chart"},Bs={class:"top"},Os={class:"right"},Ls={class:"price-info"},Us={key:0,src:Xo,alt:""},Es={key:1,src:Zo,alt:""},js={key:2,src:Qo,alt:""},Ds={class:"bottom"},qs={class:"left"},Ws={class:"address"},Vs={key:0,class:"pc-address"},zs={key:1,class:"pc-address"},Hs={class:"h5-address"},Gs=Po(()=>n("use",{"xlink:href":"#icon-icon_copy2"},null,-1)),Ks=[Gs],Ys=["href"],Js=Po(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_link"})],-1)),Xs=[Js],Zs={class:"right"},Qs=["id"];function xs(e,t,p,s,c,w){var r;const i=oe("CoinSingle"),l=Ye;return f(),P("div",Ns,[n("div",Bs,[G(i,{"token-info":e.coin},null,8,["token-info"]),n("div",Os,[G(l,{placement:"top","arrow-point-at-center":""},{title:se(()=>[_e(j(e.market==="pyth"?"Data source: Pyth Network":e.market==="coingecko"?"Data source: CoinGecko":"Data source: Birdeye"),1)]),default:se(()=>[n("div",Ls,[e.market==="pyth"?(f(),P("img",Us)):e.market==="coingecko"?(f(),P("img",Es)):e.market==="birdeye"?(f(),P("img",js)):K("",!0),n("span",null,"$"+j(e.nowPrice?Number(e.nowPrice)<1?("decimalUi"in e?e.decimalUi:ne(ce))(e.nowPrice,4):("addCommom"in e?e.addCommom:ne(X))(("fixD"in e?e.fixD:ne(je))(e.nowPrice,2)):"--"),1),e.price_rate_24h?(f(),P("i",{key:3,class:fe(e.price_rate_24h>0?"up":e.price_rate_24h<0?"down":"up")},j(e.price_rate_24h<0?+`${("fixD"in e?e.fixD:ne(je))(e.price_rate_24h,2)}`:`+ ${("fixD"in e?e.fixD:ne(je))(e.price_rate_24h,2)}`)+"%",3)):K("",!0)])]),_:1})])]),n("div",Ds,[n("div",qs,[n("div",Ws,[e.coin&&e.address!=="0x2::sui::SUI"?(f(),P("span",Vs,j(e.coin&&e.coin.address.substr(0,8))+" ... "+j(e.coin&&e.coin.address.substr(e.coin.address.length-8,8)),1)):(f(),P("span",zs,j(e.coin&&e.coin.address),1)),n("span",Hs,j(e.coin&&e.coin.address.substr(0,4))+" ... "+j(e.coin&&e.coin.address.substr(e.coin.address.length-4,4)),1),(f(),P("svg",{class:"icon","aria-hidden":"true",onClick:t[0]||(t[0]=a=>e.store.copy(e.coin&&e.coin.address))},Ks)),n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:ne(Co))(e.currentExplorer,"coin",e.coin&&e.coin.address),target:"_blank"},Xs,8,Ys)])]),n("div",Zs,[n("div",{id:`main${(r=e.coin)==null?void 0:r.name}`,class:"main"},null,8,Qs)])])])}const ea=me(Ms,[["render",xs],["__scopeId","data-v-0d5aec5c"]]),oa=de({components:{PriceTokenChart:ea},setup(){const{formCoinId:e,toCoinId:t,formCoinMarket:p,toCoinMarket:s,fromCoinUrl:c,toCoinUrl:w}=bs(),i=ue(),l=o(()=>i),r=o(()=>l.value.fromCoin),a=o(()=>l.value.toCoin);return{refresh:o(()=>l.value.refresh),fromCoin:r,toCoin:a,formCoinId:e,toCoinId:t,formCoinMarket:p,toCoinMarket:s,fromCoinUrl:c,toCoinUrl:w}}});const ro=e=>(he("data-v-e3fbe02e"),e=e(),ge(),e),ta={class:"price-reference-container"},na={class:"info-title"},sa=ro(()=>n("span",{class:"coingecko"},"Price Reference",-1)),aa=ro(()=>n("div",{class:"price-reference-text"}," The following price is only an external reference from 3rd party data providers, which does not reflect actual data on Cetus. ",-1)),ia=ro(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_tips"})],-1));function ra(e,t,p,s,c,w){const i=Ye,l=oe("PriceTokenChart");return f(),P("div",ta,[n("div",na,[sa,G(i,{"overlay-class-name":"price-impact-tooltip",placement:"top","arrow-point-at-center":""},{title:se(()=>[aa]),default:se(()=>[ia]),_:1})]),e.fromCoin&&e.formCoinMarket?(f(),Z(l,{key:0,id:e.formCoinId,coin:e.fromCoin,market:e.formCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):K("",!0),e.toCoin&&e.toCoinMarket?(f(),Z(l,{key:1,id:e.toCoinId,coin:e.toCoin,market:e.toCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):K("",!0)])}const la=me(oa,[["render",ra],["__scopeId","data-v-e3fbe02e"]]);function ua(){const{getToken:e,getTokenList:t}=bo(),p=ho(),{t:s,locale:c}=Xe(),w=Se(),i=o(()=>ko()),{allTokensObj:l}=ao(),r=ue(),a=o(()=>(console.log(r,"#suiSwapStore"),r)),{setIsSwapping:S,setIsSwapConfirmModal:g,setFromCoinAmount:u,setToCoinAmount:$,setOneFromAmount:b,setOneToAmount:_,setInsufficientLiquidity:A,setRouterPool:F,setSuiPreSwapData:I,setCountdown:D,setFromCoin:h,setToCoin:d,setFixedFromCoin:k,setRouterSwap:C,setSwapPoolInfo:B}=r;oo(()=>{t()});const v=o(()=>a.value.fromCoin),N=o(()=>a.value.toCoin),E=o(()=>a.value.fromCoinAmount),O=o(()=>a.value.toCoinAmount),q=o(()=>a.value.fixedFromCoin),m=o(()=>a.value.isSwapping),y=o(()=>a.value.swapPoolInfo),R=o(()=>a.value.swapRouterLoading),L=o(()=>a.value.notFoundRouter),T=o(()=>a.value.insufficientLiquidity),W=o(()=>a.value.isSwapConfirmModal),Y=o(()=>a.value.suiPreSwapData),z=o(()=>w.chainName),V=o(()=>w.slippage),we=o(()=>ve&&ve[z.value]&&ve[z.value].hasRouter),Ce=o(()=>$e.getPoolInfoSuccess),$e=Re(),De=o(()=>$e),Qe=Ke(),ke=o(()=>Qe),Me=o(()=>z.value?wo(z.value):{}),lo=o(()=>ke.value.assets&&v.value&&ke.value.assets[v.value.address]?So(ke.value.assets[v.value.address].balance,v.value.decimals):0),xe=o(()=>{var H;return ke.value.connected?y.value&&((H=y.value)!=null&&H.is_pause)?"Pool Closed":!v.value||!N.value?s("modal.selectTokenModalTitle"):!Number(E.value)&&!Number(O.value)?s("button.enterAmount"):!we.value&&!y.value&&Ce.value?"Pool Not Found":we.value&&L.value?"No Available Route":T.value?s("button.insufficientLiquidity"):Number(E.value)>Number(lo.value)?s("button.insufficientBalance",{name:v.value.symbol}):s("button.swap"):s("button.connectWallet")}),Fo=o(()=>{var H;return ke.value.connected?!!(m.value||!v.value||!N.value||!Number(E.value)||!Number(O.value)||Number(E.value)>Number(lo.value)||xe.value==s("button.poolNotFound")||xe.value!==s("button.swap")||(H=y==null?void 0:y.value)!=null&&H.is_pause||R.value):!1});ae(()=>l,async H=>{if(H&&!re(H)){const J=p?p.currentRoute.value.query.to:"",Q=p?p.currentRoute.value.query.from:"";if(console.log(Q,re(v.value),"!routerCoinFrom && checkNullObj(fromCoin)"),Q&&Q!=="undefined"){console.log("ðŸš€ ~ routerCoinFrom:",Q);const ie=await e(Q);h(ie)}else if(!Q&&re(v.value)){const ie=ve[z.value].swapDefaultPair.fromCoin,x=await e(ie);console.log(x,ie,"#coin"),h(x)}if(J&&J!=="undefined"){const ie=await e(J);d(ie)}else if(!J&&re(N.value)){const ie=ve[z.value].swapDefaultPair.toCoin,x=await e(ie);d(x)}!Q&&J&&h("")}},{immediate:!0}),ae(()=>[v.value,N.value,De.value.poolConfigList],([H,J,Q])=>{var ie;if(!re(H)&&!re(J)){console.log("ðŸš€ ~ fromCoin:",J,H);let x=null;const te={};Object.values(De.value.poolConfigList).forEach(ee=>{var le,be,We,Oe,Le,ye,Ae,Ue;(ee.coinA.address.toUpperCase()===((be=(le=H.value)==null?void 0:le.address)==null?void 0:be.toUpperCase())&&ee.coinB.address.toUpperCase()===((Oe=(We=J.value)==null?void 0:We.address)==null?void 0:Oe.toUpperCase())||ee.coinB.address.toUpperCase()===((ye=(Le=H.value)==null?void 0:Le.address)==null?void 0:ye.toUpperCase())&&ee.coinA.address.toUpperCase()===((Ue=(Ae=J.value)==null?void 0:Ae.address)==null?void 0:Ue.toUpperCase()))&&(te[ee.address]={...ee})});const pe=Object.values(te).sort((ee,le)=>ee.fee-le.fee);for(let ee=0;ee<pe.length;ee++)if(!((ie=pe[ee])!=null&&ie.is_pause)){x=pe[ee];break}x&&!re(x)&&(console.log("ðŸš€ ~ info:",x),B(x)),B(null)}if(B(null),Q&&Q.length>0&&H&&J){const x=[];Q.forEach(te=>{var pe,ee,le,be;(te.coinA.address.toUpperCase()===((pe=H.address)==null?void 0:pe.toUpperCase())&&te.coinB.address.toUpperCase()===((ee=J.address)==null?void 0:ee.toUpperCase())||te.coinB.address.toUpperCase()===((le=H.address)==null?void 0:le.toUpperCase())&&te.coinA.address.toUpperCase()===((be=J.address)==null?void 0:be.toUpperCase()))&&(te!=null&&te.is_pause||x.push(te.address))}),C(x)}},{immediate:!0}),ae(q,Ho((H,J)=>{k(H)},500),{immediate:!0}),ae(()=>[v.value,N.value],([H,J])=>{if(!re(H)||!re(J)){const Q=`/swap?from=${H==null?void 0:H.address}&to=${J==null?void 0:J.address}`;p.push(Q)}},{immediate:!0,deep:!0});const Ne=U(!1),uo=async H=>{var J;try{let Q;if(q.value){const te=new M(E.value).mul(Math.pow(10,v.value.decimals)).toString();Q=new ze(te)}else{const te=new M(O.value).mul(Math.pow(10,N.value.decimals)).toString();Q=new ze(te)}const ie=Number(V.value)/100,x=await((J=i==null?void 0:i.value)==null?void 0:J.getFindRouter(v,N,Q.toString(),q.value,ie,""));if(x){I(x),F(x.routes),A(!1);const te=X(ce(new M(E.value).div(new M(O.value).toString()),v.value.decimals));b(te);const pe=X(ce(new M(O.value).div(E.value).toString(),N.value.decimals));_(pe);const ee=new M(x.amountOut).div(new M(Math.pow(10,N.value.decimals))).toString(),le=new M(x.amountIn).div(new M(Math.pow(10,v.value.decimals))).toString();q.value?O.value!==ee&&(Ne.value=!0,$(ee)):E.value!==le&&(Ne.value=!0,u(le))}}catch(Q){console.log("pre swap error3",Q)}},Be=U(null);ae(()=>W.value,H=>{H?Be.value=setInterval(()=>{uo(q.value)},3e3):(clearInterval(Be.value),window.clearInterval(Be.value))},{immediate:!0});const Mo=()=>{Ne.value=!1},No=()=>{g(!1),Ne.value=!1},{setIsShowSuccess:Bo,setIsShowRejected:co,setIsShowWaiting:qe,setTransactionDesc:Oo,setTransactionTxid:mo}=w;return{isShowAccept:Ne,toSwap:async()=>{var H,J,Q,ie,x,te,pe,ee,le;g(!1),S(!0),clearInterval(Be),window.clearInterval(Be),mo(""),Oo(s("tips.swapping",{from:`${X(E.value)} ${(H=v.value)==null?void 0:H.symbol}`,to:`${X(O.value)} ${(J=N.value)==null?void 0:J.symbol}`})),qe(!0);try{const be=q.value,We=Number(V.value)/100,Oe=await((Q=i==null?void 0:i.value)==null?void 0:Q.getRouterSwapPayload(Y.value,be,We,v,N));console.log("0221####swap###swapPayload###",Oe);const Le=await Me.value.signAndExecuteTransactionBlock(ke.value.currentWallet,Oe);console.log("0221###sui swap res###",Le);const ye=Me.value.handleTx(Le);if(console.log("0221###swap###sui##tx###",ye),ye&&ye.hash){mo(ye.hash),qe(!1),Bo(!0);const Ae={title:s("tips.swap"),desc:s("tips.swapSuccessText",{from:`${X(E.value)} ${(ie=v.value)==null?void 0:ie.symbol}`,to:`${X(O.value)} ${(x=N.value)==null?void 0:x.symbol}`}),hash:ye.hash,tit:"Swap",type:"liquidity",action:"swap",isHaveSui:v.value.address==ve[z.value].currentChainTokenAddress||N.value.address==ve[z.value].currentChainTokenAddress,icon:"icon-icon-swap1",tokenInfo:{tokena:`${(te=v.value)==null?void 0:te.address}`,numa:`- ${E.value}`,logoa:l&&v.value&&v.value.address&&l[v.value.address]&&l[v.value.address].logoURI,tokenb:`${(pe=N.value)==null?void 0:pe.address}`,numb:`+ ${O.value}`,logob:l&&N.value&&N.value.address&&l[N.value.address]&&l[N.value.address].logoURI},text:`Pay ${E.value} ${(ee=v.value)==null?void 0:ee.symbol} to receive ${O.value} ${(le=N.value)==null?void 0:le.symbol}`};Ae.res=ye.res,Me.value.showTransitionPending(Ae);const Ue=await Me.value.watchTransaction(Ae);console.log("0221###swap###transitionStatus####",Ue),Ue&&setTimeout(()=>{Me.value.getAccount(ke.value.address)},1e3)}else qe(!1),co(!0);u(""),$(""),S(!1)}catch(be){u(""),$(""),S(!1),console.log("Swap Error###",be),qe(!1),co(!0)}},updateAccept:Mo,getSuiAmountAccept:uo,closeSwapConfirmModal:No,slippage:V,swapBtnText:xe,isSwapBtnDisabled:Fo}}const ca=de({components:{SwapShowInfo:Ao,UnderlineTab:at,PlusSetting:qn,TokenInputBox:ks,PriceReference:la,SwapSuiConfirm:To},setup(){const{closeSwapConfirmModal:e,isShowAccept:t,updateAccept:p,toSwap:s,swapBtnText:c,isSwapBtnDisabled:w}=ua(),i=ue(),l=o(()=>i),r=Se(),a=o(()=>r.slippage),S=o(()=>l.value.isSwapping),g=o(()=>l.value.isSwapConfirmModal),{setIsSwapConfirmModal:u}=l.value,$=ho(),b=Ke(),_=o(()=>b);return{isShowAccept:t,slippage:a,updateAccept:p,closeSwapConfirmModal:e,toSwap:s,isSwapping:S,swapBtnText:c,isSwapBtnDisabled:w,isSwapConfirmModal:g,clickSwapBtn:()=>{_.value.connected?u(!0):_.value.setIsShowWalletModal(!0)},router:$,tradeTabList:[{label:"Swap",value:"swap",link:"/swap"},{label:"Limit",value:"limit",link:"/limit"},{label:"DCA",value:"dca",link:"/dca",isHaveBeta:!0}]}}});const da=e=>(he("data-v-db6681ae"),e=e(),ge(),e),ma={class:"swap-sui-container"},pa=da(()=>n("div",{class:"bg"},null,-1));function va(e,t,p,s,c,w){const i=oe("UnderlineTab"),l=oe("PlusSetting"),r=oe("TokenInputBox"),a=to,S=Ao,g=oe("PriceReference"),u=To;return f(),P("div",ma,[pa,G(i,{"tab-list":e.tradeTabList,"current-tab":"swap",onClickTab:t[0]||(t[0]=$=>e.$router.push($.link))},null,8,["tab-list"]),G(l),G(r),G(a,{disabled:e.isSwapBtnDisabled,class:"big-btn new-big-btn",loading:e.isSwapping,onClick:t[1]||(t[1]=$=>e.clickSwapBtn())},{default:se(()=>[n("span",null,j(e.swapBtnText),1)]),_:1},8,["disabled","loading"]),G(S),G(g),e.isSwapConfirmModal?(f(),Z(u,{key:0,"is-show-accept":e.isShowAccept,onOnClose:e.closeSwapConfirmModal,onToSwap:e.toSwap,onAccept:e.updateAccept},null,8,["is-show-accept","onOnClose","onToSwap","onAccept"])):K("",!0)])}const Ga=me(ca,[["render",va],["__scopeId","data-v-db6681ae"]]);export{Ga as default};
