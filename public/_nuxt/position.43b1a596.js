import{_ as re}from"./upgrade-select-input.64b6e8a1.js";import{_ as ue}from"./upgrade-loading.0b6ccc95.js";import{_ as ie}from"./upgrade-position-item.bb0f5301.js";import{a as ce,r as p,y as de,b as me,l as m,q as R,H as ve,K as pe,R as ge,X as he,e as be,o as l,f as r,h as v,F as j,E as V,x as A,i as I,z as K,v as w,A as M,j as H,w as fe,B as _e,c as ye,p as ke,k as Le}from"./entry.61500d5d.js";import{u as Se,a as Ae,c as we}from"./sha256.7f09dfa8.js";import{u as Te}from"./notifi.e1e2a417.js";import{u as Pe,c as $e}from"./pool.c7bdc0b4.js";import{i as X}from"./import-icon.de3e6c66.js";import{_ as Z}from"./icon_on_2x.5e96733d.js";import{_ as Oe}from"./img-no-Positions_2x.1c41be11.js";import{_ as Re}from"./img-no-Positions_2x.074135fe.js";import{_ as Ue}from"./img-connect-wallet_2x.3122b16e.js";import{_ as Be}from"./img-connect-wallet_2x.9b7564c5.js";import"./coin-select.69595517.js";/* empty css              *//* empty css              */import"./token-warning_2x.28d81f1f.js";/* empty css              *//* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.dddc5aa8.js";import"./decimal.0bdeb344.js";import"./farms.5c03459f.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./useWhale.375ab066.js";const Ce=ce({setup(){const o=p(!1),{t:i}=de(),W=p(["position"]),P=me(),q=p(""),U=Se(),g=m(()=>U),E=m(()=>g.value.chainName?we[g.value.chainName]:{});let c=p([]);const _=Pe(),a=m(()=>_),y=Ae(),h=m(()=>y),D=p(!1),$=p(i("tab.all")),G=p([i("tab.layerZero"),i("tab.wormhole"),i("tab.celer")]),B=p(!0),Y=p("TVL"),z=()=>{o.value=!0,c.value=[],h.value.address&&_.getMyPositons(h.value.address,a.value.poolsObj,g.value.chainName),setTimeout(()=>{o.value=!1},1e3)},x=m(()=>{const s=Array.from(new Set(a.value.poolConfigList.flatMap(e=>!(e!=null&&e.category)||(e==null?void 0:e.category)==""?"All":e==null?void 0:e.category)));return console.log(s,"newArr"),s.length<=1?[]:s}),ee=s=>{a.value.setCurrentPoolTab(s)};R(()=>g.value.isRefresh,s=>{var e,t,n,u;s&&((u=(n=(t=(e=P==null?void 0:P.currentRoute)==null?void 0:e.value)==null?void 0:t.name)==null?void 0:n.split("-"))==null?void 0:u[1])=="position"&&z()}),ve(()=>{c.value=[],document.addEventListener("click",()=>{D.value=!1}),_.setMyPositionsLoading(!0)}),pe(()=>{document.addEventListener("click",()=>{D.value=!1})}),ge(()=>{h.value.connected||(c.value=[])});const F=()=>{o.value=!0;let s=[];a.value.myPositions.forEach(e=>{var f,T,C,N;let t,n;const u=e.amountA*((f=a.value.RATES[e.token_a.address])==null?void 0:f.price),d=e.amountB*((T=a.value.RATES[e.token_b.address])==null?void 0:T.price);(C=a.value.RATES[e.token_a.address])!=null&&C.price&&((N=a.value.RATES[e.token_b.address])!=null&&N.price)?(t=u+d,n=u+d):(t=" --",n=0),console.log(a.value.currentPoolTab,"##pools.value.currentPoolTab"),(a.value.currentPoolTab=="All"||a.value.currentPoolTab!=="All"&&e.category==a.value.currentPoolTab)&&s.push({...e,amountUSD:t,amountUSDOrigin:n,tokenARates:u,tokenBRates:d})}),$.value!="All"?B.value?(c.value=s.sort((e,t)=>Number(t.amountUSDOrigin)-Number(e.amountUSDOrigin)),o.value=!1):(c.value=s.sort((e,t)=>Number(e.amountUSDOrigin)-Number(t.amountUSDOrigin)),o.value=!1):B.value?(c.value=s.sort((e,t)=>t.amountUSDOrigin-e.amountUSDOrigin),o.value=!1):(c.value=s.sort((e,t)=>e.amountUSDOrigin-t.amountUSDOrigin),o.value=!1),console.log(c.value,"list.value========>")};R(()=>[a.value.myPositions,a.value.RATES],([s,e])=>{s&&e&&(console.log("0605==>updateLpList9099999"),F())},{immediate:!0}),R(()=>[h.value.address,a.value.poolConfigList,a.value.poolsObj,g.value.chainName],([s,e,t,n])=>{var u,d,f;s&&e&&e.length>0&&n&&(n!=null&&n.toLowerCase().includes((u=e[0])==null?void 0:u.chain))&&!$e(t)&&(n==="Aptos"?e.length===Object.values(t).length:(f=(d=Object.values(t)[0])==null?void 0:d.chain)!=null&&f.includes("sui"))&&(console.log(t,e,"0605==>getMyPositons9099999"),_.getMyPositons(h.value.address,t,n))},{immediate:!0,deep:!0}),R(()=>[$.value,B.value,a.value.currentPoolTab],([s])=>{F()});const oe=s=>{const e=[];G.value.forEach((t,n)=>{t==s?e[n]=$.value:e[n]=t}),G.value=e,$.value=s},O=Te(),b=m(()=>O),J=m(()=>_),se=async s=>{await O.getSourceGroups();const e=b.value.sourceGroups&&b.value.sourceGroups.length>0&&b.value.sourceGroups[0]&&b.value.sourceGroups[0].sources||[];for(let t=0;t<e.length;t++){const{pool_address:n,position_index:u}=JSON.parse(e[t].blockchainAddress);let d=!1,f;for(let T=0;T<s.length;T++){const{poolAddress:C,index:N}=s[T];n==C&&Number(N)==Number(u)&&(d=!0),f={pool_address:n,position_index:u}}d||await O.subscribePosition(f,"",!1,!1)}},te=async()=>{await O.getSourceGroups();const s=b.value.sourceGroups&&b.value.sourceGroups.length>0&&b.value.sourceGroups[0]&&b.value.sourceGroups[0].sources||[];for(let e=0;e<s.length;e++){const{pool_address:t,position_index:n}=JSON.parse(s[e].blockchainAddress),{name:u}=s[e],d={pool_address:t,position_index:n};await O.subscribePosition(d,u,!1,!1)}},ae=m(()=>J.value.myPositionsLoading);R(()=>J.value.myPositions,(s,e)=>{E.value.hasNotifi&&(s&&s.length>0&&e&&e.length!==s.length?se(s):s&&s.length==0&&!ae.value&&te())},{immediate:!0});const ne=s=>{var e;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((e=a.value.tokensObj[s==null?void 0:s.address])==null?void 0:e.logo_url)||(g.value.theme==="default"?X("/image/coins/unknown.png"):X("/image/coins/sui-unknown.png"))},k=p(null),L=m(()=>k.value&&k.value.firstToken?k.value.firstToken:null),S=m(()=>k.value&&k.value.lastToken?k.value.lastToken:null),le=m(()=>{let s=[];s=c.value;const e=s.filter((t,n)=>L.value&&S.value?t.coinA.symbol==L.value.symbol&&t.coinB.symbol==S.value.symbol||t.coinA.symbol==S.value.symbol&&t.coinB.symbol==L.value.symbol:L.value?t.coinA.symbol.toLowerCase().includes(L.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(L.value.symbol.toLowerCase()):S.value?t.coinA.symbol.toLowerCase().includes(S.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(S.value.symbol.toLowerCase()):s);return a.value.myPositionsLoading||U.setPositiomAmount(e.length),e});return he(()=>{U.setPositiomAmount("--")}),{tabArr:x,changeTab:ee,showList:le,childTokenSelectRef:k,firstToken:L,lastToken:S,getCoinIcon:ne,changeSortLabel:oe,label:D,labelList:G,labelValue:$,select:B,selectValue:Y,t:i,pools:a,store:g,wallet:h,list:c,clickRefresh:z,refresh:o,current:W,router:P,searchKey:q}}});const Q=o=>(ke("data-v-8c65dae8"),o=o(),Le(),o),Ne={class:"upgrade-position-list-container"},Ee={class:"content-top"},De={class:"content-top-left"},Ge={key:0,class:"tag-list"},je=["onClick"],Ve={class:"content-top-right"},Ie={class:"value"},We=Q(()=>v("use",{"xlink:href":"#icon-icon_on"},null,-1)),qe=[We],ze={key:0,class:"select-item"},Fe=["onClick"],Je={class:"search-select-box"},Ke=Q(()=>v("span",null,"TVL",-1)),Me={key:0,src:Z,alt:""},He={key:1,class:"fan-img",src:Z,alt:""},Xe={key:0,class:"upgrade-loading"},Ze={key:1,class:"position-list"},Qe={key:2,class:"no-data"},Ye={key:0,src:Oe,alt:""},xe={key:1,src:Re,alt:""},eo={key:3,class:"no-data"},oo={key:0,src:Ue,alt:""},so={key:1,src:Be,alt:""};function to(o,i,W,P,q,U){const g=re,E=ue,c=ie,_=_e;return l(),r("div",Ne,[v("div",Ee,[v("div",De,[o.tabArr.length>1?(l(),r("div",Ge,[(l(!0),r(j,null,V(o.tabArr,(a,y)=>(l(),r("div",{key:y,class:M(["tag-item",a==o.pools.currentPoolTab?`tag-active tab-num-${o.tabArr.length}`:`tab-num-${o.tabArr.length}`]),onClick:h=>o.changeTab(a)},w(a),11,je))),128))])):A("",!0),I(g,{ref:"childTokenSelectRef"},null,512)]),v("div",Ve,[o.store.theme=="default"?(l(),r("div",{key:0,class:"search-label",onClick:i[0]||(i[0]=K(a=>o.label=!o.label,["stop"]))},[v("span",null,w(o.$t("newAdd.label")),1),v("div",Ie,w(o.labelValue),1),(l(),r("svg",{"aria-hidden":"true",class:M(o.label?"show-icon icon":"icon")},qe,2)),o.label?(l(),r("div",ze,[(l(!0),r(j,null,V(o.labelList,(a,y)=>(l(),r("div",{key:y,class:"select-menu-item",onClick:h=>o.changeSortLabel(a)},w(a),9,Fe))),128))])):A("",!0)])):A("",!0),v("div",Je,[v("div",{class:"search-select",onClick:i[1]||(i[1]=K(a=>o.select=!o.select,["stop"]))},[H(w(o.$t("newAdd.sortBy"))+" ",1),v("div",null,[Ke,o.select?(l(),r("img",Me)):(l(),r("img",He))])])])])]),o.pools.myPositionsLoading&&o.wallet.connected?(l(),r("div",Xe,[I(E,{loading:o.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):A("",!0),o.showList&&o.showList.length>0&&o.wallet.connected&&!o.pools.myPositionsLoading?(l(),r("div",Ze,[(l(!0),r(j,null,V(o.showList,(a,y)=>(l(),ye(c,{key:y,"p-item":a},null,8,["p-item"]))),128))])):A("",!0),o.showList&&o.showList.length<=0&&!o.pools.myPositionsLoading&&o.wallet.connected?(l(),r("div",Qe,[o.store.theme=="default"?(l(),r("img",Ye)):(l(),r("img",xe)),v("span",null,w(o.$t("common.noLiquidityPositions")),1)])):A("",!0),o.wallet.connected?A("",!0):(l(),r("div",eo,[o.store.theme=="default"?(l(),r("img",oo)):(l(),r("img",so)),I(_,{class:"connect-wallet",onClick:i[2]||(i[2]=a=>o.wallet.setIsShowWalletModal(!0))},{default:fe(()=>[H(w(o.$t("button.connectWallet")),1)]),_:1})]))])}const Uo=be(Ce,[["render",to],["__scopeId","data-v-8c65dae8"]]);export{Uo as default};
