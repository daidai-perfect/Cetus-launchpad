import{w as Dt,x as Lt,f as ie,h as Ie,i as ne,k as qt,T as pt,y as di,c as mi,u as vi,m as ze,z as fi}from"./index.c41a185a.js";import{a as et,r as U,m as f,y as Xt,G as Ne,e as tt,o as p,f as H,t as yt,H as gi,h as o,J as $t,v as N,u as X,x as re,c as Ee,p as _t,k as wt,S as Wt,i as $e,w as Xe,j as Je,Q as Ft,l as Zt,W as Ot,E as Gt,q as Jt,F as Mt,s as jt,z as ht,a2 as pi,P as bi,b as Kt,M as hi,B as Qt,a3 as ki}from"./entry.1afe32c4.js";/* empty css              */import{s as bt,m as yi,l as _i,b as wi,a as Ci}from"./transform.c672907f.js";import{D as r}from"./decimal.0bdeb344.js";import{b as st,c as Rt,u as Ct,g as Pi,p as zt}from"./pool.83f6439f.js";/* empty css              */import{d as Yt,_ as Vt,c as xt,a as ei,b as Ii}from"./new-liquidity-title.c42e42ae.js";import{i as rt}from"./import-icon.de3e6c66.js";/* empty css              */import{positionError as at,fromCoin as S,toCoin as y,tickList as ot,currentPrice as vt,currentPriceReverse as kt,direction as we,currentPriceTab as Y,defaultMinPrice as Nt,defaultMaxPrice as At,minPrice as B,maxPrice as _,toggle as ti,isStableFarmingRange as Ue,isInputTotalAmount as De,priceConfigObj as xe,fromCoinAmount as L,toCoinAmount as q,fixedFromCoin as Te,resetTickList as Et,resetData as Si}from"./data.bfb0958b.js";import{u as Pt}from"./farms.2b755d68.js";import{_ as ii}from"./icon_farms_2x.7cf88730.js";import{_ as Ti}from"./coin-lock.9b7a4e87.js";import{C as Ni}from"./coin-select.1f300d63.js";import{_ as Ai}from"./status-block.635f2a4b.js";import{_ as ni}from"./icon-arrow_2x.948aedb2.js";import{_ as oi}from"./icon-arrow_2x.4ffddb8e.js";import{_ as Li,a as qi,b as $i}from"./icon-Add-Liquidity_2x.1eeb3361.js";import{u as Mi}from"./notifi.63f5c945.js";import"./img-lock_2x.a28135f4.js";import"./index.fa5ab6c5.js";/* empty css              */import"./token-warning.7014f9c6.js";import"./useDebounceFunction.6fcad2ee.js";import"./swap-setting.a82a0c56.js";import"./icon-warning_2x.e4f91c80.js";import"./icon-error_2x.b4924e70.js";import"./token-warning_2x.68c70fba.js";import"./img-no-Positions_2x.514f203f.js";import"./img-no-Positions_2x.51b74fe4.js";import"./useWhale.b340524c.js";function Ht(e,s,V){const x=new r(10).pow(s-V);return new r(1.0001).pow(e).mul(x)}const Fi=et({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,s){const V=U(""),x=U(""),$=f(()=>{var a,P,m,Z,z,ee;return(a=e.poolInfo)!=null&&a.current_sqrt_price&&((P=e.poolInfo)!=null&&P.coinA)&&((m=e.poolInfo)!=null&&m.coinB)?n.sqrtPriceX64ToPrice((Z=e.poolInfo)==null?void 0:Z.current_sqrt_price,(z=e.poolInfo)==null?void 0:z.coinA.decimals,(ee=e.poolInfo)==null?void 0:ee.coinB.decimals).toString():"0"}),se=f(()=>{let a=0;return e.direction?a=(Number(e.minPrice)/Number($.value)-1)*100:a=(Number(e.minPrice)/Number(1/Number($.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),T=f(()=>{let a=0;return e.direction?a=(Number(e.maxPrice)/Number($.value)-1)*100:a=(Number(e.maxPrice)/Number(1/Number($.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),M=st(),w=f(()=>M),G=f(()=>w.value.chainName?Rt(w.value.chainName):{}),{TickMath:n,getNearestTickByTick:C}=G.value,W=(a=[])=>{let P=6;const m=Math.abs(Number(a[0])-Number(a[a.length-1]));return m>=6?P=0:m>=1?P=1:m>=.1?P=2:m>=.01?P=3:m>=.001?P=4:m>=1e-4?P=5:m>=1e-5?P=6:m>=1e-6?P=7:m>=1e-7&&(P=8),P},F=(a,P=1)=>{if(a&&a.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const m=Number(e.poolInfo.current_tick_index);let Z=m+100*P,z=m-100*P,ee,b;if(e.maxPrice==="âˆž")b=G.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?b=n.priceToTickIndex(new r(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):b=n.priceToTickIndex(new r(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{b=443636}if(e.minPrice==="0")ee=G.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ee=n.priceToTickIndex(new r(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ee=n.priceToTickIndex(new r(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ee=-443636}let ve=0;if(e.currentPriceTab!=="full range"){if(m>=ee&&m<=b){const R=m-ee,fe=b-m;ve=Math.max(Math.abs(R),Math.abs(fe))}else m<ee?ve=Math.abs(b-m):ve=Math.abs(m-ee);Z=m+ve+100*P,z=m-ve-100*P}else{const R=(Math.abs(m)>5e3,2e4);Z=m+R*P,z=m-R*P}z<-443636&&(z=-443636),Z>443636&&(Z=443636);const g=new r(a.liquidity).div(Math.pow(10,8)).toString(),O=e.tickList,D=[],ke=[];let k={};for(let R=0;R<O.length;R++){if(k=O[R],k.index<=m&&k.index>=z){if(D.length<1&&R!==0){const fe=O[R-1];D.unshift({...fe,index:z,source:"left"})}D.unshift(k)}else if(k.index>m&&k.index<=Z&&(ke.push(k),D.length<1&&R!==0)){const fe=O[R-1];D.push({...fe,index:z,source:"left"})}if(k.index>Z){const fe=O[R];if(ke.push({...fe,index:Z,source:"right"}),D.length<1&&R!==0){const Qe=O[R-1];D.push({...Qe,index:z,source:"left"})}break}}let E="0";for(let R=D.length-1;R>=0;R--)E=new r(E).plus(new r(D[R].liquidityNet.toString()).div(Math.pow(10,8))).toString(),D[R].liquityAmount=E;let ue=g;for(let R=0;R<ke.length;R++)ue=new r(ue).plus(new r(ke[R].liquidityNet.toString()).div(Math.pow(10,8))).toString(),ke[R].liquityAmount=ue;let me=[];const J=O&&O.length>0?{index:m,liquityAmount:Number(g)}:{index:m,liquityAmount:0};(D.length>0||ke.length>0)&&(me=[...D.reverse(),J,...ke],e.direction||(me=me.reverse()));const He=[];O.forEach(R=>{He.push({...R,liquidityGross:R.liquidityGross.toString(),liquidityNet:R.liquidityNet.toString()})}),v(me,z,Z,ee,b,m)}};let oe=U(!1);const K=U(!1);Xt(()=>{const a=document.body.clientWidth;K.value=!0,a<750?oe.value=!1:oe.value=!0,window.onresize=()=>{document.body.clientWidth<750?oe.value=!1:oe.value=!0,F(e.poolInfo,e.zoom)}});const v=(a,P,m,Z,z,ee)=>{let b,ve;e.direction?(b=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new r(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ve=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new r(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(b=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new r(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ve=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new r(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const g={top:30,right:35,bottom:20,left:80};let O,D;oe.value?(O=460-g.left-g.right,D=205-g.top-g.bottom):(O=340-g.left-g.right,D=205-g.top-g.bottom);const ke=m-P,k=parseInt(String(ke/4));let E=[P+k/4,P+k,P+2*k,m-k,m-k/4];const ue=P,me=m,J=O/(me-ue);e.currentPriceTab==="full range"&&(E=[P,P+2*k,m]);const He=E.map(l=>e.direction?Ht(l,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new r(1).div(Ht(l,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),R=W(He);bt("#chart").selectAll("*").remove();const fe=bt("#chart").attr("width",O+g.left+g.right).attr("height",D+g.top+g.bottom).append("g").attr("transform",`translate(${g.left},${g.right})`),Qe=yi(a,function(l){return Number(Math.abs(l.liquityAmount))})||0,Me=_i().range([0,D]).domain([Qe,0]);wi().rangeRound([0,O]).padding(.1);const it=fe.append("g").attr("id","barsBox").selectAll("rect").data(a).enter().append("rect");w.value.theme=="default"?it.attr("x",function(l,c){return c===0?0:e.direction?Math.abs(l.index-ue)*J:Math.abs(me-l.index)*J}).attr("y",function(l,c){return e.direction?c===a.length-1?0:Me(l.liquityAmount):c===a.length-1?0:Me(a[c+1].liquityAmount)}).attr("width",function(l,c){return c===0&&a.length===1&&l.liquityAmount>0?O:(e.direction,c!==a.length-1?Math.abs(a[c+1].index-l.index)*J:0)}).attr("height",function(l,c){return c===0&&a.length===1&&l.liquityAmount>0?D:e.direction?c===a.length-1?0:D-Me(l.liquityAmount):c===a.length-1?0:D-Me(a[c+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):it.attr("x",function(l,c){return c===0?0:e.direction?Math.abs(l.index-ue)*J:Math.abs(me-l.index)*J}).attr("y",function(l,c){return e.direction?c===a.length-1?0:Me(Math.abs(l.liquityAmount)):c===a.length-1?0:Me(Math.abs(a[c+1].liquityAmount))}).attr("width",function(l,c){return c===0&&a.length===1&&l.liquityAmount>0?O:(e.direction,c!==a.length-1?Math.abs(a[c+1].index-l.index)*J:0)}).attr("height",function(l,c){if(c===0&&a.length===1&&l.liquityAmount>0)return D;if(e.direction)return c===a.length-1?0:Number(l.liquityAmount)?D-Me(Math.abs(l.liquityAmount)):0;{if(c===a.length-1)return 0;const qe=D-Me(Math.abs(a[c+1].liquityAmount));return Number(a[c+1].liquityAmount)?qe:0}}).attr("fill",function(l,c){return"#417494"}).attr("class","bars").attr("stroke-width",1).attr("stroke",function(l,c){return"#417494"});const Ye=fe.append("g");Ye.append("line").attr("x1",0).attr("y1",155).attr("x2",O).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const Ve=Ye.append("g");let ae=0;if(e.direction){for(let l=0;l<E.length;l++){const c=ie(He[l],R)||"0";He.push(c);const qe=Math.abs(E[l]-ue)*J;let te=0;for(let le=0;le<c.length;le++)c[le]==="1"?te+=4.02:c[le]==="."?te+=2.64:c[le]==="7"?te+=5.48:te+=6;Ve.append("text").text(c).attr("x",qe-te/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(ee-ue)*J}else{for(let l=E.length-1;l>=0;l--){const c=ie(He[l],R)||0;He.push(c);const qe=Math.abs(E[l]-me)*J;let te=0;for(let le=0;le<c.length;le++)c[le]==="1"?te+=4.02:c[le]==="."?te+=2.64:c[le]==="7"?te+=5.48:te+=6;Ve.append("text").text(c).attr("x",qe-te/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}ae=Math.abs(ee-me)*J}(w.value.theme=="default"?fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+ae+", 0)");let Ae,t,d,A;e.direction?(Ae=Z<ue?-100:parseInt(String(Math.abs(Z-ue)*J)),t=z<ue?-100:parseInt(String(Math.abs(z-ue)*J)),d=b<ue?-100:Math.abs(b-ue)*J,A=ve<ue?-100:Math.abs(ve-ue)*J):(t=Z<ue?-100:Math.abs(me-Z)*J,Ae=z<ue?-100:Math.abs(me-z)*J,A=b>me?-100:Math.abs(me-b)*J,d=ve>me?-100:Math.abs(me-ve)*J),e.minPrice==="0"&&(Ae=0),e.maxPrice==="âˆž"&&(t=O),oe.value?V.value=O-Ae+94+"px":V.value=O-Ae+87+"px",x.value=t+98+"px",b&&d<O&&fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+d+", 0)"),ve&&A<O&&fe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+A+", 0)");const I=fe.append("g").attr("id","left-handle"),j=fe.append("g").attr("id","right-handle");w.value.theme=="default"?(I.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),I.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),I.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),I.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),j.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),j.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),j.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),j.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(I.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),I.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),I.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),I.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),j.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),j.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),j.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),j.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),I.attr("transform","translate("+Ae+", 0)"),j.attr("transform","translate("+t+", 0)");const ge=Ci().extent([[0,0],[O,D]]).handleSize(30).on("end",Le);fe.append("g").attr("class","brush").call(ge).call(ge.move,[Ae,t]);function Le(l){if(!l.sourceEvent||!l.selection)return;I.attr("transform","translate("+l.selection[0]+", 0)"),j.attr("transform","translate("+l.selection[1]+", 0)"),oe.value,V.value=O-l.selection[0]+87+"px",x.value=l.selection[1]+74+"px";let c,qe,te=0,le=0;e.direction?(te=C(parseInt(String(l.selection[0]/J+ue)),Number(e.poolInfo.tickSpacing)),c=n.tickIndexToPrice(te,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),le=C(parseInt(String(l.selection[1]/J+ue)),Number(e.poolInfo.tickSpacing)),qe=n.tickIndexToPrice(le,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(le=C(me-l.selection[0]/J,Number(e.poolInfo.tickSpacing)),c=1/n.tickIndexToPrice(le,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),te=C(me-l.selection[1]/J,Number(e.poolInfo.tickSpacing)),qe=1/n.tickIndexToPrice(te,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),s.emit("onChangeMinPrice",String(ie(String(c),6))),s.emit("onChangeMaxPrice",String(ie(String(qe),6)))}w.value.theme=="default"?bt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):bt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};return U(""),Ne(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom,e.tickList],([a,P,m,Z,z,ee])=>{a&&P&&m&&(a!=null&&a.liquidity)&&F(a,z)},{immediate:!0}),{store:w,loading:K,rangeSizeLower:se,rangeSizeUpper:T,rangeSizeLowerPosition:V,rangeSizeUpperPosition:x,decimalFormat:Dt,numberformat:Lt}}});const Oi=e=>(_t("data-v-662ad41d"),e=e(),wt(),e),Ri={class:"chart-box"},Bi={class:"chart"},Ui=Oi(()=>o("svg",{id:"chart"},null,-1));function ji(e,s,V,x,$,se){const T=Wt;return p(),H("div",Ri,[yt(o("div",Bi,[e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(p(),H("div",{key:0,class:"range-size range-size-lower",style:$t({right:e.rangeSizeLowerPosition})},N(("numberformat"in e?e.numberformat:X(Lt))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):re("",!0),e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(p(),H("div",{key:1,class:"range-size range-size-upper",style:$t({left:e.rangeSizeUpperPosition})},N(("numberformat"in e?e.numberformat:X(Lt))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):re("",!0),Ui],512),[[gi,!e.chartLoading]]),e.chartLoading?(p(),Ee(T,{key:0})):re("",!0)])}const ai=tt(Fi,[["render",ji],["__scopeId","data-v-662ad41d"]]),zi=et({props:{lever:{type:String,default:""}},setup(){return{}}});const Ei=e=>(_t("data-v-47f26f4b"),e=e(),wt(),e),Hi={class:"lever"},Di=Ei(()=>o("div",{class:"lever-title"},[o("span",null,"Leverage"),o("svg",{"aria-hidden":"true",class:"icon"},[o("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),Xi={class:"lever-text"};function Wi(e,s,V,x,$,se){const T=Ft;return p(),H("div",Hi,[$e(T,{"overlay-class-name":"lever-tooltip"},{title:Xe(()=>[Je("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Xe(()=>[Di]),_:1}),o("div",Xi,N(e.lever),1)])}const Zi=tt(zi,[["render",Wi],["__scopeId","data-v-47f26f4b"]]),Gi=et({components:{NewLiquidityD3Chart:ai,NewLiquidityPrice:Yt},setup(){const{t:e,locale:s}=Zt(),V=U("liquidity"),x=st(),$=f(()=>x),se=f(()=>$.value.chainName),T=Ct(),M=f(()=>T),w=f(()=>$.value.chainName?Rt($.value.chainName):{});Xt(()=>{at.value=!1});const G=Ot(),n=f(()=>{let t=null;for(let d=0;d<M.value.poolConfigList.length;d++){const A=M.value.poolConfigList[d];A.address==G.query.poolAddress&&(t=A)}return t}),C=f(()=>{let t=null;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:481 ~ constpoolInfo:any=computed ~ pools.value.poolsObj:",M.value.poolsObj);for(const d in M.value.poolsObj){const A=M.value.poolsObj[d];A.address==G.query.poolAddress&&(t=A)}return console.log(t==null?void 0:t.address,"###info.address1"),t&&(t!=null&&t.current_tick_index)||(t==null?void 0:t.current_tick_index)==0?t:null}),W=U(),F=U(!0),oe=async(t,d)=>{var A,I,j,ge,Le,l,c,qe,te,le,ct,dt;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:497 ~ watchPoolInfo ~ pool:",t),t&&(S.value=t.needReverse?t.token_b:t.token_a,y.value=t.needReverse?t.token_a:t.token_b),d&&(t.current_tick_index||t.current_tick_index===0)){F.value=!0,ot.value=[],v.value=[],Ue.value=!1;const nt=t.token_a.decimals,mt=t.token_b.decimals;vt.value=pt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((A=t==null?void 0:t.object)==null?void 0:A.current_sqrt_price),nt,mt).toString(),kt.value=new r(1).div(pt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((I=t==null?void 0:t.object)==null?void 0:I.current_sqrt_price),nt,mt)).toString(),W.value=t.needReverse,((ge=(j=t==null?void 0:t.token_a)==null?void 0:j.address)==null?void 0:ge.toLowerCase())===((c=(l=(Le=S)==null?void 0:Le.value)==null?void 0:l.address)==null?void 0:c.toLowerCase())&&((te=(qe=t==null?void 0:t.token_b)==null?void 0:qe.address)==null?void 0:te.toLowerCase())===((dt=(ct=(le=y)==null?void 0:le.value)==null?void 0:ct.address)==null?void 0:dt.toLowerCase())?we.value=!0:we.value=!1;let It={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const{list:ft,address:St}=await w.value.getTicks(It);ot.value=ft&&St==t.address?w.value.getTickDataFromUrlData(ft):[],(t!=null&&t.current_tick_index||(t==null?void 0:t.current_tick_index)===0)&&(P(t),F.value=!1)}},K=t=>{var I,j;const d=t.token_a.decimals,A=t.token_b.decimals;vt.value=pt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((I=t==null?void 0:t.object)==null?void 0:I.current_sqrt_price),d,A).toString(),kt.value=new r(1).div(pt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((j=t==null?void 0:t.object)==null?void 0:j.current_sqrt_price),d,A)).toString()},v=U([]),a=U(),P=async t=>{const d=t.token_a.decimals,A=t.token_b.decimals;let I=M.value.poolPriceConfigObj&&M.value.poolPriceConfigObj[t.address]&&M.value.poolPriceConfigObj[t.address].recommend_ranges||{};const j=M.value.poolPriceConfigObj&&M.value.poolPriceConfigObj[t.address]&&M.value.poolPriceConfigObj[t.address].type||"";let ge,Le;const l=di(t.current_tick_index,t.tickSpacing);a.value=t.current_tick_index,ge=l-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),Le=l+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const c=w.value.TickMath.tickIndexToPrice(ge,d,A).toString(),qe=w.value.TickMath.tickIndexToPrice(Le,d,A).toString();I["full range"]={lower:w.value.TickUtil.getMinIndex(Number(C.value.tickSpacing)),upper:w.value.TickUtil.getMaxIndex(Number(C.value.tickSpacing))},I.custom={lower:ge,upper:Le,minPrice:c,maxPrice:qe};const te=[];for(let le in I)I[le]&&te.push({...I[le],key:le});j&&te&&te.length>2?t.isSelfBuilt?Y.value="custom":j=="stable"?Y.value="suggested":Y.value="passive":Y.value="custom",v.value=te||{},xe.value=I,z({key:Y.value,...I[Y.value]})},m=U(""),Z=U(""),z=t=>{Y.value=t.key.toLowerCase();const d=C.value.token_a.decimals,A=C.value.token_b.decimals,{lower:I,upper:j}=t;De.value=!1;const ge=w.value.TickMath.tickIndexToPrice(I,d,A).toString(),Le=w.value.TickMath.tickIndexToPrice(j,d,A).toString();if(t.key=="full range"){m.value=I,Z.value=j,ee();return}we.value?(Nt.value=String(ge),B.value=String(ge),At.value=String(Le),_.value=String(Le),m.value=I,Z.value=j):(Nt.value=new r(1).div(new r(Le)).toString(),B.value=new r(1).div(new r(Le)).toString(),At.value=new r(1).div(new r(ge)).toString(),_.value=new r(1).div(new r(ge)).toString(),m.value=w.value.TickMath.priceToTickIndex(new r(1/Number(Le)),d,A),Z.value=w.value.TickMath.priceToTickIndex(new r(1/Number(ge)),d,A))},ee=t=>{B.value="0",_.value="âˆž"};Ne(()=>C.value,(t,d)=>{console.log(!d&&t&&!ne(t),"###info.address2"),console.log(d&&t&&(d==null?void 0:d.address)!==(t==null?void 0:t.address),"###info.address3"),(!d&&t&&!ne(t)||d&&t&&(d==null?void 0:d.address)!==(t==null?void 0:t.address))&&oe(t,(d==null?void 0:d.address)!==(t==null?void 0:t.address)),t&&!ne(t)&&K(t),t||(ot.value=[])},{immediate:!0,deep:!0}),Gt(()=>{S.value=U(),y.value=U(),ot.value=[]}),Ne(()=>n.value,(t,d)=>{t&&T.setSinglePool(t,{},se.value)},{immediate:!0});const b=t=>{if(se.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},ve=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},g=t=>{var A,I;const d=M.value.poolPriceConfigObj&&M.value.poolPriceConfigObj[(A=C.value)==null?void 0:A.address]&&M.value.poolPriceConfigObj[(I=C.value)==null?void 0:I.address].type||"";if(v.value.length>2)if(d=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"suggested":return{top:"25%"};case"full range":return{top:"49%"};case"custom":return{top:"75%"}}else if(d=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"full range":return{top:"35%"};case"custom":return{top:"60%"}}},O=U(1),D=()=>{const t=O.value/2;O.value=t},ke=()=>{const t=O.value*2;O.value=t},k=f(()=>{var t,d,A;return!C.value||ne($.value.addressHistTokens)||!$.value.addressHistTokens[(t=C.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((A=$.value.addressHistTokens[(d=C.value)==null?void 0:d.poolAddress])==null?void 0:A.data.map(I=>[I.key,I.value]))}),E=U(30),ue=U("30D"),me=f(()=>we.value?k.value&&ie(E.value==7?k.value.before_7_d_contract_price_lowest:E.value==24?k.value.before_24_h_contract_price_lowest:k.value.before_30_d_contract_price_lowest,6)||0:k.value&&ie(new r(1).div(E.value==7?k.value.before_7_d_contract_price_highest:E.value==24?k.value.before_24_h_contract_price_highest:k.value.before_30_d_contract_price_highest).toString(),6)||0),J=f(()=>we.value?k.value&&ie(E.value==7?k.value.before_7_d_contract_price_highest:E.value==24?k.value.before_24_h_contract_price_highest:k.value.before_30_d_contract_price_highest,6)||0:(k.value&&ie(1/Number(E.value==7?k.value.before_7_d_contract_price_lowest:E.value==24?k.value.before_24_h_contract_price_lowest:k.value.before_30_d_contract_price_lowest),6))==1/0?0:k.value&&ie(1/Number(E.value==7?k.value.before_7_d_contract_price_lowest:E.value==24?k.value.before_24_h_contract_price_lowest:k.value.before_30_d_contract_price_lowest),6)||0),He=f(()=>{const t=Number(B.value),d=Number(_.value);if(B.value=="0"&&_.value=="âˆž"||Y.value=="full range")return"1x";if(B.value==_.value||Y.value=="full range")return"--";if(B.value&&_.value&&B.value!=="0"&&_.value!=="âˆž"){const A=qt(1/(1-Number((t/d)**.25)),2);return Number(A)>0?A+"x":"--"}else return 1}),R=f(()=>{var t,d,A,I,j,ge;return((t=S.value)==null?void 0:t.isSelfBuilt)||((d=y.value)==null?void 0:d.isSelfBuilt)||((I=M.value.tokensObj[(A=S.value)==null?void 0:A.address])==null?void 0:I.isSelfBuilt)||((ge=M.value.tokensObj[(j=y.value)==null?void 0:j.address])==null?void 0:ge.isSelfBuilt)}),fe=(t,d)=>{t!==B.value&&Y.value=="full range"?z({key:"custom",...v.value.custom}):Y.value!=="full range"&&Y.value!=="custom"?(Y.value="custom",B.value=t):B.value=t,ae.value&&(Ue.value?(we.value&&B.value!==ae.value.minPrice&&(Ue.value=!1),!we.value&&Number(B.value)!==1/Number(ae.value.maxPrice)&&(Ue.value=!1)):(we.value&&B.value==ae.value.minPrice&&_.value==ae.value.maxPrice&&(Ue.value=!0),!we.value&&Number(B.value)==1/Number(ae.value.maxPrice)&&Number(_.value)==1/Number(ae.value.minPrice)&&(Ue.value=!0)))},Qe=(t,d)=>{t!==_.value&&Y.value=="full range"?z({key:"custom",...v.value.custom}):Y.value!=="full range"&&Y.value!=="custom"?(Y.value="custom",t=="0"?_.value="âˆž":_.value=t):t=="0"?_.value="âˆž":_.value=t,ae.value&&(Ue.value?(we.value&&_.value!==ae.value.maxPrice&&(Ue.value=!1),!we.value&&Number(_.value)!==1/Number(ae.value.minPrice)&&(Ue.value=!1)):(we.value&&B.value==ae.value.minPrice&&_.value==ae.value.maxPrice&&(Ue.value=!0),!we.value&&Number(B.value)==1/Number(ae.value.maxPrice)&&Number(_.value)==1/Number(ae.value.minPrice)&&(Ue.value=!0)))},Me=t=>{var d;return console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:1215 ~ getCoinIcon ~ info:",t),(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((d=M.value.tokensObj[t==null?void 0:t.address])==null?void 0:d.logo_url)||($.value.theme==="default"?rt("/image/coins/unknown.png"):rt("/image/coins/sui-unknown.png"))},lt=t=>{switch(t){case"active":return e("newAdd.activeTips");case"passive":return e("newAdd.passiveTips");case"full range":return e("newAdd.fullRangTips");case"suggested":return e("newAdd.suggestedTips");case"custom":return e("newAdd.customTips")}},it=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],Ye=Pt(),Ve=f(()=>Ye),ae=f(()=>{var t;return Ve.value.farmsPoolObj[(t=C==null?void 0:C.value)==null?void 0:t.address]}),ut=f(()=>M.value.poolPriceConfigObj);Ne(()=>[Ue.value,C.value,v.value,ut.value,ae.value,we.value],(t,d)=>{var A,I;if(t[0]&&t[4]&&!ne(t[4]))Y.value="custom",B.value=t[5]?t[4].minPrice:String(1/t[4].maxPrice),_.value=t[5]?t[4].maxPrice:String(1/t[4].minPrice);else if(t[1]&&!ne(t[1])&&t[2]&&!ne(t[2])&&t[3]&&!ne(t[3])&&t[4]&&!ne(t[4])){t[3]&&t[3][(A=t[1])==null?void 0:A.address]&&t[3][(I=t[1])==null?void 0:I.address].type;const j=t[2].filter(ge=>ge.key===(t[2].length==4?"passive":"suggested"));j!=null&&j[0]&&(!d||d[0]!==t[0])&&z({...j[0]})}},{immediate:!0});const Ae=f(()=>M.value.poolsLoading);return{positionError:at,getCoinIcon:Me,chainName:se,store:$,currentTab:V,currentPrice:vt,currentPriceReverse:kt,fromCoin:S,toCoin:y,direction:we,needReverse:W,addCommom:Ie,decimalUi:ie,priceTablList:v,currentPriceTab:Y,sliderStyle:g,poolInfo:C,tickList:ot,getPriceTabImage:b,getPriceTabText:ve,defaultMinPrice:Nt,defaultMaxPrice:At,minPrice:B,maxPrice:_,currentTick:a,chartLoading:F,zoomOut:D,zoomIn:ke,zoom:O,priceTab:z,before7dContractPriceLowest:me,before7dContractPriceHighest:J,aprRewardsTime:ue,lever:He,aprRewardsParameter:E,isSelfBuilt:R,priceRangeChangeMin:fe,priceRangeChangeMax:Qe,toggle:ti,getPirceTabTips:lt,timeList:it,farmsPoolInfo:ae,checkNullObj:ne,isStableFarmingRange:Ue,poolsLoading:Ae}}});const Ji={class:"new-liquidity-left"},Ki=o("span",{class:"selectRange"},"Select Range",-1),Qi={class:"price-info"},Yi={class:"left"},Vi={class:"base-coin"},xi={class:"base-coin-title"},en=o("span",null,"Base coin",-1),tn=o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})],-1),nn=o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})],-1),on=[tn,nn],an={class:"base-coin-bottom"},rn={alt:""},sn={class:"current-price"},ln=o("div",{class:"current-price-title"},"Current Price",-1),un={key:0,class:"from-pre-to"},cn={class:"right"},dn={class:"price-range"},mn={class:"left"},vn={class:"price-slider"},fn={class:"slider"},gn=o("div",{class:"slider-ratio-content"},null,-1),pn=[gn],bn={class:"price-tab-list"},hn=["onClick"],kn=["src"],yn={class:"right"},_n={class:"price-zoom"},wn={class:"current-price"},Cn=o("div",{class:"current-price-title"},"Current Price",-1),Pn={key:0,class:"from-pre-to"},In={class:"price-zoom-right"},Sn={class:"leverage"},Tn=o("div",{class:"left"},null,-1),Nn={class:"right"},An={class:"right-time"},Ln={key:0,class:"day-7-price-range"},qn=o("i",null,null,-1),$n={class:"gray"},Mn={class:"time-list"},Fn=["onClick"],On={class:"right-price-h5"},Rn={class:"range pc-range"},Bn={key:0,class:"stable-farming-range pc-stable-farming-range"},Un=o("img",{src:ii},null,-1),jn={class:"check-box-active"},zn={key:1,class:"stable-farming-range h5-stable-farming-range"},En=o("span",null,[o("img",{src:ii}),Je(" Farm rewards rangeï¼š ")],-1),Hn={class:"check-box-active"},Dn={key:2,class:"position-tips"},Xn=["src"],Wn={class:"error"};function Zn(e,s,V,x,$,se){var W,F,oe,K,v,a,P,m,Z,z,ee;const T=Ft,M=ai,w=Zi,G=pi,n=Yt,C=Jt("image");return p(),H("div",Ji,[Ki,o("div",Qi,[o("div",Yi,[o("div",Vi,[o("div",xi,[en,o("div",{class:"change-price",onClick:s[0]||(s[0]=(...b)=>e.toggle&&e.toggle(...b))},on)]),o("div",an,[yt(o("img",rn,null,512),[[C,e.getCoinIcon(e.fromCoin)]]),o("span",null,N((W=e.fromCoin)==null?void 0:W.symbol),1)])]),o("div",sn,[ln,o("div",null,[o("span",null,N(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.currentPrice,6)):("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(p(),H("span",un,N((F=e.toCoin)==null?void 0:F.symbol)+" per "+N((oe=e.fromCoin)==null?void 0:oe.symbol),1)):re("",!0)])])]),o("div",cn,[e.currentTab=="liquidity"?(p(),H("div",{key:0,class:"zoom-out",onClick:s[1]||(s[1]=(...b)=>e.zoomOut&&e.zoomOut(...b))}," + ")):re("",!0),e.currentTab=="liquidity"?(p(),H("div",{key:1,class:"zoom-in",onClick:s[2]||(s[2]=(...b)=>e.zoomIn&&e.zoomIn(...b))}," - ")):re("",!0)])]),o("div",dn,[o("div",mn,[o("div",vn,[o("div",fn,[o("div",{class:"slider-ratio",style:$t(e.sliderStyle(e.currentPriceTab))},pn,4)])]),o("div",bn,[(p(!0),H(Mt,null,jt(e.priceTablList,b=>(p(),H("div",{key:b.key,class:ht(["price-tab-item",e.currentPriceTab==b.key?"price-tab-item-active":""]),onClick:ve=>e.priceTab(b)},[$e(T,{placement:"bottom","arrow-point-at-center":""},{title:Xe(()=>[Je(N(e.getPirceTabTips(b.key)),1)]),default:Xe(()=>[o("img",{src:e.getPriceTabImage(b.key),alt:""},null,8,kn),o("span",null,N(e.getPriceTabText(b.key)),1)]),_:2},1024)],10,hn))),128))])]),o("div",yn,[o("div",_n,[o("div",wn,[Cn,o("div",null,[o("span",null,N(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.currentPrice,6)):("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(p(),H("span",Pn,N(e.direction&&!e.needReverse?`${(K=e.fromCoin)==null?void 0:K.symbol} per ${(v=e.toCoin)==null?void 0:v.symbol}`:`${(a=e.toCoin)==null?void 0:a.symbol} per ${(P=e.fromCoin)==null?void 0:P.symbol}`),1)):re("",!0)])]),o("div",In,[e.currentTab=="liquidity"?(p(),H("div",{key:0,class:"zoom-out",onClick:s[3]||(s[3]=(...b)=>e.zoomOut&&e.zoomOut(...b))}," + ")):re("",!0),e.currentTab=="liquidity"?(p(),H("div",{key:1,class:"zoom-in",onClick:s[4]||(s[4]=(...b)=>e.zoomIn&&e.zoomIn(...b))}," - ")):re("",!0)])]),e.poolInfo?(p(),Ee(M,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):re("",!0)])]),o("div",Sn,[Tn,o("div",Nn,[o("div",An,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(p(),H("div",Ln,[qn,o("span",$n,N(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),o("span",null,N(("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.before7dContractPriceLowest,6)))+" - "+N(("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.before7dContractPriceHighest,6))),1)])):re("",!0),o("div",Mn,[(p(!0),H(Mt,null,jt(e.timeList,b=>(p(),H("div",{key:b.value,class:ht(["time-item",b.value==e.aprRewardsParameter?"time-item-active":""]),onClick:ve=>e.aprRewardsParameter=b.value},N(b.label),11,Fn))),128))])]),o("div",On,[o("span",null,N(("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.before7dContractPriceLowest,6)))+" - "+N(("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(e.before7dContractPriceHighest,6))),1)])])]),o("div",{class:ht(["apr-and-price",e.positionError&&e.poolInfo?"padding-apr-and-price":""])},[$e(w,{lever:e.lever},null,8,["lever"]),o("div",Rn,[e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:X(ne))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(p(),H("div",Bn,[o("span",null,[Un,Je(" Farm rewards rangeï¼š"+N(("decimalUi"in e?e.decimalUi:X(ie))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+N(("decimalUi"in e?e.decimalUi:X(ie))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+N((m=e.toCoin)==null?void 0:m.symbol)+" per "+N((Z=e.fromCoin)==null?void 0:Z.symbol),1)]),o("div",jn,[$e(G,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:s[5]||(s[5]=b=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):re("",!0),e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:X(ne))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(p(),H("div",zn,[En,o("div",Hn,[Je(N(("decimalUi"in e?e.decimalUi:X(ie))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+N(("decimalUi"in e?e.decimalUi:X(ie))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+N((z=e.toCoin)==null?void 0:z.symbol)+" per "+N((ee=e.fromCoin)==null?void 0:ee.symbol)+" ",1),$e(G,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:s[6]||(s[6]=b=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):re("",!0),$e(n,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(p(),H("div",Dn,[o("img",{src:("importIcon"in e?e.importIcon:X(rt))("/image/icon-tips-error@2x.png"),alt:""},null,8,Xn),o("p",Wn,N(e.$t("tips.positionError")),1)])):re("",!0)])],2)])}const ri=tt(Gi,[["render",Zn]]),Gn=et({components:{Modal:bi},props:{positionInfo:{type:Object,default:()=>({})},poolInfo:{type:Object,required:!0},farmPoolInfo:{type:Object,default:()=>({})},isAutoStakeFarming:{type:Boolean,default:!0}},setup(e){console.log("ðŸš€ðŸš€ðŸš€ ~ file: viewDetail.vue:218 ~ setup ~ props:",e);const s=st(),V=f(()=>s),x=f(()=>V.value.chainName),$=f(()=>mi[x.value]);let se=U(!0);const T=Ct(),M=f(()=>T),w=Kt(),G=f(()=>e.poolInfo.needResever),n=f(()=>e.farmPoolInfo&&e.isAutoStakeFarming?`/new-position-detail?position_nft_id=${e.positionInfo.id}&positionSource=farming`:`/new-position-detail?collect=${e.positionInfo.collectionName}&&token=${e.positionInfo.tokenName}&&address=${e.positionInfo.pool}&pos=${e.positionInfo.pos_object_id}`),C=F=>{var oe;return(F==null?void 0:F.logoURI)||(F==null?void 0:F.logo_url)||((oe=M.value.tokensObj[F==null?void 0:F.address])==null?void 0:oe.logo_url)||(V.value.theme==="default"?rt("/image/coins/unknown.png"):rt("/image/coins/sui-unknown.png"))},W=f(()=>V.value.currentExplorer);return{getExplorerUrl:Pi,addCommom:Ie,router:w,pools:M,decimalFormat:Dt,rateChange:se,config:$,importIcon:rt,store:V,chainName:x,checkNullObj:ne,needReverse:G,getCoinIcon:C,decimalUi:ie,currentExplorer:W,positionDetailUrl:n}}});const Bt=e=>(_t("data-v-9a9a42f6"),e=e(),wt(),e),Jn=Bt(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Kn={class:"rejected-container"},Qn=Bt(()=>o("div",{class:"coin-pair"},null,-1)),Yn={class:"coin-pair"},Vn={class:"fee"},xn={class:"status"},eo={class:"min-and-max"},to={key:0},io={class:"text"},no={key:0,src:ni,alt:""},oo={key:1,src:oi,alt:""},ao={class:"text"},ro={key:1},so={class:"text"},lo={key:0,src:ni,alt:""},uo={key:1,src:oi,alt:""},co={class:"text"},mo=Bt(()=>o("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),vo=[mo];function fo(e,s,V,x,$,se){const T=Ai,M=Qt,w=hi("Modal"),G=Jt("image");return p(),Ee(w,{visible:!0,class:"transiaction-rejected",centered:"",title:e.$t("newAdd.openPositionSuccessful"),width:"340px",footer:null,onCancel:s[3]||(s[3]=n=>e.$emit("onClose"))},{closeIcon:Xe(()=>[Jn]),default:Xe(()=>{var n,C,W,F,oe,K,v,a,P,m,Z,z,ee,b,ve,g,O,D,ke,k;return[o("div",Kn,[Qn,o("div",{class:ht(["left",`position-status-${e.positionInfo&&e.positionInfo.currentStatus&&e.positionInfo.currentStatus.toLowerCase()}`])},[o("div",Yn,[o("div",null,[yt(o("img",null,null,512),[[G,e.getCoinIcon(e.needReverse?(C=e.positionInfo)==null?void 0:C.token_b:(n=e.positionInfo)==null?void 0:n.token_a)]]),yt(o("img",null,null,512),[[G,e.getCoinIcon(e.needReverse?(F=e.positionInfo)==null?void 0:F.token_a:(W=e.positionInfo)==null?void 0:W.token_b)]])]),o("span",null,N(e.needReverse?(a=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:a.symbol:(K=(oe=e.positionInfo)==null?void 0:oe.token_a)==null?void 0:K.symbol)+" - "+N(e.needReverse?(z=(Z=e.positionInfo)==null?void 0:Z.token_a)==null?void 0:z.symbol:(m=(P=e.positionInfo)==null?void 0:P.token_b)==null?void 0:m.symbol),1)]),o("div",Vn,N(e.$t("common.fee"))+" "+N(e.poolInfo.fee*100)+"%",1)],2),o("div",xn,[$e(T,{"current-status":e.positionInfo.currentStatus||""},null,8,["current-status"])]),o("div",eo,[(e.needReverse?!e.rateChange:e.rateChange)?(p(),H("div",to,[o("div",io,N(("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(String(e.positionInfo&&e.positionInfo.minPrice),6))),1),e.store.theme=="default"?(p(),H("img",no)):(p(),H("img",oo)),o("div",ao,N(e.positionInfo&&e.positionInfo.maxPrice.indexOf("âˆž")>-1||e.positionInfo&&e.positionInfo.maxPrice.indexOf("+")>-1?"âˆž":("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(String(e.positionInfo&&e.positionInfo.maxPrice),6)))+" "+N((b=(ee=e.positionInfo)==null?void 0:ee.token_b)==null?void 0:b.symbol)+" per "+N((g=(ve=e.positionInfo)==null?void 0:ve.token_a)==null?void 0:g.symbol),1)])):(p(),H("div",ro,[o("div",so,N(("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(String(1/Number(e.positionInfo&&e.positionInfo.maxPrice)),6))),1),e.store.theme=="default"?(p(),H("img",lo)):(p(),H("img",uo)),o("div",co,N(e.positionInfo&&e.positionInfo.maxPrice.indexOf("âˆž")>-1||e.positionInfo&&e.positionInfo.maxPrice.indexOf("+")>-1?"âˆž":("addCommom"in e?e.addCommom:X(Ie))(("decimalUi"in e?e.decimalUi:X(ie))(String(1/Number(e.positionInfo&&e.positionInfo.minPrice)),6)))+" "+N((D=(O=e.positionInfo)==null?void 0:O.token_a)==null?void 0:D.symbol)+" per "+N((k=(ke=e.positionInfo)==null?void 0:ke.token_b)==null?void 0:k.symbol),1)])),(p(),H("svg",{class:"icon-change","aria-hidden":"true",onClick:s[0]||(s[0]=E=>e.rateChange=!e.rateChange)},vo))])]),e.chainName=="Sui"?(p(),Ee(M,{key:0,disabled:("checkNullObj"in e?e.checkNullObj:X(ne))(e.positionInfo)||e.isAutoStakeFarming&&!e.positionInfo.clmm_pool_id,onClick:s[1]||(s[1]=E=>e.router.push(e.positionDetailUrl))},{default:Xe(()=>[Je(N(e.$t("newAdd.viewDetail")),1)]),_:1},8,["disabled"])):(p(),Ee(M,{key:1,disabled:("checkNullObj"in e?e.checkNullObj:X(ne))(e.positionInfo),onClick:s[2]||(s[2]=E=>e.router.push(`/new-position-detail?collect=${e.positionInfo.collectionName}&&token=${e.positionInfo.tokenName}&&address=${e.positionInfo.pool}&pos=${e.positionInfo.pos_object_id}`))},{default:Xe(()=>[Je(N(e.$t("newAdd.viewDetail")),1)]),_:1},8,["disabled"]))]}),_:1},8,["title"])}const go=tt(Gn,[["render",fo],["__scopeId","data-v-9a9a42f6"]]),po=et({props:{poolInfo:{type:Object,default:()=>({})},isActive:{type:Boolean,default:!0}},setup(e,s){const V=Pt(),x=f(()=>V),$=U(!1),se=U(),T=U(!0),M=st(),w=f(()=>M),G=f(()=>w.value.newTopPoolsObj);f(()=>x.value.farmsPoolList);const n=W=>{var K,v,a,P;const F=W[(K=e==null?void 0:e.poolInfo)==null?void 0:K.poolAddress]||{};let oe=0;F&&!ne(F)&&((a=(v=F==null?void 0:F.stable_farming)==null?void 0:v.stable_rewarder)==null||a.forEach(m=>{m.amount_second>0&&(oe+=m.amount_second)}),oe>0?($.value=!0,se.value={id:F.stable_farming.stable_farming_pool,clmm_pool_id:(P=e==null?void 0:e.poolInfo)==null?void 0:P.poolAddress},s.emit("sendFarmsPoolInfo",T.value&&e.isActive?se.value:"")):($.value=!1,s.emit("sendFarmsPoolInfo","")))};return Ne(()=>[G.value,e.poolInfo],([W,F])=>{W&&!ne(W)&&F&&!ne(F)&&n(W)},{immediate:!0}),Ne(()=>[e.isActive,T.value,se.value],([W,F,oe])=>{s.emit("sendFarmsPoolInfo",F&&e.isActive?oe:"")},{immediate:!0}),{isShowAutoStake:$,changeIsOpen:()=>{T.value=!T.value,s.emit("sendFarmsPoolInfo",T.value&&e.isActive?se.value:"")},isOpen:T}}}),bo=""+globalThis.__publicAssetsURL("sui-image/farming_huo.png"),ho=""+globalThis.__publicAssetsURL("sui-image/icon_sel@2x.png");const Ut=e=>(_t("data-v-20c0ad07"),e=e(),wt(),e),ko={key:0,class:"farms-auto-stake"},yo=Ut(()=>o("img",{class:"farms-icon",src:bo,alt:""},null,-1)),_o=Ut(()=>o("div",{class:"desc"},"Automatically stake your position into the farm to enjoy higher yield.",-1)),wo={key:0,src:ho,alt:""},Co=Ut(()=>o("div",{class:"check-box"},null,-1));function Po(e,s,V,x,$,se){const T=Ft;return e.isShowAutoStake?(p(),H("div",ko,[yo,_o,e.isActive?(p(),H("div",{key:0,class:"check-box-active",onClick:s[0]||(s[0]=(...M)=>e.changeIsOpen&&e.changeIsOpen(...M))},[e.isOpen?(p(),H("img",wo)):re("",!0)])):(p(),Ee(T,{key:1,"overlay-style":{"min-width":"200px"}},ki({default:Xe(()=>[Co]),_:2},[e.isActive?void 0:{name:"title",fn:Xe(()=>[Je("Farming rewards only available for active positions.")]),key:"0"}]),1024))])):re("",!0)}const Io=tt(po,[["render",Po],["__scopeId","data-v-20c0ad07"]]),So=et({components:{NewLiquidityTitle:Vt,NewLiquidityAssetsCard:xt,NewLiquidityDepositRatio:ei},setup(){const{t:e,locale:s}=Zt(),V=st(),x=f(()=>V),$=f(()=>x.value.chainName),se=Ct(),T=f(()=>se),M=vi(),w=f(()=>M),G=Ot(),n=f(()=>{let i=null;for(const u in T.value.poolsObj){const h=T.value.poolsObj[u];h.address==G.query.poolAddress&&(i=h)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:272 ~ constpoolInfo:any=computed ~ info:",i),i}),C=U(!1),W=U(!1),F=f(()=>x.value.theme),oe=async(i,u)=>{S.value=i.needReverse?i.token_b:i.token_a,y.value=i.needReverse?i.token_a:i.token_b,L.value="",q.value=""},K=f(()=>w.value.assets&&S.value&&w.value.assets[S.value.address]?zt(w.value.assets[S.value.address].balance,S.value.decimals):"0"),v=f(()=>w.value.assets&&y.value&&w.value.assets[y.value.address]?zt(w.value.assets[y.value.address].balance,y.value.decimals):"0"),a=i=>{i==="fromCoin"?(Te.value=!0,$.value==="Aptos"?L.value=Number(K.value)>0?S.value.symbol=="APT"?new r(Number(K.value)).sub(new r(.1)).lt(new r(0))?"0":new r(Number(K.value)).sub(new r(.1)).toString():String(K.value):"":L.value=Number(K.value)>0?S.value.symbol=="SUI"?new r(Number(K.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(K.value)).sub(new r(.05)).toString():String(K.value):""):(Te.value=!1,$.value==="Aptos"?q.value=Number(v.value)>0?y.value.symbol=="APT"?new r(Number(v.value)).sub(new r(.1)).lt(new r(0))?"0":new r(Number(v.value)).sub(new r(.1)).toString():String(v.value):"":q.value=Number(v.value)>0?y.value.symbol=="SUI"?new r(Number(v.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(v.value)).sub(new r(.05)).toString():String(v.value):"")},P=i=>{i==="fromCoin"?(Te.value=!0,L.value=Number(K.value)>0?qt(new r(Number(K.value)).div(2).toString(),S.value.decimals).toString():""):(Te.value=!1,q.value=Number(v.value)>0?qt(new r(Number(v.value)).div(2).toString(),y.value.decimals).toString():"")},m=U(),Z=U(),z=U(),ee=U(!1),b=i=>{var u,h,pe,Q;m.value=i,i==="fromCoin"?(Z.value=((u=y.value)==null?void 0:u.address)||"",z.value=G.query.actions=="new-position"?(h=S.value)==null?void 0:h.address:n.value.needReverse?n.value.token_b.address:n.value.token_a.address):(Z.value=((pe=S.value)==null?void 0:pe.address)||"",z.value=G.query.actions=="new-position"?(Q=y.value)==null?void 0:Q.address:n.value.needReverse?n.value.token_a.address:n.value.token_b.address),ee.value=!0},ve=i=>{var pe,Q,Ce,Pe,be,ye,_e,Se;const u=n.value.needReverse?n.value.token_b:n.value.token_a,h=n.value.needReverse?n.value.token_a:n.value.token_b;m.value==="fromCoin"?(((pe=S.value)==null?void 0:pe.address)===(u==null?void 0:u.address)||!((Q=S.value)!=null&&Q.address)?(y.value&&i.address.toLowerCase()===((Ce=y)==null?void 0:Ce.value.address.toLowerCase())&&(y.value=null),S.value=i):(S.value&&i.address.toLowerCase()===((Pe=S)==null?void 0:Pe.value.address.toLowerCase())&&(S.value=null),y.value=i),G.query.action||(G.query.fee="")):((be=y.value)==null?void 0:be.address)===(h==null?void 0:h.address)||!((ye=y.value)!=null&&ye.address)?(S.value&&i.address.toLowerCase()===((_e=S)==null?void 0:_e.value.address.toLowerCase())&&(S.value=null),y.value=i):(y.value&&i.address.toLowerCase()===((Se=y)==null?void 0:Se.value.address.toLowerCase())&&(y.value=null),S.value=i),ee.value=!1},g=f(()=>x.value.chainName?Rt(x.value.chainName):{}),O=f(()=>x.value.slippage),D=U(),ke=async()=>{var je,Oe,Re,Ze;if(De.value||!B.value&&!_.value)return!1;if(!L.value&&!q.value&&!B.value&&!_.value)return;const i=n.value||{};if(ne(i))return;const{TickUtil:u,TickMath:h,getNearestTickByTick:pe}=g.value,Q=i==null?void 0:i.token_a.decimals,Ce=i==null?void 0:i.token_b.decimals;let Pe,be,ye,_e,Se,Fe,We,Ke,he=i==null?void 0:i.current_tick_index;if(!he&&(i==null?void 0:i.current_tick_index)!==0)return;let ce;if(i.token_a.address.toLowerCase()===S.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===y.value.address.toLowerCase()?ce=!0:ce=!1,B.value==="0"&&_.value==="âˆž")ye=u.getMinIndex(Number(i.tickSpacing)),_e=u.getMaxIndex(Number(i.tickSpacing)),Se=h.tickIndexToSqrtPriceX64(ye),Fe=h.tickIndexToSqrtPriceX64(_e);else if(Y.value=="custom"){ce?(Pe=B.value,be=_.value):(Pe=_.value!=="âˆž"?new r(1).div(_.value).toString():1/0,be=new r(1).div(B.value).toString());try{We=new r(Pe).equals(new r(0))?-443636:h.priceToTickIndex(new r(Pe),Q,Ce)}catch{We=-443636}try{Ke=h.priceToTickIndex(new r(be),Q,Ce)}catch{Ke=443636}ye=pe(We,Number(i.tickSpacing),!0),_e=pe(Ke,Number(i.tickSpacing),!0);try{Se=h.priceToSqrtPriceX64(new r(Pe),Q,Ce)}catch{(be===1/0||be==="âˆž")&&(Se=h.tickIndexToSqrtPriceX64(u.getMinIndex(Number(i.tickSpacing))))}try{Fe=h.priceToSqrtPriceX64(new r(be),Q,Ce)}catch{(be===1/0||be==="âˆž")&&(Fe=h.tickIndexToSqrtPriceX64(u.getMaxIndex(Number(i.tickSpacing))))}}else ye=(je=xe.value[Y.value])==null?void 0:je.lower,_e=(Oe=xe.value[Y.value])==null?void 0:Oe.upper,Se=h.tickIndexToSqrtPriceX64(ye),Fe=h.tickIndexToSqrtPriceX64(_e);if(_.value!=="âˆž"&&ye>=_e){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:639 ~ updateAmounts ~",_.value!=="âˆž"&&ye>=_e),C.value=!0,L.value="",W.value=!0,q.value="";return}if(_.value==="âˆž"||he>=ye&&he<_e){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:708 ~ updateAmounts ~ currentTickIndex:",he),C.value=!1,W.value=!1;let de;if(L.value||q.value){if(Te.value){const Tt=new r(L.value).mul(Math.pow(10,S.value.decimals)).toString();de=new ze(Tt)}else{const Tt=new r(q.value).mul(Math.pow(10,y.value.decimals)).toString();de=new ze(Tt)}h.tickIndexToSqrtPriceX64(n.value.current_tick_index);const{liquidityAmount:Be,tokenMaxA:Ge,tokenMaxB:gt,tokenMaxAOrigin:ui,tokenMaxBOrigin:ci}=g.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.token_a,tokenB:i.token_b,lowerTick:ye,upperTick:_e,coinAmount:de,iscoinA:ce?Te.value:!Te.value,roundUp:!0,slippage:Number(O.value)/100,curSqrtPrice:new ze(n.value.current_sqrt_price)});D.value={liquidityAmount:Be,tokenMaxA:Ge,tokenMaxB:gt,tokenMaxAOrigin:ui,tokenMaxBOrigin:ci},ce?Te.value?q.value=Number(gt)>0?gt:"":L.value=Number(Ge)>0?Ge:"":Te.value?q.value=Ge:L.value=gt}}else if(he>=_e){if(ce?L.value="":q.value="",C.value=ce,W.value=!ce,L.value||q.value){let de;if(ce){const Be=new r(q.value).mul(Math.pow(10,(Re=y.value)==null?void 0:Re.decimals)).toString();de=new ze(Be),D.value={liquidityAmount:g.value.estimateLiquidityForCoinB(Se,Fe,de),tokenMaxA:0,tokenMaxB:q.value}}else{const Be=new r(L.value).mul(Math.pow(10,(Ze=S.value)==null?void 0:Ze.decimals)).toString();de=new ze(Be),D.value={liquidityAmount:g.value.estimateLiquidityForCoinB(Se,Fe,de),tokenMaxA:0,tokenMaxB:L.value}}}}else if(he<ye){if(C.value=!ce,W.value=ce,ce?q.value="":L.value="",L.value||q.value){let de;if(ce){const Be=new r(L.value).mul(Math.pow(10,S.value.decimals)).toString();de=new ze(Be),D.value={liquidityAmount:g.value.estimateLiquidityForCoinA(Se,Fe,de),tokenMaxA:L.value,tokenMaxB:0}}else{const Be=new r(q.value).mul(Math.pow(10,y.value.decimals)).toString();de=new ze(Be),D.value={liquidityAmount:g.value.estimateLiquidityForCoinA(Se,Fe,de),tokenMaxA:q.value,tokenMaxB:0}}}}else C.value=!0,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:783 ~ updateAmounts ~ showFromCoinLock.value:",C.value),L.value="",W.value=!0,q.value=""};Ne(()=>n.value,(i,u)=>{(!u&&i&&!ne(i)||u&&i&&u.address!==i.address)&&oe(i,!u||i.address!==u.address),i&&!ne(i)&&ke()},{immediate:!0}),Ne(L,(i,u)=>{i==""&&Te.value&&(q.value=""),i&&Te.value&&!De.value&&ke()}),Ne(q,(i,u)=>{i==""&&!Te.value&&(L.value=""),i&&!Te.value&&!De.value&&ke()}),Ne(()=>we.value,(i,u)=>{ke()}),Ne(()=>[S.value,y.value],([i,u])=>{i&&u&&(C.value=!1,W.value=!1)});const k=U("--"),E=f(()=>T.value.RATES),ue=()=>{const i=E.value&&E.value[S.value.address]&&E.value[S.value.address].price,u=E.value&&E.value[y.value.address]&&E.value[y.value.address].price;if(i&&u){const h=new r(L.value>0?L.value:0).mul(i),pe=new r(q.value>0?q.value:0).mul(u),Q=h.add(pe).toNumber();k.value=Q>0&&Q<.01?"<$0.01":"$"+Ie(Q,2)}else k.value="--"};Ne(()=>[L.value,q.value,De.value],([i,u,h])=>{(i||u)&&!h?ue():(!i||!u)&&!h&&(k.value="--")},{immediate:!0});const me=U(),J=async()=>{var ce,je;if(!B.value&&!_.value)return!1;if(!L.value&&!q.value&&!B.value&&!_.value)return;const i=n.value;if(ne(i))return;const{TickUtil:u,TickMath:h,getNearestTickByTick:pe}=g.value,Q=i==null?void 0:i.token_a.decimals,Ce=i==null?void 0:i.token_b.decimals;let Pe,be,ye,_e,Se,Fe,We;if(i.token_a.address.toLowerCase()===S.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===y.value.address.toLowerCase()?We=!0:We=!1,B.value==="0"&&_.value==="âˆž")ye=u.getMinIndex(Number(i.tickSpacing)),_e=u.getMaxIndex(Number(i.tickSpacing));else if(Y.value=="custom"){We?(Pe=Number(B.value),be=Number(_.value)):(Pe=new r(1).div(_.value).toString(),be=new r(1).div(B.value).toString());try{Se=Pe==0?-443636:h.priceToTickIndex(new r(Pe),Q,Ce)}catch{Se=-443636}try{Fe=h.priceToTickIndex(new r(be),Q,Ce)}catch{Fe=443636}ye=pe(Se,Number(i.tickSpacing),!0),_e=pe(Fe,Number(i.tickSpacing),!0)}else ye=(ce=xe.value[Y.value])==null?void 0:ce.lower,_e=(je=xe.value[Y.value])==null?void 0:je.upper;const Ke=E.value[i==null?void 0:i.token_a.address].price,he=E.value[i==null?void 0:i.token_b.address].price;we.value?new ze(i.current_sqrt_price):new ze(1/i.current_sqrt_price);try{const{amountA:Oe,amountB:Re,tokenAmountsInfo:Ze}=await g.value.estCoinAmountsFromTotalAmount({lowerTick:ye,upperTick:_e,decimalsA:Q,decimalsB:Ce,curSqrtPrice:new ze(i.current_sqrt_price),totalAmount:k.value.replace(/[^\d.]/g,""),tokenPriceA:Ke,tokenPriceB:he});me.value=Ze,i.needReverse?we.value?(L.value=Oe,q.value=Re):(L.value=Re,q.value=Oe):(L.value=Oe,q.value=Re)}catch(Oe){console.log(Oe,"e===>")}};Ne([B,_],([i,u])=>{De.value?De.value&&J():ke(),u!=="âˆž"&&Number(i)!==0&&Number(u)!==0&&Number(i)>=Number(u)?at.value=!0:at.value=!1,Number(i)==0&&Number(u)==0&&vt.value&&(at.value=!0)},{deep:!0,immediate:!0});const He=i=>{const u=i.replace(/[^\d.]/g,""),h="$"+Ie(u);De.value=!0,k.value=h,u>0?J():(L.value="",q.value="")},R=U(!1),{setTransactionTxid:fe,setTransactionDesc:Qe,setIsShowWaiting:Me,setIsShowSuccess:lt,setPositiomNum:it,setIsShowRejected:Ye}=V,Ve=Mi(),ae=f(()=>T.value.currentPositionInfo),ut=U(!1),Ae=U(!0),t=Pt(),d=f(()=>t),A=f(()=>d.value.farmsPoolObj);Ne(()=>[A.value,n.value],([i,u])=>{i&&!ne(i)&&u&&!ne(u)&&(i[u.address]||(Ae.value=!1))},{immediate:!0});const I=U(),j=U(),ge=i=>{I.value=i,i?Ae.value=!0:Ae.value=!1},Le=async(i,u,h,pe)=>{try{u=="farming"?await T.value.setCurrentPositionInfo("","","","Sui",h,"farming"):await T.value.setCurrentPositionInfo(i,"","",$.value,pe),await fi(3e3),Ae.value?await Ve.subscribePosition({pool_address:ae.value.clmm_pool_id,position_index:ae.value.name.split("-")[1]},ae.value.clmm_position_id):await Ve.subscribePosition({pool_address:ae.value.poolAddress,position_index:ae.value.index},ae.value.nftHash)}catch(Q){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1151 ~ notifiSubscribePosition ~ error:",Q)}},l=async i=>{var Se,Fe,We,Ke;R.value=!1,T.value.currentPositionInfo={},fe(""),Qe(e("tips.increaseLiquiditySuccess",{from:C.value?"":`${Ie(L.value)} ${(Se=S.value)==null?void 0:Se.symbol}`,and:!C.value&&!W.value?"and":"",to:W.value?"":`${Ie(q.value)} ${(Fe=y.value)==null?void 0:Fe.symbol}`})),Me(!0);const u=we.value?Te.value:!Te.value;let h,pe,Q,Ce,Pe,be;const ye=n.value.token_a.decimals,_e=n.value.token_b.decimals;if(B.value==="0"&&_.value==="âˆž")Q=g.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),Ce=g.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing));else if(Y.value=="custom"){we.value?(h=B.value,pe=_.value):(h=new r(1).div(_.value).toString(),pe=new r(1).div(B.value).toString());try{Pe=h==0?g.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)):g.value.TickMath.priceToTickIndex(new r(h),ye,_e)}catch{Pe=g.value.TickUtil.getMinIndex(Number(n.value.tickSpacing))}try{be=g.value.TickMath.priceToTickIndex(new r(pe),ye,_e)}catch{be=g.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))}Q=g.value.getNearestTickByTick(Pe,Number(n.value.tickSpacing),!0),Ce=g.value.getNearestTickByTick(be,Number(n.value.tickSpacing),!0)}else Q=xe.value[Y.value].lower,Ce=xe.value[Y.value].upper;try{let he;De.value?he=await g.value.getCreateAddLiquidityPayload({pool:n.value,curSqrtPrice:new ze(n.value.current_sqrt_price),tickLower:Q,tickUpper:Ce,slippage:Number(O.value)/100,tokenAmounts:me.value}):he=await g.value.getAddLiquidityTransactionPayload({pool:{poolAddress:n.value.poolAddress,token_a:n.value.token_a,token_b:n.value.token_b},amount:Te.value?L.value:q.value,fix_amount_a:u,tick_lower:Q,tick_upper:Ce,index:0,slippage:Number(O.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new ze(n.value.current_sqrt_price),farmPoolInfo:I.value});let ce;if($.value==="Aptos")ce=await w.value.currentWallet.signAndSubmitTransaction(he);else{const je=await g.value.signAndExecuteTransactionBlock(w.value.currentWallet,he==null?void 0:he.txb,he==null?void 0:he.payloadParams);ce=g.value.handleTx(je)}if(console.log("0410###tx###",ce),ce&&ce.hash){fe(ce.hash),Me(!1),lt(!0);let je;n.value.needReverse?n.value.token_a.address.toLowerCase()===S.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?je=!1:je=!0:n.value.token_a.address.toLowerCase()===S.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===y.value.address.toLowerCase()?je=!0:je=!1;const Oe={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:C.value?"":`${Ie(L.value)} ${(We=S.value)==null?void 0:We.symbol}`,and:!C.value&&!W.value?"and":"",to:W.value?"":`${Ie(q.value)} ${(Ke=y.value)==null?void 0:Ke.symbol}`}),hash:ce.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};$.value!=="Aptos"&&(Oe.res=ce.res),g.value.showTransitionPending(Oe),console.log(Oe,"toAdd params###");const Re=await g.value.watchTransaction(Oe,!0);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1295 ~ toAdd ~ watchInfo:",Re),Re.status){lt(!1),T.value.setCurrentPositionLoading(!0);let Ze,de;$.value==="Aptos"?j.value={token_a:n.value.token_a,token_b:n.value.token_b,minPrice:B.value,maxPrice:_.value,pool:n.value.address,collection:Re.nftInfo[0].data.id.collection,tokenName:Re.nftInfo[0].data.name}:(de=Re.nftInfo,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1319 ~ toAdd ~ nftInfo:",de),Ae.value?(Re.res.events.forEach(Ge=>{Ge.type.indexOf("::pool::DepositEvent")>-1&&(Ze=Ge.parsedJson.wrapped_position_id)}),j.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:B.value,maxPrice:_.value,id:Ze,clmm_pool_id:n.value.address,pool:n.value.address}):j.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:B.value,maxPrice:_.value,pos_object_id:de.position,pool:n.value.address},console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1389 ~ toAdd ~ positionInfoDetail:",j.value)),ut.value=!0;const Be=n.value.poolAddress;setTimeout(()=>{if(i){const Ge=Ze?"farming":"clmm";console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1400 ~ setTimeout ~ poolInfo.value.poolAddress:",Be),Le(Be,Ge,Ze,de==null?void 0:de.position)}},3e3),setTimeout(()=>{se.updateCurrentPools(Be,$.value),g.value.getAccount(w.value.address)},3e3),setTimeout(async()=>{Et(g,n)},7e3)}it()}else Me(!1),Ye(!0);L.value="",q.value=""}catch(he){L.value="",q.value="",console.log("0330###Add liquidity Error###",he),Me(!1),Ye(!0)}},c=f(()=>!!(!L.value&&!q.value||Number(L.value)>Number(K.value)||Number(q.value)>Number(v.value)||te.value!==e("button.addLiquidity")&&te.value!==e("newAdd.preview")||n.value&&n.value&&n.value.is_pause||Number(L.value)<=0&&Number(q.value)<=0||!C.value&&Number(L.value)==0||!W.value&&Number(q.value)==0)),qe=f(()=>!S.value||!y.value),te=f(()=>n.value&&n.value.is_pause?"Pool Closed":!S.value||!y.value||qe.value?e("modal.selectTokenModalTitle"):Number(L.value)>Number(K.value)?e("button.insufficientBalance",{name:S.value.symbol}):Number(q.value)>Number(v.value)?e("button.insufficientBalance",{name:y.value.symbol}):!Number(L.value)&&!Number(q.value)?e("button.enterAmount"):_.value!=="âˆž"&&Number(B.value)>=Number(_.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),le=U({}),ct=U({}),dt=U(!1),nt=(i,u)=>{const h=localStorage.getItem(i.address);console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1518 ~ getTokenSource ~ coinLocak:",h,i),i!=null&&i.isSelfBuilt&&!h&&(u=="fromCoin"&&(le.value=i),u=="toCoin"&&(ct.value=i),dt.value=!0)};Ne(()=>[S.value,y.value],([i,u])=>{i&&!ne(i)&&nt(i,"fromCoin"),u&&!ne(u)&&nt(u,"toCoin")},{immediate:!0});const mt=Kt(),It=()=>{$.value!=="Aptos"?mt.push("/pool/list"):mt.push("/pools")},ft=i=>{De.value,l(i)},St=()=>{G.query.action!=="create-pool"&&G.query.actions!=="new-position"&&(Et(g,n),ke(),w.value.address&&g.value.getAccount(w.value.address),se.updateCurrentPools(n.value.poolAddress,$.value)),se.setPoolConfigList($.value,x.value.filterCoinsObj)},li=f(()=>{var h,pe,Q,Ce,Pe,be;const i=(Q=E.value[(pe=(h=S)==null?void 0:h.value)==null?void 0:pe.address])==null?void 0:Q.price,u=(be=E.value[(Pe=(Ce=y)==null?void 0:Ce.value)==null?void 0:Pe.address])==null?void 0:be.price;return!!(i&&u)});return Ne(()=>[G,T.value.tokensObj],([i,u])=>{var h;u&&!ne(u)&&(y.value||(y.value=T.value.tokensObj[(h=i==null?void 0:i.query)==null?void 0:h.toCoin]))},{immediate:!0,deep:!0}),{positionError:at,decimalUi:ie,poolInfo:n,fromCoinAmount:L,toCoinAmount:q,fromCoin:S,toCoin:y,theme:F,showFromCoinLock:C,showToCoinLock:W,fromCoinBlance:K,toCoinBlance:v,maxBtnSelect:a,halfBtnSelect:P,fixedFromCoin:Te,openCoinSelect:b,currentCoinKey:m,existingCoins:Z,lastSelectCoin:z,showCoinSelect:ee,onCoinSelect:ve,liquidityTotalAmount:k,toggle:ti,onInput:He,isInputTotalAmount:De,isViewDetail:ut,addLiquidityBtnDisabled:c,addLiquidityBtnText:te,isShowTokenWarning:dt,chainName:$,closeTokenWarning:It,warningFromCoin:le,warningToCoin:ct,isShowLiquidityModal:R,currentPrice:vt,currentPriceReverse:kt,currentPriceTab:Y,minPrice:B,maxPrice:_,toAdd:l,direction:we,wallet:w,getAddLiquidityType:ft,clickRefresh:St,isShowtotalAmount:li,isAutoStakeFarming:Ae,farmPoolInfo:I,getFarmsPoolInfo:ge,positionInfoDetail:j,getTokenSource:nt}}});const To={class:"new-liquidity-right"},No={class:"deposit-title"},Ao={class:"card-container"},Lo={key:0,class:"lock"},qo={class:"card-item"},$o={class:"card-item"},Mo={key:0,class:"total-amount"},Fo=o("span",null,"Total Amount",-1);function Oo(e,s,V,x,$,se){const T=Vt,M=Ii,w=xt,G=Ti,n=ei,C=Qt,W=Ni,F=go,oe=$i,K=Io;return p(),H("div",To,[o("div",No,[$e(T,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),o("div",Ao,[e.positionError?(p(),H("div",Lo,[$e(M)])):re("",!0),o("div",qo,[$e(w,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":s[0]||(s[0]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:s[1]||(s[1]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:s[2]||(s[2]=v=>e.halfBtnSelect("fromCoin")),onOnInput:s[3]||(s[3]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.positionError?(p(),Ee(G,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):re("",!0)]),o("div",$o,[$e(w,{modelValue:e.toCoinAmount,"onUpdate:modelValue":s[4]||(s[4]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:s[5]||(s[5]=v=>e.maxBtnSelect("toCoin")),onOnHalf:s[6]||(s[6]=v=>e.halfBtnSelect("toCoin")),onOnInput:s[7]||(s[7]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.positionError?(p(),Ee(G,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):re("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(p(),H("img",{key:1,class:"add",src:Li,alt:"",onClick:s[8]||(s[8]=(...v)=>e.toggle&&e.toggle(...v))})):re("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(p(),H("img",{key:2,class:"add",src:qi,alt:"",onClick:s[9]||(s[9]=(...v)=>e.toggle&&e.toggle(...v))})):re("",!0)]),e.isShowtotalAmount?(p(),H("div",Mo,[Fo,o("span",null,N(e.liquidityTotalAmount),1)])):re("",!0),$e(n,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),$e(C,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:s[10]||(s[10]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Xe(()=>[Je(N(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(p(),Ee(W,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:s[11]||(s[11]=v=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):re("",!0),e.isViewDetail?(p(),Ee(F,{key:2,"pool-info":e.poolInfo,"farm-pool-info":e.farmPoolInfo,"position-info":e.positionInfoDetail,"is-auto-stake-farming":e.isAutoStakeFarming,onOnClose:s[12]||(s[12]=v=>e.isViewDetail=!1)},null,8,["pool-info","farm-pool-info","position-info","is-auto-stake-farming"])):re("",!0),e.isShowLiquidityModal?(p(),Ee(oe,{key:3,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:s[13]||(s[13]=v=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):re("",!0),e.chainName=="Sui"?(p(),Ee(K,{key:4,"pool-info":e.poolInfo,"is-active":!e.showFromCoinLock&&!e.showToCoinLock,"is-auto-stake-farming":e.isAutoStakeFarming,onSendFarmsPoolInfo:e.getFarmsPoolInfo},null,8,["pool-info","is-active","is-auto-stake-farming","onSendFarmsPoolInfo"])):re("",!0)])}const si=tt(So,[["render",Oo]]),Ro=et({components:{NewLiquidityLeft:ri,NewLiquidityRight:si},setup(){const e=Pt(),s=f(()=>e),V=f(()=>s.value.farmsPoolObj);Gt(()=>{Si(),se.setPoolsLoading(!0)}),Ne(()=>V.value,T=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: deposit.vue:41 ~ watch ~ newVal:",T),T&&ne(T)&&e.getFarmsPoolList(!0)},{immediate:!0});const x=Ot(),$=st();f(()=>$);const se=Ct();return{tickList:ot,route:x}}});const Bo={key:0,class:"loading-spin-liquidity loading-global"},Uo={class:"privide-liquidity"};function jo(e,s,V,x,$,se){var G,n;const T=Wt,M=ri,w=si;return p(),H(Mt,null,[!e.tickList&&((n=(G=e.route)==null?void 0:G.query)!=null&&n.poolAddress)?(p(),H("div",Bo,[$e(T)])):re("",!0),o("div",Uo,[$e(M),$e(w)])],64)}const ha=tt(Ro,[["render",jo],["__scopeId","data-v-14b489b7"]]);export{ha as default};
