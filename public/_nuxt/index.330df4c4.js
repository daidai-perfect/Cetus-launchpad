var me=Object.defineProperty;var ge=(e,s,t)=>s in e?me(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var b=(e,s,t)=>(ge(e,typeof s!="symbol"?s+"":s,t),t);import{ag as fe,ah as S,ai as F,aj as g,ak as J,al as d,am as j,an as k,ao as P,ap as q,F as p,aq as K,ar as c,as as h,at as m,au as A,av as re,aw as te,ax as M,af as T,T as H,ay as se,az as G,aA as ee,aB as z,aC as ke,D as x,aD as ye,aE as ce,aF as de,aG as X,aH as ie,aI as be,aJ as ve,f as Q,aK as we}from"./pool.771f7a64.js";var Z="router",B=1e4,$=class{static buildPoolImmutables(e){const{fields:s}=e.value.fields.value;return{clmm_pool_id:p(s.clmm_pool_id).address,booster_type:p(s.booster_type.fields.name).source_address,pool_id:p(s.pool_id).address,coinTypeA:p(s.coin_type_a.fields.name).source_address,coinTypeB:p(s.coin_type_b.fields.name).source_address}}static buildPoolState(e){const s=k(e),t=[];return s.config.fields.contents.forEach(n=>{t.push({lock_day:Number(n.fields.key),multiplier:Number(c(n.fields.value).div(B))})}),{basic_percent:Number(c(s.basic_percent).div(B)),balances:{balances_handle:s.balances.fields.id.id,size:s.balances.fields.size},config:t,lock_positions:{lock_positions_handle:s.lock_positions.fields.id.id,size:s.lock_positions.fields.size},is_open:s.is_open,index:Number(s.index),pool_id:X(e)}}static buildLockNFT(e){const s=p(X(e)).address;return{lock_clmm_position:te(e),locked_nft_id:s}}static buildLockPositionInfo(e){const s=k(e),{value:t}=s.value.fields;return{type:t.type,position_id:t.fields.position_id,start_time:Number(t.fields.start_time),lock_period:Number(t.fields.lock_period),end_time:Number(t.fields.end_time),growth_rewarder:t.fields.growth_rewarder,rewarder_owned:t.fields.rewarder_owned,is_settled:t.fields.is_settled}}static isLocked(e){return e.end_time>Date.parse(new Date().toString())/1e3}},Ce=class{constructor(e){b(this,"_sdk");b(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=!1){var o;const{booster:s}=this._sdk.sdkOptions,t=`${s.package_id}_getPoolImmutables`,i=this.getCache(t,e),n=[];if(i!==void 0)n.push(...i);else{const a=[];(o=(await J(this._sdk.ClmmSDK,d(s).booster_pool_handle)).data)==null||o.forEach(u=>{a.push(u.objectId)});const _=await j(this._sdk.ClmmSDK,a,{showContent:!0});for(const u of _){const l=k(u);if(l){const f=$.buildPoolImmutables(l);this.updateCache(`${f.pool_id}_getPoolImmutable`,f,g),n.push(f)}}}return this.updateCache(t,n,g),n}async getPoolImmutable(e){const{booster:s}=this._sdk.sdkOptions,t=`${e}_getPoolImmutable`,i=this.getCache(t);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:d(s).booster_pool_handle,name:{type:"0x2::object::ID",value:e}}),o=k(n),a=$.buildPoolImmutables(o);return this.updateCache(t,a,g),a}async getPools(){const e=[],t=(await this.getPoolImmutables()).map(n=>n.pool_id),i=await j(this._sdk.ClmmSDK,t,{showType:!0,showContent:!0});for(const n of i){const o=$.buildPoolState(n);if(o){const a={...await this.getPoolImmutable(o.pool_id),...o};e.push(a);const r=`${a.pool_id}_getPoolObject`;this.updateCache(r,a,g)}}return e}async getPool(e,s=!0){const t=`${e}_getPoolObject`,i=this.getCache(t,s),n=await this.getPoolImmutable(e);if(i!==void 0)return{...n,...i};const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),a=$.buildPoolState(o),r={...n,...a};return this.updateCache(t,r,g),r}async getPoolHandleId(e){const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),t=k(s);return t?t.list.fields.id.id:""}async getBoosterInitConfigs(){var i;const{package_id:e}=this.sdk.sdkOptions.booster,s=(i=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::config::InitEvent`}))==null?void 0:i.data,t={booster_config_id:"",booster_pool_handle:""};return s.length>0&&s.forEach(n=>{const o=n.parsedJson;o&&(t.booster_config_id=o.config_id)}),t.booster_pool_handle=await this.getPoolHandleId(t.booster_config_id),t}async getOwnerBoosterPositions(e,s,t){const{booster:i}=this.sdk.sdkOptions,n=[],o=[],a=`${i.package_id}::lock_nft::LockNFT<${this._sdk.ClmmSDK.Position.buildPositionType()}>`,r=await q(this._sdk.ClmmSDK,e,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{StructType:a}});for(const u of r.data)if(p(K(u)).source_address===a&&u.data){const f=$.buildLockNFT(u);this.updateCache(`${f.locked_nft_id}_getBoosterPositionById`,f,g),f&&(s===void 0||s===f.lock_clmm_position.pool)&&n.push(f)}const _=await this.getLockPositionInfos(t,n.map(u=>u.locked_nft_id));for(const u of n)for(const l of _)if(u.lock_clmm_position.pos_object_id===l.position_id){o.push({...u,...l});break}return o}async getBoosterPosition(e,s){const t=`${s}_getBoosterPositionById`,i=this.getCache(t);let n;if(i!==void 0)n=i;else{const a=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0,showOwner:!0}});n=$.buildLockNFT(a),this.updateCache(t,n,g)}const o=await this.getLockPositionInfo(e,s);return{...n,...o}}async getLockPositionInfos(e,s=[]){var o;const t=await J(this._sdk.ClmmSDK,e),i=[],n=[];return(o=t.data)==null||o.forEach(a=>{s.length>0?s.includes(a.name.value)&&i.push(a.objectId):i.push(a.objectId)}),i.length>0&&(await j(this._sdk.ClmmSDK,i,{showContent:!0})).forEach(r=>{const _=$.buildLockPositionInfo(r);_&&n.push(_)}),n}async getLockPositionInfo(e,s){const t=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:s}});return $.buildLockPositionInfo(t)}calculateXCetusRewarder(e,s,t){let i=s.basic_percent,n="0";e.forEach(r=>{r.coin_address===s.booster_type&&(console.log("find ",s.booster_type),n=r.amount_owed.toString())}),t.is_settled||s.config.forEach(r=>{r.lock_day===t.lock_period&&(i=r.multiplier)});const o=c(n).sub(t.growth_rewarder).mul(i);return c(t.rewarder_owned).add(o).toString()}lockPositionPayload(e){const{booster:s}=this.sdk.sdkOptions,{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions,i=new h;return i.moveCall({target:`${s.published_at}::${Z}::lock_position`,typeArguments:[e.booster_type,e.coinTypeA,e.coinTypeB],arguments:[i.pure(d(s).booster_config_id),i.pure(d(t).global_config_id),i.pure(e.booster_pool_id),i.pure(e.clmm_pool_id),i.pure(e.clmm_position_id),i.pure(e.lock_day),i.pure(m)]}),i}canceLockPositionPayload(e){const{booster:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${Z}::cancel_lock`,typeArguments:[e.booster_type],arguments:[t.pure(d(s).booster_config_id),t.pure(e.booster_pool_id),t.pure(e.lock_nft_id),t.pure(m)]}),t}redeemPayload(e){const{booster:s,xcetus:t}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,n=new h,o=d(t);return n.moveCall({target:`${s.published_at}::${Z}::redeem`,typeArguments:[e.booster_type,e.coinTypeA,e.coinTypeB],arguments:[n.pure(d(s).booster_config_id),n.pure(d(i).global_config_id),n.pure(e.booster_pool_id),n.pure(e.lock_nft_id),n.pure(e.clmm_pool_id),n.pure(o.lock_manager_id),n.pure(o.xcetus_manager_id),n.pure(e.ve_nft_id),n.pure(m)]}),n}updateCache(e,s,t=A){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}},D="router",_e=1e9,C=class{static priceRealToFix(e,s,t){const i=c(s-t).toNumber();return Number(c(e).div(c(10).pow(c(i))).toString())}static priceFixToReal(e,s,t){const i=c(s-t).toNumber();return Number(c(e).mul(c(10).pow(c(i))).toString())}static raiseTotalAmount(e,s,t){const i=c(s-t).abs().toNumber();return s>t?Number(c(e.total_supply).mul(e.current_price).div(c(10).pow(c(i))).toString()):Number(c(e.total_supply).mul(e.current_price).mul(c(10).pow(c(i))).toString())}static buildLaunchPadPool(e){const s=K(e),t=p(s),i=k(e),n={coin_type_sale:t.type_arguments[0],coin_type_raise:t.type_arguments[1],pool_address:z(X(e)),is_settle:i.is_settle,current_price:c(i.initialize_price).div(c(_e)).toString(),price:i.initialize_price,min_price:"0",max_price:"0",sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,total_purchase_amount:i.reality_raise_total,total_supply:i.sale_total,min_purchase:i.min_purchase,max_purchase:i.max_purchase,complete_raise_limit:i.least_raise_amount,softcap:i.softcap,max_raise_amount:i.hardcap,sale_decimals:0,raise_decimals:0,liquidity_injection_ratio:Number(i.liquidity_rate)/1e4,is_cancel:i.is_cancel,duration_summary:{start_time:Number(i.duration_manager.fields.start_time),end_time:0,settle_end_time:0,purchase_duration:Number(i.duration_manager.fields.activity_duration),settle_duration:Number(i.duration_manager.fields.settle_duration),lock_up_duration:Number(i.duration_manager.fields.locked_duration)},white_summary:{white_handle:i.white_list.fields.users.fields.id.id,protection_hard_cap:i.white_list.fields.hard_cap_total,protection_limit_used:i.white_list.fields.purchase_total,size:Number(i.white_list.fields.users.fields.size)},unused_sale:i.unused_sale,harvest_raise:i.harvest_raise,tick_spacing:Number(i.tick_spacing),owner:i.recipient,purchase_summary:{purchase_handle:i.purchase_list.fields.id.id,size:Number(i.purchase_list.fields.size)},pool_status:"Failed"};return C.updatePoolStatus(n),n}static updatePoolStatus(e){const s=Number(c(Date.now()/1e3).toFixed(0)),{duration_summary:t}=e,i=t.start_time+t.purchase_duration,n=i+t.settle_duration;if(t.end_time=i,t.settle_end_time=n,e.is_settle)e.pool_status="Ended";else if(e.is_cancel)e.pool_status="Canceled";else if(s<t.start_time)e.pool_status="Upcoming";else if(s>t.start_time&&s<i)e.pool_status="Live";else if(s>i&&s<n){const o=e.raise_coin_amount;Number(o)<Number(e.complete_raise_limit)?e.pool_status="Failed":e.pool_status="Settle"}return e}static async calculatePoolPrice(e,s){const t=await e.ClmmSDK.CetusConfig.getTokenListByCoinTypes([s.coin_type_sale,s.coin_type_raise]),i=t[s.coin_type_sale].decimals,n=t[s.coin_type_raise].decimals;s.min_price=this.priceFixToReal(Number(c(s.softcap).div(c(s.total_supply))),i,n).toString(),s.max_price=this.priceFixToReal(Number(c(s.max_raise_amount).div(c(s.total_supply))),i,n).toString(),s.current_price=this.priceFixToReal(Number(s.current_price),i,n).toString(),s.sale_decimals=i,s.raise_decimals=n}static async getWithdrawRaise(e){return e.pool_status==="Ended"?e.harvest_raise:"0"}static async getWithdrawSale(e){return e.pool_status==="Ended"?e.unused_sale:e.sale_coin_amount}static async getHistoryWithdrawRaise(e,s){if(s.pool_status==="Ended"){if(c(s.harvest_raise).equals(c(0))){const i=await e.Launchpad.getSettleEvent(s.pool_address);i&&(s.harvest_raise=i.unused_raise)}const t=Q.min(new Q(s.total_purchase_amount),new Q(s.max_raise_amount));return c(t.toString()).mul(1-s.liquidity_injection_ratio).toString()}return"0"}static async getHistoryWithdrawSale(e,s){if(s.pool_status==="Ended"){const t=await e.Launchpad.getSettleEvent(s.pool_address);return t&&(s.unused_sale=t.unused_sale),s.unused_sale}return"0"}static async getOverrecruitReverseAmount(e,s){const t=await e.Launchpad.getPurchaseMarks(e.ClmmSDK.senderAddress,[s.pool_address],!1);if(t.length>0){const i=t[0].purchased_raise_amount,n=(await e.Launchpad.getPurchaseAmount(s.white_summary.white_handle,e.ClmmSDK.senderAddress)).safe_purchased_amount,{protection_limit_used:o}=s.white_summary;return c(i).sub(n).div(c(s.total_purchase_amount).sub(o)).mul(c(s.total_purchase_amount).sub(s.max_raise_amount)).toString()}return"0"}static async getCanPurchaseAmount(e,s){const t=await C.getOverrecruitReverseAmount(e,s),i=await e.Launchpad.getPurchaseMarks(e.ClmmSDK.senderAddress,[s.pool_address],!1);if(i){const n=i[0].purchased_raise_amount;c(n).sub(t).div(s.current_price)}return"0"}},Pe=class{constructor(e){b(this,"_sdk");b(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=[],s=0,t=100,i=!1){var l;const{package_id:n}=this._sdk.sdkOptions.launchpad;if(n===void 0)throw Error("sdk.sdkOptions.launchpad is undefined");const o=`${n}_getPoolImmutables`,a=this.getCache(o,i),r=[],_=[];if(a!==void 0&&r.push(...a),r.length===0)try{((l=await P(this._sdk.ClmmSDK,{MoveEventType:`${n}::factory::CreatePoolEvent`}))==null?void 0:l.data).forEach(v=>{const y=v.parsedJson;y&&r.push({pool_address:y.pool_id,coin_type_sale:p(y.sale_coin.name).full_address,coin_type_raise:p(y.raise_coin.name).full_address})}),this.updateCache(o,r,g)}catch(f){console.log("getPoolImmutables",f)}const u=e.length>0;for(let f=0;f<r.length;f+=1){const v=r[f];if(!(u&&!e.includes(v.pool_address))){if(!u){const y=f;if(y<s||y>=s+t)continue}_.push(v)}}return _}async getPoolImmutablesWithPage(e="all",s=!1){const{package_id:t}=this._sdk.sdkOptions.launchpad,i=`${t}_getPoolImmutables`,n=[],o={data:[],hasNextPage:!1},a=e==="all";if(a){const r=this.getCache(i,s);r&&n.push(...r)}if(n.length===0)try{const r=await P(this._sdk.ClmmSDK,{MoveEventType:`${t}::factory::CreatePoolEvent`},e);o.hasNextPage=r.hasNextPage,o.nextCursor=r.nextCursor,r.data.forEach(_=>{const u=_.parsedJson;u&&n.push({pool_address:u.pool_id,coin_type_sale:p(u.sale_coin.name).full_address,coin_type_raise:p(u.raise_coin.name).full_address})})}catch(r){console.log("getPoolImmutables",r)}return o.data=n,a&&this.updateCache(i,n,g),o}async getPools(e=[],s=0,t=100){const i=[];let n=[];e.length>0?n=[...e]:(await this.getPoolImmutables([],s,t,!1)).forEach(r=>{n.push(r.pool_address)});const o=await j(this.sdk.ClmmSDK,n,{showType:!0,showContent:!0});for(const a of o){const r=C.buildLaunchPadPool(a);await C.calculatePoolPrice(this._sdk,r),i.push(r);const _=`${r.pool_address}_getPoolObject`;this.updateCache(_,r,g)}return i}async getPool(e,s=!0){const t=`${e}_getPoolObject`,i=this.getCache(t,s);if(i!==void 0){const a=i;return C.updatePoolStatus(a),a}const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),o=C.buildLaunchPadPool(n);return await C.calculatePoolPrice(this._sdk,o),this.updateCache(t,o),o}async getInitConfig(e=!1){var _;const s=this._sdk.sdkOptions.launchpad.package_id,t=`${s}_getInitEvent`,i=this.getCache(t,e);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showPreviousTransaction:!0}}),o=re(n),a=(_=await P(this._sdk.ClmmSDK,{Transaction:o}))==null?void 0:_.data,r={pools_id:"",admin_cap_id:"",config_cap_id:""};return a.length>0&&(a.forEach(u=>{const l=u.parsedJson;if(l)switch(p(u.type).full_address){case`${s}::config::InitConfigEvent`:r.admin_cap_id=l.admin_cap_id,r.config_cap_id=l.config_cap_id;break;case`${s}::factory::InitFactoryEvent`:r.pools_id=l.pools_id;break}}),this.updateCache(t,r,g)),r}async getLockNFT(e,s=!1){const t=`${e}_getLockNFT`,i=this.getCache(t,s);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!n.error)return te(n)}async getLockNFTList(e){var n;const{package_id:s}=this._sdk.ClmmSDK.sdkOptions.clmm_pool,{sdkOptions:t}=this._sdk,i=[];try{const o=(n=await P(this._sdk.ClmmSDK,{MoveEventType:`${t.launchpad.package_id}::lock::LockNFTEvent`}))==null?void 0:n.data;for(const a of o){const r=a.parsedJson;if(r){const _={locked_time:Number(r.locked_time),end_lock_time:Number(r.end_lock_time),nft_type:r.nft_type_name.name,lock_nft_id:r.lock_nft_id,recipient:r.recipient};if(e===_.recipient&&`${s}`===p(_.nft_type).address){const u=await this.getLockNFT(_.lock_nft_id);if(u){const l=p(u.coin_type_a).full_address,f=p(u.coin_type_b).full_address;i.push({...u,coin_type_a:l,coin_type_b:f,..._})}}}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPoolTransactionPayload(e){const{launchpad:s}=this.sdk.sdkOptions,t=d(s);if(this.assertLuanchpadConfig(),this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=C.priceRealToFix(Number(e.initialize_price),e.sale_decimals,e.raise_decimals),n=new h,o=c(e.total_supply).add(c(e.total_supply).mul(c(e.liquidity_rate))).toNumber(),a=await M.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(o),e.coin_type_sale),r=[n.pure(t.admin_cap_id),n.pure(t.config_cap_id),n.pure(t.pools_id),n.pure(T(e.recipient)),n.pure((i*_e).toString()),a,n.pure(e.total_supply.toString()),n.pure(e.min_purchase.toString()),n.pure(e.max_purchase.toString()),n.pure(e.least_raise_amount.toString()),n.pure(e.hardcap.toString()),n.pure((e.liquidity_rate*1e3).toString()),n.pure(e.start_time.toString()),n.pure(e.activity_duration.toString()),n.pure(e.settle_duration.toString()),n.pure(e.locked_duration.toString()),n.pure(e.tick_spacing.toString()),n.pure(m)],_=[e.coin_type_sale,e.coin_type_raise];return n.moveCall({target:`${s.published_at}::${D}::create_launch_pool`,typeArguments:_,arguments:r}),n}async creatPurchasePayload(e){const{launchpad:s}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const t=new h,i=await M.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,t,BigInt(e.purchase_amount),e.coin_type_raise),n=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[e.pool_address],!1))[0],o=[e.coin_type_sale,e.coin_type_raise];let a;return n?a=[t.pure(e.pool_address),t.pure(d(s).config_cap_id),t.pure(n.id),i,t.pure(e.purchase_amount.toString()),t.pure(m)]:a=[t.pure(e.pool_address),t.pure(d(s).config_cap_id),i,t.pure(e.purchase_amount.toString()),t.pure(m)],t.moveCall({target:`${s.published_at}::${D}::${n===void 0?"create_and_purchase":"purchase"}`,typeArguments:o,arguments:a}),t}async creatClaimPayload(e){const{launchpad:s}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const t=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[e.pool_address],!1))[0],i=new h,n=[e.coin_type_sale,e.coin_type_raise],o=[i.pure(e.pool_address),i.pure(d(s).config_cap_id),i.pure(t==null?void 0:t.id),i.pure(m)];return i.moveCall({target:`${s.published_at}::${D}::claim`,typeArguments:n,arguments:o}),i}async creatSettlePayload(e){var r;const{launchpad:s}=this.sdk.sdkOptions,{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");this.assertLuanchpadConfig();const i=d(t),{clmm_args:n}=e,o=new h;o.setSender(this.sdk.ClmmSDK.senderAddress);const a=[e.coin_type_sale,e.coin_type_raise];if(n){const _=n.opposite?H.priceToSqrtPriceX64(c(1).div(n.current_price),n.raise_decimals,n.sale_decimals).toString():H.priceToSqrtPriceX64(c(n.current_price),n.sale_decimals,n.raise_decimals).toString(),u=BigInt(_)<BigInt(n.clmm_sqrt_price),l=n.opposite?u?e.coin_type_raise:e.coin_type_sale:u?e.coin_type_sale:e.coin_type_raise,f=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,l);let v=se.calculateTotalBalance(f);se.isSuiCoin(l)&&(v-=BigInt(2e8));const le=(r=M.buildCoinInputForAmount(o,f,v,l))==null?void 0:r.transactionArgument,pe=n.opposite?u?"settle_with_reverse_clmm_only_with_a":"settle_with_reverse_clmm_only_with_b":u?"settle_only_with_a":"settle_only_with_b",he=[o.pure(e.pool_address),o.pure(d(s).config_cap_id),o.pure(n.clmm_pool_address),o.pure(i.global_config_id),o.pure(_),le,o.pure(m)];o.moveCall({target:`${s.published_at}::${D}::${pe}`,typeArguments:a,arguments:he})}else o.moveCall({target:`${s.published_at}::${D}::settle`,typeArguments:a,arguments:[o.pure(e.pool_address),o.pure(d(s).config_cap_id),o.pure(m)]});return o}creatWithdrawPayload(e){const{launchpad:s}=this.sdk.sdkOptions,t=new h,i=[e.coin_type_sale,e.coin_type_raise],n=[t.object(e.pool_address),t.object(d(s).config_cap_id),t.object(m)];return e.sale_amount>BigInt(0)&&t.moveCall({target:`${s.published_at}::${D}::withdraw_sale`,typeArguments:i,arguments:n}),e.raise_amount>BigInt(0)&&t.moveCall({target:`${s.published_at}::${D}::withdraw_raise`,typeArguments:i,arguments:n}),t}addUserToWhitelisPayload(e){const{launchpad:s}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const t=new h,i=[e.coin_type_sale,e.coin_type_raise];return e.user_addrs.forEach(n=>{const o=[t.object(d(s).admin_cap_id),t.object(d(s).config_cap_id),t.object(e.pool_address),t.object(n),t.pure(e.safe_limit_amount),t.object(m)];t.moveCall({target:`${s.published_at}::${D}::add_user_to_whitelist`,typeArguments:i,arguments:o})}),t}updateWhitelistCapPayload(e){const{launchpad:s}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const t=new h,i=[e.coin_type_sale,e.coin_type_raise];return e.safe_limit_amount>0&&t.moveCall({target:`${s.published_at}::${D}::update_whitelist_member_safe_limit_amount`,typeArguments:i,arguments:[t.object(d(s).admin_cap_id),t.object(d(s).config_cap_id),t.object(e.pool_address),t.pure(e.white_list_member),t.pure(e.safe_limit_amount),t.object(m)]}),e.hard_cap_total>0&&t.moveCall({target:`${s.published_at}::${D}::update_whitelist_hard_cap_total`,typeArguments:i,arguments:[t.object(d(s).admin_cap_id),t.object(d(s).config_cap_id),t.object(e.pool_address),t.pure(e.hard_cap_total),t.object(m)]}),t}creatRemoveWhitelistPayload(e){const{launchpad:s}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const t=new h,i=[e.coin_type_sale,e.coin_type_raise];return e.user_addrs.forEach(n=>{const o=[t.object(d(s).admin_cap_id),t.object(d(s).config_cap_id),t.object(e.pool_address),t.object(n),t.object(m)];t.moveCall({target:`${s.published_at}::${D}::remove_user_from_whitelist`,typeArguments:i,arguments:o})}),t}creatCancelPoolPayload(e){const{launchpad:s}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const t=new h,i=[e.coin_type_sale,e.coin_type_raise],n=[t.pure(d(s).admin_cap_id),t.pure(d(s).config_cap_id),t.pure(e.pool_address),t.pure(m)];return t.moveCall({target:`${s.published_at}::${D}::cancel`,typeArguments:i,arguments:n}),t}updateRecipientPayload(e){const{launchpad:s}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const t=new h,i=[e.coin_type_sale,e.coin_type_raise],n=[t.pure(d(s).admin_cap_id),t.pure(d(s).config_cap_id),t.pure(e.pool_address),t.pure(e.new_recipient),t.pure(m)];return t.moveCall({target:`${s.published_at}::${D}::update_recipient_address`,typeArguments:i,arguments:n}),t}updatePoolDuractionPayload(e){const{launchpad:s}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const t=new h,i=[e.coin_type_sale,e.coin_type_raise],n=[t.pure(d(s).admin_cap_id),t.pure(d(s).config_cap_id),t.pure(e.pool_address),t.pure(e.activity_duration),t.pure(e.settle_duration),t.pure(e.lock_duration),t.pure(m)];return t.moveCall({target:`${s.published_at}::${D}::update_pool_duration`,typeArguments:i,arguments:n}),t}creatUnlockNftPayload(e){const{launchpad:s}=this.sdk.sdkOptions;if(d(s)===void 0)throw Error("getPackagerConfigs(launchpad)  is null");const t=new h,i=[e.nft_type],n=[t.pure(e.lock_nft),t.pure(m)];return t.moveCall({target:`${s.published_at}::lock::unlock_nft`,typeArguments:i,arguments:n}),t}async isAdminCap(e){const{launchpad:s}=this._sdk.sdkOptions;if(d(s)===void 0)throw Error("launchpad config is empty");const t=`${e}_isAdminCap`,i=this.getCache(t);if(i)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:d(s).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(n);const o=G(n),a=ee(n);let r=!1;return a&&o&&p(o).source_address===`${s.package_id}::config::AdminCap`&&(r=T(a.AddressOwner)===T(e)),this.updateCache(t,r,g),r}async isWhiteListUser(e,s){const t={type:"address",value:s};try{const i=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:t});return!!(i&&i.data)}catch{return!1}}async getPurchaseAmount(e,s){var i;const t={type:"address",value:s};try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:t}),o=k(n);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getPurchaseMarks(e,s=[],t=!0){const{launchpad:i}=this._sdk.sdkOptions,n=`${s}_getPurchaseMark`,o=this.getCache(n,t);if(!t&&o!==void 0)return o;let a=null;const r=[];for(;;){const _=await this._sdk.ClmmSDK.fullClient.getOwnedObjects({owner:e,options:{showType:!0,showContent:!0,showDisplay:!0},cursor:a});for(const u of _.data){const{fields:l}=u.data.content;if(p(K(u)).source_address===`${i.package_id}::pool::PurchaseMark`){console.log("fields: ",l);const v={id:l.id.id,pool_id:p(l.pool_id).address,purchased_raise_amount:l.purchase_total,obtain_sale_amount:l.obtain_sale_amount,used_raise_amount:l.used_raise_amount};s.length>0?s.includes(v.pool_id)&&r.push(v):r.push(v)}}if(_.hasNextPage)a=_.nextCursor;else break}return this.updateCache(n,r,g),r}async getSettleEvent(e){const{launchpad:s}=this._sdk.sdkOptions,t=`${e}_getPurchaseMark`,i=this.getCache(t);if(i!==void 0)return i;const n=await P(this._sdk.ClmmSDK,{MoveEventType:`${s.package_id}::pool::SettleEvent`});for(const o of n.data){const a=o.parsedJson;if(e===z(a.pool_id)){const r={pool_id:a.pool_id,settle_price:a.settle_price,unused_sale:a.unused_sale,unused_raise:a.unused_raise,white_purchase_total:a.white_purchase_total};return this.updateCache(t,r,g),r}}}buildLaunchpadCoinType(e,s){return ke(this._sdk.sdkOptions.launchpad.package_id,"pool",we,[e,s])}assertLuanchpadConfig(){const{launchpad:e}=this.sdk.sdkOptions;if(d(e)===void 0)throw Error("sdk getPackagerConfigs(launchpad) is null")}updateCache(e,s,t=A){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}},N=class{static buildPoolImmutables(e){const{fields:s}=e.value.fields.value;return{clmm_pool_id:p(s.clmm_pool_id).address,bonus_type:p(s.bonus_type.fields.name).source_address,pool_id:p(s.pool_id).address,coinTypeA:p(s.coin_type_a.fields.name).source_address,coinTypeB:p(s.coin_type_b.fields.name).source_address}}static buildPoolState(e){const s=k(e),t=[];return s.config.fields.contents.forEach(n=>{t.push({rate:Number(c(n.fields.key).div(B)),multiplier:Number(c(n.fields.value).div(B))})}),{balance:s.balance,config:t,is_open:s.is_open,index:Number(s.index),start_time:Number(s.start_time),interval_day:Number(s.interval_day),minimum_percent_to_reward:Number(c(s.minimum_percent_to_reward).div(B)),rewarders:{rewarder_handle:s.rewarders.fields.id.id,size:Number(s.rewarders.fields.size)},whale_nfts:{whale_nfts_handle:s.whale_nfts.fields.id.id,size:Number(s.whale_nfts.fields.size)},points:{point_handle:s.points.fields.id.id,size:Number(s.points.fields.size)}}}static buildMarkerPositions(e){const{contents:s}=e.value.fields.value.fields,t=[],i=e.id.id;return s.forEach(n=>{const{key:o,value:a}=n.fields,r={id:o,period_id:i,bonus_num:a.fields.bonus_num,point:a.fields.point,is_burn:a.fields.is_burn,point_after_multiplier:a.fields.point_after_multiplier,percent:Number(c(a.fields.percent).div(B)),fee_share_rate:0,is_redeemed:a.fields.is_redeemed};t.push(r)}),t}static buildPoolBonusInfo(e){const{fields:s,type:t}=e.value.fields.value;return{type:t,time:Number(s.time),settle_time:Number(s.settle_time),settled_num:s.settled_num,is_settled:s.is_settled,basis_bonus:s.basis_bonus,total_bonus:s.total_bonus,is_vacant:s.is_vacant,redeemed_num:s.redeemed_num}}static getBonusPercent(e,s){let t=0;for(const i of e)s>=i.rate&&i.rate>t&&(t=i.multiplier);return t}},ne="router",De=class{constructor(e){b(this,"_sdk");b(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e=!1){var o;const{maker_bonus:s}=this._sdk.sdkOptions,t=`${s.package_id}_getPoolImmutables`,i=this.getCache(t,e),n=[];if(i!==void 0)n.push(...i);else{const a=[];(o=(await J(this._sdk.ClmmSDK,d(s).maker_pool_handle)).data)==null||o.forEach(u=>{a.push(u.objectId)});const _=await j(this._sdk.ClmmSDK,a,{showContent:!0});for(const u of _){const l=k(u);l&&n.push(N.buildPoolImmutables(l))}}return n}async getPoolImmutable(e){const{maker_bonus:s}=this._sdk.sdkOptions,t=`${s.package_id}_getPoolImmutables`,i=this.getCache(t);if(i!==void 0){const a=i.filter(r=>e===r.pool_id);if(a.length>0)return a[0]}const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:d(s).maker_pool_handle,name:{type:"0x2::object::ID",value:e}}),o=k(n);return N.buildPoolImmutables(o)}async getPools(){const e=[],s=await this.getPoolImmutables(),t=s.map(o=>o.pool_id),i=await j(this._sdk.ClmmSDK,t,{showType:!0,showContent:!0});let n=0;for(const o of i){const a=N.buildPoolState(o);if(a){const r={...s[n],...a};e.push(r);const _=`${r.pool_id}_getPoolObject`;this.updateCache(_,r,g)}n+=1}return e}async getPool(e,s=!0){const t=`${e}_getPoolObject`,i=this.getCache(t,s),n=await this.getPoolImmutable(e);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),a=N.buildPoolState(o),r={...n,...a};return this.updateCache(t,r,g),r}async getPoolHandleId(e){const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),t=k(s);return t?t.list.fields.id.id:""}async getMakerPoolPeriods(e,s=!1){const t=[],i=`${e.pool_id}_getMakerPoolPeriods`,n=this.getCache(i,s);return n!==void 0?n:((await J(this._sdk.ClmmSDK,e.whale_nfts.whale_nfts_handle)).data.forEach(a=>{const r={id:a.objectId,start_time:0,end_time:0,period:Number(a.name.value)};r.start_time=Number(c(e.start_time).add(c(e.interval_day).mul(24*3600).mul(r.period)).toFixed(0,x.ROUND_DOWN)),r.end_time=Number(c(r.start_time).add(c(e.interval_day).mul(24*3600)).toFixed(0,x.ROUND_DOWN)),t.push(r)}),this.updateCache(i,t,g),t)}async getMakerBonusInitConfigs(){var i;const{package_id:e}=this.sdk.sdkOptions.maker_bonus,s=(i=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::config::InitEvent`}))==null?void 0:i.data,t={maker_config_id:"",maker_pool_handle:""};return s.length>0&&s.forEach(n=>{const o=n.parsedJson;o&&(t.maker_config_id=o.config_id)}),t.maker_pool_handle=await this.getPoolHandleId(t.maker_config_id),t}async getPoolMarkerPositionList(e,s,t=!1){const i={},n=[];t||s.forEach(o=>{const a=`${e}_${o.period}_getPoolMarkerPositionList`,r=this.getCache(a);r!==void 0?i[o.period]=r:(i[o.period]=[],n.push(o))});try{n.length>0&&(await j(this._sdk.ClmmSDK,n.map(r=>r.id),{showContent:!0})).forEach(r=>{const _=k(r),u=N.buildMarkerPositions(_);if(u.length>0){const{period_id:l}=u[0],f=s.filter(v=>v.id===l)[0];i[f.period]=u}});const o=[];for(const a in i)i[a].forEach(_=>{o.push(_)});if(o.length>0){const a=await this._sdk.ClmmSDK.Position.getSipmlePositionList(o.map(r=>r.id));for(const r of o)for(const _ of a)if(r.id===_.pos_object_id){r.clmm_position=_;break}}}catch(o){console.log(o)}for(const o in i){const a=`${e}_${o}_getPoolMarkerPositionList`;this.updateCache(a,i[o],g)}return i}async updateXCetusRewarderAndFee(e,s,t){const i=await this.calculateTotalPointsAfterMultiper(e,t);for(const n of s)await this.calculateXCetusRewarder(e,n,t.period,i);return s}async calculateXCetusRewarder(e,s,t,i){const n=await this.getPoolBonusInfo(e.rewarders.rewarder_handle,t),{fee_share_rate:o}=this.calculateFeeShareRate(e,s,i),a=c(o).mul(n.total_bonus);return s.is_redeemed?s.bonus_num="0":s.bonus_num=a.toString(),s.bonus_num}calculateFeeShareRate(e,s,t){const i=N.getBonusPercent(e.config,s.percent),n=c(s.point).mul(i),o=c(n).div(t);return s.point_after_multiplier=n.toString(),s.fee_share_rate=Number(o),{fee_share_rate:Number(o),points_after_multiper:n.toString()}}async calculateTotalPointsAfterMultiper(e,s){const t=await this.getPoolMarkerPositionList(e.whale_nfts.whale_nfts_handle,[s]);let i=c(0);const n=t[s.period];for(const o of n){const a=N.getBonusPercent(e.config,o.percent),r=c(o.point).mul(a);i=i.add(r)}return i.toString()}async calculateAllXCetusRewarder(e){const s=this._sdk.ClmmSDK.senderAddress;let t=c(0);const i=[];for(const n of e){const o=await this._sdk.MakerModule.getMakerPoolPeriods(n),a=await this._sdk.MakerModule.getPoolMarkerPositionList(n.whale_nfts.whale_nfts_handle,o),r=[];for(const _ of o){const u=a[_.period].filter(l=>{var f;return s.length===0?!1:((f=l.clmm_position)==null?void 0:f.owner)===s});u.length>0&&(await this._sdk.MakerModule.updateXCetusRewarderAndFee(n,u,_),u.forEach(l=>{var f;((f=l.clmm_position)==null?void 0:f.position_status)===ye.Exists&&c(l.bonus_num).greaterThan(0)&&(t=t.add(l.bonus_num),r.includes(l.clmm_position.pos_object_id)||r.push(l.clmm_position.pos_object_id))}))}i.push({bonus_type:n.bonus_type,pool_id:n.pool_id,nft_ids:r})}return{claimtotal:t,claimRecord:i}}async getPoolBonusInfo(e,s,t=!1){const i=`${e}_${s}_getPoolBonusInfo`,n=this.getCache(i,t);if(n!==void 0)return n;const o=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"u64",value:s.toString()}}),a=k(o),r=N.buildPoolBonusInfo(a);return this.updateCache(i,r,A),r}claimPayload(e){const{maker_bonus:s,xcetus:t}=this.sdk.sdkOptions,i=new h;return i.moveCall({target:`${s.published_at}::${ne}::claim`,typeArguments:[e.bonus_type],arguments:[i.pure(d(s).maker_config_id),i.pure(e.market_pool_id),i.pure(e.position_nft_id),i.pure(e.phase),i.pure(d(t).lock_manager_id),i.pure(d(t).xcetus_manager_id),i.pure(e.ve_nft_id)]}),i}claimAllPayload(e){const{maker_bonus:s,xcetus:t}=this.sdk.sdkOptions,i=new h;return e.whale_nfts.forEach(n=>{n.nft_ids.forEach(o=>{i.moveCall({target:`${s.published_at}::${ne}::claim_all`,typeArguments:[n.bonus_type],arguments:[i.object(d(s).maker_config_id),i.object(n.pool_id),i.object(o),i.object(d(t).lock_manager_id),i.object(d(t).xcetus_manager_id),i.object(e.ve_nft_id)]})})}),i}updateCache(e,s,t=A){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}},R="router",oe="router",W=24*3600,Y=1e3,O=1e11,E=class{static buildVeNFTDividendInfo(e){const s={id:e.id.id,ve_nft_id:e.name,rewards:[]};return e.value.fields.value.fields.dividends.fields.contents.forEach(t=>{const i=[];t.fields.value.fields.contents.forEach(n=>{i.push({coin_type:p(n.fields.key.fields.name).source_address,amount:n.fields.value})}),s.rewards.push({period:Number(t.fields.key),rewards:i})}),s}static buildDividendManager(e){const s={id:e.id.id,dividends:{id:e.dividends.fields.id.id,size:e.dividends.fields.size},venft_dividends:{id:e.venft_dividends.fields.id.id,size:e.venft_dividends.fields.size},bonus_types:[],start_time:Number(e.start_time),interval_day:Number(e.interval_day),balances:{id:e.balances.fields.id.id,size:e.balances.fields.size},is_open:e.is_open};return e.bonus_types.forEach(t=>{s.bonus_types.push(p(t.fields.name).source_address)}),s}static buildLockUpManager(e){return{id:e.id.id,balance:e.balance,treasury_manager:e.treasury_manager,extra_treasury:e.extra_treasury,lock_infos:{lock_handle_id:e.lock_infos.fields.id.id,size:Number(e.lock_infos.fields.size)},type_name:ce(e.type_name.fields.name),min_lock_day:Number(e.min_lock_day),max_lock_day:Number(e.max_lock_day),package_version:Number(e.package_version),max_percent_numerator:Number(e.max_percent_numerator),min_percent_numerator:Number(e.min_percent_numerator)}}static buildLockCetus(e){const s=e.fields,t={id:s.id.id,type:p(e.type).source_address,locked_start_time:Number(s.locked_start_time),locked_until_time:Number(s.locked_until_time),cetus_amount:s.balance,xcetus_amount:"0",lock_day:0};return t.lock_day=(t.locked_until_time-t.locked_start_time)/W,t}static getAvailableXCetus(e,s){let t=c(0);return s.forEach(i=>{t=t.add(i.xcetus_amount)}),c(e.xcetus_balance).sub(t).toString()}static getWaitUnLockCetuss(e){return e.filter(s=>!E.isLocked(s))}static getLockingCetuss(e){return e.filter(s=>E.isLocked(s))}static isLocked(e){return e.locked_until_time>Date.parse(new Date().toString())/1e3}static getNextStartTime(e){const s=Date.now()/1e3,{start_time:t,interval_day:i}=e,n=Math.ceil((s-t)/(i*W));return t+n*i*W}},Se=class{constructor(e){b(this,"_sdk");b(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getOwnerVeNFT(e,s=!0){const{xcetus:t}=this.sdk.sdkOptions,i=`${e}_getLockUpManagerEvent`,n=this.getCache(i,s);if(n!==void 0)return n;let o;const a=`${t.package_id}::xcetus::VeNFT`;return(await q(this._sdk.ClmmSDK,e,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:a}})).data.forEach(_=>{const u=p(K(_)).source_address;if(u===a&&_.data&&_.data.content){const{fields:l}=_.data.content;o={...de(_),id:l.id.id,index:l.index,type:u,xcetus_balance:l.xcetus_balance},this.updateCache(i,o,g)}}),o}async getOwnerLockCetuss(e){const{xcetus:s}=this.sdk.sdkOptions,t=[],i=`${s.package_id}::lock_coin::LockedCoin<${this.buileCetusCoinType()}>`,n=await q(this._sdk.ClmmSDK,e,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of n.data)if(p(K(o)).source_address===i&&o.data){const r=E.buildLockCetus(o.data.content);r.xcetus_amount=await this.getXCetusAmount(r.id),t.push(r)}return t}async getLockCetus(e){var t;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if((t=s.data)!=null&&t.content){const i=E.buildLockCetus(s.data.content);return i.xcetus_amount=await this.getXCetusAmount(i.id),i}}async getOwnerCetusCoins(e){return await this._sdk.ClmmSDK.getOwnerCoinAssets(e,this.buileCetusCoinType())}mintVeNFTPayload(){const{xcetus:e}=this.sdk.sdkOptions,s=new h;return s.moveCall({target:`${e.published_at}::${R}::mint_venft`,typeArguments:[],arguments:[s.pure(d(e).xcetus_manager_id)]}),s}async convertPayload(e){const{xcetus:s}=this.sdk.sdkOptions,t=new h,i=this.buileCetusCoinType(),n=await M.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,t,BigInt(e.amount),i);return e.venft_id===void 0?t.moveCall({target:`${s.published_at}::${R}::mint_and_convert`,typeArguments:[],arguments:[t.object(d(s).lock_manager_id),t.object(d(s).xcetus_manager_id),n,t.pure(e.amount)]}):t.moveCall({target:`${s.published_at}::${R}::convert`,typeArguments:[],arguments:[t.object(d(s).lock_manager_id),t.object(d(s).xcetus_manager_id),n,t.pure(e.amount),t.pure(e.venft_id)]}),t}redeemLockPayload(e){const{xcetus:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${R}::redeem_lock`,typeArguments:[],arguments:[t.pure(d(s).lock_manager_id),t.pure(d(s).xcetus_manager_id),t.pure(e.venft_id),t.pure(e.amount),t.pure(e.lock_day),t.pure(m)]}),t}redeemPayload(e){const{xcetus:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${R}::redeem`,typeArguments:[],arguments:[t.pure(d(s).lock_manager_id),t.pure(d(s).xcetus_manager_id),t.pure(e.venft_id),t.pure(e.lock_id),t.pure(m)]}),t}redeemDividendPayload(e,s){const{xcetus:t,xcetus_dividends:i}=this.sdk.sdkOptions,n=new h;return s.forEach(o=>{n.moveCall({target:`${t.published_at}::${oe}::redeem`,typeArguments:[o],arguments:[n.object(d(i).dividend_manager_id),n.object(e)]})}),n}redeemDividendV2Payload(e,s){const{xcetus_dividends:t}=this.sdk.sdkOptions,i=new h;return s.forEach(n=>{i.moveCall({target:`${t.published_at}::${oe}::redeem_v2`,typeArguments:[n],arguments:[i.object(d(t).dividend_manager_id),i.object(e),i.object(m)]})}),i}buileCetusCoinType(){return`${this.sdk.sdkOptions.cetus_faucet.package_id}::cetus::CETUS`}cancelRedeemPayload(e){const{xcetus:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${R}::cancel_redeem_lock`,typeArguments:[],arguments:[t.pure(d(s).lock_manager_id),t.pure(d(s).xcetus_manager_id),t.pure(e.venft_id),t.pure(e.lock_id),t.pure(m)]}),t}async getInitConfigs(){var a,r;const{package_id:e}=this.sdk.sdkOptions.xcetus,s=`${e}_getInitFactoryEvent`,t=this.getCache(s);if(t!==void 0)return t;const i=(a=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::xcetus::InitEvent`}))==null?void 0:a.data,n={xcetus_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(_=>{const u=_.parsedJson;u&&(n.xcetus_manager_id=u.xcetus_manager)});const o=(r=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::locking::InitializeEvent`}))==null?void 0:r.data;return o.length>0&&o.forEach(_=>{const u=_.parsedJson;u&&(n.lock_manager_id=u.lock_manager)}),n.lock_handle_id=(await this.getLockUpManager()).lock_infos.lock_handle_id,this.updateCache(s,n,g),n}async getLockUpManager(e=!1){const{lock_manager_id:s}=d(this.sdk.sdkOptions.xcetus),t=`${s}_getLockUpManager`,i=this.getCache(t,e);if(i!==void 0)return i;const n=await this.sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0}}),o=E.buildLockUpManager(k(n));return this.updateCache(t,o,g),o}async getDividendConfigs(){var o;const{package_id:e}=this.sdk.sdkOptions.xcetus_dividends,s=`${e}_getDividendManagerEvent`,t=this.getCache(s);if(t!==void 0)return t;const i=(o=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::dividend::InitEvent`}))==null?void 0:o.data,n={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(a=>{const r=a.parsedJson;r&&(n.dividend_manager_id=r.manager_id,n.dividend_admin_id=r.admin_id,n.dividend_settle_id=r.settle_id,this.updateCache(s,n,g))}),n}async getDividendManager(e=!1){const{dividend_manager_id:s}=d(this._sdk.sdkOptions.xcetus_dividends),t=`${s}_getDividendManager`,i=this.getCache(t,e);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0}}),o=k(n),a=E.buildDividendManager(o);return this.updateCache(t,a,g),a}async getXcetusManager(e=!0){const{xcetus_manager_id:s}=d(this._sdk.sdkOptions.xcetus),t=`${s}_getXcetusManager`,i=this.getCache(t,e);if(i)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0}}),o=k(n),a={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(t,a),a}async getVeNFTDividendInfo(e,s){try{const t=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:s}}),i=k(t);return E.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(e,s){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const t=await this.getLockUpManager(),i=c(O).mul(c(t.max_lock_day).sub(c(s))).mul(c(t.max_percent_numerator).sub(c(t.min_percent_numerator))).div(c(t.max_lock_day).sub(c(t.min_lock_day))),n=c(O).mul(c(t.max_percent_numerator)).sub(i).div(c(Y)).div(O);return{amountOut:c(n).mul(c(e)).round().toString(),percent:n.toString()}}async reverseRedeemNum(e,s){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const t=await this.getLockUpManager(),i=c(O).mul(c(t.max_lock_day).sub(c(s))).mul(c(t.max_percent_numerator).sub(c(t.min_percent_numerator))).div(c(t.max_lock_day).sub(c(t.min_lock_day))),n=c(O).mul(c(t.max_percent_numerator)).sub(i).div(c(Y)).div(O);return{amountOut:c(e).div(n).toFixed(0,x.ROUND_UP),percent:n.toString()}}async getXCetusAmount(e){const{lock_handle_id:s}=d(this._sdk.sdkOptions.xcetus),t=`${e}_getXCetusAmount`,i=this.getCache(t);if(i!==void 0)return i;try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:s,name:{type:"0x2::object::ID",value:e}}),o=k(n);if(o){const{xcetus_amount:a}=o.value.fields.value.fields;return this.updateCache(t,a,g),a}}catch{}return"0"}async getVeNftAmount(e,s){try{const t=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:s}}),i=k(t);if(i){const{lock_amount:n,xcetus_amount:o}=i.value.fields.value.fields;return{lock_amount:n,xcetus_amount:o}}}catch{}return{lock_amount:"0",xcetus_amount:"0"}}async getPhaseDividendInfo(e,s=!1){const i=(await this.getDividendManager()).dividends.id,n=`${i}_${e}_getPhaseDividendInfo`,o=this._sdk.getCache(n,s);if(o)return o;const a=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:e}}),r=k(a),_=r.value.fields.value.fields,u=_.redeemed_num.fields.contents.map(y=>({name:y.fields.key.fields.name,value:y.fields.value})),l=_.bonus_types.map(y=>y.fields.name),f=_.bonus.fields.contents.map(y=>({name:y.fields.key.fields.name,value:y.fields.value})),v={id:X(a),phase:r.name,settled_num:_.settled_num,register_time:_.register_time,redeemed_num:u,is_settled:_.is_settled,bonus_types:l,bonus:f,phase_end_time:""};return this.updateCache(n,v),v}updateCache(e,s,t=A){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}},Ie="factory",I="oversubscribe_pool",ue=1e6,V=1e18,U="router",ae="router",w=class{static buildIdoPoolImmutables(e){return{pool_address:z(e.pool_id),coin_type_sale:p(e.sale_coin_type.name).full_address,coin_type_raise:p(e.raise_coin_type.name).full_address,tick_spacing:Number(e.tick_spacing),total_supply:e.total_supply,min_purchase:e.min_purchase_amount,max_purchase:e.max_purchase_amount}}static buildIdoPool(e){const s=K(e),t=p(s),i=k(e),n={pool_address:z(i.id.id),coin_type_sale:t.type_arguments[0],coin_type_raise:t.type_arguments[1],tick_spacing:Number(i.tick_spacing),total_supply:i.total_supply,min_purchase:i.min_purchase_amount,max_purchase:i.max_purchase_amount},o={start_time:Number(i.duration_manager.fields.start_time),lock_up_duration:Number(i.duration_manager.fields.lock_up_duration),purchase_duration:Number(i.duration_manager.fields.purchase_duration),end_time:0};o.end_time=o.start_time+o.purchase_duration;const a={complete_raise_limit:i.complete_raise_limit,liquidity_injection_ratio:c(i.liquidity_injection_ratio).div(ue).toNumber(),current_sqrt_price_min:i.current_sqrt_price_min,current_sqrt_price_max:i.current_sqrt_price_max,owner:i.owner,sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,price:i.price,current_price:i.price,duration_summary:o,is_cancelled:i.is_cancelled,is_liquidity_injected:i.is_liquidity_injected,liquidity_used_raise_amount:i.liquidity_used_raise_amount,liquidity_used_sale_amount:i.liquidity_used_sale_amount,purchase_summary:{size:Number(i.purchase_manager.fields.purchases.fields.size),purchase_handle:i.purchase_manager.fields.purchases.fields.id.id},total_purchase_amount:i.total_purchase_amount,white_summary:{white_list_id:i.white_list.fields.id.id,protection_limit_used:i.white_list.fields.protection_limit_used,protection_hard_cap:i.white_list.fields.protection_hard_cap,white_handle:i.white_list.fields.addresses.fields.id.id,size:Number(i.white_list.fields.addresses.fields.size)},pool_status:"Upcoming",max_raise_amount:"",sale_decimals:0,raise_decimals:0,is_withdrawn:i.is_withdrawn};return w.updatePoolStatus(a),{...n,...a}}static is_init_period(e){return Number(c(Date.now()/1e3).toFixed(0))<e.start_time}static is_purchase_period(e){const s=Number(c(Date.now()/1e3).toFixed(0));return s>=e.start_time&&s<=e.start_time+e.purchase_duration}static is_claim_period(e){const s=Number(c(Date.now()/1e3).toFixed(0)),t=e.start_time+e.purchase_duration;return s>t}static is_can_inject_liquidity(e){return!e.is_cancelled&&e.liquidity_injection_ratio!==0&&w.is_claim_period(e.duration_summary)&&!e.is_liquidity_injected}static is_can_withdraw(e){return e.is_withdrawn?!1:w.is_sale_failed(e)?!0:(e.liquidity_injection_ratio===0||e.is_liquidity_injected)&&w.is_claim_period(e.duration_summary)}static is_sale_failed(e){return!!(e.is_cancelled||w.is_claim_period(e.duration_summary)&&c(e.total_purchase_amount).lessThan(e.complete_raise_limit))}static buildPurchaseInfo(e){return{...e.value.fields.value.fields,owner:e.name}}static calculateRedeemAmount(e,s){let t,i;if(w.is_sale_failed(e))t="0",i="0";else if(s.is_redeemed)t=s.obtained_sale_amount,i=s.used_raise_amount;else if(c(e.total_purchase_amount).lessThanOrEqualTo(e.max_raise_amount))t=c(s.purchased_raise_amount).mul(V).div(e.price).toString(),i=s.purchased_raise_amount;else{const o=w.redeemForSaleOversubcribe(e,s);t=o.user_obtained_sale_amount,i=o.user_used_raise_amount_ceil}t=x.floor(t);const n=x.floor(c(s.purchased_raise_amount).sub(i).toString());return{obtained_sale_amount:t,refunded_raise_amount:n}}static calculateWithdrawAmount(e){let s,t;const i=c(e.total_supply).mul(e.liquidity_injection_ratio);if(w.is_sale_failed(e))s="0",t=c(i).add(e.total_supply);else{const{max_raise_amount:n}=e;c(e.total_purchase_amount).greaterThanOrEqualTo(n)?(s=c(n).sub(e.liquidity_used_raise_amount).toString(),t="0"):(s=c(e.total_purchase_amount).sub(e.liquidity_used_raise_amount),t=c(e.total_supply).add(i).sub(e.liquidity_used_sale_amount).sub(w.get_sold_amount(e)))}return{obtained_raise_amount:x.floor(s).toString(),refunded_sale_amount:x.ceil(t).toString()}}static get_sold_amount(e){return c(e.total_purchase_amount).greaterThanOrEqualTo(e.max_raise_amount)?e.total_supply:c(e.total_purchase_amount).mul(V).div(e.price)}static redeemForSaleOversubcribe(e,s){const t=s.protection_raise_amount,i=c(s.purchased_raise_amount).sub(t),n=e.max_raise_amount,{protection_limit_used:o}=e.white_summary,a=c(n).sub(o),r=c(e.total_purchase_amount).sub(o),_=x.ceil(i.mul(a).div(r).add(t)),u=x.floor(i.mul(a).div(r).add(t));return{user_obtained_sale_amount:x.floor(c(e.total_supply).mul(u).div(n)),user_used_raise_amount_ceil:_}}static raiseTotalAmount(e){const s=c(e.sale_decimals-e.raise_decimals).abs().toNumber();return e.sale_decimals>e.raise_decimals?c(e.total_supply).mul(e.current_price).div(c(10).pow(c(s))).toString():c(e.total_supply).mul(e.current_price).mul(c(10).pow(c(s))).toString()}static updatePoolStatus(e){const s=Number(c(Date.now()/1e3).toFixed(0)),t=e.duration_summary,i=t.start_time+t.purchase_duration;e.is_cancelled?e.pool_status="Canceled":s<t.start_time?e.pool_status="Upcoming":s>t.start_time&&s<i?e.pool_status="Live":c(e.total_purchase_amount).lessThan(e.complete_raise_limit)?e.pool_status="Failed":e.pool_status="Ended"}static async calculatePoolUiPrice(e,s){const t=await e.ClmmSDK.CetusConfig.getTokenListByCoinTypes([s.coin_type_sale,s.coin_type_raise]),i=t[s.coin_type_sale].decimals,n=t[s.coin_type_raise].decimals;s.current_price=C.priceFixToReal(Number(c(s.price).div(c(V)).toString()),i,n).toString(),s.sale_decimals=i,s.raise_decimals=n,s.max_raise_amount=this.raiseTotalAmount(s)}},$e=class{constructor(e){b(this,"_sdk");this._sdk=e}async getPools(e=[],s=!1){const t=[];if(e.length>0){if(e.filter(n=>{const o=`${n}_getPool`,a=this._sdk.getCache(o,s);return a?(t.push(a),!1):!0}).length>0){const n=await j(this._sdk.ClmmSDK,e,{showType:!0,showContent:!0});for(const o of n){const a=await this.buildIdoWarpPool(o);a&&t.push(a)}}}else{const i=await this._sdk.Launchpad.getPools(),n=await this._sdk.Ido.getPools();i.forEach(o=>{t.push({...o,version:"1"})}),n.forEach(o=>{t.push({...o,version:"2"})})}return t.forEach(i=>{const n=`${i.pool_address}_getPool`;this._sdk.updateCache(n,i)}),t}async getPool(e,s=!0){const t=`${e}_getPool`,i=this._sdk.getCache(t,s);if(i)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),o=await this.buildIdoWarpPool(n);return this._sdk.updateCache(t,o),o}async getJoinPools(e,s){const t=[],i=s.filter(o=>o.version==="1"),n=s.filter(o=>o.version==="2");if(i.length>0){const o=await this._sdk.Launchpad.getPurchaseMarks(e,i.map(a=>a.pool_address),!1);i.forEach(a=>{for(const r of o)if(r.pool_id===a.pool_address){t.push(a);break}})}for(const o of n)await this._sdk.Ido.getPurchaseInfo(o.purchase_summary.purchase_handle,e,!1)&&t.push(o);return t}async getOwnerPools(e,s){return s.filter(t=>t.owner===T(e))}async creatPurchasePayload(e,s){return e.version==="1"?await this._sdk.Launchpad.creatPurchasePayload({pool_address:e.pool_address,purchase_amount:s,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise}):await this._sdk.Ido.creatPurchasePayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,purchase_handle:e.purchase_summary.purchase_handle,raise_amount:s.toString()})}async creatRedeemPayload(e){return e.version==="1"?await this._sdk.Launchpad.creatClaimPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise}):await this._sdk.Ido.redeemPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,purchase_handle:e.purchase_summary.purchase_handle})}async creatWithdrawPayload(e){if(e.version==="1"){const t=await C.getWithdrawSale(e),i=await C.getWithdrawRaise(e);return this._sdk.Launchpad.creatWithdrawPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise,sale_amount:BigInt(t),raise_amount:BigInt(i)})}return this._sdk.Ido.withdrawPayload({pool_address:e.pool_address,coin_type_sale:e.coin_type_sale,coin_type_raise:e.coin_type_raise})}unlockNftPayload(e,s){return e.version==="1"?this._sdk.Launchpad.creatUnlockNftPayload(s):this._sdk.Ido.unlockNftPayload({lock_nft_id:s.lock_nft,nft_type:s.nft_type})}async getLockNFTList(e){let s=[];return e.version==="1"&&(s=await this._sdk.Launchpad.getLockNFTList(e.owner)),s=await this._sdk.Ido.getLockNFTList(e.owner),s.filter(i=>i.coin_type_a===e.coin_type_sale&&i.coin_type_b===e.coin_type_raise||i.coin_type_a===e.coin_type_raise&&i.coin_type_b===e.coin_type_sale)}async isWhiteListUser(e,s){return s.version==="1"?await this._sdk.Launchpad.isWhiteListUser(s.white_summary.white_handle,e):!!await this._sdk.Ido.getWhiteProtectionLimit(s.white_summary.white_handle,e)}async getPurchaseInfo(e,s){if(s.version==="1"){const i=await this._sdk.Launchpad.getPurchaseMarks(e,[s.pool_address]);return i.length>0?i[0]:void 0}return await this._sdk.Ido.getPurchaseInfo(s.purchase_summary.purchase_handle,e)}async getwhiteProtectionInfo(e,s,t=!1){if(s.version==="1")return await this._sdk.Launchpad.getPurchaseAmount(s.white_summary.white_handle,e);const i=await this._sdk.Ido.getPurchaseInfo(s.purchase_summary.purchase_handle,e,t);if(i)return{safe_limit_amount:i.protection_raise_limit,safe_purchased_amount:i.protection_raise_amount};const n=await this._sdk.Ido.getWhiteProtectionLimit(s.white_summary.white_handle,e,!1);return n?{safe_limit_amount:n,safe_purchased_amount:"0"}:{safe_limit_amount:"0",safe_purchased_amount:"0"}}async calculateWithdrawAmount(e){if(e.version==="1"){const s=await C.getHistoryWithdrawRaise(this._sdk,e),t=await C.getHistoryWithdrawSale(this._sdk,e);return{obtained_raise_amount:s,refunded_sale_amount:t}}return w.calculateWithdrawAmount(e)}async buildIdoWarpPool(e){const s=G(e);if(p(s).address===this._sdk.sdkOptions.ido.package_id){const t=w.buildIdoPool(e);return await w.calculatePoolUiPrice(this._sdk,t),{...t,version:"2"}}if(p(s).address===this._sdk.sdkOptions.launchpad.package_id){const t=C.buildLaunchPadPool(e);return await C.calculatePoolPrice(this._sdk,t),{...t,version:"1"}}}},L=class{static buildVeNFTDividendInfo(e){const s={id:e.id.id,ve_nft_id:e.name,rewards:[]};return e.value.fields.value.fields.dividends.fields.contents.forEach(t=>{const i=[];t.fields.value.fields.contents.forEach(n=>{i.push({coin_type:p(n.fields.key.fields.name).source_address,amount:n.fields.value})}),s.rewards.push({period:Number(t.fields.key),rewards:i})}),s}static buildDividendManager(e){const s={id:e.id.id,dividends:{id:e.dividends.fields.id.id,size:e.dividends.fields.size},venft_dividends:{id:e.venft_dividends.fields.id.id,size:e.venft_dividends.fields.size},bonus_types:[],start_time:Number(e.start_time),interval_day:Number(e.interval_day),balances:{id:e.balances.fields.id.id,size:e.balances.fields.size},is_open:e.is_open};return e.bonus_types.forEach(t=>{s.bonus_types.push(p(t.fields.name).source_address)}),s}static buildLockUpManager(e){return{id:e.id.id,balance:e.balance,treasury_manager:e.treasury_manager,extra_treasury:e.extra_treasury,lock_infos:{lock_handle_id:e.lock_infos.fields.id.id,size:Number(e.lock_infos.fields.size)},type_name:ce(e.type_name.fields.name),min_lock_day:Number(e.min_lock_day),max_lock_day:Number(e.max_lock_day),package_version:Number(e.package_version),max_percent_numerator:Number(e.max_percent_numerator),min_percent_numerator:Number(e.min_percent_numerator)}}static buildLockToken(e){const s=e.fields,t={id:s.id.id,type:p(e.type).source_address,locked_start_time:Number(s.locked_start_time),locked_until_time:Number(s.locked_until_time),token_amount:s.balance,xtoken_amount:"0",lock_day:0};return t.lock_day=(t.locked_until_time-t.locked_start_time)/W,t}static getAvailableXToken(e,s){let t=c(0);return s.forEach(i=>{t=t.add(i.xtoken_amount)}),c(e.xtoken_balance).sub(t).toString()}static getWaitUnLockTokens(e){return e.filter(s=>!L.isLocked(s))}static getLockingTokens(e){return e.filter(s=>L.isLocked(s))}static isLocked(e){return e.locked_until_time>Date.parse(new Date().toString())/1e3}static getNextStartTime(e,s=W){const t=Date.now()/1e3,{start_time:i,interval_day:n}=e,o=Math.ceil((t-i)/(n*s));return i+o*n*s}},Oe=class{constructor(e){b(this,"_sdk");b(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getPoolImmutables(e="all",s=!1){const{package_id:t}=this._sdk.sdkOptions.ido,i=`${t}_getPoolImmutables`,n=this.getCache(i,s),o={data:[],hasNextPage:!1},a=[];if(n!==void 0&&a.push(...n),a.length===0)try{const r=await P(this._sdk.ClmmSDK,{MoveEventType:`${t}::oversubscribe_pool::CreatePoolEvent`},e);r.data.forEach(_=>{const u=_.parsedJson;if(u){const l=w.buildIdoPoolImmutables(u);a.push(l)}}),o.hasNextPage=r.hasNextPage,o.nextCursor=r.nextCursor,this.updateCache(i,a,g)}catch(r){console.log("getPoolImmutables",r)}return o.data=a,o}async getPools(e=[],s=!1){const t=[];let i=[];e.length>0?i=[...e]:(await this.getPoolImmutables("all",s)).data.forEach(a=>{i.push(a.pool_address)});const n=await j(this.sdk.ClmmSDK,i,{showType:!0,showContent:!0});for(const o of n){const a=w.buildIdoPool(o);await w.calculatePoolUiPrice(this._sdk,a),t.push(a);const r=`${a.pool_address}_getPoolObject`;this.updateCache(r,a,g)}return t}async getPool(e,s=!0){const t=`${e}_getPoolObject`,i=this.getCache(t,s);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showType:!0}}),o=w.buildIdoPool(n);return await w.calculatePoolUiPrice(this._sdk,o),this.updateCache(t,o),o}async getIdoConfigs(e=!1){var _;const{package_id:s}=this._sdk.sdkOptions.ido,t=`${s}_getInitEvent`,i=this.getCache(t,e);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showPreviousTransaction:!0}}),o=re(n),a=(_=await P(this._sdk.ClmmSDK,{Transaction:o}))==null?void 0:_.data,r={pools_id:"",admin_cap_id:"",package_version_id:""};return a.length>0&&(a.forEach(u=>{console.log("item: ",u);const l=u.parsedJson;if(l)switch(p(u.type).full_address){case`${s}::config::InitConfigEvent`:r.admin_cap_id=l.admin_cap_id,r.package_version_id=l.package_version_id;break;case`${s}::factory::InitFactoryEvent`:r.pools_id=l.pools_id;break}}),this.updateCache(t,r,g)),r}async getPurchaseInfo(e,s,t=!0){const i=`${e}_${s}_getPurchaseInfo`,n=this.getCache(i,t);if(n)return n;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:s}}),a=w.buildPurchaseInfo(k(o));return this.updateCache(i,a,A),a}catch{return}}async getLockNFT(e,s=!1){const t=`${e}_getLockNFT`,i=this.getCache(t,s);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!n.error)return te(n)}async getLockNFTList(e){var n;const{clmm_pool:s}=this._sdk.ClmmSDK.sdkOptions,{ido:t}=this._sdk.sdkOptions,i=[];try{const o=(n=await q(this._sdk.ClmmSDK,e,{filter:{StructType:`${t.package_id}::lock::LockedNFT<${s.package_id}::position::Position>`},options:{showContent:!0}}))==null?void 0:n.data;for(const a of o){const r=k(a);if(r){const _=r.nft.fields,u={locked_at:Number(r.locked_at),lock_duration:Number(r.lock_duration),lock_nft_id:r.id.id,type:r.nft.type,..._};u.end_lock_time=u.locked_at+u.lock_duration,u.coin_type_a=p(_.coin_type_a.fields.name).full_address,u.coin_type_b=p(_.coin_type_b.fields.name).full_address,u.id=_.id.id,u.tick_lower_index=ie(BigInt(_.tick_lower_index.fields.bits)),u.tick_upper_index=ie(BigInt(_.tick_upper_index.fields.bits)),i.push(u)}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPool(e){const{ido:s}=this.sdk.sdkOptions;be(T(e.coin_type_sale),T(e.coin_type_raise))&&(e.price_min=c(1).div(e.price_max).toNumber(),e.price_max=c(1).div(e.price_min).toNumber());const i=C.priceRealToFix(Number(e.price),e.sale_decimals,e.raise_decimals),n=H.priceToSqrtPriceX64(c(e.price_min),e.sale_decimals,e.raise_decimals).toString(),o=H.priceToSqrtPriceX64(c(e.price_max),e.sale_decimals,e.raise_decimals).toString(),a=new h,r=c(e.total_supply).add(c(e.total_supply).mul(c(e.liquidity_injection_ratio))).toNumber(),_=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.coin_type_sale),u=M.buildCoinInputForAmount(a,_,BigInt(r),e.coin_type_sale,!1),l=[a.pure(d(s).admin_cap_id),a.pure(d(s).package_version_id),a.pure(d(s).pools_id),a.pure(T(e.owner)),a.pure(c(i).mul(V).toString()),a.pure(e.total_supply),a.pure(e.complete_raise_limit),a.pure(e.min_purchase_amount),a.pure(e.max_purchase_amount),a.pure(e.start_time),a.pure(e.purchase_duration),a.pure(e.lock_up_duration),a.pure((e.liquidity_injection_ratio*ue).toString()),a.pure(n),a.pure(o),a.pure(e.tick_spacing.toString()),u.transactionArgument,a.pure(e.protection_hard_cap.toString()),a.pure(m)],f=[e.coin_type_sale,e.coin_type_raise];return a.moveCall({target:`${s.published_at}::${Ie}::create_oversubscribe_pool`,typeArguments:f,arguments:l}),a}async creatPurchasePayload(e){const{ido:s}=this.sdk.sdkOptions,t=new h,i=await this.getPurchaseInfo(e.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1),n=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,e.coin_type_raise),o=M.buildCoinInputForAmount(t,n,BigInt(e.raise_amount),e.coin_type_raise,!1),a=[e.coin_type_sale,e.coin_type_raise];let r,_;return i?(_="purchase",r=[t.object(d(s).package_version_id),t.object(e.pool_address),t.object(i.purchase_certificate_id),t.pure(e.raise_amount.toString()),o.transactionArgument,t.pure(m)]):(_="create_certificate_and_purchase",r=[t.object(d(s).package_version_id),t.object(e.pool_address),t.pure(e.raise_amount.toString()),o.transactionArgument,t.pure(m)]),t.moveCall({target:`${s.published_at}::${I}::${_}`,typeArguments:a,arguments:r}),t}async redeemPayload(e){const{ido:s}=this.sdk.sdkOptions,t=await this.getPurchaseInfo(e.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1);if(t===void 0)throw Error("get purchase certificate fail");const i=new h,n=[e.coin_type_sale,e.coin_type_raise],o=[i.pure(d(s).package_version_id),i.pure(e.pool_address),i.pure(t.purchase_certificate_id),i.pure(m)];return i.moveCall({target:`${s.published_at}::${I}::redeem`,typeArguments:n,arguments:o}),i}injectLiquidityPayload(e){const{ido:s}=this.sdk.sdkOptions,{clmm_pool:t}=this.sdk.ClmmSDK.sdkOptions,i=new h,n=[e.coin_type_sale,e.coin_type_raise],o=e.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",a=[i.pure(d(s).package_version_id),i.pure(e.pool_address),i.pure(d(t).global_config_id),i.pure(e.clmm_pool_address),i.pure(m)];return i.moveCall({target:`${s.published_at}::${I}::${o}`,typeArguments:n,arguments:a}),i}unPauseInjectLiquidity(e){const{ido:s}=this.sdk.sdkOptions,{integrate:t,clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,n=new h;n.moveCall({target:`${t.published_at}::${ve}::unpause_pool`,typeArguments:[e.coin_type_a,e.coin_type_b],arguments:[n.object(d(i).global_config_id),n.object(e.clmm_pool_address)]});const o=[e.coin_type_sale,e.coin_type_raise],a=e.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",r=[n.object(d(s).package_version_id),n.object(e.pool_address),n.object(d(i).global_config_id),n.object(e.clmm_pool_address),n.object(m)];return n.moveCall({target:`${s.published_at}::${I}::${a}`,typeArguments:o,arguments:r}),n}async findClmmPoolForLiquidity(e){let s=null,t=!1;const i=await this.sdk.ClmmSDK.Pool.getPoolImmutables();for(const n of i){if(n.coinTypeA===e.coin_type_sale&&n.coinTypeB===e.coin_type_raise&&Number(n.tickSpacing)===e.tick_spacing){s=await this._sdk.ClmmSDK.Pool.getPool(n.poolAddress);break}if(n.coinTypeA===e.coin_type_raise&&n.coinTypeB===e.coin_type_sale&&Number(n.tickSpacing)===e.tick_spacing){s=await this._sdk.ClmmSDK.Pool.getPool(n.poolAddress),t=!0;break}}return s&&(c(s.current_sqrt_price).lessThanOrEqualTo(e.current_sqrt_price_min)||c(s.current_sqrt_price).greaterThanOrEqualTo(e.current_sqrt_price_max))?(console.log("clmmPool: ",s.poolAddress),{is_reverse:t,clmmPool:null}):{is_reverse:t,clmmPool:s}}withdrawPayload(e){const{ido:s}=this.sdk.sdkOptions,t=new h,i=[e.coin_type_sale,e.coin_type_raise],n=[t.object(d(s).package_version_id),t.object(e.pool_address),t.object(m)];return t.moveCall({target:`${s.published_at}::${I}::withdraw`,typeArguments:i,arguments:n}),t}updateWhitelistCapPayload(e){const{ido:s}=this.sdk.sdkOptions,t=new h,i=[e.coin_type_sale,e.coin_type_raise];return e.add_whites&&e.add_whites.addresses.length>0&&t.moveCall({target:`${s.published_at}::${I}::add_white_listed_addresses`,typeArguments:i,arguments:[t.object(d(s).admin_cap_id),t.object(d(s).package_version_id),t.object(e.pool_address),t.makeMoveVec({type:"address",objects:e.add_whites.addresses.map(n=>t.pure(z(n),"address"))}),t.pure(e.add_whites.protection_limit),t.object(m)]}),e.remove_whites&&e.remove_whites.length>0&&t.moveCall({target:`${s.published_at}::${I}::remove_white_listed_addresses`,typeArguments:i,arguments:[t.object(d(s).admin_cap_id),t.object(d(s).package_version_id),t.object(e.pool_address),t.makeMoveVec({type:"address",objects:e.remove_whites.map(n=>t.pure(z(n),"address"))}),t.object(m)]}),e.update_whites&&e.update_whites.forEach(n=>{t.moveCall({target:`${s.published_at}::${I}::update_white_listed_address`,typeArguments:i,arguments:[t.object(d(s).admin_cap_id),t.object(d(s).package_version_id),t.object(e.pool_address),t.object(n.address),t.pure(n.protection_limit),t.object(m)]})}),t}creatCancelPoolPayload(e){const{ido:s}=this.sdk.sdkOptions,t=new h,i=[e.coin_type_sale,e.coin_type_raise],n=[t.pure(d(s).admin_cap_id),t.pure(d(s).package_version_id),t.pure(e.pool_address),t.pure(m)];return t.moveCall({target:`${s.published_at}::${I}::cancel`,typeArguments:i,arguments:n}),t}updatePoolOwnerPayload(e,s){const{ido:t}=this.sdk.sdkOptions;s=s===void 0?new h:s;const i=[e.coin_type_sale,e.coin_type_raise],n=[s.object(d(t).admin_cap_id),s.object(d(t).package_version_id),s.object(e.pool_address),s.object(e.new_owner),s.object(m)];return s.moveCall({target:`${t.published_at}::${I}::update_pool_owner`,typeArguments:i,arguments:n}),s}updatePoolDuractionPayload(e,s){const{ido:t}=this.sdk.sdkOptions;s=s===void 0?new h:s;const i=[e.coin_type_sale,e.coin_type_raise],n=[s.object(d(t).admin_cap_id),s.object(d(t).package_version_id),s.object(e.pool_address),s.pure(e.start_time),s.pure(e.purchase_duration),s.pure(e.lock_duration),s.object(m)];return s.moveCall({target:`${t.published_at}::${I}::update_pool_duration`,typeArguments:i,arguments:n}),s}updateProtectionHardCapPayload(e,s){const{ido:t}=this.sdk.sdkOptions;s=s===void 0?new h:s;const i=[e.coin_type_sale,e.coin_type_raise],n=[s.object(d(t).admin_cap_id),s.object(d(t).package_version_id),s.object(e.pool_address),s.pure(e.protection_hard_cap),s.object(m)];return s.moveCall({target:`${t.published_at}::${I}::update_protection_hard_cap`,typeArguments:i,arguments:n}),s}unlockNftPayload(e){const{ido:s}=this.sdk.sdkOptions,t=new h,i=[e.nft_type],n=[t.pure(e.lock_nft_id),t.pure(m)];return t.moveCall({target:`${s.published_at}::lock::unlock_nft`,typeArguments:i,arguments:n}),t}async isAdminCap(e){const{ido:s}=this._sdk.sdkOptions,t=`${s.package_id}_${e}_isAdminCap`,i=this.getCache(t);if(i)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:d(s).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(n);const o=G(n),a=ee(n);let r=!1;return a&&o&&p(o).source_address===`${s.package_id}::config::AdminCap`&&(r=T(a.AddressOwner)===T(e)),this.updateCache(t,r,g),r}async getWhiteProtectionLimit(e,s,t=!0){const i=`${e}_${s}_getWhiteProtectionLimit`,n=this._sdk.getCache(i,t);if(n)return n;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"address",value:s}});if(o&&o.data){const a=k(o);return this._sdk.updateCache(i,a.value),a.value}return}catch{return}}async getWhiteList(e,s){var i;const t={type:"address",value:s};try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:t}),o=k(n);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getAdminAddress(){const{ido:e}=this._sdk.sdkOptions,s=`${d(e).admin_cap_id}_getAdminAddress`,t=this.getCache(s);if(t)return t;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:d(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(i);const n=G(i),o=ee(i);if(o&&n&&p(n).source_address===`${e.package_id}::config::AdminCap`){const r=T(o.AddressOwner);return this.updateCache(s,r,g),r}return""}updateCache(e,s,t=g){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}},xe=class{constructor(e){b(this,"_sdk");b(this,"_cache",{});this._sdk=e}get sdk(){return this._sdk}async getOwnerVeNFT(e,s=!0){const{xtoken:t}=this.sdk.sdkOptions,i=`${e}_getLockUpManagerEvent`,n=this.getCache(i,s);if(n!==void 0)return n;let o;const a=`${t.package_id}::xtoken::VeNFT`;return(await q(this._sdk.ClmmSDK,e,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:a}})).data.forEach(_=>{const u=p(K(_)).source_address;if(u===a&&_.data&&_.data.content){const{fields:l}=_.data.content;o={...de(_),id:l.id.id,index:l.index,type:u,xtoken_balance:l.xtoken_balance},this.updateCache(i,o,g)}}),o}async getOwnerLockTokens(e){const{xtoken:s}=this.sdk.sdkOptions,t=[],i=`${s.package_id}::lock_coin::LockedCoin<${this.buileTokenCoinType()}>`,n=await q(this._sdk.ClmmSDK,e,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of n.data)if(p(K(o)).source_address===i&&o.data){const r=L.buildLockToken(o.data.content),_=await this.getLockXToken(r.id);_&&(r.xtoken_amount=_.xtoken_amount),t.push(r)}return t}async getLockToken(e){var t;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showType:!0,showContent:!0}});if((t=s.data)!=null&&t.content){const i=L.buildLockToken(s.data.content),n=await this.getLockXToken(i.id);return n&&(i.xtoken_amount=n.xtoken_amount),i}}async getOwnerTokenCoins(e){return await this._sdk.ClmmSDK.getOwnerCoinAssets(e,this.buileTokenCoinType())}mintVeNFTPayload(){const{xtoken:e}=this.sdk.sdkOptions,s=new h;return s.moveCall({target:`${e.published_at}::${U}::mint_venft`,typeArguments:[],arguments:[s.pure(d(e).xtoken_manager_id)]}),s}async convertPayload(e){const{xtoken:s}=this.sdk.sdkOptions,t=new h,i=this.buileTokenCoinType(),n=await M.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,t,BigInt(e.amount),i);return e.venft_id===void 0?t.moveCall({target:`${s.published_at}::${U}::mint_and_convert`,typeArguments:[],arguments:[t.object(d(s).lock_manager_id),t.object(d(s).xtoken_manager_id),n,t.pure(e.amount)]}):t.moveCall({target:`${s.published_at}::${U}::convert`,typeArguments:[],arguments:[t.object(d(s).lock_manager_id),t.object(d(s).xtoken_manager_id),n,t.pure(e.amount),t.pure(e.venft_id)]}),t}redeemLockPayload(e){const{xtoken:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${U}::redeem_lock`,typeArguments:[],arguments:[t.pure(d(s).lock_manager_id),t.pure(d(s).xtoken_manager_id),t.pure(e.venft_id),t.pure(e.amount),t.pure(e.lock_day),t.pure(m)]}),t}redeemPayload(e){const{xtoken:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${U}::redeem`,typeArguments:[],arguments:[t.pure(d(s).lock_manager_id),t.pure(d(s).xtoken_manager_id),t.pure(e.venft_id),t.pure(e.lock_id),t.pure(m)]}),t}redeemDividendPayload(e,s){const{xtoken_dividends:t}=this.sdk.sdkOptions,i=new h;return s.forEach(n=>{i.moveCall({target:`${t.published_at}::${ae}::redeem`,typeArguments:[n],arguments:[i.object(d(t).dividend_manager_id),i.object(e)]})}),i}redeemDividendV2Payload(e,s){const{xtoken_dividends:t}=this.sdk.sdkOptions,i=new h;return s.forEach(n=>{i.moveCall({target:`${t.published_at}::${ae}::redeem_v2`,typeArguments:[n],arguments:[i.object(d(t).dividend_manager_id),i.object(e),i.object(m)]})}),i}buileTokenCoinType(){return`${this.sdk.sdkOptions.token_faucet.package_id}::token::TOKEN`}cancelRedeemPayload(e){const{xtoken:s}=this.sdk.sdkOptions,t=new h;return t.moveCall({target:`${s.published_at}::${U}::cancel_redeem_lock`,typeArguments:[],arguments:[t.pure(d(s).lock_manager_id),t.pure(d(s).xtoken_manager_id),t.pure(e.venft_id),t.pure(e.lock_id),t.pure(m)]}),t}async getInitConfigs(){var a,r;const{package_id:e}=this.sdk.sdkOptions.xtoken,s=`${e}_getInitFactoryEvent`,t=this.getCache(s);if(t!==void 0)return t;const i=(a=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::xtoken::InitEvent`}))==null?void 0:a.data,n={xtoken_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(_=>{const u=_.parsedJson;u&&(n.xtoken_manager_id=u.xtoken_manager)});const o=(r=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::locking::InitializeEvent`}))==null?void 0:r.data;return o.length>0&&o.forEach(_=>{const u=_.parsedJson;u&&(n.lock_manager_id=u.lock_manager)}),n.lock_handle_id=(await this.getLockUpManager()).lock_infos.lock_handle_id,this.updateCache(s,n,g),n}async getLockUpManager(){const{xtoken:e}=this.sdk.sdkOptions,{lock_manager_id:s}=d(e),t=`${s}_getLockUpManagerEvent`,i=this.getCache(t);if(i!==void 0)return i;const n=await this.sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0}}),o=L.buildLockUpManager(k(n));return this.updateCache(t,o,g),o}async getLockInfoHandle(e){const s=`${e}_getLockInfoHandle`,t=this.getCache(s);if(t!==void 0)return t;let i="";const n=await this.sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=k(n);return o&&(i=o.lock_infos.fields.id.id,this.updateCache(s,i,g)),i}async getDividendConfigs(){var o;const{package_id:e}=this.sdk.sdkOptions.xtoken_dividends,s=`${e}_getDividendManagerEvent`,t=this.getCache(s);if(t!==void 0)return t;const i=(o=await P(this._sdk.ClmmSDK,{MoveEventType:`${e}::dividend::InitEvent`}))==null?void 0:o.data,n={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(a=>{const r=a.parsedJson;r&&(n.dividend_manager_id=r.manager_id,n.dividend_admin_id=r.admin_id,n.dividend_settle_id=r.settle_id,this.updateCache(s,n,g))}),n}async getDividendManager(e=!1){const{dividend_manager_id:s}=d(this.sdk.sdkOptions.xtoken_dividends),t=`${s}_getDividendManager`,i=this.getCache(t,e);if(i!==void 0)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0}}),o=k(n),a=L.buildDividendManager(o);return this.updateCache(t,a,g),a}async getXcetusManager(e=!0){const{xtoken_manager_id:s}=d(this.sdk.sdkOptions.xtoken),t=`${s}_getXcetusManager`,i=this.getCache(t,e);if(i)return i;const n=await this._sdk.ClmmSDK.fullClient.getObject({id:s,options:{showContent:!0}}),o=k(n),a={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(t,a),a}async getVeNFTDividendInfo(e,s){try{const t=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:s}}),i=k(t);return L.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(e,s){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const t=await this.getLockUpManager(),i=c(O).mul(c(t.max_lock_day).sub(c(s))).mul(c(t.max_percent_numerator).sub(c(t.min_percent_numerator))).div(c(t.max_lock_day).sub(c(t.min_lock_day))),n=c(O).mul(c(t.max_percent_numerator)).sub(i).div(c(Y)).div(O);return{amountOut:c(n).mul(c(e)).round().toString(),percent:n.toString()}}async reverseRedeemNum(e,s){if(BigInt(e)===BigInt(0))return{amountOut:"0",percent:"0"};const t=await this.getLockUpManager(),i=c(O).mul(c(t.max_lock_day).sub(c(s))).mul(c(t.max_percent_numerator).sub(c(t.min_percent_numerator))).div(c(t.max_lock_day).sub(c(t.min_lock_day))),n=c(O).mul(c(t.max_percent_numerator)).sub(i).div(c(Y)).div(O);return{amountOut:c(e).div(n).toFixed(0,x.ROUND_UP),percent:n.toString()}}async getLockXToken(e){const{lock_handle_id:s}=d(this._sdk.sdkOptions.xtoken),t=`${e}_getXTokenAmount`,i=this.getCache(t);if(i)return i;try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:s,name:{type:"0x2::object::ID",value:e}}),o=k(n);if(o){const a=o.value.fields.value.fields;return this.updateCache(t,a,g),a}}catch{}}async getVeNftAmount(e,s){try{const t=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:s}}),i=k(t);if(i){const{lock_amount:n,xcetus_amount:o}=i.value.fields.value.fields;return{lock_amount:n,xcetus_amount:o}}}catch{}return{lock_amount:"0",xcetus_amount:"0"}}async getPhaseDividendInfo(e,s=!1){const i=(await this.getDividendManager()).dividends.id,n=`${i}_${e}_getPhaseDividendInfo`,o=this._sdk.getCache(n,s);if(o)return o;const a=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:e}}),r=k(a),_=r.value.fields.value.fields,u=_.redeemed_num.fields.contents.map(y=>({name:y.fields.key.fields.name,value:y.fields.value})),l=_.bonus_types.map(y=>y.fields.name),f=_.bonus.fields.contents.map(y=>({name:y.fields.key.fields.name,value:y.fields.value})),v={id:X(a),phase:r.name,settled_num:_.settled_num,register_time:_.register_time,redeemed_num:u,is_settled:_.is_settled,bonus_types:l,bonus:f,phase_end_time:""};return this.updateCache(n,v),v}updateCache(e,s,t=A){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}},Ne=class{constructor(e,s){b(this,"_cache",{});b(this,"_sdkOptions");b(this,"_launchpad");b(this,"_ido");b(this,"_xcetusModule");b(this,"_xtokenModule");b(this,"_boosterModule");b(this,"_makerModule");b(this,"_clmmSDK");this._sdkOptions=e,this._clmmSDK=s,this._launchpad=new Pe(this),this._ido=new Oe(this),this._xcetusModule=new Se(this),this._xtokenModule=new xe(this),this._boosterModule=new Ce(this),this._makerModule=new De(this),fe(this._sdkOptions)}get ClmmSDK(){return this._clmmSDK}get sdkOptions(){return this._sdkOptions}get Launchpad(){return this._launchpad}get Ido(){return this._ido}get XToken(){return this._xtokenModule}get XCetusModule(){return this._xcetusModule}get BoosterModule(){return this._boosterModule}get MakerModule(){return this._makerModule}updateCache(e,s,t=g){let i=this._cache[e];i?(i.overdueTime=S(t),i.value=s):i=new F(s,S(t)),this._cache[e]=i}getCache(e,s=!1){const t=this._cache[e];if(!s&&(t!=null&&t.isValid()))return t.value;delete this._cache[e]}};export{Ne as C,w as I,E as X,$e as a};
