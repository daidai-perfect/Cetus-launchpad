import{_ as dn}from"./refresh-icon.0d1d6216.js";import{_ as mn}from"./assets-card.dd5e1791.js";import{u as Me,e as io,c as Ae,s as le,a as H,q as Ge,d as ge,A as Ye,g as Ro,j as vn,b as Ze,p as $o}from"./pool.ec7155de.js";import{e as Fe,a as Ke,C as No,L as Oo,r as b,l as T,q as ne,s as je,o as l,f,h as o,c as Z,x as F,t as ee,j as Q,v as u,A as se,F as Be,u as z,S as To,M as Bo,p as Ee,k as Ue,a4 as pn,i as ye,w as me,P as Mo,a1 as Fo,Q as jo,E as Io,B as Eo,b as Po,y as gn,H as fn,K as hn,D as ze}from"./entry.99d20ac2.js";/* empty css              *//* empty css              */import{c as be,u as Le,a as Cn}from"./sha256.f7311d31.js";import{i as fe}from"./import-icon.de3e6c66.js";import{D as i}from"./decimal.0bdeb344.js";import{_ as wn}from"./network-tips.ef91dba5.js";import{_ as bn}from"./coin-select.46a920a0.js";import{_ as kn}from"./swap-setting.d31df86e.js";/* empty css              */import{_ as yn}from"./token-warning-modal.cdb1d9ac.js";import{u as An}from"./swapRouter.c2c0f57b.js";import{_ as Sn}from"./img-leverage_2x.1c577303.js";/* empty css              */import"./token-warning.11ff7cab.js";/* empty css              */import"./img-no-Positions_2x.59bd36fa.js";import"./img-no-Positions_2x.be9f9259.js";/* empty css              */import"./icon-error_2x.3cd9b14e.js";import"./icon-selected_3x.09e9a6f0.js";async function _n(e,h){var W,q,p;const R=e==="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":e,v=`${be.Sui.api}/v2/sui/coin/kline?coin_address=${R}&interval=day&market=${h}`;try{const N=await $fetch(v);return console.log("0621###getprice###res###",N),{price:((q=(W=N==null?void 0:N.data)==null?void 0:W.list)==null?void 0:q.reverse())||[],daily_rate:(p=N==null?void 0:N.data)==null?void 0:p.daily_rate.replace("%","")}}catch{return{price:[],daily_rate:""}}}async function $n(e){try{const{prices:h}=await $fetch(`https://api.coingecko.com/api/v3/coins/${e}/market_chart?vs_currency=usd&id=${e}&days=7&interval=daily`,{headers:{Connection:"keep-alive",Accept:"*/*"}}),v=(await $fetch(`https://api.coingecko.com/api/v3/coins/markets?ids=${e}&vs_currency=usd&price_change_percentage=24h`,{headers:{Connection:"keep-alive",Accept:"*/*"}}))[0].price_change_percentage_24h,W=[];return h.forEach(q=>{W.push({price:new i(q[1]).toString(),timestamp:q[0]})}),{price:W,daily_rate:v}}catch{return{price:[],daily_rate:""}}}const In=""+globalThis.__publicAssetsURL("sui-image/route-view.png");const Pn=Ke({props:{swapLoading:{type:Boolean,default:!1},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fixedFromCoin:{type:Boolean,default:!0},impact:{type:String,default:""},insufficientLiquidity:{type:Boolean,default:!1},oneToAmount:{type:String,default:""},oneFromAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})},suiSwapFee:{type:String,default:""},swapRouterLoading:{type:Boolean,default:!1}},setup(e){const h=No(Oo,{style:{fontSize:"20px",color:"#75C8FF"},spin:!0}),R=b(!1),v=Le(),W=T(()=>v),q=T(()=>W.value.slippage),p=T(()=>W.isShowRouterModal);ne(()=>e,n=>{console.log(n,"==>newValue")},{immediate:!0,deep:!0});const N=Me(),k=T(()=>N),X=io("Sui"),K=b(0),V=b([]),I=b({});ne(()=>e.suiPreSwapdata,async n=>{var t;if(console.log(n,"===>suiPreSwapdata"),n&&!Ae(n)){let w=[];(t=n==null?void 0:n.splitPaths)==null||t.forEach(O=>{O==null||O.basePaths.forEach(async D=>{w.push(D.label),console.log(D.toCoin,"==>basePath.toCoin"),console.log(D.fromCoin,"==>basePath.fromCoin")})});const{splitPaths:C}=n,P=C&&C[0]&&C[0].basePaths;if(C&&C.length==1&&P&&P.length==2){const O=P[0].toCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":P[0].toCoin;I.value=k.value.tokensObj[O]||(await X.getTokenListByCoinType[O])[0],console.log(I.value,"===>coinTypeB.value")}else I.value="";V.value=Array.from(new Set(w)),K.value=V.value.length,console.log(V.value,"===>sourcesArr.value"),console.log(I.value,"===>coinTypeB")}},{immediate:!0});const E=b(0),r=b(0);ne(()=>[e.fromCoinAmount,e.toCoinAmount,e.fromCoin,e.toCoin,e.fixedFromCoin,q.value],([n,t,w,C,P,O])=>{if(n&&t&&w&&C&&O)if(P){const D=new i(t).mul(new i(O/100));r.value=new i(t).sub(D).toString()}else{const D=new i(n).mul(new i(O/100));E.value=new i(n).add(D).toString()}},{immediate:!0});const x=n=>{var t;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((t=k.value.tokensObj[n==null?void 0:n.address])==null?void 0:t.logo_url)||(W.theme==="default"?fe("/image/coins/unknown.png"):fe("/image/coins/sui-unknown.png"))},oe=T(()=>{var n,t,w,C,P,O,D,$,J;return(w=(t=k==null?void 0:k.value)==null?void 0:t.tokensObj[(n=e.fromCoin)==null?void 0:n.address])!=null&&w.pyth_id&&((O=(P=k==null?void 0:k.value)==null?void 0:P.tokensObj[(C=e.fromCoin)==null?void 0:C.address])==null?void 0:O.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(J=($=k==null?void 0:k.value)==null?void 0:$.tokensObj[(D=e.fromCoin)==null?void 0:D.address])!=null&&J.coingecko_id?"coingecko":null}),y=T(()=>{var n,t,w,C,P,O,D,$,J;return(w=(t=k==null?void 0:k.value)==null?void 0:t.tokensObj[(n=e.toCoin)==null?void 0:n.address])!=null&&w.pyth_id&&((O=(P=k==null?void 0:k.value)==null?void 0:P.tokensObj[(C=e.toCoin)==null?void 0:C.address])==null?void 0:O.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(J=($=k==null?void 0:k.value)==null?void 0:$.tokensObj[(D=e.toCoin)==null?void 0:D.address])!=null&&J.coingecko_id?"coingecko":null}),G=b(""),U=async()=>{console.log("##result400");const n=k.value.tokenExternalPriceObj[e.fromCoin.address],t=k.value.tokenExternalPriceObj[e.toCoin.address];if(n&&t){console.log("fromCoin价格:",n),console.log("toCoin价格",t),console.log("当前价格:",e.oneToAmount.replace(",",""));const w=new i(n).div(new i(t)),C=new i(e.oneToAmount.replace(new RegExp(/,/g),"")).sub(w).div(w).mul(100);console.log(oe.value,y.value,"##417");let P=Math.abs(le(C,2));w.toNumber()<Number(e.oneToAmount.replace(new RegExp(/,/g),""))?G.value="":(G.value=C>0&&C<=.01?"0.01":P,console.log(n,t,C.toString(),"##367"))}else G.value=""},g=n=>{if(n<5)return"color-s";if(n>=5&&n<10)return"color-w";if(n>=10)return"color-e"};return ne(()=>[e.oneToAmount,k.value.tokenExternalPriceObj],([n,t])=>{n&&t&&!Ae(t)&&(console.log(n,t,"##newVal"),U())},{immediate:!0,deep:!0}),{sFixD:le,getCoinIcon:x,indicator:h,rateChange:R,slippage:q,isShowRouterModal:p,indexStore:v,maximumSold:E,minimumReceived:r,addCommom:H,pathLength:K,sourcesArr:V,coinTypeB:I,priceExangeRate:G,getTextColor:g,formCoinMarket:oe,toCoinMarket:y}}}),re=e=>(Ee("data-v-05eeebb6"),e=e(),Ue(),e),Rn={key:0,class:"swap-info"},Nn={class:"loading-swap"},On={key:1,class:"swap-rate"},Tn={key:0},Bn={key:0,class:"after-amount"},Mn={key:1},Fn={key:0,class:"after-amount"},jn=re(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),En=re(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Un=[jn,En],Ln={key:2,class:"swap-exchange-rate"},Dn={class:"swap-exchange-rate-content"},Wn={key:0},qn=["href"],Jn=re(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),Qn=[Jn],Xn={key:1},Hn=["href"],Yn=re(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),Zn=[Yn],zn={key:0},Gn=["href"],Kn=re(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),Vn=[Kn],xn={key:1},et=["href"],ot=re(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),nt=[ot],tt={key:2},st=["href"],at=re(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),it=[at],lt={key:3},rt=["href"],ut=re(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),ct=[ut],dt={key:3},mt={class:"trade-info"},vt={class:"trade-block"},pt=re(()=>o("div",{class:"lebal"},"Price Impact",-1)),gt={key:0,class:"icon","aria-hidden":"true"},ft=re(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),ht=[ft],Ct={class:"trade-block"},wt={class:"lebal"},bt={key:0,class:"text"},kt={class:"trade-block"},yt=re(()=>o("div",{class:"lebal"},"Fee",-1)),At={key:0,class:"text"},St={key:0,class:"trade-block"},_t=re(()=>o("div",{class:"lebal"},"Route",-1)),$t={key:0,class:"text text-box"},It=["src"],Pt=["src"],Rt={key:1,class:"text text-box"},Nt=["src"],Ot=["src"],Tt=re(()=>o("img",{src:In,alt:""},null,-1));function Bt(e,h,R,v,W,q){var X,K,V,I;const p=To,N=Bo,k=je("image");return e.swapLoading||Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&!e.insufficientLiquidity?(l(),f("div",Rn,[o("div",Nn,[e.swapLoading||e.swapRouterLoading?(l(),Z(p,{key:0,size:"small",indicator:e.indicator},null,8,["indicator"])):F("",!0),e.swapLoading?F("",!0):(l(),f("div",On,[e.rateChange?(l(),f("span",Mn,[e.fromCoinAmount&&e.toCoinAmount?(l(),f("span",Fn,[ee(o("img",null,null,512),[[k,e.getCoinIcon(e.toCoin)]]),Q(" 1 "+u(e.toCoin.symbol)+" ≈ ",1),ee(o("img",null,null,512),[[k,e.getCoinIcon(e.fromCoin)]]),Q(u(e.oneFromAmount==1/0?0:e.oneFromAmount)+" "+u(e.fromCoin.symbol),1)])):(l(),Z(p,{key:1,indicator:e.indicator},null,8,["indicator"]))])):(l(),f("span",Tn,[ee(o("img",null,null,512),[[k,e.getCoinIcon(e.fromCoin)]]),Q(" 1 "+u(e.fromCoin.symbol)+" ≈ ",1),e.fromCoinAmount&&e.toCoinAmount?(l(),f("span",Bn,[ee(o("img",null,null,512),[[k,e.getCoinIcon(e.toCoin)]]),Q(u(e.oneToAmount==1/0?0:e.oneToAmount)+" "+u(e.toCoin.symbol),1)])):(l(),Z(p,{key:1,indicator:e.indicator},null,8,["indicator"]))])),o("div",{class:"right",onClick:h[0]||(h[0]=E=>e.rateChange=!e.rateChange)},Un)])),!e.swapLoading&&e.priceExangeRate!==""&&e.priceExangeRate>10?(l(),f("div",Ln,[o("div",Dn,[o("p",null,[o("span",{class:se(e.getTextColor(e.priceExangeRate))},"Within ~"+u(e.priceExangeRate)+"% of",3)]),e.formCoinMarket=="pyth"&&e.toCoinMarket=="pyth"?(l(),f("span",Wn,[Q("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.fromCoin.pyth_id}&ids[]=${e.toCoin.pyth_id}`,target:"_blank"},Qn,8,qn)])):e.formCoinMarket=="coingecko"&&e.toCoinMarket=="coingecko"?(l(),f("span",Xn,[Q("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.fromCoin.coingecko_id},${e.toCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},Zn,8,Hn)])):e.formCoinMarket!==e.toCoinMarket?(l(),f(Be,{key:2},[e.formCoinMarket=="pyth"?(l(),f("span",zn,[Q("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.fromCoin.pyth_id}`,target:"_blank"},Vn,8,Gn)])):e.formCoinMarket=="coingecko"?(l(),f("span",xn,[Q("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.fromCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},nt,8,et)])):F("",!0),e.toCoinMarket=="coingecko"?(l(),f("span",tt,[Q("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.toCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},it,8,st)])):e.toCoinMarket=="pyth"?(l(),f("span",lt,[Q("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.toCoin.pyth_id}`,target:"_blank"},ct,8,rt)])):F("",!0)],64)):F("",!0)])])):e.swapLoading?(l(),f("span",dt,"Best route and price")):F("",!0)]),o("div",mt,[o("div",vt,[pt,e.swapRouterLoading?(l(),Z(N,{key:1,paragraph:!1,active:""})):(l(),f("div",{key:0,class:se(["text",e.impact<1?"impact-s":e.impact<10&&e.impact>=1?"impact-w":"impact-e"])},[Q(u(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",1),e.impact>=10?(l(),f("svg",gt,ht)):F("",!0)],2))]),o("div",Ct,[o("div",wt,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swapRouterLoading?(l(),Z(N,{key:1,paragraph:!1,active:""})):(l(),f("div",bt,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:z(H))(("sFixD"in e?e.sFixD:z(le))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:z(H))(("sFixD"in e?e.sFixD:z(le))(e.maximumSold,e.fromCoin.decimals)))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),o("div",kt,[yt,e.swapRouterLoading?(l(),Z(N,{key:1,paragraph:!1,active:""})):(l(),f("div",At,u(e.suiSwapFee)+" "+u(e.fromCoin.symbol),1))]),e.insufficientLiquidity?F("",!0):(l(),f("div",St,[_t,e.swapRouterLoading?(l(),Z(N,{key:1,paragraph:!1,active:""})):(l(),f("div",{key:0,class:"text",onClick:h[1]||(h[1]=E=>e.indexStore.setIsShowRouterModal(!e.isShowRouterModal))},[!e.swapRouterLoading&&e.suiPreSwapdata&&e.suiPreSwapdata.splitPaths&&e.suiPreSwapdata.splitPaths.length==1?(l(),f("div",$t,[o("span",null,u(e.fromCoin.symbol)+" "+u(e.coinTypeB&&((X=e.coinTypeB)!=null&&X.symbol)?`> ${(K=e.coinTypeB)==null?void 0:K.symbol}`:"")+" > "+u(e.toCoin.symbol),1),o("img",{src:e.sourcesArr[0]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,It),e.sourcesArr[1]?(l(),f("img",{key:0,src:e.sourcesArr[1]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,Pt)):F("",!0)])):e.swapRouterLoading?F("",!0):(l(),f("div",Rt,[Q(u((I=(V=e.suiPreSwapdata)==null?void 0:V.splitPaths)==null?void 0:I.length)+" Streams ",1),e.sourcesArr[0]?(l(),f("img",{key:0,src:e.sourcesArr[0]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,Nt)):F("",!0),e.sourcesArr[1]?(l(),f("img",{key:1,src:e.sourcesArr[1]=="Deepbook"?"/sui-image/logo_deepbook@2x.png":"/sui-image/logo_cetus@2x.png",alt:""},null,8,Ot)):F("",!0)])),Tt]))]))])])):F("",!0)}const Mt=Fe(Pn,[["render",Bt],["__scopeId","data-v-05eeebb6"]]),Ft={props:{coin:{type:Object,default:()=>({})},refresh:{type:Boolean,default:!1},id:{type:String,default:""},market:{type:String,default:""}},setup(e,h){const{$echarts:R}=pn();let v=null,W;const q=b(!0),p=Le(),N=T(()=>p),k=T(()=>N.value.chainName),X=T(()=>be[k.value]),K=Me(),V=T(()=>K),I=(n,t,w)=>{W={xAxis:{type:"category",boundaryGap:!1,show:!1,data:t},yAxis:{type:"value",show:!1,min:function(C){return C.min-C.min*.1},max:function(C){return C.max+C.max*.1}},grid:{top:1,right:1,bottom:1,left:1},tooltip:{trigger:"axis",borderWidth:0,padding:0,backgroundColor:"transparent",axisPointer:{lineStyle:{color:N.value.chainName=="Aptos"?"#68FFD8":"#76C8FF"}},formatter:function(C){return`<div class="chart-tip">
              <div>${C&&C[0]&&C[0].name}</div>
              <div>$${ge(C&&C[0]&&C[0].value,4)}</div>
            </chart-tip>`}},color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:N.value.chainName=="Aptos"?"#0C4535":"#2E546D"},{offset:1,color:N.value.chainName=="Aptos"?"#151817":"#1B1B1B"}]},series:[{data:n,type:"line",showSymbol:!1,areaStyle:{},lineStyle:{color:N.value.chainName=="Aptos"?"#68FFD8":"#76C8FF",width:2,type:"solid"}}]},W&&v.clear(),W&&v.setOption(W,!0),v.resize(),q.value=!1},E=b(""),r=b(""),x=async n=>{var D,$,J;const t=[],w=[],{price:C,daily_rate:P}=k.value==="Aptos"?await $n(n):await _n(n,e.market);k.value=="Sui"&&K.setTokenExternalPrice(e.coin.address,(D=C[C.length-1])==null?void 0:D.price),E.value=P,r.value=C&&C.length>1&&C[C.length-1].price,k.value==="Aptos"?C.forEach(c=>{t.push(c.price);const d=Ye(Number(c.timestamp),"MD"),pe=Ye(Number(c.timestamp),"HM");w.push(d+" "+pe)}):C.forEach(c=>{t.push(c.price);const d=Ye(new i(c.timestamp).mul(1e3).toNumber(),"MD"),pe=Ye(new i(c.timestamp).mul(1e3).toNumber(),"HM");w.push(d+" "+pe)});let O=document.getElementById(`main${($=e.coin)==null?void 0:$.name}`);v=R.init(O),I(t,w,(J=e.coin)==null?void 0:J.name)};ne(()=>e.id,(n,t)=>{console.log(n,t,"===>oldValue"),console.log(!q.value,"!isFirst.value"),n&&(E.value="",r.value="",setTimeout(()=>{x(n)},1e3))},{immediate:!0});const oe=b(""),y=b(""),G=b(""),U=b("");ne(()=>[V.value.tokensObj,e.coin],([n,t])=>{var w,C;n&&t&&n[t.address]&&(console.log(n[t.address],"===>newValue[coin.address]"),y.value=((w=n[t.address])==null?void 0:w.labels)&&((C=n[t.address])==null?void 0:C.labels[0]),oe.value=n[t.address].name,G.value=n[t.address].symbol,U.value=n[t.address].address)},{immediate:!0,deep:!0}),ne(()=>e.refresh,n=>{n&&x(e.id)});const g=T(()=>N.value.theme);return console.log(e.coin.address=="0x2::sui::SUI","0x2::sui::SUI"),{theme:g,store:p,importIcon:fe,fixD:Ge,config:X,price_rate_24h:E,nowPrice:r,coinName:oe,coinLabels:y,coinSymbol:G,address:U,decimalUi:ge}}},jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAk1BMVEUAAADn2v/m2//r2//v4//n2v/55P/n2v/o3P//+P/m2v/n2f/n2v/n2v/n2v/n2v/n2v/o2//p2//n3f/o3v/n2f/n2v/n2v/n2v/n2v/n2//o2v/q3f/r4f/u3f/n2v/o2v/n2//p3P/o3P/m2v/n2v/n2f/n2v/o2f/n2//r3f/t3P/n2v/m2v/o2v/r3v/m2f/tUDLHAAAAMHRSTlMAl5oyFNMJqSwFhvvr5d7Yr2FGNSD0zb2lkIltOhkOxoJoT0D48aJzWFYlHeB8Wief0nHAAAABSElEQVQ4y52Q53LCMBCEZWK5g0swBpveQknZ93+6rFxAHkSYyf6x9+67JqHLKxOZRzJJbWHStkCn0Fo8pG0XuvJv0dciBjVZb+dZeoxABb38MlbpXeucr5z2QwdUf8vX1h0ByLT9aAeCGlez4Ozw5zoE4nvFBJB0yymUhqp0B2DT5ec0O+YlWlUMJsCqAwJA8jNV1W4RAnuvqepeYwWsOR/AkfM9ji8YjYBTC3wCZyEq1jvKnoCQP8X90j0wF2IGuM2jArjUE8sWAPAmxACwavtDf623XJsBtoqa2zcm4MI8Ag7iNZkBeAcVc8cUOPhPgJjP4I/UzkYgKtWxpQqaAGfMvvUATIUBaOQHAEb2M2CZcj4OnrhJasDYXYVQ9Vpe2LJ/BeWyf4/oAXlC25e9uI0IqswRJulX/BOwXgG2JPCCIPA3sXmM/QK1PTc8LGCPoAAAAABJRU5ErkJggg==",Et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAACM9JREFUWEeVV2lwU9cV/u59i1YLWZItb9iWw2JWsxXCQMIyJAOdkJSEtsDQhE7Slpl2OoXOdJpf4R/9kU7STtqmDBm2pnQaICkOZUoISUigQFhM7BhsTGUbGyNbsqzNT09v69yr2IjdOfr3dO493znnO8slGKO8H/6VV8vY3tDM1OpMbtCTMzKiZir8tETskESX7pZ9SYl6GiWXumVN6M2hsVxNHqW0/8ovlpqaeWBguMOnG9oj9dl9oiBZJY4Jg1Sma9dPeevTh9l44IV7el70y/FxF26lr1Ybps71iiQ7JrjLEHKVwinKcIs2WDQABW5kDBWdyXZcS1xBMpfiNgUqWkH35G6tODn3paq9sfsBuS+A/c2bl6azQ8cTuYjADpU7vFgenAGf5IIJi/9GxLJMECKCCAEIci0EsQoxpRUfd7+H3kwfV/PIQaPI7l2xfsbb90TjHgB7mjZtTeUGX89qKSJTAasqZqPa6YdhmgB5WAYMwLIAIoBIdRDFIG4kzuLIjRNQTQ12yW15pODWF2fvfLMwEnfcuK/5laVJpf+EoqXIOMmOF6oeh1O0ca/HLkyXgRFBpUooRhaHOhsRz6U5CL+jcnlhJEYBvHVljd+WcUQSap/gkWzYWLsEhBBYzKsCoYSA/ZiwVFAA7JtpWdDv0GXnLEAoBhUq8bdrOzGUS2OcrcyQXdngS1Pe55wYBfDu5Z939qVbayQqYEPNYrhF+2iuiUVAKYEJE9FsGmlN4eDsooyYQtE3nEPI48SEIgdM04Q1miqLp4VItVDhxN62PyNn6qhwT+3a0PCn2lEALPSxTPcJVmYry2diYlEFDMvkDjDDWUPD1UQPwul+JHQFqqFy5DKRoFoibmQsdKUFrAjWYl1dBWQWuVHXGAgKqehphOOncbjzIAQqWWXuOp4Krrbv8uZoJN3mL5ad2Fj7ZN44Cy0IwukIzsU6ENeGkTMMeB1VaChdBYHK6IidRmfiS5hEQFYHRCpjeTCEKZ4KOEQ7yGgMdRBpEiTHdLzb+hoGlBjK3PWxjQ1/CZBdl77nTanZwZyhkjVV30G5w8dzJxCKrxPdOBvtQMrIgqXB7wxhofeXOHbkJEzdwvxFM9HrPIxw/DxEIoLBZudkKqLS6UPIVYIqlx8OKnOHZM9z6E83YX/7TkiCzaoOlvnIrgs/2RXLdmyyURE/m/gUdNPgnverCXx0qxlRNcUvZTmfV7IRXx3N4vMvTnLSzZw+CwvXetGaakROz4AQRsl8NfL8AXAIEuqLKjHXXw2HYzYkeQLebv4NFD2LcteU3WTfV5ujkVSbv9YVwOrKeTz8IhXwef8VNA12ceIx45RQLCh9GV8c7MPZc2d4cKdMmoYl6ypwTT2C4dwQKOF9q0DyLcswDcwqrsEC/zR4fD/Ev9u3oy3ZgfHemTGyu+nlXDTzP+mJkslo8Nbymmdl9WHPeXSk+zmYvBBUu+cimF6JwwePcw/nLZgF14xWXI19AkKF0fIcQSAQietppgaZUKyqmI6JZT9FS/+/cKznOEpcdRrZcf4HZlIdIM9VzuP5YpA1S0dj7wXcyMRuA+AVIaCh9Bl4zalQVQ1mURTn+/ZDM4ZB7vJeIDJqPHOgGml0JS9CpjJWVczEpMB30ZfpwD+uH4DHVmKRP5xZaWqGSn4UWgIPYy4BhnUVH/ZexE0lXhCBfOMxTR0O2QOR2pDKRkEpY0w+9yPC9NiIDhUvgKIn0BE/izpnOZaW18PvrEfOVPHXq3/nRCR/PLPSZBWwoWYRim1uTsB4LsMBxHJ5At4t+cxa3DADfFezzKtTBlaDqgAOswjPPjYT1R4fTAhQLQPvXPsPJMFukR3n15lJNUJWljfwUcsIN5BN4sjNi0how5x8DxTLQk6hkGQLgs3i/GFtWlcJlEERhga4XAKeqK3DrMB40G+aU68Sxwc9X8JjK7XInqZXcgOZ69Kc4hosCtQDhOLmcAxHbl7CsJHjhHyYaAowHJGRSwswTAIqmJCcJuxeA04HxeKKiZgWqIAAgc8VFuFL8TBORdtR4npMI//8eku0e6jJX2IrwvraRZyE11MRHL15CQbz6BEAYFrQNQJDZ3XCeh+byBZcdgGLg5NR76n8hiP5viASioM3zoJFodo7K0Y+uPLaro7Bk5tEQvDjumVwCDKah7pw7FYL2GAasxQEihXk44GJvKzZ58J5yhza0fERNNPEBN+Tu8kn4W3elv5zg6qukPn+EGYX1+FUtA1N8S6I9zSWMcBhHdI7HotLpxQOW36QAbs8FMbJgXbYRIc1vXS+j+N+r+XX0a7ERb9dEPF0WQNOD7QhoibvWwEPJiR416x0+PBM5RxIRCwY9vn0sC67N/wphg0NNePmxL4//fcBDuBoePvS9shnJ1g/KBJFpHX9W+1A7A5GMIlQrKmejxLZc8/6xsj8WaQFzYleXv+TgkuWrwq9mh/HTA62/rYzHD9bw2pbN7N83H4b0Q0DcwIhLPRPhHBX6lgptye78XGkDYZlsAbV9cLU391eSJihQz2v+pP9tyJRpVPIg8ixtXpMGNhkFEHxfPUClNqY97ePMeOx7BAO9Vzgy2nAUWt4SsuCz1dtv3MlG0lFV+z8ibQ6SCgoNEMBpfIjS1G3DExyl2NZcBrsgpTfFQnlaWkZ6sR/Y2HkTA1um8+q8c/joR+BeE+XaWzbtrU31fw6B0EEsOcXZXv/Xf2+MDRsz1scmIzZvhAvXbYXDKlpnOpvRZeSgGHp3HiFe8bWZ+u3PXgtH7mUkTISv3Y8qoRHG4Fh5UBRAKQAOgPwVHAGphWPR1RJoiURxvX0IA85Exb2YPGkFYWePzACI38wTlhJ60JP8nK1ZmS5OUYuxg0+jPgEYp/ZtmygWHbzMtMswuc/EzZsqjwN3cRD5o7k/G5SPfKxyaKRHo4duJVu9bFmNRZWsiZT5p466Hb6197P68I7xnQhO8A6ZiJrvaGZ6dWKnvSoelpUtPwL3CF5YRPdukP0JCXqbhxnJ1uWhbaN6Xn+f1F23aMaO2HeAAAAAElFTkSuQmCC";const Ut=e=>(Ee("data-v-9f8b1d01"),e=e(),Ue(),e),Lt={class:"token-info"},Dt={class:"token-info-padding"},Wt={class:"token-info-header"},qt={class:"left"},Jt=["onerror"],Qt={class:"name"},Xt={class:"desc"},Ht={key:0},Yt={class:"right"},Zt={class:"price-info"},zt={key:0,src:jt,alt:""},Gt={key:1,src:Et,alt:""},Kt={class:"token-info-footer"},Vt={class:"left"},xt={class:"address"},es={key:0,class:"pc-address"},os={key:1,class:"pc-address"},ns={class:"h5-address"},ts=Ut(()=>o("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),ss=[ts],as={class:"right"},is=["id"];function ls(e,h,R,v,W,q){var k;const p=Mo,N=je("image");return l(),f("div",Lt,[o("div",Dt,[o("div",Wt,[o("div",qt,[ee(o("img",{onerror:v.theme=="default"?v.importIcon("/image/coins/unknown.png"):v.importIcon("/image/coins/sui-unknown.png")},null,8,Jt),[[N,R.coin.logoURI||v.importIcon(`/image/coins/${R.coin.symbol.toLowerCase()}.png`)]]),o("div",null,[o("div",Qt,u(v.coinSymbol),1),o("div",Xt,[o("span",null,[Q(u(v.coinName)+" ",1),v.theme!=="sui"?(l(),f("span",Ht,u(v.coinLabels?`(${v.coinLabels})`:""),1)):F("",!0)])])])]),o("div",Yt,[ye(p,{placement:"top","arrow-point-at-center":""},{title:me(()=>[Q(u(R.market==="pyth"?"Data source: Pyth Network":"Data source: CoinGecko"),1)]),default:me(()=>[o("div",Zt,[R.market==="pyth"?(l(),f("img",zt)):(l(),f("img",Gt)),o("span",null,"$"+u(v.nowPrice?Number(v.nowPrice)<1?v.decimalUi(v.nowPrice,4):v.fixD(v.nowPrice,2):"--"),1),v.price_rate_24h?(l(),f("i",{key:2,class:se(v.price_rate_24h>0?"up":v.price_rate_24h<0?"down":"up")},u(v.price_rate_24h>0?`+ ${v.fixD(v.price_rate_24h,2)}`:v.price_rate_24h<0?+`${v.fixD(v.price_rate_24h,2)}`:`+${v.fixD(v.price_rate_24h,2)}`)+"%",3)):F("",!0)])]),_:1})])]),o("div",Kt,[o("div",Vt,[o("div",xt,[R.coin&&v.address!=="0x2::sui::SUI"?(l(),f("span",es,u(R.coin&&R.coin.address.substr(0,13))+" ... "+u(R.coin&&R.coin.address.substr(R.coin.address.length-13,13)),1)):(l(),f("span",os,u(R.coin&&R.coin.address),1)),o("span",ns,u(R.coin&&R.coin.address.substr(0,4))+" ... "+u(R.coin&&R.coin.address.substr(R.coin.address.length-4,4)),1),(l(),f("svg",{class:"icon","aria-hidden":"true",onClick:h[0]||(h[0]=X=>v.store.copy(R.coin&&R.coin.address))},ss))])]),o("div",as,[o("div",{id:`main${(k=R.coin)==null?void 0:k.name}`,class:"main"},null,8,is)])])])])}const rs=Fe(Ft,[["render",ls],["__scopeId","data-v-9f8b1d01"]]);const us=Ke({components:{Modal:Fo},props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})}},setup(e){const h=Me(),R=io("Sui"),v=T(()=>h);T(()=>{var I,E;return(E=(I=v.value)==null?void 0:I.poolInfo)==null?void 0:E.needReverse});const W=b([]),q=b({});ne(()=>[e.suiPreSwapdata,e.fromCoin,e.toCoin],async([I,E,r])=>{if(I&&!Ae(I)){let x=[];I.splitPaths.sort((g,n)=>n.outputAmount-g.outputAmount);for(let g=0;g<I.splitPaths.length;g++){const n=I.splitPaths[g];console.log(n,"###splitPath");const t={...n,amountIn:new i(n.inputAmount).div(new i(Math.pow(10,E.decimals))).toString(),amountOut:new i(n.outputAmount).div(new i(Math.pow(10,r.decimals))).toString()};let w=[];for(let C=0;C<n.basePaths.length;C++){const P=n.basePaths[C];console.log(P,"###basePath");const O=P.fromCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":P.fromCoin,D=P.toCoin=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":P.toCoin,$=v.value.tokensObj[O]||(await R.getTokenListByCoinType([O]))[0],J=v.value.tokensObj[D]||(await R.getTokenListByCoinType([D]))[0];console.log($,J,"###coin_a coin_b"),(P==null?void 0:P.label)=="Deepbook"?w.push({...P,...v.value.routerPoolConfigObj[P.poolAddress],feeRate:new i(P.feeRate).div(new i(Math.pow(10,9))),coin_a:$,coin_b:J}):w.push({...P,...v.value.routerPoolConfigObj[P.poolAddress],feeRate:new i(P.feeRate).div(new i(Math.pow(10,6)))})}x.push({...t,basePaths:w})}W.value=x;const oe=[];let y=new i(0);x.forEach(g=>{const n=new i(g.percent).gt(0)?new i(g.percent).div(100).mul(100).toString():0,t=le(n,2);y=y.plus(t);const w=t.split(".");oe.push({value:t,int:w[0],decimal:w[1],pathIndex:g.pathIndex})});let G=new i(100).minus(y).toNumber();const U=oe.sort((g,n)=>Number(n.decimal)-Number(g.decimal));if(G)for(let g=0;g<U.length&&G;g++)U[g].value=new i(U[g].value).plus(.01).toString(),G=new i(G).minus(.01).toNumber();q.value=Object.fromEntries(U.map((g,n)=>[g.pathIndex,g])),console.log(U,"===>sortByDecimalPart"),console.log(x,"===>routerArr")}},{immediate:!0});const p=Le(),N=T(()=>p),k=I=>{var E;return console.log("获取logo"),console.log(v.value.tokensObj,"==>pools.value.tokensObj217"),(I==null?void 0:I.logoURI)||(I==null?void 0:I.logo_url)||((E=v.value.tokensObj[(I==null?void 0:I.address)=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":I==null?void 0:I.address])==null?void 0:E.logo_url)||(N.value.theme==="default"?fe("/image/coins/unknown.png"):fe("/image/coins/sui-unknown.png"))},X=async I=>{const E=(await R.getTokenListByCoinType([I]))[0];return console.log(E,"###tokenInfo"),E&&!Ae(E)?E==null?void 0:E.logo_url:""},K=T(()=>v.value.tokensObj),V=T(()=>N.value.currentExplorer);return{addCommom:H,routerStep:W,getCoinIcon:k,getDeepBookLogo:X,percentObj:q,tokensObj:K,store:N,getExplorerUrl:Ro,currentExplorer:V}}}),Se=e=>(Ee("data-v-02677be7"),e=e(),Ue(),e),cs=Se(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),ds={class:"route-top"},ms={class:"token-a"},vs={alt:""},ps={class:"token-num"},gs={class:"token-symbol"},fs={class:"token-b"},hs={class:"token-num"},Cs={class:"token-symbol"},ws={alt:""},bs={class:"route-bottom"},ks=Se(()=>o("div",{class:"left-round"},null,-1)),ys=Se(()=>o("div",{class:"right-round"},null,-1)),As={class:"percent-text"},Ss={class:"amount"},_s={class:"symbol"},$s={class:"percent-ratio"},Is={class:"percent-text"},Ps={class:"amount"},Rs={class:"symbol"},Ns={class:"pool-info-box"},Os={key:0,class:"icon","aria-hidden":"true"},Ts=Se(()=>o("use",{"xlink:href":"#icon-icon_on1"},null,-1)),Bs=[Ts],Ms={class:"pool-info"},Fs={class:"pool-info-top"},js={class:"token-a-img",alt:""},Es={class:"token-b-img",alt:""},Us={class:"source"},Ls=["src"],Ds={class:"pool-info-detail"},Ws={class:"pool-address"},qs=Se(()=>o("span",null,"Pool Address",-1)),Js=["href"],Qs=["onClick"],Xs=Se(()=>o("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Hs=[Xs],Ys={key:0,class:"token-info-detail"},Zs={alt:""},zs={class:"token-name"},Gs={class:"token-address"},Ks=["onClick"],Vs=Se(()=>o("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),xs=[Vs],ea={class:"token-symbol"},oa={class:"token-info-detail"},na={alt:""},ta={class:"token-name"},sa={class:"token-address"},aa=["onClick"],ia=Se(()=>o("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),la=[ia],ra={class:"token-symbol"};function ua(e,h,R,v,W,q){const p=jo("Modal"),N=je("image");return l(),Z(p,{title:"Route",width:"600px",visible:!0,footer:null,onCancel:h[0]||(h[0]=k=>e.$emit("onClose"))},{closeIcon:me(()=>[cs]),default:me(()=>{var k,X,K,V;return[o("div",ds,[o("div",ms,[ee(o("img",vs,null,512),[[N,(k=e.fromCoin)==null?void 0:k.logo_url]]),o("span",ps,u(("addCommom"in e?e.addCommom:z(H))(e.fromCoinAmount)),1),o("span",gs,u((X=e.fromCoin)==null?void 0:X.symbol),1)]),o("div",fs,[o("span",hs,u(("addCommom"in e?e.addCommom:z(H))(e.toCoinAmount)),1),o("span",Cs,u((K=e.toCoin)==null?void 0:K.symbol),1),ee(o("img",ws,null,512),[[N,(V=e.toCoin)==null?void 0:V.logo_url]])])]),o("div",bs,[ks,ys,(l(!0),f(Be,null,Io(e.routerStep,(I,E)=>(l(),f("div",{key:E,class:se(["route-path",E!==0?"route-path-active":""])},[o("div",{class:se(["percent",E!==0?"percent-active":""])},[o("div",As,[o("div",Ss,u(("addCommom"in e?e.addCommom:z(H))(I.amountIn)),1),o("div",_s,u(e.fromCoin.symbol),1),o("span",$s,"("+u(e.percentObj&&e.percentObj[I.pathIndex].value)+"%)",1)]),o("div",Is,[o("div",Ps,u(("addCommom"in e?e.addCommom:z(H))(I.amountOut)),1),o("div",Rs,u(e.toCoin.symbol),1)])],2),o("div",Ns,[I.basePaths&&I.basePaths.length>1?(l(),f("svg",Os,Bs)):F("",!0),(l(!0),f(Be,null,Io(I.basePaths,(r,x)=>{var oe,y,G,U,g,n,t,w,C,P,O,D,$,J,c,d,pe,Oe,De,We;return l(),f("div",{key:x},[o("div",Ms,[o("div",Fs,[ee(o("img",js,null,512),[[N,r.label=="Cetus"?e.getCoinIcon({address:r.fromCoin}):(oe=r==null?void 0:r.coin_a)==null?void 0:oe.logo_url]]),ee(o("img",Es,null,512),[[N,r.label=="Cetus"?e.getCoinIcon({address:r.toCoin}):(y=r==null?void 0:r.coin_b)==null?void 0:y.logo_url]]),o("span",null,u((r==null?void 0:r.feeRate)*100)+"%",1)]),o("div",Us,[o("img",{src:r.label=="Cetus"?"/sui-image/logo_cetus@2x.png":"/sui-image/logo_deepbook@2x.png",alt:""},null,8,Ls),o("span",null,u(r.label=="Cetus"?"Cetus":"DeepBook"),1)]),o("div",{class:se(["pool-info-detail-box",I.basePaths.length==1?"pool-info-detail-box-center":x==0?"pool-info-detail-box-left":"pool-info-detail-box-right"])},[o("div",Ds,[o("div",Ws,[qs,o("p",null,[o("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:z(Ro))(e.currentExplorer,"poolAddress",r==null?void 0:r.poolAddress),target:"_blank"},u(r&&((G=r==null?void 0:r.poolAddress)==null?void 0:G.substr(0,6)))+" ... "+u(r&&((U=r==null?void 0:r.poolAddress)==null?void 0:U.substr(r.poolAddress.length-6,6))),9,Js),(l(),f("svg",{class:"copy-icon","aria-hidden":"true",onClick:Re=>e.store.copy(r==null?void 0:r.poolAddress)},Hs,8,Qs))])]),r.coin_a&&r.coin_a?(l(),f("div",Ys,[ee(o("img",Zs,null,512),[[N,(g=r==null?void 0:r.coin_a)==null?void 0:g.logo_url]]),o("div",null,[o("div",null,[o("span",zs,u((n=r==null?void 0:r.coin_a)==null?void 0:n.symbol),1),o("p",Gs,[o("span",null,u((w=(t=r==null?void 0:r.coin_a)==null?void 0:t.address)==null?void 0:w.substr(0,4))+" ... "+u(r&&((O=(C=r==null?void 0:r.coin_a)==null?void 0:C.address)==null?void 0:O.substr(((P=r==null?void 0:r.coin_a)==null?void 0:P.address.length)-4,4))),1),(l(),f("svg",{class:"copy-icon","aria-hidden":"true",onClick:Re=>{var he;return e.store.copy((he=r==null?void 0:r.coin_a)==null?void 0:he.address)}},xs,8,Ks))])]),o("div",ea,u((D=r==null?void 0:r.coin_a)==null?void 0:D.name),1)])])):F("",!0),o("div",oa,[ee(o("img",na,null,512),[[N,($=r==null?void 0:r.coin_b)==null?void 0:$.logo_url]]),o("div",null,[o("div",null,[o("span",ta,u((J=r==null?void 0:r.coin_b)==null?void 0:J.symbol),1),o("p",sa,[o("span",null,u((d=(c=r==null?void 0:r.coin_b)==null?void 0:c.address)==null?void 0:d.substr(0,4))+" ... "+u(r&&((De=(pe=r==null?void 0:r.coin_b)==null?void 0:pe.address)==null?void 0:De.substr(((Oe=r==null?void 0:r.coin_b)==null?void 0:Oe.address.length)-4,4))),1),(l(),f("svg",{class:"copy-icon","aria-hidden":"true",onClick:Re=>{var he;return e.store.copy((he=r==null?void 0:r.coin_b)==null?void 0:he.address)}},la,8,aa))])]),o("div",ra,u((We=r==null?void 0:r.coin_b)==null?void 0:We.name),1)])])])],2)])])}),128))])],2))),128))])]}),_:1})}const ca=Fe(us,[["render",ua],["__scopeId","data-v-02677be7"]]),da=Ke({components:{Modal:Fo},props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,required:!0},toCoinAmount:{type:String,required:!0},slippage:{type:String,default:""},impact:{type:Number,required:!1},fixedFromCoin:{type:Boolean,default:!1},fee:{type:String,required:!1},formatFee:{type:String,default:""},isShowAccept:{type:Boolean,default:!1},swapLoading:{type:Boolean,required:!1},oneFromAmount:{type:String,default:""},oneToAmount:{type:String,default:""},suiPreSwapdata:{type:Object,default:()=>({})}},setup(e,h){const R=Me(),v=T(()=>R),W=Le(),q=T(()=>W),p=g=>{var n;return(g==null?void 0:g.logoURI)||(g==null?void 0:g.logo_url)||((n=v.value.tokensObj[g==null?void 0:g.address])==null?void 0:n.logo_url)||(q.value.theme==="default"?fe("/image/coins/unknown.png"):fe("/image/coins/sui-unknown.png"))},N=b(!1),k=T(()=>q.value.chainName),X=async()=>{h.emit("to-swap")};b([]);const K=b(0),V=b(""),I=b(""),E=T(()=>q.value.slippage);ne(()=>[e.fromCoinAmount,e.toCoinAmount,e.fromCoin,e.toCoin,e.fixedFromCoin,E.value],([g,n,t,w,C,P])=>{if(console.log(n,g,P,"===>"),g&&n&&t&&w&&P)if(C){const O=new i(n).mul(new i(P/100));I.value=new i(n).sub(O).toString()}else{const O=new i(g).mul(new i(P/100));V.value=new i(g).add(O).toString()}},{immediate:!0});const r=b(""),x=T(()=>{var g,n,t,w,C,P,O,D,$;return(t=(n=v==null?void 0:v.value)==null?void 0:n.tokensObj[(g=e.fromCoin)==null?void 0:g.address])!=null&&t.pyth_id&&((P=(C=v==null?void 0:v.value)==null?void 0:C.tokensObj[(w=e.fromCoin)==null?void 0:w.address])==null?void 0:P.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":($=(D=v==null?void 0:v.value)==null?void 0:D.tokensObj[(O=e.fromCoin)==null?void 0:O.address])!=null&&$.coingecko_id?"coingecko":null}),oe=T(()=>{var g,n,t,w,C,P,O,D,$;return(t=(n=v==null?void 0:v.value)==null?void 0:n.tokensObj[(g=e.toCoin)==null?void 0:g.address])!=null&&t.pyth_id&&((P=(C=v==null?void 0:v.value)==null?void 0:C.tokensObj[(w=e.toCoin)==null?void 0:w.address])==null?void 0:P.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":($=(D=v==null?void 0:v.value)==null?void 0:D.tokensObj[(O=e.toCoin)==null?void 0:O.address])!=null&&$.coingecko_id?"coingecko":null}),y=async()=>{console.log("##result400");const g=v.value.tokenExternalPriceObj[e.fromCoin.address],n=v.value.tokenExternalPriceObj[e.toCoin.address];if(g&&n){console.log("fromCoin价格:",g),console.log("toCoin价格",n),console.log("当前价格:",e.oneToAmount.replace(",",""));const t=new i(g).div(new i(n)),w=new i(e.oneToAmount.replace(new RegExp(/,/g),"")).sub(t).div(t).mul(100);console.log(x.value,oe.value,"##417");let C=Math.abs(le(w,2));t.toNumber()<Number(e.oneToAmount.replace(new RegExp(/,/g),""))?r.value="":(r.value=w>0&&w<=.01?"0.01":C,console.log(g,n,w.toString(),"##367"))}else r.value=""},G=g=>{if(g<5)return"color-s";if(g>=5&&g<10)return"color-w";if(g>=10)return"color-e"};ne(()=>[e.oneToAmount,v.value.tokenExternalPriceObj,k.value],([g,n,t])=>{g&&n&&!Ae(n)&&t!=="Aptos"&&(console.log(g,n,"##newVal"),y())},{immediate:!0,deep:!0});const U=b(!1);return console.log(e,"swapLoading===>"),{getCoinIcon:p,addCommom:H,sFixD:le,rateChange:N,chainName:k,clickNextBtn:X,pathLength:K,maximumSold:V,minimumReceived:I,decimalUi:ge,getTextColor:G,priceExangeRate:r,formCoinMarket:x,toCoinMarket:oe,readWithin:U}}}),ma=""+globalThis.__publicAssetsURL("sui-image/within-error.png");const ae=e=>(Ee("data-v-fcbd16c6"),e=e(),Ue(),e),va=ae(()=>o("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),pa={class:"new-swap-contnet"},ga={class:"coin-info"},fa={class:"from-coin-info"},ha={class:"left"},Ca={class:"coin-amount"},wa={class:"coin-symbol"},ba={class:"right"},ka={class:"to-coin-info"},ya={class:"left"},Aa={class:"coin-amount"},Sa={class:"coin-symbol"},_a={class:"right"},$a=ae(()=>o("div",{class:"to-swap-logo"},null,-1)),Ia={class:"coin-rate"},Pa={key:0,class:"coin-rate-box"},Ra={class:"left"},Na=ae(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Oa=ae(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Ta=[Na,Oa],Ba={key:1,class:"coin-rate-box"},Ma={class:"left"},Fa=ae(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ja=ae(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Ea=[Fa,ja],Ua={key:2,class:"within-tips-box"},La={class:"within-tips"},Da={key:0},Wa=["href"],qa=ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),Ja=[qa],Qa={key:1},Xa=["href"],Ha=ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),Ya=[Ha],Za={key:0},za=["href"],Ga=ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),Ka=[Ga],Va={key:1},xa=["href"],ei=ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),oi=[ei],ni={key:2},ti=["href"],si=ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),ai=[si],ii={key:3},li=["href"],ri=ae(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-link1"})],-1)),ui=[ri],ci={class:"bottom"},di={class:"induction"},mi={class:"item"},vi={class:"induction-text"},pi={class:"induction-value"},gi={class:"item"},fi={class:"induction-text"},hi={class:"induction-value"},Ci={class:"item"},wi={class:"induction-text"},bi={key:0,class:"icon","aria-hidden":"true"},ki=ae(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),yi=[ki],Ai={class:"item"},Si={class:"induction-text"},_i={key:0,class:"induction-value"},$i={key:1,class:"induction-value"},Ii={key:0,class:"within-desc"},Pi=ae(()=>o("div",{class:"within-top"},[o("img",{src:ma,alt:""}),o("span",null,"The exchange rate of this order deviates from the market price by a large percentage. Are you sure you want to continue the swap?")],-1)),Ri={class:"within-bottom"},Ni={key:0,class:"price-updated"},Oi=ae(()=>o("span",null,"Price updated",-1));function Ti(e,h,R,v,W,q){const p=Eo,N=jo("Modal"),k=je("image");return l(),Z(N,{width:"440px",visible:!0,footer:null,title:e.$t("button.swap"),class:"add-liquidity-modal",onCancel:h[7]||(h[7]=X=>e.$emit("on-close"))},{closeIcon:me(()=>[va]),default:me(()=>[o("div",pa,[o("div",ga,[o("div",fa,[o("div",ha,[o("div",Ca,u(e.fromCoinAmount&&("addCommom"in e?e.addCommom:z(H))(e.fromCoinAmount)),1),o("div",wa,u(e.fromCoin&&e.fromCoin.symbol),1)]),o("div",ba,[ee(o("img",null,null,512),[[k,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]])])]),o("div",ka,[o("div",ya,[o("div",Aa,u(e.toCoinAmount&&("addCommom"in e?e.addCommom:z(H))(e.toCoinAmount)),1),o("div",Sa,u(e.toCoin&&e.toCoin.symbol),1)]),o("div",_a,[ee(o("img",null,null,512),[[k,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]])]),$a]),o("div",Ia,[e.rateChange?(l(),f("div",Ba,[o("div",Ma,[ee(o("img",null,null,512),[[k,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]]),o("span",null,"1 "+u(e.toCoin&&e.toCoin.symbol)+" ≈",1),ee(o("img",null,null,512),[[k,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]]),o("span",null,u(e.oneFromAmount)+" "+u(e.fromCoin.symbol),1)]),o("div",{class:"right",onClick:h[1]||(h[1]=X=>e.rateChange=!e.rateChange)},Ea)])):(l(),f("div",Pa,[o("div",Ra,[ee(o("img",null,null,512),[[k,e.fromCoin&&e.fromCoin.logoURI||e.getCoinIcon(e.fromCoin)]]),o("span",null,"1 "+u(e.fromCoin&&e.fromCoin.symbol)+" ≈",1),ee(o("img",null,null,512),[[k,e.toCoin&&e.toCoin.logoURI||e.getCoinIcon(e.toCoin)]]),o("span",null,u(e.oneToAmount)+" "+u(e.toCoin.symbol),1)]),o("div",{class:"right",onClick:h[0]||(h[0]=X=>e.rateChange=!e.rateChange)},Ta)])),e.chainName=="Sui"&&e.priceExangeRate&&Number(e.priceExangeRate)>10?(l(),f("div",Ua,[o("div",La,[o("p",null,[o("span",{class:se(e.getTextColor(e.priceExangeRate))},"Within ~"+u(e.priceExangeRate)+"% of",3)]),e.formCoinMarket=="pyth"&&e.toCoinMarket=="pyth"?(l(),f("span",Da,[Q("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.fromCoin.pyth_id}&ids[]=${e.toCoin.pyth_id}`,target:"_blank"},Ja,8,Wa)])):e.formCoinMarket=="coingecko"&&e.toCoinMarket=="coingecko"?(l(),f("span",Qa,[Q("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.fromCoin.coingecko_id},${e.toCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},Ya,8,Xa)])):e.formCoinMarket!==e.toCoinMarket?(l(),f(Be,{key:2},[e.formCoinMarket=="pyth"?(l(),f("span",Za,[Q("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.fromCoin.pyth_id}`,target:"_blank"},Ka,8,za)])):e.formCoinMarket=="coingecko"?(l(),f("span",Va,[Q("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.fromCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},oi,8,xa)])):F("",!0),e.toCoinMarket=="coingecko"?(l(),f("span",ni,[Q("CoinGecko "),o("a",{href:`https://api.coingecko.com/api/v3/simple/price?ids=${e.toCoin.coingecko_id}&vs_currencies=usd`,target:"_blank"},ai,8,ti)])):e.toCoinMarket=="pyth"?(l(),f("span",ii,[Q("Pyth Network "),o("a",{href:`https://xc-mainnet.pyth.network/api/latest_price_feeds?ids[]=${e.toCoin.pyth_id}`,target:"_blank"},ui,8,li)])):F("",!0)],64)):F("",!0)])])):F("",!0)])]),o("div",ci,[o("div",di,[o("div",mi,[o("div",vi,u(e.$t("modal.slippageTolerance")),1),o("div",pi,u(e.slippage)+"%",1)]),o("div",gi,[o("div",fi,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),o("div",hi,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:z(H))(("sFixD"in e?e.sFixD:z(le))(e.minimumReceived,e.toCoin.decimals)):("addCommom"in e?e.addCommom:z(H))(("sFixD"in e?e.sFixD:z(le))(e.maximumSold,e.fromCoin.decimals)))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1)]),o("div",Ci,[o("div",wi,u(e.$t("common.priceImpact")),1),o("div",{class:se(["induction-value",e.impact<1?"impact-s":e.impact<10&&e.impact>=1?"impact-w":"impact-e"])},[Q(u(e.impact<.01?"<0.01":e.impact>100?"100":e.impact)+"% ",1),e.impact>=10?(l(),f("svg",bi,yi)):F("",!0)],2)]),o("div",Ai,[o("div",Si,u(e.$t("common.fee")),1),e.chainName=="Aptos"?(l(),f("div",_i,u(e.formatFee)+" "+u(e.fromCoin.symbol)+" ("+u(e.fee*100)+"%) ",1)):(l(),f("div",$i,u(e.fee)+" "+u(e.fromCoin.symbol),1))])])]),e.chainName=="Sui"&&e.priceExangeRate&&Number(e.priceExangeRate)>10?(l(),f("div",Ii,[Pi,o("div",Ri,[o("div",{class:se(["within-btn",e.readWithin?"within-btn-active":""]),onClick:h[2]||(h[2]=X=>e.readWithin=!0)},"Yes, please continue.",2),o("div",{class:"within-btn",onClick:h[3]||(h[3]=X=>e.$emit("on-close"))},"No, cancel it.")])])):F("",!0)]),e.isShowAccept?(l(),f("div",Ni,[Oi,ye(p,{class:"accept-btn",loading:e.swapLoading,onClick:h[4]||(h[4]=X=>e.$emit("accept"))},{default:me(()=>[Q("Accept")]),_:1},8,["loading"])])):e.chainName=="Sui"?(l(),Z(p,{key:1,class:"big-btn swap-confirm-btn",disabled:Number(e.priceExangeRate)>10&&!e.readWithin,onClick:h[5]||(h[5]=X=>e.clickNextBtn())},{default:me(()=>[Q(u(e.$t("button.confirmSwap")),1)]),_:1},8,["disabled"])):e.chainName=="Aptos"?(l(),Z(p,{key:2,class:"big-btn swap-confirm-btn",onClick:h[6]||(h[6]=X=>e.clickNextBtn())},{default:me(()=>[Q(u(e.$t("button.confirmSwap")),1)]),_:1})):F("",!0)]),_:1},8,["title"])}const Bi=Fe(da,[["render",Ti],["__scopeId","data-v-fcbd16c6"]]),Mi=Ke({setup(){const e=Po(),h=No(Oo,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0}),{t:R,locale:v}=gn(),W=Le(),q=Me(),p=T(()=>q);let N=b(!1),k=b(!1),X=b(!1),K=b(!1),V=b(!1),I=b(!1);const E=b("fromCoin"),r=b(""),x=b(""),oe=b(!1),y=b(!0),G=b(!1),U=b(!1),g=b(!1),n=b(""),t=b(""),w=b(20),C=b(0),P=b(null),O=b(!1),D=T(()=>W.slippage),$=T(()=>W.chainName),J=T(()=>$.value?io($.value):{}),c=b(),d=b(),pe=T(()=>be&&be[$.value]&&be[$.value].hasRouter),Oe=T(()=>q.getPoolInfoSuccess),De=T(()=>{var s;return B.value&&((s=B.value)!=null&&s.is_pause)?"Pool Closed":!c.value||!d.value?R("modal.selectTokenModalTitle"):!Number(n.value)&&!Number(t.value)?R("button.enterAmount"):!pe.value&&!B.value&&Oe.value?"Pool Not Found":pe.value&&$e.value?"No Available Route":(console.log(O.value,"===>insufficientLiquidity.value"),O.value?R("button.insufficientLiquidity"):Number(n.value)>Number(de.value)?R("button.insufficientBalance",{name:c.value.symbol}):R("button.swap"))}),We=s=>{var m,a,A,_;E.value=s,s==="fromCoin"?(r.value=((m=d.value)==null?void 0:m.address)||"",x.value=((a=c.value)==null?void 0:a.address)||""):(r.value=((A=c.value)==null?void 0:A.address)||"",x.value=((_=d.value)==null?void 0:_.address)||""),oe.value=!0},Re=b({}),he=b({}),Uo=s=>{E.value==="fromCoin"?(Re.value=s,oo(s)):(he.value=s,oo(s))},Lo=s=>{s==="fromCoin"?(y.value=!0,$.value==="Aptos"?n.value=de.value>0?c.value.symbol=="APT"?new i(Number(de.value)).sub(new i(.1)).lt(new i(0))?"0":new i(Number(de.value)).sub(new i(.1)).toString():String(de.value):"":n.value=de.value>0?c.value.symbol=="SUI"?new i(Number(de.value)).sub(new i(.05)).lt(new i(0))?"0":new i(Number(de.value)).sub(new i(.05)).toString():String(de.value):""):(y.value=!1,$.value==="Aptos"?t.value=ve.value>0?d.value.symbol=="APT"?new i(Number(ve.value)).sub(new i(.1)).lt(new i(0))?"0":new i(Number(ve.value)).sub(new i(.1)).toString():String(ve.value):"":t.value=ve.value>0?d.value.symbol=="SUI"?new i(Number(ve.value)).sub(new i(.05)).lt(new i(0))?"0":new i(Number(ve.value)).sub(new i(.05)).toString():String(ve.value):"")},Do=s=>{s==="fromCoin"?(y.value=!0,n.value=de.value>0?le(new i(Number(de.value)).div(2).toString(),c.value.decimals).toString():""):(y.value=!1,t.value=ve.value>0?le(new i(Number(ve.value)).div(2).toString(),d.value.decimals).toString():"")},Ve=b(!1);fn(()=>{lo(),window.addEventListener("updateSwapParams",s=>{Ve.value=!Ve.value})}),hn(()=>{clearInterval(P.value)});const xe=T(()=>W),eo=()=>{k.value||!B.value&&!pe.value||(clearInterval(P.value),q.setPoolConfigList(xe.value.chainName,xe.value.filterCoinsObj),C.value=0,k.value=!0,B.value&&q.updateCurrentPools(B.value.poolAddress,$.value),Ie(y.value?n.value:t.value),ce.value.address&&J.value.getAccount(ce.value.address),W.getStatsData($.value,xe.value.filterCoinsObj),setTimeout(()=>{k.value=!1,lo()},1e3))},lo=()=>{P.value=setInterval(()=>{k.value=!1,G.value||C.value<w.value&&(C.value+=1,C.value===w.value&&($.value=="Aptos"?(B.value&&B.value.poolAddress&&q.updateCurrentPools(B.value.poolAddress,$.value),eo()):I.value||eo(),C.value=0,k.value=!0))},1e3)};ne(y,ze((s,m)=>{y.value=s},500));const Ne=b(!1);ne(n,ze((s,m)=>{s&&s!==0&&y.value&&(C.value=0,Ie(s)),s==""&&y.value&&(t.value="")},800)),ne(t,ze((s,m)=>{s&&s!==0&&!y.value&&(C.value=0,Ie(s)),s==""&&!y.value&&(n.value="")},800));const qe=b(1e-4),Je=async s=>{let m=s;if(console.log(m,"poolInfo====>"),$.value==="Aptos"&&!m.current_sqrt_price&&n.value&&t.value){const a=await J.value.getPools([m.address]);a&&a[0]&&(m={...s,...a[0],fee:Number(a[0].fee_rate)/1e6})}if(m.current_sqrt_price&&n.value&&t.value){const A=(c.value.address===m.coinA.address&&d.value.address===m.coinB.address?0:1)==0,_=new i(n.value),S=new i(t.value),j=_.sub(_.mul(new i(m.fee)));console.log("getImpact###poolInfo.fee####",m.fee),console.log("getImpact###fAmount####",_.toString()),console.log("getImpact###tAmount####",S.toString()),console.log("getImpact###f####",j.toString());const Y=S.div(j);console.log("getImpact####rates####",Y.toString());const M=J.value.getPriceImpactPct(m,Y.toString(),A);return console.log(M,"t===>"),M}return"--"},ro=b(0),uo=b(0),co=b(),ue=b({}),Wo=async s=>{if(B.value&&(console.log(Number(n.value)==0,"===>Number(fromCoinAmount.value)==0"),!(y.value&&Number(n.value)==0)&&!(!y.value&&Number(t.value)==0)))if(c.value&&d.value&&(n.value||t.value)){U.value=!0,g.value=!0,O.value=!1;const m=c.value.address===B.value.coinA.address&&d.value.address===B.value.coinB.address?0:1;console.log(B.value,"poolInfo=====>451"),console.log(y.value?n.value:t.value,"fixedFromCoin.value ? fromCoinAmount.value : toCoinAmount.value"),console.log(m,"===>direct");try{let a=await J.value.preSwap({pool:B.value,a2b:m==0,byAmountIn:y.value,amount:y.value?n.value:t.value});console.log(a,"preSwapRespreSwapRes"),O.value=a==null?void 0:a.isExceed,co.value=a==null?void 0:a.estimatedFeeAmount,y.value?(t.value=a.estimatedAmountOut,we.value=(Number(a.estimatedAmountOut)/s).toString(),Ce.value=(s/Number(a.estimatedAmountOut)).toString()):(n.value=a.estimatedAmountIn,we.value=(s/Number(a.estimatedAmountIn)).toString(),Ce.value=(Number(a.estimatedAmountIn)/s).toString()),console.log(Ce.value,we.value,"===>831"),ro.value=new i(t.value).div(n.value).toString(),uo.value=new i(n.value).div(t.value).toString(),console.log("0524###getAmount###toAddLiquidiPoolInfo.value ###",ue.value),console.log("0524###getAmount###poolInfo.value ###",B.value),qe.value=$.value=="Aptos"?await Je(B.value):await Je(ue.value||B.value),U.value=!1,g.value=!1}catch(a){console.log("pre swap error1",a),U.value=!1,g.value=!1}}else y.value?t.value="":n.value="",U.value=!1,g.value=!1},qo=Cn(),ce=T(()=>qo),Jo=b({}),Ce=b(""),we=b(""),de=T(()=>ce.value.assets&&c.value&&ce.value.assets[c.value.address]?$o(ce.value.assets[c.value.address].balance,c.value.decimals):0),ve=T(()=>ce.value.assets&&d.value&&ce.value.assets[d.value.address]?$o(ce.value.assets[d.value.address].balance,d.value.decimals):0),Qo=Po();ne(()=>p.value.tokensObj,async s=>{if(!Ae(s)){console.log(s,"===>newValue626"),console.log(Qo,"===>route625");const m=e?e.currentRoute.value.query.to:"",a=e?e.currentRoute.value.query.from:"";a?c.value=await J.value.getTokenBySymbol(s,a):!a&&!c.value&&(c.value=await J.value.getTokenBySymbol(s,be[$.value].swapDefaultPair.fromCoin),console.log(c.value,"===>fromCoin.value")),m?d.value=await J.value.getTokenBySymbol(s,m):!m&&!d.value&&(d.value=await J.value.getTokenBySymbol(s,be[$.value].swapDefaultPair.toCoin)),!a&&m&&(c.value="",console.log("我清空了fromCoin"))}},{immediate:!0});const B=T(()=>{var s,m,a,A,_;if(c.value&&d.value){let S=null,j={};if(console.log(d.value.address,"===>toCoin.value.address930"),Object.values(p.value.poolConfigList).forEach(M=>{var L,te,ie,Pe;(M.coinA.address.toUpperCase()===((L=c.value.address)==null?void 0:L.toUpperCase())&&M.coinB.address.toUpperCase()===((te=d.value.address)==null?void 0:te.toUpperCase())||M.coinB.address.toUpperCase()===((ie=c.value.address)==null?void 0:ie.toUpperCase())&&M.coinA.address.toUpperCase()===((Pe=d.value.address)==null?void 0:Pe.toUpperCase()))&&(console.log(M,"p===>"),j[M.address]={...M})}),$.value=="Aptos"&&p.value.poolsObj&&!Ae(p.value.poolsObj))for(const M in p.value.poolsObj){const L=p.value.poolsObj[M];(L.token_a.address.toUpperCase()===((s=c.value.address)==null?void 0:s.toUpperCase())&&L.token_b.address.toUpperCase()===((m=d.value.address)==null?void 0:m.toUpperCase())||L.token_b.address.toUpperCase()===((a=c.value.address)==null?void 0:a.toUpperCase())&&L.token_a.address.toUpperCase()===((A=d.value.address)==null?void 0:A.toUpperCase()))&&(j[L.address]={...L})}console.log(j,"===>currentPoolsObj");const Y=Object.values(j).sort((M,L)=>M.fee-L.fee);console.log("0507####swap###poolInfo###poolSortList###",Y);for(let M=0;M<Y.length;M++)if(!((_=Y[M])!=null&&_.is_pause)){S=Y[M];break}return S=Object.values(j).sort((M,L)=>M.fee-L.fee)[0],console.log(j,"currentPoolsObj===>"),console.log("0507####swap###poolInfo###info###",S),S&&!Ae(S)?S:null}return null}),mo=b(!0),vo=b(!1),Xo=async s=>{s&&$.value=="Aptos"&&(Ie(y.value?n.value:t.value),vo.value=!0,s.coinA.symbol.toLowerCase()===c.value.symbol.toLowerCase()&&s.coinB.symbol.toLowerCase()===d.value.symbol.toLowerCase()?mo.value=!0:mo.value=!1,O.value=!1)};ne(()=>B.value,(s,m)=>{s&&(!m||s.address!==m.address||s.current_sqrt_price!==m.current_sqrt_price)&&Xo(s)},{immediate:!0,deep:!0});const Ho=T(()=>p.value.tokensObj&&c.value&&c.value.address&&p.value.tokensObj[c.value.address]&&p.value.tokensObj[c.value.address].logoURI),Yo=T(()=>(console.log(p.value.tokensObj,"===>pools.value.tokensObj"),p.value.tokensObj&&d.value&&d.value.address&&p.value.tokensObj[d.value.address]&&p.value.tokensObj[d.value.address].logoURI)),Zo=T(()=>$.value==="Aptos"?p.value.tokensObj&&c.value&&c.value.address&&p.value.tokensObj[c.value.address]&&p.value.tokensObj[c.value.address].coingecko_id||null:p.value.tokensObj&&c.value&&c.value.address||null),zo=T(()=>$.value==="Aptos"?p.value.tokensObj&&d.value&&d.value.address&&p.value.tokensObj[d.value.address]&&p.value.tokensObj[d.value.address].coingecko_id||null:p.value.tokensObj&&d.value&&d.value.address||null),Go=T(()=>{var s,m,a,A,_,S,j,Y,M;return(a=(m=p==null?void 0:p.value)==null?void 0:m.tokensObj[(s=c==null?void 0:c.value)==null?void 0:s.address])!=null&&a.pyth_id&&((S=(_=p==null?void 0:p.value)==null?void 0:_.tokensObj[(A=c==null?void 0:c.value)==null?void 0:A.address])==null?void 0:S.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(M=(Y=p==null?void 0:p.value)==null?void 0:Y.tokensObj[(j=c==null?void 0:c.value)==null?void 0:j.address])!=null&&M.coingecko_id?"coingecko":null}),Ko=T(()=>{var s,m,a,A,_,S,j,Y,M;return(a=(m=p==null?void 0:p.value)==null?void 0:m.tokensObj[(s=d==null?void 0:d.value)==null?void 0:s.address])!=null&&a.pyth_id&&((S=(_=p==null?void 0:p.value)==null?void 0:_.tokensObj[(A=d==null?void 0:d.value)==null?void 0:A.address])==null?void 0:S.pyth_id)!=="0x0000000000000000000000000000000000000000000000000000000000000000"?"pyth":(M=(Y=p==null?void 0:p.value)==null?void 0:Y.tokensObj[(j=d==null?void 0:d.value)==null?void 0:j.address])!=null&&M.coingecko_id?"coingecko":null}),Vo=T(()=>{var A,_,S;const s=new i(n.value);console.log(ue.value,"===>toAddLiquidiPoolInfo"),console.log((A=ue==null?void 0:ue.value)==null?void 0:A.fee,"toAddLiquidiPoolInfo?.value?.fee");const m=new i($.value=="Aptos"?(_=B==null?void 0:B.value)==null?void 0:_.fee:(S=ue==null?void 0:ue.value)==null?void 0:S.fee),a=s.mul(m).toString();return console.log(a,"===>fee"),Number(a)<1/Math.pow(10,c.value.decimals)?`<${new i(1).div(new i(Math.pow(10,c.value.decimals))).toString()}`:le(a,c.value.decimals)}),{setIsShowSuccess:xo,setIsShowRejected:po,setIsShowWaiting:Qe,setTransactionDesc:en,setTransactionTxid:go}=W,on=async()=>{var m,a,A,_,S,j,Y,M;I.value=!1,U.value=!0,clearInterval(Te),window.clearInterval(Te),go(""),en(R("tips.swapping",{from:`${H(n.value)} ${(m=c.value)==null?void 0:m.symbol}`,to:`${H(t.value)} ${(a=d.value)==null?void 0:a.symbol}`})),Qe(!0);let s;$.value=="Aptos"&&(s=c.value.address===B.value.token_a.address&&d.value.address===B.value.token_b.address?0:1);try{console.log("0221####swap start####",$.value,"###",J),console.log("0412###toSwap###poolInfo.value###",B.value);let L;$.value=="Aptos"?L=await J.value.getSwapTransactionPayload({pool:B.value,a2b:s==0,byAmountIn:y.value,amount:y.value?n.value:t.value,slippage:Number(D.value)/100}):(console.log(ue.value,"===>toAddLiquidiPoolInfo.value"),L=await Xe.value.swapRouterContract.getSwapRouterPayload(He.value,Number(D.value)/100)),console.log("0221####swap###swapPayload###",L);let te;if($.value==="Aptos")te=await ce.value.currentWallet.signAndSubmitTransaction(L);else{console.log("0221###swap###sui##signAndExecuteTransaction前###",$.value,"###swapPayload###",L);const ie=await ce.value.currentWallet.signAndExecuteTransactionBlock(L);console.log("0221###sui swap res###",ie),te=J.value.handleTx(ie),console.log("0221###swap###sui##tx###",te)}if(te&&te.hash){go(te.hash),Qe(!1),xo(!0);const ie={title:R("tips.swap"),desc:R("tips.swapSuccessText",{from:`${H(n.value)} ${(A=c.value)==null?void 0:A.symbol}`,to:`${H(t.value)} ${(_=d.value)==null?void 0:_.symbol}`}),hash:te.hash,tit:"Swap",type:"liquidity",action:"swap",isHaveSui:c.value.address==be[$.value].currentChainTokenAddress||d.value.address==be[$.value].currentChainTokenAddress,icon:"icon-icon-swap1",tokenInfo:{tokena:`${(S=c.value)==null?void 0:S.address}`,numa:`- ${n.value}`,logoa:p.value.tokensObj&&c.value&&c.value.address&&p.value.tokensObj[c.value.address]&&p.value.tokensObj[c.value.address].logoURI,tokenb:`${(j=d.value)==null?void 0:j.address}`,numb:`+ ${t.value}`,logob:p.value.tokensObj&&d.value&&d.value.address&&p.value.tokensObj[d.value.address]&&p.value.tokensObj[d.value.address].logoURI},text:`Pay ${n.value} ${(Y=c.value)==null?void 0:Y.symbol} to receive ${t.value} ${(M=d.value)==null?void 0:M.symbol}`};$.value!=="Aptos"&&(ie.res=te.res),J.value.showTransitionPending(ie);const Pe=await J.value.watchTransaction(ie);console.log("0221###swap###transitionStatus####",Pe),Pe&&setTimeout(()=>{$.value=="Aptos"&&q.updateCurrentPools(B.value.poolAddress,$.value),J.value.getAccount(ce.value.address)},1e3)}else Qe(!1),po(!0);n.value="",t.value="",U.value=!1}catch(L){n.value="",t.value="",console.log("Swap Error###",L),U.value=!1,Qe(!1),po(!0)}},nn=s=>{var m;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((m=p.value.tokensObj[s==null?void 0:s.address])==null?void 0:m.logo_url)||(W.theme==="default"?fe("/image/coins/unknown.png"):fe("/image/coins/sui-unknown.png"))},fo=b([]);ne(()=>[c.value,d.value,p.value.poolConfigList],([s,m,a])=>{if(a&&a.length>0&&s&&m){const A=[];a.forEach(_=>{var S,j,Y,M;(_.coinA.address.toUpperCase()===((S=s.address)==null?void 0:S.toUpperCase())&&_.coinB.address.toUpperCase()===((j=m.address)==null?void 0:j.toUpperCase())||_.coinB.address.toUpperCase()===((Y=s.address)==null?void 0:Y.toUpperCase())&&_.coinA.address.toUpperCase()===((M=m.address)==null?void 0:M.toUpperCase()))&&(_!=null&&_.is_pause||A.push(_.address))}),console.log(A,"result===>"),fo.value=A}},{immediate:!0});const oo=s=>{console.log(E.value,"===>currentCoinKey.value"),console.log(s);const m=localStorage.getItem(s.address);console.log(p.value.tokensObj,"===>pools.value.tokensObj"),console.log(m,"===>coinLocak"),p.value.tokensObj&&p.value.tokensObj[s.address]&&p.value.tokensObj[s.address].isSelfBuilt&&!m?no.value=!0:(E.value==="fromCoin"?(n.value="",d.value&&s.address.toLowerCase()===(d==null?void 0:d.value.address.toLowerCase())&&(d.value=null),c.value=s):(c.value&&(t.value="",s.address.toLowerCase()===(c==null?void 0:c.value.address.toLowerCase())&&(c.value=null)),d.value=s),ho())},no=b(!1),ho=()=>{he.value={},Re.value={},no.value=!1},tn=T(()=>W.isShowRouterModal),to=b([]),Co=b(""),sn=b(!1),wo=An(),Xe=T(()=>wo),$e=b(!1),He=b({}),bo=b(""),ko=s=>{console.log("0711###getSuiSwapFee###swapRouter###",s);const{splitPaths:m}=s;let a=new i(0);m.forEach((_,S)=>{const j=_.basePaths[0],Y=j.label==="Cetus"?new i(j.feeRate).div(Math.pow(10,6)):new i(j.feeRate).div(Math.pow(10,9)),M=new i(j.inputAmount).div(Math.pow(10,c.value.decimals)).mul(Y);if(a=a.add(M),console.log(a.toString(),"1431"),console.log(S,"@0711getSuiSwapFee#####","ele.basePaths[0]###",_.basePaths[0].currentPrice.toString()),_.basePaths[1]){const L=_.basePaths[1];console.log(S,"@0711getSuiSwapFee#####","ele.basePaths[1]###",_.basePaths[1].currentPrice.toString());const te=j.direction?j.currentPrice:new i(1).div(j.currentPrice),ie=L.direction?L.currentPrice:new i(1).div(_.basePaths[1].currentPrice),Pe=L.label==="Cetus"?new i(L.feeRate).div(Math.pow(10,6)):new i(L.feeRate).div(Math.pow(10,9)),ao=new i(L.outputAmount).div(Math.pow(10,d.value.decimals)).mul(Pe).div(te.mul(ie));console.log(S,"@0711getSuiSwapFee#####","price1###",te.toString()),console.log(S,"@0711getSuiSwapFee#####","price2###",ie.toString()),console.log(S,"@0711getSuiSwapFee#####","price1.mul(price2)###",te.mul(ie).toString()),console.log(S,"@0711getSuiSwapFee#####","new Decimal(1).div(price1.mul(price2))###",new i(1).div(te.mul(ie)).toString()),console.log(S,"@0711getSuiSwapFee#####","fee2###",ao.toString()),console.log(ao.toString(),144611),a=a.add(ao)}});const A=a.toNumber();console.log(A,"===>feeText"),bo.value=A>0&&A<1e-6?"<0.000001":H(le(A,c.value.decimals))},so=(s,m)=>m.minus(s).div(m).mul(100),yo=async s=>{console.log("0711###getSuiPriceImpact####swapRouter###",s);const{splitPaths:m}=s;let a=new i(0);m.forEach((A,_)=>{if(A.basePaths.length===1){const S=A.basePaths[0],j=new i(S.outputAmount).div(Math.pow(10,S.toDecimal)),Y=new i(S.inputAmount).div(Math.pow(10,S.fromDecimal)),M=j.div(Y),L=S.direction?new i(S.currentPrice):new i(1).div(S.currentPrice);console.log("getSuiPriceImpact###",_,"####outputAmount###",j.toString()),console.log("getSuiPriceImpact###",_,"####inputAmount###",Y.toString()),console.log("getSuiPriceImpact###",_,"####rate###",M.toString()),console.log("getSuiPriceImpact###",_,"####cprice###",L.toString()),console.log("getSuiPriceImpact###",_,"####path.currentPrice###",S.currentPrice.toString()),console.log("getSuiPriceImpact###",_,"####calculateSingleImpact(rate, cprice)###",so(M,L)),a=a.add(so(M,L)),console.log("getSuiPriceImpact###",_,"####impactValue###",a.toString())}else{console.log("####getSuiPriceImpact 多路径计算");const S=A.basePaths[0].direction?new i(A.basePaths[0].currentPrice):new i(1).div(A.basePaths[0].currentPrice),j=A.basePaths[1].direction?new i(A.basePaths[1].currentPrice):new i(1).div(A.basePaths[1].currentPrice),Y=S.mul(j),M=new i(A.basePaths[1].outputAmount).div(Math.pow(10,A.basePaths[1].toDecimal)),L=new i(A.basePaths[0].inputAmount).div(Math.pow(10,A.basePaths[0].fromDecimal)),te=M.div(L);a=a.add(so(te,Y)),console.log("getSuiPriceImpact###",_,"####cprice1###",S.toString()),console.log("getSuiPriceImpact###",_,"####ele.basePaths[0].currentPrice###",A.basePaths[0].currentPrice.toString()),console.log("getSuiPriceImpact###",_,"####cprice2###",j.toString()),console.log("getSuiPriceImpact###",_,"####ele.basePaths[1].currentPrice###",A.basePaths[1].currentPrice.toString()),console.log("getSuiPriceImpact###",_,"####cprice###",Y.toString()),console.log("getSuiPriceImpact###",_,"####rate###",te.toString()),console.log("getSuiPriceImpact###",_,"####impactValue###",a.toString())}}),console.log("0711###getSuiPriceImpact###impactValue.toNumber()####",a.toNumber()),qe.value=Number(le(a.toNumber(),2))},Ao=async s=>{if(c.value&&d.value&&(Number(n.value)>0||Number(t.value)>0)){console.log(new Date().getTime(),"开始计算时间戳"),console.log("执行吧"),(!n.value&&t.value||n.value&&!t.value)&&(U.value=!0),Ne.value=!0,$e.value=!1,console.log(B.value,"==>poolInfo.value.");let m;B.value&&(m=c.value.address===B.value.coinA.address&&d.value.address===B.value.coinB.address?0:1);try{let a;if(y.value){const j=new i(n.value).mul(Math.pow(10,c.value.decimals)).toString();a=new Ze(j)}else{const j=new i(t.value).mul(Math.pow(10,d.value.decimals)).toString();a=new Ze(j)}console.log(a.toString(),"====>1498");const A=Number(D.value)/100;console.log(Xe.value,"===>swapRouterContract.value");const _=B.value?{poolAddresses:fo.value,coinTypeA:B.value.coin_a_address,coinTypeB:B.value.coin_b_address,decimalsA:B.value.coinA.decimals,decimalsB:B.value.coinB.decimals,a2b:m==0,byAmountIn:y.value,amount:a.toString()}:"",S=await Xe.value.swapRouterContract.getSwapRouter(c,d,a,y.value,A,"",B.value?_:"");if(console.log(new Date().getTime(),"计算完成时间戳"),console.log(S,"===> swapRouter1454"),S&&!S.isExceed&&S.splitPaths&&S.splitPaths.length==0){$e.value=!0;return}if(S){if(He.value=S,to.value=S.paths,console.log("build"),O.value=S.isExceed,console.log(S.isExceed,O.value,"===>swapRouter.isExceed"),S.isExceed){U.value=!1,$e.value=!1,y.value?t.value="":n.value="";return}ko(S),y.value?n.value&&(t.value=new i(S.outputAmount).div(new i(Math.pow(10,d.value.decimals))).toString()):t.value&&(n.value=new i(S.inputAmount).div(new i(Math.pow(10,c.value.decimals))).toString()),console.log(t.value,"###toCoinAmount.value"),Ce.value=H(ge(new i(n.value).div(new i(t.value).toString()),c.value.decimals)),we.value=H(ge(new i(t.value).div(n.value).toString(),d.value.decimals)),yo(S),U.value=!1,$e.value=!1,Ne.value=!1}else U.value=!1,$e.value=!0,Ne.value=!1}catch(a){console.log("pre swap error2",a),U.value=!1,Ne.value=!1}}else y.value?t.value="":n.value="",U.value=!1,Ne.value=!1;console.log(U.value,"====>routerSwaping")},ke=b(!1),So=async s=>{console.log("3s执行一次");try{let m;if(y.value){const _=new i(n.value).mul(Math.pow(10,c.value.decimals)).toString();m=new Ze(_)}else{const _=new i(t.value).mul(Math.pow(10,d.value.decimals)).toString();m=new Ze(_)}const a=Number(D.value)/100,A=await Xe.value.swapRouterContract.getSwapRouter(c,d,m,y.value,a,"");A&&(He.value=A,to.value=A.paths,O.value=A.isExceed,console.log(A.isExceed,O.value,"===>swapRouter.isExceed"),Co.value=A.amountIn,ko(A),Ce.value=H(ge(new i(n.value).div(new i(t.value).toString()),c.value.decimals)),we.value=H(ge(new i(t.value).div(n.value).toString(),d.value.decimals)),yo(A),y.value?t.value!==A.amountOut&&(ke.value=!0,t.value=A.amountOut):n.value!==A.amountIn&&(ke.value=!0,n.value=A.amountIn))}catch(m){console.log("pre swap error3",m)}},an=async s=>{if(c.value&&d.value&&(n.value||t.value)){const m=c.value.address===B.value.coinA.address&&d.value.address===B.value.coinB.address?0:1;try{let a=await J.value.preSwap({pool:B.value,a2b:m==0,byAmountIn:y.value,amount:y.value?n.value:t.value});console.log(a,"preSwapRespreSwapRes"),O.value=a==null?void 0:a.isExceed,co.value=a==null?void 0:a.estimatedFeeAmount,y.value?(we.value=(Number(a.estimatedAmountOut)/a.estimatedAmountIn).toString(),Ce.value=(a.estimatedAmountIn/Number(a.estimatedAmountOut)).toString()):(we.value=(Number(a.estimatedAmountOut)/Number(a.estimatedAmountIn)).toString(),Ce.value=(Number(a.estimatedAmountIn)/Number(a.estimatedAmountOut)).toString()),y.value?t.value!==a.estimatedAmountOut&&(ke.value=!0,t.value=a.estimatedAmountOut):n.value!==a.estimatedAmountIn&&(ke.value=!0,n.value=a.estimatedAmountIn),console.log(Ce.value,we.value,"===>831"),console.log(ke.value,"==>isShowAccept.value"),qe.value=$.value=="Aptos"?await Je(B.value):await Je(ue.value||B.value),U.value=!1,g.value=!1}catch(a){console.log("pre swap error4",a),U.value=!1,g.value=!1}}else U.value=!1,g.value=!1};let Te=b(null);ne(()=>I.value,s=>{s?(console.log("我开启了"),Te.value=setInterval(()=>{$.value=="Aptos"?an(y.value):So(y.value)},3e3)):(console.log("我关闭了"),clearInterval(Te.value),window.clearInterval(Te.value))},{immediate:!0});const Ie=async s=>{$.value=="Aptos"?Wo(s):(console.log("调用sui"),Ao())};ne(()=>Ve.value,s=>{(Number(n.value)>0||Number(t.value)>0)&&Ie(y.value?n.value:t.value)},{immediate:!0});const ln=T(()=>wo),rn=T(()=>ln.value.isInitRouter);ne(()=>rn.value,s=>{s||(C.value=0,Ie(y.value?n.value:t.value))},{immediate:!0}),ne(()=>[c.value,d.value],([s,m])=>{if(s&&m&&(C.value=0,Ie(y.value?n.value:t.value)),s||m){const a=`/swap?from=${s==null?void 0:s.address}&to=${m==null?void 0:m.address}`;e.push(a)}},{immediate:!0});function un(s,m=500){let a=null;return function(...A){clearTimeout(a),a=setTimeout(()=>{s.call(this,...A)},m)}}const cn=un(_o);function _o(){console.log("====>调用了几次");const s=c.value;c.value=d.value,d.value=s,N.value=!0,y.value=!y.value,y.value?(n.value=t.value,t.value=""):(t.value=n.value,n.value=""),setTimeout(()=>{N.value=!1},300)}return{closeSwapConfirmModal:()=>{I.value=!1,ke.value=!1},updateAccept:()=>{ke.value=!1},clickExchange:_o,debounceClickExchange:cn,closeTokenWarning:ho,isShowTokenWarning:no,getTokenSource:oo,hasPool:vo,getPoolInfoSuccess:Oe,halfBtnSelect:Do,formCoinId:Zo,toCoinId:zo,formCoinMarket:Go,toCoinMarket:Ko,fromCoinUrl:Ho,toCoinUrl:Yo,t:R,indicator:h,wallet:ce,currentLpInfo:Jo,fixD:Ge,decimalFormat:vn,impact:qe,oneFromAmount:Ce,oneToAmount:we,importIcon:fe,clickRefresh:eo,refresh:k,change:N,isShowAddress:X,isShowSwapSetting:K,fromCoin:c,toCoin:d,slippage:D,openCoinSelect:We,onCoinSelect:Uo,existingCoins:r,lastSelectCoin:x,currentCoinKey:E,showCoinSelect:oe,fromCoinAmount:n,toCoinAmount:t,maxBtnSelect:Lo,fixedFromCoin:y,swapBtnText:De,toSwap:on,loading:G,swaping:U,autoRefreshTime:w,countdown:C,marketTimer:P,rateChange:V,isSwapConfirmMpdal:I,fromCoinBlance:de,toCoinBlance:ve,poolInfo:B,chainName:$,swapRouterLoading:Ne,formatFee:Vo,calculating:g,currentRate:ro,currentRateReverse:uo,getCoinIcon:nn,toAddLiquidiPoolInfo:ue,decimalUi:ge,warningToCoin:he,warningFromCoin:Re,isShowRouterModal:tn,toSwapLoading:sn,insufficientLiquidity:O,routerPool:to,routerTotalAmounts:Co,store:W,suiPreSwapdata:He,suiSwapFee:bo,addCommom:H,debounce:ze,notFoundRouter:$e,getSuiAmountAccept:So,isShowAccept:ke,getSuiAmount:Ao}}});const _e=e=>(Ee("data-v-56a52a5f"),e=e(),Ue(),e),Fi={class:"swap-container"},ji={class:"title"},Ei={class:"left"},Ui={class:"right title-right"},Li=_e(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Di={class:"swap-card"},Wi={class:"card-container"},qi=_e(()=>o("use",{"xlink:href":"#icon-icon-swap1"},null,-1)),Ji=[qi],Qi={key:1,class:"induction"},Xi={key:0,class:"exchange-rate-btn"},Hi={key:0},Yi={key:0},Zi={key:0},zi={key:1},Gi={key:0},Ki=_e(()=>o("div",null,[o("svg",{class:"icon icon-up","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Vi=_e(()=>o("div",null,[o("svg",{class:"icon icon-down","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),xi=[Ki,Vi],el={class:"item"},ol={class:"induction-text"},nl={key:0,class:"icon","aria-hidden":"true"},tl=_e(()=>o("use",{"xlink:href":"#icon-icon-warning1"},null,-1)),sl=[tl],al={class:"item"},il={class:"induction-text"},ll={key:0,class:"induction-value"},rl={class:"item"},ul={class:"induction-text"},cl={key:0,class:"induction-value"},dl={key:0,class:"icon","aria-hidden":"true"},ml=_e(()=>o("use",{"xlink:href":"#icon-icon-swap"},null,-1)),vl=[ml],pl={key:2,class:"token-info-container"},gl={class:"token-info-title"},fl=_e(()=>o("span",{class:"coingecko"},"Price Reference",-1)),hl=_e(()=>o("svg",{class:"icon","aria-hidden":"true"},[o("use",{"xlink:href":"#icon-icon-information"})],-1));function Cl(e,h,R,v,W,q){var n,t;const p=dn,N=mn,k=Mt,X=To,K=Bo,V=Eo,I=wn,E=bn,r=kn,x=Mo,oe=rs,y=yn,G=ca,U=Bi,g=je("image");return l(),f("div",Fi,[o("div",ji,[o("div",Ei,u(e.$t("menu.swap")),1),o("div",Ui,[o("div",{class:"slippage-icon",onClick:h[0]||(h[0]=w=>e.isShowSwapSetting=!0)},[Li,o("span",null,u(e.slippage)+"%",1)]),ye(p,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:e.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])]),o("div",Di,[o("div",Wi,[o("div",{class:se(["card-item",!e.fixedFromCoin&&(e.swapRouterLoading||e.swapLoading)?"card-item-mask":""])},[ye(N,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":h[1]||(h[1]=w=>e.fromCoinAmount=w),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logo_url:"",address:e.fromCoin?e.fromCoin.address:"","swap-direction":"From",onOnMax:h[2]||(h[2]=w=>e.maxBtnSelect("fromCoin")),onOnHalf:h[3]||(h[3]=w=>e.halfBtnSelect("fromCoin")),onOnInput:h[4]||(h[4]=w=>{e.fromCoinAmount=w,e.fixedFromCoin=!0}),onOnSelect:h[5]||(h[5]=w=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])],2),o("div",{class:se(["card-item",e.fixedFromCoin&&(e.swapRouterLoading||e.swapLoading)?"card-item-mask":""])},[ye(N,{modelValue:e.toCoinAmount,"onUpdate:modelValue":h[6]||(h[6]=w=>e.toCoinAmount=w),"input-value":e.toCoinAmount,havemax:!1,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direction":"To","coin-icon":e.toCoin?e.toCoin.logo_url:"",address:e.toCoin?e.toCoin.address:"",havehalf:!1,onOnInput:h[7]||(h[7]=w=>{e.toCoinAmount=w,e.fixedFromCoin=!1}),onOnSelect:h[8]||(h[8]=w=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"])],2),o("img",{class:se(e.change?"gang animationex":"gang"),src:Sn,alt:""},null,2),o("div",{class:se(["exchange",e.chainName=="Sui"?"sui-exchange":""]),onClick:h[9]||(h[9]=(...w)=>e.debounceClickExchange&&e.debounceClickExchange(...w))},[(l(),f("svg",{class:se(e.change?"icon animationex":"icon"),"aria-hidden":"true"},Ji,2))],2)]),e.chainName=="Sui"&&!e.notFoundRouter?(l(),Z(k,{key:0,"swap-loading":e.swaping,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"router-pool":e.routerPool,impact:e.impact,"insufficient-liquidity":e.insufficientLiquidity,"one-to-amount":e.oneToAmount,"one-from-amount":e.oneFromAmount,"sui-pre-swapdata":e.suiPreSwapdata,"sui-swap-fee":e.suiSwapFee,"swap-router-loading":e.swapRouterLoading},null,8,["swap-loading","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","router-pool","impact","insufficient-liquidity","one-to-amount","one-from-amount","sui-pre-swapdata","sui-swap-fee","swap-router-loading"])):e.poolInfo&&e.fromCoinAmount&&e.toCoinAmount&&e.fromCoinAmount!=="0"&&e.toCoinAmount!=="0"&&e.swapBtnText!==e.$t("button.poolNotFound")?(l(),f("div",Qi,[Number(e.fromCoinAmount)>0&&Number(e.toCoinAmount)>0?(l(),f("div",Xi,[e.rateChange?Number(e.fromCoinAmount)&&Number(e.toCoinAmount)&&e.rateChange?(l(),f("span",zi,[Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(l(),f("span",Gi,[ee(o("img",null,null,512),[[g,e.toCoinUrl||e.getCoinIcon(e.toCoin)]]),Q(" 1 "+u(e.toCoin.symbol)+" ≈ ",1),ee(o("img",null,null,512),[[g,e.fromCoinUrl||e.getCoinIcon(e.fromCoin)]]),o("span",null,u(("addCommom"in e?e.addCommom:z(H))(("decimalUi"in e?e.decimalUi:z(ge))(e.currentRateReverse,e.fromCoin.decimals),e.fromCoin.decimals)),1),Q("  "+u(e.fromCoin.symbol),1)])):(l(),Z(X,{key:1,indicator:e.indicator},null,8,["indicator"]))])):F("",!0):(l(),f("span",Hi,[ee(o("img",null,null,512),[[g,e.fromCoinUrl||e.getCoinIcon(e.fromCoin)]]),Q(" 1 "+u(e.fromCoin.symbol)+" ≈ ",1),Number(e.fromCoinAmount)&&Number(e.toCoinAmount)?(l(),f("span",Yi,[ee(o("img",null,null,512),[[g,e.toCoinUrl||e.getCoinIcon(e.toCoin)]]),e.calculating?F("",!0):(l(),f("span",Zi,u(("addCommom"in e?e.addCommom:z(H))(("decimalUi"in e?e.decimalUi:z(ge))(e.currentRate,e.toCoin.decimals))),1)),e.calculating?(l(),Z(X,{key:1,indicator:e.indicator},null,8,["indicator"])):F("",!0),Q("  "+u(e.toCoin.symbol),1)])):(l(),Z(X,{key:1,indicator:e.indicator},null,8,["indicator"]))])),o("div",{class:"icon-change",onClick:h[10]||(h[10]=w=>e.rateChange=!e.rateChange)},xi)])):F("",!0),Number(e.fromCoinAmount)>0&&Number(e.toCoinAmount)>0?(l(),f(Be,{key:1},[o("div",el,[o("div",ol,u(e.$t("common.priceImpact")),1),e.swaping?(l(),Z(K,{key:1,paragraph:!1,active:""})):(l(),f("div",{key:0,class:se(["induction-value",Number(e.impact)<1?"impact-s":Number(e.impact)<10&&Number(e.impact)>1?"impact-w":"impact-e"])},[Q(u(Number(e.impact)<.01?"<0.01":Number(e.impact)>100?"100":e.impact)+"% ",1),e.impact>=10?(l(),f("svg",nl,sl)):F("",!0)],2))]),o("div",al,[o("div",il,u(e.fixedFromCoin?e.$t("common.minimumReceived"):e.$t("common.maximumSold")),1),e.swaping?(l(),Z(K,{key:1,paragraph:!1,active:""})):(l(),f("div",ll,u(e.fixedFromCoin?("addCommom"in e?e.addCommom:z(H))(("fixD"in e?e.fixD:z(Ge))(Number(e.toCoinAmount)-Number(e.toCoinAmount)*Number(e.slippage)/100,e.toCoin.decimals),e.toCoin.decimals):("addCommom"in e?e.addCommom:z(H))(("fixD"in e?e.fixD:z(Ge))(Number(e.fromCoinAmount)*Number(e.slippage)/100+Number(e.fromCoinAmount),e.fromCoin.decimals),e.fromCoin.decimals))+" "+u(e.fixedFromCoin?e.toCoin.symbol:e.fromCoin.symbol),1))]),o("div",rl,[o("div",ul,u(e.$t("common.fee")),1),e.swaping?(l(),Z(K,{key:1,paragraph:!1,active:""})):(l(),f("div",cl,u(("addCommom"in e?e.addCommom:z(H))(e.formatFee,e.fromCoin.decimals))+" "+u(e.fromCoin.symbol)+" ("+u(e.chainName=="Aptos"?e.poolInfo.fee*100:((n=e.toAddLiquidiPoolInfo)==null?void 0:n.fee)*100)+"%) ",1))])],64)):F("",!0)])):F("",!0)]),ye(V,{disabled:e.wallet.connected?e.swaping||!e.fromCoin||!e.toCoin||!Number(e.fromCoinAmount)||!Number(e.toCoinAmount)||Number(e.fromCoinAmount)>Number(e.fromCoinBlance)||e.swapBtnText==e.$t("button.poolNotFound")||e.swapBtnText!==e.$t("button.swap")||((t=e.poolInfo)==null?void 0:t.is_pause)||e.swapRouterLoading:!1,class:"big-btn",loading:e.chainName=="Aptos"?e.swaping:!1,onClick:h[11]||(h[11]=w=>e.wallet.connected?e.isSwapConfirmMpdal=!0:e.wallet.setIsShowWalletModal(!0))},{default:me(()=>[e.wallet.connected?(l(),f("svg",dl,vl)):F("",!0),o("span",null,u(e.wallet.connected?e.swapBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled","loading"]),ye(I),e.showCoinSelect?(l(),Z(E,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:h[12]||(h[12]=w=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):F("",!0),e.isShowSwapSetting?(l(),Z(r,{key:1,onOnClose:h[13]||(h[13]=w=>e.isShowSwapSetting=!1)})):F("",!0),e.chainName&&(e.formCoinMarket||e.toCoinMarket)?(l(),f("div",pl,[o("div",gl,[fl,ye(x,{placement:"top","arrow-point-at-center":""},{title:me(()=>[Q(" The following price is only an external reference from 3rd party data providers, which does not reflect actual data on Cetus. ")]),default:me(()=>[hl]),_:1})]),e.fromCoin&&e.formCoinMarket?(l(),Z(oe,{key:0,id:e.formCoinId,coin:e.fromCoin,market:e.formCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):F("",!0),e.toCoin&&e.toCoinMarket?(l(),Z(oe,{key:1,id:e.toCoinId,coin:e.toCoin,market:e.toCoinMarket,refresh:e.refresh},null,8,["id","coin","market","refresh"])):F("",!0)])):F("",!0),e.chainName=="Sui"&&e.isShowTokenWarning?(l(),Z(y,{key:3,"from-coin":e.warningFromCoin,"to-coin":e.warningToCoin,onClose:e.closeTokenWarning,onClickContinue:e.getTokenSource},null,8,["from-coin","to-coin","onClose","onClickContinue"])):F("",!0),e.isShowRouterModal?(l(),Z(G,{key:4,"sui-pre-swapdata":e.suiPreSwapdata,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,onOnClose:h[14]||(h[14]=w=>e.store.setIsShowRouterModal(!1))},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount"])):F("",!0),e.isSwapConfirmMpdal?(l(),Z(U,{key:5,"sui-pre-swapdata":e.suiPreSwapdata,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,slippage:e.slippage,impact:e.impact,"fixed-from-coin":e.fixedFromCoin,fee:e.chainName=="Sui"?e.suiSwapFee:e.poolInfo.fee,"format-fee":e.chainName=="Sui"?e.suiSwapFee:e.formatFee,"is-show-accept":e.isShowAccept,"swap-loading":e.swapRouterLoading,"one-from-amount":e.oneFromAmount,"one-to-amount":e.oneToAmount,onOnClose:e.closeSwapConfirmModal,onToSwap:e.toSwap,onAccept:e.updateAccept},null,8,["sui-pre-swapdata","from-coin","to-coin","from-coin-amount","to-coin-amount","slippage","impact","fixed-from-coin","fee","format-fee","is-show-accept","swap-loading","one-from-amount","one-to-amount","onOnClose","onToSwap","onAccept"])):F("",!0)])}const Hl=Fe(Mi,[["render",Cl],["__scopeId","data-v-56a52a5f"]]);export{Hl as default};
