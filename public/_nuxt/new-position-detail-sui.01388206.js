import{a as Me,r as L,s as eo,m as y,A as ce,b as ct,e as ze,o as c,f as k,h as t,i as X,y as ht,p as et,k as tt,q as Ht,I as le,M as Vt,C as _t,u as F,x as v,j as K,w as me,P as Xt,N as Ut,G as re,F as rt,E as ut,B as ot,c as fe,$ as to,z as Gt,a7 as oo,L as no,a8 as io,D as zt,Y as so,O as ao}from"./entry.f915a1e9.js";/* empty css              */import{u as Jt}from"./useCurrentPosition.15f6eaa8.js";import{u as dt}from"./pool.4c0bddd9.js";import{u as lo}from"./token.61adec89.js";import{u as vt,h as ro,b as Ce,C as Yt,T as jt,e as uo,f as co}from"./index.bdee7b42.js";import{c as he,g as vo,n as mo,d as ie,o as Dt,a as Y,b as Te,h as xe,p as Ze,i as ft}from"./common.26bee659.js";import{a as gt,u as De,b as nt,c as fo}from"./index.4a60ce8c.js";import{u as ho}from"./usePoolList.6aedb9ec.js";import{_ as _o}from"./back.42a1ef77.js";import{_ as po,l as go,a as bo,b as wo,c as ko}from"./icon-arrow_2x.cc61362d.js";import{_ as bt}from"./token-warning.3e9a238d.js";import{_ as Qt}from"./status-block.6579039d.js";/* empty css              */import{s as lt,m as yo,l as Po,b as Ao,a as $o}from"./transform.c672907f.js";import"./decimal.a2826370.js";import{D as M}from"./decimal.765d8738.js";import{s as pt}from"./formatter.bbce4c5f.js";import{_ as wt}from"./assets-card.b00a8c39.js";import{_ as Io}from"./coin-lock.8c260593.js";import{_ as So}from"./icon-Add-Liquidity_2x.5b1f94db.js";import{u as Co}from"./useRate.9967fd96.js";import{_ as xo}from"./deposit-ratio.3f36d070.js";/* empty css              */import{u as Kt}from"./notifi.b634b730.js";/* empty css              */import{i as Zt}from"./import-icon.de3e6c66.js";import{_ as To}from"./apr-tips.746b6204.js";import{u as No}from"./farms.d72e934b.js";import"./usePositionList.76380144.js";import"./useSDK.e92294a6.js";import"./useToken.28679674.js";import"./fetchFun.ff4aae28.js";import"./swap-setting.4f36659c.js";/* empty css              */import"./icon-error_2x.157486c5.js";import"./index.cce2acd5.js";import"./useDebounceFunction.ab8b3dbd.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.5c879086.js";import"./useWhale.0504516d.js";import"./icon_fee_2x.723b41fa.js";import"./icon_rewards_2x.1d466672.js";const Bo=Me({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,u){const o=L(!1),r=L(null),B=L(0),l=L(20),b=gt(),N=De(),a=L(!1);eo(()=>{clearInterval(r.value)});const i=()=>{r.value=setInterval(()=>{var x;a.value||B.value<l.value&&(B.value+=1,B.value===l.value&&((x=e==null?void 0:e.poolInfo)!=null&&x.poolAddress&&b.updateCurrentPools(e.poolInfo.poolAddress,N.chainName),B.value=0))},1e3)},_=y(()=>N.slippage),m=()=>{u.emit("clearAll")},p=L(!1),I=()=>{B.value=0,p.value=!0,u.emit("clickRefresh"),setTimeout(()=>{p.value=!1},1e3)};ce(()=>e.poolInfo,x=>{x&&!r.value&&i()},{immediate:!0});const G=ct(),Q=y(()=>N.chainName);return{clickRefresh:I,isShowSwapSetting:o,countdown:B,autoRefreshTime:l,slippage:_,clearAll:m,checkNullObj:he,router:G,loading:a,chainName:Q,refresh:p}}});const qo=e=>(et("data-v-39b7f750"),e=e(),tt(),e),Ro={class:"new-position-title"},Oo={class:"left"},Lo={class:"right"},Mo=qo(()=>t("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Fo=[Mo];function Uo(e,u,o,r,B,l){const b=_o,N=po;return c(),k("div",Ro,[t("div",Oo,[X(b)]),t("div",Lo,[X(N),(c(),k("svg",{"aria-hidden":"true",class:ht(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:u[0]||(u[0]=(...a)=>e.clickRefresh&&e.clickRefresh(...a))},Fo,2))])])}const jo=ze(Bo,[["render",Uo],["__scopeId","data-v-39b7f750"]]);function Et(e,u,o){const r=new M(10).pow(u-o);return new M(1.0001).pow(e).mul(r)}const Do=Me({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,coinA:{decimal:6},coinB:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,u){const o=L(1),r=L(""),B=L(""),l=y(()=>{var s,$,w;return m.sqrtPriceX64ToPrice((s=e.poolInfo)==null?void 0:s.current_sqrt_price,($=e.poolInfo)==null?void 0:$.coinA.decimals,(w=e.poolInfo)==null?void 0:w.coinB.decimals).toString()}),b=y(()=>{let s=0;return e.direction?s=(Number(e.minPrice)/Number(l.value)-1)*100:s=(Number(e.minPrice)/Number(1/Number(l.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),N=y(()=>{let s=0;return e.direction?s=(Number(e.maxPrice)/Number(l.value)-1)*100:s=(Number(e.maxPrice)/Number(1/Number(l.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),a=De(),i=y(()=>a),_=y(()=>i.value.chainName?nt(i.value.chainName):{}),{TickMath:m,getNearestTickByTick:p}=_.value,I=()=>{const s=o.value/2;o.value=s,x(e.poolInfo,s)},G=()=>{const s=o.value*2;o.value=s,x(e.poolInfo,s)},Q=(s=[])=>{let $=6;const w=Math.abs(Number(s[0])-Number(s[s.length-1]));return w>=6?$=0:w>=1?$=1:w>=.1?$=2:w>=.01?$=3:w>=.001?$=4:w>=1e-4?$=5:w>=1e-5?$=6:w>=1e-6?$=7:w>=1e-7&&($=8),$},x=(s,$=1)=>{if(s&&s.coinA&&!e.chartLoading&&e.minPrice&&e.maxPrice){const w=Number(e.poolInfo.current_tick_index);let U=w+100*$,n=w-100*$,A,d;if(e.maxPrice==="âˆž")d=_.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?d=m.priceToTickIndex(new M(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):d=m.priceToTickIndex(new M(1).div(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{d=443636}if(e.minPrice==="0")A=_.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?A=m.priceToTickIndex(new M(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):A=m.priceToTickIndex(new M(1).div(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{A=-443636}let E=0;if(e.currentPriceTab!=="full range"){if(w>=A&&w<=d){const R=w-A,de=d-w;E=Math.max(Math.abs(R),Math.abs(de))}else w<A?E=Math.abs(d-w):E=Math.abs(w-A);U=w+E+20*$,n=w-E-20*$}else{const R=(Math.abs(w)>5e3,2e4);U=w+R*$,n=w-R*$}n<-443636&&(n=-443636),U>443636&&(U=443636);const C=new M(s.poolLiquidity).div(Math.pow(10,8)).toString(),h=e.tickList,f=[],T=[];let j={};for(let R=0;R<h.length;R++){if(j=h[R],j.index<=w&&j.index>=n){if(f.length<1&&R!==0){const de=h[R-1];f.unshift({...de,index:n})}f.unshift(j)}else if(j.index>w&&j.index<=U&&(T.push(j),f.length<1&&R!==0)){const de=h[R-1];f.push({...de,index:n})}if(j.index>U){const de=h[R];if(T.push({...de,index:U}),f.length<1&&R!==0){const ue=h[R-1];f.push({...ue,index:n})}break}}let Z="0";for(let R=f.length-1;R>=0;R--)Z=new M(Z).plus(new M(f[R].liquidityNet.toString()).div(Math.pow(10,8))).toString(),f[R].liquityAmount=Z;let W=C;for(let R=0;R<T.length;R++)W=new M(W).plus(new M(T[R].liquidityNet.toString()).div(Math.pow(10,8))).toString(),T[R].liquityAmount=W;let z=[];const V=h&&h.length>0?{index:w,liquityAmount:Number(C)}:{index:w,liquityAmount:0};(f.length>0||T.length>0)&&(z=[...f.reverse(),V,...T],e.direction||(z=z.reverse()));const te=[];h.forEach(R=>{te.push({...R,liquidityGross:R.liquidityGross.toString(),liquidityNet:R.liquidityNet.toString()})}),S(z,n,U,A,d,w)}};let P=L(!0);Ht(()=>{document.body.clientWidth<750?P.value=!1:P.value=!0,window.onresize=()=>{document.body.clientWidth<750?P.value=!1:P.value=!0,x(e.poolInfo,o.value)}});const S=(s,$,w,U,n,A)=>{let d,E;e.direction?(d=e.before7dContractPriceLowest?m.priceToTickIndex(new M(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",E=e.before7dContractPriceHighest?m.priceToTickIndex(new M(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):""):(d=e.before7dContractPriceLowest?m.priceToTickIndex(new M(1).div(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",E=e.before7dContractPriceHighest?m.priceToTickIndex(new M(1).div(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"");const C={top:30,right:35,bottom:20,left:55};let h,f;P.value,h=340-C.left-C.right,f=205-C.top-C.bottom;const T=w-$,j=parseInt(String(T/4));let Z=[$+j/4,$+j,$+2*j,w-j,w-j/4];const W=$,z=w,V=h/(z-W);e.currentPriceTab==="full range"&&(Z=[$,$+2*j,w]);const te=Z.map(O=>e.direction?Et(O,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString():new M(1).div(Et(O,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)).toString());Q(te),lt("#chart").selectAll("*").remove();const R=lt("#chart").attr("width",h+C.left+C.right).attr("height",f+C.top+C.bottom).append("g").attr("transform",`translate(${C.left},${C.right})`),de=yo(s,function(O){return Number(Math.abs(O.liquityAmount))})||0,ue=Po().range([0,f]).domain([de,0]);Ao().rangeRound([0,h]).padding(.1);const Ae=R.append("g").attr("id","barsBox").selectAll("rect").data(s).enter().append("rect");i.value.theme=="default"?Ae.attr("x",function(O,D){return D===0?0:e.direction?Math.abs(O.index-W)*V:Math.abs(z-O.index)*V}).attr("y",function(O,D){return e.direction?D===s.length-1?0:ue(O.liquityAmount):D===s.length-1?0:ue(s[D+1].liquityAmount)}).attr("width",function(O,D){return D===0&&s.length===1&&O.liquityAmount>0?h:(e.direction,D!==s.length-1?Math.abs(s[D+1].index-O.index)*V:0)}).attr("height",function(O,D){return D===0&&s.length===1&&O.liquityAmount>0?f:e.direction?D===s.length-1?0:f-ue(O.liquityAmount):D===s.length-1?0:f-ue(s[D+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Ae.attr("x",function(O,D){return D===0?0:e.direction?Math.abs(O.index-W)*V:Math.abs(z-O.index)*V}).attr("y",function(O,D){return e.direction?D===s.length-1?0:ue(Math.abs(O.liquityAmount)):D===s.length-1?0:ue(Math.abs(s[D+1].liquityAmount))}).attr("width",function(O,D){return D===0&&s.length===1&&O.liquityAmount>0?h:(e.direction,D!==s.length-1?Math.abs(s[D+1].index-O.index)*V:0)}).attr("height",function(O,D){if(D===0&&s.length===1&&O.liquityAmount>0)return f;if(e.direction)return D===s.length-1?0:Number(O.liquityAmount)?f-ue(Math.abs(O.liquityAmount)):0;{if(D===s.length-1)return 0;const Be=f-ue(Math.abs(s[D+1].liquityAmount));return Number(s[D+1].liquityAmount)?Be:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const be=R.append("g");be.append("line").attr("x1",0).attr("y1",155).attr("x2",h).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),be.append("g");let ye=0;e.direction?ye=Math.abs(A-W)*V:ye=Math.abs(A-z)*V,(i.value.theme=="default"?R.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):R.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+ye+", 0)"),lt("#triangle").attr("width",8).attr("height",4);let We=[[0,0],[4,4],[8,0]],Ue=go().x(function(O){return O[0]}).y(function(O){return O[1]}).curve(bo);const oe=ye-4;R.append("path").attr("d",Ue(We)).style("fill",i.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+oe+", 0)");let $e,we,Ie,je;e.direction?($e=U<W?-100:parseInt(String(Math.abs(U-W)*V)),we=n<W?-100:parseInt(String(Math.abs(n-W)*V)),Ie=d<W?-100:Math.abs(d-W)*V,je=E<W?-100:Math.abs(E-W)*V):(we=U<W?-100:Math.abs(z-U)*V,$e=n<W?-100:Math.abs(z-n)*V,je=d<W?-100:Math.abs(z-d)*V,Ie=E<W?-100:Math.abs(z-E)*V),e.minPrice==="0"&&($e=0),e.maxPrice==="âˆž"&&(we=h),P.value?r.value=h-$e+60+"px":r.value=h-$e+52+"px",B.value=we+74+"px",d&&Ie<h&&R.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ie+", 0)"),E&&je<h&&R.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+je+", 0)");const He=$o().extent([[0,0],[h,f]]).handleSize(30).on("end",Qe);R.append("g").attr("class","brush").call(He).call(He.move,[$e,we]);function Qe(O){if(!O.sourceEvent||!O.selection)return;P.value?r.value=h-O.selection[0]+60+"px":r.value=h-O.selection[0]+52+"px",B.value=O.selection[1]+74+"px";let D,Be,Ve=0,g=0;e.direction?(Ve=p(parseInt(String(O.selection[0]/V+W)),Number(e.poolInfo.tickSpacing)),D=m.tickIndexToPrice(Ve,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),g=p(parseInt(String(O.selection[1]/V+W)),Number(e.poolInfo.tickSpacing)),Be=m.tickIndexToPrice(g,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()):(g=p(z-O.selection[0]/V,Number(e.poolInfo.tickSpacing)),D=1/m.tickIndexToPrice(g,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),Ve=p(z-O.selection[1]/V,Number(e.poolInfo.tickSpacing)),Be=1/m.tickIndexToPrice(Ve,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()),u.emit("onChangeMinPrice",String(ie(String(D),6))),u.emit("onChangeMaxPrice",String(ie(String(Be),6)))}i.value.theme=="default"?lt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):lt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};L(""),ce(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([s,$,w,U,n])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1125 ~ dataProcessing ~ poolInfo:",s),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ tickList:",n),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ currentPriceTab:",U),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ maxPrice:",w),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ minPrice:",$),s&&$&&w&&U&&n&&n.length>0&&(U!=="Custom"&&console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1131 ~ dataProcessing ~ dataProcessing:"),x(s,o.value))},{immediate:!0});const H=L(!0);return ce(()=>e.chartLoading,(s,$)=>{s!==$&&(H.value=s)},{immediate:!0,deep:!0}),{store:i,loading:H,zoomOut:I,zoomIn:G,rangeSizeLower:b,rangeSizeUpper:N,rangeSizeLowerPosition:r,rangeSizeUpperPosition:B,decimalFormat:vo,numberformat:mo}}});const Eo=e=>(et("data-v-c61e315e"),e=e(),tt(),e),Wo={class:"chart-box"},Ho={class:"chart"},Vo=Eo(()=>t("svg",{id:"chart"},null,-1)),Xo=[Vo];function Go(e,u,o,r,B,l){return c(),k("div",Wo,[le(t("div",Ho,Xo,512),[[Vt,!e.loading]])])}const zo=ze(Do,[["render",Go],["__scopeId","data-v-c61e315e"]]),Ne=e=>(et("data-v-7c67dfb5"),e=e(),tt(),e),Jo={class:"new-position-info"},Yo={class:"pool-info"},Qo={class:"left"},Ko={class:"coin-a"},Zo={alt:""},en={class:"coin-b"},tn={alt:""},on={class:"position-name"},nn=["href"],sn=Ne(()=>t("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),an=[sn],ln={class:"pool-fee"},rn=Ne(()=>t("span",null,"Fee tier",-1)),un={class:"right"},cn={class:"h5-pool-info"},dn={class:"coin-info"},vn={class:"coin-a"},mn={alt:""},fn={class:"coin-b"},hn={alt:""},_n={class:"position-name"},pn=["href"],gn=Ne(()=>t("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),bn=[gn],wn={class:"pool-fee"},kn={class:"price-info"},yn={class:"price-and-chart"},Pn={class:"left"},An={class:"current-price"},$n=Ne(()=>t("span",null,"Current Price",-1)),In={class:"coin-rate"},Sn=Ne(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Cn=Ne(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),xn=[Sn,Cn],Tn={key:0},Nn={key:1},Bn={key:0,class:"position-range"},qn=Ne(()=>t("div",{class:"position-range-title"},"Position Range",-1)),Rn={key:0},On={key:1},Ln=Ne(()=>t("img",{src:wo,alt:""},null,-1)),Mn={key:2},Fn={key:3},Un={key:1,class:"position-range position-range-warp"},jn={key:0,class:"position-range-title"},Dn={key:1,class:"position-range-title"},En={key:2},Wn={key:3},Hn=Ne(()=>t("div",{class:"price-img"},[t("img",{src:ko,alt:""})],-1)),Vn={key:4},Xn={key:5},Gn={class:"lever"},zn={class:"lever-title"},Jn=Ne(()=>t("div",null,[t("span",null," Leverage "),t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),Yn={class:"lever-text"},Qn={class:"right"},Kn=Ne(()=>t("div",{class:"chat-mask"},null,-1)),Zn=Me({__name:"new-position-info",setup(e){const u=dt(),o=y(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:643 ~ currentPositionInfo ~ suiPoolStore.currentPositionInfo:",u.currentPositionInfo),u.currentPositionInfo)),r=y(()=>u.poolsObj),B=De(),l=y(()=>B.currentExplorer),b=L(!0),N=(p,I)=>p!=="0"&&I!=="âˆž"?Te(1/(1-Number((p/I)**.25)),2)+"x":"1x",a=y(()=>o.value.minPrice&&o.value.maxPrice?N(o.value.minPrice,o.value.maxPrice):"--"),i=nt("Sui"),_=L([]),m=async p=>{const{list:I}=await i.getTicks(p),G=I?i.getTickDataFromUrlData(I):[];console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:593 ~ resetTickList ~ list:",G),_.value=G};return ce(()=>[o.value,r.value],([p,I])=>{p&&!he(p)&&I&&!he(I)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:417 ~ poolsObj:",I),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:418 ~ newValue:",p),m(I[p.pool]))},{immediate:!0}),(p,I)=>{var S,H,s,$,w,U,n,A,d,E,C,h,f,T,j,Z,W,z,V,te,R,de,ue,Ee,Ae,be,ye,Fe,We,Ue,oe,$e,we,Ie,je,He,Qe,O,D,Be,Ve,g,J,q,ee,se,ve,_e,ae,pe,qe,Re,Xe,ge,Se,Oe,Le,Je,ne,Pe,ke,Ge,st,Ke,mt,kt,yt,Pt,At,$t,It,St,Ct,xt,Tt,Nt,Bt,qt,Rt,Ot,Lt,Mt;const G=bt,Q=Qt,x=Xt,P=_t("image");return c(),k("div",Jo,[t("div",Yo,[t("div",Qo,[t("div",Ko,[le(t("img",Zo,null,512),[[P,(H=(S=o.value)==null?void 0:S.coinA)==null?void 0:H.logo_url]]),X(G,{address:($=(s=o.value)==null?void 0:s.coinA)==null?void 0:$.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",en,[le(t("img",tn,null,512),[[P,(U=(w=o.value)==null?void 0:w.coinB)==null?void 0:U.logo_url]]),X(G,{address:(A=(n=o.value)==null?void 0:n.coinB)==null?void 0:A.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",on,[t("a",{href:F(Dt)(l.value,"nftAddress",(d=o.value)==null?void 0:d.nftHash),target:"_blank"},v((E=o.value)==null?void 0:E.positionName),9,nn)]),(c(),k("svg",{class:"copy-icon","aria-hidden":"true",onClick:I[0]||(I[0]=Ft=>{var at;return F(B).copy((at=o.value)==null?void 0:at.nftHash)})},an)),t("div",ln,[rn,K(" "+v((C=o.value)==null?void 0:C.feeRate),1)])]),t("div",un,[X(Q,{"current-status":(h=o.value)==null?void 0:h.positionStatus},null,8,["current-status"])])]),t("div",cn,[t("div",null,[t("div",dn,[t("div",vn,[le(t("img",mn,null,512),[[P,(T=(f=o.value)==null?void 0:f.coinA)==null?void 0:T.logo_url]]),X(G,{address:(Z=(j=o.value)==null?void 0:j.coinA)==null?void 0:Z.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),t("div",fn,[le(t("img",hn,null,512),[[P,(z=(W=o.value)==null?void 0:W.coinB)==null?void 0:z.logo_url]]),X(G,{address:(te=(V=o.value)==null?void 0:V.coinB)==null?void 0:te.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),t("div",_n,[t("div",null,[t("a",{href:F(Dt)(l.value,"nftAddress",(R=o.value)==null?void 0:R.nftHash),target:"_blank"},v((de=o.value)==null?void 0:de.positionName),9,pn),(c(),k("svg",{class:"copy-icon","aria-hidden":"true",onClick:I[1]||(I[1]=Ft=>{var at;return F(B).copy((at=o.value)==null?void 0:at.nftHash)})},bn))]),t("div",wn,v((ue=o.value)==null?void 0:ue.feeRate),1)])]),X(Q,{"current-status":(Ee=o.value)==null?void 0:Ee.positionStatus},null,8,["current-status"])]),t("div",kn,[t("div",yn,[t("div",Pn,[t("div",An,[t("div",null,[$n,t("div",In,[t("div",{onClick:I[2]||(I[2]=Ft=>b.value=!b.value)},xn)])]),((Ae=o.value)!=null&&Ae.isResever?!b.value:b.value)?(c(),k("div",Tn,[K(v(F(Y)(F(ie)((be=o.value)==null?void 0:be.currentPriceReverse,6)))+" Â  ",1),t("span",null,v((Fe=(ye=o.value)==null?void 0:ye.coinB)==null?void 0:Fe.symbol)+" per "+v((Ue=(We=o.value)==null?void 0:We.coinA)==null?void 0:Ue.symbol),1)])):(c(),k("div",Nn,[K(v(F(Y)(F(ie)((oe=o.value)==null?void 0:oe.currentPrice,6)))+" Â  ",1),t("span",null,v((we=($e=o.value)==null?void 0:$e.coinA)==null?void 0:we.symbol)+" per "+v((je=(Ie=o.value)==null?void 0:Ie.coinB)==null?void 0:je.symbol),1)]))]),(He=o.value)!=null&&He.minPrice&&((Qe=o.value)==null?void 0:Qe.minPrice.length)<9&&((O=o.value)!=null&&O.maxPrice)&&((D=o.value)!=null&&D.maxPrice.length)?(c(),k("div",Bn,[qn,t("div",null,[((Be=o.value)!=null&&Be.isResever?!b.value:b.value)?(c(),k("div",Rn,[K(v(F(Y)(F(ie)((Ve=o.value)==null?void 0:Ve.minPrice,6)))+" ",1),t("span",null,v(o.value&&((g=o.value)==null?void 0:g.coinB)&&((q=(J=o.value)==null?void 0:J.coinB)==null?void 0:q.symbol)),1)])):(c(),k("div",On,[K(v(((ee=o.value)==null?void 0:ee.minPrice)!=="0"?F(Y)(F(ie)(1/((se=o.value)==null?void 0:se.minPrice),6)):0)+" ",1),t("span",null,v(o.value&&((ve=o.value)==null?void 0:ve.coinA)&&((ae=(_e=o.value)==null?void 0:_e.coinA)==null?void 0:ae.symbol)),1)])),Ln,((pe=o.value)!=null&&pe.isResever?!b.value:b.value)?(c(),k("div",Mn,[K(v(((qe=o.value)==null?void 0:qe.maxPrice)!=="âˆž"?F(Y)(F(ie)((Re=o.value)==null?void 0:Re.maxPrice,6)):"âˆž")+" ",1),t("span",null,v(o.value&&((Xe=o.value)==null?void 0:Xe.coinB)&&((Se=(ge=o.value)==null?void 0:ge.coinB)==null?void 0:Se.symbol)),1)])):(c(),k("div",Fn,[K(v(((Oe=o.value)==null?void 0:Oe.maxPrice)!=="âˆž"?F(Y)(F(ie)(1/((Le=o.value)==null?void 0:Le.maxPrice),6)):"âˆž")+" ",1),t("span",null,v(o.value&&((Je=o.value)==null?void 0:Je.coinA)&&((Pe=(ne=o.value)==null?void 0:ne.coinA)==null?void 0:Pe.symbol)),1)]))])])):(c(),k("div",Un,[((ke=o.value)!=null&&ke.isResever?!b.value:b.value)?(c(),k("span",jn," Position Range ")):(c(),k("span",Dn," Position Range ")),((Ge=o.value)!=null&&Ge.isResever?!b.value:b.value)?(c(),k("div",En,[K(v(F(Y)(F(ie)((st=o.value)==null?void 0:st.minPrice,6)))+" ",1),t("span",null,v(o.value&&((Ke=o.value)==null?void 0:Ke.coinB)&&((kt=(mt=o.value)==null?void 0:mt.coinB)==null?void 0:kt.symbol)),1)])):(c(),k("div",Wn,[K(v(((yt=o.value)==null?void 0:yt.maxPrice)!=="âˆž"?F(Y)(F(ie)((Pt=o.value)==null?void 0:Pt.maxPriceResever,6)):"âˆž")+" ",1),t("span",null,v(o.value&&((At=o.value)==null?void 0:At.coinA)&&((It=($t=o.value)==null?void 0:$t.coinA)==null?void 0:It.symbol)),1)])),Hn,((St=o.value)!=null&&St.isResever?!b.value:b.value)?(c(),k("div",Vn,[K(v(((Ct=o.value)==null?void 0:Ct.maxPrice)!=="âˆž"?F(Y)(F(ie)((xt=o.value)==null?void 0:xt.maxPrice,6)):"âˆž")+" ",1),t("span",null,v(o.value&&((Tt=o.value)==null?void 0:Tt.coinB)&&((Bt=(Nt=o.value)==null?void 0:Nt.coinB)==null?void 0:Bt.symbol)),1)])):(c(),k("div",Xn,[K(v(((qt=o.value)==null?void 0:qt.minPrice)!=="0"?F(Y)(F(ie)((Rt=o.value)==null?void 0:Rt.minPriceResever,6)):0)+" ",1),t("span",null,v(o.value&&((Ot=o.value)==null?void 0:Ot.coinA)&&((Mt=(Lt=o.value)==null?void 0:Lt.coinA)==null?void 0:Mt.symbol)),1),K(" Â  ")]))])),t("div",Gn,[t("div",zn,[X(x,{"overlay-class-name":"lever-tooltip"},{title:me(()=>[K("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:me(()=>[Jn]),_:1})]),t("div",Yn,v(a.value),1)])]),t("div",Qn,[X(zo,{"pool-info":o.value,"tick-list":_.value,"min-price":o.value.minPrice,"max-price":o.value.maxPrice,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),Kn])])])])}}});const ei=ze(Zn,[["__scopeId","data-v-7c67dfb5"]]),ti={class:"liquidity-card"},oi={class:"liquidity-title"},ni={class:"liquidity-usd"},ii=t("span",null,"Liquidity",-1),si={class:"liquidity-ratio"},ai={class:"coin-ratio"},li={class:"coin-a-ratio"},ri={class:"coin-b-ratio"},ui={class:"ratio-progress"},ci={class:"base-quote-num"},di={class:"base-coin-num"},vi=t("span",null,"Base",-1),mi={alt:""},fi={key:0,class:"after"},hi={class:"quote-coin-num"},_i=t("span",null,"Quote",-1),pi={alt:""},gi={key:0,class:"after"},bi={class:"pending-yield"},wi={class:"left"},ki=t("div",{class:"pending-yield-title"},"Pending Yield",-1),yi={key:0,class:"after"},Pi={class:"right"},Ai={class:"fees-rewards"},$i={class:"fees-rewards-item"},Ii=t("span",null,"Fees",-1),Si={key:0,class:"after"},Ci=t("span",null,"Mining Rewards",-1),xi={alt:""},Ti={key:0,class:"after"},Wt=Me({__name:"new-position-liquidity",setup(e){const u=De(),o=vt(),r=y(()=>o),B=dt(),l=y(()=>B.currentPositionInfo),b=y(()=>B.positionPendingFees[l.value.positionId]),N=y(()=>B.positionPendingRewards[l.value.positionId]),a=y(()=>{var n,A,d,E;let U=xe(0);return(n=b==null?void 0:b.value)!=null&&n.feesAmountUSD&&(U=U.add((A=b.value)==null?void 0:A.feesAmountUSD)),(d=N==null?void 0:N.value)!=null&&d.rewardsAmount&&(U=U.add((E=N.value)==null?void 0:E.rewardsAmount)),U.toNumber()}),i=L(!1),{setIsShowSuccess:_,setIsShowRejected:m,setIsShowWaiting:p,setTransactionDesc:I,setTransactionTxid:G}=u,Q=nt("Sui"),{getCurrentPosition:x}=Jt(),P=async()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1233 ~ claimFeesAndRewards ~ currentPositionInfo.value:",l.value),i.value=!0;let U={coinTypeA:l.value.defaultCoinaAddress,coinTypeB:l.value.defaultCoinbAddress,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:l.value.pool,pos_index:l.value.positionIndex,rewarder_nums:N.value.rewarderAmountOwed.length,collect_fee:!0};U.coinTypeC=N.value.rewarderAmountOwed[0]?N.value.rewarderAmountOwed[0].tokenInfo.address:"",U.coinTypeD=N.value.rewarderAmountOwed[1]?N.value.rewarderAmountOwed[1].tokenInfo.address:"",U.coinTypeE=N.value.rewarderAmountOwed[2]?N.value.rewarderAmountOwed[2].tokenInfo.address:"",p(!0),I();try{let n;U.pos_index=l.value.pos_object_id;const A=await Q.getCollectRewarderTransactionPayload(U,l.value),d=await Q.signAndExecuteTransactionBlock(r.value.currentWallet,A.txb,A.payloadParams);if(n=Q.handleTx(d),n&&n.hash){G(n.hash),p(!1),_(!0);const E={title:"Claim",desc:"",hash:n.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};E.res=n.res,Q.showTransitionPending(E),await Q.watchTransaction(E)&&(x(l.value.positionId,l.value.positionSource),setTimeout(()=>{Q.getAccount(r.value.address),i.value=!1},3e3))}else console.log("0310###toClaimRewards###else###"),p(!1),m(!0),i.value=!1}catch(n){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1225 ~ claimFeesAndRewards ~ error:",n),p(!1),m(!0),i.value=!1}},S=y(()=>B.positionDetailCurrentTab),H=y(()=>B.positionActionFromCoinAmount),s=y(()=>B.positionActionToCoinAmount),$=y(()=>{if(S.value=="increase")return H.value>0?xe(l.value.coinaAmount).add(xe(H.value)).toString():"";if(H.value>0){const U=xe(l.value.coinaAmount).minus(xe(H.value)).toString();return U<0?"0":U}else return""}),w=y(()=>{if(S.value=="increase")return s.value>0?xe(l.value.coinbAmount).add(xe(s.value)).toString():"";if(s.value>0){const U=xe(l.value.coinbAmount).minus(xe(s.value)).toString();return U<0?"0":U}else return""});return(U,n)=>{var C,h,f,T,j,Z,W,z,V,te,R,de,ue,Ee,Ae,be,ye,Fe,We,Ue;const A=bt,d=ot,E=_t("image");return c(),k("div",ti,[t("div",oi,[t("div",ni,[ii,t("div",null,"$"+v(l.value.positionAmountUSD),1)]),t("div",si,[t("div",ai,[t("div",li,[t("span",null,v((h=(C=l.value)==null?void 0:C.coinA)==null?void 0:h.symbol),1),K(" "+v((f=l.value)==null?void 0:f.fromPercent)+"% ",1)]),t("div",ri,[t("span",null,v((j=(T=l.value)==null?void 0:T.coinB)==null?void 0:j.symbol),1),K(" "+v((Z=l.value)==null?void 0:Z.toPercent)+"% ",1)])]),t("div",ui,[t("div",{class:"from-percent",style:Ut({width:((W=l.value)==null?void 0:W.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:Ut({width:((z=l.value)==null?void 0:z.toPercent)+"%"})},null,4)])])]),t("div",ci,[t("div",di,[vi,t("div",null,[le(t("img",mi,null,512),[[E,(te=(V=l.value)==null?void 0:V.coinA)==null?void 0:te.logo_url]]),X(A,{address:(de=(R=l.value)==null?void 0:R.coinA)==null?void 0:de.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,v(F(Y)(F(ie)((ue=l.value)==null?void 0:ue.coinaAmount))),1)]),$.value?(c(),k("div",fi,v(F(Y)($.value))+" after ",1)):re("",!0)]),t("div",hi,[_i,t("div",null,[le(t("img",pi,null,512),[[E,(Ae=(Ee=l.value)==null?void 0:Ee.coinB)==null?void 0:Ae.logo_url]]),X(A,{address:(ye=(be=l.value)==null?void 0:be.coinB)==null?void 0:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,v(F(Y)(F(ie)((Fe=l.value)==null?void 0:Fe.coinbAmount))),1)]),w.value?(c(),k("div",gi,v(F(Y)(w.value))+" after ",1)):re("",!0)])]),t("div",bi,[t("div",wi,[ki,t("div",null,[K(" $"+v(a.value>0&&a.value<.01?"<0.01":F(Y)(a.value,2))+" ",1),a.value>0?(c(),k("span",yi,"$0 after")):re("",!0)])]),t("div",Pi,[X(d,{class:"claim-all",loading:i.value,disabled:i.value||a.value==0,onClick:P},{default:me(()=>[K("Claim")]),_:1},8,["loading","disabled"])])]),t("div",Ai,[t("div",$i,[(c(!0),k(rt,null,ut((We=b.value)==null?void 0:We.feesList,oe=>(c(),k("div",{key:oe},[Ii,t("div",null,[le(t("img",null,null,512),[[E,oe.tokenInfo.logo_url]]),X(A,{address:oe.tokenInfo.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,v(F(pt)(oe.amount,"",oe.tokenInfo.decimals)),1)]),($.value||w.value)&&!F(he)(l.value)?(c(),k("div",Si," 0 after ")):re("",!0)]))),128)),(c(!0),k(rt,null,ut((Ue=N.value)==null?void 0:Ue.rewarderAmountOwed,oe=>(c(),k("div",{key:oe},[Ci,t("div",null,[le(t("img",xi,null,512),[[E,oe.tokenInfo.logo_url]]),X(A,{address:oe.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),t("span",null,v(F(pt)(oe.amount,"",oe.tokenInfo.decimals)),1)]),($.value||w.value)&&!F(he)(l.value)?(c(),k("div",Ti," 0 after ")):re("",!0)]))),128))])])])}}});function Ni(){const e=dt(),u=y(()=>e.currentPositionInfo),o=De(),r=y(()=>o.slippage);return{preAdd:(l,b)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ currentPositionInfo ~ currentPositionInfo:",u.value),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ preAdd ~ token:",b),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ preAdd ~ amount:",l);const{isReverse:N}=u.value,a=b.address==ro(u.value.defaultCoinaAddress).full_address;console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:23 ~ preAdd ~ iscoinA:",a);const i=Number(u.value.tickLowerIndex),_=Number(u.value.tickUpperIndex),m=new Ce(l),p=!0,I=new Ce(u.value.current_sqrt_price);console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:27 ~ preAdd ~ coinAmount:",m.toString());const{liquidityAmount:G,coinAmountA:Q,coinAmountB:x}=Yt.estLiquidityAndcoinAmountFromOneAmounts(i,_,m,a,p,Number(r.value)/100,I),P=N?u.value.coinB.decimals:u.value.coinA.decimals,S=N?u.value.coinA.decimals:u.value.coinB.decimals;return{tokenMaxA:N?Ze(x.toString(),S):Ze(Q.toString(),P),tokenMaxB:N?Ze(Q.toString(),P):Ze(x.toString(),S)}}}}const it=e=>(et("data-v-64c7abd5"),e=e(),tt(),e),Bi=it(()=>t("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),qi={class:"modal-content"},Ri={class:"pool-info"},Oi={class:"left"},Li={alt:""},Mi={alt:""},Fi={class:"pool-name"},Ui={class:"right"},ji={class:"coin-info"},Di={class:"from-coin-info"},Ei={class:"left"},Wi={class:"coin-amount"},Hi={class:"coin-symbol"},Vi={class:"right"},Xi={class:"to-coin-info"},Gi={class:"left"},zi={class:"coin-amount"},Ji={class:"coin-symbol"},Yi={class:"right"},Qi=it(()=>t("div",{class:"to-swap-logo"},null,-1)),Ki={class:"select-range"},Zi=it(()=>t("div",{class:"select-range-title"},"Selected Range",-1)),es={class:"price-conent"},ts={class:"current-price"},os={class:"left"},ns=it(()=>t("div",{class:"current-price-title"},"Current Price",-1)),is={class:"a2b"},ss={key:0},as={key:1},ls={key:2},rs={key:3},us={class:"right"},cs={alt:""},ds=it(()=>t("div",null,[t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),vs=it(()=>t("div",null,[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),ms=[ds,vs],fs={class:"price-range-block-content"},hs={class:"price-range-block"},_s={class:"price-item"},ps={class:"title"},gs={class:"price"},bs={key:0,class:"text"},ws={key:1,class:"text"},ks={class:"price-item"},ys={class:"title"},Ps={class:"price"},As={key:0,class:"text"},$s={key:1,class:"text"},Is={class:"deposit-ratio-content"},Ss=Me({__name:"increase-liquidity-modal",props:{fromCoinAmount:{type:String,default:"1245566.008946"},toCoinAmount:{type:String,default:"11111111111"},fixedFromCoin:{type:Boolean,default:!0},showFromCoinLock:{type:Boolean,default:!1},showToCoinLock:{type:Boolean,default:!1},positionTotalAmount:{type:Number,default:0},currentPositionInfo:{type:Object,default:()=>({})}},emits:["toAdd"],setup(e,{emit:u}){const o=u,r=L(!0);function B(){r.value=!r.value}const l=()=>{o("toAdd")};return(b,N)=>{const a=bt,i=Qt,_=xo,m=ot,p=_t("image");return c(),fe(F(to),{width:"440px",visible:!0,footer:null,title:"Increase",onCancel:N[0]||(N[0]=I=>b.$emit("onClose"))},{closeIcon:me(()=>[Bi]),default:me(()=>[t("div",qi,[t("div",Ri,[t("div",Oi,[t("div",null,[le(t("img",Li,null,512),[[p,e.currentPositionInfo.coinA.logo_url]]),X(a,{address:e.currentPositionInfo.coinA.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"0px"}},null,8,["address"])]),t("div",null,[le(t("img",Mi,null,512),[[p,e.currentPositionInfo.coinB.logo_url]]),X(a,{address:e.currentPositionInfo.coinB.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"0px"}},null,8,["address"])]),t("div",Fi,[t("span",null,v(e.currentPositionInfo.coinA.symbol),1),K(" - "),t("span",null,v(e.currentPositionInfo.coinB.symbol),1)])]),t("div",Ui,[K(" Fee tier "),t("span",null,v(e.currentPositionInfo.feeRate),1)])]),t("div",ji,[t("div",Di,[t("div",Ei,[t("div",Wi,v(F(Y)(e.fromCoinAmount)||0),1),t("div",Hi,v(e.currentPositionInfo.coinA.symbol),1)]),t("div",Vi,[le(t("img",null,null,512),[[p,e.currentPositionInfo.coinA.logo_url]]),X(a,{address:e.currentPositionInfo.coinA.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"0px"}},null,8,["address"])])]),t("div",Xi,[t("div",Gi,[t("div",zi,v(F(Y)(e.toCoinAmount)||0),1),t("div",Ji,v(e.currentPositionInfo.coinB.symbol),1)]),t("div",Yi,[le(t("img",null,null,512),[[p,e.currentPositionInfo.coinB.logo_url]]),X(a,{address:e.currentPositionInfo.coinB.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"0px"}},null,8,["address"])]),Qi])]),t("div",Ki,[Zi,X(i,{"current-status":e.showFromCoinLock||e.showToCoinLock?"Inactive":"Active"},null,8,["current-status"])]),t("div",es,[t("div",ts,[t("div",os,[ns,t("div",is,[r.value?(c(),k("span",ss,v(F(Y)(F(ie)(e.currentPositionInfo.currentPrice,6))),1)):(c(),k("span",as,v(F(Y)(F(ie)(e.currentPositionInfo.currentPriceReverse,6))),1)),r.value?(c(),k("div",rs,v(e.currentPositionInfo.coinB.symbol)+" per "+v(e.currentPositionInfo.coinA.symbol),1)):(c(),k("div",ls,v(e.currentPositionInfo.coinA.symbol)+" per "+v(e.currentPositionInfo.coinB.symbol),1))])]),t("div",us,[le(t("img",cs,null,512),[[p,r.value?e.currentPositionInfo.coinA.logo_url:e.currentPositionInfo.coinB.logo_url]]),t("span",null,v(r.value?e.currentPositionInfo.coinA.symbol:e.currentPositionInfo.coinB.symbol),1),t("div",{class:"coin-rate"},[t("div",{onClick:B},ms)])])]),t("div",fs,[t("div",hs,[t("div",_s,[t("div",ps,v(b.$t("common.minPrice")),1),t("p",gs,v(e.currentPositionInfo.minPrice),1),r.value?(c(),k("div",bs,v(e.currentPositionInfo.coinB.symbol)+" per "+v(e.currentPositionInfo.coinA.symbol),1)):(c(),k("div",ws,v(e.currentPositionInfo.coinA.symbol)+" per "+v(e.currentPositionInfo.coinB.symbol),1))]),t("div",ks,[t("div",ys,v(b.$t("common.maxPrice")),1),t("p",Ps,v(e.currentPositionInfo.maxPrice),1),r.value?(c(),k("div",As,v(e.currentPositionInfo.coinB.symbol)+" per "+v(e.currentPositionInfo.coinA.symbol),1)):(c(),k("div",$s,v(e.currentPositionInfo.coinA.symbol)+" per "+v(e.currentPositionInfo.coinB.symbol),1))])])])]),t("div",Is,[X(_,{"min-price":e.currentPositionInfo.minPrice,"max-price":e.currentPositionInfo.maxPrice,"pool-info":e.currentPositionInfo,"fixed-from-coin":e.fixedFromCoin,"from-coin":e.currentPositionInfo.coinA,"to-coin":e.currentPositionInfo.coinB,"current-price-tab":"custom",slippage:b.slippage,"current-price":e.currentPositionInfo.currentPrice,"current-price-reverse":e.currentPositionInfo.currentPriceReverse,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"position-total-amount":e.positionTotalAmount,"tick-lower":e.currentPositionInfo.tickLowerIndex,"tick-upper":e.currentPositionInfo.tickUpperIndex},null,8,["min-price","max-price","pool-info","fixed-from-coin","from-coin","to-coin","slippage","current-price","current-price-reverse","from-coin-amount","to-coin-amount","position-total-amount","tick-lower","tick-upper"])])]),X(m,{class:"big-btn liquidity-btn",onClick:l},{default:me(()=>[K(v("Increase Liquidity"))]),_:1})]),_:1})}}});const Cs=ze(Ss,[["__scopeId","data-v-64c7abd5"]]),xs={class:"new-position-asset"},Ts={class:"add-or-remove"},Ns={class:"liquidity-action-tab"},Bs=t("div",{class:"increase tab-active"},"Increase",-1),qs={class:ht("card-container")},Rs={class:"card-item"},Os={class:"card-item"},Ls={key:0,class:"add",src:So},Ms={class:"total-amount"},Fs=t("span",null,"Total Amount",-1),Us=Me({__name:"new-position-asset-add",setup(e){const{t:u}=Gt(),{getTokenRatePrice:o}=Co(),r=vt(),B=y(()=>r),l=dt(),b=y(()=>l.currentPositionInfo),N=De();y(()=>N.slippage);const a=L(),i=L(),_=L(),m=L(),p=L(!0),I=y(()=>B.value.assets&&a.value&&B.value.assets[a.value.address]?Ze(B.value.assets[a.value.address].balance,a.value.decimals):0),G=y(()=>B.value.assets&&i.value&&B.value.assets[i.value.address]?Ze(B.value.assets[i.value.address].balance,i.value.decimals):0),Q=A=>{A==="fromCoin"?(p.value=!0,_.value=I.value>0?a.value.symbol=="SUI"?new M(Number(I.value)).sub(new M(.05)).lt(new M(0))?"0":new M(Number(I.value)).sub(new M(.05)).toString():String(I.value):""):(p.value=!1,m.value=G.value>0?i.value.symbol=="SUI"?new M(Number(G.value)).sub(new M(.05)).lt(new M(0))?"0":new M(Number(G.value)).sub(new M(.05)).toString():String(G.value):"")},x=A=>{A==="fromCoin"?(p.value=!0,_.value=Te(new M(Number(I.value)).div(2).toString(),a.value.decimals).toString()):(p.value=!1,m.value=Te(new M(Number(G.value)).div(2).toString(),i.value.decimals).toString())};y(()=>b.value.isResever);const P=L(),S=L(),{preAdd:H}=Ni(),s=()=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add.vue:1021 ~ updateAmounts ~ updateAmounts:"),!b.value||!_.value&&!m.value)return;const A=p.value?_.value:m.value,d=p.value?a.value.decimals:i.value.decimals,E=xe(A).mul(M.pow(10,d)).toString(),C=p.value?a.value:i.value,{tokenMaxA:h,tokenMaxB:f}=H(E,C);p.value?m.value=f:_.value=h,l.setPositionActionAmount({fromCoinAmount:_,toCoinAmount:m})};ce(()=>b.value,A=>{if(A&&!he(A)){a.value=A.coinA,i.value=A.coinB,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add.vue:872 ~ newVal:",A);const{tickUpperIndex:d,tickUpperIndex:E,current_tick_index:C,maxPrice:h}=A;h=="âˆž"||C>=d&&C<E?(P.value=!1,S.value=!1):C>=E?(_.value="",P.value=!0,S.value=!1):C<d?(P.value=!1,S.value=!0,m.value=""):(P.value=!0,_.value="",S.value=!0,m.value=""),s()}},{immediate:!0}),ce(_,(A,d)=>{A&&s(),A==""&&(m.value="")}),ce(m,(A,d)=>{A&&s(),A==""&&(_.value="")});const $=y(()=>{var E,C,h,f;const A=o((E=a==null?void 0:a.value)==null?void 0:E.address,_==null?void 0:_.value,(C=a==null?void 0:a.value)==null?void 0:C.decimals),d=o((h=i==null?void 0:i.value)==null?void 0:h.address,m==null?void 0:m.value,(f=i==null?void 0:i.value)==null?void 0:f.decimals);if(A!=="--"&&d!=="--"){const T=xe(A).add(d);return pt(T.toString())}return"--"}),w=y(()=>{const A=Number(_.value)>Number(I.value),d=Number(m.value)>Number(G.value);return!_.value&&!m.value?u("button.enterAmount"):A?u("button.insufficientBalance",{name:a.value.symbol}):d?u("button.insufficientBalance",{name:i.value.symbol}):u("newAdd.addMore")}),U=y(()=>{const A=Number(_.value)>Number(I.value),d=Number(m.value)>Number(G.value);return!!(!_.value&&!m.value||A||d)}),n=L(!1);return(A,d)=>{const E=wt,C=Io,h=ot;return c(),k("div",xs,[t("div",Ts,[t("div",Ns,[Bs,t("div",{class:"remove",onClick:d[0]||(d[0]=f=>A.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),t("div",qs,[t("div",Rs,[X(E,{modelValue:_.value,"onUpdate:modelValue":d[1]||(d[1]=f=>_.value=f),"input-value":_.value,"coin-symbol":a.value?a.value.symbol:null,"coin-name":a.value?a.value.name:null,balance:I.value,"coin-icon":a.value?a.value.logoURI:"",address:a.value?a.value.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:d[2]||(d[2]=f=>Q("fromCoin")),onOnHalf:d[3]||(d[3]=f=>x("fromCoin")),onOnInput:d[4]||(d[4]=f=>{_.value=f}),onOnFocus:d[5]||(d[5]=()=>{p.value=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),P.value?(c(),fe(C,{key:0,"from-coin":a.value,"to-coin":i.value},null,8,["from-coin","to-coin"])):re("",!0)]),t("div",Os,[X(E,{modelValue:m.value,"onUpdate:modelValue":d[6]||(d[6]=f=>m.value=f),"input-value":m.value,"coin-symbol":i.value?i.value.symbol:null,"coin-name":i.value?i.value.name:null,balance:G.value,"swap-direct":"To","coin-icon":i.value?i.value.logoURI:"",address:i.value?i.value.address:"","import-page":"deposit","has-arrow":!1,onOnMax:d[7]||(d[7]=f=>Q("toCoin")),onOnHalf:d[8]||(d[8]=f=>x("toCoin")),onOnInput:d[9]||(d[9]=f=>{m.value=f}),onOnFocus:d[10]||(d[10]=()=>{p.value=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),S.value?(c(),fe(C,{key:0,"from-coin":a.value,"to-coin":i.value},null,8,["from-coin","to-coin"])):re("",!0)]),a.value&&i.value&&!S.value&&!P.value?(c(),k("img",Ls)):re("",!0)]),t("div",Ms,[Fs,t("span",null,v($.value),1)])]),B.value.connected?(c(),fe(h,{key:0,class:"big-btn liquidity-btn",disabled:U.value,loading:A.actionLoading,onClick:d[11]||(d[11]=f=>n.value=!0)},{default:me(()=>[t("span",null,v(w.value),1)]),_:1},8,["disabled","loading"])):(c(),fe(h,{key:1,class:"big-btn",onClick:d[12]||(d[12]=f=>B.value.connected?n.value=!0:B.value.setIsShowWalletModal(!0))},{default:me(()=>[t("span",null,v(A.$t("button.connectWallet")),1)]),_:1})),n.value?(c(),fe(Cs,{key:2,"current-position-info":b.value,"show-from-coin-lock":P.value,"show-to-coin-lock":S.value,"from-coin-amount":_.value,"to-coin-amount":m.value,onOnClose:d[13]||(d[13]=f=>n.value=!1)},null,8,["current-position-info","show-from-coin-lock","show-to-coin-lock","from-coin-amount","to-coin-amount"])):re("",!0)])}}});const js=Me({components:{AssetsCard:wt},setup(e,u){const o=L(""),r=L(""),B=De(),l=y(()=>B),b=y(()=>l.value.theme),N=gt(),a=y(()=>N),i=L(!1),_=L(!1),m=L(!0),p=y(()=>l.value.chainName),I=y(()=>p.value?nt(p.value):{}),G=vt(),Q=y(()=>G),x=y(()=>l.value.slippage),P=L(),S=L(),H=y(()=>{var g,J;return(J=(g=n.value)==null?void 0:g.poolInfo)==null?void 0:J.needReverse}),s=y(()=>{var g;return ie(n==null?void 0:n.value.amountA,(g=n==null?void 0:n.value.token_a)==null?void 0:g.decimals)}),$=y(()=>{var g;return ie(n==null?void 0:n.value.amountB,(g=n==null?void 0:n.value.token_b)==null?void 0:g.decimals)}),w=g=>{g==="fromCoin"?(m.value=!0,h.value||(p.value==="Aptos"||console.log(s.value,"213===>"),o.value=String(s.value))):(m.value=!1,h.value||(p.value,r.value=String($.value))),T.value=100,Z({value:1})},U=g=>{g==="fromCoin"?(m.value=!0,o.value=Te(new M(Number(s.value)).div(2).toString(),P.value.decimals).toString()):(m.value=!1,r.value=Te(new M(Number($.value)).div(2).toString(),S.value.decimals).toString()),h.value=!1},n=L({}),A=L(!0),d=L({}),E=L(),C=L(),h=L(!0),f=()=>{var Xe;if(h.value||!n.value||!o.value&&!r.value||Number(o.value)>Number(s.value)||Number(r.value)>Number($.value))return;if(o.value==s.value&&r.value==$.value){T.value=100,Z({value:1}),h.value=!0;return}const{TickMath:g,TickUtil:J}=I.value;let q=n.value.minPrice,ee=n.value.maxPrice.indexOf("+")>0?"âˆž":n.value.maxPrice,se=Number(n.value.tick_lower_index),ve=Number(n.value.tick_upper_index);const _e=Number(n.value.current_tick_index);let ae,pe,qe=Number(q).toString(),Re=n.value.maxPrice.indexOf("+")>0||n.value.maxPrice==="âˆž"?"âˆž":Number(ee);if(qe=="0"&&Re=="âˆž"?(se=Number(n.value.tick_lower_index),ve=Number(n.value.tick_upper_index)):(ae=g.priceToSqrtPriceX64(new M(q),P.value.decimals,S.value.decimals),pe=g.priceToSqrtPriceX64(new M(ee),P.value.decimals,S.value.decimals)),E.value=se,C.value=ve,ee!=="âˆž"&&se>=ve){i.value=!0,o.value="",_.value=!0,r.value="";return}if(ee=="âˆž"||_e>=se&&_e<ve){i.value=!1,_.value=!1;let ge;if(o.value||r.value){if(m.value){const Pe=new M(o.value).mul(Math.pow(10,P.value.decimals)).toString();ge=new Ce(Pe)}else{const Pe=new M(r.value).mul(Math.pow(10,S.value.decimals)).toString();ge=new Ce(Pe)}const{liquidityAmount:Se,tokenMaxA:Oe,tokenMaxB:Le,tokenMaxAOrigin:Je,tokenMaxBOrigin:ne}=I.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:P.value,tokenB:S.value,lowerTick:se,upperTick:ve,coinAmount:ge,iscoinA:A.value?m.value:!m.value,roundUp:p.value!="Sui",slippage:Number(x.value)/100,curSqrtPrice:new Ce(n.value.current_sqrt_price)});d.value={liquidityAmount:Se,tokenMaxA:Oe,tokenMaxB:Le,tokenMaxAOrigin:Je,tokenMaxBOrigin:ne},A.value?m.value?r.value=Number(Le)>0?Le:"":o.value=Number(Oe)>0?Oe:"":m.value?r.value=Oe:o.value=Le}}else if(_e>=ve){if(o.value="",i.value=!0,_.value=!1,o.value||r.value){let ge;const Se=new M(r.value).mul(Math.pow(10,(Xe=S.value)==null?void 0:Xe.decimals)).toString();ge=new Ce(Se),d.value={liquidityAmount:uo(ae,pe,ge),tokenMaxA:0,tokenMaxB:r.value}}}else if(_e<se){if(i.value=!1,_.value=!0,r.value="",o.value||r.value){let ge;const Se=new M(o.value).mul(Math.pow(10,P.value.decimals)).toString();ge=new Ce(Se),d.value={liquidityAmount:co(ae,pe,ge),tokenMaxA:o.value,tokenMaxB:0}}}else i.value=!0,_.value=!0;h.value=!1,T.value=new M(d.value.liquidityAmount.toString()).div(n.value.liquidity).mul(100).toNumber().toFixed(2),j.value=d.value.liquidityAmount,N.setPositionActionAmount({fromCoinAmount:o,toCoinAmount:r})},T=L(0),j=L("0"),Z=g=>{if(console.log("setPercent isSlider.value: ",h.value),!h.value)return;h.value=!0;const J=n.value.token_a.decimals,q=n.value.token_b.decimals,ee=n.value.tick_lower_index,se=n.value.tick_upper_index,ve=jt.tickIndexToSqrtPriceX64(ee),_e=jt.tickIndexToSqrtPriceX64(se);let ae="";g.value!==1?ae=new M(n.value.liquidity).mul(g.value).toString():ae=n.value.liquidity,ae=Te(ae,0)||"0",j.value=ae;const pe=Yt.getCoinAmountFromLiquidity(new Ce(ae),new Ce(n.value.current_sqrt_price),ve,_e,p.value!="Sui"),qe=new M(pe.coinA.toString()).div(Math.pow(10,J)).toString(),Re=new M(pe.coinB.toString()).div(Math.pow(10,q)).toString();o.value=Number(qe)>0?qe:"",r.value=Number(Re)>0?Re:"",N.setPositionActionAmount({fromCoinAmount:o,toCoinAmount:r})};ce(()=>a.value.currentPositionInfo,g=>{if(g&&!he(g)){n.value=g,P.value=n.value.token_a,S.value=n.value.token_b,Z({value:T.value/100});let J=Number(n.value.tick_lower_index),q=Number(n.value.tick_upper_index);const ee=Number(n.value.current_tick_index);(g.maxPrice.indexOf("+")>0||g.maxPrice==="âˆž"?"âˆž":g.maxPrice)=="âˆž"||ee>=J&&ee<q?(i.value=!1,_.value=!1):ee>=q?(o.value="",i.value=!0,_.value=!1):ee<J?(i.value=!1,_.value=!0,r.value=""):(i.value=!0,o.value="",_.value=!0,r.value=""),f()}},{immediate:!0}),ce(o,(g,J)=>{g&&f(),g==""&&(r.value="",T.value=0)}),ce(r,(g,J)=>{g&&f(),g==""&&(o.value="",T.value=0)});const W=y(()=>a.value.RATES),z=y(()=>{var ve,_e,ae,pe;const g=((_e=W.value[(ve=P.value)==null?void 0:ve.address])==null?void 0:_e.price)||0,J=((pe=W.value[(ae=S.value)==null?void 0:ae.address])==null?void 0:pe.price)||0,q=new M(g).mul(new M(o.value||0)),ee=new M(J).mul(new M(r.value||0)),se=q.add(ee);return Y(se.toString(),2)}),V=L(!1),{t:te,locale:R}=Gt(),de=y(()=>{const g=Number(o.value)>Number(s.value),J=Number(r.value)>Number($.value);return!o.value&&!r.value?te("button.enterAmount"):g||J?"Invalid Amount":te("button.remove")}),ue=y(()=>{const g=Number(o.value)>Number(s.value),J=Number(r.value)>Number($.value);return!!(!o.value&&!r.value||g||J)}),{setIsShowSuccess:Ee,setIsShowRejected:Ae,setIsShowWaiting:be,setTransactionDesc:ye,setTransactionTxid:Fe,setPositiomNum:We,setTransactionDescText:Ue}=B,oe=L(!1);ce(T,oo((g,J)=>{g!==J&&(Number(g)>100?T.value=100:g&&n.value?(T.value=g,Z({value:T.value/100})):(o.value="",r.value=""))},300)),ce(x,g=>{g&&n.value&&Z({value:T.value/100})});const $e=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],we=Kt(),Ie=y(()=>we),je=y(()=>Ie.value.status),He=L(!1),Qe=g=>{g.sources.forEach(q=>{const{pool_address:ee,position_index:se}=JSON.parse(q.blockchainAddress);ee==n.value.poolAddress&&Number(se)==Number(n.value.index)&&(He.value=!0)})},O=async()=>{await we.getSources();let g;Ie.value.allSources.forEach(J=>{const{pool_address:q,position_index:ee}=JSON.parse(J.blockchainAddress);q==n.value.poolAddress&&ee==n.value.index&&(g=J.id)}),we.deleteSource(g)};ce(()=>[Ie.value.sourceGroups,n.value],([g,J])=>{g&&g.sources&&g.sources.length>0&&J&&!he(J)&&Qe(g)},{immediate:!0,deep:!0});const D=ct(),Be=no();return{theme:b,showFromCoinLock:i,showToCoinLock:_,toCoinAmount:r,fromCoinAmount:o,fromCoinBlance:s,toCoinBlance:$,fromCoin:P,toCoin:S,maxBtnSelect:w,halfBtnSelect:U,fixedFromCoin:m,needReverse:H,totalAmount:z,wallet:Q,addLiquidityBtnText:de,isShowLiquidityModal:V,indexStore:B,positionInfo:n,actionLoading:oe,addLiquidityBtnDisabled:ue,sliderVal:T,ratioArr:$e,setPercent:Z,poolStore:N,isSlider:h,toRemove:async()=>{var se,ve,_e,ae,pe,qe,Re,Xe,ge,Se,Oe,Le,Je;oe.value=!0,Fe("");const g=Y(o.value,P.value.decimals)==0?"":`${ie(o.value,P.value.decimals)} ${P.value.symbol}`,J=Y(r.value,S.value.decimals)==0?"":`${ie(r.value,S.value.decimals)} ${S.value.symbol}`;ye(te("tips.removeLiquidiyText",{from:H.value?J:g,and:Y(o.value,P.value.decimals)==0||Y(r.value,S.value.decimals)==0?"":"and",to:H.value?g:J})),be(!0);const q=n.value.poolInfo.rewarder_infos,ee=q&&q.length>0&&p.value=="Sui"||q&&q.length>0&&T.value==100?te("modal.removeLiquidityText1"):te("modal.removeLiquidityText2");Ue(ee);try{let ne={};ne={pool:{...n.value.poolInfo,coinA:n.value.token_a,coinB:n.value.token_b},coinTypeA:n.value.poolInfo.coinTypeA,coinTypeB:n.value.poolInfo.coinTypeB,position:n.value,delta_liquidity:T.value==100?new Ce(n.value.liquidity):new Ce(Te(j.value,0)),slippage:Number(x.value),rewards_num:q.length,positionInfo:n.value},ne.coinTypeC=q[0]?q[0].coinAddress:"",ne.coinTypeD=q[1]?q[1].coinAddress:"",ne.coinTypeE=q[2]?q[2].coinAddress:"";const Pe=await I.value.getRemoveLiquidityTransactionPayload(ne);let ke;if(p.value==="Aptos")ke=await Q.value.currentWallet.signAndSubmitTransaction(Pe);else{const Ge=await I.value.signAndExecuteTransactionBlock(Q.value.currentWallet,Pe.txb,Pe==null?void 0:Pe.payloadParams);ke=I.value.handleTx(Ge),console.log("0331###remove###tx####",ke)}if(ke&&ke.hash){Fe(ke.hash),be(!1),Ee(!0);const Ge={title:te("common.removeLiquidity"),desc:"",hash:ke.hash,descTransactions:`Remove ${o.value} ${(se=P.value)==null?void 0:se.symbol} and ${r.value} ${(ve=S.value)==null?void 0:ve.symbol} 
             from the pool`,sender:Q.value.address,chainName:p.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:H.value?`${(ae=S.value)==null?void 0:ae.address}`:`${(_e=P.value)==null?void 0:_e.address}`,numa:H.value?`+ ${r.value}`:`+ ${o.value}`,logoa:H.value?a.value.tokensObj&&S.value&&S.value.address&&a.value.tokensObj[S.value.address]&&a.value.tokensObj[S.value.address].logoURI:a.value.tokensObj&&P.value&&P.value.address&&a.value.tokensObj[P.value.address]&&a.value.tokensObj[P.value.address].logoURI,tokenb:H.value?`${(pe=P.value)==null?void 0:pe.address}`:`${(qe=S.value)==null?void 0:qe.address}`,numb:H.value?`+ ${o.value}`:`+ ${r.value}`,logob:H.value?a.value.tokensObj&&P.value&&P.value.address&&a.value.tokensObj[P.value.address]&&a.value.tokensObj[P.value.address].logoURI:a.value.tokensObj&&S.value&&S.value.address&&a.value.tokensObj[S.value.address]&&a.value.tokensObj[S.value.address].logoURI},text:`Withdraw ${o.value} ${(Re=P.value)==null?void 0:Re.symbol} and ${r.value} ${(Xe=S.value)==null?void 0:Xe.symbol}`};p.value!=="Aptos"&&(Ge.res=ke.res),I.value.showTransitionPending(Ge);const st=await I.value.watchTransaction(Ge);if(q.value&&q.value.length>0&&(Number((ge=q[0])==null?void 0:ge.amount)!==0||ne.coinTypeD&&Number((Se=q[1])==null?void 0:Se.amount)!==0||ne.coinTypeE&&Number((Oe=q[2])==null?void 0:Oe.amount)!==0)){const Ke={title:te("common.removeLiquidity"),desc:"",hash:ke.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:q[0].symbol,numa:`+ ${Number(q[0].amount)}`,logoa:a.value.tokensObj&&q[0]&&q[0].address&&a.value.tokensObj[q[0].address]&&a.value.tokensObj[q[0].address].logoURI,tokenb:ne.coinTypeD?q[1].symbol:"",numb:ne.coinTypeD?`+ ${Number(q[1].amount)}`:"",logob:ne.coinTypeD?a.value.tokensObj&&q[1]&&q[1].address&&a.value.tokensObj[q[1].address]&&a.value.tokensObj[q[1].address].logoURI:"",tokenc:ne.coinTypeE?q[2].symbol:"",numc:ne.coinTypeE?`+ ${Number(q[2].amount)}`:"",logoc:ne.coinTypeE?a.value.tokensObj&&q[2]&&q[2].address&&a.value.tokensObj[q[2].address]&&a.value.tokensObj[q[2].address].logoURI:""},text:`Withdraw ${o.value} ${(Le=P.value)==null?void 0:Le.symbol} and ${r.value} ${(Je=S.value)==null?void 0:Je.symbol}`},mt=await I.value.setTransations(Ke)}if(ft(n.value.feeOwedA,n.value.token_a.decimals)!==0||ft(n.value.feeOwedB,n.value.token_b.decimals)!==0){const Ke={title:"Claim",desc:"",hash:ke.hash,chainName:p.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${n.value.token_a.symbol}`,numa:Y(n.value.feeOwedA,n.value.token_a.decimals)==0?"":`+ ${ft(n.value.feeOwedA,n.value.token_a.decimals)}`,logoa:Y(n.value.feeOwedA,n.value.token_a.decimals)==0?"":a.value.tokensObj&&n.value&&n.value.token_a.address&&a.value.tokensObj[n.value.token_a.address]&&a.value.tokensObj[n.value.token_a.address].logoURI,tokenb:`${n.value.token_b.symbol}`,numb:Y(n.value.feeOwedB,n.value.token_b.decimals)==0?"":`+ ${ft(n.value.feeOwedB,n.value.token_b.decimals)}`,logob:Y(n.value.feeOwedB,n.value.token_b.decimals)==0?"":a.value.tokensObj&&n.value&&n.value.token_b.address&&a.value.tokensObj[n.value.token_b.address]&&a.value.tokensObj[n.value.token_b.address].logoURI}},mt=await I.value.setTransations(Ke)}st&&Number(T.value)==100&&je.value=="authenticated"&&He.value&&(await we.subscribePosition({pool_address:n.value.poolAddress,position_index:n.value.index},n.value.nftHash,!1),O()),st&&(o.value="",r.value="",setTimeout(()=>{Number(T.value)!==100&&u.emit("getDetails")},3e3),setTimeout(()=>{Number(T.value)!==100&&u.emit("getDetails")},6e3),Number(T.value)==100&&Be.name=="new-position-detail"&&(p.value==="Aptos"?D.push("/position"):D.push("/pool/position")),T.value=0)}else be(!1),Ae(!0);oe.value=!1}catch(ne){console.log("Remove error",ne),oe.value=!1,be(!1),Ae(!0)}},sFixD:Te}}});const Ds={class:"new-position-asset"},Es={class:"add-or-remove"},Ws={class:"liquidity-action-tab"},Hs=t("div",{class:"remove tab-active"},"Remove",-1),Vs={class:"card-item"},Xs={key:0,class:"assets-card-mask"},Gs={class:"card-item"},zs={key:0,class:"assets-card-mask"},Js={class:"remove-ratio"},Ys=t("div",{class:"remove-ratio-title"},"Amount",-1),Qs={class:"remove-ratio-select"},Ks={key:0,class:"ratio"},Zs={key:1,class:"ratio"},ea={class:"ratio-list"},ta=["onClick"];function oa(e,u,o,r,B,l){const b=wt,N=io,a=ot;return c(),k("div",Ds,[t("div",Es,[t("div",Ws,[t("div",{class:"increase",onClick:u[0]||(u[0]=i=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Hs]),t("div",{class:ht(e.needReverse?"card-container reverse":"card-container")},[t("div",Vs,[X(b,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":u[1]||(u[1]=i=>e.fromCoinAmount=i),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:u[2]||(u[2]=i=>e.maxBtnSelect("fromCoin")),onOnHalf:u[3]||(u[3]=i=>e.halfBtnSelect("fromCoin")),onOnInput:u[4]||(u[4]=i=>{e.fromCoinAmount=i,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(c(),k("div",Xs)):re("",!0)]),t("div",Gs,[X(b,{modelValue:e.toCoinAmount,"onUpdate:modelValue":u[5]||(u[5]=i=>e.toCoinAmount=i),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:u[6]||(u[6]=i=>e.maxBtnSelect("toCoin")),onOnHalf:u[7]||(u[7]=i=>e.halfBtnSelect("toCoin")),onOnInput:u[8]||(u[8]=i=>{e.toCoinAmount=i,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(c(),k("div",zs)):re("",!0)])],2),t("div",Js,[Ys,t("div",Qs,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(c(),k("div",Ks,v(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:F(Te))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:F(Te))(e.sliderVal,2))+"% ",1)):(c(),k("div",Zs," -- ")),t("div",ea,[(c(!0),k(rt,null,ut(e.ratioArr,(i,_)=>(c(),k("div",{key:_,class:ht(["ratio-item",e.sliderVal==i.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=i.value}},v(i.name),11,ta))),128))])]),X(N,{value:e.sliderVal,"onUpdate:value":u[9]||(u[9]=i=>e.sliderVal=i)},null,8,["value"])])]),e.wallet.connected?(c(),fe(a,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:me(()=>[t("span",null,v(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(c(),fe(a,{key:1,class:"big-btn",onClick:u[10]||(u[10]=i=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:me(()=>[t("span",null,v(e.$t("button.connectWallet")),1)]),_:1}))])}const na=ze(js,[["render",oa]]),ia=Me({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const u=Kt(),o=y(()=>u),r=y(()=>o.value.status),B=De(),l=L(!1);ce(()=>r.value,i=>{i=="authenticated",l.value=!1},{immediate:!0});const b=L(!1),N=async()=>{b.value=!b.value;const i={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},_=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await u.subscribePosition(i,_,b.value)}catch{b.value=!b.value}},a=i=>{const _=i.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",_),b.value=_.some(m=>JSON.parse(m.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(m.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return ct(),ce(()=>[o.value.sourceGroups,e.positionInfo],([i,_])=>{b.value=!1,i&&i.length>0&&i[0]&&_&&!he(_)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),a(i[0]))},{immediate:!0,deep:!0}),{importIcon:Zt,isShowSetUp:l,changeSwitch:N,checked:b,notifiStatus:r,store:B}}});const sa=e=>(et("data-v-87410081"),e=e(),tt(),e),aa={class:"range-alerts"},la={class:"range-alerts-top"},ra={class:"title"},ua=sa(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),ca={key:1,class:"h5-switch-box"},da={class:"range-alerts-bottom"},va={key:0,class:"pc-switch-box"};function ma(e,u,o,r,B,l){const b=ot,N=so;return c(),k("div",aa,[t("div",la,[t("div",ra,[ua,e.isShowSetUp||e.notifiStatus!=="authenticated"?(c(),fe(b,{key:0,class:"range-alerts-button",onClick:u[0]||(u[0]=zt(a=>e.store.setIsShowNotifi(!0),["stop"]))},{default:me(()=>[K(" Set up ")]),_:1})):re("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(c(),k("div",ca,[X(N,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):re("",!0)])]),t("div",da,[K(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(c(),k("div",va,[X(N,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):re("",!0)])])}const fa=ze(ia,[["render",ma],["__scopeId","data-v-87410081"]]),ha=Me({setup(){const e=gt(),u=y(()=>e),o=No(),r=y(()=>o),B=ct(),l=y(()=>u.value.currentPositionInfo),b=L(),N=C=>{var h;return((h=u.value.tokensObj[C])==null?void 0:h.logo_url)||Zt("/image/coins/sui-unknown.png")},a=fo("Sui"),i=L(),_=async C=>{i.value=0;try{const h=await a.calculateFarmingRewards([{pool_id:C.pool_id,position_nft_id:C.id}]),f=[];let T=new M(0);h[C.id].forEach((j,Z)=>{var V;const W=(V=u.value.tokensObj[j.rewarder_type])==null?void 0:V.decimals;let z=new M(j.rewarder_amount).div(Math.pow(10,W)).toString();Number(z)>0&&p.value.rewarders[Z]&&(T=T.add(z),f.push({...j,rewarderAmount:z,rewarderAmountPer:z}))}),i.value=T,b.value=f}catch(h){console.log(h,"getRewarder")}},m=y(()=>r.value.farmsPoolObj),p=y(()=>m.value[l.value.poolAddress]);ce(()=>[l.value,m.value,p.value],([C,h,f])=>{var T;!he(C)&&C.positionSource=="farming"&&!he(f)?_(C):!he(h)&&!he(C)&&(b.value=(T=h[C.poolAddress])==null?void 0:T.rewarders)},{immediate:!0});const I=vt(),G=y(()=>I),Q=De(),x=nt("Sui"),{setIsShowSuccess:P,setIsShowRejected:S,setIsShowWaiting:H,setTransactionDesc:s,setTransactionTxid:$}=Q,w=L(!1),U=async()=>{w.value=!0,$(""),s("Claim rewards"),H(!0);const C={pool_id:l.value.pool_id,position_nft_id:l.value.id};try{const h=await a.harvestFarms(C),f=await x.signAndExecuteTransactionBlock(G.value.currentWallet,h.txb,h.payloadParams);console.log("0221###sui swap res###",f);let T=x.handleTx(f);if(T&&T.hash){$(T.hash),H(!1),P(!0);let j={title:"Claim",res:T.res,hash:T.hash};x.showTransitionPending(j),await x.watchTransaction(j)&&setTimeout(()=>{_(l.value),x.getAccount(G.value.address)},2e3)}else H(!1),S(!0);w.value=!1}catch(h){console.log("farmsDeposit error",h),H(!1),S(!0),w.value=!1}},n=async()=>{w.value=!0,$(""),s(`Unstake ${l.value.name}`),H(!0);const C=l.value.pool_id,h=l.value.id;try{const f=await a.farmsWithdraw(C,h),T=await x.signAndExecuteTransactionBlock(G.value.currentWallet,f.txb,f.payloadParams);console.log("0221###sui swap res###",T);let j=x.handleTx(T);if(j&&j.hash){$(j.hash),H(!1),P(!0);let Z={res:j.res,title:"Unstake",hash:j.hash};x.showTransitionPending(Z),await x.watchTransaction(Z)&&setTimeout(()=>{B.replace(`/new-position-detail?token=${l.value.tokenName}&address=${l.value.clmm_pool_id}&pos=${l.value.clmm_position_id}`),u.value.setCurrentPositionInfo(l.value.clmm_pool_id,"",l.value.tokenName,"Sui",l.value.clmm_position_id),i.value=0,w.value=!1},2e3)}else H(!1),S(!0)}catch(f){console.log("farmsDeposit error",f),H(!1),S(!0),w.value=!1}},A=async()=>{w.value=!0,$(""),s(`Stake ${l.value.name}`),H(!0);const C={clmm_pool_id:l.value.poolAddress,clmm_position_id:l.value.pos_object_id,coinTypeA:l.value.coin_type_a,coinTypeB:l.value.coin_type_b},h=m.value[l.value.poolAddress].id;try{const f=await a.farmsDeposit(C,h),T=await x.signAndExecuteTransactionBlock(G.value.currentWallet,f.txb,f.payloadParams);console.log("0221###sui swap res###",T);let j=x.handleTx(T);if(j&&j.hash){$(j.hash),H(!1),P(!0);let Z={res:j.res,title:"Staked",hash:j.hash};x.showTransitionPending(Z);const W=await x.watchTransaction(Z,!0);let z;W!=null&&W.status&&setTimeout(async()=>{var V,te;(te=(V=W==null?void 0:W.res)==null?void 0:V.events)==null||te.forEach(R=>{R.type.indexOf("::pool::DepositEvent")>-1&&(z=R.parsedJson.wrapped_position_id)}),B.replace(`/new-position-detail?position_nft_id=${z}&positionSource=farming`),await u.value.setCurrentPositionInfo("","","","Sui",z,"farming"),w.value=!1},2e3)}else H(!1),S(!0)}catch(f){console.log("farmsDeposit error",f),H(!1),S(!0),w.value=!1}},d=y(()=>Q),E=y(()=>d.value.addressLpTokens);return{getCoinIcon:N,rewardList:b,sFixD:Te,addCommom:Y,claim:U,unStake:n,loading:w,totalRewardAmount:i,currentPositionInfo:l,stake:A,farmsPoolObj:m,addressLpTokens:E,farmsPoolInfo:p}}});const Ye=e=>(et("data-v-2aa50387"),e=e(),tt(),e),_a={key:0,class:"farms-position-detail"},pa={class:"farms-top"},ga=Ye(()=>t("div",{class:"left"},[t("div",{class:"title"},"Farming"),t("div",{class:"desc"},"Stake Position to Earn")],-1)),ba={class:"right"},wa={class:"apr"},ka={class:"apr-tips-box"},ya=Ye(()=>t("span",null,"View",-1)),Pa=Ye(()=>t("svg",{class:"arrow-icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Aa=[ya,Pa],$a={class:"farms-bottom"},Ia=Ye(()=>t("div",{class:"title"},"Farming Rewards",-1)),Sa={key:0,class:"reward-list"},Ca={key:0,class:"rewards-item-bg"},xa={class:"rewards-item-box"},Ta={alt:""},Na={key:1},Ba={class:"rewards-item-bg"},qa={class:"rewards-item-box"},Ra={alt:""},Oa=Ye(()=>t("span",null,"0",-1)),La={key:1,class:"reward-list"},Ma={key:0,class:"rewards-item-bg"},Fa={class:"rewards-item-box"},Ua={alt:""},ja=Ye(()=>t("span",null,"0",-1)),Da={key:1},Ea={class:"rewards-item-bg"},Wa={class:"rewards-item-box"},Ha={alt:""},Va=Ye(()=>t("span",null,"0",-1)),Xa={class:"actions-box"};function Ga(e,u,o,r,B,l){var _,m,p;const b=To,N=ot,a=Xt,i=_t("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(c(),k("div",_a,[t("div",pa,[ga,t("div",ba,[t("div",wa,[K(" APRÂ  "),t("span",null,[K(v(("addCommom"in e?e.addCommom:F(Y))(((_=e.farmsPoolInfo)==null?void 0:_.total_apr)*100,2))+"%Â  ",1),t("div",ka,[X(b,{"l-item":e.farmsPoolInfo,"rewarder-info":(p=(m=e.farmsPoolInfo)==null?void 0:m.rewarder)==null?void 0:p.rewardList},null,8,["l-item","rewarder-info"])])])]),t("div",{class:"view",onClick:u[0]||(u[0]=I=>e.$router.push("/farms"))},Aa)])]),t("div",$a,[Ia,e.rewardList&&e.rewardList.length>0?(c(),k("div",Sa,[(c(!0),k(rt,null,ut(e.rewardList,I=>(c(),k("div",{key:I,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(c(),k("div",Ca,[t("div",xa,[le(t("img",Ta,null,512),[[i,e.getCoinIcon(I.rewarder_type)]]),t("span",null,v(("addCommom"in e?e.addCommom:F(Y))(I.rewarderAmount||0)),1)])])):(c(),k("div",Na,[t("div",Ba,[t("div",qa,[le(t("img",Ra,null,512),[[i,e.getCoinIcon(I.reward_coin)]]),Oa])])]))]))),128))])):(c(),k("div",La,[(c(!0),k(rt,null,ut(e.currentPositionInfo.rewards,I=>(c(),k("div",{key:I,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(c(),k("div",Ma,[t("div",Fa,[le(t("img",Ua,null,512),[[i,e.getCoinIcon(I.rewarder_type)]]),ja])])):(c(),k("div",Da,[t("div",Ea,[t("div",Wa,[le(t("img",Ha,null,512),[[i,e.getCoinIcon(I.reward_coin)]]),Va])])]))]))),128))])),t("div",Xa,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(c(),fe(N,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:me(()=>[K("Unstake")]),_:1},8,["loading","onClick"])):re("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(c(),fe(a,{key:1},{title:me(()=>[K("Farming rewards are only available for active positions.")]),default:me(()=>[X(N,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:me(()=>[K("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(c(),fe(N,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:me(()=>[K("Stake")]),_:1},8,["loading","onClick"])):re("",!0),X(N,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:zt(e.claim,["stop"])},{default:me(()=>[K("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):re("",!0)}const za=ze(ha,[["render",Ga],["__scopeId","data-v-2aa50387"]]),Ja={class:"new-position-detail"},Ya={class:"new-position-content"},Qa={class:"left"},Ka={class:"right"},Za={class:"loading-global"},el=Me({__name:"new-position-detail-sui",setup(e){const u=ct(),{getCurrentPosition:o}=Jt(),{getPoolList:r}=ho(),B=L(),l=L();Ht(()=>{B.value=u.currentRoute.value.query.id||"",l.value=u.currentRoute.value.query.positionSource||""});const b=dt(),N=y(()=>b.poolsObj),a=lo(),i=y(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:293 ~ allTokensObj ~ suiTokenStore.allTokensObj:",a.allTokensObj),a.allTokensObj));ce(()=>i.value,x=>{x&&!he(x)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:298 ~ watch ~ getPoolList:"),r())},{immediate:!0}),ce(()=>[N.value,i.value,B.value,l.value],([x,P,S,H])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ positionSource:",H),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ routerId:",S),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ allTokensObj:",P),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ poolsObj:",x),x&&!he(x)&&P&&!he(P)&&S&&H&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:38 ~ getCurrentPosition:"),o(S,H))},{immediate:!0});const _=vt(),m=y(()=>_),p=nt("Sui"),I=()=>{o(B.value,l.value),m.value.address&&p.getAccount(m.value.address)},G=y(()=>b.currentPositionLoading),Q=L("increase");return(x,P)=>{const S=ao;return c(),k("div",Ja,[X(jo,{onClickRefresh:I}),t("div",Ya,[t("div",Qa,[X(ei),X(Wt,{class:"pc-module",onGetDetails:x.getDetails},null,8,["onGetDetails"])]),t("div",Ka,[Q.value=="increase"?(c(),fe(Us,{key:0,onGetDetails:x.getDetails},null,8,["onGetDetails"])):(c(),fe(na,{key:1,onGetDetails:x.getDetails},null,8,["onGetDetails"])),X(Wt,{class:"h5-module",onGetDetails:x.getDetails},null,8,["onGetDetails"]),x.chainName=="Sui"?(c(),fe(za,{key:2})):re("",!0),x.positionInfo&&x.positionInfo.minPrice!=="0"&&x.positionInfo.maxPrice!=="âˆž"&&x.chainName=="Sui"?(c(),fe(fa,{key:3,"position-info":x.positionInfo},null,8,["position-info"])):re("",!0)])]),le(t("div",Za,[X(S)],512),[[Vt,G.value]])])}}});const Hl=ze(el,[["__scopeId","data-v-1e606406"]]);export{Hl as default};
