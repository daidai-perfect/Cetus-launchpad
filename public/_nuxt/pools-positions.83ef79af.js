import{_ as It}from"./refresh-icon.64571c8f.js";import{_ as Mt}from"./coin-pair-name.13e123eb.js";import{_ as Tt,a as At}from"./coin-select.5bc6435f.js";import{a as Ee,r as l,k as Ne,l as Z,x as qe,m as ze,w as F,D as U,y as he,b as Xe,o as v,e as b,z as $t,A as Lt,f as i,c as be,h as B,a2 as qt,p as tt,j as ot,i as nt,t as S,q as ae,s as it,v as Nt,B as at,I as Bt,J as _t,E as Ft,K as Ot,L as Rt,C as Ut,V as Ge,W as $e,O as ge,P as Ke,Q as Je,X as Qe,H as Le,Z as Vt,$ as Et,a0 as zt}from"./entry.b2a8e1c0.js";import{s as Ve,m as Xt,l as Dt,b as jt,a as xt,_ as Ye,c as Wt,d as Zt,e as Ht,f as Gt}from"./img-no-data_2x.52db0f3a.js";import{_ as lt,a as rt}from"./checked.667d8670.js";import{_ as Kt}from"./swap-setting.b2ce57aa.js";import{_ as st,a as ut,b as Jt}from"./img-lock_2x.8d4493cd.js";import"./img-no-Positions_2x.3a4bda32.js";/* empty css              */import"./index.6bbd15ef.js";import"./status-block.3e14cd96.js";import"./precision.ce0280e5.js";function et(e,t,I){const T=new U(10).pow(t-I);return new U(1.0001).pow(e).mul(T)}const Qt=Ee({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1}},setup(e,t){const I=l(1),T=Ne(),K=Z(()=>T),O=qe(),{TickMath:C}=O,V=()=>{if(I.value<.015625)return;const n=I.value/2;I.value=n,p(e.poolInfo,n)},ne=()=>{if(I.value>32)return;const n=I.value*2;I.value=n,p(e.poolInfo,n)},p=(n,d=1)=>{if(n&&n.token_a&&e.tickList.length>0&&!e.chartLoading&&e.minPrice&&e.maxPrice){const h=Number(e.currentTick),G=h+100*d,z=h-100*d;let A,P;e.maxPrice==="\u221E"?P=0:e.direction?P=C.priceToTickIndex(new U(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):P=C.priceToTickIndex(new U(1/Number(e.minPrice)),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals),e.minPrice==="0"?A=0:e.direction?A=C.priceToTickIndex(new U(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):A=C.priceToTickIndex(new U(1/Number(e.maxPrice)),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals);const r=Number(n.liquidity)/Math.pow(10,6),s=e.tickList,u=[],c=[];let a={};for(let q=0;q<s.length;q++)a=s[q],a.index<=h&&a.index>=z?u.unshift(a):a.index>h&&a.index<=G&&c.push(a);let M=Number(r);console.log(M,"nowLiquityLeft===>");for(let q=0;q<u.length;q++)u[q].liquityAmount=M-Number(u[q].liquidityGross.toString()/Math.pow(10,6));let J=Number(r);for(let q=0;q<c.length;q++)c[q].liquityAmount=J-Number(c[q].liquidityGross.toString()/Math.pow(10,6));let se=[];se=[...u.reverse(),{index:h,liquityAmount:Number(r)},...c],e.direction||(se=se.reverse()),console.log(se,"===>chartData"),le(se,z,G,A,P,h)}};let H=l(!1);ze(()=>{const n=document.body.clientWidth;n<750?H.value=!1:H.value=!0,window.onresize=()=>{n<750?H.value=!1:H.value=!0}});const le=(n,d,h,G,z,A)=>{const P={top:30,right:35,bottom:20,left:35};let r,s;H.value?(r=460-P.left-P.right,s=205-P.top-P.bottom):(r=340-P.left-P.right,s=205-P.top-P.bottom);const u=[d,A-(A-d)/2,A,A+(h-A)/2,h];console.log(u,"====>xArr");const c=u[0]-(u[1]-u[0]),a=u[4]+(u[4]-u[3]),M=r/(a-c);Ve("#chart").selectAll("*").remove();const J=Ve("#chart").attr("width",r+P.left+P.right).attr("height",s+P.top+P.bottom).append("g").attr("transform",`translate(${P.left},${P.right})`),se=Xt(n,function(g){return Number(g.liquityAmount)})||0,q=Dt().range([0,s]).domain([se,0]);jt().rangeRound([0,r]).padding(.1),J.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect").attr("x",function(g,k){return k===0?0:e.direction?Math.abs(n[k-1].index-c)*M:Math.abs(a-n[k-1].index)*M}).attr("y",function(g,k){return k===0?0:e.direction?q(n[k-1].liquityAmount):q(g.liquityAmount)}).attr("width",function(g,k){return k===0?0:e.direction?Math.abs(g.index-n[k-1].index)*M:Math.abs(n[k-1].index-g.index)*M}).attr("height",function(g,k){return k===0?0:e.direction?s-q(n[k-1].liquityAmount):s-q(g.liquityAmount)}).attr("fill","#2C4A57").attr("class","bars");const ue=J.append("g");ue.append("line").attr("x1",0).attr("y1",155).attr("x2",420).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const ke=ue.append("g");if(e.direction)for(let g=0;g<u.length;g++){const k=he(String(et(u[g],e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toNumber()),6)||"0",ie=Math.abs(u[g]-c)*M;let j=0;for(let x=0;x<k.length;x++)k[x]==="1"?j+=4.02:k[x]==="."?j+=2.64:k[x]==="7"?j+=5.48:j+=6;ke.append("text").text(k).attr("x",ie-j/2).attr("y",170).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}else for(let g=u.length-1;g>=0;g--){const k=he(String(1/et(u[g],e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toNumber()),6)||"0",ie=Math.abs(u[g]-a)*M;let j=0;for(let x=0;x<k.length;x++)k[x]==="1"?j+=4.02:k[x]==="."?j+=2.64:k[x]==="7"?j+=5.48:j+=6;ke.append("text").text(k).attr("x",ie-j/2).attr("y",170).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}const R=J.append("g").attr("id","left-handle"),X=J.append("g").attr("id","right-handle");K.value.theme=="default"?(R.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),R.append("path").attr("d","M0 0 L36 0 L36 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 20) rotate(180)"),R.append("text").text("Min").attr("fill","#B5B8C2").attr("x",-24).attr("y",14).attr("font-size","12px"),R.append("rect").attr("width",1).attr("height",6).attr("x",-32).attr("y",7).attr("fill","#68FFD8"),R.append("rect").attr("width",1).attr("height",8).attr("x",-30).attr("y",6).attr("fill","#68FFD8"),X.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),X.append("path").attr("d","M0 0 L36 0 L36 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 0)"),X.append("text").text("Max").attr("fill","#B5B8C2").attr("x",3).attr("y",14).attr("font-size","12px"),X.append("rect").attr("width",1).attr("height",6).attr("x",31).attr("y",7).attr("fill","#68FFD8"),X.append("rect").attr("width",1).attr("height",8).attr("x",29).attr("y",6).attr("fill","#68FFD8")):(R.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),R.append("path").attr("d","M0 0 L36 0 L36 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 20) rotate(180)"),R.append("text").text("Min").attr("fill","#B5B8C2").attr("x",-24).attr("y",14).attr("font-size","12px"),R.append("rect").attr("width",1).attr("height",6).attr("x",-32).attr("y",7).attr("fill","#76C8FF"),R.append("rect").attr("width",1).attr("height",8).attr("x",-30).attr("y",6).attr("fill","#76C8FF"),X.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),X.append("path").attr("d","M0 0 L36 0 L36 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 0)"),X.append("text").text("Max").attr("fill","#B5B8C2").attr("x",3).attr("y",14).attr("font-size","12px"),X.append("rect").attr("width",1).attr("height",6).attr("x",31).attr("y",7).attr("fill","#76C8FF"),X.append("rect").attr("width",1).attr("height",8).attr("x",29).attr("y",6).attr("fill","#76C8FF"));const Pe=xt().extent([[0,0],[r,s]]).handleSize(30).on("end",_e);let ce,me;e.direction?(ce=G<c?-100:Math.abs(G-c)*M,me=z<c?-100:Math.abs(z-c)*M):(me=G<c?-100:Math.abs(a-G)*M,ce=z<c?-100:Math.abs(a-z)*M),e.minPrice==="0"&&(ce=0),e.maxPrice==="\u221E"&&(me=r),J.append("g").attr("class","brush").call(Pe).call(Pe.move,[ce,me]),R.attr("transform","translate("+ce+", 0)"),X.attr("transform","translate("+me+", 0)");function _e(g){if(!g.sourceEvent||!g.selection)return;R.attr("transform","translate("+g.selection[0]+", 0)"),X.attr("transform","translate("+g.selection[1]+", 0)");let k,ie;e.direction?(k=C.tickIndexToPrice(g.selection[0]/M+c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toNumber(),ie=C.tickIndexToPrice(g.selection[1]/M+c,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toNumber()):(k=1/C.tickIndexToPrice(a-g.selection[0]/M,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toNumber(),ie=1/C.tickIndexToPrice(a-g.selection[1]/M,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toNumber()),console.log(k,"==>minPrice"),console.log(ie,"====>maxPrice"),t.emit("onChangeMinPrice",String(he(String(k),6))),t.emit("onChangeMaxPrice",String(he(String(ie),6)))}Ve(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#333")};F(()=>[e.poolInfo,e.tickList],([n,d])=>{n&&d&&d.length>0&&p(n,I.value)},{immediate:!0}),F(()=>e.direction,(n,d)=>{n!==d&&p(e.poolInfo,I.value)},{immediate:!0}),F(()=>e.minPrice,(n,d)=>{n!==d&&p(e.poolInfo,I.value)}),F(()=>e.maxPrice,(n,d)=>{n!==d&&p(e.poolInfo,I.value)});const re=l(!0);return F(()=>e.chartLoading,(n,d)=>{n!==d&&(re.value=n)},{immediate:!0,deep:!0}),{store:K,loading:re,zoomOut:V,zoomIn:ne}}});const Yt=e=>(tt("data-v-3d94e890"),e=e(),ot(),e),eo={class:"chart-box"},to={class:"chart"},oo={class:"zoom"},no=Yt(()=>i("svg",{id:"chart"},null,-1));function io(e,t,I,T,K,O){const C=qt;return v(),b("div",eo,[$t(i("div",to,[i("div",oo,[i("div",{class:"amplification",onClick:t[0]||(t[0]=(...V)=>e.zoomOut&&e.zoomOut(...V))}),i("div",{class:"narrow",onClick:t[1]||(t[1]=(...V)=>e.zoomIn&&e.zoomIn(...V))})]),no],512),[[Lt,!e.loading]]),e.loading?(v(),be(C,{key:0})):B("",!0)])}const ao=Xe(Qt,[["render",io],["__scopeId","data-v-3d94e890"]]),lo=Ee({props:{min:{type:String,default:""},max:{type:String,default:""},defaultMinPrice:{type:String,default:""},defaultMaxPrice:{type:String,default:""},fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},dirction:{type:Boolean,default:!0},invalidPriceRange:{type:Boolean,default:!1},poolInfo:{type:Object},currentPriceTab:{type:String}},setup(e,t){let I=l(""),T=l(""),K=l(),O=l(!1),C=l(!1);const V=l({}),ne=Ne(),p=Z(()=>ne);console.log(e,"props===>"),ze(()=>{I.value=e.min,T.value=e.max}),F(()=>e.currentPriceTab,(n,d)=>{n!==d&&(K.value=e.currentPriceTab)},{immediate:!0}),F(()=>e.min,(n,d)=>{n!==d&&(I.value=e.min)},{immediate:!0}),F(()=>e.max,(n,d)=>{n!==d&&(T.value=e.max)},{immediate:!0}),F(()=>e.poolInfo,(n,d)=>{n&&(V.value=n)},{immediate:!0}),F(I,(n,d)=>{n!==d&&t.emit("onChangeMinPrice",n)}),F(T,(n,d)=>{n!==d&&t.emit("onChangeMaxPrice",n)}),F(O,(n,d)=>{n!==d&&t.emit("onChangeFullRange",n)});const H=()=>{I.value=e.defaultMinPrice,T.value=e.defaultMaxPrice,C.value=!1,O.value=!1},le=()=>{C.value=!1,I.value="0",T.value="\u221E"};return F(O,(n,d)=>{n!==d&&t.emit("onChangeFullRange",n)}),{store:p,importIcon:nt,resetPrice:H,changeShowUnderStand:()=>{O.value=!O.value,O.value?C.value=!0:H(),C.value||(I.value=e.defaultMinPrice,T.value=e.defaultMaxPrice)},showUnderStand:C,minPrice:I,maxPrice:T,understand:le,isRadio:O,poolInfo:V,currentPriceTab:K}}});const ro={class:"set-price"},so={class:"title"},uo={class:"left"},co={class:"right"},mo={class:"check-img"},fo={key:0,src:lt,alt:""},vo={key:1,src:rt,alt:""},po={class:"card-container"},go={key:0,class:"card"},ko=["src"],ho={key:1,class:"understand"},yo={class:"left"},bo={class:"right"};function Co(e,t,I,T,K,O){const C=Ye,V=Ye,ne=at;return v(),b("div",ro,[i("div",so,[i("div",uo,S(e.$t("common.setPriceRange")),1),i("div",co,[i("span",{onClick:t[0]||(t[0]=(...p)=>e.resetPrice&&e.resetPrice(...p))},S(e.$t("common.reset")),1),i("div",{class:"full-range-btn",onClick:t[1]||(t[1]=p=>e.changeShowUnderStand())},[i("div",mo,[e.isRadio&&e.store.theme=="default"?(v(),b("img",fo)):B("",!0),e.isRadio&&e.store.theme!=="default"?(v(),b("img",vo)):B("",!0)]),i("span",null,S(e.$t("common.fullrange")),1)])])]),i("div",po,[e.showUnderStand?(v(),b("div",ho,[i("div",yo,[i("p",null,S(e.$t("common.lowerEfficiency")),1),i("p",null,S(e.$t("common.lowerEfficiencyTips")),1)]),i("div",bo,[ae(ne,{onClick:e.understand},{default:it(()=>[Nt(S(e.$t("common.understand")),1)]),_:1},8,["onClick"])])])):(v(),b("div",go,[ae(C,{modelValue:e.minPrice,"onUpdate:modelValue":t[2]||(t[2]=p=>e.minPrice=p),"input-value":e.minPrice,"p-type":"Min","default-max-price":e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,dirction:e.dirction,"pool-info":e.poolInfo,"current-price-tab":e.currentPriceTab,onOnInput:t[3]||(t[3]=p=>e.minPrice=p),onAddValue:t[4]||(t[4]=p=>e.minPrice=p),onDelValue:t[5]||(t[5]=p=>e.minPrice=p)},null,8,["modelValue","input-value","default-max-price","from-coin","to-coin","dirction","pool-info","current-price-tab"]),ae(V,{modelValue:e.maxPrice,"onUpdate:modelValue":t[6]||(t[6]=p=>e.maxPrice=p),"input-value":e.maxPrice,"p-type":"Max","default-min-price":e.minPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,dirction:e.dirction,"pool-info":e.poolInfo,"current-price-tab":e.currentPriceTab,onOnInput:t[7]||(t[7]=p=>e.maxPrice=p),onAddValue:t[8]||(t[8]=p=>e.maxPrice=p),onDelValue:t[9]||(t[9]=p=>e.maxPrice=p)},null,8,["modelValue","input-value","default-min-price","from-coin","to-coin","dirction","pool-info","current-price-tab"]),i("img",{src:e.importIcon("/image/lmg-line@2x.png"),alt:""},null,8,ko)]))])])}const Po=Xe(lo,[["render",Co],["__scopeId","data-v-b63a5177"]]),wo=Ee({setup(){const{t:e,locale:t}=Bt(),I=_t(),T=Z(()=>I),K=Ne(),O=l(20),C=l(0),V=l(null),ne=l(!1),p=l(!1),H=l(!1),le=l("fromCoin"),re=l(""),n=l(""),d=l(!1),h=l(!0),G=l(!1),z=l(!1),A=l(!0),P=l(!1),r=l(""),s=l(""),u=l(""),c=l(""),a=l(""),M=l(""),J=l(!1),se=l(!1),q=l(!1);l(!1);const Ce=l("0.01% fee tier"),Be=l(0),ue=l(!0),ke=l(!1),R=l([]),X=()=>{C.value=0,z.value=!0,setTimeout(()=>{z.value=!1},1e3)},Pe=Z(()=>Number(u.value)>Number(c.value)),ce=Z(()=>!m.value||!f.value),me=o=>{G.value=o,u.value="0",c.value="\u221E"},_e=Z(()=>[{label:"0.01% fee tier",title:"0.01% fee",text:"Best for extremely stable pairs."},{label:"0.05% fee tier",title:"0.05% fee",text:"Best for stable pairs."},{label:"0.2% fee tier",title:"0.2% fee",text:"Best for most pairs."},{label:"0.6% fee tier",title:"0.6% fee",text:"Best for exotic pairs."}]),g=Z(()=>K.slippage),k=Z(()=>ce.value?e("newAdd.invalidPair"):D.value?Number(r.value)>Number(Ie.value)?e("button.insufficientBalance",{name:m.value.symbol}):Number(s.value)>Number(Me.value)?e("button.insufficientBalance",{name:f.value.symbol}):P.value?e("modal.selectTokenModalTitle"):c.value!=="\u221E"&&Number(u.value)>=Number(c.value)?e("newAdd.invalidRange"):!Number(r.value)&&!Number(s.value)?e("button.enterAmount"):e("button.addLiquidity"):e("button.poolNotFound")),ie=Ne(),j=Z(()=>ie),x=Ft(),m=l(),f=l();ze(()=>{De()});const dt=o=>{console.log(o,"====>minPricevalue"),u.value=o},mt=o=>{console.log(o,"===maxPricevalue"),c.value=o},ft=()=>{ue.value=!0;const o=m.value;if(m.value=f.value,f.value=o,h.value=!h.value,console.log(h,"====>direct"),r.value=s.value,ue.value=!1,u.value!==""&&c.value!==""&&u.value!=="0"&&c.value!=="\u221E"){const y=u.value,E=c.value;(!ke.value||!h.value)&&(u.value=String(1/Number(E)),c.value=String(1/Number(y)));const $=a.value,w=M.value;console.log(w,"===>defaultMaxPriceOld"),console.log($,"===>defaultMinPriceOld"),a.value=String(1/Number(w)),M.value=String(1/Number($)),ke.value=!1}};F([u,c],([o],[y])=>{console.log(o,"===>newVal"),Re(),c.value!=="\u221E"&&Number(u.value)>=Number(c.value)?q.value=!0:q.value=!1});const vt=o=>{var y,E,$,w;le.value=o,o==="fromCoin"?(re.value=((y=f.value)==null?void 0:y.symbol)||"",n.value=((E=m.value)==null?void 0:E.symbol)||""):(re.value=(($=m.value)==null?void 0:$.symbol)||"",n.value=((w=f.value)==null?void 0:w.symbol)||""),d.value=!0},pt=o=>{P.value=!1,le.value==="fromCoin"?(f.value&&o.symbol.toLowerCase()===(f==null?void 0:f.value.symbol.toLowerCase())&&(f.value=null),m.value=o):(m.value&&o.symbol.toLowerCase()===(m==null?void 0:m.value.symbol.toLowerCase())&&(m.value=null),f.value=o),d.value=!1},gt=o=>{o==="fromCoin"?(A.value=!0,r.value=Ie.value>0?String(Ie.value):""):(A.value=!1,s.value=Me.value>0?String(Me.value):"")},De=()=>{V.value=setInterval(()=>{ne.value||C.value<O.value&&(C.value+=1,C.value===O.value&&(C.value=0))},1e3)};F(r,(o,y)=>{o&&Re()}),F(s,(o,y)=>{o&&Re()});const kt=()=>{console.log("changeCoinPosition###clearAll###"),m.value=null,f.value=null,console.log(m.value,"===fromCoin.value "),u.value="0",c.value="0",r.value="",s.value="",P.value=!0,Ce.value="",J.value=!1,Q.value=!1,Y.value=!1},je=l(!1);Ot();const{setIsShowSuccess:ht,setIsShowRejected:xe,setIsShowWaiting:we,setTransactionDesc:yt,setTransactionTxid:We,setPositiomNum:bt}=K,de=Rt(),Ct=Ut(),Fe=Z(()=>Ct);F(()=>Fe.value.tokensObj,o=>{Ge(o)||(de&&de.query&&de.query.from?m.value=$e(o,de.query.from):m.value=$e(o,"usdt"),de&&de.query&&de.query.from?f.value=$e(o,de.query.to):f.value=$e(o,"usdc"))},{immediate:!0});const fe=l({}),Q=l(!1),Y=l(!1),Ze=l(),He=l(),ve=qe(),Se=l(),Oe=l(),Re=()=>{var pe,ye;if(!D.value||!r.value&&!s.value&&!u.value&&!c.value||!m.value&&!f.value)return;console.log(D.value,"poolInfo====>");const{TickUtil:o,TickMath:y,getNearestTickByTick:E}=qe();let $=u.value,w=c.value,N,L,W,ee;if(console.log($==="0"&&w==="\u221E","min === '0' && max === '\u221E'"),$==="0"&&w==="\u221E")N=o.getMinIndex(D.value.tickSpacing),L=o.getMaxIndex(D.value.tickSpacing);else{W=y.priceToSqrtPriceX64(new U($),m.value.decimals,f.value.decimals),ee=y.priceToSqrtPriceX64(new U(w),m.value.decimals,f.value.decimals);const _=y.sqrtPriceX64ToTickIndex(W),oe=y.sqrtPriceX64ToTickIndex(ee);N=E(_,D.value.tickSpacing),L=E(oe,D.value.tickSpacing),console.log(N,L,"====tick_upper")}if(w!=="\u221E"&&N>=L){Q.value=!0,r.value="",Y.value=!0,s.value="";return}const te=Number(D.value.current_tick_index);if(console.log(N,"===>tick_lower"),console.log(L,"====>tick_upper"),console.log(te,"====>currentTick"),Ze.value=N,He.value=L,console.log(te<=N,"===>currentTick <= tick_lower"),w==="\u221E"||te>N&&te<L){Q.value=!1,Y.value=!1;let _;if(r.value||s.value){if(A.value){const Ue=new U(r.value).mul(Math.pow(10,m.value.decimals)).toString();_=new ge(Ue)}else{const Ue=new U(s.value).mul(Math.pow(10,f.value.decimals)).toString();_=new ge(Ue)}const{liquidityAmount:oe,tokenMaxA:Te,tokenMaxB:Ae,tokenMaxAOrigin:wt,tokenMaxBOrigin:St}=ve.estLiquidityAndcoinAmountFromOneAmounts({tokenA:m.value,tokenB:f.value,lowerTick:N,upperTick:L,coinAmount:_,iscoinA:h.value?A.value:!A.value,roundUp:!0,slippage:Number(g.value)/100,curSqrtPrice:new ge(D.value.current_sqrt_price)});fe.value={liquidityAmount:oe,tokenMaxA:Te,tokenMaxB:Ae,tokenMaxAOrigin:wt,tokenMaxBOrigin:St},h.value?A.value?s.value=Number(Ae)>0?Ae:"":r.value=Number(Te)>0?Te:"":A.value?s.value=Te:r.value=Ae}}else if(te>=L){if(h.value?r.value="":s.value="",Q.value=h.value,Y.value=!h.value,r.value||s.value){let _;if(h.value){const oe=new U(s.value).mul(Math.pow(10,(pe=f.value)==null?void 0:pe.decimals)).toString();_=new ge(oe),fe.value={liquidityAmount:Ke(W,ee,_),tokenMaxA:0,tokenMaxB:s.value}}else{const oe=new U(r.value).mul(Math.pow(10,(ye=m.value)==null?void 0:ye.decimals)).toString();_=new ge(oe),fe.value={liquidityAmount:Ke(W,ee,_),tokenMaxA:0,tokenMaxB:r.value}}}}else if(te<=N){if(Q.value=!h.value,Y.value=h.value,h.value?s.value="":r.value="",r.value||s.value){let _;if(h.value){const oe=new U(r.value).mul(Math.pow(10,m.value.decimals)).toString();_=new ge(oe),fe.value={liquidityAmount:Je(W,ee,_),tokenMaxA:r.value,tokenMaxB:0}}else{const oe=new U(s.value).mul(Math.pow(10,f.value.decimals)).toString();_=new ge(oe),fe.value={liquidityAmount:Je(W,ee,_),tokenMaxA:s.value,tokenMaxB:0}}}}else Q.value=!0,r.value="",Y.value=!0,s.value=""},D=Z(()=>{if(Fe.value.tokensObj&&m.value&&f.value){const o=Object.values(Fe.value.pools).find(y=>{var E,$,w,N;return y.token_a.symbol.toUpperCase()===((E=m.value.symbol)==null?void 0:E.toUpperCase())&&y.token_b.symbol.toUpperCase()===(($=f.value.symbol)==null?void 0:$.toUpperCase())||y.token_b.symbol.toUpperCase()===((w=m.value.symbol)==null?void 0:w.toUpperCase())&&y.token_a.symbol.toUpperCase()===((N=f.value.symbol)==null?void 0:N.toUpperCase())});return o&&!Ge(o)?(console.log(o,"info===>"),o):null}return null}),Pt=async o=>{if(console.log("poolInfoWatch====>",o),o){const{TickMath:y,getNearestTickByTick:E}=qe();ue.value=!0,o.token_a.symbol.toLowerCase()===m.value.symbol.toLowerCase()&&o.token_b.symbol.toLowerCase()===f.value.symbol.toLowerCase()?h.value=!0:h.value=!1,console.log(h,"===>direct852"),ke.value=!0;const $=o.token_a.decimals,w=o.token_b.decimals;if(console.log($,"decimalsA===>"),console.log(w,"decimalsB===>"),console.log(o.price_interval,"===>value.price_interval"),o.price_interval){const L=o.price_interval,W=y.priceToSqrtPriceX64(new U(L.lower_price),$,w),ee=y.priceToSqrtPriceX64(new U(L.upper_price),$,w),te=y.sqrtPriceX64ToTickIndex(W),pe=y.sqrtPriceX64ToTickIndex(ee),ye=y.tickIndexToPrice(te,$,w).toString(),_=y.tickIndexToPrice(pe,$,w).toString();a.value=String(ye),u.value=String(ye),M.value=String(_),c.value=String(_)}else{const L=Number(E(o.current_tick_index,o.tickSpacing));console.log(L,"===>currentTick");const W=L-Number(o.tickSpacing),ee=L+Number(o.tickSpacing),te=y.tickIndexToPrice(W,$,w).toString(),pe=y.tickIndexToPrice(ee,$,w).toString();a.value=String(te),u.value=String(te),M.value=String(pe),c.value=String(pe)}Ce.value=o.fee+"% fee tier",Be.value=o.current_tick_index,Se.value=he(y.sqrtPriceX64ToPrice(o.current_sqrt_price,$,w).toString(),6),Oe.value=he(String(1/Se.value),6),console.log(Se,Oe,"===>currentPriceReverse");const N=await ve.getTicks(o);console.log(N,"===>result"),R.value=ve.getTickDataFromUrlData(N),ue.value=!1,console.log(R.value,"===>tickList.value")}};F(()=>D.value,o=>{o&&Pt(o)},{immediate:!0});const Ie=Z(()=>T.value.assets&&m.value&&T.value.assets[m.value.address]?Qe(T.value.assets[m.value.address].balance,m.value.decimals):0),Me=Z(()=>T.value.assets&&f.value&&T.value.assets[f.value.address]?Qe(T.value.assets[f.value.address].balance,f.value.decimals):0);return{invalidPair:ce,t:e,wallet:T,toAdd:async()=>{var y,E,$,w;je.value=!1,We(""),yt(e("tips.increaseLiquiditySuccess",{from:Q.value?"":`${r.value} ${(y=m.value)==null?void 0:y.symbol}`,and:!Q.value&&!Y.value?"and":"",to:Y.value?"":`${s.value} ${(E=f.value)==null?void 0:E.symbol}`})),we(!0);const o=h.value?A.value:!A.value;try{const N=await ve.getAddLiquidityTransactionPayload({pool:{poolAddress:D.value.poolAddress,token_a:D.value.token_a,token_b:D.value.token_b},amount:o?fe.value.tokenMaxA:fe.value.tokenMaxB,fix_amount_a:o,tick_lower:Ze.value,tick_upper:He.value,index:0,slippage:Number(g.value)/100,roundUp:!0});console.log(N,"===>payload");let L;if(L=await T.value.currentWallet.signAndSubmitTransaction(N),console.log("toSwap###tx###",L),L&&L.hash){We(L.hash),we(!1),ht(!0);const W={title:"Add Liquidity",desc:e("tips.addLiquiditySuccessText",{from:Q.value?"":`${r.value} ${($=m.value)==null?void 0:$.symbol}`,and:!Q.value&&!Y.value?"and":"",to:Y.value?"":`${s.value} ${(w=f.value)==null?void 0:w.symbol}`}),hash:L.hash};ve.showTransitionPending(W),await ve.watchTransaction(W)&&setTimeout(()=>{ve.getAccount(T.value.address)},1e3),bt()}else we(!1),xe(!0);r.value="",s.value=""}catch(N){r.value="",s.value="",console.log("Swap Error###",N),we(!1),xe(!0)}},chartLoading:ue,currentTick:Be,tickList:R,poolInfo:D,storeIndex:j,importIcon:nt,refresh:z,addLiquidityBtnText:k,slippage:g,isShowSwapSetting:p,autoRefreshTime:O,countdown:C,setMarketTimer:De,marketTimer:V,loading:ne,fromCoin:m,toCoin:f,openCoinSelect:vt,onCoinSelect:pt,existingCoins:re,lastSelectCoin:n,currentCoinKey:le,showCoinSelect:d,fromCoinAmount:r,toCoinAmount:s,maxBtnSelect:gt,fixedFromCoin:A,isShowLiquidityModal:je,direct:h,toggle:ft,edit:J,inputValue:Ce,feeTierList:_e,minPrice:u,maxPrice:c,invalidPriceRange:Pe,defaultMinPrice:a,defaultMaxPrice:M,priceRangeChangeMin:dt,priceRangeChangeMax:mt,toFullRange:me,unilateral:H,clearAll:kt,clickClear:P,positionError:q,positionTips:se,router:x,clickRefresh:X,fromCoinBlance:Ie,toCoinBlance:Me,showToCoinLock:Y,showFromCoinLock:Q,currentPriceReverse:Oe,currentPrice:Se}}});const ct=e=>(tt("data-v-2baf3e94"),e=e(),ot(),e),So={class:"pools-container"},Io={class:"title"},Mo={class:"left"},To={class:"right title-right"},Ao=ct(()=>i("svg",{class:"icon","aria-hidden":"true"},[i("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),$o={class:"content"},Lo={class:"left"},qo={class:"pools-card"},No={class:"first-card"},Bo={class:"top"},_o={key:0,class:"toggle"},Fo={key:0,class:"fee-container"},Oo=["onClick"],Ro={key:0,src:lt,alt:""},Uo={key:1,src:rt,alt:""},Vo={class:"card-container"},Eo={class:"card-item"},zo={key:0,class:"unilateral"},Xo={key:0,src:st,alt:""},Do={key:1,src:ut,alt:""},jo={class:"card-item"},xo={key:0,class:"unilateral"},Wo={key:0,src:st,alt:""},Zo={key:1,src:ut,alt:""},Ho=ct(()=>i("svg",{class:"icon","aria-hidden":"true"},[i("use",{"xlink:href":"#icon-icon-add"})],-1)),Go={class:"right"},Ko={class:"title"},Jo={class:"titLeft"},Qo={key:0},Yo={key:1,class:"coin"},en={key:2,class:"coin"},tn={class:"chart-img"},on={key:0,class:"noDataImg",src:Ht},nn={key:1,class:"noDataImg",src:Gt},an={key:0,class:"position-tips"},ln=["src"],rn={class:"tips"},sn={key:1,class:"position-tips"},un=["src"],cn={class:"error"};function dn(e,t,I,T,K,O){var G,z,A,P,r,s,u,c;const C=It,V=Mt,ne=zt,p=Tt,H=at,le=ao,re=Po,n=At,d=Kt,h=Jt;return v(),b("div",So,[i("div",Io,[i("div",Mo,[i("span",null,S(e.$t("common.concentratedLiquidity")),1),i("div",{class:"position",onClick:t[0]||(t[0]=a=>e.router.push("/position-list"))},S(e.$t("common.myPosition")),1)]),i("div",To,[i("span",{class:"clear",onClick:t[1]||(t[1]=(...a)=>e.clearAll&&e.clearAll(...a))},S(e.$t("common.clearAll")),1),i("div",{class:"slippage-icon",onClick:t[2]||(t[2]=a=>e.isShowSwapSetting=!0)},[Ao,i("span",null,S(e.slippage)+"%",1)]),ae(C,{loading:e.refresh,"auto-refresh-time":e.autoRefreshTime,countdown:e.countdown,onClickRefresh:t[3]||(t[3]=a=>e.clickRefresh())},null,8,["loading","auto-refresh-time","countdown"])])]),i("div",$o,[i("div",Lo,[i("div",qo,[i("div",No,[i("div",Bo,[ae(V,{"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"]),e.fromCoin&&e.toCoin?(v(),b("div",_o,[i("div",{class:Le(e.direct?"item active-item":"item"),onClick:t[4]||(t[4]=a=>e.direct?"":e.toggle())},S(e.direct?(G=e.fromCoin)==null?void 0:G.symbol:(z=e.toCoin)==null?void 0:z.symbol),3),i("div",{class:Le(e.direct?"item ":"item active-item"),onClick:t[5]||(t[5]=a=>e.direct?e.toggle():"")},S(e.direct?(A=e.toCoin)==null?void 0:A.symbol:(P=e.fromCoin)==null?void 0:P.symbol),3)])):B("",!0)]),ae(ne,{placeholder:e.$t("common.feeTier"),value:e.inputValue,disabled:""},null,8,["placeholder","value"]),e.edit?(v(),b("div",Fo,[(v(!0),b(Vt,null,Et(e.feeTierList,(a,M)=>(v(),b("div",{key:M,class:Le(e.inputValue.includes(a.label)?"fee-item fee-item-active":"fee-item"),onClick:J=>e.inputValue=a.label},[i("p",null,S(a.title),1),i("span",null,S(a.text),1),e.storeIndex.theme=="default"?(v(),b("img",Ro)):(v(),b("img",Uo))],10,Oo))),128))])):B("",!0)]),i("div",Vo,[i("div",Eo,[ae(p,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=a=>e.fromCoinAmount=a),"input-value":e.fromCoinAmount,"coin-name":e.fromCoin?e.fromCoin.symbol:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.icon:"","swap-direct":"From",onOnMax:t[7]||(t[7]=a=>e.maxBtnSelect("fromCoin")),onOnInput:t[8]||(t[8]=a=>e.fromCoinAmount=a),onOnFocus:t[9]||(t[9]=()=>{e.fixedFromCoin=!0}),onOnSelect:t[10]||(t[10]=a=>e.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-name","balance","coin-icon"]),e.showFromCoinLock?(v(),b("div",zo,[e.storeIndex.theme=="default"?(v(),b("img",Xo)):(v(),b("img",Do)),i("p",null,S(e.$t("tips.marketprice")),1)])):B("",!0)]),i("div",jo,[ae(p,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[11]||(t[11]=a=>e.toCoinAmount=a),"input-value":e.toCoinAmount,"coin-name":e.toCoin?e.toCoin.symbol:"",balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.icon:"",onOnMax:t[12]||(t[12]=a=>e.maxBtnSelect("toCoin")),onOnInput:t[13]||(t[13]=a=>e.toCoinAmount=a),onOnFocus:t[14]||(t[14]=()=>{e.fixedFromCoin=!1}),onOnSelect:t[15]||(t[15]=a=>e.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-name","balance","coin-icon"]),e.showToCoinLock?(v(),b("div",xo,[e.storeIndex.theme=="default"?(v(),b("img",Wo)):(v(),b("img",Zo)),i("p",null,S(e.$t("tips.marketprice")),1)])):B("",!0)]),!e.showToCoinLock&&!e.showFromCoinLock&&e.storeIndex.theme=="default"?(v(),b("img",{key:0,class:"add",src:Wt,alt:"",onClick:t[16]||(t[16]=(...a)=>e.toggle&&e.toggle(...a))})):B("",!0),!e.showToCoinLock&&!e.showFromCoinLock&&e.storeIndex.theme!=="default"?(v(),b("img",{key:1,class:"add",src:Zt,alt:"",onClick:t[17]||(t[17]=(...a)=>e.toggle&&e.toggle(...a))})):B("",!0)])]),ae(H,{disabled:e.wallet.connected?!e.fromCoinAmount&&!e.toCoinAmount||Number(e.fromCoinAmount)>Number(e.fromCoinBlance)||Number(e.toCoinAmount)>Number(e.toCoinBlance)||e.addLiquidityBtnText!==e.$t("button.addLiquidity"):!1,class:"big-btn",onClick:t[18]||(t[18]=a=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:it(()=>[Ho,i("span",null,S(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"])]),i("div",Go,[i("div",Ko,[i("div",Jo,[e.fromCoin&&e.toCoin?(v(),b("p",Qo,S(e.$t("common.currentPrice")),1)):B("",!0),e.fromCoin&&e.toCoin&&e.direct?(v(),b("div",Yo,"1 "+S((r=e.fromCoin)==null?void 0:r.symbol)+" \u2248 "+S(e.currentPrice)+" "+S((s=e.toCoin)==null?void 0:s.symbol),1)):e.fromCoin&&e.toCoin&&!e.direct?(v(),b("div",en," 1 "+S((u=e.fromCoin)==null?void 0:u.symbol)+" \u2248 "+S(e.currentPriceReverse)+" "+S((c=e.toCoin)==null?void 0:c.symbol),1)):B("",!0)])]),i("div",tn,[(e.clickClear||!e.poolInfo)&&e.storeIndex.theme=="default"?(v(),b("img",on)):B("",!0),(e.clickClear||!e.poolInfo)&&e.storeIndex.theme!=="default"?(v(),b("img",nn)):B("",!0),e.fromCoin&&e.toCoin&&e.poolInfo?(v(),be(le,{key:2,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direct,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","tick-list","current-tick","chart-loading","onOnChangeMinPrice","onOnChangeMaxPrice"])):B("",!0)]),i("div",{class:Le(e.clickClear?"set-price-mask":"")},null,2),ae(re,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direct,"invalid-price-range":e.invalidPriceRange,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax,onOnChangeFullRange:e.toFullRange},null,8,["min","max","from-coin","to-coin","direct","invalid-price-range","default-min-price","default-max-price","pool-info","onOnChangeMinPrice","onOnChangeMaxPrice","onOnChangeFullRange"]),e.positionTips&&!e.clickClear?(v(),b("div",an,[i("img",{src:e.importIcon("/image/icon-tips@2x.png"),alt:""},null,8,ln),i("p",rn,S(e.$t("tips.positionTips")),1)])):B("",!0),e.positionError&&!e.clickClear?(v(),b("div",sn,[i("img",{src:e.importIcon("/image/icon-tips-error@2x.png"),alt:""},null,8,un),i("p",cn,S(e.$t("tips.positionError")),1)])):B("",!0)])]),e.showCoinSelect?(v(),be(n,{key:0,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:t[19]||(t[19]=a=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):B("",!0),e.isShowSwapSetting?(v(),be(d,{key:1,onOnClose:t[20]||(t[20]=a=>e.isShowSwapSetting=!1)})):B("",!0),e.isShowLiquidityModal?(v(),be(h,{key:2,"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"pool-info":e.poolInfo,onToAdd:e.toAdd,onOnClose:t[21]||(t[21]=a=>e.isShowLiquidityModal=!1)},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","onToAdd"])):B("",!0)])}const Mn=Xe(wo,[["render",dn],["__scopeId","data-v-2baf3e94"]]);export{Mn as default};
