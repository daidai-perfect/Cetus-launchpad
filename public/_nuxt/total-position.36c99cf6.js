import{a as V,q as ge,o as u,f as v,F as I,s as ee,x as T,h as e,t as ne,v as y,u as p,e as W,r as h,m as $,c as z,w as j,i as D,j as M,Y as ye,B as ue,p as se,k as te,D as ie,z as Ce,K as De,W as Le,I as Re,L as xe,H as Oe,S as Ye}from"./entry.0caab9e0.js";import"./index.d2b47555.js";import{B as L,u as Ae,b as de}from"./index.98582d64.js";import{a as Pe,c as Te,b as je,u as ce}from"./pool.e34b56ac.js";/* empty css              *//* empty css              *//* empty css              */import{_ as Se}from"./icon-selected_3x.09e9a6f0.js";import{_ as Ee}from"./coin-pair-name.bc91ea3f.js";import{D as r}from"./decimal.0bdeb344.js";import{N as Be}from"./no-data.72439221.js";const Fe=""+globalThis.__publicAssetsURL("sui-image/route-view.png"),qe={key:0,class:"claim-list"},He={class:"left"},ze={alt:""},Me={class:"right"},Ve=V({__name:"claim-list",props:{myClaimList:{type:Object,default:()=>[]}},setup(o){return(k,_)=>{const w=ge("image");return o.myClaimList&&o.myClaimList.length>0?(u(),v("div",qe,[(u(!0),v(I,null,ee(o.myClaimList,i=>(u(),v("div",{key:i,class:"claim-item"},[e("div",He,[ne(e("img",ze,null,512),[[w,i.logo_url]]),e("span",null,y(i.symbol),1)]),e("div",Me,[e("span",null,y(p(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",null,y(p(L)(i.amountUSD,2,!1,!1)),1)])]))),128))])):T("",!0)}}});const ke=W(Ve,[["__scopeId","data-v-c3e2798b"]]),E=h(!1),H=h(!1),be=Pe(),{setIsShowSuccess:We,setIsShowRejected:pe,setIsShowWaiting:Q,setTransactionDesc:Ke,setTransactionTxid:he}=be,Ze=Te("Sui"),X=je("Sui"),Ge=Ae(),we=$(()=>Ge),$e=ce(),Je=$(()=>$e),Qe=$(()=>be),Xe=async o=>{H.value=!0;try{const k=[],_=[];o.forEach(c=>{const Y=c.rewarderInfo.filter(U=>U.emissionsEveryDay>0).map(U=>U.coinAddress);c.positionSource=="clmm"?k.push({pool_id:c.pool,pos_id:c.pos_object_id,collect_fee:!0,rewarder_coin_types:Y,coinTypeA:c.coin_type_a,coinTypeB:c.coin_type_b}):_.push({pool_id:c.pool_id,position_nft_id:c.id,clmm_pool_id:c.clmm_pool_id,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:Y,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB})}),he(""),Ke("Claim Yield"),Q(!0);const w=await Ze.batchHarvestAndClmmFee(_,k),i=await X.signAndExecuteTransactionBlock(we.value.currentWallet,w.txb,w.payloadParams),C=X.handleTx(i);if(C&&C.hash){he(C.hash),Q(!1),We(!0);const c={title:"Claim",desc:"Claim Yield",hash:C.hash};c.res=C.res,X.showTransitionPending(c),await X.watchTransaction(c)&&setTimeout(()=>{$e.getMyPositons(we.value.address,Je.value.poolsObj,Qe.value.chainName)},1e3)}else Q(!1),pe(!0);H.value=!1,E.value=!1}catch(k){H.value=!1,Q(!1),pe(!0),E.value=!1,console.log("batchHarvestAndClmmFee error:",k)}},re=o=>(se("data-v-8e7a4ef5"),o=o(),te(),o),Ie={class:"claim-yield-content"},es={class:"total-claim"},ss=re(()=>e("div",null,"Total Claim",-1)),ts={class:"total-claim-usd"},as=re(()=>e("svg",{"aria-hidden":"true",class:"back-icon"},[e("use",{"xlink:href":"#icon-icon-back"})],-1)),ls=re(()=>e("span",null,"Back",-1)),os=[as,ls],ns=V({__name:"claim-yield",props:{pendingYield:{type:Number,default:0},myClaimList:{type:Object,default:()=>[]},myClaimPositionList:{type:Object,default:()=>[]}},setup(o){return(k,_)=>{const w=ue;return u(),z(p(ye),{title:"Claim Yield",visible:!0,footer:null,width:"440px",onCancel:_[2]||(_[2]=i=>k.$emit("close"))},{default:j(()=>[e("div",Ie,[e("div",es,[ss,e("div",ts,y(o.pendingYield>0&&o.pendingYield<.01?"<$0.01":`$${p(de)(o.pendingYield,2)}`),1)]),D(ke,{"my-claim-list":o.myClaimList},null,8,["my-claim-list"]),e("div",{class:"choose-amount",onClick:_[0]||(_[0]=i=>k.$emit("chooseAmount"))},os),D(w,{class:"confirm-btn",loading:p(H),onClick:_[1]||(_[1]=i=>p(Xe)(o.myClaimPositionList))},{default:j(()=>[M("Confirm")]),_:1},8,["loading"])])]),_:1})}}});const is=W(ns,[["__scopeId","data-v-8e7a4ef5"]]),Ne=o=>(se("data-v-4237fa3c"),o=o(),te(),o),ds={class:"fees-and-reward"},us={key:0,class:"fees"},cs={class:"fees-title"},rs=Ne(()=>e("div",null,"Fees",-1)),vs={alt:""},_s={class:"symbol"},ms={class:"amount"},fs={class:"amount-usd"},ps={key:1,class:"fees"},hs={class:"fees-title"},ws=Ne(()=>e("div",null,"Mining rewards",-1)),gs={alt:""},ys={class:"symbol"},Ss={class:"amount"},ks={class:"amount-usd"},bs=V({__name:"fees-and-reward",props:{pendingRewarderList:{type:Object,default:()=>[]},pendingFeesList:{type:Object,default:()=>[]},rewarderUsd:{type:String,default:""},feeOwedUsd:{type:String,default:""}},setup(o){return(k,_)=>{const w=ge("image");return u(),v("div",ds,[o.feeOwedUsd&&o.feeOwedUsd>0?(u(),v("div",us,[e("div",cs,[rs,e("div",null,y(p(L)(o.feeOwedUsd,2,!1,!1)),1)]),(u(!0),v(I,null,ee(o.pendingFeesList,i=>(u(),v("div",{key:i,class:"fees-details"},[e("div",null,[ne(e("img",vs,null,512),[[w,i.logo_url]]),e("span",_s,y(i.symbol),1)]),e("div",null,[e("span",ms,y(p(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",fs,"("+y(p(L)(i.amountUSD,2,!1,!1))+")",1)])]))),128))])):T("",!0),o.rewarderUsd&&o.rewarderUsd>0?(u(),v("div",ps,[e("div",hs,[ws,e("div",null,y(p(L)(o.rewarderUsd,2,!1,!1)),1)]),(u(!0),v(I,null,ee(o.pendingRewarderList,i=>(u(),v("div",{key:i,class:"fees-details"},[e("div",null,[ne(e("img",gs,null,512),[[w,i.logo_url]]),e("span",ys,y(i.symbol),1)]),e("div",null,[e("span",Ss,y(p(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",ks,"("+y(p(L)(i.amountUSD,2,!1,!1))+")",1)])]))),128))])):T("",!0)])}}});const $s=W(bs,[["__scopeId","data-v-4237fa3c"]]),K=o=>(se("data-v-5c834a7c"),o=o(),te(),o),Ns={class:"yield-details-box"},Us={class:"yield-details"},Cs={class:"total-claim"},Ds=K(()=>e("div",null,"Pending Yield",-1)),Ls={class:"total-claim-usd"},Rs={class:"position-detail"},xs={class:"position-detail-top"},Os=K(()=>e("div",{class:"left"},"Position",-1)),Ys={class:"right"},As=K(()=>e("span",null,"Hide yield < ",-1)),Ps={class:"position-detail-bottom"},Ts={class:"left"},js={class:"top"},Es=["onClick"],Bs={key:0,src:Se},Fs={class:"bottom"},qs={class:"right"},Hs={key:0,class:"yield-amount"},zs={key:1,class:"yield-amount-zero"},Ms={class:"select"},Vs={class:"all"},Ws=K(()=>e("span",null,"Select all",-1)),Ks={class:"amount-selected"},Zs=K(()=>e("div",null,"Amount selected",-1)),Gs=V({__name:"yield-details",props:{positionShowList:{type:Object,default:()=>[]},isShowYiedlDetails:{type:Boolean,default:!1}},emits:["showClaimYiedl"],setup(o,{emit:k}){const _=h(!0),w=h(!0),i=k,C=o,c=h(.01),Y=h(),U=h([]),ae=ce(),x=$(()=>ae),N=$(()=>x.value.rewarderObj),O=$(()=>x.value.feeOwedObj),g=h([]),b=h("all"),B=h([]),Z=l=>{const a=[];g.value=[];let s=new r(0);const t=[];l.forEach(d=>{var A,P,ve,_e,me,fe;const f=((A=N.value[d.tokenName])==null?void 0:A.pendingRewarder)||0,n=((P=O.value[d.tokenName])==null?void 0:P.feeOwed)||0,R=new r(isNaN(f)?0:f).add(new r(isNaN(n)?0:n)).toString();s=s.add(new r(isNaN(f)?0:f)).add(new r(isNaN(n)?0:n)),Number(R)>0&&t.push(d),_.value&&Number(R)>Number(c.value)&&a.push({...d,totalRewardUsd:R,pendingRewarderList:(ve=N.value[d.tokenName])==null?void 0:ve.pendingRewarderArr,pendingFeesList:(_e=O.value[d.tokenName])==null?void 0:_e.feesResult,rewarderUsd:f,feeOwedUsd:n}),_.value||a.push({...d,totalRewardUsd:R,pendingRewarderList:(me=N.value[d.tokenName])==null?void 0:me.pendingRewarderArr,pendingFeesList:(fe=O.value[d.tokenName])==null?void 0:fe.feesResult,rewarderUsd:f,feeOwedUsd:n})}),B.value=t,a.forEach(d=>{d.totalRewardUsd>0&&g.value.push(d.tokenName)}),_.value?g.value.length!==a.length?b.value="":b.value="all":g.value.length!==t.length?b.value="":b.value="all",w.value=!1,Y.value=s,U.value=a.sort((d,f)=>f.totalRewardUsd-d.totalRewardUsd)},le=$(()=>x.value.getPendingFeeSuccess),G=$(()=>x.value.getRewardSuccess);ie(()=>[C.positionShowList,c.value,le.value,G.value,_.value],([l,a,s,t])=>{l&&l.length>0&&s&&t&&Z(l)},{immediate:!0});const J=l=>{const a=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,4})?).*$");l.target.value=l.target.value.replace(a,"$1"),c.value=l.target.value},oe=()=>{(!c.value||c.value<.01)&&(c.value=.01)},F=l=>{const a=l.tokenName,s=g.value.indexOf(a);s>-1?g.value.splice(s,1):g.value.push(a),_.value?g.value.length!==U.value.length?b.value="":b.value="all":g.value.length!==B.value.length?b.value="":b.value="all"},q=()=>{b.value="all",U.value.forEach(l=>{!g.value.includes(l.tokenName)&&l.totalRewardUsd>0&&g.value.push(l.tokenName)})},S=$(()=>{let l=new r(0);return b.value=="all"?U.value.forEach(a=>{var d,f;const s=((d=N.value[a.tokenName])==null?void 0:d.pendingRewarder)||0,t=((f=O.value[a.tokenName])==null?void 0:f.feeOwed)||0;l=l.add(new r(isNaN(s)?0:s)).add(new r(isNaN(t)?0:t))}):g.value.forEach(a=>{var d,f;const s=((d=N.value[a])==null?void 0:d.pendingRewarder)||0,t=((f=O.value[a])==null?void 0:f.feeOwed)||0;l=l.add(new r(isNaN(s)?0:s)).add(new r(isNaN(t)?0:t))}),l.toString()}),m=()=>{const l=[];U.value.forEach(a=>{g.value.includes(a.tokenName)&&l.push(a)}),i("showClaimYiedl",l)};return(l,a)=>{const s=Le,t=Re,d=xe,f=ue;return u(),z(p(ye),{title:"Details",footer:null,visible:o.isShowYiedlDetails,width:"440px","wrap-class-name":"details-modal",onCancel:a[2]||(a[2]=n=>l.$emit("close"))},{default:j(()=>[e("div",Ns,[e("div",Us,[e("div",Cs,[Ds,e("div",Ls,[e("span",null,y(p(L)(Y.value,2,!1,!1)),1)])]),e("div",Rs,[e("div",xs,[Os,e("div",Ys,[D(s,{class:"range-alerts-switch",checked:_.value,onClick:a[0]||(a[0]=()=>{_.value=!_.value,w.value=!1})},null,8,["checked"]),As,D(t,{value:`$${c.value}`,onChange:J,onBlur:oe},null,8,["value"])])]),e("div",Ps,[U.value&&U.value.length>0?(u(!0),v(I,{key:0},ee(U.value,n=>(u(),v("div",{key:n,class:"position-item"},[e("div",Ts,[e("div",js,[e("div",{class:Ce(["radio",n.totalRewardUsd<=0?"radio-disable":""]),onClick:R=>n.totalRewardUsd>0?F(n):""},[(b.value=="all"||g.value.includes(n.tokenName))&&n.totalRewardUsd>0?(u(),v("img",Bs)):T("",!0)],10,Es),D(Ee,{"from-coin":n.needReverse?n.token_b:n.token_a,"to-coin":n.needReverse?n.token_a:n.token_b,"fee-tier":n.fee*1e3},null,8,["from-coin","to-coin","fee-tier"])]),e("div",Fs,y(n.tokenName),1)]),e("div",qs,[n.totalRewardUsd>0?(u(),v("div",Hs,[D(d,{placement:"bottomRight","overlay-class-name":"yield-amount-tooltip"},{title:j(()=>[D($s,{"pending-fees-list":n.pendingFeesList,"pending-rewarder-list":n.pendingRewarderList,"rewarder-usd":n.rewarderUsd,"fee-owed-usd":n.feeOwedUsd},null,8,["pending-fees-list","pending-rewarder-list","rewarder-usd","fee-owed-usd"])]),default:j(()=>[M(y(p(L)(n.totalRewardUsd,2,!1,!1))+" ",1)]),_:2},1024)])):(u(),v("div",zs,y(p(L)(n.totalRewardUsd,2,!1,!1)),1))])]))),128)):(u(),z(Be,{key:1,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found"}))])])]),e("div",Ms,[e("div",Vs,[e("div",{class:"radio",onClick:q},[b.value=="all"?(u(),v("img",{key:0,src:Se,onClick:a[1]||(a[1]=De(()=>{g.value=[],b.value=""},["stop"]))})):T("",!0)]),Ws]),e("div",Ks,[Zs,e("div",null,y(p(L)(S.value,2,!1,!1)),1)])]),D(f,{class:"claim-yield-btn",disabled:S.value=="0",onClick:m},{default:j(()=>[M("Claim Yield")]),_:1},8,["disabled"])])]),_:1},8,["visible"])}}});const Js=W(Gs,[["__scopeId","data-v-5c834a7c"]]),Ue=o=>(se("data-v-0d9399b3"),o=o(),te(),o),Qs={class:"total-info"},Xs={class:"total-liquidity"},Is=Ue(()=>e("span",null,"Total Liquidity",-1)),et={key:0,class:"skeleton-box"},st={key:1,class:"total-liquidity-usd"},tt={class:"pending-yield"},at=Ue(()=>e("div",null,"Pending Yield",-1)),lt={key:0,class:"skeleton-box"},ot={key:1},nt={key:0,class:"claim-list-box"},it={class:"claim-list-content"},dt=V({__name:"total-position",setup(o){const k=h(!1),_=ce(),w=$(()=>_),i=$(()=>w.value.rewarderObj),C=$(()=>w.value.feeOwedObj),c=$(()=>w.value.positionShowList),Y=$(()=>w.value.myPositionsLoading),U=$(()=>w.value.getPendingFeeSuccess),ae=$(()=>w.value.getRewardSuccess),x=h(0),N=h(0),O=h(!0),g=h([]),b=h([]),B=h([]),Z=S=>{let m=new r(0);const l=[];S.forEach(a=>{m=m.add(new r(isNaN(a.amountUSD)?0:a.amountUSD)),l.push(a.tokenName)}),g.value=l,x.value=m.toNumber()},le=(S,m)=>{let l=new r(0);const a=[];g.value.forEach(t=>{var n,R,A,P;const d=((n=S[t])==null?void 0:n.pendingRewarder)||0,f=((R=m[t])==null?void 0:R.feeOwed)||0;l=l.add(new r(isNaN(d)?0:d)).add(new r(isNaN(f)?0:f)),(A=S[t])!=null&&A.pendingRewarderArr&&a.push(...S[t].pendingRewarderArr),(P=m[t])!=null&&P.feesResult&&a.push(...m[t].feesResult)});const s={};a.forEach(t=>{s[t.address]?s[t.address]={...t,amountUSD:new r(s[t.address].amountUSD).add(isNaN(t.amountUSD)?0:t.amountUSD).toString(),amount:new r(s[t.address].amount).add(isNaN(t.amountUSD)?0:t.amountUSD).toString()}:(s[t.address]={},s[t.address]={...t,amountUSD:new r(0).add(isNaN(t.amountUSD)?0:t.amountUSD).toString(),amount:new r(0).add(t.amount).toString()})}),B.value=Object.values(s).filter(t=>t.amount>0).sort((t,d)=>d.amountUSD-t.amountUSD),N.value=l.toNumber(),O.value=!1};ie(()=>c.value,S=>{S&&S.length>0?Z(S):Z([])},{immediate:!0}),ie(()=>[U.value,ae.value,g.value,i.value,C.value],([S,m,l,a,s])=>{S&&m?le(a,s):O.value=!0},{immediate:!0,deep:!0});const G=h(),J=h(),oe=S=>{k.value=!1,E.value=!0;let m=new r(0);const l=[],a={};S.forEach(s=>{var n,R,A,P;const t=s.tokenName,d=((n=i.value[t])==null?void 0:n.pendingRewarder)||0,f=((R=C.value[t])==null?void 0:R.feeOwed)||0;m=m.add(new r(d)).add(new r(f)),(A=i.value[t])!=null&&A.pendingRewarderArr&&l.push(...i.value[t].pendingRewarderArr),(P=C.value[t])!=null&&P.feesResult&&l.push(...C.value[t].feesResult)}),l.forEach(s=>{a[s.address]?a[s.address]={...s,amountUSD:new r(a[s.address].amountUSD).add(isNaN(s.amountUSD)?0:s.amountUSD).toString(),amount:new r(a[s.address].amount).add(isNaN(s.amountUSD)?0:s.amountUSD).toString()}:(a[s.address]={},a[s.address]={...s,amountUSD:new r(0).add(isNaN(s.amountUSD)?0:s.amountUSD).toString(),amount:new r(0).add(s.amount).toString()})}),G.value=m.toNumber(),b.value=Object.values(a).filter(s=>s.amount>0).sort((s,t)=>t.amountUSD-s.amountUSD),J.value=S},F=h(1),q=()=>{N.value>0&&(k.value=!0,F.value=F.value==1?2:1)};return(S,m)=>{const l=Ye,a=ue;return u(),v("div",Qs,[e("div",Xs,[Is,!x.value&&Y.value?(u(),v("div",et,[D(l,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(u(),v("span",st,y(x.value>0&&x.value<.01?"<$0.01":`$${p(de)(x.value,2)}`),1))]),e("div",tt,[at,O.value?(u(),v("div",lt,[D(l,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(u(),v("div",ot,[e("span",{class:"pending-yield-usd",style:Oe(N.value<=0?{border:"none"}:{}),onClick:q},[M(y(N.value>0&&N.value<.01?"<$0.01":`$${p(de)(N.value,2)}`)+" ",1),N.value>0?(u(),v("div",nt,[e("div",it,[D(ke,{"my-claim-list":B.value},null,8,["my-claim-list"])])])):T("",!0)],4),N.value>0?(u(),v("img",{key:0,src:Fe,alt:"",onClick:q})):T("",!0),D(a,{class:"claim-all-btn",disabled:N.value<=0,loading:p(H),onClick:q},{default:j(()=>[M("Claim All")]),_:1},8,["disabled","loading"])]))]),p(E)?(u(),z(is,{key:0,"pending-yield":G.value,"my-claim-list":b.value,"my-claim-position-list":J.value,onClose:m[0]||(m[0]=s=>E.value=!1),onChooseAmount:m[1]||(m[1]=()=>{E.value=!1,k.value=!0})},null,8,["pending-yield","my-claim-list","my-claim-position-list"])):T("",!0),(u(),z(Js,{key:F.value,"position-show-list":c.value,"is-show-yiedl-details":k.value,onClose:m[2]||(m[2]=()=>{k.value=!1}),onShowClaimYiedl:oe},null,8,["position-show-list","is-show-yiedl-details"]))])}}});const yt=W(dt,[["__scopeId","data-v-0d9399b3"]]);export{yt as T};
