import{_ as de}from"./upgrade-loading.9c37e05e.js";import{_ as me}from"./upgrade-position-item.ad077e0d.js";import{a as pe,r as b,z as ve,b as ge,m as f,A as P,q as he,s as fe,t as be,V as _e,e as ye,l as K,o as n,f as r,h as p,c as Z,G as k,F as I,E as F,i as M,D as H,x as A,y as Q,j as X,w as ke,B as Se,p as Le,k as we}from"./entry.a85dcc8c.js";import{u as Ae,a as Te}from"./index.a6e74e8d.js";import{u as Pe}from"./notifi.5d045922.js";import{c as Oe}from"./common.58ad47a8.js";import{u as Ue,c as $e}from"./index.d5fbf89e.js";import{i as Y}from"./import-icon.de3e6c66.js";import{T as Ce}from"./total-position.b3375f24.js";import{_ as x}from"./icon_on_2x.5e96733d.js";import{_ as Re}from"./img-no-Positions_2x.eced461a.js";import{_ as Be}from"./img-no-Positions_2x.02902d06.js";import{_ as Ne}from"./img-connect-wallet_2x.790f2d0b.js";import{_ as De}from"./img-connect-wallet_2x.9c7563c2.js";/* empty css              */import"./index.de9b153c.js";import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.8dcecb18.js";/* empty css              */import"./farms-valid-range.3ea04fa4.js";import"./decimal.a2826370.js";import"./decimal.765d8738.js";import"./farms.577ce3d0.js";import"./icon_farms_2x.d5277acc.js";import"./icon_rewards_2x.83ce9103.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./farms.a4bc0bb7.js";import"./useWhale.89ed8e6f.js";/* empty css              *//* empty css              */import"./coin-pair-name.a8fe150f.js";import"./token-warning.54d6df24.js";import"./no-data.3e3337ec.js";const Ee=pe({components:{TotalPosition:Ce},setup(){const o=b(!1),{t:d}=ve(),W=b(["position"]),O=ge(),q=b(""),R=Ae(),v=f(()=>R),G=f(()=>v.value.chainName?$e[v.value.chainName]:{});let m=b([]);const g=Te(),a=f(()=>g),u=Ue(),c=f(()=>u),U=b(!1),$=b(d("tab.all")),j=b([d("tab.layerZero"),d("tab.wormhole"),d("tab.celer")]),B=b(!0),oe=b("TVL"),z=()=>{o.value=!0,m.value=[],c.value.address&&(g.setPools(V.value.poolConfigList,v.value.chainName),g.getMyPositons(c.value.address,a.value.poolsObj,v.value.chainName)),setTimeout(()=>{o.value=!1},1e3)},se=f(()=>{const s=Array.from(new Set(a.value.poolConfigList.flatMap(e=>!(e!=null&&e.category)||(e==null?void 0:e.category)==""?"All":e==null?void 0:e.category)));return console.log(s,"newArr"),s.length<=1?[]:s}),te=s=>{a.value.setCurrentPoolTab(s)};P(()=>v.value.isRefresh,s=>{var e,t,l,i;s&&((i=(l=(t=(e=O==null?void 0:O.currentRoute)==null?void 0:e.value)==null?void 0:t.name)==null?void 0:l.split("-"))==null?void 0:i[1])=="position"&&z()}),he(()=>{m.value=[],document.addEventListener("click",()=>{U.value=!1}),g.setMyPositionsLoading(!0)}),fe(()=>{document.addEventListener("click",()=>{U.value=!1})}),be(()=>{c.value.connected||(m.value=[])});const J=()=>{o.value=!0;let s=[];a.value.myPositions.forEach(e=>{var T,N,D,E;v.value.addressLpTokens[e.address];let t=e.positionSource=="farming",l,i;const h=e.amountA*((T=a.value.RATES[e.token_a.address])==null?void 0:T.price),_=e.amountB*((N=a.value.RATES[e.token_b.address])==null?void 0:N.price);(D=a.value.RATES[e.token_a.address])!=null&&D.price&&((E=a.value.RATES[e.token_b.address])!=null&&E.price)?(l=h+_,i=h+_):(l=" --",i=0),console.log(a.value.currentPoolTab,"##pools.value.currentPoolTab"),(a.value.currentPoolTab=="All"||a.value.currentPoolTab!=="All"&&e.category==a.value.currentPoolTab)&&s.push({...e,amountUSD:l,amountUSDOrigin:i,tokenARates:h,tokenBRates:_,isStableFarming:t})}),$.value!="All"?B.value?(m.value=s.sort((e,t)=>Number(t.amountUSDOrigin)-Number(e.amountUSDOrigin)),o.value=!1):(m.value=s.sort((e,t)=>Number(e.amountUSDOrigin)-Number(t.amountUSDOrigin)),o.value=!1):B.value?(m.value=s.sort((e,t)=>t.amountUSDOrigin-e.amountUSDOrigin),o.value=!1):(m.value=s.sort((e,t)=>e.amountUSDOrigin-t.amountUSDOrigin),o.value=!1),console.log(m.value,"list.value========>")};P(()=>[a.value.myPositions,a.value.RATES],([s,e])=>{s&&e&&(console.log("0605==>updateLpList9099999"),J())},{immediate:!0}),P(()=>[c.value.address,a.value.poolConfigList,a.value.poolsObj,v.value.chainName],([s,e,t,l])=>{var i,h,_;s&&e&&e.length>0&&l&&(l!=null&&l.toLowerCase().includes((i=e[0])==null?void 0:i.chain))&&!Oe(t)&&(l==="Aptos"?e.length===Object.values(t).length:(_=(h=Object.values(t)[0])==null?void 0:h.chain)!=null&&_.includes("sui"))&&(console.log(t,e,"0605==>getMyPositons9099999"),g.getMyPositons(c.value.address,t,l))},{immediate:!0,deep:!0}),P(()=>c.value.address,s=>{s||g.setMyPositions()},{immediate:!0}),P(()=>[$.value,B.value,a.value.currentPoolTab],([s])=>{J()});const ae=s=>{const e=[];j.value.forEach((t,l)=>{t==s?e[l]=$.value:e[l]=t}),j.value=e,$.value=s},C=Pe(),y=f(()=>C),V=f(()=>g),le=async s=>{await C.getSourceGroups();const e=y.value.sourceGroups&&y.value.sourceGroups.length>0&&y.value.sourceGroups[0]&&y.value.sourceGroups[0].sources||[];console.log(e,"####source"),console.log(s,"###myPositions");for(let t=0;t<e.length;t++){const{pool_address:l,position_index:i}=JSON.parse(e[t].blockchainAddress);let h=!1,_;for(let T=0;T<s.length;T++){const{poolAddress:N,index:D,positionSource:E,name:ce}=s[T];l==N&&Number(E=="clmm"?D:ce.split("-")[1])==Number(i)&&(h=!0),_={pool_address:l,position_index:i}}h||await C.subscribePosition(_,"",!1,!1)}},ne=async()=>{await C.getSourceGroups();const s=y.value.sourceGroups&&y.value.sourceGroups.length>0&&y.value.sourceGroups[0]&&y.value.sourceGroups[0].sources||[];for(let e=0;e<s.length;e++){const{pool_address:t,position_index:l}=JSON.parse(s[e].blockchainAddress),{name:i}=s[e],h={pool_address:t,position_index:l};await C.subscribePosition(h,i,!1,!1)}},re=f(()=>V.value.myPositionsLoading);P(()=>V.value.myPositions,(s,e)=>{G.value.hasNotifi&&(s&&s.length>0&&e&&e.length!==s.length?le(s):s&&s.length==0&&!re.value&&ne())},{immediate:!0});const ie=s=>{var e;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((e=a.value.tokensObj[s==null?void 0:s.address])==null?void 0:e.logo_url)||(v.value.theme==="default"?Y("/image/coins/unknown.png"):Y("/image/coins/sui-unknown.png"))},S=b(null),L=f(()=>S.value&&S.value.firstToken?S.value.firstToken:null),w=f(()=>S.value&&S.value.lastToken?S.value.lastToken:null),ue=f(()=>{let s=[];s=m.value;const e=s.filter((t,l)=>L.value&&w.value?t.coinA.symbol==L.value.symbol&&t.coinB.symbol==w.value.symbol||t.coinA.symbol==w.value.symbol&&t.coinB.symbol==L.value.symbol:L.value?t.coinA.symbol.toLowerCase().includes(L.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(L.value.symbol.toLowerCase()):w.value?t.coinA.symbol.toLowerCase().includes(w.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(w.value.symbol.toLowerCase()):s);return a.value.myPositionsLoading||(R.setPositiomAmount(e.length),g.setPositionShowList(e)),e});return _e(()=>{R.setPositiomAmount("--"),g.setPositionShowList([])}),{tabArr:se,changeTab:te,showList:ue,childTokenSelectRef:S,firstToken:L,lastToken:w,getCoinIcon:ie,changeSortLabel:ae,label:U,labelList:j,labelValue:$,select:B,selectValue:oe,t:d,pools:a,store:v,wallet:c,list:m,clickRefresh:z,refresh:o,current:W,router:O,searchKey:q}}});const ee=o=>(Le("data-v-07d43f93"),o=o(),we(),o),Ge={class:"upgrade-position-list-container"},je={class:"position-card-top"},Ve={class:"content-top"},Ie={class:"content-top-left"},Fe={key:0,class:"tag-list"},Me=["onClick"],We={class:"content-top-right"},qe={class:"value"},ze=ee(()=>p("use",{"xlink:href":"#icon-icon_on"},null,-1)),Je=[ze],Ke={key:0,class:"select-item"},Ze=["onClick"],He={class:"search-select-box"},Qe=ee(()=>p("span",null,"TVL",-1)),Xe={key:0,src:x,alt:""},Ye={key:1,class:"fan-img",src:x,alt:""},xe={key:0,class:"upgrade-loading"},eo={key:1,class:"position-list"},oo={key:2,class:"no-data"},so={key:0,src:Re,alt:""},to={key:1,src:Be,alt:""},ao={key:3,class:"no-data"},lo={key:0,src:Ne,alt:""},no={key:1,src:De,alt:""};function ro(o,d,W,O,q,R){const v=K("TotalPosition"),G=K("UpgradeSelectInput"),m=de,g=me,a=Se;return n(),r("div",Ge,[p("div",je,[o.wallet&&o.wallet.address?(n(),Z(v,{key:0})):k("",!0),p("div",Ve,[p("div",Ie,[o.tabArr.length>1?(n(),r("div",Fe,[(n(!0),r(I,null,F(o.tabArr,(u,c)=>(n(),r("div",{key:c,class:Q(["tag-item",u==o.pools.currentPoolTab?`tag-active tab-num-${o.tabArr.length}`:`tab-num-${o.tabArr.length}`]),onClick:U=>o.changeTab(u)},A(u),11,Me))),128))])):k("",!0),M(G,{ref:"childTokenSelectRef"},null,512)]),p("div",We,[o.store.theme=="default"?(n(),r("div",{key:0,class:"search-label",onClick:d[0]||(d[0]=H(u=>o.label=!o.label,["stop"]))},[p("span",null,A(o.$t("newAdd.label")),1),p("div",qe,A(o.labelValue),1),(n(),r("svg",{"aria-hidden":"true",class:Q(o.label?"show-icon icon":"icon")},Je,2)),o.label?(n(),r("div",Ke,[(n(!0),r(I,null,F(o.labelList,(u,c)=>(n(),r("div",{key:c,class:"select-menu-item",onClick:U=>o.changeSortLabel(u)},A(u),9,Ze))),128))])):k("",!0)])):k("",!0),p("div",He,[p("div",{class:"search-select",onClick:d[1]||(d[1]=H(u=>o.select=!o.select,["stop"]))},[X(A(o.$t("newAdd.sortBy"))+" ",1),p("div",null,[Qe,o.select?(n(),r("img",Xe)):(n(),r("img",Ye))])])])])])]),o.pools.myPositionsLoading&&o.wallet.connected?(n(),r("div",xe,[M(m,{loading:o.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):k("",!0),o.showList&&o.showList.length>0&&o.wallet.connected&&!o.pools.myPositionsLoading?(n(),r("div",eo,[(n(!0),r(I,null,F(o.showList,(u,c)=>(n(),Z(g,{key:c,"p-item":u},null,8,["p-item"]))),128))])):k("",!0),o.showList&&o.showList.length<=0&&!o.pools.myPositionsLoading&&o.wallet.connected?(n(),r("div",oo,[o.store.theme=="default"?(n(),r("img",so)):(n(),r("img",to)),p("span",null,A(o.$t("common.noLiquidityPositions")),1)])):k("",!0),o.wallet.connected?k("",!0):(n(),r("div",ao,[o.store.theme=="default"?(n(),r("img",lo)):(n(),r("img",no)),M(a,{class:"connect-wallet",onClick:d[2]||(d[2]=u=>o.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[X(A(o.$t("button.connectWallet")),1)]),_:1})]))])}const Wo=ye(Ee,[["render",ro],["__scopeId","data-v-07d43f93"]]);export{Wo as default};
