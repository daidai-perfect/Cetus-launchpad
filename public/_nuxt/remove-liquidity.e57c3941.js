import{_ as Ro}from"./back.830ea923.js";import{_ as To}from"./coin-pair-name.bc19910b.js";import{_ as Bo}from"./status-block.6e59db33.js";import{_ as qo}from"./network-tips.301ee476.js";import{_ as Po}from"./swap-setting.ae29007a.js";import{a as Lo,L as Uo,r as l,F as Do,v as T,N as Oo,G as jo,ai as Vo,z as Eo,w as j,s as Mo,aJ as Wo,ag as V,ah as to,H as m,i as Fo,W as fo,aK as Xo,R as ao,A as ho,k as _o,Y as E,b as zo,o as g,e as A,l as N,f as e,t as s,q as lo,c as Io,h as uo,a1 as bo,a2 as ko,y as S,m as Go,C as Ho,E as Jo,I as Ko,aL as Yo,B as Qo,p as Zo,j as xo,a5 as oe}from"./entry.a22eafe0.js";const ee=Lo({setup(){const{t:o,locale:v}=Uo();let ro=l(!1),q=l(!1);const M=l(!1),co=()=>{Y(),M.value=!0,setTimeout(()=>{M.value=!1},1e3)},x=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],oo=Do(),W=l(""),F=l(""),X=l(""),z=l(""),G=l(""),H=l(""),J=l(""),a=l(""),i=T(()=>oo),u=l({}),r=l({}),n=l(i.value.currentPositionInfo||{}),go=Oo(),K=T(()=>go),P=jo();Vo(()=>{K.value.connected||P.push("/position")});const C=Eo(),Y=async()=>{i.value.setCurrentPositionLoading(!0);const t=P.currentRoute.value.query.token||"",f=P.currentRoute.value.query.collect||"";t&&f&&(W.value=f,F.value=P.currentRoute.value.query.address,X.value=t,i.value.setCurrentPositionInfo(F.value,W.value,X.value),n.value=i.value.currentPositionInfo)};j(()=>i.value.addressLpTokens,t=>{E(t)||Y()},{immediate:!0}),j(()=>i.value.currentPositionInfo,t=>{t&&(n.value=i.value.currentPositionInfo,u.value=n.value.token_a,r.value=n.value.token_b,io({value:b.value/100}),console.log(n.value,"  positionInfo.valuepositionInfo.value"))});const b=l(50),d=l(0),p=l(0),eo=l(0),so=Mo(),wo=T(()=>so),no=T(()=>so.slippage);j(b,Wo((t,f)=>{Number(t)>100?b.value=100:t&&n.value&&(b.value=t,io({value:b.value/100}))},300)),j(no,t=>{t&&n.value&&io({value:b.value/100})});const io=t=>{const f=n.value.token_a.decimals,k=n.value.token_b.decimals,y=n.value.tick_lower_index,c=n.value.tick_upper_index,_=fo.tickIndexToSqrtPriceX64(y),U=fo.tickIndexToSqrtPriceX64(c);eo.value=n.value.liquidity*Number(t.value);const I=Xo.getCoinAmountFromLiquidity(new ao(eo.value),new ao(n.value.current_sqrt_price),_,U,!0),w=Number(I.coinA.toString())/Math.pow(10,f),$=Number(I.coinB.toString())/Math.pow(10,k);console.log(w,$,"amountA121212"),d.value=w,p.value=$;const h=i.value.RATES[i.value.newTokenObj[n.value.token_a.address].name.toUpperCase()].price,D=i.value.RATES[i.value.newTokenObj[n.value.token_b.address].name.toUpperCase()].price;console.log(d.value,h,"fromCoinAmount.value"),z.value=Number(d.value*h)<.01?"<0.01":m(d.value*h,2),G.value=Number(p.value*D)<.01?"<0.01":m(p.value*D,2);const O=to.minus(Number(n.value.amountA),Number(d.value))*h;H.value=Number(O)<.01?"<0.01":m(O,2);const R=to.minus(Number(n.value.amountB),Number(p.value))*D;J.value=Number(R)<.01?"<0.01":m(R,2);const Z=Number(ho(O,2))+Number(ho(R,2));a.value=Number(Z)<.01?"<0.01":m(Z,2)},{setIsShowSuccess:yo,setIsShowRejected:mo,setIsShowWaiting:Q,setTransactionDesc:Ao,setTransactionTxid:vo,setPositiomNum:ns}=so,No=async()=>{var t,f,k,y;q.value=!0,vo(""),Ao(o("tips.removeLiquidiyText",{from:m(d.value,u.value.decimals)==0?"":`${V(d.value,u.value.decimals)} ${u.value.symbol}`,and:m(d.value,u.value.decimals)==0||m(p.value,r.value.decimals)==0?"":"and",to:m(p.value,r.value.decimals)==0?"":`${V(p.value,r.value.decimals)} ${r.value.symbol}`})),Q(!0);try{let c={};c={pool:{...n.value.poolInfo,coinA:n.value.token_a,coinB:n.value.token_b},coinTypeA:n.value.poolInfo.coinTypeA,coinTypeB:n.value.poolInfo.coinTypeB,position:n.value,delta_liquidity:new ao(_o(eo.value,0)),slippage:Number(no.value),rewards_num:L.value.length};const _=L.value;console.log(L,"===>pendingRewarderArr"),c.coinTypeC=_[0]?_[0].coin_address:"",c.coinTypeD=_[1]?_[1].coin_address:"",c.coinTypeE=_[2]?_[2].coin_address:"",console.log(c,"===>params");const U=await C.getRemoveLiquidityTransactionPayload(c);let I;if(I=await K.value.currentWallet.signAndSubmitTransaction(U),I&&I.hash){vo(I.hash),Q(!1),yo(!0);const w={title:o("common.removeLiquidity"),desc:o("tips.removeSuccessText",{from:m(d.value,u.value.decimals)==0?"":`${V(d.value,u.value.decimals)} ${u.value.symbol}`,and:m(d.value,u.value.decimals)==0||m(p.value,r.value.decimals)==0?"":"and",to:m(p.value,r.value.decimals)==0?"":`${V(p.value,r.value.decimals)} ${r.value.symbol}`}),hash:I.hash,descTransactions:`Remove ${d.value} ${(t=u.value)==null?void 0:t.symbol} and ${p.value} ${(f=r.value)==null?void 0:f.symbol} 
             from the pool`,sender:K.value.address,chainName:wo.value.chainName,tit:`${b.value==100?"Closed":"Modified"} Position: ${n.value.poolInfo.symbol}`,text:`Withdraw ${d.value} ${(k=u.value)==null?void 0:k.symbol} and ${p.value} ${(y=r.value)==null?void 0:y.symbol}`};C.showTransitionPending(w),await C.watchTransaction(w)&&(setTimeout(()=>{Y()},3e3),setTimeout(()=>{Y()},6e3),Number(b.value)==100&&P.push("/position"))}else Q(!1),mo(!0);q.value=!1}catch(c){console.log("Remove error",c),q.value=!1,Q(!1),mo(!0)}},So=T(()=>i.value.tokensObj&&u.value.address&&i.value.tokensObj[u.value.address]&&i.value.tokensObj[u.value.address].logoURI),Co=T(()=>i.value.tokensObj&&r.value.address&&i.value.tokensObj[r.value.address]&&i.value.tokensObj[r.value.address].logoURI),$o=l(0),L=l([]);return j(()=>[n.value,i.value.addressLpTokens,i.value.newTokenObj,i.value.RATES],async([t,f,k,y])=>{if(!E(t)&&!E(f)&&!E(k)&&!E(y)){const c=f[t.poolAddress];console.log(c,"===>pool");const _=await C.getTickDataByIndex(c.ticks_handle,Number(t.tick_lower_index)),U=await C.getTickDataByIndex(c.ticks_handle,Number(t.tick_upper_index)),I=await C.getPosRewardersAmount({poolAddress:t.poolAddress,positionName:t.tokenName,tickLowerData:_,tickUpperData:U}),w=[];let $=0;I.forEach(h=>{const D=k[h.coin_address].decimals,O=k[h.coin_address];console.log(h.amount_owed.toString(),"===>element.amount_owed.toString()");const R=Number(h.amount_owed.toString())/Math.pow(10,D),Z=y[k[h.coin_address].name.toUpperCase()].price,po=R*Z;$+=po,w.push({...h,...O,amount:R,amountUSD:po})}),L.value=w,$o.value=Number(_o($,2))}},{immediate:!0}),{removeAmountARates:H,removeAmountBRates:J,removeAmountRates:a,receiveAmountARates:z,receiveAmountBRates:G,showNum:V,fromCoinUrl:So,toCoinUrl:Co,precision:to,addCommom:m,loading:q,wallet:K,toRemove:No,fromCoinAmount:d,toCoinAmount:p,pools:i,refresh:M,amountArr:x,sliderVal:b,positionInfo:n,slippage:no,importIcon:Fo,clickRefresh:co,isShowSwapSetting:ro,pendingRewarderArr:L}}});const B=o=>(Zo("data-v-37059584"),o=o(),xo(),o),se={class:"remove-liquidity"},ne={class:"remove-liquidity-top"},ie={class:"remove-title"},te={class:"right title-right"},ae=B(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),le=B(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),ue=[le],re={class:"remove-liquidity-center"},de={class:"top"},ce={class:"left"},me={class:"right"},ve={class:"fee"},pe={class:"bottom"},fe={class:"add-amount"},he={class:"add-amount-header"},_e={class:"amount-list"},Ie=["onClick"],be={class:"slider-box"},ke={class:"receive"},ge={class:"receiveTit"},we={class:"item"},ye={class:"left"},Ae=["src"],Ne={class:"right"},Se={class:"item"},Ce={class:"left"},$e=["src"],Re={class:"right"},Te={class:"remove-liquidity-bottom-box"},Be={class:"induction remove-liquidity-bottom"},qe={class:"item"},Pe=B(()=>e("div",{class:"induction-text"},"Fees",-1)),Le={class:"induction-value"},Ue=["src"],De=B(()=>e("div",{class:"induction-text"},null,-1)),Oe={class:"induction-value"},je=["src"],Ve={class:"induction-text"},Ee={class:"induction-value"},Me=["src"],We=B(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Fe={key:0,class:"receive"},Xe={class:"receiveTit"},ze=B(()=>e("div",{class:"left"},"Remaining in Position",-1)),Ge={class:"right"},He={class:"item"},Je={class:"left"},Ke=["src"],Ye={class:"right"},Qe={class:"item"},Ze={class:"left"},xe=["src"],os={class:"right"},es={class:"loading-global"};function ss(o,v,ro,q,M,co){const x=Ro,oo=To,W=Bo,F=Ko,X=Yo,z=Qo,G=qo,H=Po,J=oe;return g(),A("div",se,[N(x),e("div",ne,[e("div",ie,s(o.$t("common.removeLiquidity")),1),e("div",te,[e("div",{class:"slippage-icon",onClick:v[0]||(v[0]=a=>o.isShowSwapSetting=!0)},[ae,e("span",null,s(o.slippage)+"%",1)]),(g(),A("svg",{"aria-hidden":"true",class:lo(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:v[1]||(v[1]=(...a)=>o.clickRefresh&&o.clickRefresh(...a))},ue,2))])]),e("div",re,[e("div",de,[e("div",ce,[o.positionInfo?(g(),Io(oo,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):uo("",!0),e("div",me,[e("div",ve,s(o.positionInfo.fee)+"%",1)])]),N(W,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",pe,[e("div",fe,[e("div",he,[e("span",null,s(o.$t("common.amount")),1),e("div",_e,[(g(!0),A(bo,null,ko(o.amountArr,(a,i)=>(g(),A("div",{key:i,class:lo(["amount-item",o.sliderVal==a.value?"amount-item-active":""]),onClick:u=>o.sliderVal=a.value},s(a.name),11,Ie))),128))])]),e("div",be,[N(F,{value:o.sliderVal,"onUpdate:value":v[2]||(v[2]=a=>o.sliderVal=a),oninpu:"value=value.replace(/[^\\d]/g,'')",suffix:"%"},null,8,["value"]),N(X,{value:o.sliderVal,"onUpdate:value":v[3]||(v[3]=a=>o.sliderVal=a)},null,8,["value"])])])])]),e("div",ke,[e("div",ge,s(o.$t("newAdd.receive")),1),e("div",we,[e("div",ye,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ae),e("span",null,s(o.showNum(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",Ne,"\u2248 $"+s(o.receiveAmountARates),1)]),e("div",Se,[e("div",Ce,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,$e),e("span",null,s(o.showNum(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",Re,"\u2248 $"+s(o.receiveAmountBRates),1)])]),e("div",Te,[e("div",Be,[e("div",qe,[Pe,e("div",Le,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ue),S(" "+s(o.showNum(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" "+s(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:lo(o.pendingRewarderArr.length>0?"item item-boder":"item")},[De,e("div",Oe,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,je),S(" "+s(o.showNum(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" "+s(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),(g(!0),A(bo,null,ko(o.pendingRewarderArr,(a,i)=>(g(),A("div",{class:"item",key:a},[e("div",Ve,s(i==0?"Rewards":""),1),e("div",Ee,[e("img",{src:a.logoURI},null,8,Me),S(" "+s(a.amount>1e-6?a.amount:"<0.000001")+" "+s(a.symbol),1)])]))),128))])]),N(z,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:v[4]||(v[4]=a=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:Go(()=>[We,e("span",null,s(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),N(G),o.sliderVal<100?(g(),A("div",Fe,[e("div",Xe,[ze,e("div",Ge,"$"+s(o.removeAmountRates),1)]),e("div",He,[e("div",Je,[e("img",{src:o.fromCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Ke),e("span",null,s(o.showNum(o.precision.minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)]),e("div",Ye,"\u2248 $"+s(o.removeAmountARates),1)]),e("div",Qe,[e("div",Ze,[e("img",{src:o.toCoinUrl||o.importIcon(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,xe),e("span",null,s(o.showNum(o.precision.minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),S(" "+s(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)]),e("div",os,"\u2248 $"+s(o.removeAmountBRates),1)])])):uo("",!0),o.isShowSwapSetting?(g(),Io(H,{key:1,onOnClose:v[5]||(v[5]=a=>o.isShowSwapSetting=!1)})):uo("",!0),Ho(e("div",es,[N(J)],512),[[Jo,o.pools.currentPositionLoading]])])}const ds=zo(ee,[["render",ss],["__scopeId","data-v-37059584"]]);export{ds as default};
