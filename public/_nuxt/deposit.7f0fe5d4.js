import{_ as $i,a as Ki}from"./farms-auto-stake.6ef26df4.js";import{a as ci,e as di,o as _,f as F,i as re,w as Ze,j as We,h as t,x as $,P as Mi,p as Yi,k as Qi,z as Ri,r as S,m as k,q as Zi,L as Ti,A as ce,s as Oi,C as Vi,I as xi,u as U,G as X,N as eo,F as _i,E as Li,c as Be,y as Ci,Y as io,b as oo,B as ao,O as to}from"./entry.8e75b3ab.js";/* empty css              */import{a as Bi,b as Ui,c as Fi,d as ji,_ as no}from"./new-liquidity-title.85496391.js";import{a as ne,d as ee,c as J,b as yi,s as ro,p as Ii}from"./common.26dbc61a.js";import{i as Pi}from"./import-icon.de3e6c66.js";/* empty css              */import{u as Si,a as Ni,b as Di}from"./index.4ed5b0c4.js";import{T as li,g as so,u as lo,b as ge}from"./index.91fc242d.js";import"./decimal.a2826370.js";import{positionError as He,fromCoin as m,toCoin as c,tickList as Xe,currentPrice as Qe,currentPriceReverse as ui,direction as G,currentPriceTab as T,defaultMinPrice as hi,defaultMaxPrice as wi,minPrice as g,maxPrice as d,toggle as zi,isStableFarmingRange as me,isInputTotalAmount as ke,priceConfigObj as Ue,fromCoinAmount as f,toCoinAmount as p,fixedFromCoin as oe,resetTickList as qi,resetData as uo}from"./data.f10e05c6.js";import{u as Ai}from"./farms.5f4e2bbb.js";import{D as r}from"./decimal.765d8738.js";import{_ as Ei}from"./icon_farms_2x.9af88e3f.js";import{_ as co}from"./coin-lock.1c753790.js";import{_ as vo}from"./coin-select.176463ce.js";import{_ as mo}from"./viewDetail.4497f37a.js";import{_ as fo}from"./new-add-or-create.6aa27fe4.js";import{u as po}from"./notifi.9707cd39.js";import{_ as go,a as bo}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              */import"./transform.c672907f.js";import"./img-lock_2x.a28135f4.js";import"./lock.2bf3b5e4.js";import"./index.abd2f5b0.js";/* empty css              */import"./token-warning.45f58252.js";import"./useDebounceFunction.d68cdc11.js";import"./swap-setting.6504553c.js";import"./icon-error_2x.2c9cbac6.js";import"./img-lock_2x.b9ef127a.js";import"./icon-tooltip.9c059160.js";import"./token-warning_2x.0f0ae6ce.js";import"./img-no-Positions_2x.3896aa04.js";import"./img-no-Positions_2x.adeca125.js";import"./status-block.6e999e97.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./deposit-ratio.f0b9f347.js";import"./useWhale.6c927133.js";const ko=ci({props:{lever:{type:String,default:""}},setup(){return{}}});const Co=e=>(Yi("data-v-f768fa23"),e=e(),Qi(),e),ho={class:"lever"},wo=Co(()=>t("div",{class:"lever-title"},[t("span",null,"Leverage"),t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),_o={class:"lever-text"};function yo(e,l,Ce,se,I,le){const M=Mi;return _(),F("div",ho,[re(M,{"overlay-class-name":"lever-tooltip"},{title:Ze(()=>[We("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Ze(()=>[wo]),_:1}),t("div",_o,$(e.lever),1)])}const Po=di(ko,[["render",yo],["__scopeId","data-v-f768fa23"]]),To=ci({components:{NewLiquidityD3Chart:$i,NewLiquidityPrice:Bi},setup(){const{t:e,locale:l}=Ri(),Ce=S("liquidity"),se=Si(),I=k(()=>se),le=k(()=>I.value.chainName),M=Ni(),N=k(()=>M),w=k(()=>I.value.chainName?Di(I.value.chainName):{});Zi(()=>{He.value=!1});const K=Ti(),a=k(()=>{let i=null;for(let s=0;s<N.value.poolConfigList.length;s++){const b=N.value.poolConfigList[s];b.address==K.query.poolAddress&&(i=b)}return i}),C=k(()=>{let i=null;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:481 ~ constpoolInfo:any=computed ~ pools.value.poolsObj:",N.value.poolsObj);for(const s in N.value.poolsObj){const b=N.value.poolsObj[s];b.address==K.query.poolAddress&&(i=b)}return i}),Y=S(),he=S(!0),Le=async(i,s)=>{var b,h,q,x,ue,Te,De,ze,be,Se,Je,Ke;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:497 ~ watchPoolInfo ~ pool:",i),i&&(m.value=i.needReverse?i.token_b:i.token_a,c.value=i.needReverse?i.token_a:i.token_b),s&&i.current_tick_index){he.value=!0,Xe.value=[],v.value=[],me.value=!1;const Ee=i.token_a.decimals,Ye=i.token_b.decimals;Qe.value=li.sqrtPriceX64ToPrice((i==null?void 0:i.current_sqrt_price)||((b=i==null?void 0:i.object)==null?void 0:b.current_sqrt_price),Ee,Ye).toString(),ui.value=new r(1).div(li.sqrtPriceX64ToPrice((i==null?void 0:i.current_sqrt_price)||((h=i==null?void 0:i.object)==null?void 0:h.current_sqrt_price),Ee,Ye)).toString(),Y.value=i.needReverse,((x=(q=i==null?void 0:i.token_a)==null?void 0:q.address)==null?void 0:x.toLowerCase())===((De=(Te=(ue=m)==null?void 0:ue.value)==null?void 0:Te.address)==null?void 0:De.toLowerCase())&&((be=(ze=i==null?void 0:i.token_b)==null?void 0:ze.address)==null?void 0:be.toLowerCase())===((Ke=(Je=(Se=c)==null?void 0:Se.value)==null?void 0:Je.address)==null?void 0:Ke.toLowerCase())?G.value=!0:G.value=!1;let gi={poolAddress:i.address,coinTypeA:i.coin_a_address,coinTypeB:i.coin_b_address};const{list:ri,address:bi}=await w.value.getTicks(gi);Xe.value=ri&&bi==i.address?w.value.getTickDataFromUrlData(ri):[],i!=null&&i.current_tick_index&&(Fe(i),he.value=!1)}},Q=i=>{var h,q;const s=i.token_a.decimals,b=i.token_b.decimals;Qe.value=li.sqrtPriceX64ToPrice((i==null?void 0:i.current_sqrt_price)||((h=i==null?void 0:i.object)==null?void 0:h.current_sqrt_price),s,b).toString(),ui.value=new r(1).div(li.sqrtPriceX64ToPrice((i==null?void 0:i.current_sqrt_price)||((q=i==null?void 0:i.object)==null?void 0:q.current_sqrt_price),s,b)).toString()},v=S([]),Re=S(),Fe=async i=>{const s=i.token_a.decimals,b=i.token_b.decimals;let h=N.value.poolPriceConfigObj&&N.value.poolPriceConfigObj[i.address]&&N.value.poolPriceConfigObj[i.address].recommend_ranges||{};const q=N.value.poolPriceConfigObj&&N.value.poolPriceConfigObj[i.address]&&N.value.poolPriceConfigObj[i.address].type||"";let x,ue;const Te=so(i.current_tick_index,i.tickSpacing);Re.value=i.current_tick_index,x=Te-Number(i.type=="unstable"?Number(i.tickSpacing)*2:Number(i.tickSpacing)*3),ue=Te+Number(i.type=="unstable"?Number(i.tickSpacing)*2:Number(i.tickSpacing)*3);const De=w.value.TickMath.tickIndexToPrice(x,s,b).toString(),ze=w.value.TickMath.tickIndexToPrice(ue,s,b).toString();h["full range"]={lower:w.value.TickUtil.getMinIndex(Number(C.value.tickSpacing)),upper:w.value.TickUtil.getMaxIndex(Number(C.value.tickSpacing))},h.custom={lower:x,upper:ue,minPrice:De,maxPrice:ze};const be=[];for(let Se in h)h[Se]&&be.push({...h[Se],key:Se});q&&be&&be.length>2?i.isSelfBuilt?T.value="custom":q=="stable"?T.value="suggested":T.value="passive":T.value="custom",v.value=be||{},Ue.value=h,fe({key:T.value,...h[T.value]})},we=S(""),_e=S(""),fe=i=>{T.value=i.key.toLowerCase();const s=C.value.token_a.decimals,b=C.value.token_b.decimals,{lower:h,upper:q}=i;ke.value=!1;const x=w.value.TickMath.tickIndexToPrice(h,s,b).toString(),ue=w.value.TickMath.tickIndexToPrice(q,s,b).toString();if(i.key=="full range"){we.value=h,_e.value=q,Ie();return}G.value?(hi.value=String(x),g.value=String(x),wi.value=String(ue),d.value=String(ue),we.value=h,_e.value=q):(hi.value=new r(1).div(new r(ue)).toString(),g.value=new r(1).div(new r(ue)).toString(),wi.value=new r(1).div(new r(x)).toString(),d.value=new r(1).div(new r(x)).toString(),we.value=w.value.TickMath.priceToTickIndex(new r(1/Number(ue)),s,b),_e.value=w.value.TickMath.priceToTickIndex(new r(1/Number(x)),s,b))},Ie=i=>{g.value="0",d.value="âˆž"};ce(()=>C.value,(i,s)=>{(!s&&i&&!J(i)||s&&i&&(!(s!=null&&s.current_tick_index)||(s==null?void 0:s.address)!==(i==null?void 0:i.address)))&&Le(i,!s||!(s!=null&&s.current_tick_index)||(s==null?void 0:s.address)!==(i==null?void 0:i.address)),i&&!J(i)&&Q(i),i||(Xe.value=[])},{immediate:!0}),Oi(()=>{m.value=S(),c.value=S(),Xe.value=[]}),ce(()=>a.value,(i,s)=>{i&&M.setSinglePool(i,{},le.value)},{immediate:!0});const A=i=>{if(le.value=="Sui")switch(i){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(i){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},Ge=i=>{switch(i){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},y=i=>{var b,h;const s=N.value.poolPriceConfigObj&&N.value.poolPriceConfigObj[(b=C.value)==null?void 0:b.address]&&N.value.poolPriceConfigObj[(h=C.value)==null?void 0:h.address].type||"";if(v.value.length>2)if(s=="unstable")switch(i){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(i){case"suggested":return{top:"25%"};case"full range":return{top:"49%"};case"custom":return{top:"75%"}}else if(s=="unstable")switch(i){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(i){case"full range":return{top:"35%"};case"custom":return{top:"60%"}}},Pe=S(1),Oe=()=>{const i=Pe.value/2;Pe.value=i},qe=()=>{const i=Pe.value*2;Pe.value=i},L=k(()=>{var i,s,b;return!C.value||J(I.value.addressHistTokens)||!I.value.addressHistTokens[(i=C.value)==null?void 0:i.poolAddress]?null:Object.fromEntries((b=I.value.addressHistTokens[(s=C.value)==null?void 0:s.poolAddress])==null?void 0:b.data.map(h=>[h.key,h.value]))}),j=S(30),vi=S("30D"),Ve=k(()=>G.value?L.value&&ee(j.value==7?L.value.before_7_d_contract_price_lowest:j.value==24?L.value.before_24_h_contract_price_lowest:L.value.before_30_d_contract_price_lowest,6)||0:L.value&&ee(new r(1).div(j.value==7?L.value.before_7_d_contract_price_highest:j.value==24?L.value.before_24_h_contract_price_highest:L.value.before_30_d_contract_price_highest).toString(),6)||0),xe=k(()=>G.value?L.value&&ee(j.value==7?L.value.before_7_d_contract_price_highest:j.value==24?L.value.before_24_h_contract_price_highest:L.value.before_30_d_contract_price_highest,6)||0:(L.value&&ee(1/Number(j.value==7?L.value.before_7_d_contract_price_lowest:j.value==24?L.value.before_24_h_contract_price_lowest:L.value.before_30_d_contract_price_lowest),6))==1/0?0:L.value&&ee(1/Number(j.value==7?L.value.before_7_d_contract_price_lowest:j.value==24?L.value.before_24_h_contract_price_lowest:L.value.before_30_d_contract_price_lowest),6)||0),mi=k(()=>{const i=Number(g.value),s=Number(d.value);if(g.value=="0"&&d.value=="âˆž"||T.value=="full range")return"1x";if(g.value==d.value||T.value=="full range")return"--";if(g.value&&d.value&&g.value!=="0"&&d.value!=="âˆž"){const b=yi(1/(1-Number((i/s)**.25)),2);return Number(b)>0?b+"x":"--"}else return 1}),ei=k(()=>{var i,s,b,h,q,x;return((i=m.value)==null?void 0:i.isSelfBuilt)||((s=c.value)==null?void 0:s.isSelfBuilt)||((h=N.value.tokensObj[(b=m.value)==null?void 0:b.address])==null?void 0:h.isSelfBuilt)||((x=N.value.tokensObj[(q=c.value)==null?void 0:q.address])==null?void 0:x.isSelfBuilt)}),ii=(i,s)=>{i!==g.value&&T.value=="full range"?fe({key:"custom",...v.value.custom}):T.value!=="full range"&&T.value!=="custom"?(T.value="custom",g.value=i):g.value=i,B.value&&(me.value?(G.value&&g.value!==B.value.minPrice&&(me.value=!1),!G.value&&Number(g.value)!==1/Number(B.value.maxPrice)&&(me.value=!1)):(G.value&&g.value==B.value.minPrice&&d.value==B.value.maxPrice&&(me.value=!0),!G.value&&Number(g.value)==1/Number(B.value.maxPrice)&&Number(d.value)==1/Number(B.value.minPrice)&&(me.value=!0)))},fi=(i,s)=>{i!==d.value&&T.value=="full range"?fe({key:"custom",...v.value.custom}):T.value!=="full range"&&T.value!=="custom"?(T.value="custom",i=="0"?d.value="âˆž":d.value=i):i=="0"?d.value="âˆž":d.value=i,B.value&&(me.value?(G.value&&d.value!==B.value.maxPrice&&(me.value=!1),!G.value&&Number(d.value)!==1/Number(B.value.minPrice)&&(me.value=!1)):(G.value&&g.value==B.value.minPrice&&d.value==B.value.maxPrice&&(me.value=!0),!G.value&&Number(g.value)==1/Number(B.value.maxPrice)&&Number(d.value)==1/Number(B.value.minPrice)&&(me.value=!0)))},je=i=>{var s;return console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:1215 ~ getCoinIcon ~ info:",i),(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((s=N.value.tokensObj[i==null?void 0:i.address])==null?void 0:s.logo_url)||(I.value.theme==="default"?Pi("/image/coins/unknown.png"):Pi("/image/coins/sui-unknown.png"))},oi=i=>{switch(i){case"active":return e("newAdd.activeTips");case"passive":return e("newAdd.passiveTips");case"full range":return e("newAdd.fullRangTips");case"suggested":return e("newAdd.suggestedTips");case"custom":return e("newAdd.customTips")}},pi=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],ai=Ai(),ti=k(()=>ai),B=k(()=>{var i;return ti.value.farmsPoolObj[(i=C==null?void 0:C.value)==null?void 0:i.address]}),ni=k(()=>N.value.poolPriceConfigObj);ce(()=>[me.value,C.value,v.value,ni.value,B.value,G.value],(i,s)=>{var b,h;if(i[0]&&i[4]&&!J(i[4]))T.value="custom",g.value=i[5]?i[4].minPrice:String(1/i[4].maxPrice),d.value=i[5]?i[4].maxPrice:String(1/i[4].minPrice);else if(i[1]&&!J(i[1])&&i[2]&&!J(i[2])&&i[3]&&!J(i[3])&&i[4]&&!J(i[4])){i[3]&&i[3][(b=i[1])==null?void 0:b.address]&&i[3][(h=i[1])==null?void 0:h.address].type;const q=i[2].filter(x=>x.key===(i[2].length==4?"passive":"suggested"));q!=null&&q[0]&&(!s||s[0]!==i[0])&&fe({...q[0]})}},{immediate:!0});const $e=k(()=>N.value.poolsLoading);return{positionError:He,getCoinIcon:je,chainName:le,store:I,currentTab:Ce,currentPrice:Qe,currentPriceReverse:ui,fromCoin:m,toCoin:c,direction:G,needReverse:Y,addCommom:ne,decimalUi:ee,priceTablList:v,currentPriceTab:T,sliderStyle:y,poolInfo:C,tickList:Xe,getPriceTabImage:A,getPriceTabText:Ge,defaultMinPrice:hi,defaultMaxPrice:wi,minPrice:g,maxPrice:d,currentTick:Re,chartLoading:he,zoomOut:Oe,zoomIn:qe,zoom:Pe,priceTab:fe,before7dContractPriceLowest:Ve,before7dContractPriceHighest:xe,aprRewardsTime:vi,lever:mi,aprRewardsParameter:j,isSelfBuilt:ei,priceRangeChangeMin:ii,priceRangeChangeMax:fi,toggle:zi,getPirceTabTips:oi,timeList:pi,farmsPoolInfo:B,checkNullObj:J,isStableFarmingRange:me,poolsLoading:$e}}});const So={class:"new-liquidity-left"},No=t("span",{class:"selectRange"},"Select Range",-1),Ao={class:"price-info"},Lo={class:"left"},Io={class:"base-coin"},qo={class:"base-coin-title"},$o=t("span",null,"Base coin",-1),Mo=t("svg",{class:"icon icon-up","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_up1"})],-1),Ro=t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-exchange_down1"})],-1),Oo=[Mo,Ro],Bo={class:"base-coin-bottom"},Uo={alt:""},Fo={class:"current-price"},jo=t("div",{class:"current-price-title"},"Current Price",-1),Do={key:0,class:"from-pre-to"},zo={class:"right"},Eo={class:"price-range"},Xo={class:"left"},Ho={class:"price-slider"},Wo={class:"slider"},Go=t("div",{class:"slider-ratio-content"},null,-1),Jo=[Go],Ko={class:"price-tab-list"},Yo=["onClick"],Qo=["src"],Zo={class:"right"},Vo={class:"price-zoom"},xo={class:"current-price"},ea=t("div",{class:"current-price-title"},"Current Price",-1),ia={key:0,class:"from-pre-to"},oa={class:"price-zoom-right"},aa={class:"leverage"},ta=t("div",{class:"left"},null,-1),na={class:"right"},ra={class:"right-time"},sa={key:0,class:"day-7-price-range"},la=t("i",null,null,-1),ua={class:"gray"},ca={class:"time-list"},da=["onClick"],va={class:"right-price-h5"},ma={class:"range pc-range"},fa={key:0,class:"stable-farming-range pc-stable-farming-range"},pa=t("img",{src:Ei},null,-1),ga={class:"check-box-active"},ba={key:1,class:"stable-farming-range h5-stable-farming-range"},ka=t("span",null,[t("img",{src:Ei}),We(" Farm rewards rangeï¼š ")],-1),Ca={class:"check-box-active"},ha={key:2,class:"position-tips"},wa=["src"],_a={class:"error"};function ya(e,l,Ce,se,I,le){var Y,he,Le,Q,v,Re,Fe,we,_e,fe,Ie;const M=Mi,N=$i,w=Po,K=io,a=Bi,C=Vi("image");return _(),F("div",So,[No,t("div",Ao,[t("div",Lo,[t("div",Io,[t("div",qo,[$o,t("div",{class:"change-price",onClick:l[0]||(l[0]=(...A)=>e.toggle&&e.toggle(...A))},Oo)]),t("div",Bo,[xi(t("img",Uo,null,512),[[C,e.getCoinIcon(e.fromCoin)]]),t("span",null,$((Y=e.fromCoin)==null?void 0:Y.symbol),1)])]),t("div",Fo,[jo,t("div",null,[t("span",null,$(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.currentPrice,6)):("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(_(),F("span",Do,$((he=e.toCoin)==null?void 0:he.symbol)+" per "+$((Le=e.fromCoin)==null?void 0:Le.symbol),1)):X("",!0)])])]),t("div",zo,[e.currentTab=="liquidity"?(_(),F("div",{key:0,class:"zoom-out",onClick:l[1]||(l[1]=(...A)=>e.zoomOut&&e.zoomOut(...A))}," + ")):X("",!0),e.currentTab=="liquidity"?(_(),F("div",{key:1,class:"zoom-in",onClick:l[2]||(l[2]=(...A)=>e.zoomIn&&e.zoomIn(...A))}," - ")):X("",!0)])]),t("div",Eo,[t("div",Xo,[t("div",Ho,[t("div",Wo,[t("div",{class:"slider-ratio",style:eo(e.sliderStyle(e.currentPriceTab))},Jo,4)])]),t("div",Ko,[(_(!0),F(_i,null,Li(e.priceTablList,A=>(_(),F("div",{key:A.key,class:Ci(["price-tab-item",e.currentPriceTab==A.key?"price-tab-item-active":""]),onClick:Ge=>e.priceTab(A)},[re(M,{placement:"bottom","arrow-point-at-center":""},{title:Ze(()=>[We($(e.getPirceTabTips(A.key)),1)]),default:Ze(()=>[t("img",{src:e.getPriceTabImage(A.key),alt:""},null,8,Qo),t("span",null,$(e.getPriceTabText(A.key)),1)]),_:2},1024)],10,Yo))),128))])]),t("div",Zo,[t("div",Vo,[t("div",xo,[ea,t("div",null,[t("span",null,$(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.currentPrice,6)):("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(_(),F("span",ia,$(e.direction&&!e.needReverse?`${(Q=e.fromCoin)==null?void 0:Q.symbol} per ${(v=e.toCoin)==null?void 0:v.symbol}`:`${(Re=e.toCoin)==null?void 0:Re.symbol} per ${(Fe=e.fromCoin)==null?void 0:Fe.symbol}`),1)):X("",!0)])]),t("div",oa,[e.currentTab=="liquidity"?(_(),F("div",{key:0,class:"zoom-out",onClick:l[3]||(l[3]=(...A)=>e.zoomOut&&e.zoomOut(...A))}," + ")):X("",!0),e.currentTab=="liquidity"?(_(),F("div",{key:1,class:"zoom-in",onClick:l[4]||(l[4]=(...A)=>e.zoomIn&&e.zoomIn(...A))}," - ")):X("",!0)])]),e.poolInfo?(_(),Be(N,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):X("",!0)])]),t("div",aa,[ta,t("div",na,[t("div",ra,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(_(),F("div",sa,[la,t("span",ua,$(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),t("span",null,$(("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.before7dContractPriceLowest,6)))+" - "+$(("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.before7dContractPriceHighest,6))),1)])):X("",!0),t("div",ca,[(_(!0),F(_i,null,Li(e.timeList,A=>(_(),F("div",{key:A.value,class:Ci(["time-item",A.value==e.aprRewardsParameter?"time-item-active":""]),onClick:Ge=>e.aprRewardsParameter=A.value},$(A.label),11,da))),128))])]),t("div",va,[t("span",null,$(("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.before7dContractPriceLowest,6)))+" - "+$(("addCommom"in e?e.addCommom:U(ne))(("decimalUi"in e?e.decimalUi:U(ee))(e.before7dContractPriceHighest,6))),1)])])]),t("div",{class:Ci(["apr-and-price",e.positionError&&e.poolInfo?"padding-apr-and-price":""])},[re(w,{lever:e.lever},null,8,["lever"]),t("div",ma,[e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:U(J))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(_(),F("div",fa,[t("span",null,[pa,We(" Farm rewards rangeï¼š"+$(("decimalUi"in e?e.decimalUi:U(ee))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+$(("decimalUi"in e?e.decimalUi:U(ee))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+$((we=e.toCoin)==null?void 0:we.symbol)+" per "+$((_e=e.fromCoin)==null?void 0:_e.symbol),1)]),t("div",ga,[re(K,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:l[5]||(l[5]=A=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):X("",!0),e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:U(J))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(_(),F("div",ba,[ka,t("div",Ca,[We($(("decimalUi"in e?e.decimalUi:U(ee))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+$(("decimalUi"in e?e.decimalUi:U(ee))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+$((fe=e.toCoin)==null?void 0:fe.symbol)+" per "+$((Ie=e.fromCoin)==null?void 0:Ie.symbol)+" ",1),re(K,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:l[6]||(l[6]=A=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):X("",!0),re(a,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(_(),F("div",ha,[t("img",{src:("importIcon"in e?e.importIcon:U(Pi))("/image/icon-tips-error@2x.png"),alt:""},null,8,wa),t("p",_a,$(e.$t("tips.positionError")),1)])):X("",!0)])],2)])}const Xi=di(To,[["render",ya]]),Pa=ci({components:{NewLiquidityTitle:Ui,NewLiquidityAssetsCard:Fi,NewLiquidityDepositRatio:ji},setup(){const{t:e,locale:l}=Ri(),Ce=Si(),se=k(()=>Ce),I=k(()=>se.value.chainName),le=Ni(),M=k(()=>le),N=lo(),w=k(()=>N),K=Ti(),a=k(()=>{let o=null;for(const n in M.value.poolsObj){const u=M.value.poolsObj[n];u.address==K.query.poolAddress&&(o=u)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:272 ~ constpoolInfo:any=computed ~ info:",o),o}),C=S(!1),Y=S(!1),he=k(()=>se.value.theme),Le=async(o,n)=>{m.value=o.needReverse?o.token_b:o.token_a,c.value=o.needReverse?o.token_a:o.token_b,f.value="",p.value=""},Q=k(()=>w.value.assets&&m.value&&w.value.assets[m.value.address]?Ii(w.value.assets[m.value.address].balance,m.value.decimals):"0"),v=k(()=>w.value.assets&&c.value&&w.value.assets[c.value.address]?Ii(w.value.assets[c.value.address].balance,c.value.decimals):"0"),Re=o=>{o==="fromCoin"?(oe.value=!0,I.value==="Aptos"?f.value=Number(Q.value)>0?m.value.symbol=="APT"?new r(Number(Q.value)).sub(new r(.1)).lt(new r(0))?"0":new r(Number(Q.value)).sub(new r(.1)).toString():String(Q.value):"":f.value=Number(Q.value)>0?m.value.symbol=="SUI"?new r(Number(Q.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(Q.value)).sub(new r(.05)).toString():String(Q.value):""):(oe.value=!1,I.value==="Aptos"?p.value=Number(v.value)>0?c.value.symbol=="APT"?new r(Number(v.value)).sub(new r(.1)).lt(new r(0))?"0":new r(Number(v.value)).sub(new r(.1)).toString():String(v.value):"":p.value=Number(v.value)>0?c.value.symbol=="SUI"?new r(Number(v.value)).sub(new r(.05)).lt(new r(0))?"0":new r(Number(v.value)).sub(new r(.05)).toString():String(v.value):"")},Fe=o=>{o==="fromCoin"?(oe.value=!0,f.value=Number(Q.value)>0?yi(new r(Number(Q.value)).div(2).toString(),m.value.decimals).toString():""):(oe.value=!1,p.value=Number(v.value)>0?yi(new r(Number(v.value)).div(2).toString(),c.value.decimals).toString():"")},we=S(),_e=S(),fe=S(),Ie=S(!1),A=o=>{var n,u,D,P;we.value=o,o==="fromCoin"?(_e.value=((n=c.value)==null?void 0:n.address)||"",fe.value=K.query.actions=="new-position"?(u=m.value)==null?void 0:u.address:a.value.needReverse?a.value.token_b.address:a.value.token_a.address):(_e.value=((D=m.value)==null?void 0:D.address)||"",fe.value=K.query.actions=="new-position"?(P=c.value)==null?void 0:P.address:a.value.needReverse?a.value.token_a.address:a.value.token_b.address),Ie.value=!0},Ge=o=>{var D,P,Z,V,z,H,W,ie;const n=a.value.needReverse?a.value.token_b:a.value.token_a,u=a.value.needReverse?a.value.token_a:a.value.token_b;we.value==="fromCoin"?(((D=m.value)==null?void 0:D.address)===(n==null?void 0:n.address)||!((P=m.value)!=null&&P.address)?(c.value&&o.address.toLowerCase()===((Z=c)==null?void 0:Z.value.address.toLowerCase())&&(c.value=null),m.value=o):(m.value&&o.address.toLowerCase()===((V=m)==null?void 0:V.value.address.toLowerCase())&&(m.value=null),c.value=o),K.query.action||(K.query.fee="")):((z=c.value)==null?void 0:z.address)===(u==null?void 0:u.address)||!((H=c.value)!=null&&H.address)?(m.value&&o.address.toLowerCase()===((W=m)==null?void 0:W.value.address.toLowerCase())&&(m.value=null),c.value=o):(c.value&&o.address.toLowerCase()===((ie=c)==null?void 0:ie.value.address.toLowerCase())&&(c.value=null),m.value=o),Ie.value=!1},y=k(()=>se.value.chainName?Di(se.value.chainName):{}),Pe=k(()=>se.value.slippage),Oe=S(),qe=async()=>{var pe,te,de,Ne;if(ke.value||!g.value&&!d.value)return!1;if(!f.value&&!p.value&&!g.value&&!d.value)return;const o=a.value||{};if(J(o))return;const{TickUtil:n,TickMath:u,getNearestTickByTick:D}=y.value,P=o==null?void 0:o.token_a.decimals,Z=o==null?void 0:o.token_b.decimals;let V,z,H,W,ie,ae,ye,Me,E=o==null?void 0:o.current_tick_index;if(!E)return;let R;if(o.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===c.value.address.toLowerCase()?R=!0:R=!1,g.value==="0"&&d.value==="âˆž")H=n.getMinIndex(Number(o.tickSpacing)),W=n.getMaxIndex(Number(o.tickSpacing)),ie=u.tickIndexToSqrtPriceX64(H),ae=u.tickIndexToSqrtPriceX64(W);else if(T.value=="custom"){R?(V=g.value,z=d.value):(V=d.value!=="âˆž"?new r(1).div(d.value).toString():1/0,z=new r(1).div(g.value).toString());try{ye=new r(V).equals(new r(0))?-443636:u.priceToTickIndex(new r(V),P,Z)}catch{ye=-443636}try{Me=u.priceToTickIndex(new r(z),P,Z)}catch{Me=443636}H=D(ye,Number(o.tickSpacing),!0),W=D(Me,Number(o.tickSpacing),!0);try{ie=u.priceToSqrtPriceX64(new r(V),P,Z)}catch{(z===1/0||z==="âˆž")&&(ie=u.tickIndexToSqrtPriceX64(n.getMinIndex(Number(o.tickSpacing))))}try{ae=u.priceToSqrtPriceX64(new r(z),P,Z)}catch{(z===1/0||z==="âˆž")&&(ae=u.tickIndexToSqrtPriceX64(n.getMaxIndex(Number(o.tickSpacing))))}}else H=(pe=Ue.value[T.value])==null?void 0:pe.lower,W=(te=Ue.value[T.value])==null?void 0:te.upper,ie=u.tickIndexToSqrtPriceX64(H),ae=u.tickIndexToSqrtPriceX64(W);if(d.value!=="âˆž"&&H>=W){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:639 ~ updateAmounts ~",d.value!=="âˆž"&&H>=W),C.value=!0,f.value="",Y.value=!0,p.value="";return}if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:708 ~ updateAmounts ~ currentTickIndex:",E),d.value==="âˆž"||E>=H&&E<W){C.value=!1,Y.value=!1;let O;if(f.value||p.value){if(oe.value){const ki=new r(f.value).mul(Math.pow(10,m.value.decimals)).toString();O=new ge(ki)}else{const ki=new r(p.value).mul(Math.pow(10,c.value.decimals)).toString();O=new ge(ki)}u.tickIndexToSqrtPriceX64(a.value.current_tick_index);const{liquidityAmount:ve,tokenMaxA:Ae,tokenMaxB:si,tokenMaxAOrigin:Gi,tokenMaxBOrigin:Ji}=y.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.token_a,tokenB:o.token_b,lowerTick:H,upperTick:W,coinAmount:O,iscoinA:R?oe.value:!oe.value,roundUp:!0,slippage:Number(Pe.value)/100,curSqrtPrice:new ge(a.value.current_sqrt_price)});Oe.value={liquidityAmount:ve,tokenMaxA:Ae,tokenMaxB:si,tokenMaxAOrigin:Gi,tokenMaxBOrigin:Ji},R?oe.value?p.value=Number(si)>0?si:"":f.value=Number(Ae)>0?Ae:"":oe.value?p.value=Ae:f.value=si}}else if(E>=W){if(R?f.value="":p.value="",C.value=R,Y.value=!R,f.value||p.value){let O;if(R){const ve=new r(p.value).mul(Math.pow(10,(de=c.value)==null?void 0:de.decimals)).toString();O=new ge(ve),Oe.value={liquidityAmount:y.value.estimateLiquidityForCoinB(ie,ae,O),tokenMaxA:0,tokenMaxB:p.value}}else{const ve=new r(f.value).mul(Math.pow(10,(Ne=m.value)==null?void 0:Ne.decimals)).toString();O=new ge(ve),Oe.value={liquidityAmount:y.value.estimateLiquidityForCoinB(ie,ae,O),tokenMaxA:0,tokenMaxB:f.value}}}}else if(E<H){if(C.value=!R,Y.value=R,R?p.value="":f.value="",f.value||p.value){let O;if(R){const ve=new r(f.value).mul(Math.pow(10,m.value.decimals)).toString();O=new ge(ve),Oe.value={liquidityAmount:y.value.estimateLiquidityForCoinA(ie,ae,O),tokenMaxA:f.value,tokenMaxB:0}}else{const ve=new r(p.value).mul(Math.pow(10,c.value.decimals)).toString();O=new ge(ve),Oe.value={liquidityAmount:y.value.estimateLiquidityForCoinA(ie,ae,O),tokenMaxA:p.value,tokenMaxB:0}}}}else C.value=!0,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:783 ~ updateAmounts ~ showFromCoinLock.value:",C.value),f.value="",Y.value=!0,p.value=""};ce(()=>a.value,(o,n)=>{(!n&&o&&!J(o)||n&&o&&n.address!==o.address)&&Le(o,!n||o.address!==n.address),o&&!J(o)&&qe()},{immediate:!0}),ce(f,(o,n)=>{o==""&&oe.value&&(p.value=""),o&&oe.value&&!ke.value&&qe()}),ce(p,(o,n)=>{o==""&&!oe.value&&(f.value=""),o&&!oe.value&&!ke.value&&qe()}),ce(()=>G.value,(o,n)=>{qe()}),ce(()=>[m.value,c.value],([o,n])=>{o&&n&&(C.value=!1,Y.value=!1)});const L=S("--"),j=k(()=>M.value.RATES),vi=()=>{const o=j.value&&j.value[m.value.address]&&j.value[m.value.address].price,n=j.value&&j.value[c.value.address]&&j.value[c.value.address].price;if(o&&n){const u=new r(f.value>0?f.value:0).mul(o),D=new r(p.value>0?p.value:0).mul(n),P=u.add(D).toNumber();L.value=P>0&&P<.01?"<$0.01":"$"+ne(P,2)}else L.value="--"};ce(()=>[f.value,p.value,ke.value],([o,n,u])=>{(o||n)&&!u?vi():(!o||!n)&&!u&&(L.value="--")},{immediate:!0});const Ve=S(),xe=async()=>{var R,pe;if(!g.value&&!d.value)return!1;if(!f.value&&!p.value&&!g.value&&!d.value)return;const o=a.value;if(J(o))return;const{TickUtil:n,TickMath:u,getNearestTickByTick:D}=y.value,P=o==null?void 0:o.token_a.decimals,Z=o==null?void 0:o.token_b.decimals;let V,z,H,W,ie,ae,ye;if(o.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&o.token_b.address.toLowerCase()===c.value.address.toLowerCase()?ye=!0:ye=!1,g.value==="0"&&d.value==="âˆž")H=n.getMinIndex(Number(o.tickSpacing)),W=n.getMaxIndex(Number(o.tickSpacing));else if(T.value=="custom"){ye?(V=Number(g.value),z=Number(d.value)):(V=new r(1).div(d.value).toString(),z=new r(1).div(g.value).toString());try{ie=V==0?-443636:u.priceToTickIndex(new r(V),P,Z)}catch{ie=-443636}try{ae=u.priceToTickIndex(new r(z),P,Z)}catch{ae=443636}H=D(ie,Number(o.tickSpacing),!0),W=D(ae,Number(o.tickSpacing),!0)}else H=(R=Ue.value[T.value])==null?void 0:R.lower,W=(pe=Ue.value[T.value])==null?void 0:pe.upper;const Me=j.value[o==null?void 0:o.token_a.address].price,E=j.value[o==null?void 0:o.token_b.address].price;G.value?new ge(o.current_sqrt_price):new ge(1/o.current_sqrt_price);try{const{amountA:te,amountB:de,tokenAmountsInfo:Ne}=await y.value.estCoinAmountsFromTotalAmount({lowerTick:H,upperTick:W,decimalsA:P,decimalsB:Z,curSqrtPrice:new ge(o.current_sqrt_price),totalAmount:L.value.replace(/[^\d.]/g,""),tokenPriceA:Me,tokenPriceB:E});Ve.value=Ne,o.needReverse?G.value?(f.value=te,p.value=de):(f.value=de,p.value=te):(f.value=te,p.value=de)}catch(te){console.log(te,"e===>")}};ce([g,d],([o,n])=>{ke.value?ke.value&&xe():qe(),n!=="âˆž"&&Number(o)!==0&&Number(n)!==0&&Number(o)>=Number(n)?He.value=!0:He.value=!1,Number(o)==0&&Number(n)==0&&Qe.value&&(He.value=!0)},{deep:!0,immediate:!0});const mi=o=>{const n=o.replace(/[^\d.]/g,""),u="$"+ne(n);ke.value=!0,L.value=u,n>0?xe():(f.value="",p.value="")},ei=S(!1),{setTransactionTxid:ii,setTransactionDesc:fi,setIsShowWaiting:je,setIsShowSuccess:oi,setPositiomNum:pi,setIsShowRejected:ai}=Ce,ti=po(),B=k(()=>M.value.currentPositionInfo),ni=S(!1),$e=S(!0),i=Ai(),s=k(()=>i),b=k(()=>s.value.farmsPoolObj);ce(()=>[b.value,a.value],([o,n])=>{o&&!J(o)&&n&&!J(n)&&(o[n.address]||($e.value=!1))},{immediate:!0});const h=S(),q=S(),x=o=>{h.value=o,o?$e.value=!0:$e.value=!1},ue=async(o,n,u,D)=>{try{n=="farming"?await M.value.setCurrentPositionInfo("","","","Sui",u,"farming"):await M.value.setCurrentPositionInfo(o,"","",I.value,D),await ro(3e3),$e.value?await ti.subscribePosition({pool_address:B.value.clmm_pool_id,position_index:B.value.name.split("-")[1]},B.value.clmm_position_id):await ti.subscribePosition({pool_address:B.value.poolAddress,position_index:B.value.index},B.value.nftHash)}catch(P){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1151 ~ notifiSubscribePosition ~ error:",P)}},Te=async o=>{var ie,ae,ye,Me;ei.value=!1,M.value.currentPositionInfo={},ii(""),fi(e("tips.increaseLiquiditySuccess",{from:C.value?"":`${ne(f.value)} ${(ie=m.value)==null?void 0:ie.symbol}`,and:!C.value&&!Y.value?"and":"",to:Y.value?"":`${ne(p.value)} ${(ae=c.value)==null?void 0:ae.symbol}`})),je(!0);const n=G.value?oe.value:!oe.value;let u,D,P,Z,V,z;const H=a.value.token_a.decimals,W=a.value.token_b.decimals;if(g.value==="0"&&d.value==="âˆž")P=y.value.TickUtil.getMinIndex(Number(a.value.tickSpacing)),Z=y.value.TickUtil.getMaxIndex(Number(a.value.tickSpacing));else if(T.value=="custom"){G.value?(u=g.value,D=d.value):(u=new r(1).div(d.value).toString(),D=new r(1).div(g.value).toString());try{V=u==0?y.value.TickUtil.getMinIndex(Number(a.value.tickSpacing)):y.value.TickMath.priceToTickIndex(new r(u),H,W)}catch{V=y.value.TickUtil.getMinIndex(Number(a.value.tickSpacing))}try{z=y.value.TickMath.priceToTickIndex(new r(D),H,W)}catch{z=y.value.TickUtil.getMaxIndex(Number(a.value.tickSpacing))}P=y.value.getNearestTickByTick(V,Number(a.value.tickSpacing),!0),Z=y.value.getNearestTickByTick(z,Number(a.value.tickSpacing),!0)}else P=Ue.value[T.value].lower,Z=Ue.value[T.value].upper;try{let E;ke.value?E=await y.value.getCreateAddLiquidityPayload({pool:a.value,curSqrtPrice:new ge(a.value.current_sqrt_price),tickLower:P,tickUpper:Z,slippage:Number(Pe.value)/100,tokenAmounts:Ve.value}):E=await y.value.getAddLiquidityTransactionPayload({pool:{poolAddress:a.value.poolAddress,token_a:a.value.token_a,token_b:a.value.token_b},amount:oe.value?f.value:p.value,fix_amount_a:n,tick_lower:P,tick_upper:Z,index:0,slippage:Number(Pe.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new ge(a.value.current_sqrt_price),farmPoolInfo:h.value});let R;if(I.value==="Aptos")R=await w.value.currentWallet.signAndSubmitTransaction(E);else{const pe=await y.value.signAndExecuteTransactionBlock(w.value.currentWallet,E==null?void 0:E.txb,E==null?void 0:E.payloadParams);R=y.value.handleTx(pe)}if(console.log("0410###tx###",R),R&&R.hash){ii(R.hash),je(!1),oi(!0);let pe;a.value.needReverse?a.value.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&a.value.token_b.address.toLowerCase()===c.value.address.toLowerCase()?pe=!1:pe=!0:a.value.token_a.address.toLowerCase()===m.value.address.toLowerCase()&&a.value.token_b.address.toLowerCase()===c.value.address.toLowerCase()?pe=!0:pe=!1;const te={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:C.value?"":`${ne(f.value)} ${(ye=m.value)==null?void 0:ye.symbol}`,and:!C.value&&!Y.value?"and":"",to:Y.value?"":`${ne(p.value)} ${(Me=c.value)==null?void 0:Me.symbol}`}),hash:R.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};I.value!=="Aptos"&&(te.res=R.res),y.value.showTransitionPending(te),console.log(te,"toAdd params###");const de=await y.value.watchTransaction(te,!0);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1295 ~ toAdd ~ watchInfo:",de),de.status){oi(!1),M.value.setCurrentPositionLoading(!0);let Ne,O;I.value==="Aptos"?q.value={token_a:a.value.token_a,token_b:a.value.token_b,minPrice:g.value,maxPrice:d.value,pool:a.value.address,collection:de.nftInfo[0].data.id.collection,tokenName:de.nftInfo[0].data.name}:(O=de.nftInfo,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1319 ~ toAdd ~ nftInfo:",O),$e.value?(de.res.events.forEach(Ae=>{Ae.type.indexOf("::pool::DepositEvent")>-1&&(Ne=Ae.parsedJson.wrapped_position_id)}),q.value={token_a:a.value.needReverse?a.value.token_b:a.value.token_a,token_b:a.value.needReverse?a.value.token_a:a.value.token_b,minPrice:g.value,maxPrice:d.value,id:Ne,clmm_pool_id:a.value.address,pool:a.value.address}):q.value={token_a:a.value.needReverse?a.value.token_b:a.value.token_a,token_b:a.value.needReverse?a.value.token_a:a.value.token_b,minPrice:g.value,maxPrice:d.value,pos_object_id:O.position,pool:a.value.address},console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1389 ~ toAdd ~ positionInfoDetail:",q.value)),ni.value=!0;const ve=a.value.poolAddress;setTimeout(()=>{if(o){const Ae=Ne?"farming":"clmm";console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1400 ~ setTimeout ~ poolInfo.value.poolAddress:",ve),ue(ve,Ae,Ne,O==null?void 0:O.position)}},3e3),setTimeout(()=>{le.updateCurrentPools(ve,I.value),y.value.getAccount(w.value.address)},3e3),setTimeout(async()=>{qi(y,a)},7e3)}pi()}else je(!1),ai(!0);f.value="",p.value=""}catch(E){f.value="",p.value="",console.log("0330###Add liquidity Error###",E),je(!1),ai(!0)}},De=k(()=>!!(!f.value&&!p.value||Number(f.value)>Number(Q.value)||Number(p.value)>Number(v.value)||be.value!==e("button.addLiquidity")&&be.value!==e("newAdd.preview")||a.value&&a.value&&a.value.is_pause||Number(f.value)<=0&&Number(p.value)<=0||!C.value&&Number(f.value)==0||!Y.value&&Number(p.value)==0)),ze=k(()=>!m.value||!c.value),be=k(()=>a.value&&a.value.is_pause?"Pool Closed":!m.value||!c.value||ze.value?e("modal.selectTokenModalTitle"):Number(f.value)>Number(Q.value)?e("button.insufficientBalance",{name:m.value.symbol}):Number(p.value)>Number(v.value)?e("button.insufficientBalance",{name:c.value.symbol}):!Number(f.value)&&!Number(p.value)?e("button.enterAmount"):d.value!=="âˆž"&&Number(g.value)>=Number(d.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),Se=S({}),Je=S({}),Ke=S(!1),Ee=(o,n)=>{const u=localStorage.getItem(o.address);console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1518 ~ getTokenSource ~ coinLocak:",u,o),o!=null&&o.isSelfBuilt&&!u&&(n=="fromCoin"&&(Se.value=o),n=="toCoin"&&(Je.value=o),Ke.value=!0)};ce(()=>[m.value,c.value],([o,n])=>{o&&!J(o)&&Ee(o,"fromCoin"),n&&!J(n)&&Ee(n,"toCoin")},{immediate:!0});const Ye=oo(),gi=()=>{I.value!=="Aptos"?Ye.push("/pool/list"):Ye.push("/pools")},ri=o=>{ke.value,Te(o)},bi=()=>{K.query.action!=="create-pool"&&K.query.actions!=="new-position"&&(qi(y,a),qe(),w.value.address&&y.value.getAccount(w.value.address),le.updateCurrentPools(a.value.poolAddress,I.value)),le.setPoolConfigList(I.value,se.value.filterCoinsObj)},Wi=k(()=>{var u,D,P,Z,V,z;const o=(P=j.value[(D=(u=m)==null?void 0:u.value)==null?void 0:D.address])==null?void 0:P.price,n=(z=j.value[(V=(Z=c)==null?void 0:Z.value)==null?void 0:V.address])==null?void 0:z.price;return!!(o&&n)});return ce(()=>[K,M.value.tokensObj],([o,n])=>{var u;n&&!J(n)&&(c.value||(c.value=M.value.tokensObj[(u=o==null?void 0:o.query)==null?void 0:u.toCoin]))},{immediate:!0,deep:!0}),{positionError:He,decimalUi:ee,poolInfo:a,fromCoinAmount:f,toCoinAmount:p,fromCoin:m,toCoin:c,theme:he,showFromCoinLock:C,showToCoinLock:Y,fromCoinBlance:Q,toCoinBlance:v,maxBtnSelect:Re,halfBtnSelect:Fe,fixedFromCoin:oe,openCoinSelect:A,currentCoinKey:we,existingCoins:_e,lastSelectCoin:fe,showCoinSelect:Ie,onCoinSelect:Ge,liquidityTotalAmount:L,toggle:zi,onInput:mi,isInputTotalAmount:ke,isViewDetail:ni,addLiquidityBtnDisabled:De,addLiquidityBtnText:be,isShowTokenWarning:Ke,chainName:I,closeTokenWarning:gi,warningFromCoin:Se,warningToCoin:Je,isShowLiquidityModal:ei,currentPrice:Qe,currentPriceReverse:ui,currentPriceTab:T,minPrice:g,maxPrice:d,toAdd:Te,direction:G,wallet:w,getAddLiquidityType:ri,clickRefresh:bi,isShowtotalAmount:Wi,isAutoStakeFarming:$e,farmPoolInfo:h,getFarmsPoolInfo:x,positionInfoDetail:q,getTokenSource:Ee}}});const Ta={class:"new-liquidity-right"},Sa={class:"deposit-title"},Na={class:"card-container"},Aa={key:0,class:"lock"},La={class:"card-item"},Ia={class:"card-item"},qa={key:0,class:"total-amount"},$a=t("span",null,"Total Amount",-1);function Ma(e,l,Ce,se,I,le){const M=Ui,N=no,w=Fi,K=co,a=ji,C=ao,Y=vo,he=mo,Le=fo,Q=Ki;return _(),F("div",Ta,[t("div",Sa,[re(M,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),t("div",Na,[e.positionError?(_(),F("div",Aa,[re(N)])):X("",!0),t("div",La,[re(w,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":l[0]||(l[0]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:l[1]||(l[1]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:l[2]||(l[2]=v=>e.halfBtnSelect("fromCoin")),onOnInput:l[3]||(l[3]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.positionError?(_(),Be(K,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):X("",!0)]),t("div",Ia,[re(w,{modelValue:e.toCoinAmount,"onUpdate:modelValue":l[4]||(l[4]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:l[5]||(l[5]=v=>e.maxBtnSelect("toCoin")),onOnHalf:l[6]||(l[6]=v=>e.halfBtnSelect("toCoin")),onOnInput:l[7]||(l[7]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.positionError?(_(),Be(K,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):X("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(_(),F("img",{key:1,class:"add",src:go,alt:"",onClick:l[8]||(l[8]=(...v)=>e.toggle&&e.toggle(...v))})):X("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(_(),F("img",{key:2,class:"add",src:bo,alt:"",onClick:l[9]||(l[9]=(...v)=>e.toggle&&e.toggle(...v))})):X("",!0)]),e.isShowtotalAmount?(_(),F("div",qa,[$a,t("span",null,$(e.liquidityTotalAmount),1)])):X("",!0),re(a,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),re(C,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:l[10]||(l[10]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ze(()=>[We($(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(_(),Be(Y,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:l[11]||(l[11]=v=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):X("",!0),e.isViewDetail?(_(),Be(he,{key:2,"pool-info":e.poolInfo,"farm-pool-info":e.farmPoolInfo,"position-info":e.positionInfoDetail,"is-auto-stake-farming":e.isAutoStakeFarming,onOnClose:l[12]||(l[12]=v=>e.isViewDetail=!1)},null,8,["pool-info","farm-pool-info","position-info","is-auto-stake-farming"])):X("",!0),e.isShowLiquidityModal?(_(),Be(Le,{key:3,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:l[13]||(l[13]=v=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):X("",!0),e.chainName=="Sui"?(_(),Be(Q,{key:4,"pool-info":e.poolInfo,"is-active":!e.showFromCoinLock&&!e.showToCoinLock,"is-auto-stake-farming":e.isAutoStakeFarming,onSendFarmsPoolInfo:e.getFarmsPoolInfo},null,8,["pool-info","is-active","is-auto-stake-farming","onSendFarmsPoolInfo"])):X("",!0)])}const Hi=di(Pa,[["render",Ma]]),Ra=ci({components:{NewLiquidityLeft:Xi,NewLiquidityRight:Hi},setup(){const e=Ai(),l=k(()=>e),Ce=k(()=>l.value.farmsPoolObj);Oi(()=>{uo(),le.setPoolsLoading(!0)}),ce(()=>Ce.value,M=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: deposit.vue:41 ~ watch ~ newVal:",M),M&&J(M)&&e.getFarmsPoolList(!0)},{immediate:!0});const se=Ti(),I=Si();k(()=>I);const le=Ni();return{tickList:Xe,route:se}}});const Oa={key:0,class:"loading-spin-liquidity loading-global"},Ba={class:"privide-liquidity"};function Ua(e,l,Ce,se,I,le){var K,a;const M=to,N=Xi,w=Hi;return _(),F(_i,null,[!e.tickList&&((a=(K=e.route)==null?void 0:K.query)!=null&&a.poolAddress)?(_(),F("div",Oa,[re(M)])):X("",!0),t("div",Ba,[re(N),re(w)])],64)}const Pt=di(Ra,[["render",Ua],["__scopeId","data-v-24e8414d"]]);export{Pt as default};
