import{a as Pe,r as M,s as ft,m as h,A as de,b as Qe,e as qe,l as ct,o as $,f as z,h as t,i as F,q as pt,I as Ue,M as _t,p as We,k as je,u as K,x as R,j as fe,w as ce,P as ht,N as dt,G as ie,F as Je,E as Ye,B as Ee,c as ge,$ as qt,z as gt,y as lt,L as Lt,fi as Nt,D as bt,Y as Bt,C as Rt,O as Mt}from"./entry.66997069.js";/* empty css              */import{u as it}from"./useCurrentPosition.6ea6e8b0.js";import{u as Ve}from"./pool.c08eaf24.js";import{u as Ot}from"./token.c41b5710.js";import{u as Ke,b as ke,C as tt,n as he,T as Re}from"./index.ecba1457.js";import{c as ve,g as Ft,n as Dt,d as Ce,o as Ut,b as Ge,a as pe,h as me,p as ze,e as et}from"./common.edf9ae9c.js";import{a as yt,u as Se,b as Me,h as wt,c as zt}from"./index.5f9fac2e.js";import{u as Wt}from"./usePoolList.e1c6b9d4.js";import{_ as jt}from"./back.c3fdc7a8.js";import{I as Et}from"./icon-slippage.70703a40.js";import{I as Vt}from"./icon-refresh.09f3cdb5.js";/* empty css              */import{s as Xe,m as Ht,l as Xt,b as Gt,a as Jt}from"./transform.c672907f.js";import"./decimal.a2826370.js";import{D as ee}from"./decimal.765d8738.js";import{l as Yt,a as Qt}from"./linearClosed.d07a7d12.js";import{C as ye}from"./coin-img-warning.8d73ac35.js";import{N as kt}from"./sui-status-block.9f400079.js";import{P as Pt}from"./pos-current-price.55906674.js";import{N as Kt}from"./sui-position-range.30233fbd.js";import{s as rt}from"./formatter.0cda4d5e.js";import{u as St}from"./useRate.bd1b83b5.js";import{u as It}from"./useSDK.0d9b5137.js";import{S as At}from"./select-tab.d0fce5d4.js";import{I as ot}from"./input-lock.38a7faeb.js";import{T as nt}from"./token-input-block.070b248b.js";/* empty css              */import{u as $t}from"./notifi.d704f62a.js";/* empty css              */import{i as xt}from"./import-icon.de3e6c66.js";import{_ as Zt}from"./apr-tips.1d887d0c.js";import{u as eo}from"./farms.d4f74a02.js";import"./usePositionList.4a96e61d.js";import"./useToken.e9b1a10f.js";import"./fetchFun.ff4aae28.js";import"./swap-setting.4272f885.js";/* empty css              */import"./icon-error_2x.7c7f834c.js";import"./coin-img.e1d02306.js";import"./useWindowWidth.62f53e34.js";import"./lock.35e1d915.js";import"./index.91906b25.js";import"./token-dropdown-select.ef0efa17.js";import"./useDebounceFunction.d051f5b6.js";import"./useWhale.df566f71.js";import"./icon_fee_2x.aef97bd6.js";import"./icon_rewards_2x.c8ea54c6.js";const to=Pe({components:{IconSlippage:Et,IconRefresh:Vt},props:{poolInfo:{type:Object,default:()=>({})}},setup(e,L){const b=M(!1),O=M(null),q=M(0),i=M(20),p=yt(),P=Se(),_=M(!1);ft(()=>{clearInterval(O.value)});const m=()=>{O.value=setInterval(()=>{var c;_.value||q.value<i.value&&(q.value+=1,q.value===i.value&&((c=e==null?void 0:e.poolInfo)!=null&&c.poolAddress&&p.updateCurrentPools(e.poolInfo.poolAddress,P.chainName),q.value=0))},1e3)},o=h(()=>P.slippage),l=()=>{L.emit("clearAll")},s=M(!1),u=()=>{q.value=0,s.value=!0,L.emit("clickRefresh"),setTimeout(()=>{s.value=!1},1e3)};de(()=>e.poolInfo,c=>{c&&!O.value&&m()},{immediate:!0});const S=Qe(),w=h(()=>P.chainName);return{clickRefresh:u,isShowSwapSetting:b,countdown:q,autoRefreshTime:i,slippage:o,clearAll:l,checkNullObj:ve,router:S,loading:_,chainName:w,refresh:s}}});const oo={class:"new-position-title"},no={class:"left"},io={class:"right"};function so(e,L,b,O,q,i){const p=jt,P=ct("IconSlippage"),_=ct("IconRefresh");return $(),z("div",oo,[t("div",no,[F(p)]),t("div",io,[F(P),F(_,{refresh:e.refresh,onClickRefresh:e.clickRefresh},null,8,["refresh","onClickRefresh"])])])}const ao=qe(to,[["render",so],["__scopeId","data-v-5e7ee742"]]);function vt(e,L,b){const O=new ee(10).pow(L-b);return new ee(1.0001).pow(e).mul(O)}const lo=Pe({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,coinA:{decimal:6},coinB:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,L){const b=M(1),O=M(""),q=M(""),i=h(()=>{var n,d,r;return l.sqrtPriceX64ToPrice((n=e.poolInfo)==null?void 0:n.current_sqrt_price,(d=e.poolInfo)==null?void 0:d.coinA.decimals,(r=e.poolInfo)==null?void 0:r.coinB.decimals).toString()}),p=h(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(i.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(i.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),P=h(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(i.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(i.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),_=Se(),m=h(()=>_),o=h(()=>m.value.chainName?Me(m.value.chainName):{}),{TickMath:l,getNearestTickByTick:s}=o.value,u=()=>{const n=b.value/2;b.value=n,c(e.poolInfo,n)},S=()=>{const n=b.value*2;b.value=n,c(e.poolInfo,n)},w=(n=[])=>{let d=6;const r=Math.abs(Number(n[0])-Number(n[n.length-1]));return r>=6?d=0:r>=1?d=1:r>=.1?d=2:r>=.01?d=3:r>=.001?d=4:r>=1e-4?d=5:r>=1e-5?d=6:r>=1e-6?d=7:r>=1e-7&&(d=8),d},c=(n,d=1)=>{if(n&&n.coinA&&!e.chartLoading&&e.minPrice&&e.maxPrice){const r=Number(e.poolInfo.current_tick_index);let A=r+100*d,j=r-100*d,Y,T;if(e.maxPrice==="âˆž")T=o.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?T=l.priceToTickIndex(new ee(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):T=l.priceToTickIndex(new ee(1).div(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{T=443636}if(e.minPrice==="0")Y=o.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?Y=l.priceToTickIndex(new ee(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):Y=l.priceToTickIndex(new ee(1).div(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{Y=-443636}let D=0;if(e.currentPriceTab!=="full range"){if(r>=Y&&r<=T){const a=r-Y,J=T-r;D=Math.max(Math.abs(a),Math.abs(J))}else r<Y?D=Math.abs(T-r):D=Math.abs(r-Y);A=r+D+20*d,j=r-D-20*d}else{const a=(Math.abs(r)>5e3,2e4);A=r+a*d,j=r-a*d}j<-443636&&(j=-443636),A>443636&&(A=443636);const x=new ee(n.poolLiquidity).div(Math.pow(10,8)).toString(),k=e.tickList,N=[],X=[];let W={};for(let a=0;a<k.length;a++){if(W=k[a],W.index<=r&&W.index>=j){if(N.length<1&&a!==0){const J=k[a-1];N.unshift({...J,index:j})}N.unshift(W)}else if(W.index>r&&W.index<=A&&(X.push(W),N.length<1&&a!==0)){const J=k[a-1];N.push({...J,index:j})}if(W.index>A){const J=k[a];if(X.push({...J,index:A}),N.length<1&&a!==0){const U=k[a-1];N.push({...U,index:j})}break}}let Z="0";for(let a=N.length-1;a>=0;a--)Z=new ee(Z).plus(new ee(N[a].liquidityNet.toString()).div(Math.pow(10,8))).toString(),N[a].liquityAmount=Z;let E=x;for(let a=0;a<X.length;a++)E=new ee(E).plus(new ee(X[a].liquidityNet.toString()).div(Math.pow(10,8))).toString(),X[a].liquityAmount=E;let V=[];const G=k&&k.length>0?{index:r,liquityAmount:Number(x)}:{index:r,liquityAmount:0};(N.length>0||X.length>0)&&(V=[...N.reverse(),G,...X],e.direction||(V=V.reverse()));const H=[];k.forEach(a=>{H.push({...a,liquidityGross:a.liquidityGross.toString(),liquidityNet:a.liquidityNet.toString()})}),B(V,j,A,Y,T,r)}};let g=M(!0);pt(()=>{document.body.clientWidth<750?g.value=!1:g.value=!0,window.onresize=()=>{document.body.clientWidth<750?g.value=!1:g.value=!0,c(e.poolInfo,b.value)}});const B=(n,d,r,A,j,Y)=>{let T,D;e.direction?(T=e.before7dContractPriceLowest?l.priceToTickIndex(new ee(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",D=e.before7dContractPriceHighest?l.priceToTickIndex(new ee(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):""):(T=e.before7dContractPriceLowest?l.priceToTickIndex(new ee(1).div(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",D=e.before7dContractPriceHighest?l.priceToTickIndex(new ee(1).div(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"");const x={top:30,right:35,bottom:20,left:55};let k,N;g.value?(k=590-x.left-x.right,N=205-x.top-x.bottom):(k=340-x.left-x.right,N=205-x.top-x.bottom);const X=r-d,W=parseInt(String(X/4));let Z=[d+W/4,d+W,d+2*W,r-W,r-W/4];const E=d,V=r,G=k/(V-E);e.currentPriceTab==="full range"&&(Z=[d,d+2*W,r]);const H=Z.map(f=>e.direction?vt(f,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString():new ee(1).div(vt(f,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)).toString());w(H),Xe("#chart").selectAll("*").remove();const a=Xe("#chart").attr("width",k+x.left+x.right).attr("height",N+x.top+x.bottom).append("g").attr("transform",`translate(${x.left},${x.right})`),J=Ht(n,function(f){return Number(Math.abs(f.liquityAmount))})||0,U=Xt().range([0,N]).domain([J,0]);Gt().rangeRound([0,k]).padding(.1);const le=a.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");m.value.theme=="default"?le.attr("x",function(f,v){return v===0?0:e.direction?Math.abs(f.index-E)*G:Math.abs(V-f.index)*G}).attr("y",function(f,v){return e.direction?v===n.length-1?0:U(f.liquityAmount):v===n.length-1?0:U(n[v+1].liquityAmount)}).attr("width",function(f,v){return v===0&&n.length===1&&f.liquityAmount>0?k:(e.direction,v!==n.length-1?Math.abs(n[v+1].index-f.index)*G:0)}).attr("height",function(f,v){return v===0&&n.length===1&&f.liquityAmount>0?N:e.direction?v===n.length-1?0:N-U(f.liquityAmount):v===n.length-1?0:N-U(n[v+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):le.attr("x",function(f,v){return v===0?0:e.direction?Math.abs(f.index-E)*G:Math.abs(V-f.index)*G}).attr("y",function(f,v){return e.direction?v===n.length-1?0:U(Math.abs(f.liquityAmount)):v===n.length-1?0:U(Math.abs(n[v+1].liquityAmount))}).attr("width",function(f,v){return v===0&&n.length===1&&f.liquityAmount>0?k:(e.direction,v!==n.length-1?Math.abs(n[v+1].index-f.index)*G:0)}).attr("height",function(f,v){if(v===0&&n.length===1&&f.liquityAmount>0)return N;if(e.direction)return v===n.length-1?0:Number(f.liquityAmount)?N-U(Math.abs(f.liquityAmount)):0;{if(v===n.length-1)return 0;const re=N-U(Math.abs(n[v+1].liquityAmount));return Number(n[v+1].liquityAmount)?re:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const te=a.append("g");te.append("line").attr("x1",0).attr("y1",155).attr("x2",k).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),te.append("g");let we=0;e.direction?we=Math.abs(Y-E)*G:we=Math.abs(Y-V)*G,(m.value.theme=="default"?a.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):a.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+we+", 0)"),Xe("#triangle").attr("width",8).attr("height",4);let Ne=[[0,0],[4,4],[8,0]],xe=Yt().x(function(f){return f[0]}).y(function(f){return f[1]}).curve(Qt);const Te=we-4;a.append("path").attr("d",xe(Ne)).style("fill",m.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+Te+", 0)");let Q,Ie,Ae,y;e.direction?(Q=A<E?-100:parseInt(String(Math.abs(A-E)*G)),Ie=j<E?-100:parseInt(String(Math.abs(j-E)*G)),Ae=T<E?-100:Math.abs(T-E)*G,y=D<E?-100:Math.abs(D-E)*G):(Ie=A<E?-100:Math.abs(V-A)*G,Q=j<E?-100:Math.abs(V-j)*G,y=T<E?-100:Math.abs(V-T)*G,Ae=D<E?-100:Math.abs(V-D)*G),e.minPrice==="0"&&(Q=0),e.maxPrice==="âˆž"&&(Ie=k),g.value?O.value=k-Q+60+"px":O.value=k-Q+52+"px",q.value=Ie+74+"px",T&&Ae<k&&a.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ae+", 0)"),D&&y<k&&a.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+y+", 0)");const C=Jt().extent([[0,0],[k,N]]).handleSize(30).on("end",oe);a.append("g").attr("class","brush").call(C).call(C.move,[Q,Ie]);function oe(f){if(!f.sourceEvent||!f.selection)return;g.value?O.value=k-f.selection[0]+60+"px":O.value=k-f.selection[0]+52+"px",q.value=f.selection[1]+74+"px";let v,re,_e=0,ne=0;e.direction?(_e=s(parseInt(String(f.selection[0]/G+E)),Number(e.poolInfo.tickSpacing)),v=l.tickIndexToPrice(_e,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),ne=s(parseInt(String(f.selection[1]/G+E)),Number(e.poolInfo.tickSpacing)),re=l.tickIndexToPrice(ne,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()):(ne=s(V-f.selection[0]/G,Number(e.poolInfo.tickSpacing)),v=1/l.tickIndexToPrice(ne,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),_e=s(V-f.selection[1]/G,Number(e.poolInfo.tickSpacing)),re=1/l.tickIndexToPrice(_e,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()),L.emit("onChangeMinPrice",String(Ce(String(v),6))),L.emit("onChangeMaxPrice",String(Ce(String(re),6)))}m.value.theme=="default"?Xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):Xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};M(""),de(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([n,d,r,A,j])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1125 ~ dataProcessing ~ poolInfo:",n),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ tickList:",j),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ currentPriceTab:",A),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ maxPrice:",r),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ minPrice:",d),n&&d&&r&&A&&j&&j.length>0&&(A!=="Custom"&&console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1131 ~ dataProcessing ~ dataProcessing:"),c(n,b.value))},{immediate:!0});const I=M(!0);return de(()=>e.chartLoading,(n,d)=>{n!==d&&(I.value=n)},{immediate:!0,deep:!0}),{store:m,loading:I,zoomOut:u,zoomIn:S,rangeSizeLower:p,rangeSizeUpper:P,rangeSizeLowerPosition:O,rangeSizeUpperPosition:q,decimalFormat:Ft,numberformat:Dt}}});const ro=e=>(We("data-v-70d71659"),e=e(),je(),e),uo={class:"chart-box"},co={class:"chart"},vo=ro(()=>t("svg",{id:"chart"},null,-1)),mo=[vo];function fo(e,L,b,O,q,i){return $(),z("div",uo,[Ue(t("div",co,mo,512),[[_t,!e.loading]])])}const po=qe(lo,[["render",fo],["__scopeId","data-v-70d71659"]]),Ze=e=>(We("data-v-c9ff9e26"),e=e(),je(),e),_o={class:"new-position-info"},ho={class:"pool-info"},go={class:"info"},bo={class:"coin-logo"},yo={class:"name-fee"},wo={class:"name-copy"},ko=["href"],Po=Ze(()=>t("use",{"xlink:href":"#icon-icon_copy2"},null,-1)),So=[Po],Io={class:"pool-fee"},Ao=Ze(()=>t("span",null,"Fee tier",-1)),$o={class:"price-info"},xo={class:"price-and-chart"},To={class:"top"},Co={class:"position-range position-range-warp"},qo=Ze(()=>t("span",{class:"position-range-title"}," Position Range ",-1)),Lo={class:"bottom"},No=Ze(()=>t("div",{class:"chat-mask"},null,-1)),Bo={class:"lever"},Ro={class:"lever-title"},Mo=Ze(()=>t("div",{class:"tit"},[t("span",null," Leverage "),t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon_tips"})])],-1)),Oo={class:"lever-text"},Fo=Pe({__name:"sui-position-info",setup(e){const L=Ve(),b=h(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:643 ~ currentPositionInfo ~ suiPoolStore.currentPositionInfo:",L.currentPositionInfo),L.currentPositionInfo)),O=h(()=>L.poolsObj),q=Se(),i=h(()=>q.currentExplorer);M(!0);const p=(l,s)=>l!=="0"&&s!=="âˆž"?Ge(1/(1-Number((l/s)**.25)),2)+"x":"1x",P=h(()=>{var l,s,u;return(l=b==null?void 0:b.value)!=null&&l.minPrice&&b.value.maxPrice?p((s=b==null?void 0:b.value)==null?void 0:s.minPrice,(u=b==null?void 0:b.value)==null?void 0:u.maxPrice):"--"}),_=Me("Sui"),m=M([]),o=async l=>{const{list:s}=await _.getTicks(l),u=s?_.getTickDataFromUrlData(s):[];console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:593 ~ resetTickList ~ list:",u),m.value=u};return de(()=>[b.value,O.value],([l,s])=>{l&&!ve(l)&&s&&!ve(s)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:417 ~ poolsObj:",s),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:418 ~ newValue:",l),o(s[l.pool]))},{immediate:!0}),(l,s)=>{var S,w,c,g,B,I,n;const u=ht;return $(),z("div",_o,[t("div",ho,[t("div",go,[t("div",bo,[F(ye,{"token-info":(S=b.value)==null?void 0:S.coinA},null,8,["token-info"]),F(ye,{"token-info":(w=b.value)==null?void 0:w.coinB},null,8,["token-info"])]),t("div",yo,[t("div",wo,[t("a",{class:"position-name",href:K(Ut)(i.value,"nftAddress",(c=b.value)==null?void 0:c.nftHash),target:"_blank"},R((g=b.value)==null?void 0:g.positionName),9,ko),($(),z("svg",{class:"copy-icon","aria-hidden":"true",onClick:s[0]||(s[0]=d=>{var r;return K(q).copy((r=b.value)==null?void 0:r.nftHash)})},So))]),t("div",Io,[Ao,fe(" "+R((B=b.value)==null?void 0:B.feeRate),1)])])]),F(kt,{"position-info":b.value},null,8,["position-info"])]),t("div",$o,[t("div",xo,[t("div",To,[F(Pt,{"pool-info":b.value},null,8,["pool-info"]),t("div",Co,[qo,F(Kt,{"position-info":b.value},null,8,["position-info"])])]),t("div",Lo,[F(po,{"pool-info":b.value,"tick-list":m.value,"min-price":(I=b.value)==null?void 0:I.minPrice,"max-price":(n=b.value)==null?void 0:n.maxPrice,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),No,t("div",Bo,[t("div",Ro,[F(u,{"overlay-class-name":"lever-tooltip ant-tooltip-text-color"},{title:ce(()=>[fe("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:ce(()=>[Mo]),_:1})]),t("div",Oo,R(P.value),1)])])])])])}}});const Do=qe(Fo,[["__scopeId","data-v-c9ff9e26"]]),He=e=>(We("data-v-705b5bbf"),e=e(),je(),e),Uo={class:"liquidity-card-box"},zo={class:"liquidity-title"},Wo={class:"liquidity-usd"},jo=He(()=>t("span",null,"Liquidity",-1)),Eo={class:"liquidity-ratio"},Vo={class:"coin-ratio"},Ho={class:"coin-a-ratio"},Xo={class:"coin-b-ratio"},Go={class:"ratio-progress"},Jo={class:"base-quote-num"},Yo={class:"base-coin-num"},Qo=He(()=>t("span",null,"Base",-1)),Ko={class:"token-amount"},Zo={key:0,class:"after"},en={class:"quote-coin-num"},tn=He(()=>t("span",null,"Quote",-1)),on={class:"token-amount"},nn={key:0,class:"after"},sn={class:"pending-yield"},an={class:"left"},ln=He(()=>t("div",{class:"pending-yield-title"},"Pending Yield",-1)),rn={key:0,class:"after"},un={class:"right"},cn={class:"fees-rewards"},dn={class:"fees-rewards-item"},vn=He(()=>t("span",null,"Fees",-1)),mn={class:"token-amount"},fn={key:0,class:"after"},pn=He(()=>t("span",null,"Mining Rewards",-1)),_n={class:"token-amount"},hn={key:0,class:"after"},gn=Pe({__name:"sui-position-liquidity",setup(e){const L=Se(),b=Ke(),O=h(()=>b),q=Ve(),i=h(()=>q.currentPositionInfo),p=h(()=>{var A;return q.positionPendingFees[(A=i==null?void 0:i.value)==null?void 0:A.positionId]}),P=h(()=>{var A;return q.positionPendingRewards[(A=i==null?void 0:i.value)==null?void 0:A.positionId]}),_=h(()=>{var j,Y,T,D;let A=me(0);return(j=p==null?void 0:p.value)!=null&&j.feesAmountUSD&&(A=A.add((Y=p.value)==null?void 0:Y.feesAmountUSD)),(T=P==null?void 0:P.value)!=null&&T.rewardsAmount&&(A=A.add((D=P.value)==null?void 0:D.rewardsAmount)),A.toNumber()}),m=M(!1),{setIsShowSuccess:o,setIsShowRejected:l,setIsShowWaiting:s,setTransactionDesc:u,setTransactionTxid:S}=L,w=Me("Sui"),{getCurrentPosition:c}=it(),g=async()=>{var j,Y;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1233 ~ claimFeesAndRewards ~ currentPositionInfo.value:",i.value),m.value=!0;let A={coinTypeA:i.value.defaultCoinaAddress,coinTypeB:i.value.defaultCoinbAddress,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:i.value.pool,pos_index:i.value.positionIndex,rewarder_nums:P.value.rewarderAmountOwed.length,collect_fee:!0};A.coinTypeC=P.value.rewarderAmountOwed[0]?P.value.rewarderAmountOwed[0].tokenInfo.address:"",A.coinTypeD=P.value.rewarderAmountOwed[1]?P.value.rewarderAmountOwed[1].tokenInfo.address:"",A.coinTypeE=P.value.rewarderAmountOwed[2]?P.value.rewarderAmountOwed[2].tokenInfo.address:"",s(!0),u();try{let T;A.pos_index=i.value.pos_object_id;const D=await w.getCollectRewarderTransactionPayload(A,i.value),x=await w.signAndExecuteTransactionBlock(O.value.currentWallet,D.txb,D.payloadParams);if(T=w.handleTx(x),T&&T.hash){S(T.hash),s(!1),o(!0);const k={title:"Claim",desc:"",hash:T.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};k.res=T.res,w.showTransitionPending(k),await w.watchTransaction(k)&&(c((j=i==null?void 0:i.value)==null?void 0:j.positionId,(Y=i==null?void 0:i.value)==null?void 0:Y.positionSource),setTimeout(()=>{w.getAccount(O.value.address),m.value=!1},3e3))}else console.log("0310###toClaimRewards###else###"),s(!1),l(!0),m.value=!1}catch(T){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1225 ~ claimFeesAndRewards ~ error:",T),s(!1),l(!0),m.value=!1}},B=h(()=>q.positionDetailCurrentTab),I=h(()=>q.positionActionFromCoinAmount),n=h(()=>q.positionActionToCoinAmount),d=h(()=>{if(B.value=="increase")return I.value>0?me(i.value.coinaAmount).add(me(I.value)).toString():"";if(I.value>0){const A=me(i.value.coinaAmount).minus(me(I.value)).toString();return A<0?"0":A}else return""}),r=h(()=>{if(B.value=="increase")return n.value>0?me(i.value.coinbAmount).add(me(n.value)).toString():"";if(n.value>0){const A=me(i.value.coinbAmount).minus(me(n.value)).toString();return A<0?"0":A}else return""});return(A,j)=>{var T,D,x,k,N,X,W,Z,E,V,G,H,a,J,U,ae,le;const Y=Ee;return $(),z("div",Uo,[t("div",zo,[t("div",Wo,[jo,t("div",null,"$"+R(K(pe)((T=i.value)==null?void 0:T.positionAmountUSD,2)),1)]),t("div",Eo,[t("div",Vo,[t("div",Ho,[F(ye,{"token-info":(D=i.value)==null?void 0:D.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R((k=(x=i.value)==null?void 0:x.coinA)==null?void 0:k.symbol),1),t("span",null,R((N=i.value)==null?void 0:N.fromPercent)+"%",1)]),t("div",Xo,[F(ye,{"token-info":(X=i.value)==null?void 0:X.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R((Z=(W=i.value)==null?void 0:W.coinB)==null?void 0:Z.symbol),1),t("span",null,R((E=i.value)==null?void 0:E.toPercent)+"%",1)])]),t("div",Go,[t("div",{class:"from-percent",style:dt({width:((V=i.value)==null?void 0:V.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:dt({width:((G=i.value)==null?void 0:G.toPercent)+"%"})},null,4)])])]),t("div",Jo,[t("div",Yo,[Qo,t("div",Ko,[F(ye,{"token-info":(H=i.value)==null?void 0:H.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(pe)(K(Ce)((a=i.value)==null?void 0:a.coinaAmount))),1)]),d.value?($(),z("div",Zo,R(K(pe)(d.value))+" after ",1)):ie("",!0)]),t("div",en,[tn,t("div",on,[F(ye,{"token-info":(J=i.value)==null?void 0:J.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(pe)(K(Ce)((U=i.value)==null?void 0:U.coinbAmount))),1)]),r.value?($(),z("div",nn,R(K(pe)(r.value))+" after ",1)):ie("",!0)])]),t("div",sn,[t("div",an,[ln,t("div",null,[fe(R(_.value>0&&_.value<.01?"<$0.01":"$"+K(pe)(_.value,2))+" ",1),_.value>0?($(),z("span",rn,"$0 after")):ie("",!0)])]),t("div",un,[F(Y,{class:"claim-all",loading:m.value,disabled:m.value||_.value==0,onClick:g},{default:ce(()=>[fe("Claim")]),_:1},8,["loading","disabled"])])]),t("div",cn,[t("div",dn,[($(!0),z(Je,null,Ye((ae=p.value)==null?void 0:ae.feesList,te=>($(),z("div",{key:te},[vn,t("div",mn,[F(ye,{"token-info":te.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(rt)(te.amount,"",te.tokenInfo.decimals)),1)]),(d.value||r.value)&&!K(ve)(i.value)?($(),z("div",fn," 0 after ")):ie("",!0)]))),128)),($(!0),z(Je,null,Ye((le=P.value)==null?void 0:le.rewarderAmountOwed,te=>($(),z("div",{key:te},[pn,t("div",_n,[F(ye,{"token-info":te.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(rt)(te.amount,"",te.tokenInfo.decimals)),1)]),(d.value||r.value)&&!K(ve)(i.value)?($(),z("div",hn," 0 after ")):ie("",!0)]))),128))])])])}}});const mt=qe(gn,[["__scopeId","data-v-705b5bbf"]]);function Tt(){const e=Ve();h(()=>e.currentPositionInfo);const L=Se(),b=h(()=>L.slippage),{getTransactionBlock:O}=wt("Sui"),q=It(),i=(P,_,m,o,l,s,u,S=0,w=0)=>{const c=new ke(P),{coinAmountA:g,coinAmountB:B,liquidityAmount:I}=tt.estLiquidityAndcoinAmountFromOneAmounts(m,o,c,_,u,he(b.value).div(100).toNumber(),new ke(l)),n=s?w:S,d=s?S:w;return{tokenMaxA:s?ze(B.toString(),d):ze(g.toString(),n),tokenMaxB:s?ze(g.toString(),n):ze(B.toString(),d),tokenMaxAOrigin:s?B.toString():g.toString(),tokenMaxBorigin:s?g.toString():B.toString(),liquidityAmount:I.toString()}};return{preAdd:i,getAddLiquidityTransactionPayload:async(P,_,m,o,l,s,u,S="",w="",c="")=>{const g=await q.clmmSdk.Pool.getPool(l),{coinTypeA:B,coinTypeB:I}=g;console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:69 ~ getAddLiquidityTransactionPayload ~ contratcPoolInfo:",g);const n=Re.sqrtPriceX64ToTickIndex(new ke(g.current_sqrt_price));let d,r;if(n>=m&&n<=o){const{tokenMaxAOrigin:T,tokenMaxBorigin:D}=i(P,_,m,o,g.current_sqrt_price,s,!0);console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:91 ~ getAddLiquidityTransactionPayload ~ tokenMaxBorigin:",D),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:91 ~ getAddLiquidityTransactionPayload ~ tokenMaxAOrigin:",T),d=_?P:s?D:T,r=_?s?T:D:P}else n>o?(d=0,r=P):n<m&&(d=P,r=0);let A=[];if(S){const{rewarder_infos:T}=g;A=T.map(D=>D.coinAddress)}let j,Y;if(u==="clmm"){const T={coinTypeA:B,coinTypeB:I,amount_a:d,amount_b:r,pool_id:l,fix_amount_a:_,slippage:he(b.value).div(100).toNumber(),is_open:!S,tick_lower:m,tick_upper:o,collect_fee:!!S,rewarder_coin_types:A,pos_id:w};console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:98 ~ getAddLiquidityTransactionPayload ~ parameter:",T);const D={slippage:he(b.value).div(100).toNumber(),curSqrtPrice:new ke(g.current_sqrt_price)};j=await q.clmmSdk.Position.createAddLiquidityFixTokenPayload(T,D),Y={action:S?"IncreaseLiquidity":"",txbParams:{parameter:T,gasEstimateArg:D}}}else{const T={pool_id:c,coinTypeA:B,coinTypeB:I,clmm_pool_id:l,amount_a:d,amount_b:r,fix_amount_a:_,tick_lower:m,tick_upper:o};console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:127 ~ getAddLiquidityTransactionPayload ~ parameter:",T),j=await q.peripherySdk.Farms.openPositionAddLiquidityStakePaylod(T),Y={action:"FarmingOpenAndAddLiquidity",txbParams:T}}return{txb:O(j),payloadParams:Y}}}}const st=e=>(We("data-v-40c7c844"),e=e(),je(),e),bn=st(()=>t("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),yn={class:"modal-content"},wn={class:"pool-info"},kn={class:"left"},Pn={class:"pool-name"},Sn={class:"right"},In={class:"coin-info"},An={class:"from-coin-info"},$n={class:"left"},xn={class:"coin-amount"},Tn={class:"coin-symbol"},Cn={class:"right"},qn={class:"to-coin-info"},Ln={class:"left"},Nn={class:"coin-amount"},Bn={class:"coin-symbol"},Rn={class:"right"},Mn={class:"select-range"},On=st(()=>t("div",{class:"select-range-title"},"Selected Range",-1)),Fn={class:"price-conent"},Dn={class:"current-price"},Un={class:"price-range-block-content"},zn={class:"price-range-block"},Wn={class:"price-item"},jn={class:"title"},En={class:"price"},Vn={key:0,class:"text"},Hn={key:1,class:"text"},Xn={class:"price-item"},Gn={class:"title"},Jn={class:"price"},Yn={key:0,class:"text"},Qn={key:1,class:"text"},Kn={class:"modal-block"},Zn=st(()=>t("div",{class:"label"},"Deposit Ratio",-1)),ei={class:"text"},ti={class:"modal-block"},oi=st(()=>t("div",{class:"label"},"Total Amount",-1)),ni={class:"text"},ii=Pe({__name:"increase-liquidity-modal",props:{fromCoinAmount:{type:String,default:"1245566.008946"},toCoinAmount:{type:String,default:"11111111111"},fixedFromCoin:{type:Boolean,default:!0},showFromCoinLock:{type:Boolean,default:!1},showToCoinLock:{type:Boolean,default:!1},positionTotalAmount:{type:Number,default:0},currentPositionInfo:{type:Object,default:()=>({})},totalAmount:{type:String,default:""}},emits:["toAdd"],setup(e,{emit:L}){const b=L,O=M(!0),q=()=>{b("toAdd")};return(i,p)=>{const P=Ee;return $(),ge(K(qt),{width:"440px",visible:!0,footer:null,title:"Increase",onCancel:p[0]||(p[0]=_=>i.$emit("onClose"))},{closeIcon:ce(()=>[bn]),default:ce(()=>{var _,m,o,l,s,u;return[t("div",yn,[t("div",wn,[t("div",kn,[F(ye,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),F(ye,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),t("div",Pn,[t("span",null,R(e.currentPositionInfo.coinA.symbol)+"Â -Â ",1),t("span",null,R(e.currentPositionInfo.coinB.symbol),1)])]),t("div",Sn,[fe(" Fee tier "),t("span",null,R(e.currentPositionInfo.feeRate),1)])]),t("div",In,[t("div",An,[t("div",$n,[t("div",xn,R(K(pe)(e.fromCoinAmount)||0),1),t("div",Tn,R(e.currentPositionInfo.coinA.symbol),1)]),t("div",Cn,[F(ye,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])]),t("div",qn,[t("div",Ln,[t("div",Nn,R(K(pe)(e.toCoinAmount)||0),1),t("div",Bn,R(e.currentPositionInfo.coinB.symbol),1)]),t("div",Rn,[F(ye,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])])]),t("div",Mn,[On,F(kt,{"position-info":e.currentPositionInfo},null,8,["position-info"])]),t("div",Fn,[t("div",Dn,[F(Pt,{"pool-info":e.currentPositionInfo},null,8,["pool-info"])]),t("div",Un,[t("div",zn,[t("div",Wn,[t("div",jn,R(i.$t("common.minPrice")),1),t("p",En,R(e.currentPositionInfo.minPrice),1),O.value?($(),z("div",Vn,R(e.currentPositionInfo.coinB.symbol)+" per "+R(e.currentPositionInfo.coinA.symbol),1)):($(),z("div",Hn,R(e.currentPositionInfo.coinA.symbol)+" per "+R(e.currentPositionInfo.coinB.symbol),1))]),t("div",Xn,[t("div",Gn,R(i.$t("common.maxPrice")),1),t("p",Jn,R(e.currentPositionInfo.maxPrice),1),O.value?($(),z("div",Yn,R(e.currentPositionInfo.coinB.symbol)+" per "+R(e.currentPositionInfo.coinA.symbol),1)):($(),z("div",Qn,R(e.currentPositionInfo.coinA.symbol)+" per "+R(e.currentPositionInfo.coinB.symbol),1))])])])]),t("div",Kn,[Zn,t("div",ei,R((_=e.currentPositionInfo)==null?void 0:_.fromPercent)+"% "+R((o=(m=e.currentPositionInfo)==null?void 0:m.coinA)==null?void 0:o.symbol)+" / "+R((l=e.currentPositionInfo)==null?void 0:l.toPercent)+"% "+R((u=(s=e.currentPositionInfo)==null?void 0:s.coinB)==null?void 0:u.symbol),1)]),t("div",ti,[oi,t("div",ni,R(e.totalAmount),1)]),F(P,{class:"big-btn",onClick:q},{default:ce(()=>[fe(R("Increase Liquidity"))]),_:1})])]}),_:1})}}});const si=qe(ii,[["__scopeId","data-v-40c7c844"]]),ai={class:"new-position-asset-add-box"},li={class:"add-or-remove"},ri={class:"tab-box"},ui={key:0,class:"from-lock"},ci={key:1,class:"to-lock"},di={key:2,class:"new-sui-exchange to-add-logo"},vi=t("div",{class:"exchange-new"},[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_add1"})])],-1),mi=[vi],fi={class:"amount-btn"},pi={key:2,class:"total-amount"},_i=t("span",null,"Total Amount",-1),hi=Pe({__name:"sui-position-asset-add",setup(e){const L=M(!1),b=[{name:"Increase",logo:""},{name:"Remove",logo:""}],{t:O}=gt(),{getTokenRatePrice:q}=St(),i=Ke(),p=h(()=>i),P=Ve(),_=h(()=>P.currentPositionInfo),m=Se();h(()=>m.slippage);const o=M(),l=M(),s=M(),u=M(),S=M(!0),w=h(()=>p.value.assets&&o.value&&p.value.assets[o.value.address]?ze(p.value.assets[o.value.address].balance,o.value.decimals):0),c=h(()=>p.value.assets&&l.value&&p.value.assets[l.value.address]?ze(p.value.assets[l.value.address].balance,l.value.decimals):0),g=h(()=>_.value.isResever),B=M(),I=M(),{preAdd:n,getAddLiquidityTransactionPayload:d}=Tt(),{getCurrentPosition:r}=it(),A=()=>{var Q;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:1021 ~ updateAmounts ~ updateAmounts:"),!_.value||!s.value&&!u.value)return;const H=S.value?s.value:u.value,a=S.value?o.value.decimals:l.value.decimals,J=me(H).mul(ee.pow(10,a)).toString(),U=(Q=_.value)!=null&&Q.isReverse?!S.value:S.value,ae=_.value.tickLowerIndex,le=_.value.tickUpperIndex,te=_.value.current_sqrt_price,we=o.value.decimals,Le=l.value.decimals,Ne=_.value.isReverse,{tokenMaxA:xe,tokenMaxB:Te}=n(J,U,ae,le,te,Ne,!0,we,Le);console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:859 ~ updateAmounts ~ tokenMaxA, tokenMaxB:",xe,Te),S.value?u.value=Te:s.value=xe,P.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:u})};de(()=>_.value,H=>{if(H&&!ve(H)){o.value=H.coinA,l.value=H.coinB,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:872 ~ newVal:",H);const{tickLowerIndex:a,tickUpperIndex:J,current_tick_index:U,maxPrice:ae}=H;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:882 ~ currentTick,tickLower,tickUpper:",U,a,J),ae=="âˆž"||U>=a&&U<J?(B.value=!1,I.value=!1):U>=J?(s.value="",B.value=!0,I.value=!1):U<a?(B.value=!1,I.value=!0,u.value=""):(B.value=!0,s.value="",I.value=!0,u.value=""),A()}},{immediate:!0}),de(s,(H,a)=>{H&&A(),H==""&&(u.value="")}),de(u,(H,a)=>{H&&A(),H==""&&(s.value="")});const j=h(()=>{var J,U,ae,le;const H=q((J=o==null?void 0:o.value)==null?void 0:J.address,s==null?void 0:s.value,(U=o==null?void 0:o.value)==null?void 0:U.decimals),a=q((ae=l==null?void 0:l.value)==null?void 0:ae.address,u==null?void 0:u.value,(le=l==null?void 0:l.value)==null?void 0:le.decimals);if(H!=="--"&&a!=="--"){const te=me(H).add(a);return rt(te.toString())}return"--"}),Y=h(()=>{const H=Number(s.value)>Number(w.value),a=Number(u.value)>Number(c.value);return!s.value&&!u.value?O("button.enterAmount"):H?O("button.insufficientBalance",{name:o.value.symbol}):a?O("button.insufficientBalance",{name:l.value.symbol}):O("newAdd.addMore")}),T=h(()=>{const H=Number(s.value)>Number(w.value),a=Number(u.value)>Number(c.value);return!!(!s.value&&!u.value||H||a)}),D=M(!1),x=M(!1),{setTransactionTxid:k,setTransactionDesc:N,setIsShowWaiting:X,setIsShowRejected:W,setIsShowSuccess:Z}=m,E=h(()=>m.chainName),V=h(()=>E.value?Me(E.value):{}),G=async()=>{var Ae,y,C,oe,f,v,re,_e,ne;D.value=!1,x.value=!0,k("");const H=B.value?"":`${s.value} ${(Ae=o.value)==null?void 0:Ae.symbol}`,a=I.value?"":`${u.value} ${(y=l.value)==null?void 0:y.symbol}`;N(O("tips.increaseLiquiditySuccess",{from:g.value?a:H,and:!B.value&&!I.value?"and":"",to:g.value?H:a})),X(!0);const J=S.value?s.value:u.value,U=S.value?o.value.decimals:l.value.decimals,ae=me(J).mul(ee.pow(10,U)).toString(),le=(C=_.value)!=null&&C.isReverse?!S.value:S.value,te=_.value.pool,{tickLowerIndex:we,tickUpperIndex:Le,isReverse:Ne,positionIndex:xe,positionId:Te,positionSource:Q,farm_pool_id:Ie}=_.value;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:408 ~ toAdd ~ currentPositionInfo.value:",_.value);try{const se=await d(ae,le,we,Le,te,Ne,Q,xe,Te,Ie);let ue;const be=await V.value.signAndExecuteTransactionBlock(p.value.currentWallet,se==null?void 0:se.txb,se==null?void 0:se.payloadParams);if(ue=V.value.handleTx(be),console.log("toAdd###tx###",ue),ue&&ue.hash){k(ue.hash),X(!1),Z(!0);const $e={title:"Supplied",desc:O("tips.addLiquiditySuccessText",{from:B.value?"":`${g.value?u.value:s.value} ${g.value?(f=l==null?void 0:l.value)==null?void 0:f.symbol:(oe=o.value)==null?void 0:oe.symbol}`,and:!B.value&&!I.value?"and":"",to:I.value?"":`${g.value?s.value:u.value} ${g.value?(re=o==null?void 0:o.value)==null?void 0:re.symbol:(v=l.value)==null?void 0:v.symbol}`}),hash:ue.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",text:`Deopsit ${B.value?"":`${s.value} ${(_e=o.value)==null?void 0:_e.symbol}`} ${!B.value&&!I.value?"and":""} ${I.value?"":`${u.value} ${(ne=l.value)==null?void 0:ne.symbol}`}`};$e.res=ue.res,V.value.showTransitionPending($e),console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:1089 ~ toAdd ~ contract:",V),await V.value.watchTransaction($e)&&setTimeout(()=>{r(_.value.positionId,_.value.positionSource),V.value.getAccount(p.value.address)},1e3)}else X(!1),W(!0);s.value="",u.value="",x.value=!1}catch(se){console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:1103 ~ toAdd ~ error:",se),s.value="",u.value="",x.value=!1,X(!1),W(!0)}};return(H,a)=>{const J=Ee;return $(),z("div",ai,[t("div",li,[t("div",ri,[F(K(At),{"tab-list":b,"current-tab":"Increase",onOnClick:a[0]||(a[0]=U=>{U.name=="Remove"&&K(P).setPositionDetailCurrentTab("remove")})})]),t("div",{class:lt(["card-container",L.value?S.value?"input-block-add-top":"input-block-add-bottom":"input-block-add-top input-block-inactive"])},[F(nt,{modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=U=>s.value=U),"input-value":s.value,"token-info":o.value||null,"has-arrow":!1,onOnInput:a[2]||(a[2]=U=>{L.value=!0,s.value=U,S.value=!0}),onOnFocus:a[3]||(a[3]=()=>{L.value=!0,S.value=!0}),onOnBlur:a[4]||(a[4]=()=>{L.value=!1})},null,8,["modelValue","input-value","token-info"]),F(nt,{modelValue:u.value,"onUpdate:modelValue":a[5]||(a[5]=U=>u.value=U),"input-value":u.value,"token-info":l.value||null,"has-arrow":!1,onOnInput:a[6]||(a[6]=U=>{L.value=!0,u.value=U,S.value=!1}),onOnFocus:a[7]||(a[7]=()=>{L.value=!0,S.value=!1}),onOnBlur:a[8]||(a[8]=()=>{L.value=!1})},null,8,["modelValue","input-value","token-info"]),B.value?($(),z("div",ui,[F(ot,{"from-coin":o.value,"to-coin":l.value},null,8,["from-coin","to-coin"])])):ie("",!0),I.value?($(),z("div",ci,[F(ot,{"from-coin":o.value,"to-coin":l.value},null,8,["from-coin","to-coin"])])):ie("",!0),!B.value&&!I.value?($(),z("div",di,mi)):ie("",!0)],2)]),t("div",fi,[p.value.connected?($(),ge(J,{key:0,class:"big-btn liquidity-btn",disabled:T.value,loading:H.actionLoading,onClick:a[9]||(a[9]=U=>D.value=!0)},{default:ce(()=>[t("span",null,R(Y.value),1)]),_:1},8,["disabled","loading"])):($(),ge(J,{key:1,class:"big-btn",onClick:a[10]||(a[10]=U=>p.value.connected?D.value=!0:p.value.setIsShowWalletModal(!0))},{default:ce(()=>[t("span",null,R(H.$t("button.connectWallet")),1)]),_:1})),p.value.connected?($(),z("div",pi,[_i,t("span",null,R(j.value),1)])):ie("",!0)]),D.value?($(),ge(si,{key:0,"current-position-info":_.value,"show-from-coin-lock":B.value,"show-to-coin-lock":I.value,"from-coin-amount":s.value,"to-coin-amount":u.value,"total-amount":j.value,onOnClose:a[11]||(a[11]=U=>D.value=!1),onToAdd:G},null,8,["current-position-info","show-from-coin-lock","show-to-coin-lock","from-coin-amount","to-coin-amount","total-amount"])):ie("",!0)])}}});function gi(){const e=It(),{getTransactionBlock:L}=wt("Sui"),b=Se(),O=h(()=>b.slippage);return{getRemoveLiquidityTransactionPayload:async(p,P,_,m,o,l="clmm")=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionRemove.ts:18 ~ getRemoveLiquidityTransactionPayload ~ getRemoveLiquidityTransactionPayload:");const s=await e.clmmSdk.Pool.getPool(p),{coinTypeA:u,coinTypeB:S}=s,w=Re.tickIndexToSqrtPriceX64(_),c=Re.tickIndexToSqrtPriceX64(m),g=tt.getCoinAmountFromLiquidity(new ke(P),new ke(s.current_sqrt_price),w,c,!1),B=he(g.coinA.toString()).mul(he(1).sub(he(O.value).div(100))),I=he(g.coinB.toString()).mul(he(1).sub(he(O.value).div(100)));let n=[];const{rewarder_infos:d}=s;if(n=d.map(r=>r.coinAddress),l==="clmm"){const r={coinTypeA:u,coinTypeB:S,pool_id:p,pos_id:o,delta_liquidity:P,min_amount_a:et(B.toString(),0)||"",min_amount_b:et(I.toString(),0)||"",collect_fee:!0,rewarder_coin_types:n};console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionRemove.ts:49 ~ getRemoveLiquidityTransactionPayload ~ parameter:",r);const A=await e.clmmSdk.Position.removeLiquidityTransactionPayload(r),j={action:"RemoveLiquidity",txbParams:r};return{txb:L(A),payloadParams:j}}},closePositionTransactionPayload:async(p,P,_,m,o)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionRemove.ts:62 ~ closePositionTransactionPayload ~ closePositionTransactionPayload:");const l=await e.clmmSdk.Pool.getPool(p),{coinTypeA:s,coinTypeB:u}=l,S=Re.tickIndexToSqrtPriceX64(_),w=Re.tickIndexToSqrtPriceX64(m),c=tt.getCoinAmountFromLiquidity(new ke(P),new ke(l.current_sqrt_price),S,w,!0),g=he(c.coinA.toString()).mul(1-he(O.value).div(100).toNumber()),B=he(c.coinB.toString()).mul(1-he(O.value).div(100).toNumber());let I=[];const{rewarder_infos:n}=l;I=n.map(j=>j.coinAddress);const d={coinTypeA:s,coinTypeB:u,pool_id:p,pos_id:o,min_amount_a:et(g.toString(),0)||"",min_amount_b:et(B.toString(),0)||"",rewarder_coin_types:I,collect_fee:!0},r=await e.clmmSdk.Position.closePositionTransactionPayload(d),A={action:"DecreaseLiquidity",txbParams:d};return{txb:L(r),payloadParams:A}}}}const bi={class:"new-position-asset-remove-box"},yi={class:"add-or-remove"},wi={class:"tab-box"},ki={key:0,class:"assets-card-mask-from"},Pi={key:1,class:"assets-card-mask-to"},Si={class:"remove-ratio"},Ii=t("div",{class:"remove-ratio-title"},"Amount",-1),Ai={class:"remove-ratio-select"},$i={key:0,class:"ratio"},xi={key:1,class:"ratio"},Ti={class:"ratio-list"},Ci=["onClick"],qi=Pe({__name:"sui-position-asset-remove",setup(e){const L=y=>`${y}%`,b=Lt(),O=Qe(),q=M(!1),i=[{name:"Increase",logo:""},{name:"Remove",logo:""}],{t:p}=gt();St();const P=Ke(),_=h(()=>P),m=Ve(),o=h(()=>m.currentPositionInfo),l=h(()=>{var y;return m.positionPendingRewards[(y=o==null?void 0:o.value)==null?void 0:y.positionId]}),s=Se();h(()=>s.slippage);const u=M(),S=M(),w=M(),c=M(),g=M(!0),B=h(()=>{var y;return Ce(o==null?void 0:o.value.coinaAmount,(y=o==null?void 0:o.value.coinA)==null?void 0:y.decimals)}),I=h(()=>{var y;return Ce(o==null?void 0:o.value.coinbAmount,(y=o==null?void 0:o.value.coinB)==null?void 0:y.decimals)}),n=h(()=>o.value.isResever),d=M(),r=M(),{preAdd:A}=Tt(),{getRemoveLiquidityTransactionPayload:j,closePositionTransactionPayload:Y}=gi(),{getCurrentPosition:T}=it(),D=M(),x=M(!1),k=()=>{var Be;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:1021 ~ updateAmounts ~ updateAmounts:"),x.value||!o.value||!w.value&&!c.value)return;const y=g.value?w.value:c.value,C=g.value?u.value.decimals:S.value.decimals,oe=me(y).mul(ee.pow(10,C)).toString(),f=(Be=o.value)!=null&&Be.isReverse?!g.value:g.value,v=o.value.tickLowerIndex,re=o.value.tickUpperIndex,_e=o.value.current_sqrt_price,ne=u.value.decimals,se=S.value.decimals,ue=o.value.isReverse,{tokenMaxA:be,tokenMaxB:$e,liquidityAmount:Fe}=A(oe,f,v,re,_e,ue,!1,ne,se);console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:859 ~ updateAmounts ~ tokenMaxA, tokenMaxB:",be,$e),g.value?c.value=$e:w.value=be,x.value=!1,Q.value=me(Fe.toString()).div(o.value.positionLiquidity).mul(100).toNumber().toFixed(2),D.value=Fe,m.setPositionActionAmount({fromCoinAmount:w,toCoinAmount:c})};de(()=>o.value,y=>{if(y&&!ve(y)){u.value=y.coinA,S.value=y.coinB,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:872 ~ newVal:",y);const{tickLowerIndex:C,tickUpperIndex:oe,current_tick_index:f,maxPrice:v}=y;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-add.vue:882 ~ currentTick,tickLower,tickUpper:",f,C,oe),v=="âˆž"||f>=C&&f<oe?(d.value=!1,r.value=!1):f>=oe?(w.value="",d.value=!0,r.value=!1):f<C?(d.value=!1,r.value=!0,c.value=""):(d.value=!0,w.value="",r.value=!0,c.value=""),k()}},{immediate:!0}),de(w,(y,C)=>{y&&k(),y==""&&(c.value="")}),de(c,(y,C)=>{y&&k(),y==""&&(w.value="")});const N=h(()=>{const y=Number(w.value)>Number(B.value),C=Number(c.value)>Number(I.value);return!w.value&&!c.value?p("button.enterAmount"):y||C?"Invalid Amount":p("button.remove")}),X=h(()=>{const y=Number(w.value)>Number(B.value),C=Number(c.value)>Number(I.value);return!!(!w.value&&!c.value||y||C)}),W=M(!1),{setTransactionTxid:Z,setTransactionDesc:E,setIsShowWaiting:V,setIsShowRejected:G,setIsShowSuccess:H,setTransactionDescText:a}=s,J=h(()=>s.chainName),U=h(()=>J.value?Me(J.value):{}),ae=M(!1),le=$t(),te=h(()=>le),we=h(()=>te.value.status),Le=M(!1),Ne=async()=>{await le.getSources();let y;te.value.allSources.forEach(C=>{const{pool_address:oe,position_index:f}=JSON.parse(C.blockchainAddress);oe==o.value.pool&&f==o.value.positionIndex&&(y=C.id)}),le.deleteSource(y)};de(()=>[te.value.sourceGroups,o.value],([y,C])=>{y&&y.sources&&y.sources.length>0&&C&&!ve(C)&&xe(y)},{immediate:!0});const xe=y=>{y.sources.forEach(oe=>{const{pool_address:f,position_index:v}=JSON.parse(oe.blockchainAddress);f==o.value.pool&&Number(v)==Number(o.value.positionIndex)&&(Le.value=!0)})},Te=async()=>{var v,re,_e,ne;ae.value=!0,Z("");const y=pe(w.value,u.value.decimals)==0?"":`${Ce(w.value,u.value.decimals)} ${u.value.symbol}`,C=pe(c.value,S.value.decimals)==0?"":`${Ce(c.value,S.value.decimals)} ${S.value.symbol}`;E(p("tips.removeLiquidiyText",{from:n.value?C:y,and:pe(w.value,u.value.decimals)==0||pe(c.value,S.value.decimals)==0?"":"and",to:n.value?y:C})),V(!0);const oe=l.value,f=Q.value==100&&oe&&oe.length>0?p("modal.removeLiquidityText1"):p("modal.removeLiquidityText2");a(f);try{const{pool:se,tickLowerIndex:ue,tickUpperIndex:be,positionId:$e}=o.value,Fe=Q.value!==100;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-remove.vue:478 ~ toRemove ~ isClosed:",Fe,D.value,o.value.positionLiquidity);const Be=Fe?await j(se,D.value,ue,be,$e):await Y(se,D.value,ue,be,$e),Ct=await U.value.signAndExecuteTransactionBlock(_.value.currentWallet,Be.txb,Be==null?void 0:Be.payloadParams),De=U.value.handleTx(Ct);if(console.log("0331###remove###tx####",De),De&&De.hash){Z(De.hash),V(!1),H(!0);const at={title:p("common.removeLiquidity"),desc:"",hash:De.hash,descTransactions:`Remove ${w.value} ${(v=u.value)==null?void 0:v.symbol} and ${c.value} ${(re=S.value)==null?void 0:re.symbol} 
             from the pool`,sender:_.value.address,chainName:J.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",text:`Withdraw ${w.value} ${(_e=u.value)==null?void 0:_e.symbol} and ${c.value} ${(ne=S.value)==null?void 0:ne.symbol}`};J.value!=="Aptos"&&(at.res=De.res),U.value.showTransitionPending(at);const ut=await U.value.watchTransaction(at);ut&&Number(Q.value)==100&&we.value=="authenticated"&&Le.value&&(await le.subscribePosition({pool_address:o.value.pool,position_index:o.value.index},positionInfo.value.nftHash,!1),Ne()),ut&&(w.value="",c.value="",setTimeout(()=>{Number(Q.value)!==100&&T(o.value.positionId)},3e3),setTimeout(()=>{Number(Q.value)!==100&&T(o.value.positionId)},6e3),Number(Q.value)==100&&b.name=="new-position-detail"&&O.push("/pool/position"),Q.value=0)}else V(!1),G(!0);ae.value=!1}catch(se){console.log("Remove error",se),ae.value=!1,V(!1),G(!0)}},Q=M(0),Ie=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"Max",value:100}],Ae=y=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-remove.vue:580 ~ setPercent ~ item:",y),console.log("setPercent isSlider.value: ",x.value),!x.value)return;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-remove.vue:529 ~ setPercent ~ currentPositionInfo.value:",o.value),x.value=!0;const C=o.value.isReverse?S.value.decimals:u.value.decimals,oe=o.value.isReverse?u.value.decimals:S.value.decimals,f=o.value.tickLowerIndex,v=o.value.tickUpperIndex,re=Re.tickIndexToSqrtPriceX64(f),_e=Re.tickIndexToSqrtPriceX64(v);let ne="";y.value!==1?ne=me(o.value.positionLiquidity).mul(y.value).toString():ne=o.value.positionLiquidity,ne=Ge(ne,0)||"0",D.value=ne,console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-remove.vue:536 ~ setPercent ~ newLiquidity:",ne);const se=tt.getCoinAmountFromLiquidity(new ke(ne),new ke(o.value.current_sqrt_price),re,_e,!1),ue=new ee(se.coinA.toString()).div(Math.pow(10,C)).toString(),be=new ee(se.coinB.toString()).div(Math.pow(10,oe)).toString();w.value=o.value.isReverse?Number(be)>0?be:"":Number(ue)>0?ue:"",c.value=o.value.isReverse?Number(ue)>0?ue:"":Number(be)>0?be:"",m.setPositionActionAmount({fromCoinAmount:w,toCoinAmount:c})};return de(()=>Q.value,y=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-position-asset-remove.vue:625 ~ watch ~ sliderVal:",y),y>0&&Ae({value:y/100})},{immediate:!0}),(y,C)=>{const oe=Nt,f=Ee;return $(),z("div",bi,[t("div",yi,[t("div",wi,[F(K(At),{"tab-list":i,"current-tab":"Remove",onOnClick:C[0]||(C[0]=v=>{v.name=="Increase"&&K(m).setPositionDetailCurrentTab("increase")})})]),t("div",{class:lt(["card-container",q.value?g.value?"input-block-add-top":"input-block-add-bottom":"input-block-add-top input-block-inactive"])},[F(nt,{modelValue:w.value,"onUpdate:modelValue":C[1]||(C[1]=v=>w.value=v),"input-value":w.value,"token-info":u.value||null,"has-arrow":!1,"have-half":!1,"is-remove":!0,"remove-balance":B.value,onOnInput:C[2]||(C[2]=v=>{q.value=!0,w.value=v,g.value=!0,x.value=!1}),onOnFocus:C[3]||(C[3]=()=>{q.value=!0,g.value=!0}),onOnBlur:C[4]||(C[4]=()=>{q.value=!1})},null,8,["modelValue","input-value","token-info","remove-balance"]),F(nt,{modelValue:c.value,"onUpdate:modelValue":C[5]||(C[5]=v=>c.value=v),"input-value":c.value,"token-info":S.value||null,"has-arrow":!1,"have-half":!1,"is-remove":!0,"remove-balance":I.value,onOnInput:C[6]||(C[6]=v=>{q.value=!0,c.value=v,g.value=!1,x.value=!1}),onOnFocus:C[7]||(C[7]=()=>{q.value=!0,g.value=!1}),onOnBlur:C[8]||(C[8]=()=>{q.value=!1})},null,8,["modelValue","input-value","token-info","remove-balance"]),d.value?($(),z("div",ki,[F(ot,{"from-coin":u.value,"to-coin":S.value},null,8,["from-coin","to-coin"])])):ie("",!0),r.value?($(),z("div",Pi,[F(ot,{"from-coin":u.value,"to-coin":S.value},null,8,["from-coin","to-coin"])])):ie("",!0)],2),t("div",Si,[Ii,t("div",Ai,[Number(w.value)&&Number(c.value)?($(),z("div",$i,R(Q.value>0&&Number(K(Ge)(Q.value,2))<.01?"<0.01":K(Ge)(Q.value,2))+"% ",1)):($(),z("div",xi," -- ")),t("div",Ti,[($(),z(Je,null,Ye(Ie,(v,re)=>t("div",{key:re,class:lt(["ratio-item",Q.value==v.value?"ratio-item-active":""]),onClick:()=>{x.value=!0,Q.value=v.value}},R(v.name),11,Ci)),64))])]),F(oe,{value:Q.value,"onUpdate:value":C[9]||(C[9]=v=>Q.value=v),"tip-formatter":L},null,8,["value"])])]),_.value.connected?($(),ge(f,{key:0,class:"big-btn liquidity-btn",loading:ae.value,disabled:X.value,onClick:Te},{default:ce(()=>[t("span",null,R(N.value),1)]),_:1},8,["loading","disabled"])):($(),ge(f,{key:1,class:"big-btn",onClick:C[10]||(C[10]=v=>_.value.connected?W.value=!0:_.value.setIsShowWalletModal(!0))},{default:ce(()=>[t("span",null,R(y.$t("button.connectWallet")),1)]),_:1}))])}}});const Li=Pe({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const L=$t(),b=h(()=>L),O=h(()=>b.value.status),q=Se(),i=M(!1);de(()=>O.value,m=>{m=="authenticated",i.value=!1},{immediate:!0});const p=M(!1),P=async()=>{p.value=!p.value;const m={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},o=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await L.subscribePosition(m,o,p.value)}catch{p.value=!p.value}},_=m=>{const o=m.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",o),p.value=o.some(l=>JSON.parse(l.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(l.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return Qe(),de(()=>[b.value.sourceGroups,e.positionInfo],([m,o])=>{p.value=!1,m&&m.length>0&&m[0]&&o&&!ve(o)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),_(m[0]))},{immediate:!0,deep:!0}),{importIcon:xt,isShowSetUp:i,changeSwitch:P,checked:p,notifiStatus:O,store:q}}});const Ni=e=>(We("data-v-f98d0b93"),e=e(),je(),e),Bi={class:"range-alerts"},Ri={class:"range-alerts-top"},Mi={class:"title"},Oi=Ni(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),Fi={key:1,class:"h5-switch-box"},Di={class:"range-alerts-bottom"},Ui={key:0,class:"pc-switch-box"};function zi(e,L,b,O,q,i){const p=Ee,P=Bt;return $(),z("div",Bi,[t("div",Ri,[t("div",Mi,[Oi,e.isShowSetUp||e.notifiStatus!=="authenticated"?($(),ge(p,{key:0,class:"range-alerts-button",onClick:L[0]||(L[0]=bt(_=>e.store.setIsShowNotifi(!0),["stop"]))},{default:ce(()=>[fe(" Set up ")]),_:1})):ie("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?($(),z("div",Fi,[F(P,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ie("",!0)])]),t("div",Di,[fe(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?($(),z("div",Ui,[F(P,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ie("",!0)])])}const Wi=qe(Li,[["render",zi],["__scopeId","data-v-f98d0b93"]]),ji=Pe({setup(){const e=yt(),L=h(()=>e),b=eo(),O=h(()=>b),q=Qe(),i=h(()=>L.value.currentPositionInfo),p=M(),P=x=>{var k;return((k=L.value.tokensObj[x])==null?void 0:k.logo_url)||xt("/image/coins/sui-unknown.png")},_=zt("Sui"),m=M(),o=async x=>{m.value=0;try{const k=await _.calculateFarmingRewards([{pool_id:x.pool_id,position_nft_id:x.id}]),N=[];let X=new ee(0);k[x.id].forEach((W,Z)=>{var G;const E=(G=L.value.tokensObj[W.rewarder_type])==null?void 0:G.decimals;let V=new ee(W.rewarder_amount).div(Math.pow(10,E)).toString();Number(V)>0&&s.value.rewarders[Z]&&(X=X.add(V),N.push({...W,rewarderAmount:V,rewarderAmountPer:V}))}),m.value=X,p.value=N}catch(k){console.log(k,"getRewarder")}},l=h(()=>O.value.farmsPoolObj),s=h(()=>l.value[i.value.poolAddress]);de(()=>[i.value,l.value,s.value],([x,k,N])=>{var X;!ve(x)&&x.positionSource=="farming"&&!ve(N)?o(x):!ve(k)&&!ve(x)&&(p.value=(X=k[x.poolAddress])==null?void 0:X.rewarders)},{immediate:!0});const u=Ke(),S=h(()=>u),w=Se(),c=Me("Sui"),{setIsShowSuccess:g,setIsShowRejected:B,setIsShowWaiting:I,setTransactionDesc:n,setTransactionTxid:d}=w,r=M(!1),A=async()=>{r.value=!0,d(""),n("Claim rewards"),I(!0);const x={pool_id:i.value.pool_id,position_nft_id:i.value.id};try{const k=await _.harvestFarms(x),N=await c.signAndExecuteTransactionBlock(S.value.currentWallet,k.txb,k.payloadParams);console.log("0221###sui swap res###",N);let X=c.handleTx(N);if(X&&X.hash){d(X.hash),I(!1),g(!0);let W={title:"Claim",res:X.res,hash:X.hash};c.showTransitionPending(W),await c.watchTransaction(W)&&setTimeout(()=>{o(i.value),c.getAccount(S.value.address)},2e3)}else I(!1),B(!0);r.value=!1}catch(k){console.log("farmsDeposit error",k),I(!1),B(!0),r.value=!1}},j=async()=>{r.value=!0,d(""),n(`Unstake ${i.value.name}`),I(!0);const x=i.value.pool_id,k=i.value.id;try{const N=await _.farmsWithdraw(x,k),X=await c.signAndExecuteTransactionBlock(S.value.currentWallet,N.txb,N.payloadParams);console.log("0221###sui swap res###",X);let W=c.handleTx(X);if(W&&W.hash){d(W.hash),I(!1),g(!0);let Z={res:W.res,title:"Unstake",hash:W.hash};c.showTransitionPending(Z),await c.watchTransaction(Z)&&setTimeout(()=>{q.replace(`/new-position-detail?token=${i.value.tokenName}&address=${i.value.clmm_pool_id}&pos=${i.value.clmm_position_id}`),L.value.setCurrentPositionInfo(i.value.clmm_pool_id,"",i.value.tokenName,"Sui",i.value.clmm_position_id),m.value=0,r.value=!1},2e3)}else I(!1),B(!0)}catch(N){console.log("farmsDeposit error",N),I(!1),B(!0),r.value=!1}},Y=async()=>{r.value=!0,d(""),n(`Stake ${i.value.name}`),I(!0);const x={clmm_pool_id:i.value.poolAddress,clmm_position_id:i.value.pos_object_id,coinTypeA:i.value.coin_type_a,coinTypeB:i.value.coin_type_b},k=l.value[i.value.poolAddress].id;try{const N=await _.farmsDeposit(x,k),X=await c.signAndExecuteTransactionBlock(S.value.currentWallet,N.txb,N.payloadParams);console.log("0221###sui swap res###",X);let W=c.handleTx(X);if(W&&W.hash){d(W.hash),I(!1),g(!0);let Z={res:W.res,title:"Staked",hash:W.hash};c.showTransitionPending(Z);const E=await c.watchTransaction(Z,!0);let V;E!=null&&E.status&&setTimeout(async()=>{var G,H;(H=(G=E==null?void 0:E.res)==null?void 0:G.events)==null||H.forEach(a=>{a.type.indexOf("::pool::DepositEvent")>-1&&(V=a.parsedJson.wrapped_position_id)}),q.replace(`/new-position-detail?position_nft_id=${V}&positionSource=farming`),await L.value.setCurrentPositionInfo("","","","Sui",V,"farming"),r.value=!1},2e3)}else I(!1),B(!0)}catch(N){console.log("farmsDeposit error",N),I(!1),B(!0),r.value=!1}},T=h(()=>w),D=h(()=>T.value.addressLpTokens);return{getCoinIcon:P,rewardList:p,sFixD:Ge,addCommom:pe,claim:A,unStake:j,loading:r,totalRewardAmount:m,currentPositionInfo:i,stake:Y,farmsPoolObj:l,addressLpTokens:D,farmsPoolInfo:s}}});const Oe=e=>(We("data-v-d870f0ae"),e=e(),je(),e),Ei={key:0,class:"farms-position-detail-box"},Vi={class:"farms-top"},Hi=Oe(()=>t("div",{class:"left"},[t("div",{class:"title"},"Farming"),t("div",{class:"desc"},"Stake Position to Earn")],-1)),Xi={class:"right"},Gi={class:"apr"},Ji={class:"apr-tips-box"},Yi=Oe(()=>t("span",null,"View",-1)),Qi=Oe(()=>t("svg",{class:"arrow-icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ki=[Yi,Qi],Zi={class:"farms-bottom"},es=Oe(()=>t("div",{class:"title"},"Farming Rewards",-1)),ts={key:0,class:"reward-list"},os={key:0,class:"rewards-item-bg"},ns={class:"rewards-item-box"},is={alt:""},ss={key:1},as={class:"rewards-item-bg"},ls={class:"rewards-item-box"},rs={alt:""},us=Oe(()=>t("span",null,"0",-1)),cs={key:1,class:"reward-list"},ds={key:0,class:"rewards-item-bg"},vs={class:"rewards-item-box"},ms={alt:""},fs=Oe(()=>t("span",null,"0",-1)),ps={key:1},_s={class:"rewards-item-bg"},hs={class:"rewards-item-box"},gs={alt:""},bs=Oe(()=>t("span",null,"0",-1)),ys={class:"actions-box"};function ws(e,L,b,O,q,i){var o,l,s;const p=Zt,P=Ee,_=ht,m=Rt("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?($(),z("div",Ei,[t("div",Vi,[Hi,t("div",Xi,[t("div",Gi,[fe(" APRÂ  "),t("span",null,[fe(R(("addCommom"in e?e.addCommom:K(pe))(((o=e.farmsPoolInfo)==null?void 0:o.total_apr)*100,2))+"%Â  ",1),t("div",Ji,[F(p,{"l-item":e.farmsPoolInfo,"rewarder-info":(s=(l=e.farmsPoolInfo)==null?void 0:l.rewarder)==null?void 0:s.rewardList},null,8,["l-item","rewarder-info"])])])]),t("div",{class:"view",onClick:L[0]||(L[0]=u=>e.$router.push("/farms"))},Ki)])]),t("div",Zi,[es,e.rewardList&&e.rewardList.length>0?($(),z("div",ts,[($(!0),z(Je,null,Ye(e.rewardList,u=>($(),z("div",{key:u,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?($(),z("div",os,[t("div",ns,[Ue(t("img",is,null,512),[[m,e.getCoinIcon(u.rewarder_type)]]),t("span",null,R(("addCommom"in e?e.addCommom:K(pe))(u.rewarderAmount||0)),1)])])):($(),z("div",ss,[t("div",as,[t("div",ls,[Ue(t("img",rs,null,512),[[m,e.getCoinIcon(u.reward_coin)]]),us])])]))]))),128))])):($(),z("div",cs,[($(!0),z(Je,null,Ye(e.currentPositionInfo.rewards,u=>($(),z("div",{key:u,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?($(),z("div",ds,[t("div",vs,[Ue(t("img",ms,null,512),[[m,e.getCoinIcon(u.rewarder_type)]]),fs])])):($(),z("div",ps,[t("div",_s,[t("div",hs,[Ue(t("img",gs,null,512),[[m,e.getCoinIcon(u.reward_coin)]]),bs])])]))]))),128))])),t("div",ys,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?($(),ge(P,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:ce(()=>[fe("Unstake")]),_:1},8,["loading","onClick"])):ie("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?($(),ge(_,{key:1},{title:ce(()=>[fe("Farming rewards are only available for active positions.")]),default:ce(()=>[F(P,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:ce(()=>[fe("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?($(),ge(P,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:ce(()=>[fe("Stake")]),_:1},8,["loading","onClick"])):ie("",!0),F(P,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:bt(e.claim,["stop"])},{default:ce(()=>[fe("Claim")]),_:1},8,["loading","disabled","onClick"])])])])):ie("",!0)}const ks=qe(ji,[["render",ws],["__scopeId","data-v-d870f0ae"]]),Ps={class:"new-position-detail"},Ss={class:"new-position-content"},Is={class:"left"},As={class:"right"},$s={class:"loading-global"},xs=Pe({__name:"new-position-detail-sui",setup(e){const L=Qe(),{getCurrentPosition:b}=it(),{getPoolList:O}=Wt(),q=M(),i=M();pt(()=>{q.value=L.currentRoute.value.query.id||"",i.value=L.currentRoute.value.query.positionSource||""});const p=Ve(),P=h(()=>p.poolsObj),_=Ot(),m=h(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:293 ~ allTokensObj ~ suiTokenStore.allTokensObj:",_.allTokensObj),_.allTokensObj));de(()=>m.value,g=>{g&&!ve(g)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:298 ~ watch ~ getPoolList:"),O())},{immediate:!0}),de(()=>[P.value,m.value,q.value,i.value],([g,B,I,n])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ positionSource:",n),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ routerId:",I),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ allTokensObj:",B),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ poolsObj:",g),g&&!ve(g)&&B&&!ve(B)&&I&&n&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:38 ~ getCurrentPosition:"),b(I,n))},{immediate:!0});const o=Ke(),l=h(()=>o),s=Me("Sui"),u=()=>{b(q.value,i.value),l.value.address&&s.getAccount(l.value.address)},S=h(()=>p.currentPositionLoading),w=h(()=>p.currentPositionInfo),c=h(()=>p.positionDetailCurrentTab);return ft(()=>{p.setPositionDetailCurrentTab("increase")}),(g,B)=>{const I=Mt;return $(),z("div",Ps,[F(ao,{onClickRefresh:u}),t("div",Ss,[t("div",Is,[F(Do),F(mt,{class:"pc-module",onGetDetails:g.getDetails},null,8,["onGetDetails"])]),t("div",As,[c.value=="increase"?($(),ge(hi,{key:0,onGetDetails:g.getDetails},null,8,["onGetDetails"])):($(),ge(qi,{key:1,onGetDetails:g.getDetails},null,8,["onGetDetails"])),F(mt,{class:"h5-module",onGetDetails:g.getDetails},null,8,["onGetDetails"]),F(ks),w.value&&w.value.minPrice!=="0"&&w.value.maxPrice!=="âˆž"?($(),ge(Wi,{key:2,"position-info":w.value},null,8,["position-info"])):ie("",!0)])]),Ue(t("div",$s,[F(I)],512),[[_t,S.value]])])}}});const Pa=qe(xs,[["__scopeId","data-v-8d83352d"]]);export{Pa as default};
