import{_ as en}from"./back.73871274.js";import{_ as on}from"./swap-setting.a82a0c56.js";import{b as Xe,u as eo,c as oo,g as ko,f as nn,p as Co,d as tn}from"./pool.83f6439f.js";import{a as Ye,r as L,m as k,e as ze,o as g,f as P,h as n,v as z,c as Ce,x as re,p as ao,k as lo,E as Ro,G as we,b as ro,i as ae,z as fo,y as Oo,t as Pe,H as Bo,W as po,q as yo,u as K,j as me,w as Be,Q as Lo,l as Ao,$ as sn,U as Je,V as an,a4 as $o,J as So,F as xe,s as io,B as vo,Y as ln,a5 as rn,a6 as un,O as qo,a2 as dn,S as cn}from"./entry.1afe32c4.js";import{i as fe,w as vn,x as mn,f as ke,h as V,k as Ue,u as mo,D as Se,m as Oe,E as Mo,G as Uo,T as Po,H as fn}from"./index.c41a185a.js";import{_ as ho}from"./token-warning.7014f9c6.js";import{_ as jo}from"./status-block.635f2a4b.js";import{s as co,m as pn,l as hn,b as gn,a as bn}from"./transform.c672907f.js";import{D as h}from"./decimal.0bdeb344.js";/* empty css              */import{i as so}from"./import-icon.de3e6c66.js";import"./index.fa5ab6c5.js";import{_ as Eo}from"./coin-lock.9b7a4e87.js";import{_ as go}from"./assets-card.63e9b367.js";import{_ as kn,a as _n,b as wn}from"./icon-Add-Liquidity_2x.1eeb3361.js";/* empty css              */import{u as Do}from"./notifi.63f5c945.js";import{_ as yn}from"./apr-tips.a8eb9c82.js";import{u as Fo}from"./farms.2b755d68.js";/* empty css              *//* empty css              *//* empty css              */import"./icon-warning_2x.e4f91c80.js";import"./icon-error_2x.b4924e70.js";import"./img-lock_2x.a28135f4.js";import"./useDebounceFunction.6fcad2ee.js";import"./useWhale.b340524c.js";import"./icon_fee_2x.b58688a2.js";import"./icon_rewards_2x.ae1618c5.js";const _o=Math.PI,wo=2*_o,Ve=1e-6,An=wo-Ve;function Wo(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function In(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Wo;const s=10**t;return function(a){this._+=a[0];for(let N=1,p=a.length;N<p;++N)this._+=Math.round(arguments[N]*s)/s+a[N]}}class Cn{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Wo:In(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,a,N){this._append`Q${+t},${+s},${this._x1=+a},${this._y1=+N}`}bezierCurveTo(t,s,a,N,p,T){this._append`C${+t},${+s},${+a},${+N},${this._x1=+p},${this._y1=+T}`}arcTo(t,s,a,N,p){if(t=+t,s=+s,a=+a,N=+N,p=+p,p<0)throw new Error(`negative radius: ${p}`);let T=this._x1,w=this._y1,l=a-t,o=N-s,c=T-t,d=w-s,y=c*c+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(y>Ve)if(!(Math.abs(d*l-o*c)>Ve)||!p)this._append`L${this._x1=t},${this._y1=s}`;else{let I=a-T,ue=N-w,J=l*l+o*o,Q=I*I+ue*ue,_=Math.sqrt(J),f=Math.sqrt(y),F=p*Math.tan((_o-Math.acos((J+y-Q)/(2*_*f)))/2),i=F/f,A=F/_;Math.abs(i-1)>Ve&&this._append`L${t+i*c},${s+i*d}`,this._append`A${p},${p},0,0,${+(d*I>c*ue)},${this._x1=t+A*l},${this._y1=s+A*o}`}}arc(t,s,a,N,p,T){if(t=+t,s=+s,a=+a,T=!!T,a<0)throw new Error(`negative radius: ${a}`);let w=a*Math.cos(N),l=a*Math.sin(N),o=t+w,c=s+l,d=1^T,y=T?N-p:p-N;this._x1===null?this._append`M${o},${c}`:(Math.abs(this._x1-o)>Ve||Math.abs(this._y1-c)>Ve)&&this._append`L${o},${c}`,a&&(y<0&&(y=y%wo+wo),y>An?this._append`A${a},${a},0,1,${d},${t-w},${s-l}A${a},${a},0,1,${d},${this._x1=o},${this._y1=c}`:y>Ve&&this._append`A${a},${a},0,${+(y>=_o)},${d},${this._x1=t+a*Math.cos(p)},${this._y1=s+a*Math.sin(p)}`)}rect(t,s,a,N){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${a=+a}v${+N}h${-a}Z`}toString(){return this._}}function to(e){return function(){return e}}function $n(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const a=Math.floor(s);if(!(a>=0))throw new RangeError(`invalid digits: ${s}`);t=a}return e},()=>new Cn(t)}function Sn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ho(e){this._context=e}Ho.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Pn(e){return new Ho(e)}function Tn(e){return e[0]}function Nn(e){return e[1]}function Rn(e,t){var s=to(!0),a=null,N=Pn,p=null,T=$n(w);e=typeof e=="function"?e:e===void 0?Tn:to(e),t=typeof t=="function"?t:t===void 0?Nn:to(t);function w(l){var o,c=(l=Sn(l)).length,d,y=!1,I;for(a==null&&(p=N(I=T())),o=0;o<=c;++o)!(o<c&&s(d=l[o],o,l))===y&&((y=!y)?p.lineStart():p.lineEnd()),y&&p.point(+e(d,o,l),+t(d,o,l));if(I)return p=null,I+""||null}return w.x=function(l){return arguments.length?(e=typeof l=="function"?l:to(+l),w):e},w.y=function(l){return arguments.length?(t=typeof l=="function"?l:to(+l),w):t},w.defined=function(l){return arguments.length?(s=typeof l=="function"?l:to(!!l),w):s},w.curve=function(l){return arguments.length?(N=l,a!=null&&(p=N(a)),w):N},w.context=function(l){return arguments.length?(l==null?a=p=null:p=N(a=l),w):a},w}function To(){}function Xo(e){this._context=e}Xo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function On(e){return new Xo(e)}const Bn=Ye({setup(){const e=Xe(),t=L(!1),s=k(()=>e);return{slippage:k(()=>s.value.slippage),isShowSwapSetting:t}}});const Ln=e=>(ao("data-v-82585f8b"),e=e(),lo(),e),qn=Ln(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Mn(e,t,s,a,N,p){const T=on;return g(),P("div",{class:"slippage-icon",onClick:t[1]||(t[1]=w=>e.isShowSwapSetting=!0)},[qn,n("span",null,z(e.slippage)+"%",1),e.isShowSwapSetting?(g(),Ce(T,{key:0,onOnClose:t[0]||(t[0]=w=>e.isShowSwapSetting=!1)})):re("",!0)])}const Un=ze(Bn,[["render",Mn],["__scopeId","data-v-82585f8b"]]),jn=Ye({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const s=L(!1),a=L(null),N=L(0),p=L(20),T=eo(),w=Xe(),l=L(!1);Ro(()=>{clearInterval(a.value)});const o=()=>{a.value=setInterval(()=>{var Q;l.value||N.value<p.value&&(N.value+=1,N.value===p.value&&((Q=e==null?void 0:e.poolInfo)!=null&&Q.poolAddress&&T.updateCurrentPools(e.poolInfo.poolAddress,w.chainName),N.value=0))},1e3)},c=k(()=>w.slippage),d=()=>{t.emit("clearAll")},y=L(!1),I=()=>{N.value=0,y.value=!0,t.emit("clickRefresh"),setTimeout(()=>{y.value=!1},1e3)};we(()=>e.poolInfo,Q=>{Q&&!a.value&&o()},{immediate:!0});const ue=ro(),J=k(()=>w.chainName);return{clickRefresh:I,isShowSwapSetting:s,countdown:N,autoRefreshTime:p,slippage:c,clearAll:d,checkNullObj:fe,router:ue,loading:l,chainName:J,refresh:y}}});const En=e=>(ao("data-v-ca768f9b"),e=e(),lo(),e),Dn={class:"new-position-title"},Fn={class:"left"},Wn={class:"right"},Hn=En(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Xn=[Hn];function Yn(e,t,s,a,N,p){const T=en,w=Un;return g(),P("div",Dn,[n("div",Fn,[ae(T)]),n("div",Wn,[ae(w),(g(),P("svg",{"aria-hidden":"true",class:fo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:t[0]||(t[0]=(...l)=>e.clickRefresh&&e.clickRefresh(...l))},Xn,2))])])}const Yo=ze(jn,[["render",Yn],["__scopeId","data-v-ca768f9b"]]);function No(e,t,s){const a=new h(10).pow(t-s);return new h(1.0001).pow(e).mul(a)}const zn=Ye({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const s=L(1),a=L(""),N=L(""),p=k(()=>{var i,A,m;return d.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(A=e.poolInfo)==null?void 0:A.coinA.decimals,(m=e.poolInfo)==null?void 0:m.coinB.decimals).toString()}),T=k(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(p.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),w=k(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(p.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),l=Xe(),o=k(()=>l),c=k(()=>o.value.chainName?oo(o.value.chainName):{}),{TickMath:d,getNearestTickByTick:y}=c.value,I=()=>{const i=s.value/2;s.value=i,Q(e.poolInfo,i)},ue=()=>{const i=s.value*2;s.value=i,Q(e.poolInfo,i)},J=(i=[])=>{let A=6;const m=Math.abs(Number(i[0])-Number(i[i.length-1]));return m>=6?A=0:m>=1?A=1:m>=.1?A=2:m>=.01?A=3:m>=.001?A=4:m>=1e-4?A=5:m>=1e-5?A=6:m>=1e-6?A=7:m>=1e-7&&(A=8),A},Q=(i,A=1)=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:189 ~ dataProcessing ~ zooms:",A),i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const m=Number(e.poolInfo.current_tick_index);let b=m+100*A,r=m-100*A,H,oe;if(e.maxPrice==="âˆž")oe=c.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?oe=d.priceToTickIndex(new h(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):oe=d.priceToTickIndex(new h(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{oe=443636}if(e.minPrice==="0")H=c.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?H=d.priceToTickIndex(new h(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):H=d.priceToTickIndex(new h(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{H=-443636}let de=0;if(e.currentPriceTab!=="full range"){if(m>=H&&m<=oe){const W=m-H,be=oe-m;de=Math.max(Math.abs(W),Math.abs(be))}else m<H?de=Math.abs(oe-m):de=Math.abs(m-H);b=m+de+20*A,r=m-de-20*A}else{const W=(Math.abs(m)>5e3,2e4);b=m+W*A,r=m-W*A}r<-443636&&(r=-443636),b>443636&&(b=443636);const q=new h(i.liquidity).div(Math.pow(10,8)).toString(),C=e.tickList,M=[],U=[];let j={};for(let W=0;W<C.length;W++){if(j=C[W],j.index<=m&&j.index>=r){if(M.length<1&&W!==0){const be=C[W-1];M.unshift({...be,index:r})}M.unshift(j)}else if(j.index>m&&j.index<=b&&(U.push(j),M.length<1&&W!==0)){const be=C[W-1];M.push({...be,index:r})}if(j.index>b){const be=C[W];if(U.push({...be,index:b}),M.length<1&&W!==0){const ye=C[W-1];M.push({...ye,index:r})}break}}let ne="0";for(let W=M.length-1;W>=0;W--)ne=new h(ne).plus(new h(M[W].liquidityNet.toString()).div(Math.pow(10,8))).toString(),M[W].liquityAmount=ne;let G=q;for(let W=0;W<U.length;W++)G=new h(G).plus(new h(U[W].liquidityNet.toString()).div(Math.pow(10,8))).toString(),U[W].liquityAmount=G;let ie=[];const x=C&&C.length>0?{index:m,liquityAmount:Number(q)}:{index:m,liquityAmount:0};(M.length>0||U.length>0)&&(ie=[...M.reverse(),x,...U],e.direction||(ie=ie.reverse()));const he=[];C.forEach(W=>{he.push({...W,liquidityGross:W.liquidityGross.toString(),liquidityNet:W.liquidityNet.toString()})}),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:384 ~ dataProcessing ~ tickMin, tickMax, minPriceTick, maxPriceTick:",r,b,H,oe,m),f(ie,r,b,H,oe,m)}};let _=L(!0);Oo(()=>{document.body.clientWidth<750?_.value=!1:_.value=!0,window.onresize=()=>{document.body.clientWidth<750?_.value=!1:_.value=!0,Q(e.poolInfo,s.value)}});const f=(i,A,m,b,r,H)=>{let oe,de;e.direction?(oe=e.before7dContractPriceLowest?d.priceToTickIndex(new h(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?d.priceToTickIndex(new h(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(oe=e.before7dContractPriceLowest?d.priceToTickIndex(new h(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",de=e.before7dContractPriceHighest?d.priceToTickIndex(new h(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const q={top:30,right:35,bottom:20,left:55};let C,M;_.value,C=340-q.left-q.right,M=205-q.top-q.bottom;const U=m-A,j=parseInt(String(U/4));let ne=[A+j/4,A+j,A+2*j,m-j,m-j/4];const G=A,ie=m,x=C/(ie-G);e.currentPriceTab==="full range"&&(ne=[A,A+2*j,m]);const he=ne.map(R=>e.direction?No(R,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new h(1).div(No(R,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());J(he),co("#chart").selectAll("*").remove();const W=co("#chart").attr("width",C+q.left+q.right).attr("height",M+q.top+q.bottom).append("g").attr("transform",`translate(${q.left},${q.right})`),be=pn(i,function(R){return Number(Math.abs(R.liquityAmount))})||0,ye=hn().range([0,M]).domain([be,0]);gn().rangeRound([0,C]).padding(.1);const Me=W.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");o.value.theme=="default"?Me.attr("x",function(R,X){return X===0?0:e.direction?Math.abs(R.index-G)*x:Math.abs(ie-R.index)*x}).attr("y",function(R,X){return e.direction?X===i.length-1?0:ye(R.liquityAmount):X===i.length-1?0:ye(i[X+1].liquityAmount)}).attr("width",function(R,X){return X===0&&i.length===1&&R.liquityAmount>0?C:(e.direction,X!==i.length-1?Math.abs(i[X+1].index-R.index)*x:0)}).attr("height",function(R,X){return X===0&&i.length===1&&R.liquityAmount>0?M:e.direction?X===i.length-1?0:M-ye(R.liquityAmount):X===i.length-1?0:M-ye(i[X+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Me.attr("x",function(R,X){return X===0?0:e.direction?Math.abs(R.index-G)*x:Math.abs(ie-R.index)*x}).attr("y",function(R,X){return e.direction?X===i.length-1?0:ye(Math.abs(R.liquityAmount)):X===i.length-1?0:ye(Math.abs(i[X+1].liquityAmount))}).attr("width",function(R,X){return X===0&&i.length===1&&R.liquityAmount>0?C:(e.direction,X!==i.length-1?Math.abs(i[X+1].index-R.index)*x:0)}).attr("height",function(R,X){if(X===0&&i.length===1&&R.liquityAmount>0)return M;if(e.direction)return X===i.length-1?0:Number(R.liquityAmount)?M-ye(Math.abs(R.liquityAmount)):0;{if(X===i.length-1)return 0;const Ae=M-ye(Math.abs(i[X+1].liquityAmount));return Number(i[X+1].liquityAmount)?Ae:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const $e=W.append("g");$e.append("line").attr("x1",0).attr("y1",155).attr("x2",C).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),$e.append("g");let qe=0;e.direction?qe=Math.abs(H-G)*x:qe=Math.abs(H-ie)*x,(o.value.theme=="default"?W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+qe+", 0)"),co("#triangle").attr("width",8).attr("height",4);let v=[[0,0],[4,4],[8,0]],S=Rn().x(function(R){return R[0]}).y(function(R){return R[1]}).curve(On);const E=qe-4;W.append("path").attr("d",S(v)).style("fill",o.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+E+", 0)");let O,B,Y,ee;e.direction?(O=b<G?-100:parseInt(String(Math.abs(b-G)*x)),B=r<G?-100:parseInt(String(Math.abs(r-G)*x)),Y=oe<G?-100:Math.abs(oe-G)*x,ee=de<G?-100:Math.abs(de-G)*x):(B=b<G?-100:Math.abs(ie-b)*x,O=r<G?-100:Math.abs(ie-r)*x,ee=oe<G?-100:Math.abs(ie-oe)*x,Y=de<G?-100:Math.abs(ie-de)*x),e.minPrice==="0"&&(O=0),e.maxPrice==="âˆž"&&(B=C),_.value?a.value=C-O+60+"px":a.value=C-O+52+"px",N.value=B+74+"px",oe&&Y<C&&W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Y+", 0)"),de&&ee<C&&W.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ee+", 0)");const ce=bn().extent([[0,0],[C,M]]).handleSize(30).on("end",ge);W.append("g").attr("class","brush").call(ce).call(ce.move,[O,B]);function ge(R){if(!R.sourceEvent||!R.selection)return;_.value?a.value=C-R.selection[0]+60+"px":a.value=C-R.selection[0]+52+"px",N.value=R.selection[1]+74+"px";let X,Ae,pe=0,ve=0;e.direction?(pe=y(parseInt(String(R.selection[0]/x+G)),Number(e.poolInfo.tickSpacing)),X=d.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ve=y(parseInt(String(R.selection[1]/x+G)),Number(e.poolInfo.tickSpacing)),Ae=d.tickIndexToPrice(ve,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(ve=y(ie-R.selection[0]/x,Number(e.poolInfo.tickSpacing)),X=1/d.tickIndexToPrice(ve,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=y(ie-R.selection[1]/x,Number(e.poolInfo.tickSpacing)),Ae=1/d.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ke(String(X),6))),t.emit("onChangeMaxPrice",String(ke(String(Ae),6)))}o.value.theme=="default"?co(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):co(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};L(""),we(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,A,m,b,r])=>{i&&A&&m&&b&&r&&r.length>0&&Q(i,s.value)},{immediate:!0});const F=L(!0);return we(()=>e.chartLoading,(i,A)=>{i!==A&&(F.value=i)},{immediate:!0,deep:!0}),{store:o,loading:F,zoomOut:I,zoomIn:ue,rangeSizeLower:T,rangeSizeUpper:w,rangeSizeLowerPosition:a,rangeSizeUpperPosition:N,decimalFormat:vn,numberformat:mn}}});const Gn=e=>(ao("data-v-992b1bf2"),e=e(),lo(),e),Jn={class:"chart-box"},Qn={class:"chart"},Zn=Gn(()=>n("svg",{id:"chart"},null,-1)),Kn=[Zn];function Vn(e,t,s,a,N,p){return g(),P("div",Jn,[Pe(n("div",Qn,Kn,512),[[Bo,!e.loading]])])}const zo=ze(zn,[["render",Vn],["__scopeId","data-v-992b1bf2"]]),xn=Ye({components:{StatusBlock:jo,NewPositionChart:zo,TokenWarning:ho},setup(e){const t=L(),s=L(),a=k(()=>{var m,b;return(b=(m=d.value)==null?void 0:m.poolInfo)==null?void 0:b.needReverse}),N=Xe(),p=k(()=>N),T=k(()=>p.value.currentExplorer),w=k(()=>p.value.theme),l=k(()=>p.value.chainName),o=eo(),c=k(()=>o),d=L({}),y=po();we(()=>[c.value.currentPositionInfo,l.value],([m,b])=>{var r;(b=="Aptos"&&m||b=="Sui"&&m&&(m==null?void 0:m.nftHash)==((r=y==null?void 0:y.query)==null?void 0:r.pos))&&(d.value=m,t.value=d.value.token_a,s.value=d.value.token_b)},{immediate:!0});const I=m=>{var b;return(m==null?void 0:m.logoURI)||(m==null?void 0:m.logo_url)||((b=c.value.tokensObj[m==null?void 0:m.address])==null?void 0:b.logo_url)||(w.value==="default"?so("/image/coins/unknown.png"):so("/image/coins/sui-unknown.png"))},ue=k(()=>l.value?oo(l.value):{}),J=L([]),Q=async m=>{const{list:b}=await ue.value.getTicks(m),r=b?ue.value.getTickDataFromUrlData(b):[];J.value=r};we(()=>[d.value,c.value.poolsObj],([m,b])=>{m&&!fe(m)&&m.poolInfo&&b&&!fe(b)&&Q(b[m.poolAddress])},{immediate:!0});const _=L(!0),f=(m,b)=>m!=="0"&&b!=="âˆž"?Ue(1/(1-Number((m/b)**.25)),2)+"x":"1x",F=k(()=>d.value.minPrice&&d.value.maxPrice?f(d.value.minPrice,d.value.maxPrice):"--"),i=k(()=>d.value.maxPrice!=="âˆž"?new h(1).div(new h(d.value.maxPrice)).toString():"âˆž"),A=k(()=>d.value.minPrice>0?new h(1).div(new h(d.value.minPrice)).toString():"0");return{needReverse:a,getCoinIcon:I,theme:w,indexStore:N,direct:_,addCommom:V,decimalUi:ke,tickList:J,positionInfo:d,fromCoin:t,toCoin:s,getExplorerUrl:ko,lever:F,currentExplorer:T,minPriceResever:i,maxPriceResever:A}}}),et=""+globalThis.__publicAssetsURL("image/aptos-price.png"),ot=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),nt=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),tt=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Qe=e=>(ao("data-v-500e09ec"),e=e(),lo(),e),it={class:"new-position-info"},st={class:"pool-info"},at={class:"left"},lt={class:"coin-a"},rt={alt:""},ut={class:"coin-b"},dt={alt:""},ct={class:"position-name"},vt=["href"],mt=Qe(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),ft=[mt],pt={key:0,class:"pool-fee"},ht=Qe(()=>n("span",null,"Fee tier",-1)),gt={class:"right"},bt={class:"h5-pool-info"},kt={class:"coin-info"},_t={class:"coin-a"},wt={alt:""},yt={class:"coin-b"},At={alt:""},It={class:"position-name"},Ct=["href"],$t=Qe(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),St=[$t],Pt={key:0,class:"pool-fee"},Tt={class:"price-info"},Nt={class:"price-and-chart"},Rt={class:"left"},Ot={class:"current-price"},Bt=Qe(()=>n("span",null,"Current Price",-1)),Lt={class:"coin-rate"},qt=Qe(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Mt=Qe(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Ut=[qt,Mt],jt={key:0},Et={key:1},Dt={key:0,class:"position-range"},Ft=Qe(()=>n("div",{class:"position-range-title"},"Position Range",-1)),Wt={key:0},Ht={key:1},Xt={key:2,src:et,alt:""},Yt={key:3,src:ot,alt:""},zt={key:4},Gt={key:5},Jt={key:1,class:"position-range position-range-warp"},Qt={key:0,class:"position-range-title"},Zt={key:1,class:"position-range-title"},Kt={key:2},Vt={key:3},xt={class:"price-img"},ei={key:0,src:nt,alt:""},oi={key:1,src:tt,alt:""},ni={key:4},ti={key:5},ii={class:"lever"},si={class:"lever-title"},ai=Qe(()=>n("div",null,[n("span",null," Leverage "),n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),li={class:"lever-text"},ri={class:"right"},ui=Qe(()=>n("div",{class:"chat-mask"},null,-1));function di(e,t,s,a,N,p){var d,y,I,ue,J,Q,_,f,F,i,A,m,b,r,H,oe,de,q,C,M,U,j,ne,G,ie,x,he,W,be,ye;const T=ho,w=jo,l=Lo,o=zo,c=yo("image");return g(),P("div",it,[n("div",st,[n("div",at,[n("div",lt,[Pe(n("img",rt,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(T,{address:e.needReverse?(ue=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:ue.address:(y=(d=e.positionInfo)==null?void 0:d.token_a)==null?void 0:y.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ut,[Pe(n("img",dt,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(T,{address:e.needReverse?(f=(_=e.positionInfo)==null?void 0:_.token_a)==null?void 0:f.address:(Q=(J=e.positionInfo)==null?void 0:J.token_b)==null?void 0:Q.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ct,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:K(ko))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash||e.positionInfo.id),target:"_blank"},z((i=(F=e.positionInfo)==null?void 0:F.name)==null?void 0:i.split("|")[1]),9,vt)]),(g(),P("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=Le=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.id))},ft)),e.positionInfo.fee?(g(),P("div",pt,[ht,me(" "+z(e.positionInfo.fee*100)+"% ",1)])):re("",!0)]),n("div",gt,[ae(w,{"current-status":(A=e.positionInfo)==null?void 0:A.currentStatus},null,8,["current-status"])])]),n("div",bt,[n("div",null,[n("div",kt,[n("div",_t,[Pe(n("img",wt,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(T,{address:e.needReverse?(H=(r=e.positionInfo)==null?void 0:r.token_b)==null?void 0:H.address:(b=(m=e.positionInfo)==null?void 0:m.token_a)==null?void 0:b.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",yt,[Pe(n("img",At,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(T,{address:e.needReverse?(C=(q=e.positionInfo)==null?void 0:q.token_a)==null?void 0:C.address:(de=(oe=e.positionInfo)==null?void 0:oe.token_b)==null?void 0:de.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",It,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:K(ko))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash||e.positionInfo.id),target:"_blank"},z((U=(M=e.positionInfo)==null?void 0:M.name)==null?void 0:U.split("|")[1]),9,Ct),(g(),P("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=Le=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.id))},St))]),e.positionInfo.fee?(g(),P("div",Pt,z(e.positionInfo.fee*100)+"% ",1)):re("",!0)])]),ae(w,{"current-status":(j=e.positionInfo)==null?void 0:j.currentStatus},null,8,["current-status"])]),n("div",Tt,[n("div",Nt,[n("div",Rt,[n("div",Ot,[n("div",null,[Bt,n("div",Lt,[n("div",{onClick:t[2]||(t[2]=Le=>e.direct=!e.direct)},Ut)])]),(e.needReverse?!e.direct:e.direct)?(g(),P("div",jt,[me(z(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,z((ne=e.toCoin)==null?void 0:ne.symbol)+" per "+z((G=e.fromCoin)==null?void 0:G.symbol),1)])):(g(),P("div",Et,[me(z(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,z((ie=e.fromCoin)==null?void 0:ie.symbol)+" per "+z((x=e.toCoin)==null?void 0:x.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(g(),P("div",Dt,[Ft,n("div",null,[(e.needReverse?!e.direct:e.direct)?(g(),P("div",Wt,[me(z(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(g(),P("div",Ht,[me(z(((he=e.positionInfo)==null?void 0:he.minPrice)!=="0"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(g(),P("img",Xt)):(g(),P("img",Yt)),(e.needReverse?!e.direct:e.direct)?(g(),P("div",zt,[me(z(((W=e.positionInfo)==null?void 0:W.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(g(),P("div",Gt,[me(z(((be=e.positionInfo)==null?void 0:be.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(g(),P("div",Jt,[(e.needReverse?!e.direct:e.direct)?(g(),P("span",Qt," Position Range ")):(g(),P("span",Zt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(g(),P("div",Kt,[me(z(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(g(),P("div",Vt,[me(z(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.maxPriceResever,6)):"âˆž")+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",xt,[e.theme=="default"?(g(),P("img",ei)):(g(),P("img",oi))]),(e.needReverse?!e.direct:e.direct)?(g(),P("div",ni,[me(z(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(g(),P("div",ti,[me(z(((ye=e.positionInfo)==null?void 0:ye.minPrice)!=="0"?("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.positionInfo.minPriceResever,6)):0)+" ",1),n("span",null,z(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),me(" Â  ")]))])),n("div",ii,[n("div",si,[ae(l,{"overlay-class-name":"lever-tooltip"},{title:Be(()=>[me("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Be(()=>[ai]),_:1})]),n("div",li,z(e.lever),1)])]),n("div",ri,[ae(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse?e.minPriceResever:e.positionInfo.minPrice,"max-price":e.needReverse?e.maxPriceResever:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),ui])])])])}const Go=ze(xn,[["render",di],["__scopeId","data-v-500e09ec"]]),ci=Ye({components:{TokenWarning:ho},setup(e,t){const{t:s}=Ao(),{$notify:a}=sn(),N=nn(),p=Xe(),T=k(()=>p),w=eo(),l=k(()=>w),o=L({}),c=L({}),d=L({}),y=k(()=>T.value.chainName),I=k(()=>y.value?oo(y.value):{}),ue=po(),J=L(!1),Q=async(u=null)=>{var E,O;const v=u||o.value,S=l.value.addressLpTokens[v.poolAddress];if(S){const B=await I.value.getTickDataByIndex(S.ticks_handle||((E=v==null?void 0:v.poolInfo)==null?void 0:E.ticks_handle),Number(v.tick_lower_index)),Y=await I.value.getTickDataByIndex(S.ticks_handle||((O=v==null?void 0:v.poolInfo)==null?void 0:O.ticks_handle),Number(v.tick_upper_index));let ee={};y.value==="Aptos"?ee=await I.value.getPosRewardersAmount({poolAddress:r.currentRoute.value.query.address,positionName:r.currentRoute.value.query.token,tickLowerData:B,tickUpperData:Y}):ee=await I.value.fetchPosRewardersAmount({poolAddress:v.poolAddress,positionId:v.pos_object_id||v.clmm_position_id,coinTypeA:v.coin_type_a||v.coinTypeA,coinTypeB:v.coin_type_b||v.coinTypeB,rewarderInfo:v.poolInfo.rewarder_infos});const ce=[];let ge=new h(0);ee.forEach((R,X)=>{var $,Z;const Ae=($=l.value.tokensObj[R.coin_address])==null?void 0:$.decimals,pe=R.amount_owed.toString();let ve=new h(pe).div(Math.pow(10,Ae)).toString();if(y.value=="Aptos"&&Number(ve)>999999999&&(ve="0"),v.poolInfo[`rewarder_display${X+1}`]||Number(ve)>0){const D=l.value.tokensObj[R.coin_address],se=((Z=l.value.RATES[R.coin_address])==null?void 0:Z.price)||0,te=new h(ve).mul(se).toString();ge=new h(ge).plus(te),ce.push({...R,...D,amount:Number(ve)>0?ve:0,amountUSD:Number(te)>0?Se(te,2):0,amountUSDText:te})}}),H.value=ce}};we(()=>[l.value.currentPositionInfo,y.value],([u,v])=>{var S;v=="Aptos"&&u?(o.value=u,c.value=u==null?void 0:u.token_a,d.value=u==null?void 0:u.token_b):v=="Sui"&&u&&(u==null?void 0:u.nftHash)==((S=ue==null?void 0:ue.query)==null?void 0:S.pos)&&(o.value=u,c.value=u==null?void 0:u.token_a,d.value=u==null?void 0:u.token_b,J.value=!1)},{immediate:!0}),we(()=>[o.value,l.value.addressLpTokens],([u,v])=>{!fe(u)&&!fe(v)&&Q(u)},{immediate:!0});const _=k(()=>{var u,v,S,E,O,B,Y,ee;if(o.value&&!fe(o.value)&&l.value.RATES){const ce=o.value.amountA*((v=l.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:v.price),ge=o.value.amountB*((E=l.value.RATES[(S=o.value)==null?void 0:S.token_b.address])==null?void 0:E.price);if((B=l.value.RATES[(O=o.value)==null?void 0:O.token_a.address])!=null&&B.price&&((ee=l.value.RATES[(Y=o.value)==null?void 0:Y.token_b.address])!=null&&ee.price)){const R=Number(ce+ge);return R>0&&R<.01?"<$0.01":`$${V(Ue(ce+ge,2),2)}`}else return" --"}else return" --"}),f=k(()=>{var u,v;return(v=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:v.needReverse}),F=k(()=>l.value.RATES),i=k(()=>{var u,v;if(F.value&&c.value&&d.value&&!fe(F.value)&&!fe(c.value)&&!fe(d.value)){const S=[],E=Number(o.value.feeOwedA)||0,O=Number(o.value.feeOwedB)||0,B=new h(E).mul(((u=F.value[c.value.address])==null?void 0:u.price)||0),Y=new h(O).mul(((v=F.value[d.value.address])==null?void 0:v.price)||0);return S.push({amount:E,amountUSD:B.toString()},{amount:O,amountUSD:Y.toString()}),S}return[]}),A=k(()=>{var v,S;let u=new h(0);return(v=i==null?void 0:i.value)==null||v.forEach(E=>{u=u.add(new h(E.amount))}),y.value=="Sui"&&((S=H==null?void 0:H.value)==null||S.forEach(E=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:622 ~ canClaimYield ~ ele:",E),u=u.add(new h(E.amount))})),u.toNumber()}),m=k(()=>{var v,S;let u=new h(0);return(v=i==null?void 0:i.value)==null||v.forEach(E=>{u=u.add(new h(E.amountUSD))}),y.value=="Sui"&&((S=H==null?void 0:H.value)==null||S.forEach(E=>{u=u.add(new h(E.amountUSDText))})),u.toNumber()}),b=k(()=>{var v;let u=new h(0);return(v=H.value)==null||v.forEach(S=>{u=u.add(new h(S.amountUSDText))}),u.toNumber()}),r=ro(),H=L([]),{setIsShowSuccess:oe,setIsShowRejected:de,setIsShowWaiting:q,setTransactionDesc:C,setTransactionTxid:M}=p,U=mo(),j=k(()=>U),ne=async()=>{var v,S,E;console.log("ðŸš€ ~ file: new-position-liquidity.vue:673 ~ claimAll ~ positionInfo:",o),console.log("ðŸš€ ~ file: new-position-liquidity.vue:673 ~ claimAll ~ pendingRewarderArr:",H),J.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:H.value.length,collect_fee:!0};u.coinTypeC=H.value[0]?H.value[0].coin_address:"",u.coinTypeD=H.value[1]?H.value[1].coin_address:"",u.coinTypeE=H.value[2]?H.value[2].coin_address:"",q(!0),C();try{let O;if(y.value==="Aptos"){const B=await I.value.getCollectRewarderTransactionPayload(u);O=await j.value.currentWallet.signAndSubmitTransaction(B)}else{u.pos_index=o.value.pos_object_id;let B;if((v=o.value)!=null&&v.isLpBurn){const Y=N.getBurnClaim({pos:(S=o.value)==null?void 0:S.id,pool:o.value.poolAddress,coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,rewarderCoinTypes:(E=H.value)==null?void 0:E.map(ee=>ee==null?void 0:ee.coin_address),account:j.value.address});B=await I.value.signAndExecuteTransactionBlock(j.value.currentWallet,Y)}else{const Y=await I.value.getCollectRewarderTransactionPayload(u,o.value);B=await I.value.signAndExecuteTransactionBlock(j.value.currentWallet,Y.txb,Y.payloadParams)}O=I.value.handleTx(B)}if(O&&O.hash){M(O.hash),q(!1),oe(!0);const B={title:"Claim",desc:"",hash:O.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};y.value!=="Aptos"&&(B.res=O.res),I.value.showTransitionPending(B),await I.value.watchTransaction(B)&&(t.emit("getDetails"),setTimeout(()=>{I.value.getAccount(j.value.address)},3e3))}else console.log("0310###toClaimRewards###else###"),q(!1),de(!0),J.value=!1}catch(O){q(!1),de(!0),J.value=!1,console.log(O,"error===>")}},G=L(!1),ie=async()=>{G.value=!0;const u=H.value;let v={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};v.coinTypeC=u[0]?u[0].coin_address:"",v.coinTypeD=u[1]?u[1].coin_address:"",v.coinTypeE=u[2]?u[2].coin_address:"";try{let S;if(y.value==="Aptos"){const E=await I.value.getCollectRewarderTransactionPayload(v);S=await j.value.currentWallet.signAndSubmitTransaction(E)}else{v.pos_index=o.value.pos_object_id;const E=await I.value.getCollectRewarderTransactionPayload(v),O=await I.value.signAndExecuteTransactionBlock(j.value.currentWallet,E.txb,E.payloadParams);S=I.value.handleTx(O)}if(S&&S.hash){M(S.hash),q(!1),oe(!0);const E=u[0].amount+u[0].symbol,O=v.coinTypeD?" and "+u[1].amount+u[1].symbol:"",B=v.coinTypeE?" and "+u[2].amount+u[2].symbol:"",Y={title:"Claim",desc:"",hash:S.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:l.value.tokensObj&&u[0]&&u[0].address&&l.value.tokensObj[u[0].address]&&l.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:v.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:v.coinTypeD?l.value.tokensObj&&u[1]&&u[1].address&&l.value.tokensObj[u[1].address]&&l.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:v.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:v.coinTypeE?l.value.tokensObj&&u[2]&&u[2].address&&l.value.tokensObj[u[2].address]&&l.value.tokensObj[u[2].address].logoURI:""},text:E+O+B};y.value!=="Aptos"&&(Y.res=S.res),I.value.showTransitionPending(Y),await I.value.watchTransaction(Y)&&setTimeout(()=>{t.emit("getDetails"),I.value.getAccount(j.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),q(!1),de(!0);G.value=!1}catch(S){console.log("0310###collectRewarderParams Error###",S),G.value=!1,q(!1),de(!0)}},x=k(()=>l.value.positionDetailCurrentTab),he=k(()=>{var S,E,O,B,Y,ee;const u=ke(f.value?(E=o.value)==null?void 0:E.amountB:(S=o.value)==null?void 0:S.amountA,f.value?(ee=(Y=o.value)==null?void 0:Y.token_b)==null?void 0:ee.decimals:(B=(O=o.value)==null?void 0:O.token_a)==null?void 0:B.decimals),v=f.value?l.value.positionActionAmount.toCoinAmount||0:l.value.positionActionAmount.fromCoinAmount||0;if(x.value=="increase")return v?new h(u).add(new h(v)).toString():"";if(v){const ce=new h(u).minus(new h(v)).toString();return ce<0?"0":String(ce)}else return""}),W=k(()=>{var S,E,O,B,Y,ee;const u=ke(f.value?(E=o.value)==null?void 0:E.amountA:(S=o.value)==null?void 0:S.amountB,f.value?(ee=(Y=o.value)==null?void 0:Y.token_a)==null?void 0:ee.decimals:(B=(O=o.value)==null?void 0:O.token_b)==null?void 0:B.decimals),v=f.value?l.value.positionActionAmount.fromCoinAmount||0:l.value.positionActionAmount.toCoinAmount||0;if(x.value=="increase")return v?new h(u).add(new h(v)).toString():"";if(v){const ce=new h(u).minus(new h(v)).toString();return ce<0?"0":String(ce)}else return""}),be=k(()=>f.value?l.value.positionActionAmount.toCoinAmount:l.value.positionActionAmount.fromCoinAmount),ye=k(()=>f.value?l.value.positionActionAmount.fromCoinAmount:l.value.positionActionAmount.toCoinAmount),Le=u=>{var v;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((v=l.value.tokensObj[u==null?void 0:u.address])==null?void 0:v.logo_url)||(T.value.theme==="default"?so("/image/coins/unknown.png"):so("/image/coins/sui-unknown.png"))},Me=k(()=>{var B,Y,ee,ce,ge,R,X,Ae,pe,ve,$,Z;const{fromCoinAmount:u,toCoinAmount:v}=l.value.positionActionAmount,S=l.value.positionDetailCurrentTab,E=ke(f.value?(Y=o.value)==null?void 0:Y.amountB:(B=o.value)==null?void 0:B.amountA,f.value?(R=(ge=o.value)==null?void 0:ge.token_b)==null?void 0:R.decimals:(ce=(ee=o.value)==null?void 0:ee.token_a)==null?void 0:ce.decimals),O=ke(f.value?(Ae=o.value)==null?void 0:Ae.amountA:(X=o.value)==null?void 0:X.amountB,f.value?(Z=($=o.value)==null?void 0:$.token_a)==null?void 0:Z.decimals:(ve=(pe=o.value)==null?void 0:pe.token_b)==null?void 0:ve.decimals);return y.value=="Sui"||S=="remove"&&y.value=="Aptos"&&u==E&&v==O}),$e=async()=>{J.value=!0;const u=V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,v=V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;C(s("newAdd.claimWaitingText",{from:f.value?v:u,and:V(o.value.feeOwedA,o.value.token_a.decimals)==0||V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?u:v})),q(!0);let S;const E={pool:o.value.poolInfo,position:o.value};try{const O=await I.value.getCollectFeeTransactionPayload(E);if(y.value==="Aptos")S=await j.value.currentWallet.signAndSubmitTransaction(O);else{const B=await I.value.signAndExecuteTransactionBlock(j.value.currentWallet,O);S=I.value.handleTx(B)}if(S){M(S.hash),q(!1),oe(!0);const B={title:"Claim",desc:"",hash:S.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":l.value.tokensObj&&o.value&&o.value.token_a.address&&l.value.tokensObj[o.value.token_a.address]&&l.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":l.value.tokensObj&&o.value&&o.value.token_b.address&&l.value.tokensObj[o.value.token_b.address]&&l.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${V(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${V(o.value.feeOwedA,o.value.token_a.decimals)==0||V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${V(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};y.value!=="Aptos"&&(B.res=S.res),I.value.showTransitionPending(B);const Y=await I.value.watchTransaction(B);console.log("0310##toClaim###transitionStatus####",Y),Y&&setTimeout(()=>{t.emit("getDetails")},1e3)}else q(!1),de(!0),a.error({icon:Je("svg",{class:{icon:!0},"aria-hidden":!0},[Je("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Je("div",{class:"notification-title"},[Je("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});J.value=!1,console.log("claim####test###",S)}catch(O){console.log("claim###error####",O),J.value=!1,q(!1),de(!0),a.error({icon:Je("svg",{class:{icon:!0},"aria-hidden":!0},[Je("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Je("div",{class:"notification-title"},[Je("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},qe=Je(an,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:_,needReverse:f,decimalUi:ke,pendingFees:i,positionInfo:o,pendingRewarderArr:H,pendingYieldAmount:m,toClaim:$e,claimAll:ne,fromCoin:c,toCoin:d,showNum:Se,claimLoading:J,addCommom:V,afterBase:he,afterQuote:W,fromCoinAmount:be,toCoinAmount:ye,checkNullObj:fe,getCoinIcon:Le,chainName:y,isShowAfterAmount:Me,pendingRewarderAmount:b,toClaimRewards:ie,rewarderLoading:G,indicator:qe,canClaimYield:A}}});const vi={class:"liquidity-card"},mi={class:"liquidity-title"},fi={class:"liquidity-usd"},pi=n("span",null,"Liquidity",-1),hi={class:"liquidity-ratio"},gi={class:"coin-ratio"},bi={class:"coin-a-ratio"},ki={class:"coin-b-ratio"},_i={class:"ratio-progress"},wi={class:"base-quote-num"},yi={class:"base-coin-num"},Ai=n("span",null,"Base",-1),Ii={alt:""},Ci={key:0,class:"after"},$i={class:"quote-coin-num"},Si=n("span",null,"Quote",-1),Pi={alt:""},Ti={key:0,class:"after"},Ni={class:"pending-yield"},Ri={class:"left"},Oi={class:"pending-yield-title"},Bi={key:0,class:"after"},Li={class:"right"},qi={class:"fees-rewards"},Mi={class:"fees-rewards-item"},Ui=n("span",null,"Fees",-1),ji={key:0,class:"after"},Ei=n("span",null,"Fees",-1),Di={key:0,class:"after"},Fi=n("span",null,"Mining Rewards",-1),Wi={style:{"margin-top":"5px"}},Hi={alt:""},Xi=n("span",null,"Mining Rewards",-1),Yi={alt:""},zi={key:0,class:"after"},Gi={key:0,class:"pending-yield"},Ji={class:"left"},Qi=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Zi={key:0,class:"after"},Ki={class:"right"},Vi={key:1,class:"fees-rewards"},xi={class:"fees-rewards-item"},es=n("span",null,"Mining Rewards",-1),os={alt:""},ns={key:0,class:"after"};function ts(e,t,s,a,N,p){var c,d,y,I,ue,J,Q,_,f,F,i,A,m,b,r,H,oe,de,q,C,M,U,j,ne,G,ie,x,he,W,be,ye,Le,Me,$e,qe,u,v,S,E,O,B,Y,ee,ce,ge,R,X,Ae,pe,ve,$,Z,D,se,te,_e,Te,Ie,Ne,Ee,De,Ze,Re,je,Fe,We,Ke;const T=ho,w=vo,l=ln,o=yo("image");return g(),P("div",vi,[n("div",mi,[n("div",fi,[pi,n("div",null,z(e.amountUSD),1)]),n("div",hi,[n("div",gi,[n("div",bi,[n("span",null,z(e.needReverse?(d=e.toCoin)==null?void 0:d.symbol:(c=e.fromCoin)==null?void 0:c.symbol),1),me(" "+z(e.needReverse?(I=e.positionInfo)==null?void 0:I.toPercent:(y=e.positionInfo)==null?void 0:y.fromPercent)+"% ",1)]),n("div",ki,[n("span",null,z(e.needReverse?(J=e.fromCoin)==null?void 0:J.symbol:(ue=e.toCoin)==null?void 0:ue.symbol),1),me(" "+z(e.needReverse?(_=e.positionInfo)==null?void 0:_.fromPercent:(Q=e.positionInfo)==null?void 0:Q.toPercent)+"% ",1)])]),n("div",_i,[n("div",{class:"from-percent",style:So({width:e.needReverse?((F=e.positionInfo)==null?void 0:F.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:So({width:e.needReverse?((A=e.positionInfo)==null?void 0:A.fromPercent)+"%":((i=e.positionInfo)==null?void 0:i.toPercent)+"%"})},null,4)])])]),n("div",wi,[n("div",yi,[Ai,n("div",null,[Pe(n("img",Ii,null,512),[[o,(e.needReverse?(b=e.toCoin)==null?void 0:b.logo_url:(m=e.fromCoin)==null?void 0:m.logo_url)||e.getCoinIcon(e.needReverse?(H=e.positionInfo)==null?void 0:H.token_b:(r=e.positionInfo)==null?void 0:r.token_a)]]),ae(T,{address:e.needReverse?(C=(q=e.positionInfo)==null?void 0:q.token_b)==null?void 0:C.address:(de=(oe=e.positionInfo)==null?void 0:oe.token_a)==null?void 0:de.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,z(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.needReverse?(U=e.positionInfo)==null?void 0:U.amountB:(M=e.positionInfo)==null?void 0:M.amountA,e.needReverse?(ie=(G=e.positionInfo)==null?void 0:G.token_b)==null?void 0:ie.decimals:(ne=(j=e.positionInfo)==null?void 0:j.token_a)==null?void 0:ne.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:K(fe))(e.positionInfo)?(g(),P("div",Ci,z(("addCommom"in e?e.addCommom:K(V))(e.afterBase))+" after ",1)):re("",!0)]),n("div",$i,[Si,n("div",null,[Pe(n("img",Pi,null,512),[[o,(e.needReverse?(he=e.fromCoin)==null?void 0:he.logo_url:(x=e.toCoin)==null?void 0:x.logo_url)||e.getCoinIcon(e.needReverse?(be=e.positionInfo)==null?void 0:be.token_a:(W=e.positionInfo)==null?void 0:W.token_b)]]),ae(T,{address:e.needReverse?($e=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:$e.address:(Le=(ye=e.positionInfo)==null?void 0:ye.token_b)==null?void 0:Le.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,z(("addCommom"in e?e.addCommom:K(V))(("decimalUi"in e?e.decimalUi:K(ke))(e.needReverse?(u=e.positionInfo)==null?void 0:u.amountA:(qe=e.positionInfo)==null?void 0:qe.amountB,e.needReverse?(O=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:O.decimals:(S=(v=e.positionInfo)==null?void 0:v.token_b)==null?void 0:S.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:K(fe))(e.positionInfo)?(g(),P("div",Ti,z(("addCommom"in e?e.addCommom:K(V))(e.afterQuote))+" after ",1)):re("",!0)])]),n("div",Ni,[n("div",Ri,[n("div",Oi,z(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[me(z(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<$0.01":`$${("addCommom"in e?e.addCommom:K(V))(e.pendingYieldAmount,2)}`)+" ",1),e.pendingYieldAmount>0?(g(),P("span",Bi,"$0 after")):re("",!0)])]),n("div",Li,[ae(w,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.canClaimYield==0,onClick:t[0]||(t[0]=le=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Be(()=>[me("Claim")]),_:1},8,["loading","disabled"])])]),n("div",qi,[n("div",Mi,[n("div",null,[Ui,n("div",null,[Pe(n("img",null,null,512),[[o,(e.needReverse?(Y=e.toCoin)==null?void 0:Y.logo_url:(B=e.fromCoin)==null?void 0:B.logo_url)||e.getCoinIcon(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.token_b:(ee=e.positionInfo)==null?void 0:ee.token_a)]]),ae(T,{address:e.needReverse?(Ae=(X=e.positionInfo)==null?void 0:X.token_b)==null?void 0:Ae.address:(R=(ge=e.positionInfo)==null?void 0:ge.token_a)==null?void 0:R.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,z(e.needReverse?("showNum"in e?e.showNum:K(Se))(e.positionInfo.feeOwedB,(Z=($=e.positionInfo)==null?void 0:$.token_b)==null?void 0:Z.decimals):("showNum"in e?e.showNum:K(Se))(e.positionInfo.feeOwedA,(ve=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:ve.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(fe))(e.positionInfo)&&e.isShowAfterAmount?(g(),P("div",ji," 0 after ")):re("",!0)]),n("div",null,[Ei,n("div",null,[Pe(n("img",null,null,512),[[o,(e.needReverse?(se=e.fromCoin)==null?void 0:se.logo_url:(D=e.toCoin)==null?void 0:D.logo_url)||e.getCoinIcon(e.needReverse?(_e=e.positionInfo)==null?void 0:_e.token_a:(te=e.positionInfo)==null?void 0:te.token_b)]]),ae(T,{address:e.needReverse?(Ee=(Ne=e.positionInfo)==null?void 0:Ne.token_a)==null?void 0:Ee.address:(Ie=(Te=e.positionInfo)==null?void 0:Te.token_b)==null?void 0:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,z(e.needReverse?("showNum"in e?e.showNum:K(Se))(e.positionInfo.feeOwedA,(je=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:je.decimals):("showNum"in e?e.showNum:K(Se))(e.positionInfo.feeOwedB,(Ze=(De=e.positionInfo)==null?void 0:De.token_b)==null?void 0:Ze.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(fe))(e.positionInfo)&&e.isShowAfterAmount?(g(),P("div",Di," 0 after ")):re("",!0)]),e.chainName=="Sui"?(g(),P(xe,{key:0},[e.pendingRewarderArr.length==0&&((Ke=(We=(Fe=e.positionInfo)==null?void 0:Fe.poolInfo)==null?void 0:We.rewarderInfo)==null?void 0:Ke.length)>0?(g(!0),P(xe,{key:0},io(e.positionInfo.poolInfo.rewarderInfo,le=>(g(),P("div",{key:le.coinAddress},[Fi,n("div",Wi,[Pe(n("img",Hi,null,512),[[o,e.getCoinIcon({address:le.coinAddress})]]),ae(T,{address:le.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),ae(l,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):re("",!0),(g(!0),P(xe,null,io(e.pendingRewarderArr,le=>(g(),P("div",{key:le},[Xi,n("div",null,[Pe(n("img",Yi,null,512),[[o,le.logo_url]]),ae(T,{address:le.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,z(le.amount>0?("showNum"in e?e.showNum:K(Se))(le.amount,le.decimals):0),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(fe))(e.positionInfo)&&e.isShowAfterAmount?(g(),P("div",zi," 0 after ")):re("",!0)]))),128))],64)):re("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(g(),P("div",Gi,[n("div",Ji,[Qi,n("div",null,[me(" $"+z(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:K(V))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(g(),P("span",Zi,"$0 after")):re("",!0)])]),n("div",Ki,[ae(w,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Be(()=>[me("Claim")]),_:1},8,["loading","disabled","onClick"])])])):re("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(g(),P("div",Vi,[n("div",xi,[(g(!0),P(xe,null,io(e.pendingRewarderArr,le=>(g(),P("div",{key:le},[es,n("div",null,[Pe(n("img",os,null,512),[[o,le.logo_url]]),ae(T,{address:le.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,z(le.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:K(fe))(e.positionInfo)&&e.isShowAfterAmount?(g(),P("div",ns," 0 after ")):re("",!0)]))),128))])])):re("",!0)])}const Jo=ze(ci,[["render",ts]]),is=Ye({components:{AssetsCard:go},setup(e,t){const s=L(""),a=L(""),N=Xe(),p=k(()=>N),T=k(()=>p.value.theme),w=eo(),l=k(()=>w),o=L(!1),c=L(!1),d=L(!0),y=k(()=>p.value.chainName),I=k(()=>y.value?oo(y.value):{}),ue=mo(),J=k(()=>ue),Q=k(()=>p.value.slippage),_=L(),f=L(),F=k(()=>J.value.assets&&_.value&&J.value.assets[_.value.address]?Co(J.value.assets[_.value.address].balance,_.value.decimals):0),i=k(()=>J.value.assets&&f.value&&J.value.assets[f.value.address]?Co(J.value.assets[f.value.address].balance,f.value.decimals):0),A=v=>{v==="fromCoin"?(d.value=!0,y.value==="Aptos"?s.value=F.value>0?_.value.symbol=="APT"?new h(Number(F.value)).sub(new h(.1)).lt(new h(0))?"0":new h(Number(F.value)).sub(new h(.1)).toString():String(F.value):"":s.value=F.value>0?_.value.symbol=="SUI"?new h(Number(F.value)).sub(new h(.05)).lt(new h(0))?"0":new h(Number(F.value)).sub(new h(.05)).toString():String(F.value):""):(d.value=!1,y.value==="Aptos"?a.value=i.value>0?f.value.symbol=="APT"?new h(Number(i.value)).sub(new h(.1)).lt(new h(0))?"0":new h(Number(i.value)).sub(new h(.1)).toString():String(i.value):"":a.value=i.value>0?f.value.symbol=="SUI"?new h(Number(i.value)).sub(new h(.05)).lt(new h(0))?"0":new h(Number(i.value)).sub(new h(.05)).toString():String(i.value):"")},m=v=>{v==="fromCoin"?(d.value=!0,s.value=Ue(new h(Number(F.value)).div(2).toString(),_.value.decimals).toString()):(d.value=!1,a.value=Ue(new h(Number(i.value)).div(2).toString(),f.value.decimals).toString())},b=L({}),r=L(!0),H=L({}),oe=L(),de=L(),q=()=>{var Ae;if(!b.value||!s.value&&!a.value)return;const{TickMath:v,TickUtil:S}=I.value;let E=b.value.minPrice,O=b.value.maxPrice.indexOf("+")>0?"âˆž":b.value.maxPrice,B=Number(b.value.tick_lower_index),Y=Number(b.value.tick_upper_index);const ee=Number(b.value.current_tick_index);let ce,ge,R=Number(E).toString(),X=b.value.maxPrice.indexOf("+")>0||b.value.maxPrice==="âˆž"?"âˆž":Number(O);if(R=="0"&&X=="âˆž"?(B=Number(b.value.tick_lower_index),Y=Number(b.value.tick_upper_index)):(ce=v.priceToSqrtPriceX64(new h(E),_.value.decimals,f.value.decimals),ge=v.priceToSqrtPriceX64(new h(O),_.value.decimals,f.value.decimals)),oe.value=B,de.value=Y,O!=="âˆž"&&B>=Y){o.value=!0,s.value="",c.value=!0,a.value="";return}if(O=="âˆž"||ee>=B&&ee<Y){o.value=!1,c.value=!1;let pe;if(s.value||a.value){if(d.value){const te=new h(s.value).mul(Math.pow(10,_.value.decimals)).toString();pe=new Oe(te)}else{const te=new h(a.value).mul(Math.pow(10,f.value.decimals)).toString();pe=new Oe(te)}const{liquidityAmount:ve,tokenMaxA:$,tokenMaxB:Z,tokenMaxAOrigin:D,tokenMaxBOrigin:se}=I.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:_.value,tokenB:f.value,lowerTick:B,upperTick:Y,coinAmount:pe,iscoinA:r.value?d.value:!d.value,roundUp:!0,slippage:Number(Q.value)/100,curSqrtPrice:new Oe(b.value.current_sqrt_price)});H.value={liquidityAmount:ve,tokenMaxA:$,tokenMaxB:Z,tokenMaxAOrigin:D,tokenMaxBOrigin:se},r.value?d.value?a.value=Number(Z)>0?Z:"":s.value=Number($)>0?$:"":d.value?a.value=$:s.value=Z}}else if(ee>=Y){if(s.value="",o.value=!0,c.value=!1,s.value||a.value){let pe;const ve=new h(a.value).mul(Math.pow(10,(Ae=f.value)==null?void 0:Ae.decimals)).toString();pe=new Oe(ve),H.value={liquidityAmount:Mo(ce,ge,pe),tokenMaxA:0,tokenMaxB:a.value}}}else if(ee<B){if(o.value=!1,c.value=!0,a.value="",s.value||a.value){let pe;const ve=new h(s.value).mul(Math.pow(10,_.value.decimals)).toString();pe=new Oe(ve),H.value={liquidityAmount:Uo(ce,ge,pe),tokenMaxA:s.value,tokenMaxB:0}}}else o.value=!0,s.value="",c.value=!0,a.value="";w.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};we(()=>l.value.currentPositionInfo,v=>{if(v&&!fe(v)){b.value=v,_.value=b.value.token_a,f.value=b.value.token_b;let S=Number(b.value.tick_lower_index),E=Number(b.value.tick_upper_index);const O=Number(b.value.current_tick_index);(v.maxPrice.indexOf("+")>0||v.maxPrice==="âˆž"?"âˆž":v.maxPrice)=="âˆž"||O>=S&&O<E?(o.value=!1,c.value=!1):O>=E?(s.value="",o.value=!0,c.value=!1):O<S?(o.value=!1,c.value=!0,a.value=""):(o.value=!0,s.value="",c.value=!0,a.value=""),q()}},{immediate:!0}),we(s,(v,S)=>{v&&q(),v==""&&(a.value="")}),we(a,(v,S)=>{v&&q(),v==""&&(s.value="")});const C=k(()=>{var v,S;return(S=(v=b.value)==null?void 0:v.poolInfo)==null?void 0:S.needReverse}),M=k(()=>l.value.RATES),U=k(()=>{var Y,ee,ce,ge;const v=((ee=M.value[(Y=_.value)==null?void 0:Y.address])==null?void 0:ee.price)||0,S=((ge=M.value[(ce=f.value)==null?void 0:ce.address])==null?void 0:ge.price)||0,E=new h(v).mul(new h(s.value||0)),O=new h(S).mul(new h(a.value||0)),B=E.add(O);return B.toNumber()?B.toNumber()>0&&B.toNumber()>.01?V(B.toString(),2):"<0.01":"--"}),j=L(!1),{t:ne,locale:G}=Ao(),ie=k(()=>{const v=Number(s.value)>Number(F.value),S=Number(a.value)>Number(i.value);return!s.value&&!a.value?ne("button.enterAmount"):v?ne("button.insufficientBalance",{name:_.value.symbol}):S?ne("button.insufficientBalance",{name:f.value.symbol}):ne("newAdd.addMore")}),x=k(()=>{const v=Number(s.value)>Number(F.value),S=Number(a.value)>Number(i.value);return!!(u.value||!s.value&&!a.value||v||S)}),{setIsShowSuccess:he,setIsShowRejected:W,setIsShowWaiting:be,setTransactionDesc:ye,setTransactionTxid:Le,setPositiomNum:Me}=N,$e=L(!1),qe=async()=>{var Y,ee,ce,ge,R,X,Ae,pe,ve,$,Z,D;j.value=!1,$e.value=!0,Le("");const v=o.value?"":`${s.value} ${(Y=_.value)==null?void 0:Y.symbol}`,S=c.value?"":`${a.value} ${(ee=f.value)==null?void 0:ee.symbol}`;ye(ne("tips.increaseLiquiditySuccess",{from:C.value?S:v,and:!o.value&&!c.value?"and":"",to:C.value?v:S})),be(!0);const E=d.value,O=b.value.poolInfo.rewarder_infos;let B={};B.coinTypeC=O[0]?O[0].coinAddress:"",B.coinTypeD=O[1]?O[1].coinAddress:"",B.coinTypeE=O[2]?O[2].coinAddress:"";try{const se=await I.value.getAddLiquidityTransactionPayload({pool:{poolAddress:b.value.poolAddress,token_a:b.value.token_a,token_b:b.value.token_b},amount:E?H.value.tokenMaxA:H.value.tokenMaxB,fix_amount_a:E,tick_lower:oe.value,tick_upper:de.value,index:y.value==="Aptos"?b.value.index:b.value.pos_object_id,slippage:Number(Q.value)/100,roundUp:!0,collect_fee:!0,...B,curSqrtPrice:new Oe(b==null?void 0:b.value.poolInfo.current_sqrt_price),positionInfo:b});let te;if(y.value==="Aptos")te=await J.value.currentWallet.signAndSubmitTransaction(se);else{const _e=await I.value.signAndExecuteTransactionBlock(J.value.currentWallet,se==null?void 0:se.txb,se==null?void 0:se.payloadParams);te=I.value.handleTx(_e)}if(console.log("toAdd###tx###",te),te&&te.hash){Le(te.hash),be(!1),he(!0);const _e={title:"Supplied",desc:ne("tips.addLiquiditySuccessText",{from:o.value?"":`${C.value?a.value:s.value} ${C.value?(ge=f==null?void 0:f.value)==null?void 0:ge.symbol:(ce=_.value)==null?void 0:ce.symbol}`,and:!o.value&&!c.value?"and":"",to:c.value?"":`${C.value?s.value:a.value} ${C.value?(X=_==null?void 0:_.value)==null?void 0:X.symbol:(R=f.value)==null?void 0:R.symbol}`}),hash:te.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:C.value?`${(pe=f.value)==null?void 0:pe.address}`:`${(Ae=_.value)==null?void 0:Ae.address}`,numa:C.value?`- ${a.value}`:`- ${s.value}`,logoa:C.value?l.value.tokensObj&&f.value&&f.value.address&&l.value.tokensObj[f.value.address]&&l.value.tokensObj[f.value.address].logoURI:l.value.tokensObj&&_.value&&_.value.address&&l.value.tokensObj[_.value.address]&&l.value.tokensObj[_.value.address].logoURI,tokenb:C.value?`${($=_.value)==null?void 0:$.address}`:`${(ve=f.value)==null?void 0:ve.address}`,numb:C.value?`- ${s.value}`:`- ${a.value}`,logob:C.value?l.value.tokensObj&&_.value&&_.value.address&&l.value.tokensObj[_.value.address]&&l.value.tokensObj[_.value.address].logoURI:l.value.tokensObj&&f.value&&f.value.address&&l.value.tokensObj[f.value.address]&&l.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${o.value?"":`${s.value} ${(Z=_.value)==null?void 0:Z.symbol}`} ${!o.value&&!c.value?"and":""} ${c.value?"":`${a.value} ${(D=f.value)==null?void 0:D.symbol}`}`};y.value!=="Aptos"&&(_e.res=te.res),I.value.showTransitionPending(_e),await I.value.watchTransaction(_e)&&setTimeout(()=>{t.emit("getDetails"),I.value.getAccount(J.value.address)},1e3),Me()}else be(!1),W(!0);s.value="",a.value="",$e.value=!1}catch(se){s.value="",a.value="",console.log("addError###",se),$e.value=!1,be(!1),W(!0)}},u=k(()=>{var v;return(v=b.value)==null?void 0:v.isLpBurn});return{isLpBurn:u,theme:T,showFromCoinLock:o,showToCoinLock:c,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:F,toCoinBlance:i,fromCoin:_,toCoin:f,maxBtnSelect:A,halfBtnSelect:m,fixedFromCoin:d,needReverse:C,totalAmount:U,wallet:J,addLiquidityBtnText:ie,isShowLiquidityModal:j,indexStore:N,positionInfo:b,actionLoading:$e,toAdd:qe,addLiquidityBtnDisabled:x,poolStore:w}}});const ss={class:"new-position-asset"},as={class:"add-or-remove"},ls={class:"liquidity-action-tab"},rs=n("div",{class:"increase tab-active"}," Increase ",-1),us={class:"card-item"},ds={class:"card-item"},cs={key:1,class:"add",src:kn},vs={key:2,class:"add",src:_n},ms={key:0,class:"total-amount"},fs=n("span",null,"Total Amount",-1);function ps(e,t,s,a,N,p){var c;const T=Eo,w=go,l=vo,o=wn;return g(),P("div",ss,[n("div",as,[n("div",ls,[rs,n("div",{class:"remove",onClick:t[0]||(t[0]=d=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:fo(e.needReverse?"card-container reverse":"card-container")},[e.isLpBurn?(g(),Ce(T,{key:0,"is-lp-burn-pos":!0})):re("",!0),n("div",us,[ae(w,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=d=>{e.fromCoinAmount=d}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),!e.isLpBurn&&e.showFromCoinLock?(g(),Ce(T,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):re("",!0)]),n("div",ds,[ae(w,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=d=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=d=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=d=>{e.toCoinAmount=d}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),!e.isLpBurn&&e.showToCoinLock?(g(),Ce(T,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):re("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(g(),P("img",cs)):re("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(g(),P("img",vs)):re("",!0)],2),e.isLpBurn?re("",!0):(g(),P("div",ms,[fs,n("span",null,"$"+z(e.totalAmount),1)]))]),e.wallet.connected?(g(),Ce(l,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=d=>e.isShowLiquidityModal=!0)},{default:Be(()=>[n("span",null,z(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(g(),Ce(l,{key:1,class:"big-btn",onClick:t[12]||(t[12]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Be(()=>[n("span",null,z(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(g(),Ce(o,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(c=e.positionInfo)==null?void 0:c.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=d=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):re("",!0)])}const Qo=ze(is,[["render",ps]]),hs=Ye({components:{AssetsCard:go},setup(e,t){const s=L(""),a=L(""),N=Xe(),p=k(()=>N),T=k(()=>p.value.theme),w=eo(),l=k(()=>w),o=L(!1),c=L(!1),d=L(!0),y=k(()=>p.value.chainName),I=k(()=>y.value?oo(y.value):{}),ue=mo(),J=k(()=>ue),Q=k(()=>p.value.slippage),_=L(),f=L(),F=k(()=>{var $,Z;return(Z=($=r.value)==null?void 0:$.poolInfo)==null?void 0:Z.needReverse}),i=k(()=>{var $;return ke(r==null?void 0:r.value.amountA,($=r==null?void 0:r.value.token_a)==null?void 0:$.decimals)}),A=k(()=>{var $;return ke(r==null?void 0:r.value.amountB,($=r==null?void 0:r.value.token_b)==null?void 0:$.decimals)}),m=$=>{$==="fromCoin"?(d.value=!0,C.value||(y.value==="Aptos"||console.log(i.value,"213===>"),s.value=String(i.value))):(d.value=!1,C.value||(y.value,a.value=String(A.value))),U.value=100,ne({value:1})},b=$=>{$==="fromCoin"?(d.value=!0,s.value=Ue(new h(Number(i.value)).div(2).toString(),_.value.decimals).toString()):(d.value=!1,a.value=Ue(new h(Number(A.value)).div(2).toString(),f.value.decimals).toString()),C.value=!1},r=L({}),H=L(!0),oe=L({}),de=L(),q=L(),C=L(!0),M=()=>{var Ze;if(C.value||!r.value||!s.value&&!a.value||Number(s.value)>Number(i.value)||Number(a.value)>Number(A.value))return;if(s.value==i.value&&a.value==A.value){U.value=100,ne({value:1}),C.value=!0;return}const{TickMath:$,TickUtil:Z}=I.value;let D=r.value.minPrice,se=r.value.maxPrice.indexOf("+")>0?"âˆž":r.value.maxPrice,te=Number(r.value.tick_lower_index),_e=Number(r.value.tick_upper_index);const Te=Number(r.value.current_tick_index);let Ie,Ne,Ee=Number(D).toString(),De=r.value.maxPrice.indexOf("+")>0||r.value.maxPrice==="âˆž"?"âˆž":Number(se);if(Ee=="0"&&De=="âˆž"?(te=Number(r.value.tick_lower_index),_e=Number(r.value.tick_upper_index)):(Ie=$.priceToSqrtPriceX64(new h(D),_.value.decimals,f.value.decimals),Ne=$.priceToSqrtPriceX64(new h(se),_.value.decimals,f.value.decimals)),de.value=te,q.value=_e,se!=="âˆž"&&te>=_e){o.value=!0,s.value="",c.value=!0,a.value="";return}if(se=="âˆž"||Te>=te&&Te<_e){o.value=!1,c.value=!1;let Re;if(s.value||a.value){if(d.value){const Ge=new h(s.value).mul(Math.pow(10,_.value.decimals)).toString();Re=new Oe(Ge)}else{const Ge=new h(a.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Ge)}const{liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ke,tokenMaxBOrigin:le}=I.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:_.value,tokenB:f.value,lowerTick:te,upperTick:_e,coinAmount:Re,iscoinA:H.value?d.value:!d.value,roundUp:y.value!="Sui",slippage:Number(Q.value)/100,curSqrtPrice:new Oe(r.value.current_sqrt_price)});oe.value={liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ke,tokenMaxBOrigin:le},H.value?d.value?a.value=Number(We)>0?We:"":s.value=Number(Fe)>0?Fe:"":d.value?a.value=Fe:s.value=We}}else if(Te>=_e){if(s.value="",o.value=!0,c.value=!1,s.value||a.value){let Re;const je=new h(a.value).mul(Math.pow(10,(Ze=f.value)==null?void 0:Ze.decimals)).toString();Re=new Oe(je),oe.value={liquidityAmount:Mo(Ie,Ne,Re),tokenMaxA:0,tokenMaxB:a.value}}}else if(Te<te){if(o.value=!1,c.value=!0,a.value="",s.value||a.value){let Re;const je=new h(s.value).mul(Math.pow(10,_.value.decimals)).toString();Re=new Oe(je),oe.value={liquidityAmount:Uo(Ie,Ne,Re),tokenMaxA:s.value,tokenMaxB:0}}}else o.value=!0,c.value=!0;C.value=!1,U.value=new h(oe.value.liquidityAmount.toString()).div(r.value.liquidity).mul(100).toNumber().toFixed(2),j.value=oe.value.liquidityAmount,w.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})},U=L(0),j=L("0"),ne=$=>{if(console.log("setPercent isSlider.value: ",C.value),!C.value)return;C.value=!0;const Z=r.value.token_a.decimals,D=r.value.token_b.decimals,se=r.value.tick_lower_index,te=r.value.tick_upper_index,_e=Po.tickIndexToSqrtPriceX64(se),Te=Po.tickIndexToSqrtPriceX64(te);let Ie="";$.value!==1?Ie=new h(r.value.liquidity).mul($.value).toString():Ie=r.value.liquidity,Ie=Ue(Ie,0)||"0",j.value=Ie;const Ne=fn.getCoinAmountFromLiquidity(new Oe(Ie),new Oe(r.value.current_sqrt_price),_e,Te,y.value!="Sui"),Ee=new h(Ne.coinA.toString()).div(Math.pow(10,Z)).toString(),De=new h(Ne.coinB.toString()).div(Math.pow(10,D)).toString();s.value=Number(Ee)>0?Ee:"",a.value=Number(De)>0?De:"",w.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};we(()=>l.value.currentPositionInfo,$=>{if($&&!fe($)){r.value=$,_.value=r.value.token_a,f.value=r.value.token_b,ne({value:U.value/100});let Z=Number(r.value.tick_lower_index),D=Number(r.value.tick_upper_index);const se=Number(r.value.current_tick_index);($.maxPrice.indexOf("+")>0||$.maxPrice==="âˆž"?"âˆž":$.maxPrice)=="âˆž"||se>=Z&&se<D?(o.value=!1,c.value=!1):se>=D?(s.value="",o.value=!0,c.value=!1):se<Z?(o.value=!1,c.value=!0,a.value=""):(o.value=!0,s.value="",c.value=!0,a.value=""),M()}},{immediate:!0}),we(s,($,Z)=>{$&&M(),$==""&&(a.value="",U.value=0)}),we(a,($,Z)=>{$&&M(),$==""&&(s.value="",U.value=0)});const G=k(()=>l.value.RATES),ie=k(()=>{var _e,Te,Ie,Ne;const $=((Te=G.value[(_e=_.value)==null?void 0:_e.address])==null?void 0:Te.price)||0,Z=((Ne=G.value[(Ie=f.value)==null?void 0:Ie.address])==null?void 0:Ne.price)||0,D=new h($).mul(new h(s.value||0)),se=new h(Z).mul(new h(a.value||0)),te=D.add(se);return V(te.toString(),2)}),x=L(!1),{t:he,locale:W}=Ao(),be=k(()=>{const $=Number(s.value)>Number(i.value),Z=Number(a.value)>Number(A.value);return!s.value&&!a.value?he("button.enterAmount"):$||Z?"Invalid Amount":he("button.remove")}),ye=k(()=>{const $=Number(s.value)>Number(i.value),Z=Number(a.value)>Number(A.value);return!!(ve.value||!s.value&&!a.value||$||Z)}),{setIsShowSuccess:Le,setIsShowRejected:Me,setIsShowWaiting:$e,setTransactionDesc:qe,setTransactionTxid:u,setPositiomNum:v,setTransactionDescText:S}=N,E=L(!1);we(U,rn(($,Z)=>{$!==Z&&(Number($)>100?U.value=100:$&&r.value?(U.value=$,ne({value:U.value/100})):(s.value="",a.value=""))},300)),we(Q,$=>{$&&r.value&&ne({value:U.value/100})});const O=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],B=Do(),Y=k(()=>B),ee=k(()=>Y.value.status),ce=L(!1),ge=$=>{$.sources.forEach(D=>{const{pool_address:se,position_index:te}=JSON.parse(D.blockchainAddress);se==r.value.poolAddress&&Number(te)==Number(r.value.index)&&(ce.value=!0)})},R=async()=>{await B.getSources();let $;Y.value.allSources.forEach(Z=>{const{pool_address:D,position_index:se}=JSON.parse(Z.blockchainAddress);D==r.value.poolAddress&&se==r.value.index&&($=Z.id)}),B.deleteSource($)};we(()=>[Y.value.sourceGroups,r.value],([$,Z])=>{$&&$.sources&&$.sources.length>0&&Z&&!fe(Z)&&ge($)},{immediate:!0,deep:!0});const X=ro(),Ae=po(),pe=async()=>{var te,_e,Te,Ie,Ne,Ee,De,Ze,Re,je,Fe,We,Ke;E.value=!0,u("");const $=V(s.value,_.value.decimals)==0?"":`${ke(s.value,_.value.decimals)} ${_.value.symbol}`,Z=V(a.value,f.value.decimals)==0?"":`${ke(a.value,f.value.decimals)} ${f.value.symbol}`;qe(he("tips.removeLiquidiyText",{from:F.value?Z:$,and:V(s.value,_.value.decimals)==0||V(a.value,f.value.decimals)==0?"":"and",to:F.value?$:Z})),$e(!0);const D=r.value.poolInfo.rewarder_infos,se=D&&D.length>0&&y.value=="Sui"||D&&D.length>0&&U.value==100?he("modal.removeLiquidityText1"):he("modal.removeLiquidityText2");S(se);try{let le={};le={pool:{...r.value.poolInfo,coinA:r.value.token_a,coinB:r.value.token_b},coinTypeA:r.value.poolInfo.coinTypeA,coinTypeB:r.value.poolInfo.coinTypeB,position:r.value,delta_liquidity:U.value==100?new Oe(r.value.liquidity):new Oe(Ue(j.value,0)),slippage:Number(Q.value),rewards_num:D.length,positionInfo:r.value},le.coinTypeC=D[0]?D[0].coinAddress:"",le.coinTypeD=D[1]?D[1].coinAddress:"",le.coinTypeE=D[2]?D[2].coinAddress:"";const Ge=await I.value.getRemoveLiquidityTransactionPayload(le);let He;if(y.value==="Aptos")He=await J.value.currentWallet.signAndSubmitTransaction(Ge);else{const uo=await I.value.signAndExecuteTransactionBlock(J.value.currentWallet,Ge.txb,Ge==null?void 0:Ge.payloadParams);He=I.value.handleTx(uo),console.log("0331###remove###tx####",He)}if(He&&He.hash){u(He.hash),$e(!1),Le(!0);const uo={title:he("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${s.value} ${(te=_.value)==null?void 0:te.symbol} and ${a.value} ${(_e=f.value)==null?void 0:_e.symbol} 
             from the pool`,sender:J.value.address,chainName:y.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:F.value?`${(Ie=f.value)==null?void 0:Ie.address}`:`${(Te=_.value)==null?void 0:Te.address}`,numa:F.value?`+ ${a.value}`:`+ ${s.value}`,logoa:F.value?l.value.tokensObj&&f.value&&f.value.address&&l.value.tokensObj[f.value.address]&&l.value.tokensObj[f.value.address].logoURI:l.value.tokensObj&&_.value&&_.value.address&&l.value.tokensObj[_.value.address]&&l.value.tokensObj[_.value.address].logoURI,tokenb:F.value?`${(Ne=_.value)==null?void 0:Ne.address}`:`${(Ee=f.value)==null?void 0:Ee.address}`,numb:F.value?`+ ${s.value}`:`+ ${a.value}`,logob:F.value?l.value.tokensObj&&_.value&&_.value.address&&l.value.tokensObj[_.value.address]&&l.value.tokensObj[_.value.address].logoURI:l.value.tokensObj&&f.value&&f.value.address&&l.value.tokensObj[f.value.address]&&l.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${s.value} ${(De=_.value)==null?void 0:De.symbol} and ${a.value} ${(Ze=f.value)==null?void 0:Ze.symbol}`};y.value!=="Aptos"&&(uo.res=He.res),I.value.showTransitionPending(uo);const Io=await I.value.watchTransaction(uo);if(D.value&&D.value.length>0&&(Number((Re=D[0])==null?void 0:Re.amount)!==0||le.coinTypeD&&Number((je=D[1])==null?void 0:je.amount)!==0||le.coinTypeE&&Number((Fe=D[2])==null?void 0:Fe.amount)!==0)){const bo={title:he("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:D[0].symbol,numa:`+ ${Number(D[0].amount)}`,logoa:l.value.tokensObj&&D[0]&&D[0].address&&l.value.tokensObj[D[0].address]&&l.value.tokensObj[D[0].address].logoURI,tokenb:le.coinTypeD?D[1].symbol:"",numb:le.coinTypeD?`+ ${Number(D[1].amount)}`:"",logob:le.coinTypeD?l.value.tokensObj&&D[1]&&D[1].address&&l.value.tokensObj[D[1].address]&&l.value.tokensObj[D[1].address].logoURI:"",tokenc:le.coinTypeE?D[2].symbol:"",numc:le.coinTypeE?`+ ${Number(D[2].amount)}`:"",logoc:le.coinTypeE?l.value.tokensObj&&D[2]&&D[2].address&&l.value.tokensObj[D[2].address]&&l.value.tokensObj[D[2].address].logoURI:""},text:`Withdraw ${s.value} ${(We=_.value)==null?void 0:We.symbol} and ${a.value} ${(Ke=f.value)==null?void 0:Ke.symbol}`},xo=await I.value.setTransations(bo)}if(Se(r.value.feeOwedA,r.value.token_a.decimals)!==0||Se(r.value.feeOwedB,r.value.token_b.decimals)!==0){const bo={title:"Claim",desc:"",hash:He.hash,chainName:y.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${r.value.token_a.symbol}`,numa:V(r.value.feeOwedA,r.value.token_a.decimals)==0?"":`+ ${Se(r.value.feeOwedA,r.value.token_a.decimals)}`,logoa:V(r.value.feeOwedA,r.value.token_a.decimals)==0?"":l.value.tokensObj&&r.value&&r.value.token_a.address&&l.value.tokensObj[r.value.token_a.address]&&l.value.tokensObj[r.value.token_a.address].logoURI,tokenb:`${r.value.token_b.symbol}`,numb:V(r.value.feeOwedB,r.value.token_b.decimals)==0?"":`+ ${Se(r.value.feeOwedB,r.value.token_b.decimals)}`,logob:V(r.value.feeOwedB,r.value.token_b.decimals)==0?"":l.value.tokensObj&&r.value&&r.value.token_b.address&&l.value.tokensObj[r.value.token_b.address]&&l.value.tokensObj[r.value.token_b.address].logoURI}},xo=await I.value.setTransations(bo)}Io&&Number(U.value)==100&&ee.value=="authenticated"&&ce.value&&(await B.subscribePosition({pool_address:r.value.poolAddress,position_index:r.value.index},r.value.nftHash,!1),R()),Io&&(s.value="",a.value="",setTimeout(()=>{Number(U.value)!==100&&t.emit("getDetails")},3e3),setTimeout(()=>{Number(U.value)!==100&&t.emit("getDetails")},6e3),Number(U.value)==100&&Ae.name=="new-position-detail"&&(y.value==="Aptos"?X.push("/position"):X.push("/pool/position")),U.value=0)}else $e(!1),Me(!0);E.value=!1}catch(le){console.log("Remove error",le),E.value=!1,$e(!1),Me(!0)}},ve=k(()=>{var $;return($=r.value)==null?void 0:$.isLpBurn});return{isLpBurn:ve,theme:T,showFromCoinLock:o,showToCoinLock:c,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:i,toCoinBlance:A,fromCoin:_,toCoin:f,maxBtnSelect:m,halfBtnSelect:b,fixedFromCoin:d,needReverse:F,totalAmount:ie,wallet:J,addLiquidityBtnText:be,isShowLiquidityModal:x,indexStore:N,positionInfo:r,actionLoading:E,addLiquidityBtnDisabled:ye,sliderVal:U,ratioArr:O,setPercent:ne,poolStore:w,isSlider:C,toRemove:pe,sFixD:Ue}}});const gs={class:"new-position-asset"},bs={class:"add-or-remove"},ks={class:"liquidity-action-tab"},_s=n("div",{class:"remove tab-active"},"Remove",-1),ws={class:"card-item"},ys={key:0,class:"assets-card-mask"},As={class:"card-item"},Is={key:0,class:"assets-card-mask"},Cs={key:0,class:"remove-ratio"},$s=n("div",{class:"remove-ratio-title"},"Amount",-1),Ss={class:"remove-ratio-select"},Ps={key:0,class:"ratio"},Ts={key:1,class:"ratio"},Ns={class:"ratio-list"},Rs=["onClick"];function Os(e,t,s,a,N,p){const T=Eo,w=go,l=un,o=vo;return g(),P("div",gs,[n("div",bs,[n("div",ks,[n("div",{class:"increase",onClick:t[0]||(t[0]=c=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),_s]),n("div",{class:fo(e.needReverse?"card-container reverse":"card-container")},[e.isLpBurn?(g(),Ce(T,{key:0,"is-lp-burn-pos":!0})):re("",!0),n("div",ws,[ae(w,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=c=>e.fromCoinAmount=c),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=c=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=c=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=c=>{e.fromCoinAmount=c,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(g(),P("div",ys)):re("",!0)]),n("div",As,[ae(w,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=c=>e.toCoinAmount=c),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=c=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=c=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=c=>{e.toCoinAmount=c,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(g(),P("div",Is)):re("",!0)])],2),e.isLpBurn?re("",!0):(g(),P("div",Cs,[$s,n("div",Ss,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(g(),P("div",Ps,z(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:K(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:K(Ue))(e.sliderVal,2))+"% ",1)):(g(),P("div",Ts," -- ")),n("div",Ns,[(g(!0),P(xe,null,io(e.ratioArr,(c,d)=>(g(),P("div",{key:d,class:fo(["ratio-item",e.sliderVal==c.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=c.value}},z(c.name),11,Rs))),128))])]),ae(l,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=c=>e.sliderVal=c)},null,8,["value"])]))]),e.wallet.connected?(g(),Ce(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Be(()=>[n("span",null,z(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(g(),Ce(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=c=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Be(()=>[n("span",null,z(e.$t("button.connectWallet")),1)]),_:1}))])}const Zo=ze(hs,[["render",Os]]),Bs=Ye({setup(){const e=eo(),t=k(()=>e),s=Fo(),a=k(()=>s),N=ro(),p=k(()=>t.value.currentPositionInfo),T=L(),w=q=>{var C;return((C=t.value.tokensObj[q])==null?void 0:C.logo_url)||so("/image/coins/sui-unknown.png")},l=tn("Sui"),o=L(),c=async q=>{o.value=0;try{const C=await l.calculateFarmingRewards([{pool_id:q.pool_id,position_nft_id:q.id}]),M=[];let U=new h(0);C[q.id].forEach((j,ne)=>{var x;const G=(x=t.value.tokensObj[j.rewarder_type])==null?void 0:x.decimals;let ie=new h(j.rewarder_amount).div(Math.pow(10,G)).toString();Number(ie)>0&&y.value.rewarders[ne]&&(U=U.add(ie),M.push({...j,rewarderAmount:ie,rewarderAmountPer:ie}))}),o.value=U,T.value=M}catch(C){console.log(C,"getRewarder")}},d=k(()=>a.value.farmsPoolObj),y=k(()=>d.value[p.value.poolAddress]);we(()=>[p.value,d.value,y.value],([q,C,M])=>{var U;!fe(q)&&q.positionSource=="farming"&&!fe(M)?c(q):!fe(C)&&!fe(q)&&(T.value=(U=C[q.poolAddress])==null?void 0:U.rewarders)},{immediate:!0});const I=mo(),ue=k(()=>I),J=Xe(),Q=oo("Sui"),{setIsShowSuccess:_,setIsShowRejected:f,setIsShowWaiting:F,setTransactionDesc:i,setTransactionTxid:A}=J,m=L(!1),b=async()=>{m.value=!0,A(""),i("Claim rewards"),F(!0);const q={pool_id:p.value.pool_id,position_nft_id:p.value.id};try{const C=await l.harvestFarms(q),M=await Q.signAndExecuteTransactionBlock(ue.value.currentWallet,C.txb,C.payloadParams);console.log("0221###sui swap res###",M);let U=Q.handleTx(M);if(U&&U.hash){A(U.hash),F(!1),_(!0);let j={title:"Claim",res:U.res,hash:U.hash};Q.showTransitionPending(j),await Q.watchTransaction(j)&&setTimeout(()=>{c(p.value),Q.getAccount(ue.value.address)},2e3)}else F(!1),f(!0);m.value=!1}catch(C){console.log("farmsDeposit error",C),F(!1),f(!0),m.value=!1}},r=async()=>{m.value=!0,A(""),i(`Unstake ${p.value.name}`),F(!0);const q=p.value.pool_id,C=p.value.id;try{const M=await l.farmsWithdraw(q,C),U=await Q.signAndExecuteTransactionBlock(ue.value.currentWallet,M.txb,M.payloadParams);console.log("0221###sui swap res###",U);let j=Q.handleTx(U);if(j&&j.hash){A(j.hash),F(!1),_(!0);let ne={res:j.res,title:"Unstake",hash:j.hash};Q.showTransitionPending(ne),await Q.watchTransaction(ne)&&setTimeout(()=>{N.replace(`/new-position-detail?token=${p.value.tokenName}&address=${p.value.clmm_pool_id}&pos=${p.value.clmm_position_id}`),t.value.setCurrentPositionInfo(p.value.clmm_pool_id,"",p.value.tokenName,"Sui",p.value.clmm_position_id),o.value=0,m.value=!1},2e3)}else F(!1),f(!0)}catch(M){console.log("farmsDeposit error",M),F(!1),f(!0),m.value=!1}},H=async()=>{m.value=!0,A(""),i(`Stake ${p.value.name}`),F(!0);const q={clmm_pool_id:p.value.poolAddress,clmm_position_id:p.value.pos_object_id,coinTypeA:p.value.coin_type_a,coinTypeB:p.value.coin_type_b},C=d.value[p.value.poolAddress].id;try{const M=await l.farmsDeposit(q,C),U=await Q.signAndExecuteTransactionBlock(ue.value.currentWallet,M.txb,M.payloadParams);console.log("0221###sui swap res###",U);let j=Q.handleTx(U);if(j&&j.hash){A(j.hash),F(!1),_(!0);let ne={res:j.res,title:"Staked",hash:j.hash};Q.showTransitionPending(ne);const G=await Q.watchTransaction(ne,!0);let ie;G!=null&&G.status&&setTimeout(async()=>{var x,he;(he=(x=G==null?void 0:G.res)==null?void 0:x.events)==null||he.forEach(W=>{W.type.indexOf("::pool::DepositEvent")>-1&&(ie=W.parsedJson.wrapped_position_id)}),N.replace(`/new-position-detail?position_nft_id=${ie}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",ie,"farming"),m.value=!1},2e3)}else F(!1),f(!0)}catch(M){console.log("farmsDeposit error",M),F(!1),f(!0),m.value=!1}},oe=k(()=>J),de=k(()=>oe.value.addressLpTokens);return{getCoinIcon:w,rewardList:T,sFixD:Ue,addCommom:V,claim:b,unStake:r,loading:m,totalRewardAmount:o,currentPositionInfo:p,stake:H,farmsPoolObj:d,addressLpTokens:de,farmsPoolInfo:y}}});const no=e=>(ao("data-v-b105cc87"),e=e(),lo(),e),Ls={key:0,class:"farms-position-detail"},qs={class:"farms-top"},Ms=no(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),Us={class:"right"},js={class:"apr"},Es={class:"apr-tips-box"},Ds=no(()=>n("span",null,"View",-1)),Fs=no(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ws=[Ds,Fs],Hs={class:"farms-bottom"},Xs=no(()=>n("div",{class:"title"},"Farming Rewards",-1)),Ys={key:0,class:"reward-list"},zs={key:0,class:"rewards-item-bg"},Gs={class:"rewards-item-box"},Js={alt:""},Qs={key:1},Zs={class:"rewards-item-bg"},Ks={class:"rewards-item-box"},Vs={alt:""},xs=no(()=>n("span",null,"0",-1)),ea={key:1,class:"reward-list"},oa={key:0,class:"rewards-item-bg"},na={class:"rewards-item-box"},ta={alt:""},ia=no(()=>n("span",null,"0",-1)),sa={key:1},aa={class:"rewards-item-bg"},la={class:"rewards-item-box"},ra={alt:""},ua=no(()=>n("span",null,"0",-1)),da={class:"actions-box"};function ca(e,t,s,a,N,p){var c,d,y;const T=yn,w=vo,l=Lo,o=yo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(g(),P("div",Ls,[n("div",qs,[Ms,n("div",Us,[n("div",js,[me(" APRÂ  "),n("span",null,[me(z(("addCommom"in e?e.addCommom:K(V))(((c=e.farmsPoolInfo)==null?void 0:c.total_apr)*100,2))+"%Â  ",1),n("div",Es,[ae(T,{"l-item":e.farmsPoolInfo,"rewarder-info":(y=(d=e.farmsPoolInfo)==null?void 0:d.rewarder)==null?void 0:y.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=I=>e.$router.push("/farms"))},Ws)])]),n("div",Hs,[Xs,e.rewardList&&e.rewardList.length>0?(g(),P("div",Ys,[(g(!0),P(xe,null,io(e.rewardList,I=>(g(),P("div",{key:I,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(g(),P("div",zs,[n("div",Gs,[Pe(n("img",Js,null,512),[[o,e.getCoinIcon(I.rewarder_type)]]),n("span",null,z(("addCommom"in e?e.addCommom:K(V))(I.rewarderAmount||0)),1)])])):(g(),P("div",Qs,[n("div",Zs,[n("div",Ks,[Pe(n("img",Vs,null,512),[[o,e.getCoinIcon(I.reward_coin)]]),xs])])]))]))),128))])):(g(),P("div",ea,[(g(!0),P(xe,null,io(e.currentPositionInfo.rewards,I=>(g(),P("div",{key:I,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(g(),P("div",oa,[n("div",na,[Pe(n("img",ta,null,512),[[o,e.getCoinIcon(I.rewarder_type)]]),ia])])):(g(),P("div",sa,[n("div",aa,[n("div",la,[Pe(n("img",ra,null,512),[[o,e.getCoinIcon(I.reward_coin)]]),ua])])]))]))),128))])),n("div",da,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(g(),Ce(w,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Be(()=>[me("Unstake")]),_:1},8,["loading","onClick"])):re("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(g(),Ce(l,{key:1},{title:Be(()=>[me("Farming rewards are only available for active positions.")]),default:Be(()=>[ae(w,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Be(()=>[me("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(g(),Ce(w,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Be(()=>[me("Stake")]),_:1},8,["loading","onClick"])):re("",!0),ae(w,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:qo(e.claim,["stop"])},{default:Be(()=>[me("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):re("",!0)}const Ko=ze(Bs,[["render",ca],["__scopeId","data-v-b105cc87"]]),va=Ye({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=Do(),s=k(()=>t),a=k(()=>s.value.status),N=Xe(),p=L(!1);we(()=>a.value,o=>{o=="authenticated",p.value=!1},{immediate:!0});const T=L(!1),w=async()=>{T.value=!T.value;const o={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},c=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(o,c,T.value)}catch{T.value=!T.value}},l=o=>{const c=o.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",c),T.value=c.some(d=>JSON.parse(d.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(d.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return ro(),we(()=>[s.value.sourceGroups,e.positionInfo],([o,c])=>{T.value=!1,o&&o.length>0&&o[0]&&c&&!fe(c)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),l(o[0]))},{immediate:!0,deep:!0}),{importIcon:so,isShowSetUp:p,changeSwitch:w,checked:T,notifiStatus:a,store:N}}});const ma=e=>(ao("data-v-1a37a36d"),e=e(),lo(),e),fa={class:"range-alerts"},pa={class:"range-alerts-top"},ha={class:"title"},ga=ma(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ba={key:1,class:"h5-switch-box"},ka={class:"range-alerts-bottom"},_a={key:0,class:"pc-switch-box"};function wa(e,t,s,a,N,p){const T=vo,w=dn;return g(),P("div",fa,[n("div",pa,[n("div",ha,[ga,e.isShowSetUp||e.notifiStatus!=="authenticated"?(g(),Ce(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=qo(l=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Be(()=>[me(" Set up ")]),_:1})):re("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(g(),P("div",ba,[ae(w,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):re("",!0)])]),n("div",ka,[me(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(g(),P("div",_a,[ae(w,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):re("",!0)])])}const Vo=ze(va,[["render",wa],["__scopeId","data-v-1a37a36d"]]),ya=Ye({components:{NewPositionTitle:Yo,NewPositionInfo:Go,NewPositionLiquidity:Jo,NewPositionAssetAdd:Qo,NewPositionAssetRemove:Zo,NewPositionNotifi:Vo,FarmsPositionDetail:Ko},setup(){const e=L(),t=L(),s=L(),a=Xe(),N=k(()=>a),p=k(()=>N.value.chainName),T=eo(),w=k(()=>T),l=Fo(),o=k(()=>l),c=ro();Oo(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),w.value.setCurrentPositionLoading(!0)});const d=async()=>{w.value.setCurrentPositionLoading(!0);const i=c.currentRoute.value.query.token||"",A=c.currentRoute.value.query.collect||"",m=c.currentRoute.value.query.address||"",b=c.currentRoute.value.query.pos||"",r=c.currentRoute.value.query.id||"",H=c.currentRoute.value.query.positionSource||"",oe=c.currentRoute.value.query.position_nft_id||"";p.value==="Aptos"?i&&A&&m&&w.value.setCurrentPositionInfo(m,A,i,p.value):i&&m&&b?w.value.setCurrentPositionInfo(m,A,i,p.value,b):r&&!H?w.value.setCurrentPositionInfo("","","",p.value,r):w.value.setCurrentPositionInfo("","","",p.value,oe,H)};we(()=>w.value.poolConfigObj,i=>{i&&!fe(i)&&d()},{immediate:!0});const y=k(()=>w.value.currentPositionLoading),I=k(()=>{var A,m,b;const i=((b=(m=(A=c==null?void 0:c.currentRoute)==null?void 0:A.value)==null?void 0:m.query)==null?void 0:b.address)||"";return i&&w.value.addressLpTokens&&!fe(w.value.addressLpTokens)&&w.value.addressLpTokens[i]?w.value.addressLpTokens[i]:null});we(()=>I.value,(i,A)=>{i&&!fe(i)&&(e.value=i),i&&!fe(i)&&i.current_sqrt_price!==(A==null?void 0:A.current_sqrt_price)&&d()},{immediate:!0});const ue=po();we(()=>[w.value.currentPositionInfo,p.value],([i,A])=>{var m;(A=="Aptos"&&i||A=="Sui"&&i&&(i==null?void 0:i.nftHash)==((m=ue==null?void 0:ue.query)==null?void 0:m.pos))&&(e.value=i,t.value=e.value.token_a,s.value=e.value.token_b)},{immediate:!0});const J=k(()=>w.value.positionDetailCurrentTab),Q=mo(),_=k(()=>Q);k(()=>N.value.theme);const f=k(()=>p.value?oo(p.value):{}),F=()=>{d(),_.value.address&&f.value.getAccount(_.value.address)};return we(()=>e.value,i=>{var A,m,b,r;((i==null?void 0:i.positionSource)==="farming"||(A=i==null?void 0:i.poolInfo)!=null&&A.stable_farming)&&!((b=(m=o==null?void 0:o.value)==null?void 0:m.farmsPoolObj)!=null&&b[i==null?void 0:i.poolAddress])&&!((r=o==null?void 0:o.value)!=null&&r.farmsPoolListLoading)&&o.value.getFarmsPoolList(!1)},{deep:!0}),Ro(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:s,getDetails:d,currentPositionLoading:y,positionDetailCurrentTab:J,clickRefresh:F,chainName:p}}});const Aa={class:"new-position-detail"},Ia={class:"new-position-content"},Ca={class:"left"},$a={class:"right"},Sa={class:"loading-global"};function Pa(e,t,s,a,N,p){const T=Yo,w=Go,l=Jo,o=Qo,c=Zo,d=Ko,y=Vo,I=cn;return g(),P("div",Aa,[ae(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",Ia,[n("div",Ca,[ae(w),ae(l,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",$a,[e.positionDetailCurrentTab=="increase"?(g(),Ce(o,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(g(),Ce(c,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ae(l,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"&&e.positionInfo.positionSource!=="burn"?(g(),Ce(d,{key:2})):re("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(g(),Ce(y,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):re("",!0)])]),Pe(n("div",Sa,[ae(I)],512),[[Bo,e.currentPositionLoading]])])}const il=ze(ya,[["render",Pa],["__scopeId","data-v-7d3c5029"]]);export{il as default};
