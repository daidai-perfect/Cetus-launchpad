import{_ as Ze}from"./upgrade-select-input.2dc830a6.js";import{_ as Je}from"./upgrade-loading.fff9f274.js";import{_ as Ke}from"./upgrade-position-item.85bda02d.js";import{a as te,q as Ue,o as a,f as r,F as X,s as x,x as Y,h as s,t as I,v as b,u as D,e as oe,r as w,m as y,c as ee,w as J,i as F,j as se,P as Ye,B as ke,p as ce,k as ve,l as Ee,H as Pe,G as z,z as $e,O as Se,a2 as Qe,Z as Ie,Q as Xe,J as xe,Y as es,b as ss,y as ts,E as os,C as as,a1 as ns,M as ls}from"./entry.f1d335d0.js";import{b as Le,d as is,c as rs,u as me}from"./pool.73243d89.js";import{u as us}from"./notifi.711bb630.js";import{I as G,u as Be,g as Ce,c as ds,i as cs,d as ye}from"./index.b02d129f.js";import{i as ue}from"./import-icon.de3e6c66.js";import"./index.206efd4d.js";/* empty css              *//* empty css              *//* empty css              */import{_ as Fe}from"./icon-selected_3x.09e9a6f0.js";import{_ as vs}from"./token-warning.9bd2828a.js";import{D as N}from"./decimal.0bdeb344.js";import{_ as ms}from"./no-data.d780c7ef.js";import{_ as Ge}from"./icon_on_2x.5e96733d.js";import{_ as _s}from"./img-no-Positions_2x.c064470c.js";import{_ as ps}from"./img-no-Positions_2x.ab4b93a8.js";import{_ as fs}from"./img-connect-wallet_2x.13a52d2e.js";import{_ as hs}from"./img-connect-wallet_2x.7e2caedf.js";import"./coin-select.353cacc4.js";/* empty css              */import"./token-warning_2x.e4d6b51d.js";/* empty css              */import"./status-block.bc9eac3d.js";import"./farms-valid-range.f9c31b6d.js";import"./farms.0be9a35b.js";import"./icon_farms_2x.00f41c8c.js";import"./icon_rewards_2x.ed2dfeb6.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./farms.4842d7d1.js";import"./useWhale.9c5cce00.js";const gs=""+globalThis.__publicAssetsURL("sui-image/route-view.png"),ys={key:0,class:"claim-list"},ws={class:"left"},bs={alt:""},ks={class:"right"},$s=te({__name:"claim-list",props:{myClaimList:{type:Object,default:()=>[]}},setup(e){return(p,k)=>{const C=Ue("image");return e.myClaimList&&e.myClaimList.length>0?(a(),r("div",ys,[(a(!0),r(X,null,x(e.myClaimList,m=>(a(),r("div",{key:m,class:"claim-item"},[s("div",ws,[I(s("img",bs,null,512),[[C,m.logo_url]]),s("span",null,b(m.symbol),1)]),s("div",ks,[s("span",null,b(D(G)(m.amount,m.decimals,!0,!1,!1)),1),s("span",null,b(D(G)(m.amountUSD,2,!1,!1)),1)])]))),128))])):Y("",!0)}}});const qe=oe($s,[["__scopeId","data-v-c3e2798b"]]),le=w(!1),de=w(!1),Me=Le(),{setIsShowSuccess:Ss,setIsShowRejected:Te,setIsShowWaiting:we,setTransactionDesc:Cs,setTransactionTxid:De}=Me,Us=is("Sui"),be=rs("Sui"),Ls=Be(),je=y(()=>Ls),Ve=me(),Ns=y(()=>Ve),Rs=y(()=>Me),As=async e=>{de.value=!0;try{const p=[],k=[];e.forEach(c=>{const E=c.rewarderInfo.filter(f=>f.emissionsEveryDay>0).map(f=>f.coinAddress);c.positionSource=="clmm"?p.push({pool_id:c.pool,pos_id:c.pos_object_id,collect_fee:!0,rewarder_coin_types:E,coinTypeA:c.coin_type_a,coinTypeB:c.coin_type_b}):k.push({pool_id:c.pool_id,position_nft_id:c.id,clmm_pool_id:c.clmm_pool_id,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:E,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB})}),De(""),Cs("Claim Yield"),we(!0);const C=await Us.batchHarvestAndClmmFee(k,p),m=await be.signAndExecuteTransactionBlock(je.value.currentWallet,C.txb,C.payloadParams),L=be.handleTx(m);if(L&&L.hash){De(L.hash),we(!1),Ss(!0);const c={title:"Claim",desc:"Claim Yield",hash:L.hash};c.res=L.res,be.showTransitionPending(c),await be.watchTransaction(c)&&setTimeout(()=>{Ve.getMyPositons(je.value.address,Ns.value.poolsObj,Rs.value.chainName)},1e3)}else we(!1),Te(!0);de.value=!1,le.value=!1}catch(p){de.value=!1,we(!1),Te(!0),le.value=!1,console.log("batchHarvestAndClmmFee error:",p)}},Ne=e=>(ce("data-v-8e7a4ef5"),e=e(),ve(),e),Os={class:"claim-yield-content"},Ps={class:"total-claim"},Ts=Ne(()=>s("div",null,"Total Claim",-1)),Ds={class:"total-claim-usd"},js=Ne(()=>s("svg",{"aria-hidden":"true",class:"back-icon"},[s("use",{"xlink:href":"#icon-icon-back"})],-1)),Ys=Ne(()=>s("span",null,"Back",-1)),Es=[js,Ys],Bs=te({__name:"claim-yield",props:{pendingYield:{type:Number,default:0},myClaimList:{type:Object,default:()=>[]},myClaimPositionList:{type:Object,default:()=>[]}},setup(e){return(p,k)=>{const C=ke;return a(),ee(D(Ye),{title:"Claim Yield",visible:!0,footer:null,width:"440px",onCancel:k[2]||(k[2]=m=>p.$emit("close"))},{default:J(()=>[s("div",Os,[s("div",Ps,[Ts,s("div",Ds,b(e.pendingYield>0&&e.pendingYield<.01?"<$0.01":`$${D(Ce)(e.pendingYield,2)}`),1)]),F(qe,{"my-claim-list":e.myClaimList},null,8,["my-claim-list"]),s("div",{class:"choose-amount",onClick:k[0]||(k[0]=m=>p.$emit("chooseAmount"))},Es),F(C,{class:"confirm-btn",loading:D(de),onClick:k[1]||(k[1]=m=>D(As)(e.myClaimPositionList))},{default:J(()=>[se("Confirm")]),_:1},8,["loading"])])]),_:1})}}});const Fs=oe(Bs,[["__scopeId","data-v-8e7a4ef5"]]),Gs=te({props:{fromCoin:{type:Object,default:null},toCoin:{type:Object,default:null},feeTier:{type:Number,default:0}},setup(e){const p=Le(),k=y(()=>p),{t:C}=Ee(),m=me(),L=y(()=>m),c=y(()=>L.value.tokensObj&&e.fromCoin.address&&L.value.tokensObj[e.fromCoin.address]&&L.value.tokensObj[e.fromCoin.address].logoURI),E=y(()=>L.value.tokensObj&&e.toCoin.address&&L.value.tokensObj[e.toCoin.address]&&L.value.tokensObj[e.toCoin.address].logoURI);return{t:C,store:k,importIcon:ue,fromCoinUrl:c,toCoinUrl:E,getCoinIcon:U=>{var _;return(U==null?void 0:U.logoURI)||(U==null?void 0:U.logo_url)||((_=L.value.tokensObj[U==null?void 0:U.address])==null?void 0:_.logo_url)||(k.value.theme==="default"?ue("/image/coins/unknown.png"):ue("/image/coins/sui-unknown.png"))}}}});const qs={class:"coin-logo"},Ms={class:"img-box"},Vs={class:"token-a"},Ws={key:0},Hs={class:"token-b"},zs={key:0},Zs={key:0};function Js(e,p,k,C,m,L){var f,U;const c=vs,E=Ue("image");return a(),r("div",qs,[s("div",Ms,[s("div",Vs,[e.fromCoin?I((a(),r("img",Ws,null,512)),[[E,e.fromCoinUrl?e.fromCoinUrl:e.getCoinIcon(e.fromCoin)]]):Y("",!0),F(c,{address:e.fromCoin&&e.fromCoin.address,"style-params":{width:"8px",height:"8px",left:"15px",bottom:"0px"}},null,8,["address"])]),s("div",Hs,[e.toCoin?I((a(),r("img",zs,null,512)),[[E,e.toCoinUrl?e.toCoinUrl:e.getCoinIcon(e.toCoin)]]):Y("",!0),F(c,{address:e.toCoin&&e.toCoin.address,"style-params":{width:"8px",height:"8px",left:"15px",bottom:"0px"}},null,8,["address"])])]),I(s("span",{class:"coin-name"},b(e.$t("common.selectPool")),513),[[Pe,!e.fromCoin||!e.toCoin]]),I(s("span",{class:"coin-name"},b((f=e.fromCoin)==null?void 0:f.symbol)+" - "+b((U=e.toCoin)==null?void 0:U.symbol),513),[[Pe,e.fromCoin&&e.toCoin]]),e.feeTier?(a(),r("p",Zs,b(e.feeTier)+"%",1)):Y("",!0)])}const Ks=oe(Gs,[["render",Js],["__scopeId","data-v-747c398d"]]),We=e=>(ce("data-v-4237fa3c"),e=e(),ve(),e),Qs={class:"fees-and-reward"},Is={key:0,class:"fees"},Xs={class:"fees-title"},xs=We(()=>s("div",null,"Fees",-1)),et={alt:""},st={class:"symbol"},tt={class:"amount"},ot={class:"amount-usd"},at={key:1,class:"fees"},nt={class:"fees-title"},lt=We(()=>s("div",null,"Mining rewards",-1)),it={alt:""},rt={class:"symbol"},ut={class:"amount"},dt={class:"amount-usd"},ct=te({__name:"fees-and-reward",props:{pendingRewarderList:{type:Object,default:()=>[]},pendingFeesList:{type:Object,default:()=>[]},rewarderUsd:{type:String,default:""},feeOwedUsd:{type:String,default:""}},setup(e){return(p,k)=>{const C=Ue("image");return a(),r("div",Qs,[e.feeOwedUsd&&e.feeOwedUsd>0?(a(),r("div",Is,[s("div",Xs,[xs,s("div",null,b(D(G)(e.feeOwedUsd,2,!1,!1)),1)]),(a(!0),r(X,null,x(e.pendingFeesList,m=>(a(),r("div",{key:m,class:"fees-details"},[s("div",null,[I(s("img",et,null,512),[[C,m.logo_url]]),s("span",st,b(m.symbol),1)]),s("div",null,[s("span",tt,b(D(G)(m.amount,m.decimals,!0,!1,!1)),1),s("span",ot,"("+b(D(G)(m.amountUSD,2,!1,!1))+")",1)])]))),128))])):Y("",!0),e.rewarderUsd&&e.rewarderUsd>0?(a(),r("div",at,[s("div",nt,[lt,s("div",null,b(D(G)(e.rewarderUsd,2,!1,!1)),1)]),(a(!0),r(X,null,x(e.pendingRewarderList,m=>(a(),r("div",{key:m,class:"fees-details"},[s("div",null,[I(s("img",it,null,512),[[C,m.logo_url]]),s("span",rt,b(m.symbol),1)]),s("div",null,[s("span",ut,b(D(G)(m.amount,m.decimals,!0,!1,!1)),1),s("span",dt,"("+b(D(G)(m.amountUSD,2,!1,!1))+")",1)])]))),128))])):Y("",!0)])}}});const vt=oe(ct,[["__scopeId","data-v-4237fa3c"]]),_e=e=>(ce("data-v-5c834a7c"),e=e(),ve(),e),mt={class:"yield-details-box"},_t={class:"yield-details"},pt={class:"total-claim"},ft=_e(()=>s("div",null,"Pending Yield",-1)),ht={class:"total-claim-usd"},gt={class:"position-detail"},yt={class:"position-detail-top"},wt=_e(()=>s("div",{class:"left"},"Position",-1)),bt={class:"right"},kt=_e(()=>s("span",null,"Hide yield < ",-1)),$t={class:"position-detail-bottom"},St={class:"left"},Ct={class:"top"},Ut=["onClick"],Lt={key:0,src:Fe},Nt={class:"bottom"},Rt={class:"right"},At={key:0,class:"yield-amount"},Ot={key:1,class:"yield-amount-zero"},Pt={class:"select"},Tt={class:"all"},Dt=_e(()=>s("span",null,"Select all",-1)),jt={class:"amount-selected"},Yt=_e(()=>s("div",null,"Amount selected",-1)),Et=te({__name:"yield-details",props:{positionShowList:{type:Object,default:()=>[]},isShowYiedlDetails:{type:Boolean,default:!1}},emits:["showClaimYiedl"],setup(e,{emit:p}){const k=w(!0),C=w(!0),m=p,L=e,c=w(.01),E=w(),f=w([]),U=me(),_=y(()=>U),$=y(()=>_.value.rewarderObj),P=y(()=>_.value.feeOwedObj),R=w([]),T=w("all"),V=w([]),W=u=>{const i=[];R.value=[];let n=new N(0);const l=[];u.forEach(g=>{var M,o,t,v,A,B;const S=((M=$.value[g.tokenName])==null?void 0:M.pendingRewarder)||0,d=((o=P.value[g.tokenName])==null?void 0:o.feeOwed)||0,j=new N(isNaN(S)?0:S).add(new N(isNaN(d)?0:d)).toString();n=n.add(new N(isNaN(S)?0:S)).add(new N(isNaN(d)?0:d)),Number(j)>0&&l.push(g),k.value&&Number(j)>Number(c.value)&&i.push({...g,totalRewardUsd:j,pendingRewarderList:(t=$.value[g.tokenName])==null?void 0:t.pendingRewarderArr,pendingFeesList:(v=P.value[g.tokenName])==null?void 0:v.feesResult,rewarderUsd:S,feeOwedUsd:d}),k.value||i.push({...g,totalRewardUsd:j,pendingRewarderList:(A=$.value[g.tokenName])==null?void 0:A.pendingRewarderArr,pendingFeesList:(B=P.value[g.tokenName])==null?void 0:B.feesResult,rewarderUsd:S,feeOwedUsd:d})}),V.value=l,i.forEach(g=>{g.totalRewardUsd>0&&R.value.push(g.tokenName)}),k.value?R.value.length!==i.length?T.value="":T.value="all":R.value.length!==l.length?T.value="":T.value="all",C.value=!1,E.value=n,f.value=i.sort((g,S)=>S.totalRewardUsd-g.totalRewardUsd)},ie=y(()=>_.value.getPendingFeeSuccess),K=y(()=>_.value.getRewardSuccess);z(()=>[L.positionShowList,c.value,ie.value,K.value,k.value],([u,i,n,l])=>{u&&u.length>0&&n&&l&&W(u)},{immediate:!0});const ae=u=>{const i=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,4})?).*$");u.target.value=u.target.value.replace(i,"$1"),c.value=u.target.value},re=()=>{(!c.value||c.value<.01)&&(c.value=.01)},Z=u=>{const i=u.tokenName,n=R.value.indexOf(i);n>-1?R.value.splice(n,1):R.value.push(i),k.value?R.value.length!==f.value.length?T.value="":T.value="all":R.value.length!==V.value.length?T.value="":T.value="all"},Q=()=>{T.value="all",f.value.forEach(u=>{!R.value.includes(u.tokenName)&&u.totalRewardUsd>0&&R.value.push(u.tokenName)})},O=y(()=>{let u=new N(0);return T.value=="all"?f.value.forEach(i=>{var g,S;const n=((g=$.value[i.tokenName])==null?void 0:g.pendingRewarder)||0,l=((S=P.value[i.tokenName])==null?void 0:S.feeOwed)||0;u=u.add(new N(isNaN(n)?0:n)).add(new N(isNaN(l)?0:l))}):R.value.forEach(i=>{var g,S;const n=((g=$.value[i])==null?void 0:g.pendingRewarder)||0,l=((S=P.value[i])==null?void 0:S.feeOwed)||0;u=u.add(new N(isNaN(n)?0:n)).add(new N(isNaN(l)?0:l))}),u.toString()}),h=()=>{const u=[];f.value.forEach(i=>{R.value.includes(i.tokenName)&&u.push(i)}),m("showClaimYiedl",u)};return(u,i)=>{const n=Qe,l=Ie,g=Xe,S=ke;return a(),ee(D(Ye),{title:"Details",footer:null,visible:e.isShowYiedlDetails,width:"440px","wrap-class-name":"details-modal",onCancel:i[2]||(i[2]=d=>u.$emit("close"))},{default:J(()=>[s("div",mt,[s("div",_t,[s("div",pt,[ft,s("div",ht,[s("span",null,b(D(G)(E.value,2,!1,!1)),1)])]),s("div",gt,[s("div",yt,[wt,s("div",bt,[F(n,{class:"range-alerts-switch",checked:k.value,onClick:i[0]||(i[0]=()=>{k.value=!k.value,C.value=!1})},null,8,["checked"]),kt,F(l,{value:`$${c.value}`,onChange:ae,onBlur:re},null,8,["value"])])]),s("div",$t,[f.value&&f.value.length>0?(a(!0),r(X,{key:0},x(f.value,d=>(a(),r("div",{key:d,class:"position-item"},[s("div",St,[s("div",Ct,[s("div",{class:$e(["radio",d.totalRewardUsd<=0?"radio-disable":""]),onClick:j=>d.totalRewardUsd>0?Z(d):""},[(T.value=="all"||R.value.includes(d.tokenName))&&d.totalRewardUsd>0?(a(),r("img",Lt)):Y("",!0)],10,Ut),F(Ks,{"from-coin":d.needReverse?d.token_b:d.token_a,"to-coin":d.needReverse?d.token_a:d.token_b,"fee-tier":d.fee*1e3},null,8,["from-coin","to-coin","fee-tier"])]),s("div",Nt,b(d.tokenName),1)]),s("div",Rt,[d.totalRewardUsd>0?(a(),r("div",At,[F(g,{placement:"bottomRight","overlay-class-name":"yield-amount-tooltip"},{title:J(()=>[F(vt,{"pending-fees-list":d.pendingFeesList,"pending-rewarder-list":d.pendingRewarderList,"rewarder-usd":d.rewarderUsd,"fee-owed-usd":d.feeOwedUsd},null,8,["pending-fees-list","pending-rewarder-list","rewarder-usd","fee-owed-usd"])]),default:J(()=>[se(b(D(G)(d.totalRewardUsd,2,!1,!1))+" ",1)]),_:2},1024)])):(a(),r("div",Ot,b(D(G)(d.totalRewardUsd,2,!1,!1)),1))])]))),128)):(a(),ee(ms,{key:1,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found"}))])])]),s("div",Pt,[s("div",Tt,[s("div",{class:"radio",onClick:Q},[T.value=="all"?(a(),r("img",{key:0,src:Fe,onClick:i[1]||(i[1]=Se(()=>{R.value=[],T.value=""},["stop"]))})):Y("",!0)]),Dt]),s("div",jt,[Yt,s("div",null,b(D(G)(O.value,2,!1,!1)),1)])]),F(S,{class:"claim-yield-btn",disabled:O.value=="0",onClick:h},{default:J(()=>[se("Claim Yield")]),_:1},8,["disabled"])])]),_:1},8,["visible"])}}});const Bt=oe(Et,[["__scopeId","data-v-5c834a7c"]]),He=e=>(ce("data-v-826d7f95"),e=e(),ve(),e),Ft={class:"total-info"},Gt={class:"total-liquidity"},qt=He(()=>s("span",null,"Total Liquidity",-1)),Mt={key:0,class:"skeleton-box"},Vt={key:1,class:"total-liquidity-usd"},Wt={class:"pending-yield"},Ht=He(()=>s("div",null,"Pending Yield",-1)),zt={key:0,class:"skeleton-box"},Zt={key:1},Jt={key:0,class:"claim-list-box"},Kt={class:"claim-list-content"},Qt=te({__name:"total-position",setup(e){const p=w(!1),k=me(),C=y(()=>k),m=y(()=>C.value.rewarderObj),L=y(()=>C.value.feeOwedObj),c=y(()=>C.value.positionShowList),E=y(()=>C.value.myPositionsLoading),f=y(()=>C.value.getPendingFeeSuccess),U=y(()=>C.value.getRewardSuccess),_=w(0),$=w(0),P=w(!0),R=w([]),T=w([]),V=w([]),W=O=>{let h=new N(0);const u=[];O.forEach(i=>{h=h.add(new N(isNaN(i.amountUSD)?0:i.amountUSD)),u.push(i.tokenName)}),R.value=u,_.value=h.toNumber()},ie=(O,h)=>{let u=new N(0);const i=[];R.value.forEach(l=>{var d,j,M,o;const g=((d=O[l])==null?void 0:d.pendingRewarder)||0,S=((j=h[l])==null?void 0:j.feeOwed)||0;u=u.add(new N(isNaN(g)?0:g)).add(new N(isNaN(S)?0:S)),(M=O[l])!=null&&M.pendingRewarderArr&&i.push(...O[l].pendingRewarderArr),(o=h[l])!=null&&o.feesResult&&i.push(...h[l].feesResult)});const n={};i.forEach(l=>{n[l.address]?n[l.address]={...l,amountUSD:new N(n[l.address].amountUSD).add(isNaN(l.amountUSD)?0:l.amountUSD).toString(),amount:new N(n[l.address].amount).add(isNaN(l.amountUSD)?0:l.amountUSD).toString()}:(n[l.address]={},n[l.address]={...l,amountUSD:new N(0).add(isNaN(l.amountUSD)?0:l.amountUSD).toString(),amount:new N(0).add(l.amount).toString()})}),V.value=Object.values(n).filter(l=>l.amount>0).sort((l,g)=>g.amountUSD-l.amountUSD),$.value=u.toNumber(),P.value=!1};z(()=>c.value,O=>{O&&O.length>0?W(O):W([])},{immediate:!0}),z(()=>[f.value,U.value,R.value,m.value,L.value],([O,h,u,i,n])=>{O&&h?ie(i,n):P.value=!0},{immediate:!0,deep:!0});const K=w(),ae=w(),re=O=>{p.value=!1,le.value=!0;let h=new N(0);const u=[],i={};O.forEach(n=>{var d,j,M,o;const l=n.tokenName,g=((d=m.value[l])==null?void 0:d.pendingRewarder)||0,S=((j=L.value[l])==null?void 0:j.feeOwed)||0;h=h.add(new N(g)).add(new N(S)),(M=m.value[l])!=null&&M.pendingRewarderArr&&u.push(...m.value[l].pendingRewarderArr),(o=L.value[l])!=null&&o.feesResult&&u.push(...L.value[l].feesResult)}),u.forEach(n=>{i[n.address]?i[n.address]={...n,amountUSD:new N(i[n.address].amountUSD).add(isNaN(n.amountUSD)?0:n.amountUSD).toString(),amount:new N(i[n.address].amount).add(isNaN(n.amountUSD)?0:n.amountUSD).toString()}:(i[n.address]={},i[n.address]={...n,amountUSD:new N(0).add(isNaN(n.amountUSD)?0:n.amountUSD).toString(),amount:new N(0).add(n.amount).toString()})}),K.value=h.toNumber(),T.value=Object.values(i).filter(n=>n.amount>0).sort((n,l)=>l.amountUSD-n.amountUSD),ae.value=O},Z=w(1),Q=()=>{$.value>0&&(p.value=!0,Z.value=Z.value==1?2:1)};return(O,h)=>{const u=es,i=ke;return a(),r("div",Ft,[s("div",Gt,[qt,!_.value&&E.value?(a(),r("div",Mt,[F(u,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(a(),r("span",Vt,b(_.value>0&&_.value<.01?"<$0.01":`$${D(Ce)(_.value,2)}`),1))]),s("div",Wt,[Ht,P.value?(a(),r("div",zt,[F(u,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(a(),r("div",Zt,[s("span",{class:"pending-yield-usd",style:xe($.value<=0?{border:"none"}:{}),onClick:Q},[se(b($.value>0&&$.value<.01?"<$0.01":`$${D(Ce)($.value,2)}`)+" ",1),$.value>0?(a(),r("div",Jt,[s("div",Kt,[F(qe,{"my-claim-list":V.value},null,8,["my-claim-list"])])])):Y("",!0)],4),$.value>0?(a(),r("img",{key:0,src:gs,alt:"",onClick:Q})):Y("",!0),F(i,{class:"claim-all-btn",disabled:$.value<=0,loading:D(de),onClick:Q},{default:J(()=>[se("Claim All")]),_:1},8,["disabled","loading"])]))]),D(le)?(a(),ee(Fs,{key:0,"pending-yield":K.value,"my-claim-list":T.value,"my-claim-position-list":ae.value,onClose:h[0]||(h[0]=n=>le.value=!1),onChooseAmount:h[1]||(h[1]=()=>{le.value=!1,p.value=!0})},null,8,["pending-yield","my-claim-list","my-claim-position-list"])):Y("",!0),(a(),ee(Bt,{key:Z.value,"position-show-list":c.value,"is-show-yiedl-details":p.value,onClose:h[2]||(h[2]=()=>{p.value=!1}),onShowClaimYiedl:re},null,8,["position-show-list","is-show-yiedl-details"]))])}}});const It=oe(Qt,[["__scopeId","data-v-826d7f95"]]),Xt=te({components:{TotalPosition:It},setup(){const e=w(!1),{t:p}=Ee(),k=w(["position"]),C=ss(),m=w(""),L=Le(),c=y(()=>L),E=y(()=>c.value.chainName?ds[c.value.chainName]:{});let f=w([]);const U=me(),_=y(()=>U),$=Be(),P=y(()=>$),R=w(!1),T=w(p("tab.all")),V=w([p("tab.layerZero"),p("tab.wormhole"),p("tab.celer")]),W=w(!0),ie=w("TVL"),K=()=>{console.log("🚀 ~ file: position.vue:171 ~ clickRefresh ~ times:"),e.value=!0,f.value=[],P.value.address&&U.setPools(u.value.poolConfigList,c.value.chainName),setTimeout(()=>{e.value=!1},1e3)},ae=y(()=>{const o=Array.from(new Set(_.value.poolConfigList.flatMap(t=>!(t!=null&&t.category)||(t==null?void 0:t.category)==""?"All":t==null?void 0:t.category)));return console.log(o,"newArr"),o.length<=1?[]:o}),re=o=>{_.value.setCurrentPoolTab(o)};z(()=>c.value.isRefresh,o=>{var t,v,A,B;console.log("🚀 ~ file: position.vue:182 ~ setup ~ newValue:",o),o&&((B=(A=(v=(t=C==null?void 0:C.currentRoute)==null?void 0:t.value)==null?void 0:v.name)==null?void 0:A.split("-"))==null?void 0:B[1])=="position"&&K()}),ts(()=>{f.value=[],document.addEventListener("click",()=>{R.value=!1}),U.setMyPositionsLoading(!0)}),os(()=>{document.addEventListener("click",()=>{R.value=!1})}),as(()=>{P.value.connected||(f.value=[])});const Z=()=>{e.value=!0;let o=[];_.value.myPositions.forEach(t=>{var ne,pe,fe,he,ge,Re,Ae,Oe;c.value.addressLpTokens[t.address];let v=t.positionSource=="farming",A,B;const q=ye(t.amountA).mul(((pe=(ne=_.value.RATES)==null?void 0:ne[t.token_a.address])==null?void 0:pe.price)||"0").toString(),H=ye(t.amountB).mul(((he=(fe=_.value.RATES)==null?void 0:fe[t.token_b.address])==null?void 0:he.price)||"0").toString();(Re=(ge=_.value.RATES)==null?void 0:ge[t.token_a.address])!=null&&Re.price&&((Oe=(Ae=_.value.RATES)==null?void 0:Ae[t.token_b.address])!=null&&Oe.price)?(A=ye(q).plus(H).toString(),B=ye(q).plus(H).toString()):(A=" --",B=0),console.log(_.value.currentPoolTab,"##pools.value.currentPoolTab"),(_.value.currentPoolTab=="All"||_.value.currentPoolTab!=="All"&&t.category==_.value.currentPoolTab)&&o.push({...t,amountUSD:A,amountUSDOrigin:B,tokenARates:q,tokenBRates:H,isStableFarming:v})}),T.value!="All"?W.value?(f.value=o.sort((t,v)=>Number(v.amountUSDOrigin)-Number(t.amountUSDOrigin)),e.value=!1):(f.value=o.sort((t,v)=>Number(t.amountUSDOrigin)-Number(v.amountUSDOrigin)),e.value=!1):W.value?(f.value=o.sort((t,v)=>v.amountUSDOrigin-t.amountUSDOrigin),e.value=!1):(f.value=o.sort((t,v)=>t.amountUSDOrigin-v.amountUSDOrigin),e.value=!1),console.log(f.value,"list.value========>")};z(()=>[_.value.myPositions,_.value.RATES],([o,t])=>{o&&t&&(console.log("0605==>updateLpList9099999"),Z())},{immediate:!0}),z(()=>[P.value.address,_.value.poolConfigList,_.value.poolsObj,c.value.chainName],([o,t,v,A])=>{var B,q,H;o&&t&&t.length>0&&A&&(A!=null&&A.toLowerCase().includes((B=t[0])==null?void 0:B.chain))&&!cs(v)&&(A==="Aptos"?t.length===Object.values(v).length:(H=(q=Object.values(v)[0])==null?void 0:q.chain)!=null&&H.includes("sui"))&&(console.log(v,t,"0605==>getMyPositons9099999"),U.getMyPositons(P.value.address,v,A))},{immediate:!0,deep:!0}),z(()=>P.value.address,o=>{o||U.setMyPositions()},{immediate:!0}),z(()=>[T.value,W.value,_.value.currentPoolTab],([o])=>{Z()});const Q=o=>{const t=[];V.value.forEach((v,A)=>{v==o?t[A]=T.value:t[A]=v}),V.value=t,T.value=o},O=us(),h=y(()=>O),u=y(()=>U),i=async o=>{await O.getSourceGroups();const t=h.value.sourceGroups&&h.value.sourceGroups.length>0&&h.value.sourceGroups[0]&&h.value.sourceGroups[0].sources||[];console.log(t,"####source"),console.log(o,"###myPositions");for(let v=0;v<t.length;v++){const{pool_address:A,position_index:B}=JSON.parse(t[v].blockchainAddress);let q=!1,H;for(let ne=0;ne<o.length;ne++){const{poolAddress:pe,index:fe,positionSource:he,name:ge}=o[ne];A==pe&&Number(he=="clmm"?fe:ge.split("-")[1])==Number(B)&&(q=!0),H={pool_address:A,position_index:B}}q||await O.subscribePosition(H,"",!1,!1)}},n=async()=>{await O.getSourceGroups();const o=h.value.sourceGroups&&h.value.sourceGroups.length>0&&h.value.sourceGroups[0]&&h.value.sourceGroups[0].sources||[];for(let t=0;t<o.length;t++){const{pool_address:v,position_index:A}=JSON.parse(o[t].blockchainAddress),{name:B}=o[t],q={pool_address:v,position_index:A};await O.subscribePosition(q,B,!1,!1)}},l=y(()=>u.value.myPositionsLoading);z(()=>u.value.myPositions,(o,t)=>{E.value.hasNotifi&&(o&&o.length>0&&t&&t.length!==o.length?i(o):o&&o.length==0&&!l.value&&n())},{immediate:!0});const g=o=>{var t;return(o==null?void 0:o.logoURI)||(o==null?void 0:o.logo_url)||((t=_.value.tokensObj[o==null?void 0:o.address])==null?void 0:t.logo_url)||(c.value.theme==="default"?ue("/image/coins/unknown.png"):ue("/image/coins/sui-unknown.png"))},S=w(null),d=y(()=>S.value&&S.value.firstToken?S.value.firstToken:null),j=y(()=>S.value&&S.value.lastToken?S.value.lastToken:null),M=y(()=>{let o=[];o=f.value;const t=o.filter((v,A)=>d.value&&j.value?v.coinA.symbol==d.value.symbol&&v.coinB.symbol==j.value.symbol||v.coinA.symbol==j.value.symbol&&v.coinB.symbol==d.value.symbol:d.value?v.coinA.symbol.toLowerCase().includes(d.value.symbol.toLowerCase())||v.coinB.symbol.toLowerCase().includes(d.value.symbol.toLowerCase()):j.value?v.coinA.symbol.toLowerCase().includes(j.value.symbol.toLowerCase())||v.coinB.symbol.toLowerCase().includes(j.value.symbol.toLowerCase()):o);return _.value.myPositionsLoading||(L.setPositiomAmount(t.length),U.setPositionShowList(t)),t});return ns(()=>{L.setPositiomAmount("--"),U.setPositionShowList([])}),{tabArr:ae,changeTab:re,showList:M,childTokenSelectRef:S,firstToken:d,lastToken:j,getCoinIcon:g,changeSortLabel:Q,label:R,labelList:V,labelValue:T,select:W,selectValue:ie,t:p,pools:_,store:c,wallet:P,list:f,clickRefresh:K,refresh:e,current:k,router:C,searchKey:m}}});const ze=e=>(ce("data-v-44a4646b"),e=e(),ve(),e),xt={class:"upgrade-position-list-container"},eo={class:"position-card-top"},so={class:"content-top"},to={class:"content-top-left"},oo={key:0,class:"tag-list"},ao=["onClick"],no={class:"content-top-right"},lo={class:"value"},io=ze(()=>s("use",{"xlink:href":"#icon-icon_on"},null,-1)),ro=[io],uo={key:0,class:"select-item"},co=["onClick"],vo={class:"search-select-box"},mo=ze(()=>s("span",null,"TVL",-1)),_o={key:0,src:Ge,alt:""},po={key:1,class:"fan-img",src:Ge,alt:""},fo={key:0,class:"upgrade-loading"},ho={key:1,class:"position-list"},go={key:2,class:"no-data"},yo={key:0,src:_s,alt:""},wo={key:1,src:ps,alt:""},bo={key:3,class:"no-data"},ko={key:0,src:fs,alt:""},$o={key:1,src:hs,alt:""};function So(e,p,k,C,m,L){const c=ls("TotalPosition"),E=Ze,f=Je,U=Ke,_=ke;return a(),r("div",xt,[s("div",eo,[e.wallet&&e.wallet.address?(a(),ee(c,{key:0})):Y("",!0),s("div",so,[s("div",to,[e.tabArr.length>1?(a(),r("div",oo,[(a(!0),r(X,null,x(e.tabArr,($,P)=>(a(),r("div",{key:P,class:$e(["tag-item",$==e.pools.currentPoolTab?`tag-active tab-num-${e.tabArr.length}`:`tab-num-${e.tabArr.length}`]),onClick:R=>e.changeTab($)},b($),11,ao))),128))])):Y("",!0),F(E,{ref:"childTokenSelectRef"},null,512)]),s("div",no,[e.store.theme=="default"?(a(),r("div",{key:0,class:"search-label",onClick:p[0]||(p[0]=Se($=>e.label=!e.label,["stop"]))},[s("span",null,b(e.$t("newAdd.label")),1),s("div",lo,b(e.labelValue),1),(a(),r("svg",{"aria-hidden":"true",class:$e(e.label?"show-icon icon":"icon")},ro,2)),e.label?(a(),r("div",uo,[(a(!0),r(X,null,x(e.labelList,($,P)=>(a(),r("div",{key:P,class:"select-menu-item",onClick:R=>e.changeSortLabel($)},b($),9,co))),128))])):Y("",!0)])):Y("",!0),s("div",vo,[s("div",{class:"search-select",onClick:p[1]||(p[1]=Se($=>e.select=!e.select,["stop"]))},[se(b(e.$t("newAdd.sortBy"))+" ",1),s("div",null,[mo,e.select?(a(),r("img",_o)):(a(),r("img",po))])])])])])]),e.pools.myPositionsLoading&&e.wallet.connected?(a(),r("div",fo,[F(f,{loading:e.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):Y("",!0),e.showList&&e.showList.length>0&&e.wallet.connected&&!e.pools.myPositionsLoading?(a(),r("div",ho,[(a(!0),r(X,null,x(e.showList,($,P)=>(a(),ee(U,{key:P,"p-item":$},null,8,["p-item"]))),128))])):Y("",!0),e.showList&&e.showList.length<=0&&!e.pools.myPositionsLoading&&e.wallet.connected?(a(),r("div",go,[e.store.theme=="default"?(a(),r("img",yo)):(a(),r("img",wo)),s("span",null,b(e.$t("common.noLiquidityPositions")),1)])):Y("",!0),e.wallet.connected?Y("",!0):(a(),r("div",bo,[e.store.theme=="default"?(a(),r("img",ko)):(a(),r("img",$o)),F(_,{class:"connect-wallet",onClick:p[2]||(p[2]=$=>e.wallet.setIsShowWalletModal(!0))},{default:J(()=>[se(b(e.$t("button.connectWallet")),1)]),_:1})]))])}const na=oe(Xt,[["render",So],["__scopeId","data-v-44a4646b"]]);export{na as default};
