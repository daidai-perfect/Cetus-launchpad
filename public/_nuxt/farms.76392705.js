import{m as yo,e as wo,s as W,a as j,o as Ho,u as vo,d as co,q as Ao,c as oo,k as Ro}from"./pool.536b5e88.js";import{a as X,l as r,r as B,e as Y,o as n,f as t,h as s,i as w,v as m,u as g,c as T,w as N,S as Jo,B as bo,j as U,p as to,k as ao,q as go,z as fo,s as Io,t as lo,x as E,b as Po,A as ho,F as z,E as no,P as ms,N as zo,M as Fo,H as Qo,Q as ps}from"./entry.d648dbe8.js";/* empty css              */import{a as ro,u as ko}from"./sha256.00f5695d.js";import{u as uo}from"./farms.7178b263.js";import{_ as Go}from"./apr-tips.f9355242.js";import{i as Lo}from"./import-icon.de3e6c66.js";/* empty css              *//* empty css              */import{_ as Ko}from"./img-connect-wallet_2x.aa76fd18.js";import{_ as Xo}from"./img-no-Positions_2x.4fa1fb07.js";import{_ as _s}from"./upgrade-loading.dad17989.js";import{p as fs}from"./precision.a7a6c57b.js";import"./decimal.0bdeb344.js";import"./icon_rewards_2x.4f275a32.js";/* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";const hs=X({setup(){const o=ro(),l=r(()=>o),p=uo(),u=r(()=>p),_=r(()=>(console.log(u.value.farmsRewardObj,"##farmsRewardObj"),Object.values(u.value.farmsRewardObj))),a=r(()=>{const Q=_.value.reduce(function(Z,A){const O=A&&A.amountUsd?A.amountUsd:0;return Number(O)>.01?Ho(Number(Z)).plus(W(Number(O),2)).toString():Ho(Number(Z)).plus(Number(O)).toString()},0);return console.log(u.value.farmsRewardObj,_.value,Q,"resultresult67"),Q}),i=r(()=>u.value.farmsPositionList),d=r(()=>u.value.farmsAllPositionLoading),v=r(()=>u.value.farmsPoolListLoading),$=ko(),f=yo("Sui"),h=wo("Sui"),{setIsShowSuccess:I,setIsShowRejected:C,setIsShowWaiting:e,setTransactionDesc:M,setTransactionTxid:S}=$,L=B(!1);return{farmsPoolListLoading:v,wallet:l,farms:u,totalRwadrdUsd:a,sFixD:W,claimAllPoolReward:async Q=>{L.value=!0,console.log(i.value,"farmsRewardObj###");const Z=[];i.value.forEach(A=>{console.log(Q,A,"#position"),A.positionSource=="farming"&&Z.push({pool_id:A.pool_id,position_nft_id:A.id})}),console.log(JSON.stringify(Z),"##params"),S(""),M("Claim Rewards"),e(!0);try{const A=await f.batchHarvest(Z),O=await l.value.currentWallet.signAndExecuteTransactionBlock(A);console.log("0221###sui swap res###",O);let R=h.handleTx(O);if(R&&R.hash){S(R.hash),e(!1),I(!0);let q={res:R.res,title:"Claim",hash:R.hash};h.showTransitionPending(q),await h.watchTransaction(q)&&setTimeout(()=>{p.getFarmsPoolList()},4e3)}else e(!1),C(!0);L.value=!1}catch(A){console.log("Claim all error",A),e(!1),C(!0),L.value=!1}},loading:L,addCommom:j,farmsAllPositionLoading:d}}});const Yo=o=>(to("data-v-d521a357"),o=o(),ao(),o),vs={class:"farms-banner-bg"},gs={class:"farms-banner"},bs={class:"farms-banner-center"},$s=Yo(()=>s("div",{class:"title"},"Farms",-1)),ys=Yo(()=>s("div",{class:"desc"},"Stake your positions to earn higher yield.",-1)),ws={class:"claim-rewards"},Is={class:"claim-title"},ks={key:0,class:"loading-spin"},Ss={key:1},Ps={key:2},Ls={class:"claim-content"};function Cs(o,l,p,u,_,a){const i=Jo,d=bo;return n(),t("div",vs,[s("div",gs,[s("div",bs,[$s,ys,s("div",ws,[s("div",Is,[o.farmsAllPositionLoading||o.farmsPoolListLoading?(n(),t("span",ks,[w(i)])):o.wallet.address?(n(),t("span",Ss,m(Number(o.totalRwadrdUsd)>0&&Number(o.totalRwadrdUsd)<.01?"<$0.01":`$${("addCommom"in o?o.addCommom:g(j))(("sFixD"in o?o.sFixD:g(W))(o.totalRwadrdUsd||0,2))}`),1)):(n(),t("span",Ps,"--"))]),s("div",Ls,[o.wallet.address?(n(),T(d,{key:0,class:"claim-btn",loading:o.loading,disabled:Number(o.totalRwadrdUsd)==0||o.farmsAllPositionLoading,onClick:o.claimAllPoolReward},{default:N(()=>[U(" Claim All Rewards ")]),_:1},8,["loading","disabled","onClick"])):(n(),T(d,{key:1,class:"claim-btn",onClick:l[0]||(l[0]=v=>o.wallet.setIsShowWalletModal(!0))},{default:N(()=>[U("Connect")]),_:1}))])])])])])}const Zo=Y(hs,[["render",Cs],["__scopeId","data-v-d521a357"]]),js=X({props:{poolInfo:{type:Object,default:()=>({})},usePropsDirect:{type:Boolean,require:!1,default:!1},propDirect:{type:Boolean,require:!1,default:!1}},setup(o,l){const p=B(!0),u=B(o.usePropsDirect),_=B(o.propDirect);return go(()=>o.propDirect,i=>{_.value=i},{immediate:!0}),{sFixD:W,direct:p,isUsepropsDirect:u,propsDirect:_,clickChange:()=>{p.value=!p.value,u.value&&l.emit("clickChange")}}}}),xo=""+globalThis.__publicAssetsURL("sui-image/range.png");const Co=o=>(to("data-v-1fbaf879"),o=o(),ao(),o),Os={class:"range"},Us={key:0},Ts={class:"num"},Rs=Co(()=>s("img",{src:xo,alt:""},null,-1)),As={class:"num"},Fs={class:"per"},Ds={key:1},Ns={class:"num"},Bs=Co(()=>s("img",{src:xo,alt:""},null,-1)),Es={class:"num"},Ms={class:"per"},qs=Co(()=>s("div",null,[s("svg",{class:"icon icon-up","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Vs=Co(()=>s("div",null,[s("svg",{class:"icon icon-down","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Ws=[qs,Vs];function Hs(o,l,p,u,_,a){var i,d,v,$;return n(),t("div",Os,[(o.isUsepropsDirect?o.propsDirect:o.direct)?(n(),t("p",Us,[s("span",Ts,m(("sFixD"in o?o.sFixD:g(W))(o.poolInfo.minPrice,6))+" ",1),Rs,s("span",As," "+m(("sFixD"in o?o.sFixD:g(W))(o.poolInfo.maxPrice,6))+" ",1),s("span",Fs,m((i=o.poolInfo.coinB)==null?void 0:i.symbol)+" per "+m((d=o.poolInfo.coinA)==null?void 0:d.symbol),1)])):(n(),t("p",Ds,[s("span",Ns,m(o.poolInfo.maxPrice!=="∞"?("sFixD"in o?o.sFixD:g(W))(1/o.poolInfo.maxPrice,6):"0")+" ",1),Bs,s("span",Es," "+m(o.poolInfo.minPrice!=="0"?("sFixD"in o?o.sFixD:g(W))(1/o.poolInfo.minPrice,6):"∞")+" ",1),s("span",Ms,m((v=o.poolInfo.coinA)==null?void 0:v.symbol)+" per "+m(($=o.poolInfo.coinB)==null?void 0:$.symbol),1)])),s("div",{class:"icon-change",onClick:l[0]||(l[0]=fo(()=>o.clickChange(),["stop"]))},Ws)])}const Do=Y(js,[["render",Hs],["__scopeId","data-v-1fbaf879"]]),Js=X({props:{poolInfo:{type:Object,default:()=>({})}},setup(){const o=B(!0);return{sFixD:W,direct:o}}});const zs=o=>(to("data-v-14f67ada"),o=o(),ao(),o),Qs={class:"valid-range"},Gs=zs(()=>s("div",{class:"title"},"Valid Range",-1));function Ks(o,l,p,u,_,a){const i=Do;return n(),t("div",Qs,[Gs,w(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Xs=Y(Js,[["render",Ks],["__scopeId","data-v-14f67ada"]]),Ys=X({props:{poolInfo:{type:Object,default:()=>({})}},setup(){return{}}});const Zs={class:"pool"},xs={class:"pool-info"},oe={class:"token-logo"},se={alt:""},ee={alt:""},ne={class:"token-symbol"},te={class:"symbol"},ae={class:"fee-rate"};function ie(o,l,p,u,_,a){var v,$,f,h;const i=Xs,d=Io("image");return n(),t("div",Zs,[s("div",xs,[s("div",oe,[lo(s("img",se,null,512),[[d,(v=o.poolInfo.coinA)==null?void 0:v.logo_url]]),lo(s("img",ee,null,512),[[d,($=o.poolInfo.coinB)==null?void 0:$.logo_url]])]),s("div",ne,[s("div",te,m((f=o.poolInfo.coinA)==null?void 0:f.symbol)+" - "+m((h=o.poolInfo.coinB)==null?void 0:h.symbol),1),s("div",ae,m(o.poolInfo.fee),1)])]),w(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const os=Y(Ys,[["render",ie],["__scopeId","data-v-c027f63c"]]),le=X({props:{currentTab:{type:String,default:""},rewardInfo:{type:Object,default:()=>({})}},setup(){const o=vo(),l=r(()=>o);return{sFixD:W,addCommom:j,getCoinIcon:u=>{var _;return((_=l.value.tokensObj[u])==null?void 0:_.logo_url)||Lo("/image/coins/sui-unknown.png")}}}});const re={key:0,class:"rewards-day"},de={class:"rewards-day-box"},ce={alt:""};function ue(o,l,p,u,_,a){const i=Io("image");return o.rewardInfo.allocate_point>0||o.currentTab!=="Live"?(n(),t("div",re,[s("div",null,[s("div",de,[lo(s("img",ce,null,512),[[i,o.getCoinIcon(o.rewardInfo.reward_coin)]]),s("span",null,m(("addCommom"in o?o.addCommom:g(j))(("sFixD"in o?o.sFixD:g(W))(o.rewardInfo.emission_per_day,4)))+" "+m(o.rewardInfo.symbol),1)])])])):E("",!0)}const ss=Y(le,[["render",ue],["__scopeId","data-v-48e4e83a"]]),me=X({props:{positionInfo:{type:Object,default:()=>({})}},setup(o){console.log(o.positionInfo,"props.positionInfo");const l=vo(),p=r(()=>l);return{addCommom:j,decimalUi:co,fixD:Ao,getCoinIcon:_=>{var a;return((a=p.value.tokensObj[_])==null?void 0:a.logo_url)||Lo("/image/coins/sui-unknown.png")}}}});const pe={class:"hover-rewarder"},_e={class:"rewarder-info"},fe={class:"left-rewarder"},he={alt:""},ve={class:"right-rewarder"},ge={class:"amount"},be={key:0,class:"amount-usd"},$e={key:1,class:"amount-usd"},ye={class:"rewarder-info"},we={class:"left-rewarder"},Ie={alt:""},ke={class:"right-rewarder"},Se={class:"amount"},Pe={key:0,class:"amount-usd"},Le={key:1,class:"amount-usd"};function Ce(o,l,p,u,_,a){const i=Io("image");return n(),t("div",pe,[s("div",_e,[s("div",fe,[lo(s("img",he,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinB.address:o.positionInfo.coinA.address)]]),s("span",null,m(o.positionInfo.needReverse?o.positionInfo.coinB.symbol:o.positionInfo.coinA.symbol),1)]),s("div",ve,[s("div",ge,m(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:g(j))(("decimalUi"in o?o.decimalUi:g(co))(o.positionInfo.amountB,o.positionInfo.coinB.decimals)):("addCommom"in o?o.addCommom:g(j))(("decimalUi"in o?o.decimalUi:g(co))(o.positionInfo.amountA,o.positionInfo.coinA.decimals))),1),o.positionInfo.needReverse?(n(),t("div",$e,m(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("fixD"in o?o.fixD:g(Ao))(o.positionInfo.amountBUsd,2):"<$0.01"),1)):(n(),t("div",be,m(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("fixD"in o?o.fixD:g(Ao))(o.positionInfo.amountAUsd,2):"<$0.01"),1))])]),s("div",ye,[s("div",we,[lo(s("img",Ie,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinA.address:o.positionInfo.coinB.address)]]),s("span",null,m(o.positionInfo.needReverse?o.positionInfo.coinA.symbol:o.positionInfo.coinB.symbol),1)]),s("div",ke,[s("div",Se,m(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:g(j))(("decimalUi"in o?o.decimalUi:g(co))(o.positionInfo.amountA,o.positionInfo.coinA.decimals)):("addCommom"in o?o.addCommom:g(j))(("decimalUi"in o?o.decimalUi:g(co))(o.positionInfo.amountB,o.positionInfo.coinB.decimals))),1),o.positionInfo.needReverse?(n(),t("div",Le,m(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("addCommom"in o?o.addCommom:g(j))(("decimalUi"in o?o.decimalUi:g(co))(o.positionInfo.amountAUsd,2)):"<$0.01"),1)):(n(),t("div",Pe,m(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("addCommom"in o?o.addCommom:g(j))(("decimalUi"in o?o.decimalUi:g(co))(o.positionInfo.amountBUsd,2)):"<$0.01"),1))])])])}const es=Y(me,[["render",Ce],["__scopeId","data-v-0ca1f131"]]),je=X({components:{FarmsPositionAmountTips:es},props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const l=ro(),p=r(()=>l);console.log(o.positionInfo,"positionInfo#");const u=uo(),_=r(()=>u),a=wo("Sui"),i=yo("Sui"),d=B(!1),v=ko();r(()=>v);const $=Po(),{setIsShowSuccess:f,setIsShowRejected:h,setIsShowWaiting:I,setTransactionDesc:C,setTransactionTxid:e}=v,M=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,e(""),C(`Stake ${o.positionInfo.name}`),I(!0);const y={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b};console.log(O.value,"##farmsPoolObj.value");const k=O.value[o.positionInfo.clmmPool||o.positionInfo.poolAddress].id;try{const F=await i.farmsDeposit(y,k),H=await p.value.currentWallet.signAndExecuteTransactionBlock(F);console.log("0221###sui swap res###",H),u.setFarmsLoadingObj(o.positionInfo.clmm_pool_id);let V=a.handleTx(H);if(V&&V.hash){e(V.hash),I(!1),f(!0);let eo={res:V.res,title:"Staked",hash:V.hash};a.showTransitionPending(eo),await a.watchTransaction(eo)&&setTimeout(()=>{u.getPositionByPool(p.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else I(!1),h(!0)}catch(F){console.log("farmsDeposit error",F),I(!1),h(!0),d.value=!1}},S=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,e(""),C(`Unstake ${o.positionInfo.name}`),I(!0);const y=O.value[o.positionInfo.clmmPool].id,k=o.positionInfo.id;try{const F=await i.farmsWithdraw(y,k),H=await p.value.currentWallet.signAndExecuteTransactionBlock(F);console.log("0221###sui swap res###",H),u.setFarmsLoadingObj(o.positionInfo.clmm_pool_id);let V=a.handleTx(H);if(console.log(V,"unStaketx##"),V&&V.hash){e(V.hash),I(!1),f(!0);let eo={res:V.res,title:"Unstaked",hash:V.hash};a.showTransitionPending(eo),await a.watchTransaction(eo)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),u.getPositionByPool(p.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else I(!1),h(!0)}catch(F){console.log("farmsDeposit error",F),I(!1),h(!0),d.value=!1}},L=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,e(""),C("Claim rewards"),I(!0);const y={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const k=await i.harvestFarms(y),F=await p.value.currentWallet.signAndExecuteTransactionBlock(k);u.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",F);let H=a.handleTx(F);if(H&&H.hash){e(H.hash),I(!1),f(!0);let V={title:"Claim",res:H.res,hash:H.hash};a.showTransitionPending(V),await a.watchTransaction(V)&&setTimeout(()=>{u.getPositionByPool(p.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else I(!1),h(!0);d.value=!1}catch(k){console.log("farmsDeposit error",k),I(!1),h(!0),d.value=!1}},J=r(()=>_.value.farmsRewardObj),Q=vo(),Z=r(()=>Q),A=r(()=>_.value.farmsLoadingObj),O=r(()=>_.value.farmsPoolObj);return{sFixD:W,stake:M,loading:d,unStake:S,router:$,claim:L,farmsRewardObj:J,getCoinIcon:y=>{var k;return((k=Z.value.tokensObj[y])==null?void 0:k.logo_url)||Lo("/image/coins/sui-unknown.png")},toPositionDetails:y=>{console.log("toPositionDetails:",y),y.positionSource=="clmm"?$.push(`/new-position-detail?collect=${y.collectionName}&&token=${y.name}&&address=${y.pool}&pos=${y.pos_object_id}`):$.push(`/new-position-detail?position_nft_id=${y.id}&positionSource=farming`)},farmsLoadingObj:A,addCommom:j}}}),ns=""+globalThis.__publicAssetsURL("sui-image/position-active.png");const jo=o=>(to("data-v-5d2916e1"),o=o(),ao(),o),Oe={class:"farms-position-item"},Ue=jo(()=>s("thead",null,[s("tr",null,[s("th",null,"Position"),s("th",null,"Liquidity"),s("th",null,"Earnings"),s("th")])],-1)),Te={class:"position-info"},Re={key:0,class:"status-bg"},Ae=jo(()=>s("img",{src:ns,alt:""},null,-1)),Fe=[Ae],De={class:"status-text"},Ne={class:"name-range"},Be=jo(()=>s("span",null,"Details",-1)),Ee=jo(()=>s("svg",{class:"arrow-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Me=[Be,Ee],qe={class:"liquidity"},Ve={class:"rewards-day-box"},We={alt:""},He={key:1,class:"rewards-day"},Je={class:"action-btn"};function ze(o,l,p,u,_,a){const i=Do,d=es,v=bo,$=ms,f=Io("image");return n(),t("div",Oe,[s("table",null,[Ue,s("tbody",null,[s("tr",null,[s("td",null,[s("div",Te,[s("div",{class:ho(["position-status",o.positionInfo.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionInfo.positionStatus=="Active"?(n(),t("div",Re,Fe)):E("",!0),s("div",De,m(o.positionInfo.positionStatus),1)],2),s("div",Ne,[s("span",null,m(o.positionInfo.name),1),w(i,{"pool-info":o.positionInfo},null,8,["pool-info"])]),s("div",{class:"details",onClick:l[0]||(l[0]=h=>o.toPositionDetails(o.positionInfo))},Me)])]),s("td",null,[s("div",qe,[s("span",null,[U(m(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:g(j))(("sFixD"in o?o.sFixD:g(W))(o.positionInfo.positionUSD,2))}`)+" ",1),w(d,{"position-info":o.positionInfo},null,8,["position-info"])])])]),s("td",null,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(z,{key:0},no(o.positionInfo.rewards,h=>(n(),t("div",{key:h.rewarder_type,class:"rewards-day"},[s("div",null,[s("div",Ve,[lo(s("img",We,null,512),[[f,o.getCoinIcon(h.rewarder_type)]]),s("span",null,m(h.rewarderAmount),1)])])]))),128)):(n(),t("div",He,"0"))]),s("td",null,[s("div",Je,[o.positionInfo.positionSource=="clmm"?(n(),t(z,{key:0},[o.positionInfo&&o.positionInfo.positionStatus!=="Active"?(n(),T($,{key:0},{title:N(()=>[U("Farming rewards are only available for active positions.")]),default:N(()=>[w(v,{class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:N(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"])]),_:1})):(n(),T(v,{key:1,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:N(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"]))],64)):(n(),T(v,{key:1,class:"unstake-btn",onClick:o.unStake},{default:N(()=>[U("Unstake")]),_:1},8,["onClick"])),o.positionInfo.positionSource=="clmm"?(n(),T(v,{key:2,class:"claim-btn",disabled:!0},{default:N(()=>[U("↑ Claim")]),_:1})):(n(),T(v,{key:3,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0,onClick:o.claim},{default:N(()=>[U("↑ Claim")]),_:1},8,["disabled","onClick"]))])])])])])])}const ts=Y(je,[["render",ze],["__scopeId","data-v-5d2916e1"]]),Qe=X({props:{noDataImg:{type:String,default:""},desc:{type:String,default:""},type:{type:String,default:""},addLiquidityUrl:{type:String,default:""}},setup(){return{walletStore:ro()}}});const Ge={class:"no-data"},Ke=["src"],Xe={key:0,class:"desc"};function Ye(o,l,p,u,_,a){const i=bo;return n(),t("div",Ge,[s("img",{src:o.noDataImg,alt:""},null,8,Ke),o.desc?(n(),t("div",Xe,m(o.desc),1)):E("",!0),o.type=="addLiquidity"?(n(),T(i,{key:1,class:"add-liquidity-btn",onClick:l[0]||(l[0]=d=>o.addLiquidityUrl?o.$router.push(o.addLiquidityUrl):"")},{default:N(()=>[U("Add Liquidity")]),_:1})):E("",!0),o.type=="connectWallet"?(n(),T(i,{key:2,class:"add-liquidity-btn",onClick:l[1]||(l[1]=d=>o.walletStore.setIsShowWalletModal(!0))},{default:N(()=>[U("Connect Wallet")]),_:1})):E("",!0)])}const as=Y(Qe,[["render",Ye],["__scopeId","data-v-130f9462"]]),Ze=X({components:{FarmsPositionItem:ts},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const l=B({}),p=ro(),u=r(()=>p),_=uo(),a=r(()=>_),i=r(()=>a.value.farmsPoolList),d=r(()=>a.value.farmsPoolList),v=ko(),$=r(()=>v),f=r(()=>$.value.addressLpTokens),h=B([]),I=r(()=>a.value.myFarmsPoolList),C=K=>{console.log(d.value,"###list.value");let G,x;o.currentTab=="My Farms"&&(G=u.value.address?I.value:[]),console.log("getPageList:",G),o.currentTab=="Ended"&&(G=a.value.farmsPoolList.filter(c=>(console.log(c.status,"##ele.status "),c.status=="Ended"))),o.currentTab=="Live"&&(G=a.value.farmsPoolList.filter(c=>c.status=="Live")),K=="APR"?x=G.sort((c,b)=>b.stable_farming.apr-c.stable_farming.apr):x=G.sort((c,b)=>b.stable_farming.tvl-c.stable_farming.tvl),h.value=x.map(c=>{var b;return console.log(c,"pool###"),{...c,needReverse:c.is_forward===!1,coinA:c.coin_a,coinB:c.coin_b,liquidity:c.tvl_in_usd,vol:c.vol_in_usd_24h,stableFarmingApr:c.stable_farming&&c.stable_farming.apr*100,apr:c.apr_24h.replace("%",""),is_display_rewarder:(b=c==null?void 0:c.rewarder)==null?void 0:b.is_display_rewarder}})};go(()=>[d.value,o.sortValue,o.currentTab,I.value],([K,G])=>{console.log(G,"sortValue326"),K&&K.length>0&&G&&C(G)},{immediate:!0});const e=K=>{if(l.value[K.clmm_pool_id])l.value[K.clmm_pool_id]=!1;else{if(l.value[K.clmm_pool_id]=!0,!u.value.address)return!1;console.log("执行了吗"),_.getPositionByPool(u.value.address,K.clmm_pool_id,K.id)}},M=r(()=>a.value.farmsPositionObj),S=r(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),L=r(()=>a.value.farmsUserUsd),J=r(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),Q=r(()=>a.value.farmsPositionList),Z=r(()=>a.value.farmsAllPositionLoading),A=Po(),O=yo("Sui"),R=wo("Sui"),{setIsShowSuccess:q,setIsShowRejected:y,setIsShowWaiting:k,setTransactionDesc:F,setTransactionTxid:H}=v,V=async K=>{console.log(Q.value,"farmsRewardObj###");const G=[];Q.value.forEach(x=>{console.log(K,x,"#position"),K==x.clmm_pool_id&&G.push({pool_id:x.pool_id,position_nft_id:x.id})}),console.log(JSON.stringify(G),"##params"),H(""),F("Claim rewards"),k(!0);try{const x=await O.batchHarvest(G),c=await u.value.currentWallet.signAndExecuteTransactionBlock(x);console.log("0221###sui swap res###",c);let b=R.handleTx(c);if(b&&b.hash){H(b.hash),k(!1),q(!0);let P={res:b.res,title:"Claim",hash:b.hash};R.showTransitionPending(P),await R.watchTransaction(P)&&setTimeout(()=>{_.getFarmsPoolList()},4e3)}else k(!1),y(!0)}catch(x){console.log("Claim all error",x),k(!1),y(!0)}},eo=vo(),io=r(()=>eo),Oo=r(()=>(console.log(io.value.poolsObj,"##pools.value.poolsObj"),io.value.poolsObj));r(()=>io.value.tokensObj);const Uo=B({}),po=r(()=>a.value.farmsPoolObj);return console.log(f.value,"addressLpTokens:"),{wallet:u,walletStore:p,farmsPoolList:i,openMore:e,openMoreObj:l,checkNullObj:oo,router:A,farmsPositionObj:M,farmsLoadingObj:S,farmsUserUsd:L,sFixD:W,farmsRewardObj:J,claimPoolReward:V,farmsAllPositionLoading:Z,addCommom:j,addressLpTokens:f,poolsObj:Oo,rewardInfoObj:Uo,pageList:h,farmsPoolObj:po}}});const mo=o=>(to("data-v-8bda247e"),o=o(),ao(),o),xe={class:"farms-table"},on=mo(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px"}})],-1)),sn={key:0},en=["onClick"],nn={class:"staked-tvl"},tn={class:"apr"},an={key:0,class:"apr-hover-box"},ln={class:"farms-reward-box"},rn={key:0,class:"my-staked"},dn={key:0,class:"my-staked-loading"},cn={key:0,class:"position-usd"},un={key:1,class:"position-usd"},mn={key:2,class:"position-usd"},pn={key:3,class:"position-num"},_n={key:1,class:"my-staked"},fn=mo(()=>s("div",{class:"position-usd"},"--",-1)),hn=[fn],vn={class:"earned"},gn={key:0,class:"my-staked-loading"},bn={key:0,class:"ratio-bg"},$n=mo(()=>s("div",{class:"ratio"},null,-1)),yn=[$n],wn={key:1},In={key:2},kn={key:3},Sn={key:2},Pn={class:"actions"},Ln={class:"actions-btn"},Cn=["onClick"],jn=mo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),On=[jn],Un={colspan:"7",style:{padding:"0 16px 16px"}},Tn={key:0,class:"farm-position-list"},Rn={key:0,class:"farm-position-loading"},An={key:1,class:"farm-position-list"},Fn=mo(()=>s("tr",{style:{height:"8px"}},null,-1)),Dn={key:1},Nn={colspan:"7"},Bn={key:0,class:"no-data"},En=mo(()=>s("img",{src:Ko,alt:""},null,-1)),Mn={key:1,class:"no-data"},qn=mo(()=>s("img",{src:Xo,alt:""},null,-1)),Vn=mo(()=>s("span",null,"No farms found",-1)),Wn=[qn,Vn];function Hn(o,l,p,u,_,a){const i=os,d=Go,v=ss,$=Fo,f=bo,h=Jo,I=ts,C=as;return n(),t("div",xe,[s("table",null,[on,o.pageList&&o.pageList.length>0?(n(),t("tbody",sn,[(n(!0),t(z,null,no(o.pageList,e=>{var M;return n(),t(z,{key:e.id},[s("tr",{onClick:S=>o.openMore(e)},[s("td",null,[w(i,{"pool-info":e},null,8,["pool-info"])]),s("td",null,[s("div",nn," $"+m(("addCommom"in o?o.addCommom:g(j))(e.stable_farming.tvl,2)),1)]),s("td",null,[s("div",tn,[e.isStableFarming||e.rewarderInfo&&e.rewarderInfo.length>0||(M=e==null?void 0:e.stable_farming)!=null&&M.stable_farming_pool?(n(),t("div",an,[w(d,{"l-item":e,"rewarder-info":e.rewarder.rewardList,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])):E("",!0),s("span",null,m((e==null?void 0:e.total_apr)>0&&e.total_apr<1e-4?"<0.01%":`${("addCommom"in o?o.addCommom:g(j))(e.total_apr*100,2)}%`),1)])]),s("td",null,[s("div",ln,[(n(!0),t(z,null,no(e.rewarders,S=>(n(),T(v,{key:S.reward_coin,"reward-info":S,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("td",null,[o.wallet.address?(n(),t("div",rn,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",dn,[w($,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):(n(),t(z,{key:1},[o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount>.01?(n(),t("div",cn,m(Number(o.farmsUserUsd[e.clmm_pool_id].amount)>0&&Number(o.farmsUserUsd[e.clmm_pool_id].amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:g(j))(o.farmsUserUsd[e.clmm_pool_id].amount,2)),1)):o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount<.01?(n(),t("div",un," <$0.01 ")):(n(),t("div",mn,"0")),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",pn,m(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+m(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):E("",!0)],64))])):(n(),t("div",_n,hn))]),s("td",null,[s("div",vn,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",gn,[w($,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(z,{key:1},[o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd>0?(n(),t("div",bn,yn)):E("",!0),Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>.01?(n(),t("span",wn,"$"+m(("addCommom"in o?o.addCommom:g(j))(("sFixD"in o?o.sFixD:g(W))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>0&&Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)<.01?(n(),t("span",In,"<$0.01")):(n(),t("span",kn,"0"))],64)):(n(),t("span",Sn,"0"))])]),s("td",null,[s("div",Pn,[s("div",Ln,[w(f,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||!o.farmsRewardObj[e.clmm_pool_id].amountUsd||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0||o.farmsLoadingObj[e.clmm_pool_id],onClick:fo(S=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:N(()=>[U("Claim")]),_:2},1032,["disabled","onClick"]),w(f,{class:"add-liquidity-btn",onClick:fo(S=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:N(()=>[U("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more",onClick:fo(S=>o.openMore(e),["stop"])},[(n(),t("svg",{class:ho(["arrow-icon",o.openMoreObj[e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},On,2))],8,Cn)])])],8,en),lo(s("tr",null,[s("td",Un,[o.wallet.address?(n(),t("div",Tn,[!("checkNullObj"in o?o.checkNullObj:g(oo))(o.farmsLoadingObj)&&o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Rn,[w(h)])):o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length>0?(n(!0),t(z,{key:1},no(o.farmsPositionObj[e.clmm_pool_id],S=>(n(),T(I,{key:S.clmm_position_id,"current-tab":o.currentTab,"position-info":{...S,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"]))),128)):(n(),T(C,{key:2,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"]))])):(n(),t("div",An,[w(C,{"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"})]))])],512),[[zo,!("checkNullObj"in o?o.checkNullObj:g(oo))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]]),Fn],64)}),128))])):(n(),t("tbody",Dn,[s("tr",null,[s("td",Nn,[!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",Bn,[En,w(f,{class:"connect-wallet",onClick:l[0]||(l[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:N(()=>[U(m(o.$t("button.connectWallet")),1)]),_:1})])):o.pageList.length==0?(n(),t("div",Mn,Wn)):E("",!0)])])]))])])}const is=Y(Ze,[["render",Hn],["__scopeId","data-v-8bda247e"]]),Jn=X({props:{currentTab:{type:String,default:""}},setup(){const o=B(!1),l=ro(),p=r(()=>l),u=uo(),_=r(()=>u),a=r(()=>_.value.farmsPoolList);return{isShowMore:o,wallet:p,walletStore:l,farmsPoolList:a}}});const ls=o=>(to("data-v-f521ea67"),o=o(),ao(),o),zn={class:"farms-table"},Qn=ls(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px",background:"unset"}})],-1)),Gn={class:"pool"},Kn={class:"staked-tvl"},Xn={class:"apr"},Yn={class:"my-staked"},Zn={class:"actions"},xn={class:"actions"},ot={class:"actions"},st=ls(()=>s("tr",{style:{height:"8px",background:"unset !important"}},null,-1));function et(o,l,p,u,_,a){const i=Fo;return n(),t("div",zn,[s("table",null,[Qn,s("tbody",null,[(n(),t(z,null,no(4,(d,v)=>(n(),t(z,{key:v},[s("tr",null,[s("td",null,[s("div",Gn,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1}),w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Kn,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Xn,[s("span",null,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),s("td",null,[s("div",Yn,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Zn,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",xn,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",ot,[w(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),st],64))),64))])])])}const nt=Y(Jn,[["render",et],["__scopeId","data-v-f521ea67"]]),tt=X({props:{positionStatus:{type:String,default:"Active"},positionInfo:{type:Object,default:()=>({})}},setup(){return{}}});const at=o=>(to("data-v-882c76c0"),o=o(),ao(),o),it={class:"position-info"},lt={key:0,class:"status-bg"},rt=at(()=>s("img",{src:ns,alt:""},null,-1)),dt=[rt],ct={class:"status-text"},ut={class:"name-range"};function mt(o,l,p,u,_,a){const i=Do;return n(),t("div",it,[s("div",{class:ho(["position-status",o.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionStatus=="Active"?(n(),t("div",lt,dt)):E("",!0),s("div",ct,m(o.positionStatus),1)],2),s("div",ut,[s("span",null,m(o.positionInfo.name),1),o.positionStatus=="Active"?(n(),T(i,{key:0,"pool-info":o.positionInfo},null,8,["pool-info"])):E("",!0)])])}const pt=Y(tt,[["render",mt],["__scopeId","data-v-882c76c0"]]),_t=X({props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const l=vo(),p=r(()=>l),u=Po(),_=O=>{var R;return((R=p.value.tokensObj[O])==null?void 0:R.logo_url)||Lo("/image/coins/sui-unknown.png")},a=wo("Sui"),i=yo("Sui"),d=B(!1),v=ko(),$=ro(),f=uo(),h=r(()=>$),{setIsShowSuccess:I,setIsShowRejected:C,setIsShowWaiting:e,setTransactionDesc:M,setTransactionTxid:S}=v,L=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,S(""),M("Claim rewards"),e(!0);const O={pool_id:A.value[o.positionInfo.clmmPool].id,position_nft_id:o.positionInfo.id};try{const R=await i.harvestFarms(O),q=await h.value.currentWallet.signAndExecuteTransactionBlock(R);f.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",q);let y=a.handleTx(q);if(y&&y.hash){S(y.hash),e(!1),I(!0);let k={title:"Claim",res:y.res,hash:y.hash};a.showTransitionPending(k),await a.watchTransaction(k)&&setTimeout(()=>{f.getPositionByPool(h.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else e(!1),C(!0);d.value=!1}catch(R){console.log("farmsDeposit error",R),e(!1),C(!0),d.value=!1}},J=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,S(""),M(`Unstake ${o.positionInfo.name}`),e(!0);const O=A.value[o.positionInfo.clmmPool].id,R=o.positionInfo.id;try{const q=await i.farmsWithdraw(O,R),y=await h.value.currentWallet.signAndExecuteTransactionBlock(q);f.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",y);let k=a.handleTx(y);if(k&&k.hash){S(k.hash),e(!1),I(!0);let F={res:k.res,title:"Unstaked",hash:k.hash};a.showTransitionPending(F),await a.watchTransaction(F)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),f.getPositionByPool(h.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else e(!1),C(!0)}catch(q){console.log("farmsDeposit error",q),e(!1),C(!0),d.value=!1}},Q=async()=>{console.log(o.positionInfo,"props.positionInfo"),d.value=!0,S(""),M(`Stake ${o.positionInfo.name}`),e(!0);const O={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},R=A.value[o.positionInfo.clmmPool].id;try{const q=await i.farmsDeposit(O,R),y=await h.value.currentWallet.signAndExecuteTransactionBlock(q);f.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",y);let k=a.handleTx(y);if(k&&k.hash){S(k.hash),e(!1),I(!0);let F={res:k.res,title:"Staked",hash:k.hash};a.showTransitionPending(F),await a.watchTransaction(F)&&setTimeout(()=>{f.getPositionByPool(h.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),d.value=!1},2e3)}else e(!1),C(!0)}catch(q){console.log("farmsDeposit error",q),e(!1),C(!0),d.value=!1}},Z=r(()=>f),A=r(()=>Z.value.farmsPoolObj);return{getCoinIcon:_,router:u,claim:L,unStake:J,loading:d,stake:Q,sFixD:W,addCommom:j}}});const rs=o=>(to("data-v-7a0376ad"),o=o(),ao(),o),ft={class:"farms-position"},ht={class:"farms-position-box"},vt={class:"position-info-block"},gt={class:"block-item"},bt=rs(()=>s("div",{class:"leabl"},"Liquidity",-1)),$t={class:"text"},yt={class:"earnings"},wt={class:"block-item"},It=rs(()=>s("div",{class:"leabl"},"Earnings",-1)),kt={class:"text"},St={key:0},Pt={alt:""},Lt={key:1,class:"rewards-day"},Ct={class:"unstake-btn-box"};function jt(o,l,p,u,_,a){const i=pt,d=bo,v=Io("image");return n(),t("div",ft,[s("div",ht,[w(i,{"position-info":o.positionInfo},null,8,["position-info"])]),s("div",vt,[s("div",gt,[bt,s("div",$t,m(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:g(j))(("sFixD"in o?o.sFixD:g(W))(o.positionInfo.positionUSD,2))}`),1)])]),s("div",yt,[s("div",wt,[It,s("div",kt,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(z,{key:0},no(o.positionInfo.rewards,$=>(n(),t("div",{key:$.rewarder_type,class:"rewards-day"},[$.rewarderAmount>0?(n(),t("div",St,[lo(s("img",Pt,null,512),[[v,o.getCoinIcon($.rewarder_type)]]),s("span",null,m($.rewarderAmount),1)])):E("",!0)]))),128)):(n(),t("div",Lt,"--"))])]),o.positionInfo.positionSource=="clmm"?(n(),T(d,{key:0,class:"add-liquidity-btn claim-btn",onClick:l[0]||(l[0]=$=>o.router.push(`/new-position-detail?collect=${o.positionInfo.collectionName}&&token=${o.positionInfo.name}&&address=${o.positionInfo.pool}&pos=${o.positionInfo.pos_object_id}`))},{default:N(()=>[U("+ Add liquidity")]),_:1})):(n(),T(d,{key:1,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0||o.currentTab=="Ended",onClick:o.claim},{default:N(()=>[U("↑ Claim")]),_:1},8,["disabled","onClick"]))]),s("div",Ct,[s("div",null,[o.positionInfo.positionSource=="clmm"?(n(),T(d,{key:0,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:N(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"])):(n(),T(d,{key:1,class:"unstake-btn",onClick:o.unStake},{default:N(()=>[U("Unstake")]),_:1},8,["onClick"]))])])])}const ds=Y(_t,[["render",jt],["__scopeId","data-v-7a0376ad"]]),Ot=X({components:{FarmsH5Position:ds},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const l=B(!1),p=ro(),u=r(()=>p),_=uo(),a=r(()=>_),i=r(()=>(console.log(a.value.farmsPoolList,"##farms.value.farmsPoolList"),o.currentTab=="My Farms"?u.value.address?a.value.myFarmsPoolList:[]:o.currentTab=="Ended"?a.value.farmsPoolList.filter(c=>c.status=="Ended"):a.value.farmsPoolList.filter(c=>c.status=="Live"))),d=B([]),v=ko(),$=r(()=>v),f=r(()=>$.value.addressLpTokens),h=c=>{const b=i.value.map(P=>{const{stable_farming:D}=f.value[P.clmm_pool_id];return{...P,apr:D.apr,tvl:D.tvl}});c=="APR"?d.value=b.sort((P,D)=>D.apr-P.apr):d.value=b.sort((P,D)=>D.tvl-P.tvl),console.log(d.value,"##farmsPoolList.value")};go(()=>[i.value,o.sortValue,f.value],([c,b,P])=>{console.log(b,"sortValue326"),c&&c.length>0&&b&&P&&!oo(P)&&h(b)},{immediate:!0});const I=r(()=>a.value.farmsUserUsd),C=r(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),e=r(()=>a.value.farmsPositionObj),M=r(()=>a.value.farmsPoolListLoading),S=r(()=>a.value.farmsPositionList),L=r(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),J=r(()=>a.value.farmsAllPositionLoading),Q=B({}),Z=c=>{if(Q.value[c.clmm_pool_id])Q.value[c.clmm_pool_id]=!1;else{if(Q.value[c.clmm_pool_id]=!0,!u.value.address)return!1;console.log("执行了吗"),_.getPositionByPool(u.value.address,c.clmm_pool_id,c.id)}},A=yo("Sui"),O=wo("Sui"),{setIsShowSuccess:R,setIsShowRejected:q,setIsShowWaiting:y,setTransactionDesc:k,setTransactionTxid:F}=v,H=async c=>{console.log(S.value,"farmsRewardObj###");const b=[];S.value.forEach(P=>{console.log(c,P,"#position"),c==P.clmm_pool_id&&b.push({pool_id:P.pool_id,position_nft_id:P.id})}),console.log(JSON.stringify(b),"##params"),F(""),k("Claim rewards"),y(!0);try{const P=await A.batchHarvest(b),D=await u.value.currentWallet.signAndExecuteTransactionBlock(P);console.log("0221###sui swap res###",D);let _o=O.handleTx(D);if(_o&&_o.hash){F(_o.hash),y(!1),R(!0);let So={res:_o.res,title:"Claim",hash:_o.hash};O.showTransitionPending(So),await O.watchTransaction(So)&&setTimeout(()=>{_.getFarmsPoolList()},4e3)}else y(!1),q(!0)}catch(P){console.log("Claim all error",P),y(!1),q(!0)}},V=Po(),eo=vo(),io=r(()=>eo),Oo=r(()=>(console.log(io.value.poolsObj,"##pools.value.poolsObj"),io.value.poolsObj)),Uo=r(()=>io.value.tokensObj),po=B({}),K=(c,b)=>c&&b?fs.plus(Ro(c),Ro(b)):c||0,G=c=>{let b=0;return c&&c.forEach(P=>{b+=Ro(String(P))}),String(co(String(b),2))},x=(c,b,P)=>{console.log(c,"poolsObj##473"),Object.keys(c).forEach(D=>{var To,No,Bo;const _o=(To=b[D])==null?void 0:To.apr_7day,So=K((No=b[D])==null?void 0:No.apr_7day,G((Bo=b[D])==null?void 0:Bo.rewarder_apr));po.value[D]={...c[D],apr:String(_o).replace("%",""),aprTotal:So},po.value[D].rewards=[],c[D].rewarderInfo.forEach((us,Eo)=>{var Vo,Wo;const Mo=(Vo=P[us.coinAddress])==null?void 0:Vo.symbol,qo=(Wo=b[D])==null?void 0:Wo.rewarder_apr[Eo];console.log(Mo,qo,"getRewardInfo:"),console.log(c[D],"## poolsObj[key]"),po.value[D].rewards.push({symbol:Mo,rewarderApr:qo,rewarder_display:c[D][`rewarder_display${Eo+1}`]})})}),console.log(po.value,"##rewardInfoObj")};return go(()=>[Oo.value,f.value,Uo.value],([c,b,P])=>{c&&!oo(c)&&b&&!oo(b)&&P&&!oo(P)&&x(c,b,P)},{immediate:!0}),{isShowMore:l,wallet:u,farmsPoolList:d,farmsUserUsd:I,sFixD:W,farmsRewardObj:C,farmsPositionObj:e,openMore:Z,checkNullObj:oo,openMoreObj:Q,farmsPoolListLoading:M,claimPoolReward:H,router:V,addCommom:j,farmsLoadingObj:L,farmsAllPositionLoading:J,addressLpTokens:f,rewardInfoObj:po}}});const so=o=>(to("data-v-e50cf02b"),o=o(),ao(),o),Ut={key:0,class:"farms-pool-list"},Tt={class:"farms-block"},Rt={class:"item-block"},At=so(()=>s("div",{class:"leabl"},"Staked TVL",-1)),Ft={class:"text"},Dt={class:"item-block apr"},Nt=so(()=>s("div",{class:"leabl"},"APR",-1)),Bt={class:"text"},Et={class:"apr-hover-box"},Mt={class:"item-block"},qt=so(()=>s("div",{class:"leabl"},"Rewards / day",-1)),Vt={class:"text"},Wt={class:"item-block my-staked"},Ht=so(()=>s("div",{class:"leabl"},"My Staked",-1)),Jt={key:0,class:"text"},zt={class:"position-usd"},Qt={key:0,class:"position-num"},Gt={key:1,class:"text"},Kt=so(()=>s("div",{class:"position-usd"},"--",-1)),Xt=[Kt],Yt={class:"item-block"},Zt=so(()=>s("div",{class:"leabl"},"Earned",-1)),xt={class:"text earned-box"},oa={class:"earned"},sa={key:0,class:"my-staked-loading"},ea=so(()=>s("div",{class:"ratio-bg"},[s("div",{class:"ratio"})],-1)),na={key:0},ta={key:1},aa={key:2},ia={key:2},la={class:"add-liquidity-box"},ra=["onClick"],da=so(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),ca=[da],ua={key:1,class:"upgrade-loading"},ma={key:2,class:"no-data"},pa=so(()=>s("img",{src:Ko,alt:""},null,-1)),_a={key:3,class:"no-data"},fa=so(()=>s("img",{src:Xo,alt:""},null,-1)),ha=so(()=>s("span",null,"No Data",-1)),va=[fa,ha];function ga(o,l,p,u,_,a){const i=os,d=Go,v=ss,$=Fo,f=bo,h=ds,I=as,C=_s;return n(),t(z,null,[o.farmsPoolListLoading?o.farmsPoolListLoading?(n(),t("div",ua,[w(C,{type:"poolsCard",loading:!0})])):E("",!0):(n(),t("div",Ut,[(n(!0),t(z,null,no(o.farmsPoolList,e=>{var M,S,L;return n(),t("div",{key:e.id,class:"farms-item"},[w(i,{"pool-info":e},null,8,["pool-info"]),s("div",Tt,[s("div",Rt,[At,s("div",Ft,"$"+m(("addCommom"in o?o.addCommom:g(j))(e.tvl,2)),1)]),s("div",Dt,[Nt,s("div",Bt,[U(m(e.total_apr>0&&e.total_apr<1e-4?"<0.01%":("addCommom"in o?o.addCommom:g(j))(e.total_apr*100,2))+"% ",1),s("div",Et,[e.isStableFarming||e.rewarderInfo&&e.rewarderInfo.length>0||(M=e==null?void 0:e.stable_farming)!=null&&M.stable_farming_pool?(n(),T(d,{key:0,"l-item":e,"rewarder-info":e.rewarder.rewardList,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])):E("",!0)])])]),s("div",Mt,[qt,s("div",Vt,[(n(!0),t(z,null,no(e.rewarders,J=>(n(),T(v,{key:J.reward_coin,"reward-info":J,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("div",Wt,[Ht,o.wallet.address?(n(),t("div",Jt,[s("div",zt,m(Number((S=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:S.amount)>0&&Number((L=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:L.amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:g(j))(o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount||0,2)),1),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Qt,m(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+m(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):E("",!0)])):(n(),t("div",Gt,Xt))]),s("div",Yt,[Zt,s("div",xt,[s("div",oa,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",sa,[w($,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(z,{key:1},[ea,o.farmsRewardObj[e.clmm_pool_id].amountUsd>.01?(n(),t("span",na,"$"+m(("addCommom"in o?o.addCommom:g(j))(("sFixD"in o?o.sFixD:g(W))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):o.farmsRewardObj[e.clmm_pool_id].amountUsd>0&&o.farmsRewardObj[e.clmm_pool_id].amountUsd<.01?(n(),t("span",ta,"<$0.01")):(n(),t("span",aa,"0"))],64)):(n(),t("span",ia,"--"))]),w(f,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0,onClick:fo(J=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:N(()=>[U("Claim")]),_:2},1032,["disabled","onClick"])])])]),s("div",la,[w(f,{class:"add-liquidity-btn",onClick:fo(J=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:N(()=>[U("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more-btn",onClick:J=>o.openMore(e)},[(n(),t("svg",{class:ho(["arrow-icon",!("checkNullObj"in o?o.checkNullObj:g(oo))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},ca,2))],8,ra),(n(!0),t(z,null,no(o.farmsPositionObj[e.clmm_pool_id],J=>lo((n(),T(h,{key:J.clmm_pool_id,"current-tab":o.currentTab,"position-info":{...J,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"])),[[zo,!("checkNullObj"in o?o.checkNullObj:g(oo))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]])),128)),o.farmsPositionObj&&o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length==0?(n(),T(I,{key:0,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"])):E("",!0),o.wallet.address?E("",!0):(n(),T(I,{key:1,"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"},null,8,["no-data-img"]))])}),128))])),!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",ma,[pa,w(f,{class:"connect-wallet",onClick:l[0]||(l[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:N(()=>[U(m(o.$t("button.connectWallet")),1)]),_:1})])):o.farmsPoolList.length==0?(n(),t("div",_a,va)):E("",!0)],64)}const cs=Y(Ot,[["render",ga],["__scopeId","data-v-e50cf02b"]]),ba=X({setup(o,l){const p=B("Live"),u=B("TVL"),_=B(!1),a=B(!1),i=uo(),d=r(()=>i),v=ro(),$=r(()=>v),f=r(()=>p.value=="My Farms"?$.value.address?d.value.myFarmsPoolList:[]:p.value=="Ended"?d.value.farmsPoolList.filter(L=>L.status=="Ended"):d.value.farmsPoolList.filter(L=>L.status=="Live")),h=r(()=>d.value.farmsPoolList.filter(L=>L.status=="Ended")),I=r(()=>h.value.length>0?["Live","Ended","My Farms"]:["Live","My Farms"]),C=L=>f.value.length,e=()=>{_.value=!0,i.getFarmsPoolList(),setTimeout(()=>{_.value=!1},1e3)},M=L=>{p.value=L,l.emit("changeTab",L)},S=L=>{u.value=L,l.emit("changeSortValue",L)};return Qo(()=>{document.addEventListener("click",()=>{a.value=!1})}),{isOpenList:a,tabList:I,currentTab:p,sortValue:u,clickRefresh:e,isRefresh:_,farmsPoolList:f,getListNum:C,changeTab:M,changeSortValue:S}}});const $o=o=>(to("data-v-29027bb0"),o=o(),ao(),o),$a={class:"farms-tab"},ya={class:"tab-left"},wa=["onClick"],Ia={key:0},ka={class:"tab-right"},Sa={class:"sort-select"},Pa=$o(()=>s("div",null,"Sort by",-1)),La={class:"showSort"},Ca=$o(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),ja=$o(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),Oa=[ja],Ua={key:0,class:"sort-list"},Ta=$o(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),Ra=$o(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),Aa={class:"refresh"},Fa=$o(()=>s("use",{"xlink:href":"#icon-icon-refresh2"},null,-1)),Da=[Fa];function Na(o,l,p,u,_,a){return n(),t("div",$a,[s("div",ya,[(n(!0),t(z,null,no(o.tabList,i=>(n(),t("div",{key:i,class:ho(["tab-item",o.currentTab==i?"tab-item-active":""]),onClick:d=>o.changeTab(i)},[s("span",null,m(i=="Ended"?"Finished":i),1),o.currentTab==i&&o.getListNum(i)?(n(),t("p",Ia,m(o.getListNum(i)),1)):E("",!0)],10,wa))),128))]),s("div",ka,[s("div",Sa,[s("div",{class:"sort-select-box",onClick:l[0]||(l[0]=fo(i=>o.isOpenList=!o.isOpenList,["stop"]))},[Pa,s("div",La,[s("span",null,m(o.sortValue),1),Ca,(n(),t("svg",{class:ho(["arrow-icon",o.isOpenList?"arrow-icon-active":""]),"aria-hidden":"true"},Oa,2))])]),o.isOpenList?(n(),t("div",Ua,[s("div",{class:"sort-item",onClick:l[1]||(l[1]=i=>o.changeSortValue("APR"))},[U("APR "),Ta]),s("div",{class:"sort-item",onClick:l[2]||(l[2]=i=>o.changeSortValue("TVL"))},[U("TVL "),Ra])])):E("",!0)]),s("div",Aa,[(n(),t("svg",{"aria-hidden":"true",class:ho(["refresh-icon",o.isRefresh?"refreshing":""]),onClick:l[3]||(l[3]=(...i)=>o.clickRefresh&&o.clickRefresh(...i))},Da,2))])])])}const Ba=Y(ba,[["render",Na],["__scopeId","data-v-29027bb0"]]),Ea=X({components:{FarmsBanner:Zo,FarmsTabs:Ba,FarmsTable:is,FarmsH5List:cs},setup(){const o=uo(),l=r(()=>o),p=r(()=>l.value.farmsPoolListLoading),u=B("TVL"),_=r(()=>l.value.farmsPoolList),a=ro(),i=r(()=>a),d=vo(),v=r(()=>d);go(()=>[i.value.address,_.value,v.value.tokensObj,v.value.RATES],([f,h,I,C])=>{f&&h.length>0&&!oo(I)&&!oo(C)&&o.getPositionByAllPool(f)},{immediate:!0}),Qo(()=>{o.getFarmsPoolList()}),go(()=>i.value.address,f=>{f||o.logOut()},{immediate:!0});const $=B("Live");return{farmsPoolListLoading:p,currentTab:$,sortValue:u}}});const Ma={class:"farm-container"},qa={class:"farm-container-center"};function Va(o,l,p,u,_,a){const i=Zo,d=ps("FarmsTabs"),v=is,$=nt,f=cs;return n(),t("div",Ma,[w(i),s("div",qa,[w(d,{onChangeTab:l[0]||(l[0]=h=>{o.currentTab=h}),onChangeSortValue:l[1]||(l[1]=h=>{o.sortValue=h})}),o.farmsPoolListLoading?(n(),T($,{key:1,"current-tab":o.currentTab},null,8,["current-tab"])):(n(),T(v,{key:0,"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])),w(f,{"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])])])}const ii=Y(Ea,[["render",Va],["__scopeId","data-v-656fe488"]]);export{ii as default};
