import{_ as de}from"./upgrade-loading.8cfddc05.js";import{_ as me}from"./upgrade-position-item.66f8f07c.js";import{a as pe,r as b,z as ve,b as ge,m as f,A as P,q as he,s as fe,t as be,V as _e,e as ye,l as K,o as n,f as r,h as p,c as Z,G as k,F as I,E as F,i as M,D as H,x as A,y as Q,j as X,w as ke,B as Se,p as Le,k as we}from"./entry.ec51292c.js";import{u as Ae,a as Te}from"./index.5ec39a2c.js";import{u as Pe}from"./notifi.87ce3227.js";import{c as Oe}from"./common.923681a5.js";import{u as Ue,c as $e}from"./index.1602a5cd.js";import{i as Y}from"./import-icon.de3e6c66.js";import{T as Ce}from"./total-position.8cf6db48.js";import{_ as x}from"./icon_on_2x.5e96733d.js";import{_ as Re}from"./img-no-Positions_2x.90bb01f4.js";import{_ as Be}from"./img-no-Positions_2x.9e24c205.js";import{_ as Ne}from"./img-connect-wallet_2x.63d1d0fc.js";import{_ as De}from"./img-connect-wallet_2x.0715fc8f.js";/* empty css              */import"./index.ef83fc04.js";import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.6a322f85.js";/* empty css              */import"./farms-valid-range.1642b3c8.js";import"./decimal.a2826370.js";import"./decimal.765d8738.js";import"./farms.e2934ed3.js";import"./icon_farms_2x.9decfb95.js";import"./icon_rewards_2x.6258c5ab.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./farms.02b92dd0.js";import"./useWhale.a622f1b3.js";import"./pool.fef7f7f3.js";import"./formatter.64ddaae3.js";import"./coin-pair-name.75c4b05a.js";import"./token-warning.e63c2885.js";import"./no-data.114888c8.js";/* empty css              *//* empty css              */import"./usePositionList.5fcb823a.js";import"./useSDK.f15fa82d.js";import"./useToken.15049d74.js";import"./token.5343f0b4.js";import"./fetchFun.ff4aae28.js";import"./useRate.3578201c.js";const Ee=pe({components:{TotalPosition:Ce},setup(){const o=b(!1),{t:d}=ve(),W=b(["position"]),O=ge(),q=b(""),R=Ae(),v=f(()=>R),G=f(()=>v.value.chainName?$e[v.value.chainName]:{});let m=b([]);const g=Te(),a=f(()=>g),u=Ue(),c=f(()=>u),U=b(!1),$=b(d("tab.all")),j=b([d("tab.layerZero"),d("tab.wormhole"),d("tab.celer")]),B=b(!0),oe=b("TVL"),z=()=>{o.value=!0,m.value=[],c.value.address&&(g.setPools(V.value.poolConfigList,v.value.chainName),g.getMyPositons(c.value.address,a.value.poolsObj,v.value.chainName)),setTimeout(()=>{o.value=!1},1e3)},te=f(()=>{const t=Array.from(new Set(a.value.poolConfigList.flatMap(e=>!(e!=null&&e.category)||(e==null?void 0:e.category)==""?"All":e==null?void 0:e.category)));return console.log(t,"newArr"),t.length<=1?[]:t}),se=t=>{a.value.setCurrentPoolTab(t)};P(()=>v.value.isRefresh,t=>{var e,s,l,i;t&&((i=(l=(s=(e=O==null?void 0:O.currentRoute)==null?void 0:e.value)==null?void 0:s.name)==null?void 0:l.split("-"))==null?void 0:i[1])=="position"&&z()}),he(()=>{m.value=[],document.addEventListener("click",()=>{U.value=!1}),g.setMyPositionsLoading(!0)}),fe(()=>{document.addEventListener("click",()=>{U.value=!1})}),be(()=>{c.value.connected||(m.value=[])});const J=()=>{o.value=!0;let t=[];a.value.myPositions.forEach(e=>{var T,N,D,E;v.value.addressLpTokens[e.address];let s=e.positionSource=="farming",l,i;const h=e.amountA*((T=a.value.RATES[e.token_a.address])==null?void 0:T.price),_=e.amountB*((N=a.value.RATES[e.token_b.address])==null?void 0:N.price);(D=a.value.RATES[e.token_a.address])!=null&&D.price&&((E=a.value.RATES[e.token_b.address])!=null&&E.price)?(l=h+_,i=h+_):(l=" --",i=0),console.log(a.value.currentPoolTab,"##pools.value.currentPoolTab"),(a.value.currentPoolTab=="All"||a.value.currentPoolTab!=="All"&&e.category==a.value.currentPoolTab)&&t.push({...e,amountUSD:l,amountUSDOrigin:i,tokenARates:h,tokenBRates:_,isStableFarming:s})}),$.value!="All"?B.value?(m.value=t.sort((e,s)=>Number(s.amountUSDOrigin)-Number(e.amountUSDOrigin)),o.value=!1):(m.value=t.sort((e,s)=>Number(e.amountUSDOrigin)-Number(s.amountUSDOrigin)),o.value=!1):B.value?(m.value=t.sort((e,s)=>s.amountUSDOrigin-e.amountUSDOrigin),o.value=!1):(m.value=t.sort((e,s)=>e.amountUSDOrigin-s.amountUSDOrigin),o.value=!1),console.log(m.value,"list.value========>")};P(()=>[a.value.myPositions,a.value.RATES],([t,e])=>{t&&e&&(console.log("0605==>updateLpList9099999"),J())},{immediate:!0}),P(()=>[c.value.address,a.value.poolConfigList,a.value.poolsObj,v.value.chainName],([t,e,s,l])=>{var i,h,_;t&&e&&e.length>0&&l&&(l!=null&&l.toLowerCase().includes((i=e[0])==null?void 0:i.chain))&&!Oe(s)&&(l==="Aptos"?e.length===Object.values(s).length:(_=(h=Object.values(s)[0])==null?void 0:h.chain)!=null&&_.includes("sui"))&&(console.log(s,e,"0605==>getMyPositons9099999"),g.getMyPositons(c.value.address,s,l))},{immediate:!0,deep:!0}),P(()=>c.value.address,t=>{t||g.setMyPositions()},{immediate:!0}),P(()=>[$.value,B.value,a.value.currentPoolTab],([t])=>{J()});const ae=t=>{const e=[];j.value.forEach((s,l)=>{s==t?e[l]=$.value:e[l]=s}),j.value=e,$.value=t},C=Pe(),y=f(()=>C),V=f(()=>g),le=async t=>{await C.getSourceGroups();const e=y.value.sourceGroups&&y.value.sourceGroups.length>0&&y.value.sourceGroups[0]&&y.value.sourceGroups[0].sources||[];console.log(e,"####source"),console.log(t,"###myPositions");for(let s=0;s<e.length;s++){const{pool_address:l,position_index:i}=JSON.parse(e[s].blockchainAddress);let h=!1,_;for(let T=0;T<t.length;T++){const{poolAddress:N,index:D,positionSource:E,name:ce}=t[T];l==N&&Number(E=="clmm"?D:ce.split("-")[1])==Number(i)&&(h=!0),_={pool_address:l,position_index:i}}h||await C.subscribePosition(_,"",!1,!1)}},ne=async()=>{await C.getSourceGroups();const t=y.value.sourceGroups&&y.value.sourceGroups.length>0&&y.value.sourceGroups[0]&&y.value.sourceGroups[0].sources||[];for(let e=0;e<t.length;e++){const{pool_address:s,position_index:l}=JSON.parse(t[e].blockchainAddress),{name:i}=t[e],h={pool_address:s,position_index:l};await C.subscribePosition(h,i,!1,!1)}},re=f(()=>V.value.myPositionsLoading);P(()=>V.value.myPositions,(t,e)=>{G.value.hasNotifi&&(t&&t.length>0&&e&&e.length!==t.length?le(t):t&&t.length==0&&!re.value&&ne())},{immediate:!0});const ie=t=>{var e;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((e=a.value.tokensObj[t==null?void 0:t.address])==null?void 0:e.logo_url)||(v.value.theme==="default"?Y("/image/coins/unknown.png"):Y("/image/coins/sui-unknown.png"))},S=b(null),L=f(()=>S.value&&S.value.firstToken?S.value.firstToken:null),w=f(()=>S.value&&S.value.lastToken?S.value.lastToken:null),ue=f(()=>{let t=[];t=m.value;const e=t.filter((s,l)=>L.value&&w.value?s.coinA.symbol==L.value.symbol&&s.coinB.symbol==w.value.symbol||s.coinA.symbol==w.value.symbol&&s.coinB.symbol==L.value.symbol:L.value?s.coinA.symbol.toLowerCase().includes(L.value.symbol.toLowerCase())||s.coinB.symbol.toLowerCase().includes(L.value.symbol.toLowerCase()):w.value?s.coinA.symbol.toLowerCase().includes(w.value.symbol.toLowerCase())||s.coinB.symbol.toLowerCase().includes(w.value.symbol.toLowerCase()):t);return a.value.myPositionsLoading||(R.setPositiomAmount(e.length),g.setPositionShowList(e)),e});return _e(()=>{R.setPositiomAmount("--"),g.setPositionShowList([])}),{tabArr:te,changeTab:se,showList:ue,childTokenSelectRef:S,firstToken:L,lastToken:w,getCoinIcon:ie,changeSortLabel:ae,label:U,labelList:j,labelValue:$,select:B,selectValue:oe,t:d,pools:a,store:v,wallet:c,list:m,clickRefresh:z,refresh:o,current:W,router:O,searchKey:q}}});const ee=o=>(Le("data-v-07d43f93"),o=o(),we(),o),Ge={class:"upgrade-position-list-container"},je={class:"position-card-top"},Ve={class:"content-top"},Ie={class:"content-top-left"},Fe={key:0,class:"tag-list"},Me=["onClick"],We={class:"content-top-right"},qe={class:"value"},ze=ee(()=>p("use",{"xlink:href":"#icon-icon_on"},null,-1)),Je=[ze],Ke={key:0,class:"select-item"},Ze=["onClick"],He={class:"search-select-box"},Qe=ee(()=>p("span",null,"TVL",-1)),Xe={key:0,src:x,alt:""},Ye={key:1,class:"fan-img",src:x,alt:""},xe={key:0,class:"upgrade-loading"},eo={key:1,class:"position-list"},oo={key:2,class:"no-data"},to={key:0,src:Re,alt:""},so={key:1,src:Be,alt:""},ao={key:3,class:"no-data"},lo={key:0,src:Ne,alt:""},no={key:1,src:De,alt:""};function ro(o,d,W,O,q,R){const v=K("TotalPosition"),G=K("UpgradeSelectInput"),m=de,g=me,a=Se;return n(),r("div",Ge,[p("div",je,[o.wallet&&o.wallet.address?(n(),Z(v,{key:0})):k("",!0),p("div",Ve,[p("div",Ie,[o.tabArr.length>1?(n(),r("div",Fe,[(n(!0),r(I,null,F(o.tabArr,(u,c)=>(n(),r("div",{key:c,class:Q(["tag-item",u==o.pools.currentPoolTab?`tag-active tab-num-${o.tabArr.length}`:`tab-num-${o.tabArr.length}`]),onClick:U=>o.changeTab(u)},A(u),11,Me))),128))])):k("",!0),M(G,{ref:"childTokenSelectRef"},null,512)]),p("div",We,[o.store.theme=="default"?(n(),r("div",{key:0,class:"search-label",onClick:d[0]||(d[0]=H(u=>o.label=!o.label,["stop"]))},[p("span",null,A(o.$t("newAdd.label")),1),p("div",qe,A(o.labelValue),1),(n(),r("svg",{"aria-hidden":"true",class:Q(o.label?"show-icon icon":"icon")},Je,2)),o.label?(n(),r("div",Ke,[(n(!0),r(I,null,F(o.labelList,(u,c)=>(n(),r("div",{key:c,class:"select-menu-item",onClick:U=>o.changeSortLabel(u)},A(u),9,Ze))),128))])):k("",!0)])):k("",!0),p("div",He,[p("div",{class:"search-select",onClick:d[1]||(d[1]=H(u=>o.select=!o.select,["stop"]))},[X(A(o.$t("newAdd.sortBy"))+" ",1),p("div",null,[Qe,o.select?(n(),r("img",Xe)):(n(),r("img",Ye))])])])])])]),o.pools.myPositionsLoading&&o.wallet.connected?(n(),r("div",xe,[M(m,{loading:o.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):k("",!0),o.showList&&o.showList.length>0&&o.wallet.connected&&!o.pools.myPositionsLoading?(n(),r("div",eo,[(n(!0),r(I,null,F(o.showList,(u,c)=>(n(),Z(g,{key:c,"p-item":u},null,8,["p-item"]))),128))])):k("",!0),o.showList&&o.showList.length<=0&&!o.pools.myPositionsLoading&&o.wallet.connected?(n(),r("div",oo,[o.store.theme=="default"?(n(),r("img",to)):(n(),r("img",so)),p("span",null,A(o.$t("common.noLiquidityPositions")),1)])):k("",!0),o.wallet.connected?k("",!0):(n(),r("div",ao,[o.store.theme=="default"?(n(),r("img",lo)):(n(),r("img",no)),M(a,{class:"connect-wallet",onClick:d[2]||(d[2]=u=>o.wallet.setIsShowWalletModal(!0))},{default:ke(()=>[X(A(o.$t("button.connectWallet")),1)]),_:1})]))])}const Xo=ye(Ee,[["render",ro],["__scopeId","data-v-07d43f93"]]);export{Xo as default};
