import{a as ye,r as S,s as Mt,m as c,A as oe,b as et,e as xe,l as pt,o as b,f as R,h as t,i as L,q as yt,I as Ue,M as Pt,p as ze,k as We,u as Q,x as O,j as ce,w as se,P as It,N as ht,G as te,F as Ke,E as Ze,B as He,c as ve,$ as Ft,z as At,y as vt,fg as jt,L as Ut,fi as Dt,D as St,Y as Et,C as zt,O as Wt}from"./entry.ec51292c.js";/* empty css              */import{u as $t}from"./useCurrentPosition.ed51d742.js";import{u as Xe}from"./pool.fef7f7f3.js";import{u as Ht}from"./token.5343f0b4.js";import{u as tt,p as Xt,b as ge,C as xt,T as gt,n as Vt,m as Gt}from"./index.1602a5cd.js";import{c as re,g as Jt,n as Yt,d as $e,o as Qt,b as De,a as ee,h as be,p as Ee,i as at}from"./common.923681a5.js";import{a as ft,u as Ae,b as Ve,c as Kt}from"./index.5ec39a2c.js";import{u as Zt}from"./usePoolList.795a237a.js";import{_ as eo}from"./back.80974f79.js";import{I as to}from"./icon-slippage.6bc90e9e.js";import{I as oo,N as Tt,a as bt}from"./input-lock.adda11a5.js";/* empty css              */import{s as Qe,m as no,l as io,b as so,a as ao}from"./transform.c672907f.js";import"./decimal.a2826370.js";import{D as G}from"./decimal.765d8738.js";import{l as lo,a as ro}from"./linearClosed.d07a7d12.js";import{C as pe}from"./coin-img-warning.b8d58195.js";import{P as Ct,N as uo}from"./sui-position-range.120b09d1.js";import{s as mt}from"./formatter.64ddaae3.js";import{u as co}from"./useRate.3578201c.js";import{_ as vo}from"./deposit-ratio.dda29a98.js";import{S as Nt}from"./select-tab.fa0700fd.js";import{T as lt}from"./token-input-block.d550157b.js";/* empty css              */import{u as qt}from"./notifi.87ce3227.js";/* empty css              */import{i as Bt}from"./import-icon.de3e6c66.js";import{_ as mo}from"./apr-tips.ebaad691.js";import{u as fo}from"./farms.e2934ed3.js";import"./usePositionList.5fcb823a.js";import"./useSDK.f15fa82d.js";import"./useToken.15049d74.js";import"./fetchFun.ff4aae28.js";import"./swap-setting.78b1c8a7.js";/* empty css              */import"./icon-error_2x.12260942.js";import"./lock.35e1d915.js";import"./coin-img.bd146cea.js";import"./index.ef83fc04.js";import"./token-dropdown-select.01eaf32a.js";import"./useDebounceFunction.89176ca6.js";import"./useWhale.a622f1b3.js";import"./icon_fee_2x.1f7b0c67.js";import"./icon_rewards_2x.6258c5ab.js";const _o=ye({components:{IconSlippage:to,IconRefresh:oo},props:{poolInfo:{type:Object,default:()=>({})}},setup(e,I){const w=S(!1),W=S(null),M=S(0),o=S(20),s=ft(),h=Ae(),U=S(!1);Mt(()=>{clearInterval(W.value)});const y=()=>{W.value=setInterval(()=>{var A;U.value||M.value<o.value&&(M.value+=1,M.value===o.value&&((A=e==null?void 0:e.poolInfo)!=null&&A.poolAddress&&s.updateCurrentPools(e.poolInfo.poolAddress,h.chainName),M.value=0))},1e3)},f=c(()=>h.slippage),l=()=>{I.emit("clearAll")},r=S(!1),P=()=>{M.value=0,r.value=!0,I.emit("clickRefresh"),setTimeout(()=>{r.value=!1},1e3)};oe(()=>e.poolInfo,A=>{A&&!W.value&&y()},{immediate:!0});const C=et(),E=c(()=>h.chainName);return{clickRefresh:P,isShowSwapSetting:w,countdown:M,autoRefreshTime:o,slippage:f,clearAll:l,checkNullObj:re,router:C,loading:U,chainName:E,refresh:r}}});const po={class:"new-position-title"},ho={class:"left"},go={class:"right"};function bo(e,I,w,W,M,o){const s=eo,h=pt("IconSlippage"),U=pt("IconRefresh");return b(),R("div",po,[t("div",ho,[L(s)]),t("div",go,[L(h),L(U,{refresh:e.refresh,onClickRefresh:e.clickRefresh},null,8,["refresh","onClickRefresh"])])])}const ko=xe(_o,[["render",bo],["__scopeId","data-v-5e7ee742"]]);function kt(e,I,w){const W=new G(10).pow(I-w);return new G(1.0001).pow(e).mul(W)}const wo=ye({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,coinA:{decimal:6},coinB:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,I){const w=S(1),W=S(""),M=S(""),o=c(()=>{var i,p,u;return l.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(p=e.poolInfo)==null?void 0:p.coinA.decimals,(u=e.poolInfo)==null?void 0:u.coinB.decimals).toString()}),s=c(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(o.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(o.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),h=c(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(o.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(o.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),U=Ae(),y=c(()=>U),f=c(()=>y.value.chainName?Ve(y.value.chainName):{}),{TickMath:l,getNearestTickByTick:r}=f.value,P=()=>{const i=w.value/2;w.value=i,A(e.poolInfo,i)},C=()=>{const i=w.value*2;w.value=i,A(e.poolInfo,i)},E=(i=[])=>{let p=6;const u=Math.abs(Number(i[0])-Number(i[i.length-1]));return u>=6?p=0:u>=1?p=1:u>=.1?p=2:u>=.01?p=3:u>=.001?p=4:u>=1e-4?p=5:u>=1e-5?p=6:u>=1e-6?p=7:u>=1e-7&&(p=8),p},A=(i,p=1)=>{if(i&&i.coinA&&!e.chartLoading&&e.minPrice&&e.maxPrice){const u=Number(e.poolInfo.current_tick_index);let B=u+100*p,n=u-100*p,J,g;if(e.maxPrice==="âˆž")g=f.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?g=l.priceToTickIndex(new G(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):g=l.priceToTickIndex(new G(1).div(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{g=443636}if(e.minPrice==="0")J=f.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?J=l.priceToTickIndex(new G(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):J=l.priceToTickIndex(new G(1).div(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{J=-443636}let d=0;if(e.currentPriceTab!=="full range"){if(u>=J&&u<=g){const N=u-J,de=g-u;d=Math.max(Math.abs(N),Math.abs(de))}else u<J?d=Math.abs(g-u):d=Math.abs(u-J);B=u+d+20*p,n=u-d-20*p}else{const N=(Math.abs(u)>5e3,2e4);B=u+N*p,n=u-N*p}n<-443636&&(n=-443636),B>443636&&(B=443636);const $=new G(i.poolLiquidity).div(Math.pow(10,8)).toString(),a=e.tickList,k=[],v=[];let F={};for(let N=0;N<a.length;N++){if(F=a[N],F.index<=u&&F.index>=n){if(k.length<1&&N!==0){const de=a[N-1];k.unshift({...de,index:n})}k.unshift(F)}else if(F.index>u&&F.index<=B&&(v.push(F),k.length<1&&N!==0)){const de=a[N-1];k.push({...de,index:n})}if(F.index>B){const de=a[N];if(v.push({...de,index:B}),k.length<1&&N!==0){const ue=a[N-1];k.push({...ue,index:n})}break}}let K="0";for(let N=k.length-1;N>=0;N--)K=new G(K).plus(new G(k[N].liquidityNet.toString()).div(Math.pow(10,8))).toString(),k[N].liquityAmount=K;let z=$;for(let N=0;N<v.length;N++)z=new G(z).plus(new G(v[N].liquidityNet.toString()).div(Math.pow(10,8))).toString(),v[N].liquityAmount=z;let Y=[];const j=a&&a.length>0?{index:u,liquityAmount:Number($)}:{index:u,liquityAmount:0};(k.length>0||v.length>0)&&(Y=[...k.reverse(),j,...v],e.direction||(Y=Y.reverse()));const ke=[];a.forEach(N=>{ke.push({...N,liquidityGross:N.liquidityGross.toString(),liquidityNet:N.liquidityNet.toString()})}),H(Y,n,B,J,g,u)}};let X=S(!0);yt(()=>{document.body.clientWidth<750?X.value=!1:X.value=!0,window.onresize=()=>{document.body.clientWidth<750?X.value=!1:X.value=!0,A(e.poolInfo,w.value)}});const H=(i,p,u,B,n,J)=>{let g,d;e.direction?(g=e.before7dContractPriceLowest?l.priceToTickIndex(new G(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",d=e.before7dContractPriceHighest?l.priceToTickIndex(new G(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):""):(g=e.before7dContractPriceLowest?l.priceToTickIndex(new G(1).div(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",d=e.before7dContractPriceHighest?l.priceToTickIndex(new G(1).div(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"");const $={top:30,right:35,bottom:20,left:55};let a,k;X.value?(a=590-$.left-$.right,k=205-$.top-$.bottom):(a=340-$.left-$.right,k=205-$.top-$.bottom);const v=u-p,F=parseInt(String(v/4));let K=[p+F/4,p+F,p+2*F,u-F,u-F/4];const z=p,Y=u,j=a/(Y-z);e.currentPriceTab==="full range"&&(K=[p,p+2*F,u]);const ke=K.map(q=>e.direction?kt(q,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString():new G(1).div(kt(q,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)).toString());E(ke),Qe("#chart").selectAll("*").remove();const N=Qe("#chart").attr("width",a+$.left+$.right).attr("height",k+$.top+$.bottom).append("g").attr("transform",`translate(${$.left},${$.right})`),de=no(i,function(q){return Number(Math.abs(q.liquityAmount))})||0,ue=io().range([0,k]).domain([de,0]);so().rangeRound([0,a]).padding(.1);const ne=N.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");y.value.theme=="default"?ne.attr("x",function(q,D){return D===0?0:e.direction?Math.abs(q.index-z)*j:Math.abs(Y-q.index)*j}).attr("y",function(q,D){return e.direction?D===i.length-1?0:ue(q.liquityAmount):D===i.length-1?0:ue(i[D+1].liquityAmount)}).attr("width",function(q,D){return D===0&&i.length===1&&q.liquityAmount>0?a:(e.direction,D!==i.length-1?Math.abs(i[D+1].index-q.index)*j:0)}).attr("height",function(q,D){return D===0&&i.length===1&&q.liquityAmount>0?k:e.direction?D===i.length-1?0:k-ue(q.liquityAmount):D===i.length-1?0:k-ue(i[D+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):ne.attr("x",function(q,D){return D===0?0:e.direction?Math.abs(q.index-z)*j:Math.abs(Y-q.index)*j}).attr("y",function(q,D){return e.direction?D===i.length-1?0:ue(Math.abs(q.liquityAmount)):D===i.length-1?0:ue(Math.abs(i[D+1].liquityAmount))}).attr("width",function(q,D){return D===0&&i.length===1&&q.liquityAmount>0?a:(e.direction,D!==i.length-1?Math.abs(i[D+1].index-q.index)*j:0)}).attr("height",function(q,D){if(D===0&&i.length===1&&q.liquityAmount>0)return k;if(e.direction)return D===i.length-1?0:Number(q.liquityAmount)?k-ue(Math.abs(q.liquityAmount)):0;{if(D===i.length-1)return 0;const Ne=k-ue(Math.abs(i[D+1].liquityAmount));return Number(i[D+1].liquityAmount)?Ne:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const nt=N.append("g");nt.append("line").attr("x1",0).attr("y1",155).attr("x2",a).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),nt.append("g");let Te=0;e.direction?Te=Math.abs(J-z)*j:Te=Math.abs(J-Y)*j,(y.value.theme=="default"?N.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):N.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+Te+", 0)"),Qe("#triangle").attr("width",8).attr("height",4);let rt=[[0,0],[4,4],[8,0]],Fe=lo().x(function(q){return q[0]}).y(function(q){return q[1]}).curve(ro);const ut=Te-4;N.append("path").attr("d",Fe(rt)).style("fill",y.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+ut+", 0)");let he,Pe,je,Ce;e.direction?(he=B<z?-100:parseInt(String(Math.abs(B-z)*j)),Pe=n<z?-100:parseInt(String(Math.abs(n-z)*j)),je=g<z?-100:Math.abs(g-z)*j,Ce=d<z?-100:Math.abs(d-z)*j):(Pe=B<z?-100:Math.abs(Y-B)*j,he=n<z?-100:Math.abs(Y-n)*j,Ce=g<z?-100:Math.abs(Y-g)*j,je=d<z?-100:Math.abs(Y-d)*j),e.minPrice==="0"&&(he=0),e.maxPrice==="âˆž"&&(Pe=a),X.value?W.value=a-he+60+"px":W.value=a-he+52+"px",M.value=Pe+74+"px",g&&je<a&&N.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+je+", 0)"),d&&Ce<a&&N.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Ce+", 0)");const it=ao().extent([[0,0],[a,k]]).handleSize(30).on("end",ct);N.append("g").attr("class","brush").call(it).call(it.move,[he,Pe]);function ct(q){if(!q.sourceEvent||!q.selection)return;X.value?W.value=a-q.selection[0]+60+"px":W.value=a-q.selection[0]+52+"px",M.value=q.selection[1]+74+"px";let D,Ne,m=0,x=0;e.direction?(m=r(parseInt(String(q.selection[0]/j+z)),Number(e.poolInfo.tickSpacing)),D=l.tickIndexToPrice(m,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),x=r(parseInt(String(q.selection[1]/j+z)),Number(e.poolInfo.tickSpacing)),Ne=l.tickIndexToPrice(x,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()):(x=r(Y-q.selection[0]/j,Number(e.poolInfo.tickSpacing)),D=1/l.tickIndexToPrice(x,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),m=r(Y-q.selection[1]/j,Number(e.poolInfo.tickSpacing)),Ne=1/l.tickIndexToPrice(m,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()),I.emit("onChangeMinPrice",String($e(String(D),6))),I.emit("onChangeMaxPrice",String($e(String(Ne),6)))}y.value.theme=="default"?Qe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):Qe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};S(""),oe(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,p,u,B,n])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1125 ~ dataProcessing ~ poolInfo:",i),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ tickList:",n),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ currentPriceTab:",B),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ maxPrice:",u),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ minPrice:",p),i&&p&&u&&B&&n&&n.length>0&&(B!=="Custom"&&console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1131 ~ dataProcessing ~ dataProcessing:"),A(i,w.value))},{immediate:!0});const _=S(!0);return oe(()=>e.chartLoading,(i,p)=>{i!==p&&(_.value=i)},{immediate:!0,deep:!0}),{store:y,loading:_,zoomOut:P,zoomIn:C,rangeSizeLower:s,rangeSizeUpper:h,rangeSizeLowerPosition:W,rangeSizeUpperPosition:M,decimalFormat:Jt,numberformat:Yt}}});const yo=e=>(ze("data-v-70d71659"),e=e(),We(),e),Po={class:"chart-box"},Io={class:"chart"},Ao=yo(()=>t("svg",{id:"chart"},null,-1)),So=[Ao];function $o(e,I,w,W,M,o){return b(),R("div",Po,[Ue(t("div",Io,So,512),[[Pt,!e.loading]])])}const xo=xe(wo,[["render",$o],["__scopeId","data-v-70d71659"]]),ot=e=>(ze("data-v-8cb2b3ff"),e=e(),We(),e),To={class:"new-position-info"},Co={class:"pool-info"},No={class:"info"},qo={class:"coin-logo"},Bo={class:"name-fee"},Lo={class:"name-copy"},Oo=["href"],Ro=ot(()=>t("use",{"xlink:href":"#icon-icon_copy2"},null,-1)),Mo=[Ro],Fo={class:"pool-fee"},jo=ot(()=>t("span",null,"Fee tier",-1)),Uo={class:"price-info"},Do={class:"price-and-chart"},Eo={class:"top"},zo={class:"position-range position-range-warp"},Wo=ot(()=>t("span",{class:"position-range-title"}," Position Range ",-1)),Ho={class:"bottom"},Xo=ot(()=>t("div",{class:"chat-mask"},null,-1)),Vo={class:"lever"},Go={class:"lever-title"},Jo=ot(()=>t("div",{class:"tit"},[t("span",null," Leverage "),t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon_tips"})])],-1)),Yo={class:"lever-text"},Qo=ye({__name:"sui-position-info",setup(e){const I=Xe(),w=c(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:643 ~ currentPositionInfo ~ suiPoolStore.currentPositionInfo:",I.currentPositionInfo),I.currentPositionInfo)),W=c(()=>I.poolsObj),M=Ae(),o=c(()=>M.currentExplorer);S(!0);const s=(l,r)=>l!=="0"&&r!=="âˆž"?De(1/(1-Number((l/r)**.25)),2)+"x":"1x",h=c(()=>w.value.minPrice&&w.value.maxPrice?s(w.value.minPrice,w.value.maxPrice):"--"),U=Ve("Sui"),y=S([]),f=async l=>{const{list:r}=await U.getTicks(l),P=r?U.getTickDataFromUrlData(r):[];console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:593 ~ resetTickList ~ list:",P),y.value=P};return oe(()=>[w.value,W.value],([l,r])=>{l&&!re(l)&&r&&!re(r)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:417 ~ poolsObj:",r),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:418 ~ newValue:",l),f(r[l.pool]))},{immediate:!0}),(l,r)=>{var C,E,A,X,H;const P=It;return b(),R("div",To,[t("div",Co,[t("div",No,[t("div",qo,[L(pe,{"token-info":(C=w.value)==null?void 0:C.coinA},null,8,["token-info"]),L(pe,{"token-info":(E=w.value)==null?void 0:E.coinB},null,8,["token-info"])]),t("div",Bo,[t("div",Lo,[t("a",{class:"position-name",href:Q(Qt)(o.value,"nftAddress",(A=w.value)==null?void 0:A.nftHash),target:"_blank"},O((X=w.value)==null?void 0:X.positionName),9,Oo),(b(),R("svg",{class:"copy-icon","aria-hidden":"true",onClick:r[0]||(r[0]=_=>{var i;return Q(M).copy((i=w.value)==null?void 0:i.nftHash)})},Mo))]),t("div",Fo,[jo,ce(" "+O((H=w.value)==null?void 0:H.feeRate),1)])])]),L(Tt,{"position-info":w.value},null,8,["position-info"])]),t("div",Uo,[t("div",Do,[t("div",Eo,[L(Ct,{"pool-info":w.value},null,8,["pool-info"]),t("div",zo,[Wo,L(uo,{"position-info":w.value},null,8,["position-info"])])]),t("div",Ho,[L(xo,{"pool-info":w.value,"tick-list":y.value,"min-price":w.value.minPrice,"max-price":w.value.maxPrice,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),Xo,t("div",Vo,[t("div",Go,[L(P,{"overlay-class-name":"lever-tooltip ant-tooltip-text-color"},{title:se(()=>[ce("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:se(()=>[Jo]),_:1})]),t("div",Yo,O(h.value),1)])])])])])}}});const Ko=xe(Qo,[["__scopeId","data-v-8cb2b3ff"]]),Ge=e=>(ze("data-v-45b598c8"),e=e(),We(),e),Zo={class:"liquidity-card-box"},en={class:"liquidity-title"},tn={class:"liquidity-usd"},on=Ge(()=>t("span",null,"Liquidity",-1)),nn={class:"liquidity-ratio"},sn={class:"coin-ratio"},an={class:"coin-a-ratio"},ln={class:"coin-b-ratio"},rn={class:"ratio-progress"},un={class:"base-quote-num"},cn={class:"base-coin-num"},dn=Ge(()=>t("span",null,"Base",-1)),vn={class:"token-amount"},mn={key:0,class:"after"},fn={class:"quote-coin-num"},_n=Ge(()=>t("span",null,"Quote",-1)),pn={class:"token-amount"},hn={key:0,class:"after"},gn={class:"pending-yield"},bn={class:"left"},kn=Ge(()=>t("div",{class:"pending-yield-title"},"Pending Yield",-1)),wn={key:0,class:"after"},yn={class:"right"},Pn={class:"fees-rewards"},In={class:"fees-rewards-item"},An=Ge(()=>t("span",null,"Fees",-1)),Sn={class:"token-amount"},$n={key:0,class:"after"},xn=Ge(()=>t("span",null,"Mining Rewards",-1)),Tn={class:"token-amount"},Cn={key:0,class:"after"},Nn=ye({__name:"sui-position-liquidity",setup(e){const I=Ae(),w=tt(),W=c(()=>w),M=Xe(),o=c(()=>M.currentPositionInfo),s=c(()=>M.positionPendingFees[o.value.positionId]),h=c(()=>M.positionPendingRewards[o.value.positionId]),U=c(()=>{var n,J,g,d;let B=be(0);return(n=s==null?void 0:s.value)!=null&&n.feesAmountUSD&&(B=B.add((J=s.value)==null?void 0:J.feesAmountUSD)),(g=h==null?void 0:h.value)!=null&&g.rewardsAmount&&(B=B.add((d=h.value)==null?void 0:d.rewardsAmount)),B.toNumber()}),y=S(!1),{setIsShowSuccess:f,setIsShowRejected:l,setIsShowWaiting:r,setTransactionDesc:P,setTransactionTxid:C}=I,E=Ve("Sui"),{getCurrentPosition:A}=$t(),X=async()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1233 ~ claimFeesAndRewards ~ currentPositionInfo.value:",o.value),y.value=!0;let B={coinTypeA:o.value.defaultCoinaAddress,coinTypeB:o.value.defaultCoinbAddress,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.pool,pos_index:o.value.positionIndex,rewarder_nums:h.value.rewarderAmountOwed.length,collect_fee:!0};B.coinTypeC=h.value.rewarderAmountOwed[0]?h.value.rewarderAmountOwed[0].tokenInfo.address:"",B.coinTypeD=h.value.rewarderAmountOwed[1]?h.value.rewarderAmountOwed[1].tokenInfo.address:"",B.coinTypeE=h.value.rewarderAmountOwed[2]?h.value.rewarderAmountOwed[2].tokenInfo.address:"",r(!0),P();try{let n;B.pos_index=o.value.pos_object_id;const J=await E.getCollectRewarderTransactionPayload(B,o.value),g=await E.signAndExecuteTransactionBlock(W.value.currentWallet,J.txb,J.payloadParams);if(n=E.handleTx(g),n&&n.hash){C(n.hash),r(!1),f(!0);const d={title:"Claim",desc:"",hash:n.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};d.res=n.res,E.showTransitionPending(d),await E.watchTransaction(d)&&(A(o.value.positionId,o.value.positionSource),setTimeout(()=>{E.getAccount(W.value.address),y.value=!1},3e3))}else console.log("0310###toClaimRewards###else###"),r(!1),l(!0),y.value=!1}catch(n){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1225 ~ claimFeesAndRewards ~ error:",n),r(!1),l(!0),y.value=!1}},H=c(()=>M.positionDetailCurrentTab),_=c(()=>M.positionActionFromCoinAmount),i=c(()=>M.positionActionToCoinAmount),p=c(()=>{if(H.value=="increase")return _.value>0?be(o.value.coinaAmount).add(be(_.value)).toString():"";if(_.value>0){const B=be(o.value.coinaAmount).minus(be(_.value)).toString();return B<0?"0":B}else return""}),u=c(()=>{if(H.value=="increase")return i.value>0?be(o.value.coinbAmount).add(be(i.value)).toString():"";if(i.value>0){const B=be(o.value.coinbAmount).minus(be(i.value)).toString();return B<0?"0":B}else return""});return(B,n)=>{var g,d,$,a,k,v,F,K,z,Y,j,ke,N,de,ue,Me;const J=He;return b(),R("div",Zo,[t("div",en,[t("div",tn,[on,t("div",null,"$"+O(o.value.positionAmountUSD),1)]),t("div",nn,[t("div",sn,[t("div",an,[L(pe,{"token-info":(g=o.value)==null?void 0:g.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,O(($=(d=o.value)==null?void 0:d.coinA)==null?void 0:$.symbol),1),t("span",null,O((a=o.value)==null?void 0:a.fromPercent)+"%",1)]),t("div",ln,[L(pe,{"token-info":(k=o.value)==null?void 0:k.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,O((F=(v=o.value)==null?void 0:v.coinB)==null?void 0:F.symbol),1),t("span",null,O((K=o.value)==null?void 0:K.toPercent)+"%",1)])]),t("div",rn,[t("div",{class:"from-percent",style:ht({width:((z=o.value)==null?void 0:z.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:ht({width:((Y=o.value)==null?void 0:Y.toPercent)+"%"})},null,4)])])]),t("div",un,[t("div",cn,[dn,t("div",vn,[L(pe,{"token-info":(j=o.value)==null?void 0:j.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,O(Q(ee)(Q($e)((ke=o.value)==null?void 0:ke.coinaAmount))),1)]),p.value?(b(),R("div",mn,O(Q(ee)(p.value))+" after ",1)):te("",!0)]),t("div",fn,[_n,t("div",pn,[L(pe,{"token-info":(N=o.value)==null?void 0:N.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,O(Q(ee)(Q($e)((de=o.value)==null?void 0:de.coinbAmount))),1)]),u.value?(b(),R("div",hn,O(Q(ee)(u.value))+" after ",1)):te("",!0)])]),t("div",gn,[t("div",bn,[kn,t("div",null,[ce(" $"+O(U.value>0&&U.value<.01?"<0.01":Q(ee)(U.value,2))+" ",1),U.value>0?(b(),R("span",wn,"$0 after")):te("",!0)])]),t("div",yn,[L(J,{class:"claim-all",loading:y.value,disabled:y.value||U.value==0,onClick:X},{default:se(()=>[ce("Claim")]),_:1},8,["loading","disabled"])])]),t("div",Pn,[t("div",In,[(b(!0),R(Ke,null,Ze((ue=s.value)==null?void 0:ue.feesList,ne=>(b(),R("div",{key:ne},[An,t("div",Sn,[L(pe,{"token-info":ne.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,O(Q(mt)(ne.amount,"",ne.tokenInfo.decimals)),1)]),(p.value||u.value)&&!Q(re)(o.value)?(b(),R("div",$n," 0 after ")):te("",!0)]))),128)),(b(!0),R(Ke,null,Ze((Me=h.value)==null?void 0:Me.rewarderAmountOwed,ne=>(b(),R("div",{key:ne},[xn,t("div",Tn,[L(pe,{"token-info":ne.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,O(Q(mt)(ne.amount,"",ne.tokenInfo.decimals)),1)]),(p.value||u.value)&&!Q(re)(o.value)?(b(),R("div",Cn," 0 after ")):te("",!0)]))),128))])])])}}});const wt=xe(Nn,[["__scopeId","data-v-45b598c8"]]);function qn(){const e=Xe(),I=c(()=>e.currentPositionInfo),w=Ae(),W=c(()=>w.slippage);return{preAdd:(o,s)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ currentPositionInfo ~ currentPositionInfo:",I.value),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ preAdd ~ token:",s),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ preAdd ~ amount:",o);const{isReverse:h}=I.value,U=s.address==Xt(I.value.defaultCoinaAddress).full_address;console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:23 ~ preAdd ~ iscoinA:",U);const y=Number(I.value.tickLowerIndex),f=Number(I.value.tickUpperIndex),l=new ge(o),r=!0,P=new ge(I.value.current_sqrt_price);console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:27 ~ preAdd ~ coinAmount:",l.toString());const{liquidityAmount:C,coinAmountA:E,coinAmountB:A}=xt.estLiquidityAndcoinAmountFromOneAmounts(y,f,l,U,r,Number(W.value)/100,P),X=h?I.value.coinB.decimals:I.value.coinA.decimals,H=h?I.value.coinA.decimals:I.value.coinB.decimals;return{tokenMaxA:h?Ee(A.toString(),H):Ee(E.toString(),X),tokenMaxB:h?Ee(E.toString(),X):Ee(A.toString(),H)}}}}const Lt=e=>(ze("data-v-a955ccbe"),e=e(),We(),e),Bn=Lt(()=>t("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Ln={class:"modal-content"},On={class:"pool-info"},Rn={class:"left"},Mn={class:"pool-name"},Fn={class:"right"},jn={class:"coin-info"},Un={class:"from-coin-info"},Dn={class:"left"},En={class:"coin-amount"},zn={class:"coin-symbol"},Wn={class:"right"},Hn={class:"to-coin-info"},Xn={class:"left"},Vn={class:"coin-amount"},Gn={class:"coin-symbol"},Jn={class:"right"},Yn={class:"select-range"},Qn=Lt(()=>t("div",{class:"select-range-title"},"Selected Range",-1)),Kn={class:"price-conent"},Zn={class:"current-price"},ei={class:"price-range-block-content"},ti={class:"price-range-block"},oi={class:"price-item"},ni={class:"title"},ii={class:"price"},si={key:0,class:"text"},ai={key:1,class:"text"},li={class:"price-item"},ri={class:"title"},ui={class:"price"},ci={key:0,class:"text"},di={key:1,class:"text"},vi={class:"deposit-ratio-content"},mi=ye({__name:"increase-liquidity-modal",props:{fromCoinAmount:{type:String,default:"1245566.008946"},toCoinAmount:{type:String,default:"11111111111"},fixedFromCoin:{type:Boolean,default:!0},showFromCoinLock:{type:Boolean,default:!1},showToCoinLock:{type:Boolean,default:!1},positionTotalAmount:{type:Number,default:0},currentPositionInfo:{type:Object,default:()=>({})}},emits:["toAdd"],setup(e,{emit:I}){const w=I,W=S(!0),M=()=>{w("toAdd")};return(o,s)=>{const h=vo,U=He;return b(),ve(Q(Ft),{width:"440px",visible:!0,footer:null,title:"Increase",onCancel:s[0]||(s[0]=y=>o.$emit("onClose"))},{closeIcon:se(()=>[Bn]),default:se(()=>[t("div",Ln,[t("div",On,[t("div",Rn,[L(pe,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),L(pe,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),t("div",Mn,[t("span",null,O(e.currentPositionInfo.coinA.symbol)+"Â -Â ",1),t("span",null,O(e.currentPositionInfo.coinB.symbol),1)])]),t("div",Fn,[ce(" Fee tier "),t("span",null,O(e.currentPositionInfo.feeRate),1)])]),t("div",jn,[t("div",Un,[t("div",Dn,[t("div",En,O(Q(ee)(e.fromCoinAmount)||0),1),t("div",zn,O(e.currentPositionInfo.coinA.symbol),1)]),t("div",Wn,[L(pe,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])]),t("div",Hn,[t("div",Xn,[t("div",Vn,O(Q(ee)(e.toCoinAmount)||0),1),t("div",Gn,O(e.currentPositionInfo.coinB.symbol),1)]),t("div",Jn,[L(pe,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])])]),t("div",Yn,[Qn,L(Tt,{"position-info":e.currentPositionInfo},null,8,["position-info"])]),t("div",Kn,[t("div",Zn,[L(Ct,{"pool-info":e.currentPositionInfo},null,8,["pool-info"])]),t("div",ei,[t("div",ti,[t("div",oi,[t("div",ni,O(o.$t("common.minPrice")),1),t("p",ii,O(e.currentPositionInfo.minPrice),1),W.value?(b(),R("div",si,O(e.currentPositionInfo.coinB.symbol)+" per "+O(e.currentPositionInfo.coinA.symbol),1)):(b(),R("div",ai,O(e.currentPositionInfo.coinA.symbol)+" per "+O(e.currentPositionInfo.coinB.symbol),1))]),t("div",li,[t("div",ri,O(o.$t("common.maxPrice")),1),t("p",ui,O(e.currentPositionInfo.maxPrice),1),W.value?(b(),R("div",ci,O(e.currentPositionInfo.coinB.symbol)+" per "+O(e.currentPositionInfo.coinA.symbol),1)):(b(),R("div",di,O(e.currentPositionInfo.coinA.symbol)+" per "+O(e.currentPositionInfo.coinB.symbol),1))])])])]),t("div",vi,[L(h,{"min-price":e.currentPositionInfo.minPrice,"max-price":e.currentPositionInfo.maxPrice,"pool-info":e.currentPositionInfo,"fixed-from-coin":e.fixedFromCoin,"from-coin":e.currentPositionInfo.coinA,"to-coin":e.currentPositionInfo.coinB,"current-price-tab":"custom",slippage:o.slippage,"current-price":e.currentPositionInfo.currentPrice,"current-price-reverse":e.currentPositionInfo.currentPriceReverse,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"position-total-amount":e.positionTotalAmount,"tick-lower":e.currentPositionInfo.tickLowerIndex,"tick-upper":e.currentPositionInfo.tickUpperIndex},null,8,["min-price","max-price","pool-info","fixed-from-coin","from-coin","to-coin","slippage","current-price","current-price-reverse","from-coin-amount","to-coin-amount","position-total-amount","tick-lower","tick-upper"])])]),L(U,{class:"big-btn modal-bottom-btn",onClick:M},{default:se(()=>[ce(O("Increase Liquidity"))]),_:1})]),_:1})}}});const fi=xe(mi,[["__scopeId","data-v-a955ccbe"]]),_i={class:"new-position-asset-add-box"},pi={class:"add-or-remove"},hi={class:"tab-box"},gi={key:0,class:"from-lock"},bi={key:1,class:"to-lock"},ki={key:2,class:"new-sui-exchange to-add-logo"},wi=t("div",{class:"exchange-new"},[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_add1"})])],-1),yi=[wi],Pi={class:"amount-btn"},Ii={key:2,class:"total-amount"},Ai=t("span",null,"Total Amount",-1),Si=ye({__name:"sui-position-asset-add",setup(e){const I=S(!0),w=S(!1),W=[{name:"Increase",logo:""},{name:"Remove",logo:""}],{t:M}=At(),{getTokenRatePrice:o}=co(),s=tt(),h=c(()=>s),U=Xe(),y=c(()=>U.currentPositionInfo),f=Ae();c(()=>f.slippage);const l=S(),r=S(),P=S(),C=S(),E=S(!0),A=c(()=>h.value.assets&&l.value&&h.value.assets[l.value.address]?Ee(h.value.assets[l.value.address].balance,l.value.decimals):0),X=c(()=>h.value.assets&&r.value&&h.value.assets[r.value.address]?Ee(h.value.assets[r.value.address].balance,r.value.decimals):0);c(()=>y.value.isResever);const H=S(),_=S(),{preAdd:i}=qn(),p=()=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:1021 ~ updateAmounts ~ updateAmounts:"),!y.value||!P.value&&!C.value)return;const g=E.value?P.value:C.value,d=E.value?l.value.decimals:r.value.decimals,$=be(g).mul(G.pow(10,d)).toString(),a=E.value?l.value:r.value,{tokenMaxA:k,tokenMaxB:v}=i($,a);E.value?C.value=v:P.value=k,U.setPositionActionAmount({fromCoinAmount:P,toCoinAmount:C})};oe(()=>y.value,g=>{if(g&&!re(g)){l.value=g.coinA,r.value=g.coinB,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:872 ~ newVal:",g);const{tickUpperIndex:d,tickUpperIndex:$,current_tick_index:a,maxPrice:k}=g;k=="âˆž"||a>=d&&a<$?(H.value=!1,_.value=!1):a>=$?(P.value="",H.value=!0,_.value=!1):a<d?(H.value=!1,_.value=!0,C.value=""):(H.value=!0,P.value="",_.value=!0,C.value=""),p()}},{immediate:!0}),oe(P,(g,d)=>{g&&p(),g==""&&(C.value="")}),oe(C,(g,d)=>{g&&p(),g==""&&(P.value="")});const u=c(()=>{var $,a,k,v;const g=o(($=l==null?void 0:l.value)==null?void 0:$.address,P==null?void 0:P.value,(a=l==null?void 0:l.value)==null?void 0:a.decimals),d=o((k=r==null?void 0:r.value)==null?void 0:k.address,C==null?void 0:C.value,(v=r==null?void 0:r.value)==null?void 0:v.decimals);if(g!=="--"&&d!=="--"){const F=be(g).add(d);return mt(F.toString())}return"--"}),B=c(()=>{const g=Number(P.value)>Number(A.value),d=Number(C.value)>Number(X.value);return!P.value&&!C.value?M("button.enterAmount"):g?M("button.insufficientBalance",{name:l.value.symbol}):d?M("button.insufficientBalance",{name:r.value.symbol}):M("newAdd.addMore")}),n=c(()=>{const g=Number(P.value)>Number(A.value),d=Number(C.value)>Number(X.value);return!!(!P.value&&!C.value||g||d)}),J=S(!1);return(g,d)=>{const $=He;return b(),R("div",_i,[t("div",pi,[t("div",hi,[L(Q(Nt),{"tab-list":W,"current-tab":"Increase",onOnClick:d[0]||(d[0]=a=>{a.name=="Remove"&&Q(U).setPositionDetailCurrentTab("remove")})})]),t("div",{class:vt(["card-container",[I.value?"input-block-add-top":"",w.value?"input-block-add-bottom":""]])},[L(lt,{modelValue:P.value,"onUpdate:modelValue":d[1]||(d[1]=a=>P.value=a),"input-value":P.value,"token-info":l.value||null,"has-arrow":!1,onOnInput:d[2]||(d[2]=a=>{P.value=a}),onOnFocus:d[3]||(d[3]=()=>{E.value=!0,I.value=!0,w.value=!1})},null,8,["modelValue","input-value","token-info"]),L(lt,{modelValue:C.value,"onUpdate:modelValue":d[4]||(d[4]=a=>C.value=a),"input-value":C.value,"token-info":r.value||null,"has-arrow":!1,onOnInput:d[5]||(d[5]=a=>{C.value=a}),onOnFocus:d[6]||(d[6]=()=>{E.value=!1,I.value=!1,w.value=!0})},null,8,["modelValue","input-value","token-info"]),H.value?(b(),R("div",gi,[L(bt,{"from-coin":l.value,"to-coin":r.value},null,8,["from-coin","to-coin"])])):te("",!0),_.value?(b(),R("div",bi,[L(bt,{"from-coin":l.value,"to-coin":r.value},null,8,["from-coin","to-coin"])])):te("",!0),!H.value&&!_.value?(b(),R("div",ki,yi)):te("",!0)],2)]),t("div",Pi,[h.value.connected?(b(),ve($,{key:0,class:"big-btn liquidity-btn",disabled:n.value,loading:g.actionLoading,onClick:d[7]||(d[7]=a=>J.value=!0)},{default:se(()=>[t("span",null,O(B.value),1)]),_:1},8,["disabled","loading"])):(b(),ve($,{key:1,class:"big-btn",onClick:d[8]||(d[8]=a=>h.value.connected?J.value=!0:h.value.setIsShowWalletModal(!0))},{default:se(()=>[t("span",null,O(g.$t("button.connectWallet")),1)]),_:1})),h.value.connected?(b(),R("div",Ii,[Ai,t("span",null,O(u.value),1)])):te("",!0)]),J.value?(b(),ve(fi,{key:0,"current-position-info":y.value,"show-from-coin-lock":H.value,"show-to-coin-lock":_.value,"from-coin-amount":P.value,"to-coin-amount":C.value,onOnClose:d[9]||(d[9]=a=>J.value=!1)},null,8,["current-position-info","show-from-coin-lock","show-to-coin-lock","from-coin-amount","to-coin-amount"])):te("",!0)])}}});const $i={class:"new-position-asset-remove-box"},xi={class:"add-or-remove"},Ti={class:"tab-box"},Ci={key:0,class:"assets-card-mask-from"},Ni={key:1,class:"assets-card-mask-to"},qi={class:"remove-ratio"},Bi=t("div",{class:"remove-ratio-title"},"Amount",-1),Li={class:"remove-ratio-select"},Oi={key:0,class:"ratio"},Ri={key:1,class:"ratio"},Mi={class:"ratio-list"},Fi=["onClick"],ji=ye({__name:"sui-position-asset-remove",setup(e){const I=S(!0),w=S(!1),W=[{name:"Increase",logo:""},{name:"Remove",logo:""}],M=Xe(),o=S(""),s=S(""),h=Ae(),U=c(()=>h);c(()=>U.value.theme);const y=ft(),f=c(()=>y),l=S(!1),r=S(!1),P=S(!0),C=c(()=>U.value.chainName),E=c(()=>C.value?Ve(C.value):{}),A=tt(),X=c(()=>A),H=c(()=>U.value.slippage),_=S(),i=S(),p=c(()=>{var m,x;return(x=(m=n.value)==null?void 0:m.poolInfo)==null?void 0:x.needReverse}),u=c(()=>{var m;return $e(n==null?void 0:n.value.amountA,(m=n==null?void 0:n.value.token_a)==null?void 0:m.decimals)}),B=c(()=>{var m;return $e(n==null?void 0:n.value.amountB,(m=n==null?void 0:n.value.token_b)==null?void 0:m.decimals)}),n=S({}),J=S(!0),g=S({}),d=S(),$=S(),a=S(!0),k=()=>{var Je;if(a.value||!n.value||!o.value&&!s.value||Number(o.value)>Number(u.value)||Number(s.value)>Number(B.value))return;if(o.value==u.value&&s.value==B.value){v.value=100,K({value:1}),a.value=!0;return}const{TickMath:m,TickUtil:x}=E.value;let T=n.value.minPrice,Z=n.value.maxPrice.indexOf("+")>0?"âˆž":n.value.maxPrice,V=Number(n.value.tick_lower_index),ae=Number(n.value.tick_upper_index);const me=Number(n.value.current_tick_index);let le,fe,qe=Number(T).toString(),Be=n.value.maxPrice.indexOf("+")>0||n.value.maxPrice==="âˆž"?"âˆž":Number(Z);if(qe=="0"&&Be=="âˆž"?(V=Number(n.value.tick_lower_index),ae=Number(n.value.tick_upper_index)):(le=m.priceToSqrtPriceX64(new G(T),_.value.decimals,i.value.decimals),fe=m.priceToSqrtPriceX64(new G(Z),_.value.decimals,i.value.decimals)),d.value=V,$.value=ae,Z!=="âˆž"&&V>=ae){l.value=!0,o.value="",r.value=!0,s.value="";return}if(Z=="âˆž"||me>=V&&me<ae){l.value=!1,r.value=!1;let _e;if(o.value||s.value){if(P.value){const Ie=new G(o.value).mul(Math.pow(10,_.value.decimals)).toString();_e=new ge(Ie)}else{const Ie=new G(s.value).mul(Math.pow(10,i.value.decimals)).toString();_e=new ge(Ie)}const{liquidityAmount:Se,tokenMaxA:Le,tokenMaxB:Oe,tokenMaxAOrigin:st,tokenMaxBOrigin:ie}=E.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:_.value,tokenB:i.value,lowerTick:V,upperTick:ae,coinAmount:_e,iscoinA:J.value?P.value:!P.value,roundUp:C.value!="Sui",slippage:Number(H.value)/100,curSqrtPrice:new ge(n.value.current_sqrt_price)});g.value={liquidityAmount:Se,tokenMaxA:Le,tokenMaxB:Oe,tokenMaxAOrigin:st,tokenMaxBOrigin:ie},J.value?P.value?s.value=Number(Oe)>0?Oe:"":o.value=Number(Le)>0?Le:"":P.value?s.value=Le:o.value=Oe}}else if(me>=ae){if(o.value="",l.value=!0,r.value=!1,o.value||s.value){let _e;const Se=new G(s.value).mul(Math.pow(10,(Je=i.value)==null?void 0:Je.decimals)).toString();_e=new ge(Se),g.value={liquidityAmount:Vt(le,fe,_e),tokenMaxA:0,tokenMaxB:s.value}}}else if(me<V){if(l.value=!1,r.value=!0,s.value="",o.value||s.value){let _e;const Se=new G(o.value).mul(Math.pow(10,_.value.decimals)).toString();_e=new ge(Se),g.value={liquidityAmount:Gt(le,fe,_e),tokenMaxA:o.value,tokenMaxB:0}}}else l.value=!0,r.value=!0;a.value=!1,v.value=new G(g.value.liquidityAmount.toString()).div(n.value.liquidity).mul(100).toNumber().toFixed(2),F.value=g.value.liquidityAmount,y.setPositionActionAmount({fromCoinAmount:o,toCoinAmount:s})},v=S(0),F=S("0"),K=m=>{if(console.log("setPercent isSlider.value: ",a.value),!a.value)return;a.value=!0;const x=n.value.token_a.decimals,T=n.value.token_b.decimals,Z=n.value.tick_lower_index,V=n.value.tick_upper_index,ae=gt.tickIndexToSqrtPriceX64(Z),me=gt.tickIndexToSqrtPriceX64(V);let le="";m.value!==1?le=new G(n.value.liquidity).mul(m.value).toString():le=n.value.liquidity,le=De(le,0)||"0",F.value=le;const fe=xt.getCoinAmountFromLiquidity(new ge(le),new ge(n.value.current_sqrt_price),ae,me,C.value!="Sui"),qe=new G(fe.coinA.toString()).div(Math.pow(10,x)).toString(),Be=new G(fe.coinB.toString()).div(Math.pow(10,T)).toString();o.value=Number(qe)>0?qe:"",s.value=Number(Be)>0?Be:"",y.setPositionActionAmount({fromCoinAmount:o,toCoinAmount:s})};oe(()=>f.value.currentPositionInfo,m=>{if(m&&!re(m)){n.value=m,_.value=n.value.token_a,i.value=n.value.token_b,K({value:v.value/100});let x=Number(n.value.tick_lower_index),T=Number(n.value.tick_upper_index);const Z=Number(n.value.current_tick_index);(m.maxPrice.indexOf("+")>0||m.maxPrice==="âˆž"?"âˆž":m.maxPrice)=="âˆž"||Z>=x&&Z<T?(l.value=!1,r.value=!1):Z>=T?(o.value="",l.value=!0,r.value=!1):Z<x?(l.value=!1,r.value=!0,s.value=""):(l.value=!0,o.value="",r.value=!0,s.value=""),k()}},{immediate:!0}),oe(o,(m,x)=>{m&&k(),m==""&&(s.value="",v.value=0)}),oe(s,(m,x)=>{m&&k(),m==""&&(o.value="",v.value=0)});const z=c(()=>f.value.RATES);c(()=>{var ae,me,le,fe;const m=((me=z.value[(ae=_.value)==null?void 0:ae.address])==null?void 0:me.price)||0,x=((fe=z.value[(le=i.value)==null?void 0:le.address])==null?void 0:fe.price)||0,T=new G(m).mul(new G(o.value||0)),Z=new G(x).mul(new G(s.value||0)),V=T.add(Z);return ee(V.toString(),2)});const Y=S(!1),{t:j,locale:ke}=At(),N=c(()=>{const m=Number(o.value)>Number(u.value),x=Number(s.value)>Number(B.value);return!o.value&&!s.value?j("button.enterAmount"):m||x?"Invalid Amount":j("button.remove")}),de=c(()=>{const m=Number(o.value)>Number(u.value),x=Number(s.value)>Number(B.value);return!!(!o.value&&!s.value||m||x)}),{setIsShowSuccess:ue,setIsShowRejected:Me,setIsShowWaiting:ne,setTransactionDesc:nt,setTransactionTxid:Te,setPositiomNum:Ot,setTransactionDescText:rt}=h,Fe=S(!1);oe(v,jt((m,x)=>{m!==x&&(Number(m)>100?v.value=100:m&&n.value?(v.value=m,K({value:v.value/100})):(o.value="",s.value=""))},300)),oe(H,m=>{m&&n.value&&K({value:v.value/100})});const ut=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],he=qt(),Pe=c(()=>he),je=c(()=>Pe.value.status),Ce=S(!1),it=m=>{m.sources.forEach(T=>{const{pool_address:Z,position_index:V}=JSON.parse(T.blockchainAddress);Z==n.value.poolAddress&&Number(V)==Number(n.value.index)&&(Ce.value=!0)})},ct=async()=>{await he.getSources();let m;Pe.value.allSources.forEach(x=>{const{pool_address:T,position_index:Z}=JSON.parse(x.blockchainAddress);T==n.value.poolAddress&&Z==n.value.index&&(m=x.id)}),he.deleteSource(m)};oe(()=>[Pe.value.sourceGroups,n.value],([m,x])=>{m&&m.sources&&m.sources.length>0&&x&&!re(x)&&it(m)},{immediate:!0,deep:!0});const q=et(),D=Ut(),Ne=async()=>{var V,ae,me,le,fe,qe,Be,Je,_e,Se,Le,Oe,st;Fe.value=!0,Te("");const m=ee(o.value,_.value.decimals)==0?"":`${$e(o.value,_.value.decimals)} ${_.value.symbol}`,x=ee(s.value,i.value.decimals)==0?"":`${$e(s.value,i.value.decimals)} ${i.value.symbol}`;nt(j("tips.removeLiquidiyText",{from:p.value?x:m,and:ee(o.value,_.value.decimals)==0||ee(s.value,i.value.decimals)==0?"":"and",to:p.value?m:x})),ne(!0);const T=n.value.poolInfo.rewarder_infos,Z=T&&T.length>0&&C.value=="Sui"||T&&T.length>0&&v.value==100?j("modal.removeLiquidityText1"):j("modal.removeLiquidityText2");rt(Z);try{let ie={};ie={pool:{...n.value.poolInfo,coinA:n.value.token_a,coinB:n.value.token_b},coinTypeA:n.value.poolInfo.coinTypeA,coinTypeB:n.value.poolInfo.coinTypeB,position:n.value,delta_liquidity:v.value==100?new ge(n.value.liquidity):new ge(De(F.value,0)),slippage:Number(H.value),rewards_num:T.length,positionInfo:n.value},ie.coinTypeC=T[0]?T[0].coinAddress:"",ie.coinTypeD=T[1]?T[1].coinAddress:"",ie.coinTypeE=T[2]?T[2].coinAddress:"";const Ie=await E.value.getRemoveLiquidityTransactionPayload(ie);let we;if(C.value==="Aptos")we=await X.value.currentWallet.signAndSubmitTransaction(Ie);else{const Ye=await E.value.signAndExecuteTransactionBlock(X.value.currentWallet,Ie.txb,Ie==null?void 0:Ie.payloadParams);we=E.value.handleTx(Ye),console.log("0331###remove###tx####",we)}if(we&&we.hash){Te(we.hash),ne(!1),ue(!0);const Ye={title:j("common.removeLiquidity"),desc:"",hash:we.hash,descTransactions:`Remove ${o.value} ${(V=_.value)==null?void 0:V.symbol} and ${s.value} ${(ae=i.value)==null?void 0:ae.symbol} 
             from the pool`,sender:X.value.address,chainName:C.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:p.value?`${(le=i.value)==null?void 0:le.address}`:`${(me=_.value)==null?void 0:me.address}`,numa:p.value?`+ ${s.value}`:`+ ${o.value}`,logoa:p.value?f.value.tokensObj&&i.value&&i.value.address&&f.value.tokensObj[i.value.address]&&f.value.tokensObj[i.value.address].logoURI:f.value.tokensObj&&_.value&&_.value.address&&f.value.tokensObj[_.value.address]&&f.value.tokensObj[_.value.address].logoURI,tokenb:p.value?`${(fe=_.value)==null?void 0:fe.address}`:`${(qe=i.value)==null?void 0:qe.address}`,numb:p.value?`+ ${o.value}`:`+ ${s.value}`,logob:p.value?f.value.tokensObj&&_.value&&_.value.address&&f.value.tokensObj[_.value.address]&&f.value.tokensObj[_.value.address].logoURI:f.value.tokensObj&&i.value&&i.value.address&&f.value.tokensObj[i.value.address]&&f.value.tokensObj[i.value.address].logoURI},text:`Withdraw ${o.value} ${(Be=_.value)==null?void 0:Be.symbol} and ${s.value} ${(Je=i.value)==null?void 0:Je.symbol}`};C.value!=="Aptos"&&(Ye.res=we.res),E.value.showTransitionPending(Ye);const _t=await E.value.watchTransaction(Ye);if(T.value&&T.value.length>0&&(Number((_e=T[0])==null?void 0:_e.amount)!==0||ie.coinTypeD&&Number((Se=T[1])==null?void 0:Se.amount)!==0||ie.coinTypeE&&Number((Le=T[2])==null?void 0:Le.amount)!==0)){const dt={title:j("common.removeLiquidity"),desc:"",hash:we.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:T[0].symbol,numa:`+ ${Number(T[0].amount)}`,logoa:f.value.tokensObj&&T[0]&&T[0].address&&f.value.tokensObj[T[0].address]&&f.value.tokensObj[T[0].address].logoURI,tokenb:ie.coinTypeD?T[1].symbol:"",numb:ie.coinTypeD?`+ ${Number(T[1].amount)}`:"",logob:ie.coinTypeD?f.value.tokensObj&&T[1]&&T[1].address&&f.value.tokensObj[T[1].address]&&f.value.tokensObj[T[1].address].logoURI:"",tokenc:ie.coinTypeE?T[2].symbol:"",numc:ie.coinTypeE?`+ ${Number(T[2].amount)}`:"",logoc:ie.coinTypeE?f.value.tokensObj&&T[2]&&T[2].address&&f.value.tokensObj[T[2].address]&&f.value.tokensObj[T[2].address].logoURI:""},text:`Withdraw ${o.value} ${(Oe=_.value)==null?void 0:Oe.symbol} and ${s.value} ${(st=i.value)==null?void 0:st.symbol}`},Rt=await E.value.setTransations(dt)}if(at(n.value.feeOwedA,n.value.token_a.decimals)!==0||at(n.value.feeOwedB,n.value.token_b.decimals)!==0){const dt={title:"Claim",desc:"",hash:we.hash,chainName:C.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${n.value.token_a.symbol}`,numa:ee(n.value.feeOwedA,n.value.token_a.decimals)==0?"":`+ ${at(n.value.feeOwedA,n.value.token_a.decimals)}`,logoa:ee(n.value.feeOwedA,n.value.token_a.decimals)==0?"":f.value.tokensObj&&n.value&&n.value.token_a.address&&f.value.tokensObj[n.value.token_a.address]&&f.value.tokensObj[n.value.token_a.address].logoURI,tokenb:`${n.value.token_b.symbol}`,numb:ee(n.value.feeOwedB,n.value.token_b.decimals)==0?"":`+ ${at(n.value.feeOwedB,n.value.token_b.decimals)}`,logob:ee(n.value.feeOwedB,n.value.token_b.decimals)==0?"":f.value.tokensObj&&n.value&&n.value.token_b.address&&f.value.tokensObj[n.value.token_b.address]&&f.value.tokensObj[n.value.token_b.address].logoURI}},Rt=await E.value.setTransations(dt)}_t&&Number(v.value)==100&&je.value=="authenticated"&&Ce.value&&(await he.subscribePosition({pool_address:n.value.poolAddress,position_index:n.value.index},n.value.nftHash,!1),ct()),_t&&(o.value="",s.value="",setTimeout(()=>{Number(v.value)!==100&&ctx.emit("getDetails")},3e3),setTimeout(()=>{Number(v.value)!==100&&ctx.emit("getDetails")},6e3),Number(v.value)==100&&D.name=="new-position-detail"&&(C.value==="Aptos"?q.push("/position"):q.push("/pool/position")),v.value=0)}else ne(!1),Me(!0);Fe.value=!1}catch(ie){console.log("Remove error",ie),Fe.value=!1,ne(!1),Me(!0)}};return(m,x)=>{const T=Dt,Z=He;return b(),R("div",$i,[t("div",xi,[t("div",Ti,[L(Q(Nt),{"tab-list":W,"current-tab":"Remove",onOnClick:x[0]||(x[0]=V=>{V.name=="Increase"&&Q(M).setPositionDetailCurrentTab("increase")})})]),t("div",{class:vt(["card-container",[I.value?"input-block-add-top":"",w.value?"input-block-add-bottom":""]])},[L(lt,{modelValue:o.value,"onUpdate:modelValue":x[1]||(x[1]=V=>o.value=V),"input-value":o.value,"token-info":_.value||null,"has-arrow":!1,"have-half":!1,onOnInput:x[2]||(x[2]=V=>{o.value=V,P.value=!0,a.value=!1}),onOnFocus:x[3]||(x[3]=()=>{I.value=!0,w.value=!1})},null,8,["modelValue","input-value","token-info"]),L(lt,{modelValue:s.value,"onUpdate:modelValue":x[4]||(x[4]=V=>s.value=V),"input-value":s.value,"token-info":i.value||null,"has-arrow":!1,"have-half":!1,onOnInput:x[5]||(x[5]=V=>{s.value=V,P.value=!1,a.value=!1}),onOnFocus:x[6]||(x[6]=()=>{I.value=!1,w.value=!0})},null,8,["modelValue","input-value","token-info"]),u.value==0?(b(),R("div",Ci)):te("",!0),B.value==0?(b(),R("div",Ni)):te("",!0)],2),t("div",qi,[Bi,t("div",Li,[Number(u.value)>=Number(o.value)&&Number(B.value)>=Number(s.value)?(b(),R("div",Oi,O(v.value>0&&Number(Q(De)(v.value,2))<.01?"<0.01":Q(De)(v.value,2))+"% ",1)):(b(),R("div",Ri," -- ")),t("div",Mi,[(b(),R(Ke,null,Ze(ut,(V,ae)=>t("div",{key:ae,class:vt(["ratio-item",v.value==V.value?"ratio-item-active":""]),onClick:()=>{a.value=!0,v.value=V.value}},O(V.name),11,Fi)),64))])]),L(T,{value:v.value,"onUpdate:value":x[7]||(x[7]=V=>v.value=V)},null,8,["value"])])]),X.value.connected?(b(),ve(Z,{key:0,class:"big-btn liquidity-btn",loading:Fe.value,disabled:de.value,onClick:Ne},{default:se(()=>[t("span",null,O(N.value),1)]),_:1},8,["loading","disabled"])):(b(),ve(Z,{key:1,class:"big-btn",onClick:x[8]||(x[8]=V=>X.value.connected?Y.value=!0:X.value.setIsShowWalletModal(!0))},{default:se(()=>[t("span",null,O(m.$t("button.connectWallet")),1)]),_:1}))])}}});const Ui=ye({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const I=qt(),w=c(()=>I),W=c(()=>w.value.status),M=Ae(),o=S(!1);oe(()=>W.value,y=>{y=="authenticated",o.value=!1},{immediate:!0});const s=S(!1),h=async()=>{s.value=!s.value;const y={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},f=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await I.subscribePosition(y,f,s.value)}catch{s.value=!s.value}},U=y=>{const f=y.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",f),s.value=f.some(l=>JSON.parse(l.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(l.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return et(),oe(()=>[w.value.sourceGroups,e.positionInfo],([y,f])=>{s.value=!1,y&&y.length>0&&y[0]&&f&&!re(f)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),U(y[0]))},{immediate:!0,deep:!0}),{importIcon:Bt,isShowSetUp:o,changeSwitch:h,checked:s,notifiStatus:W,store:M}}});const Di=e=>(ze("data-v-f21d077b"),e=e(),We(),e),Ei={class:"range-alerts"},zi={class:"range-alerts-top"},Wi={class:"title"},Hi=Di(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),Xi={key:1,class:"h5-switch-box"},Vi={class:"range-alerts-bottom"},Gi={key:0,class:"pc-switch-box"};function Ji(e,I,w,W,M,o){const s=He,h=Et;return b(),R("div",Ei,[t("div",zi,[t("div",Wi,[Hi,e.isShowSetUp||e.notifiStatus!=="authenticated"?(b(),ve(s,{key:0,class:"range-alerts-button",onClick:I[0]||(I[0]=St(U=>e.store.setIsShowNotifi(!0),["stop"]))},{default:se(()=>[ce(" Set up ")]),_:1})):te("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(b(),R("div",Xi,[L(h,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):te("",!0)])]),t("div",Vi,[ce(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(b(),R("div",Gi,[L(h,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):te("",!0)])])}const Yi=xe(Ui,[["render",Ji],["__scopeId","data-v-f21d077b"]]),Qi=ye({setup(){const e=ft(),I=c(()=>e),w=fo(),W=c(()=>w),M=et(),o=c(()=>I.value.currentPositionInfo),s=S(),h=$=>{var a;return((a=I.value.tokensObj[$])==null?void 0:a.logo_url)||Bt("/image/coins/sui-unknown.png")},U=Kt("Sui"),y=S(),f=async $=>{y.value=0;try{const a=await U.calculateFarmingRewards([{pool_id:$.pool_id,position_nft_id:$.id}]),k=[];let v=new G(0);a[$.id].forEach((F,K)=>{var j;const z=(j=I.value.tokensObj[F.rewarder_type])==null?void 0:j.decimals;let Y=new G(F.rewarder_amount).div(Math.pow(10,z)).toString();Number(Y)>0&&r.value.rewarders[K]&&(v=v.add(Y),k.push({...F,rewarderAmount:Y,rewarderAmountPer:Y}))}),y.value=v,s.value=k}catch(a){console.log(a,"getRewarder")}},l=c(()=>W.value.farmsPoolObj),r=c(()=>l.value[o.value.poolAddress]);oe(()=>[o.value,l.value,r.value],([$,a,k])=>{var v;!re($)&&$.positionSource=="farming"&&!re(k)?f($):!re(a)&&!re($)&&(s.value=(v=a[$.poolAddress])==null?void 0:v.rewarders)},{immediate:!0});const P=tt(),C=c(()=>P),E=Ae(),A=Ve("Sui"),{setIsShowSuccess:X,setIsShowRejected:H,setIsShowWaiting:_,setTransactionDesc:i,setTransactionTxid:p}=E,u=S(!1),B=async()=>{u.value=!0,p(""),i("Claim rewards"),_(!0);const $={pool_id:o.value.pool_id,position_nft_id:o.value.id};try{const a=await U.harvestFarms($),k=await A.signAndExecuteTransactionBlock(C.value.currentWallet,a.txb,a.payloadParams);console.log("0221###sui swap res###",k);let v=A.handleTx(k);if(v&&v.hash){p(v.hash),_(!1),X(!0);let F={title:"Claim",res:v.res,hash:v.hash};A.showTransitionPending(F),await A.watchTransaction(F)&&setTimeout(()=>{f(o.value),A.getAccount(C.value.address)},2e3)}else _(!1),H(!0);u.value=!1}catch(a){console.log("farmsDeposit error",a),_(!1),H(!0),u.value=!1}},n=async()=>{u.value=!0,p(""),i(`Unstake ${o.value.name}`),_(!0);const $=o.value.pool_id,a=o.value.id;try{const k=await U.farmsWithdraw($,a),v=await A.signAndExecuteTransactionBlock(C.value.currentWallet,k.txb,k.payloadParams);console.log("0221###sui swap res###",v);let F=A.handleTx(v);if(F&&F.hash){p(F.hash),_(!1),X(!0);let K={res:F.res,title:"Unstake",hash:F.hash};A.showTransitionPending(K),await A.watchTransaction(K)&&setTimeout(()=>{M.replace(`/new-position-detail?token=${o.value.tokenName}&address=${o.value.clmm_pool_id}&pos=${o.value.clmm_position_id}`),I.value.setCurrentPositionInfo(o.value.clmm_pool_id,"",o.value.tokenName,"Sui",o.value.clmm_position_id),y.value=0,u.value=!1},2e3)}else _(!1),H(!0)}catch(k){console.log("farmsDeposit error",k),_(!1),H(!0),u.value=!1}},J=async()=>{u.value=!0,p(""),i(`Stake ${o.value.name}`),_(!0);const $={clmm_pool_id:o.value.poolAddress,clmm_position_id:o.value.pos_object_id,coinTypeA:o.value.coin_type_a,coinTypeB:o.value.coin_type_b},a=l.value[o.value.poolAddress].id;try{const k=await U.farmsDeposit($,a),v=await A.signAndExecuteTransactionBlock(C.value.currentWallet,k.txb,k.payloadParams);console.log("0221###sui swap res###",v);let F=A.handleTx(v);if(F&&F.hash){p(F.hash),_(!1),X(!0);let K={res:F.res,title:"Staked",hash:F.hash};A.showTransitionPending(K);const z=await A.watchTransaction(K,!0);let Y;z!=null&&z.status&&setTimeout(async()=>{var j,ke;(ke=(j=z==null?void 0:z.res)==null?void 0:j.events)==null||ke.forEach(N=>{N.type.indexOf("::pool::DepositEvent")>-1&&(Y=N.parsedJson.wrapped_position_id)}),M.replace(`/new-position-detail?position_nft_id=${Y}&positionSource=farming`),await I.value.setCurrentPositionInfo("","","","Sui",Y,"farming"),u.value=!1},2e3)}else _(!1),H(!0)}catch(k){console.log("farmsDeposit error",k),_(!1),H(!0),u.value=!1}},g=c(()=>E),d=c(()=>g.value.addressLpTokens);return{getCoinIcon:h,rewardList:s,sFixD:De,addCommom:ee,claim:B,unStake:n,loading:u,totalRewardAmount:y,currentPositionInfo:o,stake:J,farmsPoolObj:l,addressLpTokens:d,farmsPoolInfo:r}}});const Re=e=>(ze("data-v-8a2c6b44"),e=e(),We(),e),Ki={key:0,class:"farms-position-detail-box"},Zi={class:"farms-top"},es=Re(()=>t("div",{class:"left"},[t("div",{class:"title"},"Farming"),t("div",{class:"desc"},"Stake Position to Earn")],-1)),ts={class:"right"},os={class:"apr"},ns={class:"apr-tips-box"},is=Re(()=>t("span",null,"View",-1)),ss=Re(()=>t("svg",{class:"arrow-icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_arrow"})],-1)),as=[is,ss],ls={class:"farms-bottom"},rs=Re(()=>t("div",{class:"title"},"Farming Rewards",-1)),us={key:0,class:"reward-list"},cs={key:0,class:"rewards-item-bg"},ds={class:"rewards-item-box"},vs={alt:""},ms={key:1},fs={class:"rewards-item-bg"},_s={class:"rewards-item-box"},ps={alt:""},hs=Re(()=>t("span",null,"0",-1)),gs={key:1,class:"reward-list"},bs={key:0,class:"rewards-item-bg"},ks={class:"rewards-item-box"},ws={alt:""},ys=Re(()=>t("span",null,"0",-1)),Ps={key:1},Is={class:"rewards-item-bg"},As={class:"rewards-item-box"},Ss={alt:""},$s=Re(()=>t("span",null,"0",-1)),xs={class:"actions-box"};function Ts(e,I,w,W,M,o){var f,l,r;const s=mo,h=He,U=It,y=zt("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(b(),R("div",Ki,[t("div",Zi,[es,t("div",ts,[t("div",os,[ce(" APRÂ  "),t("span",null,[ce(O(("addCommom"in e?e.addCommom:Q(ee))(((f=e.farmsPoolInfo)==null?void 0:f.total_apr)*100,2))+"%Â  ",1),t("div",ns,[L(s,{"l-item":e.farmsPoolInfo,"rewarder-info":(r=(l=e.farmsPoolInfo)==null?void 0:l.rewarder)==null?void 0:r.rewardList},null,8,["l-item","rewarder-info"])])])]),t("div",{class:"view",onClick:I[0]||(I[0]=P=>e.$router.push("/farms"))},as)])]),t("div",ls,[rs,e.rewardList&&e.rewardList.length>0?(b(),R("div",us,[(b(!0),R(Ke,null,Ze(e.rewardList,P=>(b(),R("div",{key:P,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(b(),R("div",cs,[t("div",ds,[Ue(t("img",vs,null,512),[[y,e.getCoinIcon(P.rewarder_type)]]),t("span",null,O(("addCommom"in e?e.addCommom:Q(ee))(P.rewarderAmount||0)),1)])])):(b(),R("div",ms,[t("div",fs,[t("div",_s,[Ue(t("img",ps,null,512),[[y,e.getCoinIcon(P.reward_coin)]]),hs])])]))]))),128))])):(b(),R("div",gs,[(b(!0),R(Ke,null,Ze(e.currentPositionInfo.rewards,P=>(b(),R("div",{key:P,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(b(),R("div",bs,[t("div",ks,[Ue(t("img",ws,null,512),[[y,e.getCoinIcon(P.rewarder_type)]]),ys])])):(b(),R("div",Ps,[t("div",Is,[t("div",As,[Ue(t("img",Ss,null,512),[[y,e.getCoinIcon(P.reward_coin)]]),$s])])]))]))),128))])),t("div",xs,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(b(),ve(h,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:se(()=>[ce("Unstake")]),_:1},8,["loading","onClick"])):te("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(b(),ve(U,{key:1},{title:se(()=>[ce("Farming rewards are only available for active positions.")]),default:se(()=>[L(h,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:se(()=>[ce("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(b(),ve(h,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:se(()=>[ce("Stake")]),_:1},8,["loading","onClick"])):te("",!0),L(h,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:St(e.claim,["stop"])},{default:se(()=>[ce("Claim")]),_:1},8,["loading","disabled","onClick"])])])])):te("",!0)}const Cs=xe(Qi,[["render",Ts],["__scopeId","data-v-8a2c6b44"]]),Ns={class:"new-position-detail"},qs={class:"new-position-content"},Bs={class:"left"},Ls={class:"right"},Os={class:"loading-global"},Rs=ye({__name:"new-position-detail-sui",setup(e){const I=et(),{getCurrentPosition:w}=$t(),{getPoolList:W}=Zt(),M=S(),o=S();yt(()=>{M.value=I.currentRoute.value.query.id||"",o.value=I.currentRoute.value.query.positionSource||""});const s=Xe(),h=c(()=>s.poolsObj),U=Ht(),y=c(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:293 ~ allTokensObj ~ suiTokenStore.allTokensObj:",U.allTokensObj),U.allTokensObj));oe(()=>y.value,A=>{A&&!re(A)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:298 ~ watch ~ getPoolList:"),W())},{immediate:!0}),oe(()=>[h.value,y.value,M.value,o.value],([A,X,H,_])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ positionSource:",_),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ routerId:",H),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ allTokensObj:",X),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ poolsObj:",A),A&&!re(A)&&X&&!re(X)&&H&&_&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:38 ~ getCurrentPosition:"),w(H,_))},{immediate:!0});const f=tt(),l=c(()=>f),r=Ve("Sui"),P=()=>{w(M.value,o.value),l.value.address&&r.getAccount(l.value.address)},C=c(()=>s.currentPositionLoading),E=c(()=>s.positionDetailCurrentTab);return(A,X)=>{const H=Wt;return b(),R("div",Ns,[L(ko,{onClickRefresh:P}),t("div",qs,[t("div",Bs,[L(Ko),L(wt,{class:"pc-module",onGetDetails:A.getDetails},null,8,["onGetDetails"])]),t("div",Ls,[E.value=="increase"?(b(),ve(Si,{key:0,onGetDetails:A.getDetails},null,8,["onGetDetails"])):(b(),ve(ji,{key:1,onGetDetails:A.getDetails},null,8,["onGetDetails"])),L(wt,{class:"h5-module",onGetDetails:A.getDetails},null,8,["onGetDetails"]),L(Cs),A.positionInfo&&A.positionInfo.minPrice!=="0"&&A.positionInfo.maxPrice!=="âˆž"?(b(),ve(Yi,{key:2,"position-info":A.positionInfo},null,8,["position-info"])):te("",!0)])]),Ue(t("div",Os,[L(H)],512),[[Pt,C.value]])])}}});const xa=xe(Rs,[["__scopeId","data-v-f5850fb7"]]);export{xa as default};
