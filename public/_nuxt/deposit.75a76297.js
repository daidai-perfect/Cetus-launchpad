import{a as rt,r as S,m as f,q as Et,A as Ce,e as st,o as j,f as Z,I as ii,M as ni,h as s,N as Ot,x as B,u as ce,G as Ie,c as dt,p as It,k as Ct,O as Dt,z as Ht,L as Ft,s as Xt,l as Se,i as re,y as ut,F as $t,E as Bt,j as vt,S as oi,Y as Wt,w as it,P as xt,$ as ai,b as Zt,B as Gt,a0 as ri}from"./entry.41ea690b.js";/* empty css              */import{positionError as ct,fromCoin as y,toCoin as h,tickList as lt,currentPrice as ft,currentPriceReverse as wt,direction as ye,currentPriceTab as W,defaultMinPrice as qt,defaultMaxPrice as Nt,minPrice as P,maxPrice as p,toggle as Jt,isStableFarmingRange as Re,isInputTotalAmount as Xe,priceConfigObj as at,fromCoinAmount as M,toCoinAmount as F,fixedFromCoin as Oe,resetTickList as Ut,resetData as si}from"./data.45bc77ff.js";import{g as Kt,n as Mt,d as de,a as Te,c as se,b as Yt,o as li,s as ui,p as jt}from"./common.2aa2b559.js";/* empty css              */import"./index.4014d28e.js";/* empty css              */import{u as mt,b as Rt,a as St}from"./index.46f67f5f.js";import{T as _t,g as ci,c as di,u as vi,b as je}from"./index.e4df0a82.js";import"./decimal.a2826370.js";import{s as Pt,m as mi,l as fi,b as gi,a as pi}from"./transform.c672907f.js";import{D as m}from"./decimal.765d8738.js";import{R as bi,c as ki,S as hi,a as yi,b as _i}from"./sui-liquidity-price.34594981.js";import{i as gt}from"./import-icon.de3e6c66.js";import{u as Tt}from"./farms.53913d54.js";import{_ as Qt}from"./icon_farms_2x.963970c1.js";import{_ as Pi}from"./coin-select.edb420f6.js";import{I as wi}from"./icon-tooltip.94816a6b.js";import{_ as Ii}from"./status-block.ef2e5142.js";import{C as Ci}from"./coin-img.fde2782e.js";import{_ as Vt}from"./icon-arrow_2x.4ffddb8e.js";import{I as Si}from"./input-lock.f03e4f46.js";import{u as Ti}from"./notifi.70321ead.js";import{T as Ai}from"./token-input-block.f0253fa7.js";import{_ as Li}from"./lock.35e1d915.js";import"./icon-slippage.b3a43c28.js";import"./swap-setting.16836ae6.js";/* empty css              */import"./icon-error_2x.afe4a211.js";import"./icon-refresh.b0624677.js";import"./coin-img-warning.89bc8123.js";import"./token.a65c225b.js";import"./deposit-ratio.c1856f66.js";import"./sui-status-block.7aa30cba.js";import"./token-warning_2x.400e5e4b.js";import"./img-no-Positions_2x.1a7adfb3.js";import"./img-no-Positions_2x.69186996.js";import"./useWhale.63a5ed1d.js";import"./token-dropdown-select.13dd259c.js";import"./useDebounceFunction.eab2bf30.js";function zt(e,d,G){const x=new m(10).pow(d-G);return new m(1.0001).pow(e).mul(x)}const qi=rt({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,d){const G=S(""),x=S(""),T=f(()=>{var a,k,l,H,X,ve;return(a=e.poolInfo)!=null&&a.current_sqrt_price&&((k=e.poolInfo)!=null&&k.coinA)&&((l=e.poolInfo)!=null&&l.coinB)?n.sqrtPriceX64ToPrice((H=e.poolInfo)==null?void 0:H.current_sqrt_price,(X=e.poolInfo)==null?void 0:X.coinA.decimals,(ve=e.poolInfo)==null?void 0:ve.coinB.decimals).toString():"0"}),Q=f(()=>{let a=0;return e.direction?a=(Number(e.minPrice)/Number(T.value)-1)*100:a=(Number(e.minPrice)/Number(1/Number(T.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),A=f(()=>{let a=0;return e.direction?a=(Number(e.maxPrice)/Number(T.value)-1)*100:a=(Number(e.maxPrice)/Number(1/Number(T.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),L=mt(),_=f(()=>L),J=f(()=>_.value.chainName?Rt(_.value.chainName):{}),{TickMath:n,getNearestTickByTick:g}=J.value,q=(a=[])=>{let k=6;const l=Math.abs(Number(a[0])-Number(a[a.length-1]));return l>=6?k=0:l>=1?k=1:l>=.1?k=2:l>=.01?k=3:l>=.001?k=4:l>=1e-4?k=5:l>=1e-5?k=6:l>=1e-6?k=7:l>=1e-7&&(k=8),k},U=(a,k=1)=>{if(a&&a.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const l=Number(e.poolInfo.current_tick_index);let H=l+100*k,X=l-100*k,ve,b;if(e.maxPrice==="âˆž")b=J.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?b=n.priceToTickIndex(new m(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):b=n.priceToTickIndex(new m(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{b=443636}if(e.minPrice==="0")ve=J.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ve=n.priceToTickIndex(new m(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ve=n.priceToTickIndex(new m(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ve=-443636}let ge=0;if(e.currentPriceTab!=="full range"){if(l>=ve&&l<=b){const w=l-ve,V=b-l;ge=Math.max(Math.abs(w),Math.abs(V))}else l<ve?ge=Math.abs(b-l):ge=Math.abs(l-ve);H=l+ge+100*k,X=l-ge-100*k}else{const w=(Math.abs(l)>5e3,2e4);H=l+w*k,X=l-w*k}X<-443636&&(X=-443636),H>443636&&(H=443636);const K=new m(a.liquidity).div(Math.pow(10,8)).toString(),$=e.tickList,C=[],te=[];let pe={};for(let w=0;w<$.length;w++){if(pe=$[w],pe.index<=l&&pe.index>=X){if(C.length<1&&w!==0){const V=$[w-1];C.unshift({...V,index:X,source:"left"})}C.unshift(pe)}else if(pe.index>l&&pe.index<=H&&(te.push(pe),C.length<1&&w!==0)){const V=$[w-1];C.push({...V,index:X,source:"left"})}if(pe.index>H){const V=$[w];if(te.push({...V,index:H,source:"right"}),C.length<1&&w!==0){const ze=$[w-1];C.push({...ze,index:X,source:"left"})}break}}let R="0";for(let w=C.length-1;w>=0;w--)R=new m(R).plus(new m(C[w].liquidityNet.toString()).div(Math.pow(10,8))).toString(),C[w].liquityAmount=R;let N=K;for(let w=0;w<te.length;w++)N=new m(N).plus(new m(te[w].liquidityNet.toString()).div(Math.pow(10,8))).toString(),te[w].liquityAmount=N;let ie=[];const z=$&&$.length>0?{index:l,liquityAmount:Number(K)}:{index:l,liquityAmount:0};(C.length>0||te.length>0)&&(ie=[...C.reverse(),z,...te],e.direction||(ie=ie.reverse()));const Ae=[];$.forEach(w=>{Ae.push({...w,liquidityGross:w.liquidityGross.toString(),liquidityNet:w.liquidityNet.toString()})}),O(ie,X,H,ve,b,l)}};let ee=S(!1);const _e=S(!1);Et(()=>{const a=document.body.clientWidth;_e.value=!0,a<750?ee.value=!1:ee.value=!0,window.onresize=()=>{document.body.clientWidth<750?ee.value=!1:ee.value=!0,U(e.poolInfo,e.zoom)}});const O=(a,k,l,H,X,ve)=>{let b,ge;e.direction?(b=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new m(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ge=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new m(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(b=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new m(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ge=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new m(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const K={top:30,right:35,bottom:58,left:80};let $,C;ee.value?($=528-K.left-K.right,C=242-K.top-K.bottom):($=340-K.left-K.right,C=205-K.top-K.bottom);const te=l-k,pe=parseInt(String(te/4));let R=[k+pe/4,k+pe,k+2*pe,l-pe,l-pe/4];const N=k,ie=l,z=$/(ie-N);e.currentPriceTab==="full range"&&(R=[k,k+2*pe,l]);const Ae=R.map(o=>e.direction?zt(o,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new m(1).div(zt(o,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),w=q(Ae);Pt("#chart").selectAll("*").remove();const V=Pt("#chart").attr("width",$+K.left+K.right).attr("height",C+K.top+K.bottom).append("g").attr("transform",`translate(${K.left},${K.right})`),ze=mi(a,function(o){return Number(Math.abs(o.liquityAmount))})||0,Le=fi().range([0,C]).domain([ze,0]);gi().rangeRound([0,$]).padding(.1);const Ge=V.append("g").attr("id","barsBox").selectAll("rect").data(a).enter().append("rect");_.value.theme=="default"?Ge.attr("x",function(o,r){return r===0?0:e.direction?Math.abs(o.index-N)*z:Math.abs(ie-o.index)*z}).attr("y",function(o,r){return e.direction?r===a.length-1?0:Le(o.liquityAmount):r===a.length-1?0:Le(a[r+1].liquityAmount)}).attr("width",function(o,r){return r===0&&a.length===1&&o.liquityAmount>0?$:(e.direction,r!==a.length-1?Math.abs(a[r+1].index-o.index)*z:0)}).attr("height",function(o,r){return r===0&&a.length===1&&o.liquityAmount>0?C:e.direction?r===a.length-1?0:C-Le(o.liquityAmount):r===a.length-1?0:C-Le(a[r+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Ge.attr("x",function(o,r){return r===0?0:e.direction?Math.abs(o.index-N)*z:Math.abs(ie-o.index)*z}).attr("y",function(o,r){return e.direction?r===a.length-1?0:Le(Math.abs(o.liquityAmount)):r===a.length-1?0:Le(Math.abs(a[r+1].liquityAmount))}).attr("width",function(o,r){return r===0&&a.length===1&&o.liquityAmount>0?$:(e.direction,r!==a.length-1?Math.abs(a[r+1].index-o.index)*z:0)}).attr("height",function(o,r){if(r===0&&a.length===1&&o.liquityAmount>0)return C;if(e.direction)return r===a.length-1?0:Number(o.liquityAmount)?C-Le(Math.abs(o.liquityAmount)):0;{if(r===a.length-1)return 0;const E=C-Le(Math.abs(a[r+1].liquityAmount));return Number(a[r+1].liquityAmount)?E:0}}).attr("fill",function(o,r){return"#417494"}).attr("class","bars").attr("stroke-width",1).attr("stroke",function(o,r){return"#417494"});const Ee=V.append("g");Ee.append("line").attr("x1",0).attr("y1",155).attr("x2",$).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const nt=Ee.append("g");let Be=0;if(e.direction){for(let o=0;o<R.length;o++){const r=de(Ae[o],w)||"0";Ae.push(r);const E=Math.abs(R[o]-N)*z;let D=0;for(let ne=0;ne<r.length;ne++)r[ne]==="1"?D+=4.02:r[ne]==="."?D+=2.64:r[ne]==="7"?D+=5.48:D+=6;nt.append("text").text(r).attr("x",E-D/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}Be=Math.abs(ve-N)*z}else{for(let o=R.length-1;o>=0;o--){const r=de(Ae[o],w)||0;Ae.push(r);const E=Math.abs(R[o]-ie)*z;let D=0;for(let ne=0;ne<r.length;ne++)r[ne]==="1"?D+=4.02:r[ne]==="."?D+=2.64:r[ne]==="7"?D+=5.48:D+=6;nt.append("text").text(r).attr("x",E-D/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}Be=Math.abs(ve-ie)*z}(_.value.theme=="default"?V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+Be+", 0)");let De,We,xe,He;e.direction?(De=H<N?-100:parseInt(String(Math.abs(H-N)*z)),We=X<N?-100:parseInt(String(Math.abs(X-N)*z)),xe=b<N?-100:Math.abs(b-N)*z,He=ge<N?-100:Math.abs(ge-N)*z):(We=H<N?-100:Math.abs(ie-H)*z,De=X<N?-100:Math.abs(ie-X)*z,He=b>ie?-100:Math.abs(ie-b)*z,xe=ge>ie?-100:Math.abs(ie-ge)*z),e.minPrice==="0"&&(De=0),e.maxPrice==="âˆž"&&(We=$),ee.value?G.value=$-De+94+"px":G.value=$-De+87+"px",x.value=We+98+"px",b&&xe<$&&V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+xe+", 0)"),ge&&He<$&&V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+He+", 0)");const qe=V.append("g").attr("id","left-handle"),t=V.append("g").attr("id","right-handle");_.value.theme=="default"?(qe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),qe.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(-1, 20) rotate(180)"),qe.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),qe.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),t.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(1, 0)"),t.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),t.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(qe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),qe.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(-1, 24) rotate(180)"),qe.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),qe.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),t.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(1, 0)"),t.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),t.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),qe.attr("transform","translate("+De+", 0)"),t.attr("transform","translate("+We+", 0)");const c=pi().extent([[0,0],[$,C]]).handleSize(30).on("end",I);V.append("g").attr("class","brush").call(c).call(c.move,[De,We]);function I(o){if(!o.sourceEvent||!o.selection)return;qe.attr("transform","translate("+o.selection[0]+", 0)"),t.attr("transform","translate("+o.selection[1]+", 0)"),ee.value,G.value=$-o.selection[0]+87+"px",x.value=o.selection[1]+74+"px";let r,E,D=0,ne=0;e.direction?(D=g(parseInt(String(o.selection[0]/z+N)),Number(e.poolInfo.tickSpacing)),r=n.tickIndexToPrice(D,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ne=g(parseInt(String(o.selection[1]/z+N)),Number(e.poolInfo.tickSpacing)),E=n.tickIndexToPrice(ne,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(ne=g(ie-o.selection[0]/z,Number(e.poolInfo.tickSpacing)),r=1/n.tickIndexToPrice(ne,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),D=g(ie-o.selection[1]/z,Number(e.poolInfo.tickSpacing)),E=1/n.tickIndexToPrice(D,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),d.emit("onChangeMinPrice",String(de(String(r),6))),d.emit("onChangeMaxPrice",String(de(String(E),6)))}_.value.theme=="default"?Pt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):Pt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};return S(""),Ce(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom,e.tickList],([a,k,l,H,X,ve])=>{a&&k&&l&&(a!=null&&a.liquidity)&&U(a,X)},{immediate:!0}),{store:_,loading:_e,rangeSizeLower:Q,rangeSizeUpper:A,rangeSizeLowerPosition:G,rangeSizeUpperPosition:x,decimalFormat:Kt,numberformat:Mt}}});const Ni=e=>(It("data-v-edb98a83"),e=e(),Ct(),e),$i={class:"chart-box"},Mi={class:"chart"},Fi=Ni(()=>s("svg",{id:"chart"},null,-1));function Ri(e,d,G,x,T,Q){const A=Dt;return j(),Z("div",$i,[ii(s("div",Mi,[e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(j(),Z("div",{key:0,class:"range-size range-size-lower",style:Ot({right:e.rangeSizeLowerPosition})},B(("numberformat"in e?e.numberformat:ce(Mt))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):Ie("",!0),e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(j(),Z("div",{key:1,class:"range-size range-size-upper",style:Ot({left:e.rangeSizeUpperPosition})},B(("numberformat"in e?e.numberformat:ce(Mt))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):Ie("",!0),Fi],512),[[ni,!e.chartLoading]]),e.chartLoading?(j(),dt(A,{key:0})):Ie("",!0)])}const Oi=st(qi,[["render",Ri],["__scopeId","data-v-edb98a83"]]),Bi=rt({components:{SuiLiquidityD3Chart:Oi,RectangleTab:bi,SuiLiquidityPrice:ki},setup(){var qe;const{t:e,locale:d}=Ht(),G=S("liquidity"),x=mt(),T=f(()=>x),Q=f(()=>T.value.chainName),A=St(),L=f(()=>A),_=f(()=>T.value.chainName?Rt(T.value.chainName):{});Et(()=>{ct.value=!1});const J=Ft(),n=f(()=>{let t=null;for(let c=0;c<L.value.poolConfigList.length;c++){const I=L.value.poolConfigList[c];I.address==J.query.poolAddress&&(t=I)}return t}),g=f(()=>{let t=null;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-left.vue:481 ~ constpoolInfo:any=computed ~ pools.value.poolsObj:",L.value.poolsObj);for(const c in L.value.poolsObj){const I=L.value.poolsObj[c];I.address==J.query.poolAddress&&(t=I)}return t}),q=S(),U=S(!0),ee=async(t,c)=>{var I,o,r,E,D,ne,Ve,ot,Je,et,bt,kt;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-left.vue:497 ~ watchPoolInfo ~ pool:",t),t&&(y.value=t.needReverse?t.token_b:t.token_a,h.value=t.needReverse?t.token_a:t.token_b),c&&t.current_tick_index){U.value=!0,lt.value=[],O.value=[],Re.value=!1;const ht=t.token_a.decimals,At=t.token_b.decimals;ft.value=_t.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((I=t==null?void 0:t.object)==null?void 0:I.current_sqrt_price),ht,At).toString(),wt.value=new m(1).div(_t.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((o=t==null?void 0:t.object)==null?void 0:o.current_sqrt_price),ht,At)).toString(),q.value=t.needReverse,((E=(r=t==null?void 0:t.token_a)==null?void 0:r.address)==null?void 0:E.toLowerCase())===((Ve=(ne=(D=y)==null?void 0:D.value)==null?void 0:ne.address)==null?void 0:Ve.toLowerCase())&&((Je=(ot=t==null?void 0:t.token_b)==null?void 0:ot.address)==null?void 0:Je.toLowerCase())===((kt=(bt=(et=h)==null?void 0:et.value)==null?void 0:bt.address)==null?void 0:kt.toLowerCase())?ye.value=!0:ye.value=!1;let i={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const{list:u,address:v}=await _.value.getTicks(i);lt.value=u&&v==t.address?_.value.getTickDataFromUrlData(u):[],t!=null&&t.current_tick_index&&(k(t),U.value=!1)}},_e=t=>{var o,r;const c=t.token_a.decimals,I=t.token_b.decimals;ft.value=_t.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((o=t==null?void 0:t.object)==null?void 0:o.current_sqrt_price),c,I).toString(),wt.value=new m(1).div(_t.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((r=t==null?void 0:t.object)==null?void 0:r.current_sqrt_price),c,I)).toString()},O=S([]),a=S(),k=async t=>{const c=t.token_a.decimals,I=t.token_b.decimals;let o=L.value.poolPriceConfigObj&&L.value.poolPriceConfigObj[t.address]&&L.value.poolPriceConfigObj[t.address].recommend_ranges||{};const r=L.value.poolPriceConfigObj&&L.value.poolPriceConfigObj[t.address]&&L.value.poolPriceConfigObj[t.address].type||"";let E,D;const ne=ci(t.current_tick_index,t.tickSpacing);a.value=t.current_tick_index,E=ne-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),D=ne+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const Ve=_.value.TickMath.tickIndexToPrice(E,c,I).toString(),ot=_.value.TickMath.tickIndexToPrice(D,c,I).toString();o["full range"]={lower:_.value.TickUtil.getMinIndex(Number(g.value.tickSpacing)),upper:_.value.TickUtil.getMaxIndex(Number(g.value.tickSpacing))},o.custom={lower:E,upper:D,minPrice:Ve,maxPrice:ot};const Je=[];for(let et in o)o[et]&&Je.push({...o[et],key:et});r&&Je&&Je.length>2?t.isSelfBuilt?W.value="custom":r=="stable"?W.value="suggested":W.value="passive":W.value="custom",O.value=Je||{},at.value=o,X({key:W.value,...o[W.value]})},l=S(""),H=S(""),X=t=>{W.value=t.key.toLowerCase();const c=g.value.token_a.decimals,I=g.value.token_b.decimals,{lower:o,upper:r}=t;Xe.value=!1;const E=_.value.TickMath.tickIndexToPrice(o,c,I).toString(),D=_.value.TickMath.tickIndexToPrice(r,c,I).toString();if(t.key=="full range"){l.value=o,H.value=r,ve();return}ye.value?(qt.value=String(E),P.value=String(E),Nt.value=String(D),p.value=String(D),l.value=o,H.value=r):(qt.value=new m(1).div(new m(D)).toString(),P.value=new m(1).div(new m(D)).toString(),Nt.value=new m(1).div(new m(E)).toString(),p.value=new m(1).div(new m(E)).toString(),l.value=_.value.TickMath.priceToTickIndex(new m(1/Number(D)),c,I),H.value=_.value.TickMath.priceToTickIndex(new m(1/Number(E)),c,I))},ve=t=>{P.value="0",p.value="âˆž"};Ce(()=>g.value,(t,c)=>{(!c&&t&&!se(t)||c&&t&&(!(c!=null&&c.current_tick_index)||(c==null?void 0:c.address)!==(t==null?void 0:t.address)))&&ee(t,!c||!(c!=null&&c.current_tick_index)||(c==null?void 0:c.address)!==(t==null?void 0:t.address)),t&&!se(t)&&_e(t),t||(lt.value=[])},{immediate:!0}),Xt(()=>{y.value=S(),h.value=S(),lt.value=[]}),Ce(()=>n.value,(t,c)=>{t&&A.setSinglePool(t,{},Q.value)},{immediate:!0});const b=t=>{switch(t){case"passive":return"/sui-image/icon_conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}},ge=t=>{switch(t){case"passive":return"/sui-image/img_conservative_def@2x.png";case"active":return"/sui-image/img_active_def@2x.png";case"full range":return"/sui-image/img_fullrange_def.png";case"custom":return"/sui-image/img_custom_def.png";case"suggested":return"/sui-image/icon_stabel_def@2x.png"}},K=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},$=t=>{var I,o;const c=L.value.poolPriceConfigObj&&L.value.poolPriceConfigObj[(I=g.value)==null?void 0:I.address]&&L.value.poolPriceConfigObj[(o=g.value)==null?void 0:o.address].type||"";if(O.value.length>2)if(c=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"suggested":return{top:"25%"};case"full range":return{top:"49%"};case"custom":return{top:"75%"}}else if(c=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"full range":return{top:"35%"};case"custom":return{top:"60%"}}},C=S(1),te=()=>{const t=C.value/2;C.value=t},pe=()=>{const t=C.value*2;C.value=t},R=f(()=>{var t,c,I;return!g.value||se(T.value.addressHistTokens)||!T.value.addressHistTokens[(t=g.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((I=T.value.addressHistTokens[(c=g.value)==null?void 0:c.poolAddress])==null?void 0:I.data.map(o=>[o.key,o.value]))}),N=S(30),ie=S("30D"),z=f(()=>ye.value?R.value&&de(N.value==7?R.value.before_7_d_contract_price_lowest:N.value==24?R.value.before_24_h_contract_price_lowest:R.value.before_30_d_contract_price_lowest,6)||0:R.value&&de(new m(1).div(N.value==7?R.value.before_7_d_contract_price_highest:N.value==24?R.value.before_24_h_contract_price_highest:R.value.before_30_d_contract_price_highest).toString(),6)||0),Ae=f(()=>ye.value?R.value&&de(N.value==7?R.value.before_7_d_contract_price_highest:N.value==24?R.value.before_24_h_contract_price_highest:R.value.before_30_d_contract_price_highest,6)||0:(R.value&&de(1/Number(N.value==7?R.value.before_7_d_contract_price_lowest:N.value==24?R.value.before_24_h_contract_price_lowest:R.value.before_30_d_contract_price_lowest),6))==1/0?0:R.value&&de(1/Number(N.value==7?R.value.before_7_d_contract_price_lowest:N.value==24?R.value.before_24_h_contract_price_lowest:R.value.before_30_d_contract_price_lowest),6)||0),w=f(()=>{const t=Number(P.value),c=Number(p.value);if(P.value=="0"&&p.value=="âˆž"||W.value=="full range")return"1x";if(P.value==p.value||W.value=="full range")return"--";if(P.value&&p.value&&P.value!=="0"&&p.value!=="âˆž"){const I=Yt(1/(1-Number((t/c)**.25)),2);return Number(I)>0?I+"x":"--"}else return 1}),V=f(()=>{var t,c,I,o,r,E;return((t=y.value)==null?void 0:t.isSelfBuilt)||((c=h.value)==null?void 0:c.isSelfBuilt)||((o=L.value.tokensObj[(I=y.value)==null?void 0:I.address])==null?void 0:o.isSelfBuilt)||((E=L.value.tokensObj[(r=h.value)==null?void 0:r.address])==null?void 0:E.isSelfBuilt)}),ze=(t,c)=>{t!==P.value&&W.value=="full range"?X({key:"custom",...O.value.custom}):W.value!=="full range"&&W.value!=="custom"?(W.value="custom",P.value=t):P.value=t,Pe.value&&(Re.value?(ye.value&&P.value!==Pe.value.minPrice&&(Re.value=!1),!ye.value&&Number(P.value)!==1/Number(Pe.value.maxPrice)&&(Re.value=!1)):(ye.value&&P.value==Pe.value.minPrice&&p.value==Pe.value.maxPrice&&(Re.value=!0),!ye.value&&Number(P.value)==1/Number(Pe.value.maxPrice)&&Number(p.value)==1/Number(Pe.value.minPrice)&&(Re.value=!0)))},Le=(t,c)=>{t!==p.value&&W.value=="full range"?X({key:"custom",...O.value.custom}):W.value!=="full range"&&W.value!=="custom"?(W.value="custom",t=="0"?p.value="âˆž":p.value=t):t=="0"?p.value="âˆž":p.value=t,Pe.value&&(Re.value?(ye.value&&p.value!==Pe.value.maxPrice&&(Re.value=!1),!ye.value&&Number(p.value)!==1/Number(Pe.value.minPrice)&&(Re.value=!1)):(ye.value&&P.value==Pe.value.minPrice&&p.value==Pe.value.maxPrice&&(Re.value=!0),!ye.value&&Number(P.value)==1/Number(Pe.value.maxPrice)&&Number(p.value)==1/Number(Pe.value.minPrice)&&(Re.value=!0)))},Qe=t=>{var c;return console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-left.vue:1215 ~ getCoinIcon ~ info:",t),(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((c=L.value.tokensObj[t==null?void 0:t.address])==null?void 0:c.logo_url)||(T.value.theme==="default"?gt("/image/coins/unknown.png"):gt("/image/coins/sui-unknown.png"))},Ge=t=>{switch(t){case"active":return e("newAdd.activeTips");case"passive":return e("newAdd.passiveTips");case"full range":return e("newAdd.fullRangTips");case"suggested":return e("newAdd.suggestedTips");case"custom":return e("newAdd.customTips")}},Ee=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],nt=Tt(),Be=f(()=>nt),Pe=f(()=>{var t;return Be.value.farmsPoolObj[(t=g==null?void 0:g.value)==null?void 0:t.address]}),De=f(()=>L.value.poolPriceConfigObj);Ce(()=>[Re.value,g.value,O.value,De.value,Pe.value,ye.value],(t,c)=>{var I,o;if(t[0]&&t[4]&&!se(t[4]))W.value="custom",P.value=t[5]?t[4].minPrice:String(1/t[4].maxPrice),p.value=t[5]?t[4].maxPrice:String(1/t[4].minPrice);else if(t[1]&&!se(t[1])&&t[2]&&!se(t[2])&&t[3]&&!se(t[3])&&t[4]&&!se(t[4])){t[3]&&t[3][(I=t[1])==null?void 0:I.address]&&t[3][(o=t[1])==null?void 0:o.address].type;const r=t[2].filter(E=>E.key===(t[2].length==4?"passive":"suggested"));r!=null&&r[0]&&(!c||c[0]!==t[0])&&X({...r[0]})}},{immediate:!0});const We=f(()=>L.value.poolsLoading),xe=f(()=>{var t,c,I,o,r,E;return[{label:(t=y.value)==null?void 0:t.symbol,value:(c=y.value)==null?void 0:c.address,logo:(I=y.value)==null?void 0:I.logo_url},{label:(o=h.value)==null?void 0:o.symbol,value:(r=h.value)==null?void 0:r.address,logo:(E=h.value)==null?void 0:E.logo_url}]});return{currentRectangleTab:S((qe=y.value)==null?void 0:qe.address),rectangleTabList:xe,positionError:ct,getCoinIcon:Qe,chainName:Q,store:T,currentTab:G,currentPrice:ft,currentPriceReverse:wt,fromCoin:y,toCoin:h,direction:ye,needReverse:q,addCommom:Te,decimalUi:de,priceTabList:O,currentPriceTab:W,sliderStyle:$,poolInfo:g,tickList:lt,getPriceTabImage:b,getPriceTabDefImage:ge,getPriceTabText:K,defaultMinPrice:qt,defaultMaxPrice:Nt,minPrice:P,maxPrice:p,currentTick:a,chartLoading:U,zoomOut:te,zoomIn:pe,zoom:C,priceTab:X,before7dContractPriceLowest:z,before7dContractPriceHighest:Ae,aprRewardsTime:ie,lever:w,aprRewardsParameter:N,isSelfBuilt:V,priceRangeChangeMin:ze,priceRangeChangeMax:Le,toggle:Jt,getPirceTabTips:Ge,timeList:Ee,farmsPoolInfo:Pe,checkNullObj:se,isStableFarmingRange:Re,poolsLoading:We}}});const Ui={class:"sui-liquidity-left"},ji={class:"title-box"},zi=s("span",{class:"selectRange"},"Select Range",-1),Ei={key:0,class:"tab-box"},Di={class:"range-top"},Hi=["onClick"],Xi={class:"block"},Wi=["src"],xi={class:"price-leverage"},Zi={class:"price-info"},Gi={class:"left"},Ji={class:"current-price"},Ki=s("div",{class:"current-price-title"},"Current Price",-1),Yi={key:0,class:"from-pre-to"},Qi={class:"right"},Vi={class:"chart-box"},en={class:"leverage"},tn={class:"right-time"},nn={class:"day-7-price-range"},on=s("i",null,null,-1),an={class:"gray"},rn={key:0},sn={key:1,class:"skeleton"},ln={class:"time-list"},un=["onClick"],cn={class:"range"},dn={key:0,class:"position-tips"},vn={class:"error"},mn={key:1,class:"stable-farming-range"},fn={class:"value"},gn=s("span",null,[s("img",{src:Qt}),s("span",{class:"text"},"Farm rewards rangeï¼š")],-1),pn={class:"pc-range"},bn={class:"text"},kn={class:"check-box-active plus-switch plus-liquidity-switch"},hn={class:"h5-range"},yn={class:"text"};function _n(e,d,G,x,T,Q){var q,U,ee,_e,O,a,k;const A=Se("RectangleTab"),L=xt,_=Se("SuiLiquidityD3Chart"),J=oi,n=Se("SuiLiquidityPrice"),g=Wt;return j(),Z("div",Ui,[s("div",ji,[zi,e.fromCoin&&e.toCoin?(j(),Z("div",Ei,[re(A,{"current-rectangle-tab":e.currentRectangleTab,"rectangle-tab-list":e.rectangleTabList,onClickTab:d[0]||(d[0]=l=>{e.toggle()})},null,8,["current-rectangle-tab","rectangle-tab-list"])])):Ie("",!0)]),s("div",Di,[s("div",{class:ut(["price-tab-list",((q=e.priceTabList)==null?void 0:q.length)==3?"item-3":""])},[(j(!0),Z($t,null,Bt(e.priceTabList,l=>(j(),Z("div",{key:l.key,class:ut(["price-tab-item",e.currentPriceTab==l.key?"price-tab-item-active":""]),onClick:H=>e.priceTab(l)},[re(L,{placement:"top","arrow-point-at-center":""},{title:it(()=>[vt(B(e.getPirceTabTips(l.key)),1)]),default:it(()=>[s("div",Xi,[s("img",{src:e.currentPriceTab==l.key?e.getPriceTabImage(l.key):e.getPriceTabDefImage(l.key),alt:""},null,8,Wi),s("span",null,B(e.getPriceTabText(l.key)),1)])]),_:2},1024)],10,Hi))),128))],2),s("div",xi,[s("div",Zi,[s("div",Gi,[s("div",Ji,[Ki,s("div",null,[s("span",null,B(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(e.currentPrice,6)):("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(j(),Z("span",Yi,B((U=e.toCoin)==null?void 0:U.symbol)+" per "+B((ee=e.fromCoin)==null?void 0:ee.symbol),1)):Ie("",!0)])])]),s("div",Qi,[e.currentTab=="liquidity"?(j(),Z("div",{key:0,class:"zoom-out",onClick:d[1]||(d[1]=(...l)=>e.zoomOut&&e.zoomOut(...l))}," + ")):Ie("",!0),e.currentTab=="liquidity"?(j(),Z("div",{key:1,class:"zoom-in",onClick:d[2]||(d[2]=(...l)=>e.zoomIn&&e.zoomIn(...l))}," - ")):Ie("",!0)])]),s("div",Vi,[re(_,{"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":!e.poolInfo||e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"]),s("div",en,[s("div",tn,[s("div",null,[s("div",nn,[on,s("span",an,B(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(j(),Z("span",rn,B(("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(e.before7dContractPriceLowest,6)))+" - "+B(("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(e.before7dContractPriceHighest,6))),1)):(j(),Z("div",sn,[re(J,{loading:!0,size:"large",active:"",paragraph:!1})]))])]),s("div",ln,[(j(!0),Z($t,null,Bt(e.timeList,l=>(j(),Z("div",{key:l.value,class:ut(["time-item",l.value==e.aprRewardsParameter?"time-item-active":""]),onClick:H=>e.aprRewardsParameter=l.value},B(l.label),11,un))),128))])])])])])]),s("div",{class:ut(["apr-and-price",e.positionError&&e.poolInfo?"padding-apr-and-price":""])},[s("div",cn,[re(n,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(j(),Z("div",dn,[s("p",vn,B(e.$t("tips.positionError")),1)])):Ie("",!0),e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:ce(se))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(j(),Z("div",mn,[s("div",fn,[gn,s("div",pn,[vt(B(("decimalUi"in e?e.decimalUi:ce(de))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+"- "+B(("decimalUi"in e?e.decimalUi:ce(de))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" ",1),s("span",bn,"Â Â "+B((_e=e.toCoin)==null?void 0:_e.symbol)+" per "+B((O=e.fromCoin)==null?void 0:O.symbol),1)]),s("div",kn,[re(g,{class:"liquidity-switch",checked:e.isStableFarmingRange,onClick:d[3]||(d[3]=l=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])]),s("div",hn,[vt(B(("decimalUi"in e?e.decimalUi:ce(de))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+"- "+B(("decimalUi"in e?e.decimalUi:ce(de))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" ",1),s("span",yn,"Â Â "+B((a=e.toCoin)==null?void 0:a.symbol)+" per "+B((k=e.fromCoin)==null?void 0:k.symbol),1)])])):Ie("",!0)])],2)])}const Pn=st(Bi,[["render",_n]]),wn=rt({components:{IconTooltip:wi},props:{lever:{type:String,default:""}},setup(){return{}}});const In=e=>(It("data-v-b9dd9cb0"),e=e(),Ct(),e),Cn={class:"lever"},Sn={class:"left"},Tn=In(()=>s("span",{class:"lever-title"},"Leverage",-1)),An={class:"lever-text"};function Ln(e,d,G,x,T,Q){const A=Se("IconTooltip");return j(),Z("div",Cn,[s("div",Sn,[Tn,re(A,{type:"leverage","xlink-href":"#icon-icon_tips"})]),s("div",An,B(e.lever),1)])}const qn=st(wn,[["render",Ln],["__scopeId","data-v-b9dd9cb0"]]),Nn=rt({components:{Modal:ai,CoinImg:Ci},props:{positionInfo:{type:Object,default:()=>({})},poolInfo:{type:Object,required:!0},farmPoolInfo:{type:Object,default:()=>({})},isAutoStakeFarming:{type:Boolean,default:!0}},setup(e){const d=mt(),G=f(()=>d),x=f(()=>G.value.chainName),T=f(()=>di[x.value]);let Q=S(!0);const A=St(),L=f(()=>A),_=Zt(),J=f(()=>{var U;return(U=e.poolInfo)==null?void 0:U.needResever}),n=f(()=>e.farmPoolInfo&&e.isAutoStakeFarming?`/new-position-detail?position_nft_id=${e.positionInfo.id}&positionSource=farming`:`/new-position-detail?collect=${e.positionInfo.collectionName}&&token=${e.positionInfo.tokenName}&&address=${e.positionInfo.pool}&pos=${e.positionInfo.pos_object_id}`),g=U=>{var ee;return(U==null?void 0:U.logoURI)||(U==null?void 0:U.logo_url)||((ee=L.value.tokensObj[U==null?void 0:U.address])==null?void 0:ee.logo_url)||(G.value.theme==="default"?gt("/image/coins/unknown.png"):gt("/image/coins/sui-unknown.png"))},q=f(()=>G.value.currentExplorer);return{getExplorerUrl:li,addCommom:Te,router:_,pools:L,decimalFormat:Kt,rateChange:Q,config:T,importIcon:gt,store:G,chainName:x,checkNullObj:se,needReverse:J,getCoinIcon:g,decimalUi:de,currentExplorer:q,positionDetailUrl:n}}});const pt=e=>(It("data-v-b1a140e9"),e=e(),Ct(),e),$n=pt(()=>s("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Mn={class:"view-detail-box"},Fn=pt(()=>s("div",{class:"coin-pair"},null,-1)),Rn={class:"coin-pair"},On={class:"fee"},Bn={class:"status"},Un={class:"min-and-max"},jn={key:0},zn={class:"text"},En=pt(()=>s("img",{src:Vt,alt:""},null,-1)),Dn={class:"text"},Hn={key:1},Xn={class:"text"},Wn=pt(()=>s("img",{src:Vt,alt:""},null,-1)),xn={class:"text"},Zn=pt(()=>s("use",{"xlink:href":"#icon-icon_swap2"},null,-1)),Gn=[Zn];function Jn(e,d,G,x,T,Q){const A=Se("CoinImg"),L=Ii,_=Gt,J=Se("Modal");return j(),dt(J,{visible:!0,class:"transiaction-rejected",centered:"",title:e.$t("newAdd.openPositionSuccessful"),width:"340px",footer:null,onCancel:d[2]||(d[2]=n=>e.$emit("onClose"))},{closeIcon:it(()=>[$n]),default:it(()=>{var n,g,q,U,ee,_e,O,a,k,l,H,X,ve,b,ge,K,$,C,te,pe,R,N,ie,z,Ae,w,V,ze,Le,Qe;return[s("div",Mn,[Fn,s("div",{class:ut(["left",`position-status-${e.positionInfo&&e.positionInfo.currentStatus&&e.positionInfo.currentStatus.toLowerCase()}`])},[s("div",Rn,[s("div",null,[re(A,{url:e.getCoinIcon(e.needReverse?(g=e.positionInfo)==null?void 0:g.token_b:(n=e.positionInfo)==null?void 0:n.token_a)},null,8,["url"]),re(A,{url:e.getCoinIcon(e.needReverse?(U=e.positionInfo)==null?void 0:U.token_a:(q=e.positionInfo)==null?void 0:q.token_b)},null,8,["url"])]),s("span",null,B(e.needReverse?(a=(O=e.positionInfo)==null?void 0:O.token_b)==null?void 0:a.symbol:(_e=(ee=e.positionInfo)==null?void 0:ee.token_a)==null?void 0:_e.symbol)+" - "+B(e.needReverse?(X=(H=e.positionInfo)==null?void 0:H.token_a)==null?void 0:X.symbol:(l=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:l.symbol),1)]),s("div",On,B(e.$t("common.fee"))+" "+B(e.poolInfo.fee*100)+"%",1)],2),s("div",Bn,[re(L,{"current-status":e.positionInfo.currentStatus||""},null,8,["current-status"])]),s("div",Un,[(e.needReverse?!e.rateChange:e.rateChange)?(j(),Z("div",jn,[s("div",zn,B(("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(String(e.positionInfo&&e.positionInfo.minPrice),6))),1),En,s("div",Dn,B(e.positionInfo&&((b=(ve=e.positionInfo)==null?void 0:ve.maxPrice)==null?void 0:b.indexOf("âˆž"))>-1||e.positionInfo&&((K=(ge=e.positionInfo)==null?void 0:ge.maxPrice)==null?void 0:K.indexOf("+"))>-1?"âˆž":("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(String(e.positionInfo&&(($=e.positionInfo)==null?void 0:$.maxPrice)),6)))+" "+B((te=(C=e.positionInfo)==null?void 0:C.token_b)==null?void 0:te.symbol)+" per "+B((R=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:R.symbol),1)])):(j(),Z("div",Hn,[s("div",Xn,B(("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(String(1/Number(e.positionInfo&&((N=e.positionInfo)==null?void 0:N.maxPrice))),6))),1),Wn,s("div",xn,B(e.positionInfo&&((ie=e.positionInfo.maxPrice)==null?void 0:ie.indexOf("âˆž"))>-1||e.positionInfo&&((z=e.positionInfo.maxPrice)==null?void 0:z.indexOf("+"))>-1?"âˆž":("addCommom"in e?e.addCommom:ce(Te))(("decimalUi"in e?e.decimalUi:ce(de))(String(1/Number(e.positionInfo&&((Ae=e.positionInfo)==null?void 0:Ae.minPrice))),6)))+" "+B((V=(w=e.positionInfo)==null?void 0:w.token_a)==null?void 0:V.symbol)+" per "+B((Le=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:Le.symbol),1)])),(j(),Z("svg",{class:"icon-change","aria-hidden":"true",onClick:d[0]||(d[0]=Ge=>e.rateChange=!e.rateChange)},Gn))])]),re(_,{disabled:("checkNullObj"in e?e.checkNullObj:ce(se))(e.positionInfo)||e.isAutoStakeFarming&&!((Qe=e.positionInfo)!=null&&Qe.clmm_pool_id),onClick:d[1]||(d[1]=Ge=>e.router.push(e.positionDetailUrl))},{default:it(()=>[vt(B(e.$t("newAdd.viewDetail")),1)]),_:1},8,["disabled"])]}),_:1},8,["title"])}const Kn=st(Nn,[["render",Jn],["__scopeId","data-v-b1a140e9"]]),Yn=rt({props:{poolInfo:{type:Object,default:()=>({})},isActive:{type:Boolean,default:!0}},setup(e,d){const G=Tt();f(()=>G);const x=S(!1),T=S(),Q=S(!0),A=mt(),L=f(()=>A),_=f(()=>L.value.newTopPoolsObj),J=g=>{var ee,_e,O,a;const q=g[(ee=e==null?void 0:e.poolInfo)==null?void 0:ee.poolAddress]||{};let U=0;q&&!se(q)&&((O=(_e=q==null?void 0:q.stable_farming)==null?void 0:_e.stable_rewarder)==null||O.forEach(k=>{k.amount_second>0&&(U+=k.amount_second)}),U>0?(x.value=!0,T.value={id:q.stable_farming.stable_farming_pool,clmm_pool_id:(a=e==null?void 0:e.poolInfo)==null?void 0:a.poolAddress},d.emit("sendFarmsPoolInfo",Q.value&&e.isActive?T.value:"")):(x.value=!1,d.emit("sendFarmsPoolInfo","")))};return Ce(()=>[_.value,e.poolInfo],([g,q])=>{g&&!se(g)&&q&&!se(q)&&J(g)},{immediate:!0}),Ce(()=>[e.isActive,Q.value,T.value],([g,q,U])=>{d.emit("sendFarmsPoolInfo",q&&e.isActive?U:"")},{immediate:!0}),{isShowAutoStake:x,changeIsOpen:()=>{Q.value=!Q.value,d.emit("sendFarmsPoolInfo",Q.value&&e.isActive?T.value:"")},isOpen:Q}}});const Qn=e=>(It("data-v-489098d8"),e=e(),Ct(),e),Vn={key:0,class:"farms-auto-stake"},eo=Qn(()=>s("div",{class:"icon-desc"},[s("img",{class:"farms-icon",src:Qt,alt:""}),s("div",{class:"desc"},"Automatically stake your position into the farm to enjoy higher yield.")],-1)),to={class:"switch-box"},io={key:0,class:"check-box-active plus-switch plus-liquidity-switch"},no={class:"check-box-active plus-switch plus-liquidity-switch"};function oo(e,d,G,x,T,Q){const A=Wt,L=xt;return e.isShowAutoStake?(j(),Z("div",Vn,[eo,s("div",to,[e.isActive?(j(),Z("div",io,[re(A,{class:"liquidity-switch",checked:e.isOpen,onClick:e.changeIsOpen},null,8,["checked","onClick"])])):(j(),dt(L,{key:1,"overlay-style":{"min-width":"200px"},"overlay-class-name":"ant-tooltip-text-color"},ri({default:it(()=>[s("div",no,[re(A,{class:"liquidity-switch",checked:!1,onClick:()=>{}})])]),_:2},[e.isActive?void 0:{name:"title",fn:it(()=>[vt("Farming rewards only available for active positions.")]),key:"0"}]),1024))])])):Ie("",!0)}const ao=st(Yn,[["render",oo],["__scopeId","data-v-489098d8"]]),ro=rt({components:{SuiLiquidityTitle:hi,SuiLiquidityDepositRatio:yi,InputLock:Si,SuiAddOrCreate:_i,SuiFarmsAutoStake:ao,TokenInputBlock:Ai,SuiLiquidityLever:qn,SuiViewDetail:Kn},setup(){const{t:e,locale:d}=Ht(),G=mt(),x=f(()=>G),T=f(()=>x.value.chainName),Q=St(),A=f(()=>Q),L=vi(),_=f(()=>L),J=Ft(),n=f(()=>{let i=null;for(const u in A.value.poolsObj){const v=A.value.poolsObj[u];v.address==J.query.poolAddress&&(i=v)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:272 ~ constpoolInfo:any=computed ~ info:",i),i}),g=S(!1),q=S(!1),U=f(()=>x.value.theme),ee=async(i,u)=>{y.value=i.needReverse?i.token_b:i.token_a,h.value=i.needReverse?i.token_a:i.token_b,M.value="",F.value=""},_e=f(()=>_.value.assets&&y.value&&_.value.assets[y.value.address]?jt(_.value.assets[y.value.address].balance,y.value.decimals):"0"),O=f(()=>_.value.assets&&h.value&&_.value.assets[h.value.address]?jt(_.value.assets[h.value.address].balance,h.value.decimals):"0"),a=S(),k=S(),l=S(),H=S(!1),X=i=>{var u,v,me,Y;a.value=i,i==="fromCoin"?(k.value=((u=h.value)==null?void 0:u.address)||"",l.value=J.query.actions=="new-position"?(v=y.value)==null?void 0:v.address:n.value.needReverse?n.value.token_b.address:n.value.token_a.address):(k.value=((me=y.value)==null?void 0:me.address)||"",l.value=J.query.actions=="new-position"?(Y=h.value)==null?void 0:Y.address:n.value.needReverse?n.value.token_a.address:n.value.token_b.address),H.value=!0},ve=i=>{var me,Y,fe,be,le,oe,he,we;const u=n.value.needReverse?n.value.token_b:n.value.token_a,v=n.value.needReverse?n.value.token_a:n.value.token_b;a.value==="fromCoin"?(((me=y.value)==null?void 0:me.address)===(u==null?void 0:u.address)||!((Y=y.value)!=null&&Y.address)?(h.value&&i.address.toLowerCase()===((fe=h)==null?void 0:fe.value.address.toLowerCase())&&(h.value=null),y.value=i):(y.value&&i.address.toLowerCase()===((be=y)==null?void 0:be.value.address.toLowerCase())&&(y.value=null),h.value=i),J.query.action||(J.query.fee="")):((le=h.value)==null?void 0:le.address)===(v==null?void 0:v.address)||!((oe=h.value)!=null&&oe.address)?(y.value&&i.address.toLowerCase()===((he=y)==null?void 0:he.value.address.toLowerCase())&&(y.value=null),h.value=i):(h.value&&i.address.toLowerCase()===((we=h)==null?void 0:we.value.address.toLowerCase())&&(h.value=null),y.value=i),H.value=!1},b=f(()=>x.value.chainName?Rt(x.value.chainName):{}),ge=f(()=>x.value.slippage),K=S(),$=async()=>{var Ue,$e,Me,Ke;if(Xe.value||!P.value&&!p.value)return!1;if(!M.value&&!F.value&&!P.value&&!p.value)return;const i=n.value||{};if(se(i))return;const{TickUtil:u,TickMath:v,getNearestTickByTick:me}=b.value,Y=i==null?void 0:i.token_a.decimals,fe=i==null?void 0:i.token_b.decimals;let be,le,oe,he,we,Ne,Ze,tt,ke=i==null?void 0:i.current_tick_index;if(!ke)return;let ae;if(i.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===h.value.address.toLowerCase()?ae=!0:ae=!1,P.value==="0"&&p.value==="âˆž")oe=u.getMinIndex(Number(i.tickSpacing)),he=u.getMaxIndex(Number(i.tickSpacing)),we=v.tickIndexToSqrtPriceX64(oe),Ne=v.tickIndexToSqrtPriceX64(he);else if(W.value=="custom"){ae?(be=P.value,le=p.value):(be=p.value!=="âˆž"?new m(1).div(p.value).toString():1/0,le=new m(1).div(P.value).toString());try{Ze=new m(be).equals(new m(0))?-443636:v.priceToTickIndex(new m(be),Y,fe)}catch{Ze=-443636}try{tt=v.priceToTickIndex(new m(le),Y,fe)}catch{tt=443636}oe=me(Ze,Number(i.tickSpacing),!0),he=me(tt,Number(i.tickSpacing),!0);try{we=v.priceToSqrtPriceX64(new m(be),Y,fe)}catch{(le===1/0||le==="âˆž")&&(we=v.tickIndexToSqrtPriceX64(u.getMinIndex(Number(i.tickSpacing))))}try{Ne=v.priceToSqrtPriceX64(new m(le),Y,fe)}catch{(le===1/0||le==="âˆž")&&(Ne=v.tickIndexToSqrtPriceX64(u.getMaxIndex(Number(i.tickSpacing))))}}else oe=(Ue=at.value[W.value])==null?void 0:Ue.lower,he=($e=at.value[W.value])==null?void 0:$e.upper,we=v.tickIndexToSqrtPriceX64(oe),Ne=v.tickIndexToSqrtPriceX64(he);if(p.value!=="âˆž"&&oe>=he){console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:639 ~ updateAmounts ~",p.value!=="âˆž"&&oe>=he),g.value=!0,M.value="",q.value=!0,F.value="";return}if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:708 ~ updateAmounts ~ currentTickIndex:",ke),p.value==="âˆž"||ke>=oe&&ke<he){g.value=!1,q.value=!1;let ue;if(M.value||F.value){if(Oe.value){const Lt=new m(M.value).mul(Math.pow(10,y.value.decimals)).toString();ue=new je(Lt)}else{const Lt=new m(F.value).mul(Math.pow(10,h.value.decimals)).toString();ue=new je(Lt)}v.tickIndexToSqrtPriceX64(n.value.current_tick_index);const{liquidityAmount:Fe,tokenMaxA:Ye,tokenMaxB:yt,tokenMaxAOrigin:ei,tokenMaxBOrigin:ti}=b.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.token_a,tokenB:i.token_b,lowerTick:oe,upperTick:he,coinAmount:ue,iscoinA:ae?Oe.value:!Oe.value,roundUp:!0,slippage:Number(ge.value)/100,curSqrtPrice:new je(n.value.current_sqrt_price)});K.value={liquidityAmount:Fe,tokenMaxA:Ye,tokenMaxB:yt,tokenMaxAOrigin:ei,tokenMaxBOrigin:ti},ae?Oe.value?F.value=Number(yt)>0?yt:"":M.value=Number(Ye)>0?Ye:"":Oe.value?F.value=Ye:M.value=yt}}else if(ke>=he){if(ae?M.value="":F.value="",g.value=ae,q.value=!ae,M.value||F.value){let ue;if(ae){const Fe=new m(F.value).mul(Math.pow(10,(Me=h.value)==null?void 0:Me.decimals)).toString();ue=new je(Fe),K.value={liquidityAmount:b.value.estimateLiquidityForCoinB(we,Ne,ue),tokenMaxA:0,tokenMaxB:F.value}}else{const Fe=new m(M.value).mul(Math.pow(10,(Ke=y.value)==null?void 0:Ke.decimals)).toString();ue=new je(Fe),K.value={liquidityAmount:b.value.estimateLiquidityForCoinB(we,Ne,ue),tokenMaxA:0,tokenMaxB:M.value}}}}else if(ke<oe){if(g.value=!ae,q.value=ae,ae?F.value="":M.value="",M.value||F.value){let ue;if(ae){const Fe=new m(M.value).mul(Math.pow(10,y.value.decimals)).toString();ue=new je(Fe),K.value={liquidityAmount:b.value.estimateLiquidityForCoinA(we,Ne,ue),tokenMaxA:M.value,tokenMaxB:0}}else{const Fe=new m(F.value).mul(Math.pow(10,h.value.decimals)).toString();ue=new je(Fe),K.value={liquidityAmount:b.value.estimateLiquidityForCoinA(we,Ne,ue),tokenMaxA:F.value,tokenMaxB:0}}}}else g.value=!0,console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:783 ~ updateAmounts ~ showFromCoinLock.value:",g.value),M.value="",q.value=!0,F.value=""};Ce(()=>n.value,(i,u)=>{(!u&&i&&!se(i)||u&&i&&u.address!==i.address)&&ee(i,!u||i.address!==u.address),i&&!se(i)&&$()},{immediate:!0}),Ce(M,(i,u)=>{i==""&&Oe.value&&(F.value=""),i&&Oe.value&&!Xe.value&&$()}),Ce(F,(i,u)=>{i==""&&!Oe.value&&(M.value=""),i&&!Oe.value&&!Xe.value&&$()}),Ce(()=>ye.value,(i,u)=>{$()}),Ce(()=>[y.value,h.value],([i,u])=>{i&&u&&(g.value=!1,q.value=!1)});const C=S("--"),te=f(()=>A.value.RATES),pe=()=>{var v,me,Y,fe;const i=te.value&&te.value[(v=y.value)==null?void 0:v.address]&&te.value[(me=y.value)==null?void 0:me.address].price,u=te.value&&te.value[(Y=h.value)==null?void 0:Y.address]&&te.value[(fe=h.value)==null?void 0:fe.address].price;if(i&&u){const be=new m(M.value>0?M.value:0).mul(i),le=new m(F.value>0?F.value:0).mul(u),oe=be.add(le).toNumber();C.value=oe>0&&oe<.01?"<$0.01":"$"+Te(oe,2)}else C.value="--"};Ce(()=>[M.value,F.value,Xe.value],([i,u,v])=>{(i||u)&&!v?pe():(!i||!u)&&!v&&(C.value="--")},{immediate:!0});const R=S(),N=async()=>{var ae,Ue;if(!P.value&&!p.value)return!1;if(!M.value&&!F.value&&!P.value&&!p.value)return;const i=n.value;if(se(i))return;const{TickUtil:u,TickMath:v,getNearestTickByTick:me}=b.value,Y=i==null?void 0:i.token_a.decimals,fe=i==null?void 0:i.token_b.decimals;let be,le,oe,he,we,Ne,Ze;if(i.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===h.value.address.toLowerCase()?Ze=!0:Ze=!1,P.value==="0"&&p.value==="âˆž")oe=u.getMinIndex(Number(i.tickSpacing)),he=u.getMaxIndex(Number(i.tickSpacing));else if(W.value=="custom"){Ze?(be=Number(P.value),le=Number(p.value)):(be=new m(1).div(p.value).toString(),le=new m(1).div(P.value).toString());try{we=be==0?-443636:v.priceToTickIndex(new m(be),Y,fe)}catch{we=-443636}try{Ne=v.priceToTickIndex(new m(le),Y,fe)}catch{Ne=443636}oe=me(we,Number(i.tickSpacing),!0),he=me(Ne,Number(i.tickSpacing),!0)}else oe=(ae=at.value[W.value])==null?void 0:ae.lower,he=(Ue=at.value[W.value])==null?void 0:Ue.upper;const tt=te.value[i==null?void 0:i.token_a.address].price,ke=te.value[i==null?void 0:i.token_b.address].price;ye.value?new je(i.current_sqrt_price):new je(1/i.current_sqrt_price);try{const{amountA:$e,amountB:Me,tokenAmountsInfo:Ke}=await b.value.estCoinAmountsFromTotalAmount({lowerTick:oe,upperTick:he,decimalsA:Y,decimalsB:fe,curSqrtPrice:new je(i.current_sqrt_price),totalAmount:C.value.replace(/[^\d.]/g,""),tokenPriceA:tt,tokenPriceB:ke});R.value=Ke,i.needReverse?ye.value?(M.value=$e,F.value=Me):(M.value=Me,F.value=$e):(M.value=$e,F.value=Me)}catch($e){console.log($e,"e===>")}};Ce([P,p],([i,u])=>{Xe.value?Xe.value&&N():$(),u!=="âˆž"&&Number(i)!==0&&Number(u)!==0&&Number(i)>=Number(u)?ct.value=!0:ct.value=!1,Number(i)==0&&Number(u)==0&&ft.value&&(ct.value=!0)},{deep:!0,immediate:!0});const ie=i=>{const u=i.replace(/[^\d.]/g,""),v="$"+Te(u);Xe.value=!0,C.value=v,u>0?N():(M.value="",F.value="")},z=S(!1),{setTransactionTxid:Ae,setTransactionDesc:w,setIsShowWaiting:V,setIsShowSuccess:ze,setPositiomNum:Le,setIsShowRejected:Qe}=G,Ge=Ti(),Ee=f(()=>A.value.currentPositionInfo),nt=S(!1),Be=S(!0),Pe=Tt(),De=f(()=>Pe),We=f(()=>De.value.farmsPoolObj);Ce(()=>[We.value,n.value],([i,u])=>{i&&!se(i)&&u&&!se(u)&&(i[u.address]||(Be.value=!1))},{immediate:!0});const xe=S(),He=S(),qe=i=>{xe.value=i,i?Be.value=!0:Be.value=!1},t=async(i,u,v,me)=>{try{u=="farming"?await A.value.setCurrentPositionInfo("","","","Sui",v,"farming"):await A.value.setCurrentPositionInfo(i,"","",T.value,me),await ui(3e3),Be.value?await Ge.subscribePosition({pool_address:Ee.value.clmm_pool_id,position_index:Ee.value.name.split("-")[1]},Ee.value.clmm_position_id):await Ge.subscribePosition({pool_address:Ee.value.poolAddress,position_index:Ee.value.index},Ee.value.nftHash)}catch(Y){console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1151 ~ notifiSubscribePosition ~ error:",Y)}},c=async i=>{var we,Ne,Ze,tt;z.value=!1,A.value.currentPositionInfo={},Ae(""),w(e("tips.increaseLiquiditySuccess",{from:g.value?"":`${Te(M.value)} ${(we=y.value)==null?void 0:we.symbol}`,and:!g.value&&!q.value?"and":"",to:q.value?"":`${Te(F.value)} ${(Ne=h.value)==null?void 0:Ne.symbol}`})),V(!0);const u=ye.value?Oe.value:!Oe.value;let v,me,Y,fe,be,le;const oe=n.value.token_a.decimals,he=n.value.token_b.decimals;if(P.value==="0"&&p.value==="âˆž")Y=b.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),fe=b.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing));else if(W.value=="custom"){ye.value?(v=P.value,me=p.value):(v=new m(1).div(p.value).toString(),me=new m(1).div(P.value).toString());try{be=v==0?b.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)):b.value.TickMath.priceToTickIndex(new m(v),oe,he)}catch{be=b.value.TickUtil.getMinIndex(Number(n.value.tickSpacing))}try{le=b.value.TickMath.priceToTickIndex(new m(me),oe,he)}catch{le=b.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))}Y=b.value.getNearestTickByTick(be,Number(n.value.tickSpacing),!0),fe=b.value.getNearestTickByTick(le,Number(n.value.tickSpacing),!0)}else Y=at.value[W.value].lower,fe=at.value[W.value].upper;try{let ke;Xe.value?ke=await b.value.getCreateAddLiquidityPayload({pool:n.value,curSqrtPrice:new je(n.value.current_sqrt_price),tickLower:Y,tickUpper:fe,slippage:Number(ge.value)/100,tokenAmounts:R.value}):ke=await b.value.getAddLiquidityTransactionPayload({pool:{poolAddress:n.value.poolAddress,token_a:n.value.token_a,token_b:n.value.token_b},amount:Oe.value?M.value:F.value,fix_amount_a:u,tick_lower:Y,tick_upper:fe,index:0,slippage:Number(ge.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new je(n.value.current_sqrt_price),farmPoolInfo:xe.value});let ae;if(T.value==="Aptos")ae=await _.value.currentWallet.signAndSubmitTransaction(ke);else{const Ue=await b.value.signAndExecuteTransactionBlock(_.value.currentWallet,ke==null?void 0:ke.txb,ke==null?void 0:ke.payloadParams);ae=b.value.handleTx(Ue)}if(console.log("0410###tx###",ae),ae&&ae.hash){Ae(ae.hash),V(!1),ze(!0);let Ue;n.value.needReverse?n.value.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===h.value.address.toLowerCase()?Ue=!1:Ue=!0:n.value.token_a.address.toLowerCase()===y.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===h.value.address.toLowerCase()?Ue=!0:Ue=!1;const $e={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:g.value?"":`${Te(M.value)} ${(Ze=y.value)==null?void 0:Ze.symbol}`,and:!g.value&&!q.value?"and":"",to:q.value?"":`${Te(F.value)} ${(tt=h.value)==null?void 0:tt.symbol}`}),hash:ae.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};T.value!=="Aptos"&&($e.res=ae.res),b.value.showTransitionPending($e),console.log($e,"toAdd params###");const Me=await b.value.watchTransaction($e,!0);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1295 ~ toAdd ~ watchInfo:",Me),Me.status){ze(!1),A.value.setCurrentPositionLoading(!0);let Ke,ue;T.value==="Aptos"?He.value={token_a:n.value.token_a,token_b:n.value.token_b,minPrice:P.value,maxPrice:p.value,pool:n.value.address,collection:Me.nftInfo[0].data.id.collection,tokenName:Me.nftInfo[0].data.name}:(ue=Me.nftInfo,console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1319 ~ toAdd ~ nftInfo:",ue),Be.value?(Me.res.events.forEach(Ye=>{Ye.type.indexOf("::pool::DepositEvent")>-1&&(Ke=Ye.parsedJson.wrapped_position_id)}),He.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:P.value,maxPrice:p.value,id:Ke,clmm_pool_id:n.value.address,pool:n.value.address}):He.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:P.value,maxPrice:p.value,pos_object_id:ue.position,pool:n.value.address},console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1389 ~ toAdd ~ positionInfoDetail:",He.value)),nt.value=!0;const Fe=n.value.poolAddress;setTimeout(()=>{if(i){const Ye=Ke?"farming":"clmm";console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1400 ~ setTimeout ~ poolInfo.value.poolAddress:",Fe),t(Fe,Ye,Ke,ue==null?void 0:ue.position)}},3e3),setTimeout(()=>{Q.updateCurrentPools(Fe,T.value),b.value.getAccount(_.value.address)},3e3),setTimeout(async()=>{Ut(b,n)},7e3)}Le()}else V(!1),Qe(!0);M.value="",F.value=""}catch(ke){M.value="",F.value="",console.log("0330###Add liquidity Error###",ke),V(!1),Qe(!0)}},I=f(()=>!!(!M.value&&!F.value||Number(M.value)>Number(_e.value)||Number(F.value)>Number(O.value)||r.value!==e("button.addLiquidity")&&r.value!==e("newAdd.preview")||n.value&&n.value&&n.value.is_pause||Number(M.value)<=0&&Number(F.value)<=0||!g.value&&Number(M.value)==0||!q.value&&Number(F.value)==0)),o=f(()=>!y.value||!h.value),r=f(()=>n.value&&n.value.is_pause?"Pool Closed":!y.value||!h.value||o.value?e("modal.selectTokenModalTitle"):Number(M.value)>Number(_e.value)?e("button.insufficientBalance",{name:y.value.symbol}):Number(F.value)>Number(O.value)?e("button.insufficientBalance",{name:h.value.symbol}):!Number(M.value)&&!Number(F.value)?e("button.enterAmount"):p.value!=="âˆž"&&Number(P.value)>=Number(p.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),E=S({}),D=S({}),ne=S(!1),Ve=(i,u)=>{const v=localStorage.getItem(i.address);console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1518 ~ getTokenSource ~ coinLocak:",v,i),i!=null&&i.isSelfBuilt&&!v&&(u=="fromCoin"&&(E.value=i),u=="toCoin"&&(D.value=i),ne.value=!0)};Ce(()=>[y.value,h.value],([i,u])=>{i&&!se(i)&&Ve(i,"fromCoin"),u&&!se(u)&&Ve(u,"toCoin")},{immediate:!0});const ot=Zt(),Je=()=>{T.value!=="Aptos"?ot.push("/pool/list"):ot.push("/pools")},et=i=>{Xe.value,c(i)},bt=()=>{J.query.action!=="create-pool"&&J.query.actions!=="new-position"&&(Ut(b,n),$(),_.value.address&&b.value.getAccount(_.value.address),Q.updateCurrentPools(n.value.poolAddress,T.value)),Q.setPoolConfigList(T.value,x.value.filterCoinsObj)},kt=f(()=>{var v,me,Y,fe,be,le;const i=(Y=te.value[(me=(v=y)==null?void 0:v.value)==null?void 0:me.address])==null?void 0:Y.price,u=(le=te.value[(be=(fe=h)==null?void 0:fe.value)==null?void 0:be.address])==null?void 0:le.price;return!!(i&&u)});Ce(()=>[J,A.value.tokensObj],([i,u])=>{var v;u&&!se(u)&&(h.value||(h.value=A.value.tokensObj[(v=i==null?void 0:i.query)==null?void 0:v.toCoin]))},{immediate:!0,deep:!0});const ht=S(!1);return{lever:f(()=>{const i=Number(P.value),u=Number(p.value);if(P.value=="0"&&p.value=="âˆž"||W.value=="full range")return"1x";if(P.value==p.value||W.value=="full range")return"--";if(P.value&&p.value&&P.value!=="0"&&p.value!=="âˆž"){const v=Yt(1/(1-Number((i/u)**.25)),2);return Number(v)>0?v+"x":"--"}else return 1}),isInputActive:ht,positionError:ct,decimalUi:de,poolInfo:n,fromCoinAmount:M,toCoinAmount:F,fromCoin:y,toCoin:h,theme:U,showFromCoinLock:g,showToCoinLock:q,fromCoinBlance:_e,toCoinBlance:O,fixedFromCoin:Oe,openCoinSelect:X,currentCoinKey:a,existingCoins:k,lastSelectCoin:l,showCoinSelect:H,onCoinSelect:ve,liquidityTotalAmount:C,toggle:Jt,onInput:ie,isInputTotalAmount:Xe,isViewDetail:nt,addLiquidityBtnDisabled:I,addLiquidityBtnText:r,isShowTokenWarning:ne,chainName:T,closeTokenWarning:Je,warningFromCoin:E,warningToCoin:D,isShowLiquidityModal:z,currentPrice:ft,currentPriceReverse:wt,currentPriceTab:W,minPrice:P,maxPrice:p,toAdd:c,direction:ye,wallet:_,getAddLiquidityType:et,clickRefresh:bt,isShowtotalAmount:kt,isAutoStakeFarming:Be,farmPoolInfo:xe,getFarmsPoolInfo:qe,positionInfoDetail:He,getTokenSource:Ve}}});const so={class:"sui-liquidity-right-box"},lo={class:"sui-liquidity-right"},uo={class:"deposit-title"},co={key:0,class:"create-pool-lock"},vo=s("img",{src:Li,alt:""},null,-1),mo=[vo],fo={key:0,class:"from-lock"},go={key:1,class:"to-lock"},po=s("div",{class:"exchange-new"},[s("svg",{class:"icon icon-down","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_add1"})])],-1),bo=[po],ko={class:"show-info"},ho={class:"total-amount"},yo=s("span",null,"Total Amount",-1);function _o(e,d,G,x,T,Q){const A=Se("SuiLiquidityTitle"),L=Se("TokenInputBlock"),_=Se("InputLock"),J=Se("SuiLiquidityDepositRatio"),n=Se("SuiLiquidityLever"),g=Gt,q=Pi,U=Se("SuiViewDetail"),ee=Se("SuiAddOrCreate"),_e=Se("SuiFarmsAutoStake");return j(),Z("div",so,[s("div",lo,[s("div",uo,[re(A,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),e.positionError?(j(),Z("div",co,mo)):Ie("",!0),s("div",{class:ut(["card-container",e.isInputActive?e.fixedFromCoin?"input-block-add-top":"input-block-add-bottom":"input-block-add-top input-block-inactive"])},[re(L,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":d[0]||(d[0]=O=>e.fromCoinAmount=O),"input-value":e.fromCoinAmount,"token-info":e.fromCoin||null,"has-arrow":!1,"page-token-loading":!e.poolInfo,onOnInput:d[1]||(d[1]=O=>{e.isInputActive=!0,e.fromCoinAmount=O,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnFocus:d[2]||(d[2]=()=>{e.isInputActive=!0,e.fixedFromCoin=!0}),onOnBlur:d[3]||(d[3]=()=>{e.isInputActive=!1})},null,8,["modelValue","input-value","token-info","page-token-loading"]),re(L,{modelValue:e.toCoinAmount,"onUpdate:modelValue":d[4]||(d[4]=O=>e.toCoinAmount=O),"input-value":e.toCoinAmount,"token-info":e.toCoin||null,"has-arrow":!1,"page-token-loading":!e.poolInfo,onOnInput:d[5]||(d[5]=O=>{e.isInputActive=!0,e.toCoinAmount=O,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnFocus:d[6]||(d[6]=()=>{e.isInputActive=!0,e.fixedFromCoin=!1}),onOnBlur:d[7]||(d[7]=()=>{e.isInputActive=!1})},null,8,["modelValue","input-value","token-info","page-token-loading"]),e.showFromCoinLock&&!e.positionError?(j(),Z("div",fo,[re(_,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])])):Ie("",!0),e.showToCoinLock&&!e.positionError?(j(),Z("div",go,[re(_,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])])):Ie("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(j(),Z("div",{key:2,class:"new-sui-exchange to-add-logo",onClick:d[8]||(d[8]=(...O)=>e.toggle&&e.toggle(...O))},bo)):Ie("",!0)],2),s("div",ko,[s("div",ho,[yo,s("span",null,B(e.liquidityTotalAmount),1)]),re(J,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),re(n,{lever:e.lever},null,8,["lever"])]),re(g,{class:"big-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:d[9]||(d[9]=O=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:it(()=>[vt(B(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(j(),dt(q,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:d[10]||(d[10]=O=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):Ie("",!0),e.isViewDetail?(j(),dt(U,{key:2,"pool-info":e.poolInfo,"farm-pool-info":e.farmPoolInfo,"position-info":e.positionInfoDetail,"is-auto-stake-farming":e.isAutoStakeFarming,onOnClose:d[11]||(d[11]=O=>e.isViewDetail=!1)},null,8,["pool-info","farm-pool-info","position-info","is-auto-stake-farming"])):Ie("",!0),e.isShowLiquidityModal?(j(),dt(ee,{key:3,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:d[12]||(d[12]=O=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):Ie("",!0)]),re(_e,{"pool-info":e.poolInfo,"is-active":!e.showFromCoinLock&&!e.showToCoinLock,"is-auto-stake-farming":e.isAutoStakeFarming,onSendFarmsPoolInfo:e.getFarmsPoolInfo},null,8,["pool-info","is-active","is-auto-stake-farming","onSendFarmsPoolInfo"])])}const Po=st(ro,[["render",_o]]),wo=rt({components:{SuiLiquidityLeft:Pn,SuiLiquidityRight:Po},setup(){const e=Tt(),d=f(()=>e),G=f(()=>d.value.farmsPoolObj);Xt(()=>{si(),Q.setPoolsLoading(!0)}),Ce(()=>G.value,A=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: deposit.vue:41 ~ watch ~ newVal:",A),A&&se(A)&&e.getFarmsPoolList(!0)},{immediate:!0});const x=Ft(),T=mt();f(()=>T);const Q=St();return{tickList:lt,route:x}}});const Io={key:0,class:"loading-spin-liquidity loading-global"},Co={class:"privide-liquidity"};function So(e,d,G,x,T,Q){var J,n;const A=Dt,L=Se("SuiLiquidityLeft"),_=Se("SuiLiquidityRight");return j(),Z($t,null,[!e.tickList&&((n=(J=e.route)==null?void 0:J.query)!=null&&n.poolAddress)?(j(),Z("div",Io,[re(A)])):Ie("",!0),s("div",Co,[re(L),re(_)])],64)}const ma=st(wo,[["render",So],["__scopeId","data-v-d32d60da"]]);export{ma as default};
