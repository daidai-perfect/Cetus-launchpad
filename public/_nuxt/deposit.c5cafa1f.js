import{a as ut,e as ai,n as kt,d as ce,b as Ct,u as St,f as $e,c as re,s as yt,p as Ft,i as oi}from"./pool.7cb19b71.js";import{a as nt,r as F,m as k,y as Ut,D as Ie,e as at,o as M,f as Z,t as jt,G as ri,h as r,H as _t,v as G,u as ne,x as K,c as Ze,p as Tt,k as It,J as zt,i as Fe,w as Ve,j as xe,L as At,l as Ht,E as Nt,C as Et,q as si,F as wt,s as Rt,z as pt,W as li,Z as ui,b as ci,B as di}from"./entry.6fece5f9.js";/* empty css              */import{s as dt,m as mi,l as vi,b as fi,a as gi}from"./transform.c672907f.js";import"./decimal.a2826370.js";import{D as o}from"./decimal.765d8738.js";/* empty css              */import{d as Xt,_ as Dt,c as Wt,a as Zt,b as pi}from"./new-liquidity-title.5c17e12b.js";import{i as Pt}from"./import-icon.de3e6c66.js";/* empty css              */import{T as st,g as bi,u as hi,b as ze}from"./index.723f7524.js";import{positionError as it,fromCoin as _,toCoin as p,tickList as tt,currentPrice as lt,currentPriceReverse as mt,direction as ye,currentPriceTab as W,defaultMinPrice as bt,defaultMaxPrice as ht,minPrice as q,maxPrice as h,toggle as Gt,isStableFarmingRange as Ue,isInputTotalAmount as Ee,priceConfigObj as Ye,fromCoinAmount as S,toCoinAmount as T,fixedFromCoin as Te,resetTickList as Bt,resetData as ki}from"./data.3ada9dae.js";import{u as vt}from"./farms.d8b5aeab.js";import{_ as Jt}from"./icon_farms_2x.1a9236c6.js";import{_ as yi}from"./coin-lock.5a3f9127.js";import{_ as _i}from"./coin-select.9beb234f.js";import{_ as wi}from"./viewDetail.4dd7e1d1.js";import{a as Pi}from"./new-add-or-create.5526427f.js";import{u as Ci}from"./notifi.29368765.js";import{_ as Si,a as Ti}from"./icon-Add-Liquidity_2x.0acb06cb.js";import"./img-lock_2x.a28135f4.js";import"./lock.b65884f9.js";import"./index.6fb2c779.js";/* empty css              */import"./token-warning.a25c1939.js";import"./useDebounceFunction.758a7e78.js";import"./swap-setting.40009cb9.js";import"./icon-error_2x.c383dad0.js";import"./img-lock_2x.76a4e724.js";import"./token-warning_2x.edd59b82.js";import"./img-no-Positions_2x.34983b3e.js";import"./img-no-Positions_2x.497a69b5.js";import"./status-block.30e407d3.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./useWhale.7be18106.js";function Ot(e,l,de){const ae=new o(10).pow(l-de);return new o(1.0001).pow(e).mul(ae)}const Ii=nt({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,l){const de=F(""),ae=F(""),$=k(()=>{var a,C,m,X,U,V;return(a=e.poolInfo)!=null&&a.current_sqrt_price&&((C=e.poolInfo)!=null&&C.coinA)&&((m=e.poolInfo)!=null&&m.coinB)?n.sqrtPriceX64ToPrice((X=e.poolInfo)==null?void 0:X.current_sqrt_price,(U=e.poolInfo)==null?void 0:U.coinA.decimals,(V=e.poolInfo)==null?void 0:V.coinB.decimals).toString():"0"}),se=k(()=>{let a=0;return e.direction?a=(Number(e.minPrice)/Number($.value)-1)*100:a=(Number(e.minPrice)/Number(1/Number($.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),L=k(()=>{let a=0;return e.direction?a=(Number(e.maxPrice)/Number($.value)-1)*100:a=(Number(e.maxPrice)/Number(1/Number($.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),O=ut(),I=k(()=>O),Q=k(()=>I.value.chainName?Ct(I.value.chainName):{}),{TickMath:n,getNearestTickByTick:A}=Q.value,E=(a=[])=>{let C=6;const m=Math.abs(Number(a[0])-Number(a[a.length-1]));return m>=6?C=0:m>=1?C=1:m>=.1?C=2:m>=.01?C=3:m>=.001?C=4:m>=1e-4?C=5:m>=1e-5?C=6:m>=1e-6?C=7:m>=1e-7&&(C=8),C},Y=(a,C=1)=>{if(a&&a.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const m=Number(e.poolInfo.current_tick_index);let X=m+100*C,U=m-100*C,V,y;if(e.maxPrice==="âˆž")y=Q.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?y=n.priceToTickIndex(new o(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):y=n.priceToTickIndex(new o(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{y=443636}if(e.minPrice==="0")V=Q.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=n.priceToTickIndex(new o(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=n.priceToTickIndex(new o(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let Pe=0;if(e.currentPriceTab!=="full range"){if(m>=V&&m<=y){const N=m-V,me=y-m;Pe=Math.max(Math.abs(N),Math.abs(me))}else m<V?Pe=Math.abs(y-m):Pe=Math.abs(m-V);X=m+Pe+100*C,U=m-Pe-100*C}else{const N=(Math.abs(m)>5e3,2e4);X=m+N*C,U=m-N*C}U<-443636&&(U=-443636),X>443636&&(X=443636);const f=new o(a.liquidity).div(Math.pow(10,8)).toString(),R=e.tickList,z=[],Ce=[];let w={};for(let N=0;N<R.length;N++){if(w=R[N],w.index<=m&&w.index>=U){if(z.length<1&&N!==0){const me=R[N-1];z.unshift({...me,index:U,source:"left"})}z.unshift(w)}else if(w.index>m&&w.index<=X&&(Ce.push(w),z.length<1&&N!==0)){const me=R[N-1];z.push({...me,index:U,source:"left"})}if(w.index>X){const me=R[N];if(Ce.push({...me,index:X,source:"right"}),z.length<1&&N!==0){const Je=R[N-1];z.push({...Je,index:U,source:"left"})}break}}let j="0";for(let N=z.length-1;N>=0;N--)j=new o(j).plus(new o(z[N].liquidityNet.toString()).div(Math.pow(10,8))).toString(),z[N].liquityAmount=j;let ee=f;for(let N=0;N<Ce.length;N++)ee=new o(ee).plus(new o(Ce[N].liquidityNet.toString()).div(Math.pow(10,8))).toString(),Ce[N].liquityAmount=ee;let le=[];const H=R&&R.length>0?{index:m,liquityAmount:Number(f)}:{index:m,liquityAmount:0};(z.length>0||Ce.length>0)&&(le=[...z.reverse(),H,...Ce],e.direction||(le=le.reverse()));const He=[];R.forEach(N=>{He.push({...N,liquidityGross:N.liquidityGross.toString(),liquidityNet:N.liquidityNet.toString()})}),v(le,U,X,V,y,m)}};let be=F(!1);const x=F(!1);Ut(()=>{const a=document.body.clientWidth;x.value=!0,a<750?be.value=!1:be.value=!0,window.onresize=()=>{document.body.clientWidth<750?be.value=!1:be.value=!0,Y(e.poolInfo,e.zoom)}});const v=(a,C,m,X,U,V)=>{let y,Pe;e.direction?(y=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new o(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",Pe=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new o(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(y=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new o(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",Pe=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new o(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const f={top:30,right:35,bottom:20,left:80};let R,z;be.value?(R=460-f.left-f.right,z=205-f.top-f.bottom):(R=340-f.left-f.right,z=205-f.top-f.bottom);const Ce=m-C,w=parseInt(String(Ce/4));let j=[C+w/4,C+w,C+2*w,m-w,m-w/4];const ee=C,le=m,H=R/(le-ee);e.currentPriceTab==="full range"&&(j=[C,C+2*w,m]);const He=j.map(s=>e.direction?Ot(s,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new o(1).div(Ot(s,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),N=E(He);dt("#chart").selectAll("*").remove();const me=dt("#chart").attr("width",R+f.left+f.right).attr("height",z+f.top+f.bottom).append("g").attr("transform",`translate(${f.left},${f.right})`),Je=mi(a,function(s){return Number(Math.abs(s.liquityAmount))})||0,Ne=vi().range([0,z]).domain([Je,0]);fi().rangeRound([0,R]).padding(.1);const et=me.append("g").attr("id","barsBox").selectAll("rect").data(a).enter().append("rect");I.value.theme=="default"?et.attr("x",function(s,c){return c===0?0:e.direction?Math.abs(s.index-ee)*H:Math.abs(le-s.index)*H}).attr("y",function(s,c){return e.direction?c===a.length-1?0:Ne(s.liquityAmount):c===a.length-1?0:Ne(a[c+1].liquityAmount)}).attr("width",function(s,c){return c===0&&a.length===1&&s.liquityAmount>0?R:(e.direction,c!==a.length-1?Math.abs(a[c+1].index-s.index)*H:0)}).attr("height",function(s,c){return c===0&&a.length===1&&s.liquityAmount>0?z:e.direction?c===a.length-1?0:z-Ne(s.liquityAmount):c===a.length-1?0:z-Ne(a[c+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):et.attr("x",function(s,c){return c===0?0:e.direction?Math.abs(s.index-ee)*H:Math.abs(le-s.index)*H}).attr("y",function(s,c){return e.direction?c===a.length-1?0:Ne(Math.abs(s.liquityAmount)):c===a.length-1?0:Ne(Math.abs(a[c+1].liquityAmount))}).attr("width",function(s,c){return c===0&&a.length===1&&s.liquityAmount>0?R:(e.direction,c!==a.length-1?Math.abs(a[c+1].index-s.index)*H:0)}).attr("height",function(s,c){if(c===0&&a.length===1&&s.liquityAmount>0)return z;if(e.direction)return c===a.length-1?0:Number(s.liquityAmount)?z-Ne(Math.abs(s.liquityAmount)):0;{if(c===a.length-1)return 0;const Re=z-Ne(Math.abs(a[c+1].liquityAmount));return Number(a[c+1].liquityAmount)?Re:0}}).attr("fill",function(s,c){return"#417494"}).attr("class","bars").attr("stroke-width",1).attr("stroke",function(s,c){return"#417494"});const Ke=me.append("g");Ke.append("line").attr("x1",0).attr("y1",155).attr("x2",R).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const Qe=Ke.append("g");let J=0;if(e.direction){for(let s=0;s<j.length;s++){const c=ce(He[s],N)||"0";He.push(c);const Re=Math.abs(j[s]-ee)*H;let te=0;for(let ue=0;ue<c.length;ue++)c[ue]==="1"?te+=4.02:c[ue]==="."?te+=2.64:c[ue]==="7"?te+=5.48:te+=6;Qe.append("text").text(c).attr("x",Re-te/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}J=Math.abs(V-ee)*H}else{for(let s=j.length-1;s>=0;s--){const c=ce(He[s],N)||0;He.push(c);const Re=Math.abs(j[s]-le)*H;let te=0;for(let ue=0;ue<c.length;ue++)c[ue]==="1"?te+=4.02:c[ue]==="."?te+=2.64:c[ue]==="7"?te+=5.48:te+=6;Qe.append("text").text(c).attr("x",Re-te/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}J=Math.abs(V-le)*H}(I.value.theme=="default"?me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+J+", 0)");let Ae,t,d,P;e.direction?(Ae=X<ee?-100:parseInt(String(Math.abs(X-ee)*H)),t=U<ee?-100:parseInt(String(Math.abs(U-ee)*H)),d=y<ee?-100:Math.abs(y-ee)*H,P=Pe<ee?-100:Math.abs(Pe-ee)*H):(t=X<ee?-100:Math.abs(le-X)*H,Ae=U<ee?-100:Math.abs(le-U)*H,P=y>le?-100:Math.abs(le-y)*H,d=Pe>le?-100:Math.abs(le-Pe)*H),e.minPrice==="0"&&(Ae=0),e.maxPrice==="âˆž"&&(t=R),be.value?de.value=R-Ae+94+"px":de.value=R-Ae+87+"px",ae.value=t+98+"px",y&&d<R&&me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+d+", 0)"),Pe&&P<R&&me.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+P+", 0)");const b=me.append("g").attr("id","left-handle"),B=me.append("g").attr("id","right-handle");I.value.theme=="default"?(b.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),b.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 20) rotate(180)"),b.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),b.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),B.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),B.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),B.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),B.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(b.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),b.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(-1, 24) rotate(180)"),b.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),b.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),B.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),B.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#333").attr("stroke","#333").attr("transform","translate(1, 0)"),B.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),B.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),b.attr("transform","translate("+Ae+", 0)"),B.attr("transform","translate("+t+", 0)");const ve=gi().extent([[0,0],[R,z]]).handleSize(30).on("end",Le);me.append("g").attr("class","brush").call(ve).call(ve.move,[Ae,t]);function Le(s){if(!s.sourceEvent||!s.selection)return;b.attr("transform","translate("+s.selection[0]+", 0)"),B.attr("transform","translate("+s.selection[1]+", 0)"),be.value,de.value=R-s.selection[0]+87+"px",ae.value=s.selection[1]+74+"px";let c,Re,te=0,ue=0;e.direction?(te=A(parseInt(String(s.selection[0]/H+ee)),Number(e.poolInfo.tickSpacing)),c=n.tickIndexToPrice(te,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ue=A(parseInt(String(s.selection[1]/H+ee)),Number(e.poolInfo.tickSpacing)),Re=n.tickIndexToPrice(ue,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(ue=A(le-s.selection[0]/H,Number(e.poolInfo.tickSpacing)),c=1/n.tickIndexToPrice(ue,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),te=A(le-s.selection[1]/H,Number(e.poolInfo.tickSpacing)),Re=1/n.tickIndexToPrice(te,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),l.emit("onChangeMinPrice",String(ce(String(c),6))),l.emit("onChangeMaxPrice",String(ce(String(Re),6)))}I.value.theme=="default"?dt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):dt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};return F(""),Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom,e.tickList],([a,C,m,X,U,V])=>{a&&C&&m&&(a!=null&&a.liquidity)&&Y(a,U)},{immediate:!0}),{store:I,loading:x,rangeSizeLower:se,rangeSizeUpper:L,rangeSizeLowerPosition:de,rangeSizeUpperPosition:ae,decimalFormat:ai,numberformat:kt}}});const Ai=e=>(Tt("data-v-662ad41d"),e=e(),It(),e),Ni={class:"chart-box"},Li={class:"chart"},qi=Ai(()=>r("svg",{id:"chart"},null,-1));function Mi(e,l,de,ae,$,se){const L=zt;return M(),Z("div",Ni,[jt(r("div",Li,[e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(M(),Z("div",{key:0,class:"range-size range-size-lower",style:_t({right:e.rangeSizeLowerPosition})},G(("numberformat"in e?e.numberformat:ne(kt))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):K("",!0),e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(M(),Z("div",{key:1,class:"range-size range-size-upper",style:_t({left:e.rangeSizeUpperPosition})},G(("numberformat"in e?e.numberformat:ne(kt))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):K("",!0),qi],512),[[ri,!e.chartLoading]]),e.chartLoading?(M(),Ze(L,{key:0})):K("",!0)])}const Kt=at(Ii,[["render",Mi],["__scopeId","data-v-662ad41d"]]),$i=nt({props:{lever:{type:String,default:""}},setup(){return{}}});const Fi=e=>(Tt("data-v-47f26f4b"),e=e(),It(),e),Ri={class:"lever"},Bi=Fi(()=>r("div",{class:"lever-title"},[r("span",null,"Leverage"),r("svg",{"aria-hidden":"true",class:"icon"},[r("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),Oi={class:"lever-text"};function Ui(e,l,de,ae,$,se){const L=At;return M(),Z("div",Ri,[Fe(L,{"overlay-class-name":"lever-tooltip"},{title:Ve(()=>[xe("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Ve(()=>[Bi]),_:1}),r("div",Oi,G(e.lever),1)])}const ji=at($i,[["render",Ui],["__scopeId","data-v-47f26f4b"]]),zi=nt({components:{NewLiquidityD3Chart:Kt,NewLiquidityPrice:Xt},setup(){const{t:e,locale:l}=Ht(),de=F("liquidity"),ae=ut(),$=k(()=>ae),se=k(()=>$.value.chainName),L=St(),O=k(()=>L),I=k(()=>$.value.chainName?Ct($.value.chainName):{});Ut(()=>{it.value=!1});const Q=Nt(),n=k(()=>{let t=null;for(let d=0;d<O.value.poolConfigList.length;d++){const P=O.value.poolConfigList[d];P.address==Q.query.poolAddress&&(t=P)}return t}),A=k(()=>{let t=null;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:481 ~ constpoolInfo:any=computed ~ pools.value.poolsObj:",O.value.poolsObj);for(const d in O.value.poolsObj){const P=O.value.poolsObj[d];P.address==Q.query.poolAddress&&(t=P)}return t}),E=F(),Y=F(!0),be=async(t,d)=>{var s,c;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-left.vue:497 ~ watchPoolInfo ~ pool:",t),Y.value=!0,tt.value=[],v.value=[],Ue.value=!1;const P=t.token_a.decimals,b=t.token_b.decimals;st.tickIndexToPrice(t.current_tick_index,P,b),lt.value=st.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((s=t==null?void 0:t.object)==null?void 0:s.current_sqrt_price),P,b).toString(),mt.value=new o(1).div(st.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((c=t==null?void 0:t.object)==null?void 0:c.current_sqrt_price),P,b)).toString(),_.value=t.needReverse?t.token_b:t.token_a,p.value=t.needReverse?t.token_a:t.token_b,E.value=t.needReverse,t.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&t.token_b.address.toLowerCase()===p.value.address.toLowerCase()?ye.value=!0:ye.value=!1;let B={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const{list:ve,address:Le}=await I.value.getTicks(B);tt.value=ve&&Le==t.address?I.value.getTickDataFromUrlData(ve):[],t!=null&&t.current_tick_index&&(C(t),Y.value=!1)},x=t=>{var b,B;const d=t.token_a.decimals,P=t.token_b.decimals;lt.value=st.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((b=t==null?void 0:t.object)==null?void 0:b.current_sqrt_price),d,P).toString(),mt.value=new o(1).div(st.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((B=t==null?void 0:t.object)==null?void 0:B.current_sqrt_price),d,P)).toString()},v=F([]),a=F(),C=async t=>{const d=t.token_a.decimals,P=t.token_b.decimals;let b=O.value.poolPriceConfigObj&&O.value.poolPriceConfigObj[t.address]&&O.value.poolPriceConfigObj[t.address].recommend_ranges||{};const B=O.value.poolPriceConfigObj&&O.value.poolPriceConfigObj[t.address]&&O.value.poolPriceConfigObj[t.address].type||"";let ve,Le;const s=bi(t.current_tick_index,t.tickSpacing);a.value=t.current_tick_index,ve=s-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),Le=s+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const c=I.value.TickMath.tickIndexToPrice(ve,d,P).toString(),Re=I.value.TickMath.tickIndexToPrice(Le,d,P).toString();b["full range"]={lower:I.value.TickUtil.getMinIndex(Number(A.value.tickSpacing)),upper:I.value.TickUtil.getMaxIndex(Number(A.value.tickSpacing))},b.custom={lower:ve,upper:Le,minPrice:c,maxPrice:Re};const te=[];for(let ue in b)b[ue]&&te.push({...b[ue],key:ue});B&&te&&te.length>2?t.isSelfBuilt?W.value="custom":B=="stable"?W.value="suggested":W.value="passive":W.value="custom",v.value=te||{},Ye.value=b,U({key:W.value,...b[W.value]})},m=F(""),X=F(""),U=t=>{W.value=t.key.toLowerCase();const d=A.value.token_a.decimals,P=A.value.token_b.decimals,{lower:b,upper:B}=t;Ee.value=!1;const ve=I.value.TickMath.tickIndexToPrice(b,d,P).toString(),Le=I.value.TickMath.tickIndexToPrice(B,d,P).toString();if(t.key=="full range"){m.value=b,X.value=B,V();return}ye.value?(bt.value=String(ve),q.value=String(ve),ht.value=String(Le),h.value=String(Le),m.value=b,X.value=B):(bt.value=new o(1).div(new o(Le)).toString(),q.value=new o(1).div(new o(Le)).toString(),ht.value=new o(1).div(new o(ve)).toString(),h.value=new o(1).div(new o(ve)).toString(),m.value=I.value.TickMath.priceToTickIndex(new o(1/Number(Le)),d,P),X.value=I.value.TickMath.priceToTickIndex(new o(1/Number(ve)),d,P))},V=t=>{q.value="0",h.value="âˆž"};Ie(()=>A.value,(t,d)=>{(!d&&t&&!re(t)||d&&t&&((d==null?void 0:d.current_tick_index)!==(t==null?void 0:t.current_tick_index)||(d==null?void 0:d.address)!==(t==null?void 0:t.address)))&&be(t,!d||(t==null?void 0:t.current_tick_index)!==(d==null?void 0:d.current_tick_index)),t&&!re(t)&&x(t),t||(tt.value=[])},{immediate:!0}),Et(()=>{_.value=F(),p.value=F(),tt.value=[]}),Ie(()=>n.value,(t,d)=>{t&&L.setSinglePool(t,{},se.value)},{immediate:!0});const y=t=>{if(se.value=="Sui")switch(t){case"passive":return"/sui-image/icon_ conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}else switch(t){case"passive":return"/image/icon_ conservative@2x.png";case"active":return"/image/icon_active@2x.png";case"full range":return"/image/icon_fullrange@2x.png";case"custom":return"/image/icon_costom@2x.png";case"suggested":return"/image/icon_stabel@2x.png"}},Pe=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},f=t=>{var P,b;const d=O.value.poolPriceConfigObj&&O.value.poolPriceConfigObj[(P=A.value)==null?void 0:P.address]&&O.value.poolPriceConfigObj[(b=A.value)==null?void 0:b.address].type||"";if(v.value.length>2)if(d=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"suggested":return{top:"25%"};case"full range":return{top:"49%"};case"custom":return{top:"75%"}}else if(d=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"full range":return{top:"35%"};case"custom":return{top:"60%"}}},R=F(1),z=()=>{const t=R.value/2;R.value=t},Ce=()=>{const t=R.value*2;R.value=t},w=k(()=>{var t,d,P;return!A.value||re($.value.addressHistTokens)||!$.value.addressHistTokens[(t=A.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((P=$.value.addressHistTokens[(d=A.value)==null?void 0:d.poolAddress])==null?void 0:P.data.map(b=>[b.key,b.value]))}),j=F(30),ee=F("30D"),le=k(()=>ye.value?w.value&&ce(j.value==7?w.value.before_7_d_contract_price_lowest:j.value==24?w.value.before_24_h_contract_price_lowest:w.value.before_30_d_contract_price_lowest,6)||0:w.value&&ce(new o(1).div(j.value==7?w.value.before_7_d_contract_price_highest:j.value==24?w.value.before_24_h_contract_price_highest:w.value.before_30_d_contract_price_highest).toString(),6)||0),H=k(()=>ye.value?w.value&&ce(j.value==7?w.value.before_7_d_contract_price_highest:j.value==24?w.value.before_24_h_contract_price_highest:w.value.before_30_d_contract_price_highest,6)||0:(w.value&&ce(1/Number(j.value==7?w.value.before_7_d_contract_price_lowest:j.value==24?w.value.before_24_h_contract_price_lowest:w.value.before_30_d_contract_price_lowest),6))==1/0?0:w.value&&ce(1/Number(j.value==7?w.value.before_7_d_contract_price_lowest:j.value==24?w.value.before_24_h_contract_price_lowest:w.value.before_30_d_contract_price_lowest),6)||0),He=k(()=>{const t=Number(q.value),d=Number(h.value);if(q.value=="0"&&h.value=="âˆž"||W.value=="full range")return"1x";if(q.value==h.value||W.value=="full range")return"--";if(q.value&&h.value&&q.value!=="0"&&h.value!=="âˆž"){const P=yt(1/(1-Number((t/d)**.25)),2);return Number(P)>0?P+"x":"--"}else return 1}),N=k(()=>{var t,d,P,b,B,ve;return((t=_.value)==null?void 0:t.isSelfBuilt)||((d=p.value)==null?void 0:d.isSelfBuilt)||((b=O.value.tokensObj[(P=_.value)==null?void 0:P.address])==null?void 0:b.isSelfBuilt)||((ve=O.value.tokensObj[(B=p.value)==null?void 0:B.address])==null?void 0:ve.isSelfBuilt)}),me=(t,d)=>{t!==q.value&&W.value=="full range"?U({key:"custom",...v.value.custom}):W.value!=="full range"&&W.value!=="custom"?(W.value="custom",q.value=t):q.value=t,J.value&&(Ue.value?(ye.value&&q.value!==J.value.minPrice&&(Ue.value=!1),!ye.value&&Number(q.value)!==1/Number(J.value.maxPrice)&&(Ue.value=!1)):(ye.value&&q.value==J.value.minPrice&&h.value==J.value.maxPrice&&(Ue.value=!0),!ye.value&&Number(q.value)==1/Number(J.value.maxPrice)&&Number(h.value)==1/Number(J.value.minPrice)&&(Ue.value=!0)))},Je=(t,d)=>{t!==h.value&&W.value=="full range"?U({key:"custom",...v.value.custom}):W.value!=="full range"&&W.value!=="custom"?(W.value="custom",t=="0"?h.value="âˆž":h.value=t):t=="0"?h.value="âˆž":h.value=t,J.value&&(Ue.value?(ye.value&&h.value!==J.value.maxPrice&&(Ue.value=!1),!ye.value&&Number(h.value)!==1/Number(J.value.minPrice)&&(Ue.value=!1)):(ye.value&&q.value==J.value.minPrice&&h.value==J.value.maxPrice&&(Ue.value=!0),!ye.value&&Number(q.value)==1/Number(J.value.maxPrice)&&Number(h.value)==1/Number(J.value.minPrice)&&(Ue.value=!0)))},Ne=t=>{var d;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((d=O.value.tokensObj[t==null?void 0:t.address])==null?void 0:d.logo_url)||($.value.theme==="default"?Pt("/image/coins/unknown.png"):Pt("/image/coins/sui-unknown.png"))},ot=t=>{switch(t){case"active":return e("newAdd.activeTips");case"passive":return e("newAdd.passiveTips");case"full range":return e("newAdd.fullRangTips");case"suggested":return e("newAdd.suggestedTips");case"custom":return e("newAdd.customTips")}},et=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],Ke=vt(),Qe=k(()=>Ke),J=k(()=>{var t;return Qe.value.farmsPoolObj[(t=A==null?void 0:A.value)==null?void 0:t.address]}),rt=k(()=>O.value.poolPriceConfigObj);Ie(()=>[Ue.value,A.value,v.value,rt.value,J.value,ye.value],(t,d)=>{var P,b;if(t[0]&&t[4]&&!re(t[4]))W.value="custom",q.value=t[5]?t[4].minPrice:String(1/t[4].maxPrice),h.value=t[5]?t[4].maxPrice:String(1/t[4].minPrice);else if(t[1]&&!re(t[1])&&t[2]&&!re(t[2])&&t[3]&&!re(t[3])&&t[4]&&!re(t[4])){t[3]&&t[3][(P=t[1])==null?void 0:P.address]&&t[3][(b=t[1])==null?void 0:b.address].type;const B=t[2].filter(ve=>ve.key===(t[2].length==4?"passive":"suggested"));B!=null&&B[0]&&(!d||d[0]!==t[0])&&U({...B[0]})}},{immediate:!0});const Ae=k(()=>O.value.poolsLoading);return{positionError:it,getCoinIcon:Ne,chainName:se,store:$,currentTab:de,currentPrice:lt,currentPriceReverse:mt,fromCoin:_,toCoin:p,direction:ye,needReverse:E,addCommom:$e,decimalUi:ce,priceTablList:v,currentPriceTab:W,sliderStyle:f,poolInfo:A,tickList:tt,getPriceTabImage:y,getPriceTabText:Pe,defaultMinPrice:bt,defaultMaxPrice:ht,minPrice:q,maxPrice:h,currentTick:a,chartLoading:Y,zoomOut:z,zoomIn:Ce,zoom:R,priceTab:U,before7dContractPriceLowest:le,before7dContractPriceHighest:H,aprRewardsTime:ee,lever:He,aprRewardsParameter:j,isSelfBuilt:N,priceRangeChangeMin:me,priceRangeChangeMax:Je,toggle:Gt,getPirceTabTips:ot,timeList:et,farmsPoolInfo:J,checkNullObj:re,isStableFarmingRange:Ue,poolsLoading:Ae}}});const Hi={class:"new-liquidity-left"},Ei=r("span",{class:"selectRange"},"Select Range",-1),Xi={class:"price-info"},Di={class:"left"},Wi={class:"base-coin"},Zi={class:"base-coin-title"},Gi=r("span",null,"Base coin",-1),Ji=r("svg",{class:"icon icon-up","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_up1"})],-1),Ki=r("svg",{class:"icon icon-down","aria-hidden":"true"},[r("use",{"xlink:href":"#icon-exchange_down1"})],-1),Qi=[Ji,Ki],Yi={class:"base-coin-bottom"},xi={alt:""},Vi={class:"current-price"},en=r("div",{class:"current-price-title"},"Current Price",-1),tn={key:0,class:"from-pre-to"},nn={class:"right"},an={class:"price-range"},on={class:"left"},rn={class:"price-slider"},sn={class:"slider"},ln=r("div",{class:"slider-ratio-content"},null,-1),un=[ln],cn={class:"price-tab-list"},dn=["onClick"],mn=["src"],vn={class:"right"},fn={class:"price-zoom"},gn={class:"current-price"},pn=r("div",{class:"current-price-title"},"Current Price",-1),bn={key:0,class:"from-pre-to"},hn={class:"price-zoom-right"},kn={class:"leverage"},yn=r("div",{class:"left"},null,-1),_n={class:"right"},wn={class:"right-time"},Pn={key:0,class:"day-7-price-range"},Cn=r("i",null,null,-1),Sn={class:"gray"},Tn={class:"time-list"},In=["onClick"],An={class:"right-price-h5"},Nn={class:"range pc-range"},Ln={key:0,class:"stable-farming-range pc-stable-farming-range"},qn=r("img",{src:Jt},null,-1),Mn={class:"check-box-active"},$n={key:1,class:"stable-farming-range h5-stable-farming-range"},Fn=r("span",null,[r("img",{src:Jt}),xe(" Farm rewards rangeï¼š ")],-1),Rn={class:"check-box-active"},Bn={key:2,class:"position-tips"},On=["src"],Un={class:"error"};function jn(e,l,de,ae,$,se){var E,Y,be,x,v,a,C,m,X,U,V;const L=At,O=Kt,I=ji,Q=li,n=Xt,A=si("image");return M(),Z("div",Hi,[Ei,r("div",Xi,[r("div",Di,[r("div",Wi,[r("div",Zi,[Gi,r("div",{class:"change-price",onClick:l[0]||(l[0]=(...y)=>e.toggle&&e.toggle(...y))},Qi)]),r("div",Yi,[jt(r("img",xi,null,512),[[A,e.getCoinIcon(e.fromCoin)]]),r("span",null,G((E=e.fromCoin)==null?void 0:E.symbol),1)])]),r("div",Vi,[en,r("div",null,[r("span",null,G(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.currentPrice,6)):("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(M(),Z("span",tn,G((Y=e.toCoin)==null?void 0:Y.symbol)+" per "+G((be=e.fromCoin)==null?void 0:be.symbol),1)):K("",!0)])])]),r("div",nn,[e.currentTab=="liquidity"?(M(),Z("div",{key:0,class:"zoom-out",onClick:l[1]||(l[1]=(...y)=>e.zoomOut&&e.zoomOut(...y))}," + ")):K("",!0),e.currentTab=="liquidity"?(M(),Z("div",{key:1,class:"zoom-in",onClick:l[2]||(l[2]=(...y)=>e.zoomIn&&e.zoomIn(...y))}," - ")):K("",!0)])]),r("div",an,[r("div",on,[r("div",rn,[r("div",sn,[r("div",{class:"slider-ratio",style:_t(e.sliderStyle(e.currentPriceTab))},un,4)])]),r("div",cn,[(M(!0),Z(wt,null,Rt(e.priceTablList,y=>(M(),Z("div",{key:y.key,class:pt(["price-tab-item",e.currentPriceTab==y.key?"price-tab-item-active":""]),onClick:Pe=>e.priceTab(y)},[Fe(L,{placement:"bottom","arrow-point-at-center":""},{title:Ve(()=>[xe(G(e.getPirceTabTips(y.key)),1)]),default:Ve(()=>[r("img",{src:e.getPriceTabImage(y.key),alt:""},null,8,mn),r("span",null,G(e.getPriceTabText(y.key)),1)]),_:2},1024)],10,dn))),128))])]),r("div",vn,[r("div",fn,[r("div",gn,[pn,r("div",null,[r("span",null,G(e.poolInfo?e.direction&&!e.needReverse?("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.currentPrice,6)):("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(M(),Z("span",bn,G(e.direction&&!e.needReverse?`${(x=e.fromCoin)==null?void 0:x.symbol} per ${(v=e.toCoin)==null?void 0:v.symbol}`:`${(a=e.toCoin)==null?void 0:a.symbol} per ${(C=e.fromCoin)==null?void 0:C.symbol}`),1)):K("",!0)])]),r("div",hn,[e.currentTab=="liquidity"?(M(),Z("div",{key:0,class:"zoom-out",onClick:l[3]||(l[3]=(...y)=>e.zoomOut&&e.zoomOut(...y))}," + ")):K("",!0),e.currentTab=="liquidity"?(M(),Z("div",{key:1,class:"zoom-in",onClick:l[4]||(l[4]=(...y)=>e.zoomIn&&e.zoomIn(...y))}," - ")):K("",!0)])]),e.poolInfo?(M(),Ze(O,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):K("",!0)])]),r("div",kn,[yn,r("div",_n,[r("div",wn,[e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(M(),Z("div",Pn,[Cn,r("span",Sn,G(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),r("span",null,G(("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.before7dContractPriceLowest,6)))+" - "+G(("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.before7dContractPriceHighest,6))),1)])):K("",!0),r("div",Tn,[(M(!0),Z(wt,null,Rt(e.timeList,y=>(M(),Z("div",{key:y.value,class:pt(["time-item",y.value==e.aprRewardsParameter?"time-item-active":""]),onClick:Pe=>e.aprRewardsParameter=y.value},G(y.label),11,In))),128))])]),r("div",An,[r("span",null,G(("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.before7dContractPriceLowest,6)))+" - "+G(("addCommom"in e?e.addCommom:ne($e))(("decimalUi"in e?e.decimalUi:ne(ce))(e.before7dContractPriceHighest,6))),1)])])]),r("div",{class:pt(["apr-and-price",e.positionError&&e.poolInfo?"padding-apr-and-price":""])},[Fe(I,{lever:e.lever},null,8,["lever"]),r("div",Nn,[e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:ne(re))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(M(),Z("div",Ln,[r("span",null,[qn,xe(" Farm rewards rangeï¼š"+G(("decimalUi"in e?e.decimalUi:ne(ce))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+G(("decimalUi"in e?e.decimalUi:ne(ce))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+G((m=e.toCoin)==null?void 0:m.symbol)+" per "+G((X=e.fromCoin)==null?void 0:X.symbol),1)]),r("div",Mn,[Fe(Q,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:l[5]||(l[5]=y=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):K("",!0),e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:ne(re))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(M(),Z("div",$n,[Fn,r("div",Rn,[xe(G(("decimalUi"in e?e.decimalUi:ne(ce))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+" - "+G(("decimalUi"in e?e.decimalUi:ne(ce))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" "+G((U=e.toCoin)==null?void 0:U.symbol)+" per "+G((V=e.fromCoin)==null?void 0:V.symbol)+" ",1),Fe(Q,{class:"range-alerts-switch",checked:e.isStableFarmingRange,onClick:l[6]||(l[6]=y=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):K("",!0),Fe(n,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(M(),Z("div",Bn,[r("img",{src:("importIcon"in e?e.importIcon:ne(Pt))("/image/icon-tips-error@2x.png"),alt:""},null,8,On),r("p",Un,G(e.$t("tips.positionError")),1)])):K("",!0)])],2)])}const Qt=at(zi,[["render",jn]]),zn=nt({props:{poolInfo:{type:Object,default:()=>({})},isActive:{type:Boolean,default:!0}},setup(e,l){const de=vt(),ae=k(()=>de),$=F(!1),se=F(),L=F(!0),O=ut(),I=k(()=>O),Q=k(()=>I.value.newTopPoolsObj);k(()=>ae.value.farmsPoolList);const n=E=>{var x,v,a,C;const Y=E[(x=e==null?void 0:e.poolInfo)==null?void 0:x.poolAddress]||{};let be=0;Y&&!re(Y)&&((a=(v=Y==null?void 0:Y.stable_farming)==null?void 0:v.stable_rewarder)==null||a.forEach(m=>{m.amount_second>0&&(be+=m.amount_second)}),be>0?($.value=!0,se.value={id:Y.stable_farming.stable_farming_pool,clmm_pool_id:(C=e==null?void 0:e.poolInfo)==null?void 0:C.poolAddress},l.emit("sendFarmsPoolInfo",L.value&&e.isActive?se.value:"")):($.value=!1,l.emit("sendFarmsPoolInfo","")))};return Ie(()=>[Q.value,e.poolInfo],([E,Y])=>{E&&!re(E)&&Y&&!re(Y)&&n(E)},{immediate:!0}),Ie(()=>[e.isActive,L.value,se.value],([E,Y,be])=>{l.emit("sendFarmsPoolInfo",Y&&e.isActive?be:"")},{immediate:!0}),{isShowAutoStake:$,changeIsOpen:()=>{L.value=!L.value,l.emit("sendFarmsPoolInfo",L.value&&e.isActive?se.value:"")},isOpen:L}}}),Hn=""+globalThis.__publicAssetsURL("sui-image/farming_huo.png"),En=""+globalThis.__publicAssetsURL("sui-image/icon_sel@2x.png");const Lt=e=>(Tt("data-v-20c0ad07"),e=e(),It(),e),Xn={key:0,class:"farms-auto-stake"},Dn=Lt(()=>r("img",{class:"farms-icon",src:Hn,alt:""},null,-1)),Wn=Lt(()=>r("div",{class:"desc"},"Automatically stake your position into the farm to enjoy higher yield.",-1)),Zn={key:0,src:En,alt:""},Gn=Lt(()=>r("div",{class:"check-box"},null,-1));function Jn(e,l,de,ae,$,se){const L=At;return e.isShowAutoStake?(M(),Z("div",Xn,[Dn,Wn,e.isActive?(M(),Z("div",{key:0,class:"check-box-active",onClick:l[0]||(l[0]=(...O)=>e.changeIsOpen&&e.changeIsOpen(...O))},[e.isOpen?(M(),Z("img",Zn)):K("",!0)])):(M(),Ze(L,{key:1,"overlay-style":{"min-width":"200px"}},ui({default:Ve(()=>[Gn]),_:2},[e.isActive?void 0:{name:"title",fn:Ve(()=>[xe("Farming rewards only available for active positions.")]),key:"0"}]),1024))])):K("",!0)}const Kn=at(zn,[["render",Jn],["__scopeId","data-v-20c0ad07"]]),Qn=nt({components:{NewLiquidityTitle:Dt,NewLiquidityAssetsCard:Wt,NewLiquidityDepositRatio:Zt},setup(){const{t:e,locale:l}=Ht(),de=ut(),ae=k(()=>de),$=k(()=>ae.value.chainName),se=St(),L=k(()=>se),O=hi(),I=k(()=>O),Q=Nt(),n=k(()=>{let i=null;for(const u in L.value.poolsObj){const g=L.value.poolsObj[u];g.address==Q.query.poolAddress&&(i=g)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:272 ~ constpoolInfo:any=computed ~ info:",i),i}),A=F(!1),E=F(!1),Y=k(()=>ae.value.theme),be=async(i,u)=>{_.value=i.needReverse?i.token_b:i.token_a,p.value=i.needReverse?i.token_a:i.token_b,S.value="",T.value=""},x=k(()=>I.value.assets&&_.value&&I.value.assets[_.value.address]?Ft(I.value.assets[_.value.address].balance,_.value.decimals):"0"),v=k(()=>I.value.assets&&p.value&&I.value.assets[p.value.address]?Ft(I.value.assets[p.value.address].balance,p.value.decimals):"0"),a=i=>{i==="fromCoin"?(Te.value=!0,$.value==="Aptos"?S.value=Number(x.value)>0?_.value.symbol=="APT"?new o(Number(x.value)).sub(new o(.1)).lt(new o(0))?"0":new o(Number(x.value)).sub(new o(.1)).toString():String(x.value):"":S.value=Number(x.value)>0?_.value.symbol=="SUI"?new o(Number(x.value)).sub(new o(.05)).lt(new o(0))?"0":new o(Number(x.value)).sub(new o(.05)).toString():String(x.value):""):(Te.value=!1,$.value==="Aptos"?T.value=Number(v.value)>0?p.value.symbol=="APT"?new o(Number(v.value)).sub(new o(.1)).lt(new o(0))?"0":new o(Number(v.value)).sub(new o(.1)).toString():String(v.value):"":T.value=Number(v.value)>0?p.value.symbol=="SUI"?new o(Number(v.value)).sub(new o(.05)).lt(new o(0))?"0":new o(Number(v.value)).sub(new o(.05)).toString():String(v.value):"")},C=i=>{i==="fromCoin"?(Te.value=!0,S.value=Number(x.value)>0?yt(new o(Number(x.value)).div(2).toString(),_.value.decimals).toString():""):(Te.value=!1,T.value=Number(v.value)>0?yt(new o(Number(v.value)).div(2).toString(),p.value.decimals).toString():"")},m=F(),X=F(),U=F(),V=F(!1),y=i=>{var u,g,fe,D;m.value=i,i==="fromCoin"?(X.value=((u=p.value)==null?void 0:u.address)||"",U.value=Q.query.actions=="new-position"?(g=_.value)==null?void 0:g.address:n.value.needReverse?n.value.token_b.address:n.value.token_a.address):(X.value=((fe=_.value)==null?void 0:fe.address)||"",U.value=Q.query.actions=="new-position"?(D=p.value)==null?void 0:D.address:n.value.needReverse?n.value.token_a.address:n.value.token_b.address),V.value=!0},Pe=i=>{var fe,D,_e,we,ge,he,ke,Se;const u=n.value.needReverse?n.value.token_b:n.value.token_a,g=n.value.needReverse?n.value.token_a:n.value.token_b;m.value==="fromCoin"?(((fe=_.value)==null?void 0:fe.address)===(u==null?void 0:u.address)||!((D=_.value)!=null&&D.address)?(p.value&&i.address.toLowerCase()===((_e=p)==null?void 0:_e.value.address.toLowerCase())&&(p.value=null),_.value=i):(_.value&&i.address.toLowerCase()===((we=_)==null?void 0:we.value.address.toLowerCase())&&(_.value=null),p.value=i),Q.query.action||(Q.query.fee="")):((ge=p.value)==null?void 0:ge.address)===(g==null?void 0:g.address)||!((he=p.value)!=null&&he.address)?(_.value&&i.address.toLowerCase()===((ke=_)==null?void 0:ke.value.address.toLowerCase())&&(_.value=null),p.value=i):(p.value&&i.address.toLowerCase()===((Se=p)==null?void 0:Se.value.address.toLowerCase())&&(p.value=null),_.value=i),V.value=!1},f=k(()=>ae.value.chainName?Ct(ae.value.chainName):{}),R=k(()=>ae.value.slippage),z=F(),Ce=async()=>{var je,Me,Be,De;if(Ee.value||!q.value&&!h.value)return!1;if(!S.value&&!T.value&&!q.value&&!h.value)return;const i=n.value||{};if(re(i))return;const{TickUtil:u,TickMath:g,getNearestTickByTick:fe}=f.value,D=i==null?void 0:i.token_a.decimals,_e=i==null?void 0:i.token_b.decimals;let we,ge,he,ke,Se,qe,Xe,Ge,pe=i==null?void 0:i.current_tick_index;if(!pe)return;let ie;if(i.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===p.value.address.toLowerCase()?ie=!0:ie=!1,q.value==="0"&&h.value==="âˆž")he=u.getMinIndex(Number(i.tickSpacing)),ke=u.getMaxIndex(Number(i.tickSpacing)),Se=g.tickIndexToSqrtPriceX64(he),qe=g.tickIndexToSqrtPriceX64(ke);else if(W.value=="custom"){ie?(we=q.value,ge=h.value):(we=h.value!=="âˆž"?new o(1).div(h.value).toString():1/0,ge=new o(1).div(q.value).toString());try{Xe=new o(we).equals(new o(0))?-443636:g.priceToTickIndex(new o(we),D,_e)}catch{Xe=-443636}try{Ge=g.priceToTickIndex(new o(ge),D,_e)}catch{Ge=443636}he=fe(Xe,Number(i.tickSpacing),!0),ke=fe(Ge,Number(i.tickSpacing),!0);try{Se=g.priceToSqrtPriceX64(new o(we),D,_e)}catch{(ge===1/0||ge==="âˆž")&&(Se=g.tickIndexToSqrtPriceX64(u.getMinIndex(Number(i.tickSpacing))))}try{qe=g.priceToSqrtPriceX64(new o(ge),D,_e)}catch{(ge===1/0||ge==="âˆž")&&(qe=g.tickIndexToSqrtPriceX64(u.getMaxIndex(Number(i.tickSpacing))))}}else he=(je=Ye.value[W.value])==null?void 0:je.lower,ke=(Me=Ye.value[W.value])==null?void 0:Me.upper,Se=g.tickIndexToSqrtPriceX64(he),qe=g.tickIndexToSqrtPriceX64(ke);if(h.value!=="âˆž"&&he>=ke){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:639 ~ updateAmounts ~",h.value!=="âˆž"&&he>=ke),A.value=!0,S.value="",E.value=!0,T.value="";return}if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:708 ~ updateAmounts ~ currentTickIndex:",pe),h.value==="âˆž"||pe>=he&&pe<ke){A.value=!1,E.value=!1;let oe;if(S.value||T.value){if(Te.value){const gt=new o(S.value).mul(Math.pow(10,_.value.decimals)).toString();oe=new ze(gt)}else{const gt=new o(T.value).mul(Math.pow(10,p.value.decimals)).toString();oe=new ze(gt)}g.tickIndexToSqrtPriceX64(n.value.current_tick_index);const{liquidityAmount:Oe,tokenMaxA:We,tokenMaxB:ct,tokenMaxAOrigin:ii,tokenMaxBOrigin:ni}=f.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.token_a,tokenB:i.token_b,lowerTick:he,upperTick:ke,coinAmount:oe,iscoinA:ie?Te.value:!Te.value,roundUp:!0,slippage:Number(R.value)/100,curSqrtPrice:new ze(n.value.current_sqrt_price)});z.value={liquidityAmount:Oe,tokenMaxA:We,tokenMaxB:ct,tokenMaxAOrigin:ii,tokenMaxBOrigin:ni},ie?Te.value?T.value=Number(ct)>0?ct:"":S.value=Number(We)>0?We:"":Te.value?T.value=We:S.value=ct}}else if(pe>=ke){if(ie?S.value="":T.value="",A.value=ie,E.value=!ie,S.value||T.value){let oe;if(ie){const Oe=new o(T.value).mul(Math.pow(10,(Be=p.value)==null?void 0:Be.decimals)).toString();oe=new ze(Oe),z.value={liquidityAmount:f.value.estimateLiquidityForCoinB(Se,qe,oe),tokenMaxA:0,tokenMaxB:T.value}}else{const Oe=new o(S.value).mul(Math.pow(10,(De=_.value)==null?void 0:De.decimals)).toString();oe=new ze(Oe),z.value={liquidityAmount:f.value.estimateLiquidityForCoinB(Se,qe,oe),tokenMaxA:0,tokenMaxB:S.value}}}}else if(pe<he){if(A.value=!ie,E.value=ie,ie?T.value="":S.value="",S.value||T.value){let oe;if(ie){const Oe=new o(S.value).mul(Math.pow(10,_.value.decimals)).toString();oe=new ze(Oe),z.value={liquidityAmount:f.value.estimateLiquidityForCoinA(Se,qe,oe),tokenMaxA:S.value,tokenMaxB:0}}else{const Oe=new o(T.value).mul(Math.pow(10,p.value.decimals)).toString();oe=new ze(Oe),z.value={liquidityAmount:f.value.estimateLiquidityForCoinA(Se,qe,oe),tokenMaxA:T.value,tokenMaxB:0}}}}else A.value=!0,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:783 ~ updateAmounts ~ showFromCoinLock.value:",A.value),S.value="",E.value=!0,T.value=""};Ie(()=>n.value,(i,u)=>{(!u&&i&&!re(i)||u&&i&&u.address!==i.address)&&be(i,!u||i.address!==u.address),i&&!re(i)&&Ce()},{immediate:!0}),Ie(S,(i,u)=>{i==""&&Te.value&&(T.value=""),i&&Te.value&&!Ee.value&&Ce()}),Ie(T,(i,u)=>{i==""&&!Te.value&&(S.value=""),i&&!Te.value&&!Ee.value&&Ce()}),Ie(()=>ye.value,(i,u)=>{Ce()}),Ie(()=>[_.value,p.value],([i,u])=>{i&&u&&(A.value=!1,E.value=!1)});const w=F("--"),j=k(()=>L.value.RATES),ee=()=>{const i=j.value&&j.value[_.value.address]&&j.value[_.value.address].price,u=j.value&&j.value[p.value.address]&&j.value[p.value.address].price;if(i&&u){const g=new o(S.value>0?S.value:0).mul(i),fe=new o(T.value>0?T.value:0).mul(u),D=g.add(fe).toNumber();w.value=D>0&&D<.01?"<$0.01":"$"+$e(D,2)}else w.value="--"};Ie(()=>[S.value,T.value,Ee.value],([i,u,g])=>{(i||u)&&!g?ee():(!i||!u)&&!g&&(w.value="--")},{immediate:!0});const le=F(),H=async()=>{var ie,je;if(!q.value&&!h.value)return!1;if(!S.value&&!T.value&&!q.value&&!h.value)return;const i=n.value;if(re(i))return;const{TickUtil:u,TickMath:g,getNearestTickByTick:fe}=f.value,D=i==null?void 0:i.token_a.decimals,_e=i==null?void 0:i.token_b.decimals;let we,ge,he,ke,Se,qe,Xe;if(i.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===p.value.address.toLowerCase()?Xe=!0:Xe=!1,q.value==="0"&&h.value==="âˆž")he=u.getMinIndex(Number(i.tickSpacing)),ke=u.getMaxIndex(Number(i.tickSpacing));else if(W.value=="custom"){Xe?(we=Number(q.value),ge=Number(h.value)):(we=new o(1).div(h.value).toString(),ge=new o(1).div(q.value).toString());try{Se=we==0?-443636:g.priceToTickIndex(new o(we),D,_e)}catch{Se=-443636}try{qe=g.priceToTickIndex(new o(ge),D,_e)}catch{qe=443636}he=fe(Se,Number(i.tickSpacing),!0),ke=fe(qe,Number(i.tickSpacing),!0)}else he=(ie=Ye.value[W.value])==null?void 0:ie.lower,ke=(je=Ye.value[W.value])==null?void 0:je.upper;const Ge=j.value[i==null?void 0:i.token_a.address].price,pe=j.value[i==null?void 0:i.token_b.address].price;ye.value?new ze(i.current_sqrt_price):new ze(1/i.current_sqrt_price);try{const{amountA:Me,amountB:Be,tokenAmountsInfo:De}=await f.value.estCoinAmountsFromTotalAmount({lowerTick:he,upperTick:ke,decimalsA:D,decimalsB:_e,curSqrtPrice:new ze(i.current_sqrt_price),totalAmount:w.value.replace(/[^\d.]/g,""),tokenPriceA:Ge,tokenPriceB:pe});le.value=De,i.needReverse?ye.value?(S.value=Me,T.value=Be):(S.value=Be,T.value=Me):(S.value=Me,T.value=Be)}catch(Me){console.log(Me,"e===>")}};Ie([q,h],([i,u])=>{Ee.value?Ee.value&&H():Ce(),u!=="âˆž"&&Number(i)!==0&&Number(u)!==0&&Number(i)>=Number(u)?it.value=!0:it.value=!1,Number(i)==0&&Number(u)==0&&lt.value&&(it.value=!0)},{deep:!0,immediate:!0});const He=i=>{const u=i.replace(/[^\d.]/g,""),g="$"+$e(u);Ee.value=!0,w.value=g,u>0?H():(S.value="",T.value="")},N=F(!1),{setTransactionTxid:me,setTransactionDesc:Je,setIsShowWaiting:Ne,setIsShowSuccess:ot,setPositiomNum:et,setIsShowRejected:Ke}=de,Qe=Ci(),J=k(()=>L.value.currentPositionInfo),rt=F(!1),Ae=F(!0),t=vt(),d=k(()=>t),P=k(()=>d.value.farmsPoolObj);Ie(()=>[P.value,n.value],([i,u])=>{i&&!re(i)&&u&&!re(u)&&(i[u.address]||(Ae.value=!1))},{immediate:!0});const b=F(),B=F(),ve=i=>{b.value=i,i?Ae.value=!0:Ae.value=!1},Le=async(i,u,g,fe)=>{try{u=="farming"?await L.value.setCurrentPositionInfo("","","","Sui",g,"farming"):await L.value.setCurrentPositionInfo(i,"","",$.value,fe),await oi(3e3),Ae.value?await Qe.subscribePosition({pool_address:J.value.clmm_pool_id,position_index:J.value.name.split("-")[1]},J.value.clmm_position_id):await Qe.subscribePosition({pool_address:J.value.poolAddress,position_index:J.value.index},J.value.nftHash)}catch(D){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1151 ~ notifiSubscribePosition ~ error:",D)}},s=async i=>{var Se,qe,Xe,Ge;N.value=!1,L.value.currentPositionInfo={},me(""),Je(e("tips.increaseLiquiditySuccess",{from:A.value?"":`${$e(S.value)} ${(Se=_.value)==null?void 0:Se.symbol}`,and:!A.value&&!E.value?"and":"",to:E.value?"":`${$e(T.value)} ${(qe=p.value)==null?void 0:qe.symbol}`})),Ne(!0);const u=ye.value?Te.value:!Te.value;let g,fe,D,_e,we,ge;const he=n.value.token_a.decimals,ke=n.value.token_b.decimals;if(q.value==="0"&&h.value==="âˆž")D=f.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),_e=f.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing));else if(W.value=="custom"){ye.value?(g=q.value,fe=h.value):(g=new o(1).div(h.value).toString(),fe=new o(1).div(q.value).toString());try{we=g==0?f.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)):f.value.TickMath.priceToTickIndex(new o(g),he,ke)}catch{we=f.value.TickUtil.getMinIndex(Number(n.value.tickSpacing))}try{ge=f.value.TickMath.priceToTickIndex(new o(fe),he,ke)}catch{ge=f.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))}D=f.value.getNearestTickByTick(we,Number(n.value.tickSpacing),!0),_e=f.value.getNearestTickByTick(ge,Number(n.value.tickSpacing),!0)}else D=Ye.value[W.value].lower,_e=Ye.value[W.value].upper;try{let pe;Ee.value?pe=await f.value.getCreateAddLiquidityPayload({pool:n.value,curSqrtPrice:new ze(n.value.current_sqrt_price),tickLower:D,tickUpper:_e,slippage:Number(R.value)/100,tokenAmounts:le.value}):pe=await f.value.getAddLiquidityTransactionPayload({pool:{poolAddress:n.value.poolAddress,token_a:n.value.token_a,token_b:n.value.token_b},amount:Te.value?S.value:T.value,fix_amount_a:u,tick_lower:D,tick_upper:_e,index:0,slippage:Number(R.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new ze(n.value.current_sqrt_price),farmPoolInfo:b.value});let ie;if($.value==="Aptos")ie=await I.value.currentWallet.signAndSubmitTransaction(pe);else{const je=await f.value.signAndExecuteTransactionBlock(I.value.currentWallet,pe==null?void 0:pe.txb,pe==null?void 0:pe.payloadParams);ie=f.value.handleTx(je)}if(console.log("0410###tx###",ie),ie&&ie.hash){me(ie.hash),Ne(!1),ot(!0);let je;n.value.needReverse?n.value.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===p.value.address.toLowerCase()?je=!1:je=!0:n.value.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===p.value.address.toLowerCase()?je=!0:je=!1;const Me={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:A.value?"":`${$e(S.value)} ${(Xe=_.value)==null?void 0:Xe.symbol}`,and:!A.value&&!E.value?"and":"",to:E.value?"":`${$e(T.value)} ${(Ge=p.value)==null?void 0:Ge.symbol}`}),hash:ie.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};$.value!=="Aptos"&&(Me.res=ie.res),f.value.showTransitionPending(Me),console.log(Me,"toAdd params###");const Be=await f.value.watchTransaction(Me,!0);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1295 ~ toAdd ~ watchInfo:",Be),Be.status){ot(!1),L.value.setCurrentPositionLoading(!0);let De,oe;$.value==="Aptos"?B.value={token_a:n.value.token_a,token_b:n.value.token_b,minPrice:q.value,maxPrice:h.value,pool:n.value.address,collection:Be.nftInfo[0].data.id.collection,tokenName:Be.nftInfo[0].data.name}:(oe=Be.nftInfo,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1319 ~ toAdd ~ nftInfo:",oe),Ae.value?(Be.res.events.forEach(We=>{We.type.indexOf("::pool::DepositEvent")>-1&&(De=We.parsedJson.wrapped_position_id)}),B.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:q.value,maxPrice:h.value,id:De,clmm_pool_id:n.value.address,pool:n.value.address}):B.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:q.value,maxPrice:h.value,pos_object_id:oe.position,pool:n.value.address},console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1389 ~ toAdd ~ positionInfoDetail:",B.value)),rt.value=!0;const Oe=n.value.poolAddress;setTimeout(()=>{if(i){const We=De?"farming":"clmm";console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1400 ~ setTimeout ~ poolInfo.value.poolAddress:",Oe),Le(Oe,We,De,oe==null?void 0:oe.position)}},3e3),setTimeout(()=>{se.updateCurrentPools(Oe,$.value),f.value.getAccount(I.value.address)},3e3),setTimeout(async()=>{Bt(f,n)},7e3)}et()}else Ne(!1),Ke(!0);S.value="",T.value=""}catch(pe){S.value="",T.value="",console.log("0330###Add liquidity Error###",pe),Ne(!1),Ke(!0)}},c=k(()=>!!(!S.value&&!T.value||Number(S.value)>Number(x.value)||Number(T.value)>Number(v.value)||te.value!==e("button.addLiquidity")&&te.value!==e("newAdd.preview")||n.value&&n.value&&n.value.is_pause||Number(S.value)<=0&&Number(T.value)<=0||!A.value&&Number(S.value)==0||!E.value&&Number(T.value)==0)),Re=k(()=>!_.value||!p.value),te=k(()=>n.value&&n.value.is_pause?"Pool Closed":!_.value||!p.value||Re.value?e("modal.selectTokenModalTitle"):Number(S.value)>Number(x.value)?e("button.insufficientBalance",{name:_.value.symbol}):Number(T.value)>Number(v.value)?e("button.insufficientBalance",{name:p.value.symbol}):!Number(S.value)&&!Number(T.value)?e("button.enterAmount"):h.value!=="âˆž"&&Number(q.value)>=Number(h.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),ue=F({}),qt=F({}),Mt=F(!1),ft=(i,u)=>{const g=localStorage.getItem(i.address);console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-right.vue:1518 ~ getTokenSource ~ coinLocak:",g,i),i!=null&&i.isSelfBuilt&&!g&&(u=="fromCoin"&&(ue.value=i),u=="toCoin"&&(qt.value=i),Mt.value=!0)};Ie(()=>[_.value,p.value],([i,u])=>{i&&!re(i)&&ft(i,"fromCoin"),u&&!re(u)&&ft(u,"toCoin")},{immediate:!0});const $t=ci(),xt=()=>{$.value!=="Aptos"?$t.push("/pool/list"):$t.push("/pools")},Vt=i=>{Ee.value,s(i)},ei=()=>{Q.query.action!=="create-pool"&&Q.query.actions!=="new-position"&&(Bt(f,n),Ce(),I.value.address&&f.value.getAccount(I.value.address),se.updateCurrentPools(n.value.poolAddress,$.value)),se.setPoolConfigList($.value,ae.value.filterCoinsObj)},ti=k(()=>{var g,fe,D,_e,we,ge;const i=(D=j.value[(fe=(g=_)==null?void 0:g.value)==null?void 0:fe.address])==null?void 0:D.price,u=(ge=j.value[(we=(_e=p)==null?void 0:_e.value)==null?void 0:we.address])==null?void 0:ge.price;return!!(i&&u)});return Ie(()=>[Q,L.value.tokensObj],([i,u])=>{var g;u&&!re(u)&&(p.value||(p.value=L.value.tokensObj[(g=i==null?void 0:i.query)==null?void 0:g.toCoin]))},{immediate:!0,deep:!0}),{positionError:it,decimalUi:ce,poolInfo:n,fromCoinAmount:S,toCoinAmount:T,fromCoin:_,toCoin:p,theme:Y,showFromCoinLock:A,showToCoinLock:E,fromCoinBlance:x,toCoinBlance:v,maxBtnSelect:a,halfBtnSelect:C,fixedFromCoin:Te,openCoinSelect:y,currentCoinKey:m,existingCoins:X,lastSelectCoin:U,showCoinSelect:V,onCoinSelect:Pe,liquidityTotalAmount:w,toggle:Gt,onInput:He,isInputTotalAmount:Ee,isViewDetail:rt,addLiquidityBtnDisabled:c,addLiquidityBtnText:te,isShowTokenWarning:Mt,chainName:$,closeTokenWarning:xt,warningFromCoin:ue,warningToCoin:qt,isShowLiquidityModal:N,currentPrice:lt,currentPriceReverse:mt,currentPriceTab:W,minPrice:q,maxPrice:h,toAdd:s,direction:ye,wallet:I,getAddLiquidityType:Vt,clickRefresh:ei,isShowtotalAmount:ti,isAutoStakeFarming:Ae,farmPoolInfo:b,getFarmsPoolInfo:ve,positionInfoDetail:B,getTokenSource:ft}}});const Yn={class:"new-liquidity-right"},xn={class:"deposit-title"},Vn={class:"card-container"},ea={key:0,class:"lock"},ta={class:"card-item"},ia={class:"card-item"},na={key:0,class:"total-amount"},aa=r("span",null,"Total Amount",-1);function oa(e,l,de,ae,$,se){const L=Dt,O=pi,I=Wt,Q=yi,n=Zt,A=di,E=_i,Y=wi,be=Pi,x=Kn;return M(),Z("div",Yn,[r("div",xn,[Fe(L,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),r("div",Vn,[e.positionError?(M(),Z("div",ea,[Fe(O)])):K("",!0),r("div",ta,[Fe(I,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":l[0]||(l[0]=v=>e.fromCoinAmount=v),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:l[1]||(l[1]=v=>e.maxBtnSelect("fromCoin")),onOnHalf:l[2]||(l[2]=v=>e.halfBtnSelect("fromCoin")),onOnInput:l[3]||(l[3]=v=>{e.fromCoinAmount=v,e.fixedFromCoin=!0,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock&&!e.positionError?(M(),Ze(Q,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):K("",!0)]),r("div",ia,[Fe(I,{modelValue:e.toCoinAmount,"onUpdate:modelValue":l[4]||(l[4]=v=>e.toCoinAmount=v),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:l[5]||(l[5]=v=>e.maxBtnSelect("toCoin")),onOnHalf:l[6]||(l[6]=v=>e.halfBtnSelect("toCoin")),onOnInput:l[7]||(l[7]=v=>{e.toCoinAmount=v,e.fixedFromCoin=!1,e.isInputTotalAmount=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock&&!e.positionError?(M(),Ze(Q,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])):K("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(M(),Z("img",{key:1,class:"add",src:Si,alt:"",onClick:l[8]||(l[8]=(...v)=>e.toggle&&e.toggle(...v))})):K("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(M(),Z("img",{key:2,class:"add",src:Ti,alt:"",onClick:l[9]||(l[9]=(...v)=>e.toggle&&e.toggle(...v))})):K("",!0)]),e.isShowtotalAmount?(M(),Z("div",na,[aa,r("span",null,G(e.liquidityTotalAmount)+" ",1)])):K("",!0),Fe(n,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),Fe(A,{class:"add-liquidity-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:l[10]||(l[10]=v=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ve(()=>[xe(G(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(M(),Ze(E,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:l[11]||(l[11]=v=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):K("",!0),e.isViewDetail?(M(),Ze(Y,{key:2,"pool-info":e.poolInfo,"farm-pool-info":e.farmPoolInfo,"position-info":e.positionInfoDetail,"is-auto-stake-farming":e.isAutoStakeFarming,onOnClose:l[12]||(l[12]=v=>e.isViewDetail=!1)},null,8,["pool-info","farm-pool-info","position-info","is-auto-stake-farming"])):K("",!0),e.isShowLiquidityModal?(M(),Ze(be,{key:3,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:l[13]||(l[13]=v=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):K("",!0),e.chainName=="Sui"?(M(),Ze(x,{key:4,"pool-info":e.poolInfo,"is-active":!e.showFromCoinLock&&!e.showToCoinLock,"is-auto-stake-farming":e.isAutoStakeFarming,onSendFarmsPoolInfo:e.getFarmsPoolInfo},null,8,["pool-info","is-active","is-auto-stake-farming","onSendFarmsPoolInfo"])):K("",!0)])}const Yt=at(Qn,[["render",oa]]),ra=nt({components:{NewLiquidityLeft:Qt,NewLiquidityRight:Yt},setup(){const e=vt(),l=k(()=>e),de=k(()=>l.value.farmsPoolObj);Et(()=>{ki(),se.setPoolsLoading(!0)}),Ie(()=>de.value,L=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: deposit.vue:41 ~ watch ~ newVal:",L),L&&re(L)&&e.getFarmsPoolList(!0)},{immediate:!0});const ae=Nt(),$=ut();k(()=>$);const se=St();return{tickList:tt,route:ae}}});const sa={key:0,class:"loading-spin-liquidity loading-global"},la={class:"privide-liquidity"};function ua(e,l,de,ae,$,se){var Q,n;const L=zt,O=Qt,I=Yt;return M(),Z(wt,null,[!e.tickList&&((n=(Q=e.route)==null?void 0:Q.query)!=null&&n.poolAddress)?(M(),Z("div",sa,[Fe(L)])):K("",!0),r("div",la,[Fe(O),Fe(I)])],64)}const Za=at(ra,[["render",ua],["__scopeId","data-v-14b489b7"]]);export{Za as default};
