import{m as g,a as b,b as T,r as k,q as h,A as R}from"./entry.8c071894.js";import{u as y}from"./pool.1dcfb707.js";import{u as x,a as F,b as I}from"./usePositionList.60c01465.js";import{h as j,c as q}from"./index.a960bb3c.js";import{u as A}from"./fetchFun.e65ce644.js";import{u as D}from"./useToken.b7867c73.js";import"./decimal.a2826370.js";import{h as O,c as C}from"./common.7b3188ac.js";import{u as B}from"./useRate.3586dd4d.js";import{D as L}from"./decimal.765d8738.js";import{u as N}from"./token.738b956f.js";import{u as K}from"./usePoolList.2fbb1bab.js";import"./index.e235d647.js";function M(){const S=y(),c=g(()=>S);g(()=>c.value.poolsObj);const{positionsObj:r,setCurrentPositionInfo:p}=y(),{getPositionFees:m}=x(),{getPositionReward:d}=F(),{getPoolInfoByContract:w,wrapPositionItem:P}=I(),{getPositionById:v}=j("Sui"),{getFramsPositionNFT:_}=q("Sui");A();const{getToken:s}=D(),{getTokenRatePrice:n}=B(),u=async o=>{const a=[];for(let e=0;e<o.rewards.length;e++){const t=o.rewards[e],i=await s(t.rewarder_type),l=O(t.rewarder_amount).div(L.pow(10,i.decimals)).toString();a.push({...i,rewardAmount:l,rewardAmountUSD:n(i.address,l,i.decimals)})}return{coin_type_a:o.coinTypeA,coin_type_b:o.coinTypeB,name:o.name,pool:o.clmm_pool_id,tick_lower_index:o.tick_lower_index,tick_upper_index:o.tick_upper_index,position_source:"farms",pos_object_id:o.clmm_position_id,farm_position_id:o.id,liquidity:o.liquidity,farmsReward:a}};return{getCurrentPosition:async(o,a="clmm")=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: useCurrentPosition.ts:21 ~ getCurrentPosition ~ positionId:",o,a),r&&r[o]&&p(r[o]);let e,t;a==="clmm"?(t=await v(o),e={...t,position_source:"clmm"}):(t=await _(o),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useCurrentPosition.ts:44 ~ getCurrentPosition ~ posRes:",t),e=await u(t)),console.log("ðŸš€ðŸš€ðŸš€ ~ file: useCurrentPosition.ts:78 ~ getCurrentPosition ~ positionInfo:",e);const i=await w([e.pool]),l=await P(e,i[e.pool]);console.log("ðŸš€ðŸš€ðŸš€ ~ file: useCurrentPosition.ts:82 ~ getCurrentPosition ~ position:",l),p(l),m([t]),d([t],i[e.pool])}}}const oo=b({__name:"new-position-detail",setup(S){const c=T(),{getCurrentPosition:r}=M(),{getPoolList:p}=K(),m=k(),d=k();h(()=>{m.value=c.currentRoute.value.query.id||"",d.value=c.currentRoute.value.query.positionSource||""});const w=y(),P=g(()=>w.poolsObj),v=N(),_=g(()=>v.allTokensObj);return R(()=>_.value,s=>{s&&!C(s)&&p()}),R(()=>[P.value,_.value,m.value,d.value],([s,n,u,f])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ positionSource:",f),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ routerId:",u),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ allTokensObj:",n),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ poolsObj:",s),s&&!C(s)&&n&&!C(n)&&u&&f&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:38 ~ getCurrentPosition:"),r(u,f))},{immediate:!0}),(s,n)=>"1"}});export{oo as default};
