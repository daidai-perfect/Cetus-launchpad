import{a as he,r as $,s as jt,m,A as ie,b as nt,e as Pe,l as Ft,o as f,f as N,h as t,i as j,y as et,p as je,k as Fe,q as St,I as ze,M as At,w as ne,P as pt,x as R,G as ee,u as K,j as ue,N as kt,F as tt,E as ot,B as He,c as ve,$ as Ut,z as $t,fg as Dt,L as Et,fi as zt,D as xt,Y as Wt,C as Ht,O as Xt}from"./entry.acdca605.js";/* empty css              */import{u as Tt}from"./useCurrentPosition.e3482717.js";import{u as Xe}from"./pool.1f45c568.js";import{u as Vt}from"./token.5621c078.js";import{u as it,p as Gt,b as ke,C as Ct,T as wt,n as Jt,m as Yt}from"./index.be8ffb7b.js";import{c as te,g as Qt,n as Kt,d as Oe,o as Zt,b as Ie,a as oe,h as we,p as We,i as ct}from"./common.f371ec22.js";import{a as _t,u as Se,b as Ve,c as eo}from"./index.694816b3.js";import{u as to}from"./usePoolList.fa3bba6e.js";import{_ as oo}from"./back.1c015f35.js";import{I as no}from"./icon-slippage.398e5b25.js";/* empty css              */import{s as Ze,m as io,l as ao,b as so,a as lo}from"./transform.c672907f.js";import"./decimal.a2826370.js";import{D as M}from"./decimal.765d8738.js";import{l as ro,a as uo}from"./linearClosed.d07a7d12.js";import{C as _e}from"./coin-img-warning.a4f6c2fb.js";import{P as Nt,N as co}from"./new-position-range.0b29c765.js";import{s as ft}from"./formatter.c1da724b.js";import{u as vo}from"./useRate.064c5e06.js";import{_ as mo}from"./deposit-ratio.af300874.js";import{S as Ot}from"./select-tab.cbf036ac.js";import{_ as fo}from"./img-lock_2x.a28135f4.js";import{_ as po}from"./img-lock_2x.2b064905.js";import{N as dt}from"./new-assets-card.08a58b38.js";/* empty css              */import{u as qt}from"./notifi.4c97ad81.js";/* empty css              */import{i as Bt}from"./import-icon.de3e6c66.js";import{_ as _o}from"./apr-tips.77d61db3.js";import{u as ho}from"./farms.f24fbd50.js";import"./usePositionList.fc58f0d0.js";import"./useSDK.d022c694.js";import"./useToken.497c00bc.js";import"./fetchFun.ff4aae28.js";import"./swap-setting.41512485.js";/* empty css              */import"./icon-error_2x.51894fef.js";import"./coin-img.3e1f734a.js";import"./token-warning.4623ef64.js";import"./index.8f6ad64c.js";import"./useDebounceFunction.0382450c.js";import"./useWhale.a7105bed.js";import"./icon_fee_2x.0eecaee1.js";import"./icon_rewards_2x.a7a94aaa.js";const go=he({components:{IconSlippage:no},props:{poolInfo:{type:Object,default:()=>({})}},setup(e,h){const y=$(!1),H=$(null),B=$(0),o=$(20),s=_t(),g=Se(),D=$(!1);jt(()=>{clearInterval(H.value)});const I=()=>{H.value=setInterval(()=>{var k;D.value||B.value<o.value&&(B.value+=1,B.value===o.value&&((k=e==null?void 0:e.poolInfo)!=null&&k.poolAddress&&s.updateCurrentPools(e.poolInfo.poolAddress,g.chainName),B.value=0))},1e3)},b=m(()=>g.slippage),l=()=>{h.emit("clearAll")},c=$(!1),_=()=>{B.value=0,c.value=!0,h.emit("clickRefresh"),setTimeout(()=>{c.value=!1},1e3)};ie(()=>e.poolInfo,k=>{k&&!H.value&&I()},{immediate:!0});const x=nt(),U=m(()=>g.chainName);return{clickRefresh:_,isShowSwapSetting:y,countdown:B,autoRefreshTime:o,slippage:b,clearAll:l,checkNullObj:te,router:x,loading:D,chainName:U,refresh:c}}});const bo=e=>(je("data-v-3202c1be"),e=e(),Fe(),e),ko={class:"new-position-title"},wo={class:"left"},yo={class:"right"},Io=bo(()=>t("use",{"xlink:href":"#icon-icon_refresh"},null,-1)),Po=[Io];function So(e,h,y,H,B,o){const s=oo,g=Ft("IconSlippage");return f(),N("div",ko,[t("div",wo,[j(s)]),t("div",yo,[j(g),(f(),N("svg",{"aria-hidden":"true",class:et(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:h[0]||(h[0]=(...D)=>e.clickRefresh&&e.clickRefresh(...D))},Po,2))])])}const Ao=Pe(go,[["render",So],["__scopeId","data-v-3202c1be"]]);function yt(e,h,y){const H=new M(10).pow(h-y);return new M(1.0001).pow(e).mul(H)}const $o=he({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,coinA:{decimal:6},coinB:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,h){const y=$(1),H=$(""),B=$(""),o=m(()=>{var n,v,u;return l.sqrtPriceX64ToPrice((n=e.poolInfo)==null?void 0:n.current_sqrt_price,(v=e.poolInfo)==null?void 0:v.coinA.decimals,(u=e.poolInfo)==null?void 0:u.coinB.decimals).toString()}),s=m(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(o.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(o.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),g=m(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(o.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(o.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),D=Se(),I=m(()=>D),b=m(()=>I.value.chainName?Ve(I.value.chainName):{}),{TickMath:l,getNearestTickByTick:c}=b.value,_=()=>{const n=y.value/2;y.value=n,k(e.poolInfo,n)},x=()=>{const n=y.value*2;y.value=n,k(e.poolInfo,n)},U=(n=[])=>{let v=6;const u=Math.abs(Number(n[0])-Number(n[n.length-1]));return u>=6?v=0:u>=1?v=1:u>=.1?v=2:u>=.01?v=3:u>=.001?v=4:u>=1e-4?v=5:u>=1e-5?v=6:u>=1e-6?v=7:u>=1e-7&&(v=8),v},k=(n,v=1)=>{if(n&&n.coinA&&!e.chartLoading&&e.minPrice&&e.maxPrice){const u=Number(e.poolInfo.current_tick_index);let T=u+100*v,z=u-100*v,Q,i;if(e.maxPrice==="âˆž")i=b.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?i=l.priceToTickIndex(new M(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):i=l.priceToTickIndex(new M(1).div(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{i=443636}if(e.minPrice==="0")Q=b.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?Q=l.priceToTickIndex(new M(e.minPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):Q=l.priceToTickIndex(new M(1).div(e.maxPrice),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)}catch{Q=-443636}let Y=0;if(e.currentPriceTab!=="full range"){if(u>=Q&&u<=i){const S=u-Q,de=i-u;Y=Math.max(Math.abs(S),Math.abs(de))}else u<Q?Y=Math.abs(i-u):Y=Math.abs(u-Q);T=u+Y+20*v,z=u-Y-20*v}else{const S=(Math.abs(u)>5e3,2e4);T=u+S*v,z=u-S*v}z<-443636&&(z=-443636),T>443636&&(T=443636);const O=new M(n.poolLiquidity).div(Math.pow(10,8)).toString(),r=e.tickList,a=[],P=[];let d={};for(let S=0;S<r.length;S++){if(d=r[S],d.index<=u&&d.index>=z){if(a.length<1&&S!==0){const de=r[S-1];a.unshift({...de,index:z})}a.unshift(d)}else if(d.index>u&&d.index<=T&&(P.push(d),a.length<1&&S!==0)){const de=r[S-1];a.push({...de,index:z})}if(d.index>T){const de=r[S];if(P.push({...de,index:T}),a.length<1&&S!==0){const re=r[S-1];a.push({...re,index:z})}break}}let C="0";for(let S=a.length-1;S>=0;S--)C=new M(C).plus(new M(a[S].liquidityNet.toString()).div(Math.pow(10,8))).toString(),a[S].liquityAmount=C;let F=O;for(let S=0;S<P.length;S++)F=new M(F).plus(new M(P[S].liquidityNet.toString()).div(Math.pow(10,8))).toString(),P[S].liquityAmount=F;let G=[];const V=r&&r.length>0?{index:u,liquityAmount:Number(O)}:{index:u,liquityAmount:0};(a.length>0||P.length>0)&&(G=[...a.reverse(),V,...P],e.direction||(G=G.reverse()));const ge=[];r.forEach(S=>{ge.push({...S,liquidityGross:S.liquidityGross.toString(),liquidityNet:S.liquidityNet.toString()})}),J(G,z,T,Q,i,u)}};let E=$(!0);St(()=>{document.body.clientWidth<750?E.value=!1:E.value=!0,window.onresize=()=>{document.body.clientWidth<750?E.value=!1:E.value=!0,k(e.poolInfo,y.value)}});const J=(n,v,u,T,z,Q)=>{let i,Y;e.direction?(i=e.before7dContractPriceLowest?l.priceToTickIndex(new M(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",Y=e.before7dContractPriceHighest?l.priceToTickIndex(new M(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):""):(i=e.before7dContractPriceLowest?l.priceToTickIndex(new M(1).div(e.before7dContractPriceLowest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"",Y=e.before7dContractPriceHighest?l.priceToTickIndex(new M(1).div(e.before7dContractPriceHighest),e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals):"");const O={top:30,right:35,bottom:20,left:55};let r,a;E.value?(r=590-O.left-O.right,a=205-O.top-O.bottom):(r=340-O.left-O.right,a=205-O.top-O.bottom);const P=u-v,d=parseInt(String(P/4));let C=[v+d/4,v+d,v+2*d,u-d,u-d/4];const F=v,G=u,V=r/(G-F);e.currentPriceTab==="full range"&&(C=[v,v+2*d,u]);const ge=C.map(L=>e.direction?yt(L,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString():new M(1).div(yt(L,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals)).toString());U(ge),Ze("#chart").selectAll("*").remove();const S=Ze("#chart").attr("width",r+O.left+O.right).attr("height",a+O.top+O.bottom).append("g").attr("transform",`translate(${O.left},${O.right})`),de=io(n,function(L){return Number(Math.abs(L.liquityAmount))})||0,re=ao().range([0,a]).domain([de,0]);so().rangeRound([0,r]).padding(.1);const ce=S.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");I.value.theme=="default"?ce.attr("x",function(L,W){return W===0?0:e.direction?Math.abs(L.index-F)*V:Math.abs(G-L.index)*V}).attr("y",function(L,W){return e.direction?W===n.length-1?0:re(L.liquityAmount):W===n.length-1?0:re(n[W+1].liquityAmount)}).attr("width",function(L,W){return W===0&&n.length===1&&L.liquityAmount>0?r:(e.direction,W!==n.length-1?Math.abs(n[W+1].index-L.index)*V:0)}).attr("height",function(L,W){return W===0&&n.length===1&&L.liquityAmount>0?a:e.direction?W===n.length-1?0:a-re(L.liquityAmount):W===n.length-1?0:a-re(n[W+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):ce.attr("x",function(L,W){return W===0?0:e.direction?Math.abs(L.index-F)*V:Math.abs(G-L.index)*V}).attr("y",function(L,W){return e.direction?W===n.length-1?0:re(Math.abs(L.liquityAmount)):W===n.length-1?0:re(Math.abs(n[W+1].liquityAmount))}).attr("width",function(L,W){return W===0&&n.length===1&&L.liquityAmount>0?r:(e.direction,W!==n.length-1?Math.abs(n[W+1].index-L.index)*V:0)}).attr("height",function(L,W){if(W===0&&n.length===1&&L.liquityAmount>0)return a;if(e.direction)return W===n.length-1?0:Number(L.liquityAmount)?a-re(Math.abs(L.liquityAmount)):0;{if(W===n.length-1)return 0;const Ce=a-re(Math.abs(n[W+1].liquityAmount));return Number(n[W+1].liquityAmount)?Ce:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const Ye=S.append("g");Ye.append("line").attr("x1",0).attr("y1",155).attr("x2",r).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),Ye.append("g");let Ae=0;e.direction?Ae=Math.abs(Q-F)*V:Ae=Math.abs(Q-G)*V,(I.value.theme=="default"?S.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):S.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+Ae+", 0)"),Ze("#triangle").attr("width",8).attr("height",4);let st=[[0,0],[4,4],[8,0]],gt=ro().x(function(L){return L[0]}).y(function(L){return L[1]}).curve(uo);const vt=Ae-4;S.append("path").attr("d",gt(st)).style("fill",I.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+vt+", 0)");let be,qe,$e,Te;e.direction?(be=T<F?-100:parseInt(String(Math.abs(T-F)*V)),qe=z<F?-100:parseInt(String(Math.abs(z-F)*V)),$e=i<F?-100:Math.abs(i-F)*V,Te=Y<F?-100:Math.abs(Y-F)*V):(qe=T<F?-100:Math.abs(G-T)*V,be=z<F?-100:Math.abs(G-z)*V,Te=i<F?-100:Math.abs(G-i)*V,$e=Y<F?-100:Math.abs(G-Y)*V),e.minPrice==="0"&&(be=0),e.maxPrice==="âˆž"&&(qe=r),E.value?H.value=r-be+60+"px":H.value=r-be+52+"px",B.value=qe+74+"px",i&&$e<r&&S.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+$e+", 0)"),Y&&Te<r&&S.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+Te+", 0)");const lt=lo().extent([[0,0],[r,a]]).handleSize(30).on("end",rt);S.append("g").attr("class","brush").call(lt).call(lt.move,[be,qe]);function rt(L){if(!L.sourceEvent||!L.selection)return;E.value?H.value=r-L.selection[0]+60+"px":H.value=r-L.selection[0]+52+"px",B.value=L.selection[1]+74+"px";let W,Ce,De=0,Ee=0;e.direction?(De=c(parseInt(String(L.selection[0]/V+F)),Number(e.poolInfo.tickSpacing)),W=l.tickIndexToPrice(De,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),Ee=c(parseInt(String(L.selection[1]/V+F)),Number(e.poolInfo.tickSpacing)),Ce=l.tickIndexToPrice(Ee,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()):(Ee=c(G-L.selection[0]/V,Number(e.poolInfo.tickSpacing)),W=1/l.tickIndexToPrice(Ee,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString(),De=c(G-L.selection[1]/V,Number(e.poolInfo.tickSpacing)),Ce=1/l.tickIndexToPrice(De,e.poolInfo.coinA.decimals,e.poolInfo.coinB.decimals).toString()),h.emit("onChangeMinPrice",String(Oe(String(W),6))),h.emit("onChangeMaxPrice",String(Oe(String(Ce),6)))}I.value.theme=="default"?Ze(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):Ze(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};$(""),ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([n,v,u,T,z])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1125 ~ dataProcessing ~ poolInfo:",n),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ tickList:",z),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ currentPriceTab:",T),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ maxPrice:",u),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1126 ~ dataProcessing ~ minPrice:",v),n&&v&&u&&T&&z&&z.length>0&&(T!=="Custom"&&console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:1131 ~ dataProcessing ~ dataProcessing:"),k(n,y.value))},{immediate:!0});const p=$(!0);return ie(()=>e.chartLoading,(n,v)=>{n!==v&&(p.value=n)},{immediate:!0,deep:!0}),{store:I,loading:p,zoomOut:_,zoomIn:x,rangeSizeLower:s,rangeSizeUpper:g,rangeSizeLowerPosition:H,rangeSizeUpperPosition:B,decimalFormat:Qt,numberformat:Kt}}});const xo=e=>(je("data-v-7ae11293"),e=e(),Fe(),e),To={class:"chart-box"},Co={class:"chart"},No=xo(()=>t("svg",{id:"chart"},null,-1)),Oo=[No];function qo(e,h,y,H,B,o){return f(),N("div",To,[ze(t("div",Co,Oo,512),[[At,!e.loading]])])}const Bo=Pe($o,[["render",qo],["__scopeId","data-v-7ae11293"]]),Lo={class:"status-box"},Ro=["src"],Mo={class:"status-text"},jo=he({__name:"new-status-block",props:{positionInfo:{type:Object,default:()=>({})}},setup(e){return(h,y)=>{var B;const H=pt;return f(),N("div",{class:et(["status-block",((B=e.positionInfo)==null?void 0:B.positionStatus)=="Active"?"active-status-block":"inactive-status-block"])},[j(H,{placement:"top","arrow-point-at-center":"","overlay-class-name":"ant-tooltip-text-color"},{title:ne(()=>{var o;return[t("span",null,R(h.$t("tips.statusblocktips",{word:((o=e.positionInfo)==null?void 0:o.positionStatus)==="Active"?"within":"out of"})),1)]}),default:ne(()=>{var o,s,g;return[t("div",Lo,[(o=e.positionInfo)!=null&&o.positionStatus?(f(),N("img",{key:0,src:((s=e.positionInfo)==null?void 0:s.positionStatus)=="Active"?"/sui-image/icon_pos_active@2x.png":"/sui-image/img_inactive@2x.png",alt:""},null,8,Ro)):ee("",!0),t("span",Mo,R((g=e.positionInfo)==null?void 0:g.positionStatus),1)])]}),_:1})],2)}}});const Lt=Pe(jo,[["__scopeId","data-v-7c2cac5e"]]),at=e=>(je("data-v-9c03e432"),e=e(),Fe(),e),Fo={class:"new-position-info"},Uo={class:"pool-info"},Do={class:"info"},Eo={class:"coin-logo"},zo={class:"name-fee"},Wo={class:"name-copy"},Ho=["href"],Xo=at(()=>t("use",{"xlink:href":"#icon-icon_copy2"},null,-1)),Vo=[Xo],Go={class:"pool-fee"},Jo=at(()=>t("span",null,"Fee tier",-1)),Yo={class:"price-info"},Qo={class:"price-and-chart"},Ko={class:"top"},Zo={class:"position-range position-range-warp"},en=at(()=>t("span",{class:"position-range-title"}," Position Range ",-1)),tn={class:"bottom"},on=at(()=>t("div",{class:"chat-mask"},null,-1)),nn={class:"lever"},an={class:"lever-title"},sn=at(()=>t("div",{class:"tit"},[t("span",null," Leverage "),t("svg",{"aria-hidden":"true",class:"icon"},[t("use",{"xlink:href":"#icon-icon_tips"})])],-1)),ln={class:"lever-text"},rn=he({__name:"new-position-info",setup(e){const h=Xe(),y=m(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:643 ~ currentPositionInfo ~ suiPoolStore.currentPositionInfo:",h.currentPositionInfo),h.currentPositionInfo)),H=m(()=>h.poolsObj),B=Se(),o=m(()=>B.currentExplorer);$(!0);const s=(l,c)=>l!=="0"&&c!=="âˆž"?Ie(1/(1-Number((l/c)**.25)),2)+"x":"1x",g=m(()=>y.value.minPrice&&y.value.maxPrice?s(y.value.minPrice,y.value.maxPrice):"--"),D=Ve("Sui"),I=$([]),b=async l=>{const{list:c}=await D.getTicks(l),_=c?D.getTickDataFromUrlData(c):[];console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:593 ~ resetTickList ~ list:",_),I.value=_};return ie(()=>[y.value,H.value],([l,c])=>{l&&!te(l)&&c&&!te(c)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:417 ~ poolsObj:",c),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-info.vue:418 ~ newValue:",l),b(c[l.pool]))},{immediate:!0}),(l,c)=>{var x,U,k,E,J;const _=pt;return f(),N("div",Fo,[t("div",Uo,[t("div",Do,[t("div",Eo,[j(_e,{"token-info":(x=y.value)==null?void 0:x.coinA},null,8,["token-info"]),j(_e,{"token-info":(U=y.value)==null?void 0:U.coinB},null,8,["token-info"])]),t("div",zo,[t("div",Wo,[t("a",{class:"position-name",href:K(Zt)(o.value,"nftAddress",(k=y.value)==null?void 0:k.nftHash),target:"_blank"},R((E=y.value)==null?void 0:E.positionName),9,Ho),(f(),N("svg",{class:"copy-icon","aria-hidden":"true",onClick:c[0]||(c[0]=p=>{var n;return K(B).copy((n=y.value)==null?void 0:n.nftHash)})},Vo))]),t("div",Go,[Jo,ue(" "+R((J=y.value)==null?void 0:J.feeRate),1)])])]),j(Lt,{"position-info":y.value},null,8,["position-info"])]),t("div",Yo,[t("div",Qo,[t("div",Ko,[j(Nt,{"pool-info":y.value},null,8,["pool-info"]),t("div",Zo,[en,j(co,{"position-info":y.value},null,8,["position-info"])])]),t("div",tn,[j(Bo,{"pool-info":y.value,"tick-list":I.value,"min-price":y.value.minPrice,"max-price":y.value.maxPrice,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price"]),on,t("div",nn,[t("div",an,[j(_,{"overlay-class-name":"lever-tooltip ant-tooltip-text-color"},{title:ne(()=>[ue("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:ne(()=>[sn]),_:1})]),t("div",ln,R(g.value),1)])])])])])}}});const un=Pe(rn,[["__scopeId","data-v-9c03e432"]]),Ge=e=>(je("data-v-81ba2714"),e=e(),Fe(),e),cn={class:"liquidity-card-box"},dn={class:"liquidity-title"},vn={class:"liquidity-usd"},mn=Ge(()=>t("span",null,"Liquidity",-1)),fn={class:"liquidity-ratio"},pn={class:"coin-ratio"},_n={class:"coin-a-ratio"},hn={class:"coin-b-ratio"},gn={class:"ratio-progress"},bn={class:"base-quote-num"},kn={class:"base-coin-num"},wn=Ge(()=>t("span",null,"Base",-1)),yn={class:"token-amount"},In={key:0,class:"after"},Pn={class:"quote-coin-num"},Sn=Ge(()=>t("span",null,"Quote",-1)),An={class:"token-amount"},$n={key:0,class:"after"},xn={class:"pending-yield"},Tn={class:"left"},Cn=Ge(()=>t("div",{class:"pending-yield-title"},"Pending Yield",-1)),Nn={key:0,class:"after"},On={class:"right"},qn={class:"fees-rewards"},Bn={class:"fees-rewards-item"},Ln=Ge(()=>t("span",null,"Fees",-1)),Rn={class:"token-amount"},Mn={key:0,class:"after"},jn=Ge(()=>t("span",null,"Mining Rewards",-1)),Fn={class:"token-amount"},Un={key:0,class:"after"},Dn=he({__name:"new-position-liquidity",setup(e){const h=Se(),y=it(),H=m(()=>y),B=Xe(),o=m(()=>B.currentPositionInfo),s=m(()=>B.positionPendingFees[o.value.positionId]),g=m(()=>B.positionPendingRewards[o.value.positionId]),D=m(()=>{var z,Q,i,Y;let T=we(0);return(z=s==null?void 0:s.value)!=null&&z.feesAmountUSD&&(T=T.add((Q=s.value)==null?void 0:Q.feesAmountUSD)),(i=g==null?void 0:g.value)!=null&&i.rewardsAmount&&(T=T.add((Y=g.value)==null?void 0:Y.rewardsAmount)),T.toNumber()}),I=$(!1),{setIsShowSuccess:b,setIsShowRejected:l,setIsShowWaiting:c,setTransactionDesc:_,setTransactionTxid:x}=h,U=Ve("Sui"),{getCurrentPosition:k}=Tt(),E=async()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1233 ~ claimFeesAndRewards ~ currentPositionInfo.value:",o.value),I.value=!0;let T={coinTypeA:o.value.defaultCoinaAddress,coinTypeB:o.value.defaultCoinbAddress,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.pool,pos_index:o.value.positionIndex,rewarder_nums:g.value.rewarderAmountOwed.length,collect_fee:!0};T.coinTypeC=g.value.rewarderAmountOwed[0]?g.value.rewarderAmountOwed[0].tokenInfo.address:"",T.coinTypeD=g.value.rewarderAmountOwed[1]?g.value.rewarderAmountOwed[1].tokenInfo.address:"",T.coinTypeE=g.value.rewarderAmountOwed[2]?g.value.rewarderAmountOwed[2].tokenInfo.address:"",c(!0),_();try{let z;T.pos_index=o.value.pos_object_id;const Q=await U.getCollectRewarderTransactionPayload(T,o.value),i=await U.signAndExecuteTransactionBlock(H.value.currentWallet,Q.txb,Q.payloadParams);if(z=U.handleTx(i),z&&z.hash){x(z.hash),c(!1),b(!0);const Y={title:"Claim",desc:"",hash:z.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};Y.res=z.res,U.showTransitionPending(Y),await U.watchTransaction(Y)&&(k(o.value.positionId,o.value.positionSource),setTimeout(()=>{U.getAccount(H.value.address),I.value=!1},3e3))}else console.log("0310###toClaimRewards###else###"),c(!1),l(!0),I.value=!1}catch(z){console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:1225 ~ claimFeesAndRewards ~ error:",z),c(!1),l(!0),I.value=!1}},J=m(()=>B.positionDetailCurrentTab),p=m(()=>B.positionActionFromCoinAmount),n=m(()=>B.positionActionToCoinAmount),v=m(()=>{if(J.value=="increase")return p.value>0?we(o.value.coinaAmount).add(we(p.value)).toString():"";if(p.value>0){const T=we(o.value.coinaAmount).minus(we(p.value)).toString();return T<0?"0":T}else return""}),u=m(()=>{if(J.value=="increase")return n.value>0?we(o.value.coinbAmount).add(we(n.value)).toString():"";if(n.value>0){const T=we(o.value.coinbAmount).minus(we(n.value)).toString();return T<0?"0":T}else return""});return(T,z)=>{var i,Y,O,r,a,P,d,C,F,G,V,ge,S,de,re,Je;const Q=He;return f(),N("div",cn,[t("div",dn,[t("div",vn,[mn,t("div",null,"$"+R(o.value.positionAmountUSD),1)]),t("div",fn,[t("div",pn,[t("div",_n,[j(_e,{"token-info":(i=o.value)==null?void 0:i.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R((O=(Y=o.value)==null?void 0:Y.coinA)==null?void 0:O.symbol),1),t("span",null,R((r=o.value)==null?void 0:r.fromPercent)+"%",1)]),t("div",hn,[j(_e,{"token-info":(a=o.value)==null?void 0:a.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R((d=(P=o.value)==null?void 0:P.coinB)==null?void 0:d.symbol),1),t("span",null,R((C=o.value)==null?void 0:C.toPercent)+"%",1)])]),t("div",gn,[t("div",{class:"from-percent",style:kt({width:((F=o.value)==null?void 0:F.fromPercent)+"%"})},null,4),t("div",{class:"to-percent",style:kt({width:((G=o.value)==null?void 0:G.toPercent)+"%"})},null,4)])])]),t("div",bn,[t("div",kn,[wn,t("div",yn,[j(_e,{"token-info":(V=o.value)==null?void 0:V.coinA,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(oe)(K(Oe)((ge=o.value)==null?void 0:ge.coinaAmount))),1)]),v.value?(f(),N("div",In,R(K(oe)(v.value))+" after ",1)):ee("",!0)]),t("div",Pn,[Sn,t("div",An,[j(_e,{"token-info":(S=o.value)==null?void 0:S.coinB,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(oe)(K(Oe)((de=o.value)==null?void 0:de.coinbAmount))),1)]),u.value?(f(),N("div",$n,R(K(oe)(u.value))+" after ",1)):ee("",!0)])]),t("div",xn,[t("div",Tn,[Cn,t("div",null,[ue(" $"+R(D.value>0&&D.value<.01?"<0.01":K(oe)(D.value,2))+" ",1),D.value>0?(f(),N("span",Nn,"$0 after")):ee("",!0)])]),t("div",On,[j(Q,{class:"claim-all",loading:I.value,disabled:I.value||D.value==0,onClick:E},{default:ne(()=>[ue("Claim")]),_:1},8,["loading","disabled"])])]),t("div",qn,[t("div",Bn,[(f(!0),N(tt,null,ot((re=s.value)==null?void 0:re.feesList,ce=>(f(),N("div",{key:ce},[Ln,t("div",Rn,[j(_e,{"token-info":ce.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(ft)(ce.amount,"",ce.tokenInfo.decimals)),1)]),(v.value||u.value)&&!K(te)(o.value)?(f(),N("div",Mn," 0 after ")):ee("",!0)]))),128)),(f(!0),N(tt,null,ot((Je=g.value)==null?void 0:Je.rewarderAmountOwed,ce=>(f(),N("div",{key:ce},[jn,t("div",Fn,[j(_e,{"token-info":ce.tokenInfo,"coin-size":"20px","warning-coin-size":"10px"},null,8,["token-info"]),t("span",null,R(K(ft)(ce.amount,"",ce.tokenInfo.decimals)),1)]),(v.value||u.value)&&!K(te)(o.value)?(f(),N("div",Un," 0 after ")):ee("",!0)]))),128))])])])}}});const It=Pe(Dn,[["__scopeId","data-v-81ba2714"]]);function En(){const e=Xe(),h=m(()=>e.currentPositionInfo),y=Se(),H=m(()=>y.slippage);return{preAdd:(o,s)=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ currentPositionInfo ~ currentPositionInfo:",h.value),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ preAdd ~ token:",s),console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:7 ~ preAdd ~ amount:",o);const{isReverse:g}=h.value,D=s.address==Gt(h.value.defaultCoinaAddress).full_address;console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:23 ~ preAdd ~ iscoinA:",D);const I=Number(h.value.tickLowerIndex),b=Number(h.value.tickUpperIndex),l=new ke(o),c=!0,_=new ke(h.value.current_sqrt_price);console.log("ðŸš€ðŸš€ðŸš€ ~ file: usePositionIncrease.ts:27 ~ preAdd ~ coinAmount:",l.toString());const{liquidityAmount:x,coinAmountA:U,coinAmountB:k}=Ct.estLiquidityAndcoinAmountFromOneAmounts(I,b,l,D,c,Number(H.value)/100,_),E=g?h.value.coinB.decimals:h.value.coinA.decimals,J=g?h.value.coinA.decimals:h.value.coinB.decimals;return{tokenMaxA:g?We(k.toString(),J):We(U.toString(),E),tokenMaxB:g?We(U.toString(),E):We(k.toString(),J)}}}}const Rt=e=>(je("data-v-5140dcfb"),e=e(),Fe(),e),zn=Rt(()=>t("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),Wn={class:"modal-content"},Hn={class:"pool-info"},Xn={class:"left"},Vn={class:"pool-name"},Gn={class:"right"},Jn={class:"coin-info"},Yn={class:"from-coin-info"},Qn={class:"left"},Kn={class:"coin-amount"},Zn={class:"coin-symbol"},ei={class:"right"},ti={class:"to-coin-info"},oi={class:"left"},ni={class:"coin-amount"},ii={class:"coin-symbol"},ai={class:"right"},si={class:"select-range"},li=Rt(()=>t("div",{class:"select-range-title"},"Selected Range",-1)),ri={class:"price-conent"},ui={class:"current-price"},ci={class:"price-range-block-content"},di={class:"price-range-block"},vi={class:"price-item"},mi={class:"title"},fi={class:"price"},pi={key:0,class:"text"},_i={key:1,class:"text"},hi={class:"price-item"},gi={class:"title"},bi={class:"price"},ki={key:0,class:"text"},wi={key:1,class:"text"},yi={class:"deposit-ratio-content"},Ii=he({__name:"increase-liquidity-modal",props:{fromCoinAmount:{type:String,default:"1245566.008946"},toCoinAmount:{type:String,default:"11111111111"},fixedFromCoin:{type:Boolean,default:!0},showFromCoinLock:{type:Boolean,default:!1},showToCoinLock:{type:Boolean,default:!1},positionTotalAmount:{type:Number,default:0},currentPositionInfo:{type:Object,default:()=>({})}},emits:["toAdd"],setup(e,{emit:h}){const y=h,H=$(!0),B=()=>{y("toAdd")};return(o,s)=>{const g=mo,D=He;return f(),ve(K(Ut),{width:"440px",visible:!0,footer:null,title:"Increase",onCancel:s[0]||(s[0]=I=>o.$emit("onClose"))},{closeIcon:ne(()=>[zn]),default:ne(()=>[t("div",Wn,[t("div",Hn,[t("div",Xn,[j(_e,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),j(_e,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"]),t("div",Vn,[t("span",null,R(e.currentPositionInfo.coinA.symbol)+"Â -Â ",1),t("span",null,R(e.currentPositionInfo.coinB.symbol),1)])]),t("div",Gn,[ue(" Fee tier "),t("span",null,R(e.currentPositionInfo.feeRate),1)])]),t("div",Jn,[t("div",Yn,[t("div",Qn,[t("div",Kn,R(K(oe)(e.fromCoinAmount)||0),1),t("div",Zn,R(e.currentPositionInfo.coinA.symbol),1)]),t("div",ei,[j(_e,{"token-info":e.currentPositionInfo.coinA,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])]),t("div",ti,[t("div",oi,[t("div",ni,R(K(oe)(e.toCoinAmount)||0),1),t("div",ii,R(e.currentPositionInfo.coinB.symbol),1)]),t("div",ai,[j(_e,{"token-info":e.currentPositionInfo.coinB,"coin-size":"28px","warning-coin-size":"12px"},null,8,["token-info"])])])]),t("div",si,[li,j(Lt,{"position-info":e.currentPositionInfo},null,8,["position-info"])]),t("div",ri,[t("div",ui,[j(Nt,{"pool-info":e.currentPositionInfo},null,8,["pool-info"])]),t("div",ci,[t("div",di,[t("div",vi,[t("div",mi,R(o.$t("common.minPrice")),1),t("p",fi,R(e.currentPositionInfo.minPrice),1),H.value?(f(),N("div",pi,R(e.currentPositionInfo.coinB.symbol)+" per "+R(e.currentPositionInfo.coinA.symbol),1)):(f(),N("div",_i,R(e.currentPositionInfo.coinA.symbol)+" per "+R(e.currentPositionInfo.coinB.symbol),1))]),t("div",hi,[t("div",gi,R(o.$t("common.maxPrice")),1),t("p",bi,R(e.currentPositionInfo.maxPrice),1),H.value?(f(),N("div",ki,R(e.currentPositionInfo.coinB.symbol)+" per "+R(e.currentPositionInfo.coinA.symbol),1)):(f(),N("div",wi,R(e.currentPositionInfo.coinA.symbol)+" per "+R(e.currentPositionInfo.coinB.symbol),1))])])])]),t("div",yi,[j(g,{"min-price":e.currentPositionInfo.minPrice,"max-price":e.currentPositionInfo.maxPrice,"pool-info":e.currentPositionInfo,"fixed-from-coin":e.fixedFromCoin,"from-coin":e.currentPositionInfo.coinA,"to-coin":e.currentPositionInfo.coinB,"current-price-tab":"custom",slippage:o.slippage,"current-price":e.currentPositionInfo.currentPrice,"current-price-reverse":e.currentPositionInfo.currentPriceReverse,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"position-total-amount":e.positionTotalAmount,"tick-lower":e.currentPositionInfo.tickLowerIndex,"tick-upper":e.currentPositionInfo.tickUpperIndex},null,8,["min-price","max-price","pool-info","fixed-from-coin","from-coin","to-coin","slippage","current-price","current-price-reverse","from-coin-amount","to-coin-amount","position-total-amount","tick-lower","tick-upper"])])]),j(D,{class:"big-btn liquidity-btn",onClick:B},{default:ne(()=>[ue(R("Increase Liquidity"))]),_:1})]),_:1})}}});const Pi=Pe(Ii,[["__scopeId","data-v-5140dcfb"]]),Si=he({props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},poolInfo:{type:Object,default:()=>({})}},setup(){const e=Se();return{storeIndex:m(()=>e),checkNullObj:te}}});const Ai={class:"unilateral"},$i={key:0,src:fo,alt:""},xi={key:1,src:po,alt:""},Ti={key:2};function Ci(e,h,y,H,B,o){return f(),N("div",Ai,[t("div",null,[e.storeIndex.theme=="default"?(f(),N("img",$i)):(f(),N("img",xi)),!("checkNullObj"in e?e.checkNullObj:K(te))(e.fromCoin)&&!("checkNullObj"in e?e.checkNullObj:K(te))(e.toCoin)&&!("checkNullObj"in e?e.checkNullObj:K(te))(e.poolInfo)?(f(),N("p",Ti,R(e.$t("tips.marketprice")),1)):ee("",!0)])])}const Pt=Pe(Si,[["render",Ci],["__scopeId","data-v-d1eef0bd"]]),Ni={class:"new-position-asset-add-box"},Oi={class:"add-or-remove"},qi={class:"tab-box"},Bi={key:0,class:"from-lock"},Li={key:1,class:"to-lock"},Ri={key:2,class:"new-sui-exchange to-add-logo"},Mi=t("div",{class:"exchange-new"},[t("svg",{class:"icon icon-down","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_add1"})])],-1),ji=[Mi],Fi={class:"amount-btn"},Ui={key:2,class:"total-amount"},Di=t("span",null,"Total Amount",-1),Ei=he({__name:"new-position-asset-add",setup(e){const h=$(!0),y=$(!1),H=[{name:"Increase",logo:""},{name:"Remove",logo:""}],{t:B}=$t(),{getTokenRatePrice:o}=vo(),s=it(),g=m(()=>s),D=Xe(),I=m(()=>D.currentPositionInfo),b=Se();m(()=>b.slippage);const l=$(),c=$(),_=$(),x=$(),U=$(!0),k=m(()=>g.value.assets&&l.value&&g.value.assets[l.value.address]?We(g.value.assets[l.value.address].balance,l.value.decimals):0),E=m(()=>g.value.assets&&c.value&&g.value.assets[c.value.address]?We(g.value.assets[c.value.address].balance,c.value.decimals):0),J=r=>{r==="fromCoin"?(U.value=!0,_.value=k.value>0?l.value.symbol=="SUI"?new M(Number(k.value)).sub(new M(.05)).lt(new M(0))?"0":new M(Number(k.value)).sub(new M(.05)).toString():String(k.value):""):(U.value=!1,x.value=E.value>0?c.value.symbol=="SUI"?new M(Number(E.value)).sub(new M(.05)).lt(new M(0))?"0":new M(Number(E.value)).sub(new M(.05)).toString():String(E.value):"")},p=r=>{r==="fromCoin"?(U.value=!0,_.value=Ie(new M(Number(k.value)).div(2).toString(),l.value.decimals).toString()):(U.value=!1,x.value=Ie(new M(Number(E.value)).div(2).toString(),c.value.decimals).toString())},n=m(()=>I.value.isResever),v=$(),u=$(),{preAdd:T}=En(),z=()=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:1021 ~ updateAmounts ~ updateAmounts:"),!I.value||!_.value&&!x.value)return;const r=U.value?_.value:x.value,a=U.value?l.value.decimals:c.value.decimals,P=we(r).mul(M.pow(10,a)).toString(),d=U.value?l.value:c.value,{tokenMaxA:C,tokenMaxB:F}=T(P,d);U.value?x.value=F:_.value=C,D.setPositionActionAmount({fromCoinAmount:_,toCoinAmount:x})};ie(()=>I.value,r=>{if(r&&!te(r)){l.value=r.coinA,c.value=r.coinB,console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-asset-add-box-add.vue:872 ~ newVal:",r);const{tickUpperIndex:a,tickUpperIndex:P,current_tick_index:d,maxPrice:C}=r;C=="âˆž"||d>=a&&d<P?(v.value=!1,u.value=!1):d>=P?(_.value="",v.value=!0,u.value=!1):d<a?(v.value=!1,u.value=!0,x.value=""):(v.value=!0,_.value="",u.value=!0,x.value=""),z()}},{immediate:!0}),ie(_,(r,a)=>{r&&z(),r==""&&(x.value="")}),ie(x,(r,a)=>{r&&z(),r==""&&(_.value="")});const Q=m(()=>{var P,d,C,F;const r=o((P=l==null?void 0:l.value)==null?void 0:P.address,_==null?void 0:_.value,(d=l==null?void 0:l.value)==null?void 0:d.decimals),a=o((C=c==null?void 0:c.value)==null?void 0:C.address,x==null?void 0:x.value,(F=c==null?void 0:c.value)==null?void 0:F.decimals);if(r!=="--"&&a!=="--"){const G=we(r).add(a);return ft(G.toString())}return"--"}),i=m(()=>{const r=Number(_.value)>Number(k.value),a=Number(x.value)>Number(E.value);return!_.value&&!x.value?B("button.enterAmount"):r?B("button.insufficientBalance",{name:l.value.symbol}):a?B("button.insufficientBalance",{name:c.value.symbol}):B("newAdd.addMore")}),Y=m(()=>{const r=Number(_.value)>Number(k.value),a=Number(x.value)>Number(E.value);return!!(!_.value&&!x.value||r||a)}),O=$(!1);return(r,a)=>{const P=He;return f(),N("div",Ni,[t("div",Oi,[t("div",qi,[j(K(Ot),{"tab-list":H,"current-tab":"Increase",onOnClick:a[0]||(a[0]=d=>{d.name=="Remove"&&K(D).setPositionDetailCurrentTab("remove")})})]),t("div",{class:et(["card-container",[h.value?"input-block-add-top":"",y.value?"input-block-add-bottom":"",n.value?"card-container reverse":"card-container"]])},[j(dt,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=d=>_.value=d),"input-value":_.value,"coin-symbol":l.value?l.value.symbol:null,"coin-name":l.value?l.value.name:null,balance:k.value,"coin-icon":l.value?l.value.logoURI:"",address:l.value?l.value.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,title:"",onOnMax:a[2]||(a[2]=d=>J("fromCoin")),onOnHalf:a[3]||(a[3]=d=>p("fromCoin")),onOnInput:a[4]||(a[4]=d=>{_.value=d}),onOnFocus:a[5]||(a[5]=()=>{U.value=!0,h.value=!0,y.value=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),j(dt,{modelValue:x.value,"onUpdate:modelValue":a[6]||(a[6]=d=>x.value=d),"input-value":x.value,"coin-symbol":c.value?c.value.symbol:null,"coin-name":c.value?c.value.name:null,balance:E.value,"swap-direct":"To","coin-icon":c.value?c.value.logoURI:"",address:c.value?c.value.address:"","import-page":"deposit","has-arrow":!1,title:"",onOnMax:a[7]||(a[7]=d=>J("toCoin")),onOnHalf:a[8]||(a[8]=d=>p("toCoin")),onOnInput:a[9]||(a[9]=d=>{x.value=d}),onOnFocus:a[10]||(a[10]=()=>{U.value=!1,h.value=!1,y.value=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),v.value?(f(),N("div",Bi,[j(Pt,{"from-coin":l.value,"to-coin":c.value},null,8,["from-coin","to-coin"])])):ee("",!0),u.value?(f(),N("div",Li,[j(Pt,{"from-coin":l.value,"to-coin":c.value},null,8,["from-coin","to-coin"])])):ee("",!0),!v.value&&!u.value?(f(),N("div",Ri,ji)):ee("",!0)],2)]),t("div",Fi,[g.value.connected?(f(),ve(P,{key:0,class:"big-btn liquidity-btn",disabled:Y.value,loading:r.actionLoading,onClick:a[11]||(a[11]=d=>O.value=!0)},{default:ne(()=>[t("span",null,R(i.value),1)]),_:1},8,["disabled","loading"])):(f(),ve(P,{key:1,class:"big-btn",onClick:a[12]||(a[12]=d=>g.value.connected?O.value=!0:g.value.setIsShowWalletModal(!0))},{default:ne(()=>[t("span",null,R(r.$t("button.connectWallet")),1)]),_:1})),g.value.connected?(f(),N("div",Ui,[Di,t("span",null,R(Q.value),1)])):ee("",!0)]),O.value?(f(),ve(Pi,{key:0,"current-position-info":I.value,"show-from-coin-lock":v.value,"show-to-coin-lock":u.value,"from-coin-amount":_.value,"to-coin-amount":x.value,onOnClose:a[13]||(a[13]=d=>O.value=!1)},null,8,["current-position-info","show-from-coin-lock","show-to-coin-lock","from-coin-amount","to-coin-amount"])):ee("",!0)])}}});const zi={class:"new-position-asset-remove-box"},Wi={class:"add-or-remove"},Hi={class:"tab-box"},Xi={key:0,class:"assets-card-mask-from"},Vi={key:1,class:"assets-card-mask-to"},Gi={class:"remove-ratio"},Ji=t("div",{class:"remove-ratio-title"},"Amount",-1),Yi={class:"remove-ratio-select"},Qi={key:0,class:"ratio"},Ki={key:1,class:"ratio"},Zi={class:"ratio-list"},ea=["onClick"],ta=he({__name:"new-position-asset-remove",setup(e){const h=$(!0),y=$(!1),H=[{name:"Increase",logo:""},{name:"Remove",logo:""}],B=Xe(),o=$(""),s=$(""),g=Se(),D=m(()=>g);m(()=>D.value.theme);const I=_t(),b=m(()=>I),l=$(!1),c=$(!1),_=$(!0),x=m(()=>D.value.chainName),U=m(()=>x.value?Ve(x.value):{}),k=it(),E=m(()=>k),J=m(()=>D.value.slippage),p=$(),n=$(),v=m(()=>{var w,A;return(A=(w=i.value)==null?void 0:w.poolInfo)==null?void 0:A.needReverse}),u=m(()=>{var w;return Oe(i==null?void 0:i.value.amountA,(w=i==null?void 0:i.value.token_a)==null?void 0:w.decimals)}),T=m(()=>{var w;return Oe(i==null?void 0:i.value.amountB,(w=i==null?void 0:i.value.token_b)==null?void 0:w.decimals)}),z=w=>{w==="fromCoin"?(_.value=!0,P.value||(x.value==="Aptos"||console.log(u.value,"213===>"),o.value=String(u.value))):(_.value=!1,P.value||(x.value,s.value=String(T.value))),C.value=100,G({value:1})},Q=w=>{w==="fromCoin"?(_.value=!0,o.value=Ie(new M(Number(u.value)).div(2).toString(),p.value.decimals).toString()):(_.value=!1,s.value=Ie(new M(Number(T.value)).div(2).toString(),n.value.decimals).toString()),P.value=!1},i=$({}),Y=$(!0),O=$({}),r=$(),a=$(),P=$(!0),d=()=>{var Qe;if(P.value||!i.value||!o.value&&!s.value||Number(o.value)>Number(u.value)||Number(s.value)>Number(T.value))return;if(o.value==u.value&&s.value==T.value){C.value=100,G({value:1}),P.value=!0;return}const{TickMath:w,TickUtil:A}=U.value;let q=i.value.minPrice,Z=i.value.maxPrice.indexOf("+")>0?"âˆž":i.value.maxPrice,X=Number(i.value.tick_lower_index),se=Number(i.value.tick_upper_index);const me=Number(i.value.current_tick_index);let le,fe,Be=Number(q).toString(),Le=i.value.maxPrice.indexOf("+")>0||i.value.maxPrice==="âˆž"?"âˆž":Number(Z);if(Be=="0"&&Le=="âˆž"?(X=Number(i.value.tick_lower_index),se=Number(i.value.tick_upper_index)):(le=w.priceToSqrtPriceX64(new M(q),p.value.decimals,n.value.decimals),fe=w.priceToSqrtPriceX64(new M(Z),p.value.decimals,n.value.decimals)),r.value=X,a.value=se,Z!=="âˆž"&&X>=se){l.value=!0,o.value="",c.value=!0,s.value="";return}if(Z=="âˆž"||me>=X&&me<se){l.value=!1,c.value=!1;let pe;if(o.value||s.value){if(_.value){const xe=new M(o.value).mul(Math.pow(10,p.value.decimals)).toString();pe=new ke(xe)}else{const xe=new M(s.value).mul(Math.pow(10,n.value.decimals)).toString();pe=new ke(xe)}const{liquidityAmount:Ne,tokenMaxA:Re,tokenMaxB:Me,tokenMaxAOrigin:ut,tokenMaxBOrigin:ae}=U.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:p.value,tokenB:n.value,lowerTick:X,upperTick:se,coinAmount:pe,iscoinA:Y.value?_.value:!_.value,roundUp:x.value!="Sui",slippage:Number(J.value)/100,curSqrtPrice:new ke(i.value.current_sqrt_price)});O.value={liquidityAmount:Ne,tokenMaxA:Re,tokenMaxB:Me,tokenMaxAOrigin:ut,tokenMaxBOrigin:ae},Y.value?_.value?s.value=Number(Me)>0?Me:"":o.value=Number(Re)>0?Re:"":_.value?s.value=Re:o.value=Me}}else if(me>=se){if(o.value="",l.value=!0,c.value=!1,o.value||s.value){let pe;const Ne=new M(s.value).mul(Math.pow(10,(Qe=n.value)==null?void 0:Qe.decimals)).toString();pe=new ke(Ne),O.value={liquidityAmount:Jt(le,fe,pe),tokenMaxA:0,tokenMaxB:s.value}}}else if(me<X){if(l.value=!1,c.value=!0,s.value="",o.value||s.value){let pe;const Ne=new M(o.value).mul(Math.pow(10,p.value.decimals)).toString();pe=new ke(Ne),O.value={liquidityAmount:Yt(le,fe,pe),tokenMaxA:o.value,tokenMaxB:0}}}else l.value=!0,c.value=!0;P.value=!1,C.value=new M(O.value.liquidityAmount.toString()).div(i.value.liquidity).mul(100).toNumber().toFixed(2),F.value=O.value.liquidityAmount,I.setPositionActionAmount({fromCoinAmount:o,toCoinAmount:s})},C=$(0),F=$("0"),G=w=>{if(console.log("setPercent isSlider.value: ",P.value),!P.value)return;P.value=!0;const A=i.value.token_a.decimals,q=i.value.token_b.decimals,Z=i.value.tick_lower_index,X=i.value.tick_upper_index,se=wt.tickIndexToSqrtPriceX64(Z),me=wt.tickIndexToSqrtPriceX64(X);let le="";w.value!==1?le=new M(i.value.liquidity).mul(w.value).toString():le=i.value.liquidity,le=Ie(le,0)||"0",F.value=le;const fe=Ct.getCoinAmountFromLiquidity(new ke(le),new ke(i.value.current_sqrt_price),se,me,x.value!="Sui"),Be=new M(fe.coinA.toString()).div(Math.pow(10,A)).toString(),Le=new M(fe.coinB.toString()).div(Math.pow(10,q)).toString();o.value=Number(Be)>0?Be:"",s.value=Number(Le)>0?Le:"",I.setPositionActionAmount({fromCoinAmount:o,toCoinAmount:s})};ie(()=>b.value.currentPositionInfo,w=>{if(w&&!te(w)){i.value=w,p.value=i.value.token_a,n.value=i.value.token_b,G({value:C.value/100});let A=Number(i.value.tick_lower_index),q=Number(i.value.tick_upper_index);const Z=Number(i.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="âˆž"?"âˆž":w.maxPrice)=="âˆž"||Z>=A&&Z<q?(l.value=!1,c.value=!1):Z>=q?(o.value="",l.value=!0,c.value=!1):Z<A?(l.value=!1,c.value=!0,s.value=""):(l.value=!0,o.value="",c.value=!0,s.value=""),d()}},{immediate:!0}),ie(o,(w,A)=>{w&&d(),w==""&&(s.value="",C.value=0)}),ie(s,(w,A)=>{w&&d(),w==""&&(o.value="",C.value=0)});const V=m(()=>b.value.RATES);m(()=>{var se,me,le,fe;const w=((me=V.value[(se=p.value)==null?void 0:se.address])==null?void 0:me.price)||0,A=((fe=V.value[(le=n.value)==null?void 0:le.address])==null?void 0:fe.price)||0,q=new M(w).mul(new M(o.value||0)),Z=new M(A).mul(new M(s.value||0)),X=q.add(Z);return oe(X.toString(),2)});const ge=$(!1),{t:S,locale:de}=$t(),re=m(()=>{const w=Number(o.value)>Number(u.value),A=Number(s.value)>Number(T.value);return!o.value&&!s.value?S("button.enterAmount"):w||A?"Invalid Amount":S("button.remove")}),Je=m(()=>{const w=Number(o.value)>Number(u.value),A=Number(s.value)>Number(T.value);return!!(!o.value&&!s.value||w||A)}),{setIsShowSuccess:ce,setIsShowRejected:Ye,setIsShowWaiting:Ae,setTransactionDesc:ht,setTransactionTxid:st,setPositiomNum:gt,setTransactionDescText:vt}=g,be=$(!1);ie(C,Dt((w,A)=>{w!==A&&(Number(w)>100?C.value=100:w&&i.value?(C.value=w,G({value:C.value/100})):(o.value="",s.value=""))},300)),ie(J,w=>{w&&i.value&&G({value:C.value/100})});const qe=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],$e=qt(),Te=m(()=>$e),lt=m(()=>Te.value.status),rt=$(!1),L=w=>{w.sources.forEach(q=>{const{pool_address:Z,position_index:X}=JSON.parse(q.blockchainAddress);Z==i.value.poolAddress&&Number(X)==Number(i.value.index)&&(rt.value=!0)})},W=async()=>{await $e.getSources();let w;Te.value.allSources.forEach(A=>{const{pool_address:q,position_index:Z}=JSON.parse(A.blockchainAddress);q==i.value.poolAddress&&Z==i.value.index&&(w=A.id)}),$e.deleteSource(w)};ie(()=>[Te.value.sourceGroups,i.value],([w,A])=>{w&&w.sources&&w.sources.length>0&&A&&!te(A)&&L(w)},{immediate:!0,deep:!0});const Ce=nt(),De=Et(),Ee=async()=>{var X,se,me,le,fe,Be,Le,Qe,pe,Ne,Re,Me,ut;be.value=!0,st("");const w=oe(o.value,p.value.decimals)==0?"":`${Oe(o.value,p.value.decimals)} ${p.value.symbol}`,A=oe(s.value,n.value.decimals)==0?"":`${Oe(s.value,n.value.decimals)} ${n.value.symbol}`;ht(S("tips.removeLiquidiyText",{from:v.value?A:w,and:oe(o.value,p.value.decimals)==0||oe(s.value,n.value.decimals)==0?"":"and",to:v.value?w:A})),Ae(!0);const q=i.value.poolInfo.rewarder_infos,Z=q&&q.length>0&&x.value=="Sui"||q&&q.length>0&&C.value==100?S("modal.removeLiquidityText1"):S("modal.removeLiquidityText2");vt(Z);try{let ae={};ae={pool:{...i.value.poolInfo,coinA:i.value.token_a,coinB:i.value.token_b},coinTypeA:i.value.poolInfo.coinTypeA,coinTypeB:i.value.poolInfo.coinTypeB,position:i.value,delta_liquidity:C.value==100?new ke(i.value.liquidity):new ke(Ie(F.value,0)),slippage:Number(J.value),rewards_num:q.length,positionInfo:i.value},ae.coinTypeC=q[0]?q[0].coinAddress:"",ae.coinTypeD=q[1]?q[1].coinAddress:"",ae.coinTypeE=q[2]?q[2].coinAddress:"";const xe=await U.value.getRemoveLiquidityTransactionPayload(ae);let ye;if(x.value==="Aptos")ye=await E.value.currentWallet.signAndSubmitTransaction(xe);else{const Ke=await U.value.signAndExecuteTransactionBlock(E.value.currentWallet,xe.txb,xe==null?void 0:xe.payloadParams);ye=U.value.handleTx(Ke),console.log("0331###remove###tx####",ye)}if(ye&&ye.hash){st(ye.hash),Ae(!1),ce(!0);const Ke={title:S("common.removeLiquidity"),desc:"",hash:ye.hash,descTransactions:`Remove ${o.value} ${(X=p.value)==null?void 0:X.symbol} and ${s.value} ${(se=n.value)==null?void 0:se.symbol} 
             from the pool`,sender:E.value.address,chainName:x.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:v.value?`${(le=n.value)==null?void 0:le.address}`:`${(me=p.value)==null?void 0:me.address}`,numa:v.value?`+ ${s.value}`:`+ ${o.value}`,logoa:v.value?b.value.tokensObj&&n.value&&n.value.address&&b.value.tokensObj[n.value.address]&&b.value.tokensObj[n.value.address].logoURI:b.value.tokensObj&&p.value&&p.value.address&&b.value.tokensObj[p.value.address]&&b.value.tokensObj[p.value.address].logoURI,tokenb:v.value?`${(fe=p.value)==null?void 0:fe.address}`:`${(Be=n.value)==null?void 0:Be.address}`,numb:v.value?`+ ${o.value}`:`+ ${s.value}`,logob:v.value?b.value.tokensObj&&p.value&&p.value.address&&b.value.tokensObj[p.value.address]&&b.value.tokensObj[p.value.address].logoURI:b.value.tokensObj&&n.value&&n.value.address&&b.value.tokensObj[n.value.address]&&b.value.tokensObj[n.value.address].logoURI},text:`Withdraw ${o.value} ${(Le=p.value)==null?void 0:Le.symbol} and ${s.value} ${(Qe=n.value)==null?void 0:Qe.symbol}`};x.value!=="Aptos"&&(Ke.res=ye.res),U.value.showTransitionPending(Ke);const bt=await U.value.watchTransaction(Ke);if(q.value&&q.value.length>0&&(Number((pe=q[0])==null?void 0:pe.amount)!==0||ae.coinTypeD&&Number((Ne=q[1])==null?void 0:Ne.amount)!==0||ae.coinTypeE&&Number((Re=q[2])==null?void 0:Re.amount)!==0)){const mt={title:S("common.removeLiquidity"),desc:"",hash:ye.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:q[0].symbol,numa:`+ ${Number(q[0].amount)}`,logoa:b.value.tokensObj&&q[0]&&q[0].address&&b.value.tokensObj[q[0].address]&&b.value.tokensObj[q[0].address].logoURI,tokenb:ae.coinTypeD?q[1].symbol:"",numb:ae.coinTypeD?`+ ${Number(q[1].amount)}`:"",logob:ae.coinTypeD?b.value.tokensObj&&q[1]&&q[1].address&&b.value.tokensObj[q[1].address]&&b.value.tokensObj[q[1].address].logoURI:"",tokenc:ae.coinTypeE?q[2].symbol:"",numc:ae.coinTypeE?`+ ${Number(q[2].amount)}`:"",logoc:ae.coinTypeE?b.value.tokensObj&&q[2]&&q[2].address&&b.value.tokensObj[q[2].address]&&b.value.tokensObj[q[2].address].logoURI:""},text:`Withdraw ${o.value} ${(Me=p.value)==null?void 0:Me.symbol} and ${s.value} ${(ut=n.value)==null?void 0:ut.symbol}`},Mt=await U.value.setTransations(mt)}if(ct(i.value.feeOwedA,i.value.token_a.decimals)!==0||ct(i.value.feeOwedB,i.value.token_b.decimals)!==0){const mt={title:"Claim",desc:"",hash:ye.hash,chainName:x.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${i.value.token_a.symbol}`,numa:oe(i.value.feeOwedA,i.value.token_a.decimals)==0?"":`+ ${ct(i.value.feeOwedA,i.value.token_a.decimals)}`,logoa:oe(i.value.feeOwedA,i.value.token_a.decimals)==0?"":b.value.tokensObj&&i.value&&i.value.token_a.address&&b.value.tokensObj[i.value.token_a.address]&&b.value.tokensObj[i.value.token_a.address].logoURI,tokenb:`${i.value.token_b.symbol}`,numb:oe(i.value.feeOwedB,i.value.token_b.decimals)==0?"":`+ ${ct(i.value.feeOwedB,i.value.token_b.decimals)}`,logob:oe(i.value.feeOwedB,i.value.token_b.decimals)==0?"":b.value.tokensObj&&i.value&&i.value.token_b.address&&b.value.tokensObj[i.value.token_b.address]&&b.value.tokensObj[i.value.token_b.address].logoURI}},Mt=await U.value.setTransations(mt)}bt&&Number(C.value)==100&&lt.value=="authenticated"&&rt.value&&(await $e.subscribePosition({pool_address:i.value.poolAddress,position_index:i.value.index},i.value.nftHash,!1),W()),bt&&(o.value="",s.value="",setTimeout(()=>{Number(C.value)!==100&&ctx.emit("getDetails")},3e3),setTimeout(()=>{Number(C.value)!==100&&ctx.emit("getDetails")},6e3),Number(C.value)==100&&De.name=="new-position-detail"&&(x.value==="Aptos"?Ce.push("/position"):Ce.push("/pool/position")),C.value=0)}else Ae(!1),Ye(!0);be.value=!1}catch(ae){console.log("Remove error",ae),be.value=!1,Ae(!1),Ye(!0)}};return(w,A)=>{const q=zt,Z=He;return f(),N("div",zi,[t("div",Wi,[t("div",Hi,[j(K(Ot),{"tab-list":H,"current-tab":"Remove",onOnClick:A[0]||(A[0]=X=>{X.name=="Increase"&&K(B).setPositionDetailCurrentTab("increase")})})]),t("div",{class:et(["card-container",[h.value?"input-block-add-top":"",y.value?"input-block-add-bottom":"",v.value?"card-container reverse":"card-container"]])},[j(dt,{modelValue:o.value,"onUpdate:modelValue":A[1]||(A[1]=X=>o.value=X),"input-value":o.value,"coin-symbol":p.value?p.value.symbol:null,"coin-name":p.value?p.value.name:null,balance:u.value,"coin-icon":p.value?p.value.logoURI:"",address:p.value?p.value.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:A[2]||(A[2]=X=>z("fromCoin")),onOnHalf:A[3]||(A[3]=X=>Q("fromCoin")),onOnInput:A[4]||(A[4]=X=>{o.value=X,_.value=!0,P.value=!1}),onOnFocus:A[5]||(A[5]=()=>{h.value=!0,y.value=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),j(dt,{modelValue:s.value,"onUpdate:modelValue":A[6]||(A[6]=X=>s.value=X),"input-value":s.value,"coin-symbol":n.value?n.value.symbol:null,"coin-name":n.value?n.value.name:null,balance:T.value,"swap-direct":"To","coin-icon":n.value?n.value.logoURI:"",address:n.value?n.value.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:A[7]||(A[7]=X=>z("toCoin")),onOnHalf:A[8]||(A[8]=X=>Q("toCoin")),onOnInput:A[9]||(A[9]=X=>{s.value=X,_.value=!1,P.value=!1}),onOnFocus:A[10]||(A[10]=()=>{h.value=!1,y.value=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),u.value==0?(f(),N("div",Xi)):ee("",!0),T.value==0?(f(),N("div",Vi)):ee("",!0)],2),t("div",Gi,[Ji,t("div",Yi,[Number(u.value)>=Number(o.value)&&Number(T.value)>=Number(s.value)?(f(),N("div",Qi,R(C.value>0&&Number(K(Ie)(C.value,2))<.01?"<0.01":K(Ie)(C.value,2))+"% ",1)):(f(),N("div",Ki," -- ")),t("div",Zi,[(f(),N(tt,null,ot(qe,(X,se)=>t("div",{key:se,class:et(["ratio-item",C.value==X.value?"ratio-item-active":""]),onClick:()=>{P.value=!0,C.value=X.value}},R(X.name),11,ea)),64))])]),j(q,{value:C.value,"onUpdate:value":A[11]||(A[11]=X=>C.value=X)},null,8,["value"])])]),E.value.connected?(f(),ve(Z,{key:0,class:"big-btn liquidity-btn",loading:be.value,disabled:Je.value,onClick:Ee},{default:ne(()=>[t("span",null,R(re.value),1)]),_:1},8,["loading","disabled"])):(f(),ve(Z,{key:1,class:"big-btn",onClick:A[12]||(A[12]=X=>E.value.connected?ge.value=!0:E.value.setIsShowWalletModal(!0))},{default:ne(()=>[t("span",null,R(w.$t("button.connectWallet")),1)]),_:1}))])}}});const oa=he({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const h=qt(),y=m(()=>h),H=m(()=>y.value.status),B=Se(),o=$(!1);ie(()=>H.value,I=>{I=="authenticated",o.value=!1},{immediate:!0});const s=$(!1),g=async()=>{s.value=!s.value;const I={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},b=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await h.subscribePosition(I,b,s.value)}catch{s.value=!s.value}},D=I=>{const b=I.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",b),s.value=b.some(l=>JSON.parse(l.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(l.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return nt(),ie(()=>[y.value.sourceGroups,e.positionInfo],([I,b])=>{s.value=!1,I&&I.length>0&&I[0]&&b&&!te(b)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),D(I[0]))},{immediate:!0,deep:!0}),{importIcon:Bt,isShowSetUp:o,changeSwitch:g,checked:s,notifiStatus:H,store:B}}});const na=e=>(je("data-v-a8222ee6"),e=e(),Fe(),e),ia={class:"range-alerts"},aa={class:"range-alerts-top"},sa={class:"title"},la=na(()=>t("div",{class:"title-all"},[t("span",{class:"Range"},"Range Alerts")],-1)),ra={key:1,class:"h5-switch-box"},ua={class:"range-alerts-bottom"},ca={key:0,class:"pc-switch-box"};function da(e,h,y,H,B,o){const s=He,g=Wt;return f(),N("div",ia,[t("div",aa,[t("div",sa,[la,e.isShowSetUp||e.notifiStatus!=="authenticated"?(f(),ve(s,{key:0,class:"range-alerts-button",onClick:h[0]||(h[0]=xt(D=>e.store.setIsShowNotifi(!0),["stop"]))},{default:ne(()=>[ue(" Set up ")]),_:1})):ee("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(f(),N("div",ra,[j(g,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ee("",!0)])]),t("div",ua,[ue(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(f(),N("div",ca,[j(g,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ee("",!0)])])}const va=Pe(oa,[["render",da],["__scopeId","data-v-a8222ee6"]]),ma=he({setup(){const e=_t(),h=m(()=>e),y=ho(),H=m(()=>y),B=nt(),o=m(()=>h.value.currentPositionInfo),s=$(),g=O=>{var r;return((r=h.value.tokensObj[O])==null?void 0:r.logo_url)||Bt("/image/coins/sui-unknown.png")},D=eo("Sui"),I=$(),b=async O=>{I.value=0;try{const r=await D.calculateFarmingRewards([{pool_id:O.pool_id,position_nft_id:O.id}]),a=[];let P=new M(0);r[O.id].forEach((d,C)=>{var V;const F=(V=h.value.tokensObj[d.rewarder_type])==null?void 0:V.decimals;let G=new M(d.rewarder_amount).div(Math.pow(10,F)).toString();Number(G)>0&&c.value.rewarders[C]&&(P=P.add(G),a.push({...d,rewarderAmount:G,rewarderAmountPer:G}))}),I.value=P,s.value=a}catch(r){console.log(r,"getRewarder")}},l=m(()=>H.value.farmsPoolObj),c=m(()=>l.value[o.value.poolAddress]);ie(()=>[o.value,l.value,c.value],([O,r,a])=>{var P;!te(O)&&O.positionSource=="farming"&&!te(a)?b(O):!te(r)&&!te(O)&&(s.value=(P=r[O.poolAddress])==null?void 0:P.rewarders)},{immediate:!0});const _=it(),x=m(()=>_),U=Se(),k=Ve("Sui"),{setIsShowSuccess:E,setIsShowRejected:J,setIsShowWaiting:p,setTransactionDesc:n,setTransactionTxid:v}=U,u=$(!1),T=async()=>{u.value=!0,v(""),n("Claim rewards"),p(!0);const O={pool_id:o.value.pool_id,position_nft_id:o.value.id};try{const r=await D.harvestFarms(O),a=await k.signAndExecuteTransactionBlock(x.value.currentWallet,r.txb,r.payloadParams);console.log("0221###sui swap res###",a);let P=k.handleTx(a);if(P&&P.hash){v(P.hash),p(!1),E(!0);let d={title:"Claim",res:P.res,hash:P.hash};k.showTransitionPending(d),await k.watchTransaction(d)&&setTimeout(()=>{b(o.value),k.getAccount(x.value.address)},2e3)}else p(!1),J(!0);u.value=!1}catch(r){console.log("farmsDeposit error",r),p(!1),J(!0),u.value=!1}},z=async()=>{u.value=!0,v(""),n(`Unstake ${o.value.name}`),p(!0);const O=o.value.pool_id,r=o.value.id;try{const a=await D.farmsWithdraw(O,r),P=await k.signAndExecuteTransactionBlock(x.value.currentWallet,a.txb,a.payloadParams);console.log("0221###sui swap res###",P);let d=k.handleTx(P);if(d&&d.hash){v(d.hash),p(!1),E(!0);let C={res:d.res,title:"Unstake",hash:d.hash};k.showTransitionPending(C),await k.watchTransaction(C)&&setTimeout(()=>{B.replace(`/new-position-detail?token=${o.value.tokenName}&address=${o.value.clmm_pool_id}&pos=${o.value.clmm_position_id}`),h.value.setCurrentPositionInfo(o.value.clmm_pool_id,"",o.value.tokenName,"Sui",o.value.clmm_position_id),I.value=0,u.value=!1},2e3)}else p(!1),J(!0)}catch(a){console.log("farmsDeposit error",a),p(!1),J(!0),u.value=!1}},Q=async()=>{u.value=!0,v(""),n(`Stake ${o.value.name}`),p(!0);const O={clmm_pool_id:o.value.poolAddress,clmm_position_id:o.value.pos_object_id,coinTypeA:o.value.coin_type_a,coinTypeB:o.value.coin_type_b},r=l.value[o.value.poolAddress].id;try{const a=await D.farmsDeposit(O,r),P=await k.signAndExecuteTransactionBlock(x.value.currentWallet,a.txb,a.payloadParams);console.log("0221###sui swap res###",P);let d=k.handleTx(P);if(d&&d.hash){v(d.hash),p(!1),E(!0);let C={res:d.res,title:"Staked",hash:d.hash};k.showTransitionPending(C);const F=await k.watchTransaction(C,!0);let G;F!=null&&F.status&&setTimeout(async()=>{var V,ge;(ge=(V=F==null?void 0:F.res)==null?void 0:V.events)==null||ge.forEach(S=>{S.type.indexOf("::pool::DepositEvent")>-1&&(G=S.parsedJson.wrapped_position_id)}),B.replace(`/new-position-detail?position_nft_id=${G}&positionSource=farming`),await h.value.setCurrentPositionInfo("","","","Sui",G,"farming"),u.value=!1},2e3)}else p(!1),J(!0)}catch(a){console.log("farmsDeposit error",a),p(!1),J(!0),u.value=!1}},i=m(()=>U),Y=m(()=>i.value.addressLpTokens);return{getCoinIcon:g,rewardList:s,sFixD:Ie,addCommom:oe,claim:T,unStake:z,loading:u,totalRewardAmount:I,currentPositionInfo:o,stake:Q,farmsPoolObj:l,addressLpTokens:Y,farmsPoolInfo:c}}});const Ue=e=>(je("data-v-8a2c6b44"),e=e(),Fe(),e),fa={key:0,class:"farms-position-detail-box"},pa={class:"farms-top"},_a=Ue(()=>t("div",{class:"left"},[t("div",{class:"title"},"Farming"),t("div",{class:"desc"},"Stake Position to Earn")],-1)),ha={class:"right"},ga={class:"apr"},ba={class:"apr-tips-box"},ka=Ue(()=>t("span",null,"View",-1)),wa=Ue(()=>t("svg",{class:"arrow-icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-icon_arrow"})],-1)),ya=[ka,wa],Ia={class:"farms-bottom"},Pa=Ue(()=>t("div",{class:"title"},"Farming Rewards",-1)),Sa={key:0,class:"reward-list"},Aa={key:0,class:"rewards-item-bg"},$a={class:"rewards-item-box"},xa={alt:""},Ta={key:1},Ca={class:"rewards-item-bg"},Na={class:"rewards-item-box"},Oa={alt:""},qa=Ue(()=>t("span",null,"0",-1)),Ba={key:1,class:"reward-list"},La={key:0,class:"rewards-item-bg"},Ra={class:"rewards-item-box"},Ma={alt:""},ja=Ue(()=>t("span",null,"0",-1)),Fa={key:1},Ua={class:"rewards-item-bg"},Da={class:"rewards-item-box"},Ea={alt:""},za=Ue(()=>t("span",null,"0",-1)),Wa={class:"actions-box"};function Ha(e,h,y,H,B,o){var b,l,c;const s=_o,g=He,D=pt,I=Ht("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(f(),N("div",fa,[t("div",pa,[_a,t("div",ha,[t("div",ga,[ue(" APRÂ  "),t("span",null,[ue(R(("addCommom"in e?e.addCommom:K(oe))(((b=e.farmsPoolInfo)==null?void 0:b.total_apr)*100,2))+"%Â  ",1),t("div",ba,[j(s,{"l-item":e.farmsPoolInfo,"rewarder-info":(c=(l=e.farmsPoolInfo)==null?void 0:l.rewarder)==null?void 0:c.rewardList},null,8,["l-item","rewarder-info"])])])]),t("div",{class:"view",onClick:h[0]||(h[0]=_=>e.$router.push("/farms"))},ya)])]),t("div",Ia,[Pa,e.rewardList&&e.rewardList.length>0?(f(),N("div",Sa,[(f(!0),N(tt,null,ot(e.rewardList,_=>(f(),N("div",{key:_,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(f(),N("div",Aa,[t("div",$a,[ze(t("img",xa,null,512),[[I,e.getCoinIcon(_.rewarder_type)]]),t("span",null,R(("addCommom"in e?e.addCommom:K(oe))(_.rewarderAmount||0)),1)])])):(f(),N("div",Ta,[t("div",Ca,[t("div",Na,[ze(t("img",Oa,null,512),[[I,e.getCoinIcon(_.reward_coin)]]),qa])])]))]))),128))])):(f(),N("div",Ba,[(f(!0),N(tt,null,ot(e.currentPositionInfo.rewards,_=>(f(),N("div",{key:_,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(f(),N("div",La,[t("div",Ra,[ze(t("img",Ma,null,512),[[I,e.getCoinIcon(_.rewarder_type)]]),ja])])):(f(),N("div",Fa,[t("div",Ua,[t("div",Da,[ze(t("img",Ea,null,512),[[I,e.getCoinIcon(_.reward_coin)]]),za])])]))]))),128))])),t("div",Wa,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(f(),ve(g,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:ne(()=>[ue("Unstake")]),_:1},8,["loading","onClick"])):ee("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(f(),ve(D,{key:1},{title:ne(()=>[ue("Farming rewards are only available for active positions.")]),default:ne(()=>[j(g,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:ne(()=>[ue("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(f(),ve(g,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:ne(()=>[ue("Stake")]),_:1},8,["loading","onClick"])):ee("",!0),j(g,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:xt(e.claim,["stop"])},{default:ne(()=>[ue("Claim")]),_:1},8,["loading","disabled","onClick"])])])])):ee("",!0)}const Xa=Pe(ma,[["render",Ha],["__scopeId","data-v-8a2c6b44"]]),Va={class:"new-position-detail"},Ga={class:"new-position-content"},Ja={class:"left"},Ya={class:"right"},Qa={class:"loading-global"},Ka=he({__name:"new-position-detail-sui",setup(e){const h=nt(),{getCurrentPosition:y}=Tt(),{getPoolList:H}=to(),B=$(),o=$();St(()=>{B.value=h.currentRoute.value.query.id||"",o.value=h.currentRoute.value.query.positionSource||""});const s=Xe(),g=m(()=>s.poolsObj),D=Vt(),I=m(()=>(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:293 ~ allTokensObj ~ suiTokenStore.allTokensObj:",D.allTokensObj),D.allTokensObj));ie(()=>I.value,k=>{k&&!te(k)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail-sui.vue:298 ~ watch ~ getPoolList:"),H())},{immediate:!0}),ie(()=>[g.value,I.value,B.value,o.value],([k,E,J,p])=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ positionSource:",p),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ routerId:",J),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ allTokensObj:",E),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:42 ~ poolsObj:",k),k&&!te(k)&&E&&!te(E)&&J&&p&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-detail.vue:38 ~ getCurrentPosition:"),y(J,p))},{immediate:!0});const b=it(),l=m(()=>b),c=Ve("Sui"),_=()=>{y(B.value,o.value),l.value.address&&c.getAccount(l.value.address)},x=m(()=>s.currentPositionLoading),U=m(()=>s.positionDetailCurrentTab);return(k,E)=>{const J=Xt;return f(),N("div",Va,[j(Ao,{onClickRefresh:_}),t("div",Ga,[t("div",Ja,[j(un),j(It,{class:"pc-module",onGetDetails:k.getDetails},null,8,["onGetDetails"])]),t("div",Ya,[U.value=="increase"?(f(),ve(Ei,{key:0,onGetDetails:k.getDetails},null,8,["onGetDetails"])):(f(),ve(ta,{key:1,onGetDetails:k.getDetails},null,8,["onGetDetails"])),j(It,{class:"h5-module",onGetDetails:k.getDetails},null,8,["onGetDetails"]),j(Xa),k.positionInfo&&k.positionInfo.minPrice!=="0"&&k.positionInfo.maxPrice!=="âˆž"?(f(),ve(va,{key:2,"position-info":k.positionInfo},null,8,["position-info"])):ee("",!0)])]),ze(t("div",Qa,[j(J)],512),[[At,x.value]])])}}});const Ws=Pe(Ka,[["__scopeId","data-v-f1c2b828"]]);export{Ws as default};
