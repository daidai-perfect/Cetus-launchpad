import{_ as Vo}from"./back.ae7f599f.js";import{_ as xo}from"./swap-setting.20ece20e.js";import{a as Xe,u as xe,b as eo,j as go,p as Ao,c as en}from"./pool.af987f29.js";import{a as ze,r as R,m as _,e as Ye,o as y,f as S,h as n,v as F,c as Ne,x as de,p as so,k as ao,C as No,D as ye,b as lo,i as re,z as vo,y as Ro,t as Pe,G as Oo,E as fo,q as wo,u as J,j as me,w as Le,L as qo,l as yo,a2 as on,a3 as Ge,a4 as nn,a7 as Co,H as $o,F as Ve,s as to,B as co,S as tn,a8 as sn,a9 as an,K as Lo,W as ln,J as rn}from"./entry.1237ae89.js";import{c as ve,a as un,n as dn,d as ke,b as Z,s as Ue,u as mo,j as Se,e as qe,x as Bo,y as Mo,T as So,C as cn}from"./index.1c4d7e0e.js";import{_ as po}from"./token-warning.79224669.js";import{_ as Uo}from"./status-block.0c1e07da.js";import{s as uo,m as mn,l as vn,b as fn,a as pn}from"./transform.c672907f.js";import{D as g}from"./decimal.0bdeb344.js";/* empty css              */import{i as io}from"./import-icon.de3e6c66.js";import"./index.34e13427.js";import{_ as ho}from"./assets-card.dc55790f.js";import{_ as hn}from"./coin-lock.b05dd028.js";import{a as bn}from"./new-add-or-create.4cd5876c.js";import{_ as gn,a as kn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              */import{u as jo}from"./notifi.06c7b509.js";import{_ as _n}from"./apr-tips.69f84a33.js";import{u as Eo}from"./farms.3c60dbba.js";/* empty css              *//* empty css              *//* empty css              */import"./icon-error_2x.c2dc5195.js";import"./useDebounceFunction.fdf6dec1.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.6662b70b.js";import"./useWhale.6c207cce.js";import"./icon_fee_2x.d5699afd.js";import"./icon_rewards_2x.41d69262.js";const ko=Math.PI,_o=2*ko,Ke=1e-6,wn=_o-Ke;function Do(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function yn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Do;const i=10**t;return function(a){this._+=a[0];for(let P=1,h=a.length;P<h;++P)this._+=Math.round(arguments[P]*i)/i+a[P]}}class In{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Do:yn(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,a,P){this._append`Q${+t},${+i},${this._x1=+a},${this._y1=+P}`}bezierCurveTo(t,i,a,P,h,T){this._append`C${+t},${+i},${+a},${+P},${this._x1=+h},${this._y1=+T}`}arcTo(t,i,a,P,h){if(t=+t,i=+i,a=+a,P=+P,h=+h,h<0)throw new Error(`negative radius: ${h}`);let T=this._x1,m=this._y1,o=a-t,r=P-i,p=T-t,u=m-i,b=p*p+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(b>Ke)if(!(Math.abs(u*o-r*p)>Ke)||!h)this._append`L${this._x1=t},${this._y1=i}`;else{let z=a-T,oe=P-m,ne=o*o+r*r,Y=z*z+oe*oe,f=Math.sqrt(ne),w=Math.sqrt(b),q=h*Math.tan((ko-Math.acos((ne+b-Y)/(2*f*w)))/2),s=q/w,I=q/f;Math.abs(s-1)>Ke&&this._append`L${t+s*p},${i+s*u}`,this._append`A${h},${h},0,0,${+(u*z>p*oe)},${this._x1=t+I*o},${this._y1=i+I*r}`}}arc(t,i,a,P,h,T){if(t=+t,i=+i,a=+a,T=!!T,a<0)throw new Error(`negative radius: ${a}`);let m=a*Math.cos(P),o=a*Math.sin(P),r=t+m,p=i+o,u=1^T,b=T?P-h:h-P;this._x1===null?this._append`M${r},${p}`:(Math.abs(this._x1-r)>Ke||Math.abs(this._y1-p)>Ke)&&this._append`L${r},${p}`,a&&(b<0&&(b=b%_o+_o),b>wn?this._append`A${a},${a},0,1,${u},${t-m},${i-o}A${a},${a},0,1,${u},${this._x1=r},${this._y1=p}`:b>Ke&&this._append`A${a},${a},0,${+(b>=ko)},${u},${this._x1=t+a*Math.cos(h)},${this._y1=i+a*Math.sin(h)}`)}rect(t,i,a,P){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${a=+a}v${+P}h${-a}Z`}toString(){return this._}}function no(e){return function(){return e}}function An(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const a=Math.floor(i);if(!(a>=0))throw new RangeError(`invalid digits: ${i}`);t=a}return e},()=>new In(t)}function Cn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fo(e){this._context=e}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $n(e){return new Fo(e)}function Sn(e){return e[0]}function Pn(e){return e[1]}function Tn(e,t){var i=no(!0),a=null,P=$n,h=null,T=An(m);e=typeof e=="function"?e:e===void 0?Sn:no(e),t=typeof t=="function"?t:t===void 0?Pn:no(t);function m(o){var r,p=(o=Cn(o)).length,u,b=!1,z;for(a==null&&(h=P(z=T())),r=0;r<=p;++r)!(r<p&&i(u=o[r],r,o))===b&&((b=!b)?h.lineStart():h.lineEnd()),b&&h.point(+e(u,r,o),+t(u,r,o));if(z)return h=null,z+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:no(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:no(+o),m):t},m.defined=function(o){return arguments.length?(i=typeof o=="function"?o:no(!!o),m):i},m.curve=function(o){return arguments.length?(P=o,a!=null&&(h=P(a)),m):P},m.context=function(o){return arguments.length?(o==null?a=h=null:h=P(a=o),m):a},m}function Po(){}function Wo(e){this._context=e}Wo.prototype={areaStart:Po,areaEnd:Po,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Nn(e){return new Wo(e)}const Rn=ze({setup(){const e=Xe(),t=R(!1),i=_(()=>e);return{slippage:_(()=>i.value.slippage),isShowSwapSetting:t}}});const On=e=>(so("data-v-82585f8b"),e=e(),ao(),e),qn=On(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Ln(e,t,i,a,P,h){const T=xo;return y(),S("div",{class:"slippage-icon",onClick:t[1]||(t[1]=m=>e.isShowSwapSetting=!0)},[qn,n("span",null,F(e.slippage)+"%",1),e.isShowSwapSetting?(y(),Ne(T,{key:0,onOnClose:t[0]||(t[0]=m=>e.isShowSwapSetting=!1)})):de("",!0)])}const Bn=Ye(Rn,[["render",Ln],["__scopeId","data-v-82585f8b"]]),Mn=ze({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const i=R(!1),a=R(null),P=R(0),h=R(20),T=xe(),m=Xe(),o=R(!1);No(()=>{clearInterval(a.value)});const r=()=>{a.value=setInterval(()=>{var Y;o.value||P.value<h.value&&(P.value+=1,P.value===h.value&&((Y=e==null?void 0:e.poolInfo)!=null&&Y.poolAddress&&T.updateCurrentPools(e.poolInfo.poolAddress,m.chainName),P.value=0))},1e3)},p=_(()=>m.slippage),u=()=>{t.emit("clearAll")},b=R(!1),z=()=>{P.value=0,b.value=!0,t.emit("clickRefresh"),setTimeout(()=>{b.value=!1},1e3)};ye(()=>e.poolInfo,Y=>{Y&&!a.value&&r()},{immediate:!0});const oe=lo(),ne=_(()=>m.chainName);return{clickRefresh:z,isShowSwapSetting:i,countdown:P,autoRefreshTime:h,slippage:p,clearAll:u,checkNullObj:ve,router:oe,loading:o,chainName:ne,refresh:b}}});const Un=e=>(so("data-v-ca768f9b"),e=e(),ao(),e),jn={class:"new-position-title"},En={class:"left"},Dn={class:"right"},Fn=Un(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Wn=[Fn];function Hn(e,t,i,a,P,h){const T=Vo,m=Bn;return y(),S("div",jn,[n("div",En,[re(T)]),n("div",Dn,[re(m),(y(),S("svg",{"aria-hidden":"true",class:vo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:t[0]||(t[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Wn,2))])])}const Ho=Ye(Mn,[["render",Hn],["__scopeId","data-v-ca768f9b"]]);function To(e,t,i){const a=new g(10).pow(t-i);return new g(1.0001).pow(e).mul(a)}const Xn=ze({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const i=R(1),a=R(""),P=R(""),h=_(()=>{var s,I,v;return u.sqrtPriceX64ToPrice((s=e.poolInfo)==null?void 0:s.current_sqrt_price,(I=e.poolInfo)==null?void 0:I.coinA.decimals,(v=e.poolInfo)==null?void 0:v.coinB.decimals).toString()}),T=_(()=>{let s=0;return e.direction?s=(Number(e.minPrice)/Number(h.value)-1)*100:s=(Number(e.minPrice)/Number(1/Number(h.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),m=_(()=>{let s=0;return e.direction?s=(Number(e.maxPrice)/Number(h.value)-1)*100:s=(Number(e.maxPrice)/Number(1/Number(h.value))-1)*100,s=s>0&&s<.1?.1:s,s=s<0&&s>-.1?-.1:s,s}),o=Xe(),r=_(()=>o),p=_(()=>r.value.chainName?eo(r.value.chainName):{}),{TickMath:u,getNearestTickByTick:b}=p.value,z=()=>{const s=i.value/2;i.value=s,Y(e.poolInfo,s)},oe=()=>{const s=i.value*2;i.value=s,Y(e.poolInfo,s)},ne=(s=[])=>{let I=6;const v=Math.abs(Number(s[0])-Number(s[s.length-1]));return v>=6?I=0:v>=1?I=1:v>=.1?I=2:v>=.01?I=3:v>=.001?I=4:v>=1e-4?I=5:v>=1e-5?I=6:v>=1e-6?I=7:v>=1e-7&&(I=8),I},Y=(s,I=1)=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:189 ~ dataProcessing ~ zooms:",I),s&&s.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const v=Number(e.poolInfo.current_tick_index);let k=v+100*I,l=v-100*I,te,K;if(e.maxPrice==="âˆž")K=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?K=u.priceToTickIndex(new g(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):K=u.priceToTickIndex(new g(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{K=443636}if(e.minPrice==="0")te=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?te=u.priceToTickIndex(new g(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):te=u.priceToTickIndex(new g(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{te=-443636}let ie=0;if(e.currentPriceTab!=="full range"){if(v>=te&&v<=K){const M=v-te,ge=K-v;ie=Math.max(Math.abs(M),Math.abs(ge))}else v<te?ie=Math.abs(K-v):ie=Math.abs(v-te);k=v+ie+20*I,l=v-ie-20*I}else{const M=(Math.abs(v)>5e3,2e4);k=v+M*I,l=v-M*I}l<-443636&&(l=-443636),k>443636&&(k=443636);const W=new g(s.liquidity).div(Math.pow(10,8)).toString(),$=e.tickList,B=[],N=[];let H={};for(let M=0;M<$.length;M++){if(H=$[M],H.index<=v&&H.index>=l){if(B.length<1&&M!==0){const ge=$[M-1];B.unshift({...ge,index:l})}B.unshift(H)}else if(H.index>v&&H.index<=k&&(N.push(H),B.length<1&&M!==0)){const ge=$[M-1];B.push({...ge,index:l})}if(H.index>k){const ge=$[M];if(N.push({...ge,index:k}),B.length<1&&M!==0){const Ie=$[M-1];B.push({...Ie,index:l})}break}}let x="0";for(let M=B.length-1;M>=0;M--)x=new g(x).plus(new g(B[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),B[M].liquityAmount=x;let Q=W;for(let M=0;M<N.length;M++)Q=new g(Q).plus(new g(N[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),N[M].liquityAmount=Q;let se=[];const V=$&&$.length>0?{index:v,liquityAmount:Number(W)}:{index:v,liquityAmount:0};(B.length>0||N.length>0)&&(se=[...B.reverse(),V,...N],e.direction||(se=se.reverse()));const be=[];$.forEach(M=>{be.push({...M,liquidityGross:M.liquidityGross.toString(),liquidityNet:M.liquidityNet.toString()})}),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:384 ~ dataProcessing ~ tickMin, tickMax, minPriceTick, maxPriceTick:",l,k,te,K,v),w(se,l,k,te,K,v)}};let f=R(!0);Ro(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,Y(e.poolInfo,i.value)}});const w=(s,I,v,k,l,te)=>{let K,ie;e.direction?(K=e.before7dContractPriceLowest?u.priceToTickIndex(new g(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ie=e.before7dContractPriceHighest?u.priceToTickIndex(new g(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(K=e.before7dContractPriceLowest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ie=e.before7dContractPriceHighest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const W={top:30,right:35,bottom:20,left:55};let $,B;f.value,$=340-W.left-W.right,B=205-W.top-W.bottom;const N=v-I,H=parseInt(String(N/4));let x=[I+H/4,I+H,I+2*H,v-H,v-H/4];const Q=I,se=v,V=$/(se-Q);e.currentPriceTab==="full range"&&(x=[I,I+2*H,v]);const be=x.map(O=>e.direction?To(O,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new g(1).div(To(O,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ne(be),uo("#chart").selectAll("*").remove();const M=uo("#chart").attr("width",$+W.left+W.right).attr("height",B+W.top+W.bottom).append("g").attr("transform",`translate(${W.left},${W.right})`),ge=mn(s,function(O){return Number(Math.abs(O.liquityAmount))})||0,Ie=vn().range([0,B]).domain([ge,0]);fn().rangeRound([0,$]).padding(.1);const Me=M.append("g").attr("id","barsBox").selectAll("rect").data(s).enter().append("rect");r.value.theme=="default"?Me.attr("x",function(O,j){return j===0?0:e.direction?Math.abs(O.index-Q)*V:Math.abs(se-O.index)*V}).attr("y",function(O,j){return e.direction?j===s.length-1?0:Ie(O.liquityAmount):j===s.length-1?0:Ie(s[j+1].liquityAmount)}).attr("width",function(O,j){return j===0&&s.length===1&&O.liquityAmount>0?$:(e.direction,j!==s.length-1?Math.abs(s[j+1].index-O.index)*V:0)}).attr("height",function(O,j){return j===0&&s.length===1&&O.liquityAmount>0?B:e.direction?j===s.length-1?0:B-Ie(O.liquityAmount):j===s.length-1?0:B-Ie(s[j+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Me.attr("x",function(O,j){return j===0?0:e.direction?Math.abs(O.index-Q)*V:Math.abs(se-O.index)*V}).attr("y",function(O,j){return e.direction?j===s.length-1?0:Ie(Math.abs(O.liquityAmount)):j===s.length-1?0:Ie(Math.abs(s[j+1].liquityAmount))}).attr("width",function(O,j){return j===0&&s.length===1&&O.liquityAmount>0?$:(e.direction,j!==s.length-1?Math.abs(s[j+1].index-O.index)*V:0)}).attr("height",function(O,j){if(j===0&&s.length===1&&O.liquityAmount>0)return B;if(e.direction)return j===s.length-1?0:Number(O.liquityAmount)?B-Ie(Math.abs(O.liquityAmount)):0;{if(j===s.length-1)return 0;const ce=B-Ie(Math.abs(s[j+1].liquityAmount));return Number(s[j+1].liquityAmount)?ce:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const $e=M.append("g");$e.append("line").attr("x1",0).attr("y1",155).attr("x2",$).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),$e.append("g");let d=0;e.direction?d=Math.abs(te-Q)*V:d=Math.abs(te-se)*V,(r.value.theme=="default"?M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+d+", 0)"),uo("#triangle").attr("width",8).attr("height",4);let A=[[0,0],[4,4],[8,0]],U=Tn().x(function(O){return O[0]}).y(function(O){return O[1]}).curve(Nn);const E=d-4;M.append("path").attr("d",U(A)).style("fill",r.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+E+", 0)");let D,X,ee,ue;e.direction?(D=k<Q?-100:parseInt(String(Math.abs(k-Q)*V)),X=l<Q?-100:parseInt(String(Math.abs(l-Q)*V)),ee=K<Q?-100:Math.abs(K-Q)*V,ue=ie<Q?-100:Math.abs(ie-Q)*V):(X=k<Q?-100:Math.abs(se-k)*V,D=l<Q?-100:Math.abs(se-l)*V,ue=K<Q?-100:Math.abs(se-K)*V,ee=ie<Q?-100:Math.abs(se-ie)*V),e.minPrice==="0"&&(D=0),e.maxPrice==="âˆž"&&(X=$),f.value?a.value=$-D+60+"px":a.value=$-D+52+"px",P.value=X+74+"px",K&&ee<$&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ee+", 0)"),ie&&ue<$&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ue+", 0)");const fe=pn().extent([[0,0],[$,B]]).handleSize(30).on("end",_e);M.append("g").attr("class","brush").call(fe).call(fe.move,[D,X]);function _e(O){if(!O.sourceEvent||!O.selection)return;f.value?a.value=$-O.selection[0]+60+"px":a.value=$-O.selection[0]+52+"px",P.value=O.selection[1]+74+"px";let j,ce,pe=0,C=0;e.direction?(pe=b(parseInt(String(O.selection[0]/V+Q)),Number(e.poolInfo.tickSpacing)),j=u.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),C=b(parseInt(String(O.selection[1]/V+Q)),Number(e.poolInfo.tickSpacing)),ce=u.tickIndexToPrice(C,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(C=b(se-O.selection[0]/V,Number(e.poolInfo.tickSpacing)),j=1/u.tickIndexToPrice(C,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=b(se-O.selection[1]/V,Number(e.poolInfo.tickSpacing)),ce=1/u.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ke(String(j),6))),t.emit("onChangeMaxPrice",String(ke(String(ce),6)))}r.value.theme=="default"?uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};R(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([s,I,v,k,l])=>{s&&I&&v&&k&&l&&l.length>0&&Y(s,i.value)},{immediate:!0});const q=R(!0);return ye(()=>e.chartLoading,(s,I)=>{s!==I&&(q.value=s)},{immediate:!0,deep:!0}),{store:r,loading:q,zoomOut:z,zoomIn:oe,rangeSizeLower:T,rangeSizeUpper:m,rangeSizeLowerPosition:a,rangeSizeUpperPosition:P,decimalFormat:un,numberformat:dn}}});const zn=e=>(so("data-v-992b1bf2"),e=e(),ao(),e),Yn={class:"chart-box"},Gn={class:"chart"},Jn=zn(()=>n("svg",{id:"chart"},null,-1)),Qn=[Jn];function Zn(e,t,i,a,P,h){return y(),S("div",Yn,[Pe(n("div",Gn,Qn,512),[[Oo,!e.loading]])])}const Xo=Ye(Xn,[["render",Zn],["__scopeId","data-v-992b1bf2"]]),Kn=ze({components:{StatusBlock:Uo,NewPositionChart:Xo,TokenWarning:po},setup(e){const t=R(),i=R(),a=_(()=>{var v,k;return(k=(v=u.value)==null?void 0:v.poolInfo)==null?void 0:k.needReverse}),P=Xe(),h=_(()=>P),T=_(()=>h.value.currentExplorer),m=_(()=>h.value.theme),o=_(()=>h.value.chainName),r=xe(),p=_(()=>r),u=R({}),b=fo();ye(()=>[p.value.currentPositionInfo,o.value],([v,k])=>{var l;(k=="Aptos"&&v||k=="Sui"&&v&&(v==null?void 0:v.nftHash)==((l=b==null?void 0:b.query)==null?void 0:l.pos))&&(u.value=v,t.value=u.value.token_a,i.value=u.value.token_b)},{immediate:!0});const z=v=>{var k;return(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||((k=p.value.tokensObj[v==null?void 0:v.address])==null?void 0:k.logo_url)||(m.value==="default"?io("/image/coins/unknown.png"):io("/image/coins/sui-unknown.png"))},oe=_(()=>o.value?eo(o.value):{}),ne=R([]),Y=async v=>{const{list:k}=await oe.value.getTicks(v),l=k?oe.value.getTickDataFromUrlData(k):[];ne.value=l};ye(()=>[u.value,p.value.poolsObj],([v,k])=>{v&&!ve(v)&&v.poolInfo&&k&&!ve(k)&&Y(k[v.poolAddress])},{immediate:!0});const f=R(!0),w=(v,k)=>v!=="0"&&k!=="âˆž"?Ue(1/(1-Number((v/k)**.25)),2)+"x":"1x",q=_(()=>u.value.minPrice&&u.value.maxPrice?w(u.value.minPrice,u.value.maxPrice):"--"),s=_(()=>u.value.maxPrice!=="âˆž"?new g(1).div(new g(u.value.maxPrice)).toString():"âˆž"),I=_(()=>u.value.minPrice>0?new g(1).div(new g(u.value.minPrice)).toString():"0");return{needReverse:a,getCoinIcon:z,theme:m,indexStore:P,direct:f,addCommom:Z,decimalUi:ke,tickList:ne,positionInfo:u,fromCoin:t,toCoin:i,getExplorerUrl:go,lever:q,currentExplorer:T,minPriceResever:s,maxPriceResever:I}}}),Vn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),xn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),et=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),ot=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Je=e=>(so("data-v-e3d7556c"),e=e(),ao(),e),nt={class:"new-position-info"},tt={class:"pool-info"},it={class:"left"},st={class:"coin-a"},at={alt:""},lt={class:"coin-b"},rt={alt:""},ut={class:"position-name"},dt=["href"],ct=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),mt=[ct],vt={key:0,class:"pool-fee"},ft=Je(()=>n("span",null,"Fee tier",-1)),pt={class:"right"},ht={class:"h5-pool-info"},bt={class:"coin-info"},gt={class:"coin-a"},kt={alt:""},_t={class:"coin-b"},wt={alt:""},yt={class:"position-name"},It=["href"],At=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Ct=[At],$t={key:0,class:"pool-fee"},St={class:"price-info"},Pt={class:"price-and-chart"},Tt={class:"left"},Nt={class:"current-price"},Rt=Je(()=>n("span",null,"Current Price",-1)),Ot={class:"coin-rate"},qt=Je(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Lt=Je(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Bt=[qt,Lt],Mt={key:0},Ut={key:1},jt={key:0,class:"position-range"},Et=Je(()=>n("div",{class:"position-range-title"},"Position Range",-1)),Dt={key:0},Ft={key:1},Wt={key:2,src:Vn,alt:""},Ht={key:3,src:xn,alt:""},Xt={key:4},zt={key:5},Yt={key:1,class:"position-range position-range-warp"},Gt={key:0,class:"position-range-title"},Jt={key:1,class:"position-range-title"},Qt={key:2},Zt={key:3},Kt={class:"price-img"},Vt={key:0,src:et,alt:""},xt={key:1,src:ot,alt:""},ei={key:4},oi={key:5},ni={class:"lever"},ti={class:"lever-title"},ii=Je(()=>n("div",null,[n("span",null," Leverage "),n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),si={class:"lever-text"},ai={class:"right"},li=Je(()=>n("div",{class:"chat-mask"},null,-1));function ri(e,t,i,a,P,h){var u,b,z,oe,ne,Y,f,w,q,s,I,v,k,l,te,K,ie,W,$,B,N,H,x,Q,se,V,be,M,ge,Ie;const T=po,m=Uo,o=qo,r=Xo,p=wo("image");return y(),S("div",nt,[n("div",tt,[n("div",it,[n("div",st,[Pe(n("img",at,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(oe=(z=e.positionInfo)==null?void 0:z.token_b)==null?void 0:oe.address:(b=(u=e.positionInfo)==null?void 0:u.token_a)==null?void 0:b.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",lt,[Pe(n("img",rt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(w=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:w.address:(Y=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:Y.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ut,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(go))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((s=(q=e.positionInfo)==null?void 0:q.name)==null?void 0:s.split("|")[1]),9,dt)]),(y(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},mt)),e.positionInfo.fee?(y(),S("div",vt,[ft,me(" "+F(e.positionInfo.fee*100)+"% ",1)])):de("",!0)]),n("div",pt,[re(m,{"current-status":(I=e.positionInfo)==null?void 0:I.currentStatus},null,8,["current-status"])])]),n("div",ht,[n("div",null,[n("div",bt,[n("div",gt,[Pe(n("img",kt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(te=(l=e.positionInfo)==null?void 0:l.token_b)==null?void 0:te.address:(k=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:k.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",_t,[Pe(n("img",wt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?($=(W=e.positionInfo)==null?void 0:W.token_a)==null?void 0:$.address:(ie=(K=e.positionInfo)==null?void 0:K.token_b)==null?void 0:ie.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",yt,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(go))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((N=(B=e.positionInfo)==null?void 0:B.name)==null?void 0:N.split("|")[1]),9,It),(y(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=Be=>e.indexStore.copy(e.positionInfo.nftHash))},Ct))]),e.positionInfo.fee?(y(),S("div",$t,F(e.positionInfo.fee*100)+"% ",1)):de("",!0)])]),re(m,{"current-status":(H=e.positionInfo)==null?void 0:H.currentStatus},null,8,["current-status"])]),n("div",St,[n("div",Pt,[n("div",Tt,[n("div",Nt,[n("div",null,[Rt,n("div",Ot,[n("div",{onClick:t[2]||(t[2]=Be=>e.direct=!e.direct)},Bt)])]),(e.needReverse?!e.direct:e.direct)?(y(),S("div",Mt,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,F((x=e.toCoin)==null?void 0:x.symbol)+" per "+F((Q=e.fromCoin)==null?void 0:Q.symbol),1)])):(y(),S("div",Ut,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,F((se=e.fromCoin)==null?void 0:se.symbol)+" per "+F((V=e.toCoin)==null?void 0:V.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(y(),S("div",jt,[Et,n("div",null,[(e.needReverse?!e.direct:e.direct)?(y(),S("div",Dt,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",Ft,[me(F(((be=e.positionInfo)==null?void 0:be.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(y(),S("img",Wt)):(y(),S("img",Ht)),(e.needReverse?!e.direct:e.direct)?(y(),S("div",Xt,[me(F(((M=e.positionInfo)==null?void 0:M.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",zt,[me(F(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(y(),S("div",Yt,[(e.needReverse?!e.direct:e.direct)?(y(),S("span",Gt," Position Range ")):(y(),S("span",Jt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(y(),S("div",Qt,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",Zt,[me(F(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPriceResever,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Kt,[e.theme=="default"?(y(),S("img",Vt)):(y(),S("img",xt))]),(e.needReverse?!e.direct:e.direct)?(y(),S("div",ei,[me(F(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",oi,[me(F(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPriceResever,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),me(" Â  ")]))])),n("div",ni,[n("div",ti,[re(o,{"overlay-class-name":"lever-tooltip"},{title:Le(()=>[me("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Le(()=>[ii]),_:1})]),n("div",si,F(e.lever),1)])]),n("div",ai,[re(r,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse?e.minPriceResever:e.positionInfo.minPrice,"max-price":e.needReverse?e.maxPriceResever:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),li])])])])}const zo=Ye(Kn,[["render",ri],["__scopeId","data-v-e3d7556c"]]),ui=ze({components:{TokenWarning:po},setup(e,t){const{t:i}=yo(),{$notify:a}=on(),P=Xe(),h=_(()=>P),T=xe(),m=_(()=>T),o=R({}),r=R({}),p=R({}),u=_(()=>h.value.chainName),b=_(()=>u.value?eo(u.value):{}),z=fo(),oe=R(!1),ne=async(d=null)=>{var U,E;const c=d||o.value,A=m.value.addressLpTokens[c.poolAddress];if(A){const D=await b.value.getTickDataByIndex(A.ticks_handle||((U=c==null?void 0:c.poolInfo)==null?void 0:U.ticks_handle),Number(c.tick_lower_index)),X=await b.value.getTickDataByIndex(A.ticks_handle||((E=c==null?void 0:c.poolInfo)==null?void 0:E.ticks_handle),Number(c.tick_upper_index));let ee={};u.value==="Aptos"?ee=await b.value.getPosRewardersAmount({poolAddress:k.currentRoute.value.query.address,positionName:k.currentRoute.value.query.token,tickLowerData:D,tickUpperData:X}):ee=await b.value.fetchPosRewardersAmount({poolAddress:c.poolAddress,positionId:c.pos_object_id||c.clmm_position_id,coinTypeA:c.coin_type_a||c.coinTypeA,coinTypeB:c.coin_type_b||c.coinTypeB,rewarderInfo:c.poolInfo.rewarder_infos});const ue=[];let fe=new g(0);ee.forEach((_e,O)=>{var C,G;const j=(C=m.value.tokensObj[_e.coin_address])==null?void 0:C.decimals,ce=_e.amount_owed.toString();let pe=new g(ce).div(Math.pow(10,j)).toString();if(u.value=="Aptos"&&Number(pe)>999999999&&(pe="0"),c.poolInfo[`rewarder_display${O+1}`]||Number(pe)>0){const L=m.value.tokensObj[_e.coin_address],le=((G=m.value.RATES[_e.coin_address])==null?void 0:G.price)||0,ae=new g(pe).mul(le).toString();fe=new g(fe).plus(ae),ue.push({..._e,...L,amount:Number(pe)>0?pe:0,amountUSD:Number(ae)>0?Se(ae,2):0,amountUSDText:ae})}}),l.value=ue}};ye(()=>[m.value.currentPositionInfo,u.value],([d,c])=>{var A;c=="Aptos"&&d?(o.value=d,r.value=d==null?void 0:d.token_a,p.value=d==null?void 0:d.token_b):c=="Sui"&&d&&(d==null?void 0:d.nftHash)==((A=z==null?void 0:z.query)==null?void 0:A.pos)&&(o.value=d,r.value=d==null?void 0:d.token_a,p.value=d==null?void 0:d.token_b,oe.value=!1)},{immediate:!0}),ye(()=>[o.value,m.value.addressLpTokens],([d,c])=>{!ve(d)&&!ve(c)&&ne(d)},{immediate:!0});const Y=_(()=>{var d,c,A,U,E,D,X,ee;if(o.value&&!ve(o.value)&&m.value.RATES){const ue=o.value.amountA*((c=m.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:c.price),fe=o.value.amountB*((U=m.value.RATES[(A=o.value)==null?void 0:A.token_b.address])==null?void 0:U.price);if((D=m.value.RATES[(E=o.value)==null?void 0:E.token_a.address])!=null&&D.price&&((ee=m.value.RATES[(X=o.value)==null?void 0:X.token_b.address])!=null&&ee.price)){const _e=Number(ue+fe);return _e>0&&_e<.01?"<0.01":Z(Ue(ue+fe,2),2)}else return" --"}else return" --"}),f=_(()=>{var d,c;return(c=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:c.needReverse}),w=_(()=>m.value.RATES),q=_(()=>{var d,c;if(w.value&&r.value&&p.value&&!ve(w.value)&&!ve(r.value)&&!ve(p.value)){const A=[],U=Number(o.value.feeOwedA)||0,E=Number(o.value.feeOwedB)||0,D=new g(U).mul(((d=w.value[r.value.address])==null?void 0:d.price)||0),X=new g(E).mul(((c=w.value[p.value.address])==null?void 0:c.price)||0);return A.push({amount:U,amountUSD:D.toString()},{amount:E,amountUSD:X.toString()}),A}return[]}),s=_(()=>{var c,A;let d=new g(0);return(c=q==null?void 0:q.value)==null||c.forEach(U=>{d=d.add(new g(U.amount))}),u.value=="Sui"&&((A=l==null?void 0:l.value)==null||A.forEach(U=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:622 ~ canClaimYield ~ ele:",U),d=d.add(new g(U.amount))})),d.toNumber()}),I=_(()=>{var c,A;let d=new g(0);return(c=q==null?void 0:q.value)==null||c.forEach(U=>{d=d.add(new g(U.amountUSD))}),u.value=="Sui"&&((A=l==null?void 0:l.value)==null||A.forEach(U=>{d=d.add(new g(U.amountUSDText))})),d.toNumber()}),v=_(()=>{var c;let d=new g(0);return(c=l.value)==null||c.forEach(A=>{d=d.add(new g(A.amountUSDText))}),d.toNumber()}),k=lo(),l=R([]),{setIsShowSuccess:te,setIsShowRejected:K,setIsShowWaiting:ie,setTransactionDesc:W,setTransactionTxid:$}=P,B=mo(),N=_(()=>B),H=async()=>{oe.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:l.value.length,collect_fee:!0};d.coinTypeC=l.value[0]?l.value[0].coin_address:"",d.coinTypeD=l.value[1]?l.value[1].coin_address:"",d.coinTypeE=l.value[2]?l.value[2].coin_address:"",ie(!0),W();try{let c;if(u.value==="Aptos"){const A=await b.value.getCollectRewarderTransactionPayload(d);c=await N.value.currentWallet.signAndSubmitTransaction(A)}else{d.pos_index=o.value.pos_object_id;const A=await b.value.getCollectRewarderTransactionPayload(d,o.value),U=await b.value.signAndExecuteTransactionBlock(N.value.currentWallet,A.txb,A.payloadParams);c=b.value.handleTx(U)}if(c&&c.hash){$(c.hash),ie(!1),te(!0);const A={title:"Claim",desc:"",hash:c.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(A.res=c.res),b.value.showTransitionPending(A),await b.value.watchTransaction(A)&&(t.emit("getDetails"),setTimeout(()=>{b.value.getAccount(N.value.address)},3e3))}else console.log("0310###toClaimRewards###else###"),ie(!1),K(!0),oe.value=!1}catch(c){ie(!1),K(!0),oe.value=!1,console.log(c,"error===>")}},x=R(!1),Q=async()=>{x.value=!0;const d=l.value;let c={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};c.coinTypeC=d[0]?d[0].coin_address:"",c.coinTypeD=d[1]?d[1].coin_address:"",c.coinTypeE=d[2]?d[2].coin_address:"";try{let A;if(u.value==="Aptos"){const U=await b.value.getCollectRewarderTransactionPayload(c);A=await N.value.currentWallet.signAndSubmitTransaction(U)}else{c.pos_index=o.value.pos_object_id;const U=await b.value.getCollectRewarderTransactionPayload(c),E=await b.value.signAndExecuteTransactionBlock(N.value.currentWallet,U.txb,U.payloadParams);A=b.value.handleTx(E)}if(A&&A.hash){$(A.hash),ie(!1),te(!0);const U=d[0].amount+d[0].symbol,E=c.coinTypeD?" and "+d[1].amount+d[1].symbol:"",D=c.coinTypeE?" and "+d[2].amount+d[2].symbol:"",X={title:"Claim",desc:"",hash:A.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:m.value.tokensObj&&d[0]&&d[0].address&&m.value.tokensObj[d[0].address]&&m.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:c.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:c.coinTypeD?m.value.tokensObj&&d[1]&&d[1].address&&m.value.tokensObj[d[1].address]&&m.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:c.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:c.coinTypeE?m.value.tokensObj&&d[2]&&d[2].address&&m.value.tokensObj[d[2].address]&&m.value.tokensObj[d[2].address].logoURI:""},text:U+E+D};u.value!=="Aptos"&&(X.res=A.res),b.value.showTransitionPending(X),await b.value.watchTransaction(X)&&setTimeout(()=>{t.emit("getDetails"),b.value.getAccount(N.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),ie(!1),K(!0);x.value=!1}catch(A){console.log("0310###collectRewarderParams Error###",A),x.value=!1,ie(!1),K(!0)}},se=_(()=>m.value.positionDetailCurrentTab),V=_(()=>{var A,U,E,D,X,ee;const d=ke(f.value?(U=o.value)==null?void 0:U.amountB:(A=o.value)==null?void 0:A.amountA,f.value?(ee=(X=o.value)==null?void 0:X.token_b)==null?void 0:ee.decimals:(D=(E=o.value)==null?void 0:E.token_a)==null?void 0:D.decimals),c=f.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(se.value=="increase")return c?new g(d).add(new g(c)).toString():"";if(c){const ue=new g(d).minus(new g(c)).toString();return ue<0?"0":String(ue)}else return""}),be=_(()=>{var A,U,E,D,X,ee;const d=ke(f.value?(U=o.value)==null?void 0:U.amountA:(A=o.value)==null?void 0:A.amountB,f.value?(ee=(X=o.value)==null?void 0:X.token_a)==null?void 0:ee.decimals:(D=(E=o.value)==null?void 0:E.token_b)==null?void 0:D.decimals),c=f.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(se.value=="increase")return c?new g(d).add(new g(c)).toString():"";if(c){const ue=new g(d).minus(new g(c)).toString();return ue<0?"0":String(ue)}else return""}),M=_(()=>f.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),ge=_(()=>f.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),Ie=d=>{var c;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((c=m.value.tokensObj[d==null?void 0:d.address])==null?void 0:c.logo_url)||(h.value.theme==="default"?io("/image/coins/unknown.png"):io("/image/coins/sui-unknown.png"))},Be=_(()=>{var D,X,ee,ue,fe,_e,O,j,ce,pe,C,G;const{fromCoinAmount:d,toCoinAmount:c}=m.value.positionActionAmount,A=m.value.positionDetailCurrentTab,U=ke(f.value?(X=o.value)==null?void 0:X.amountB:(D=o.value)==null?void 0:D.amountA,f.value?(_e=(fe=o.value)==null?void 0:fe.token_b)==null?void 0:_e.decimals:(ue=(ee=o.value)==null?void 0:ee.token_a)==null?void 0:ue.decimals),E=ke(f.value?(j=o.value)==null?void 0:j.amountA:(O=o.value)==null?void 0:O.amountB,f.value?(G=(C=o.value)==null?void 0:C.token_a)==null?void 0:G.decimals:(pe=(ce=o.value)==null?void 0:ce.token_b)==null?void 0:pe.decimals);return u.value=="Sui"||A=="remove"&&u.value=="Aptos"&&d==U&&c==E}),Me=async()=>{oe.value=!0;const d=Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,c=Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;W(i("newAdd.claimWaitingText",{from:f.value?c:d,and:Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?d:c})),ie(!0);let A;const U={pool:o.value.poolInfo,position:o.value};try{const E=await b.value.getCollectFeeTransactionPayload(U);if(u.value==="Aptos")A=await N.value.currentWallet.signAndSubmitTransaction(E);else{const D=await b.value.signAndExecuteTransactionBlock(N.value.currentWallet,E);A=b.value.handleTx(D)}if(A){$(A.hash),ie(!1),te(!0);const D={title:"Claim",desc:"",hash:A.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(D.res=A.res),b.value.showTransitionPending(D);const X=await b.value.watchTransaction(D);console.log("0310##toClaim###transitionStatus####",X),X&&setTimeout(()=>{t.emit("getDetails")},1e3)}else ie(!1),K(!0),a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Co.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});oe.value=!1,console.log("claim####test###",A)}catch(E){console.log("claim###error####",E),oe.value=!1,ie(!1),K(!0),a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Co.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},$e=Ge(nn,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:Y,needReverse:f,decimalUi:ke,pendingFees:q,positionInfo:o,pendingRewarderArr:l,pendingYieldAmount:I,toClaim:Me,claimAll:H,fromCoin:r,toCoin:p,showNum:Se,claimLoading:oe,addCommom:Z,afterBase:V,afterQuote:be,fromCoinAmount:M,toCoinAmount:ge,checkNullObj:ve,getCoinIcon:Ie,chainName:u,isShowAfterAmount:Be,pendingRewarderAmount:v,toClaimRewards:Q,rewarderLoading:x,indicator:$e,canClaimYield:s}}});const di={class:"liquidity-card"},ci={class:"liquidity-title"},mi={class:"liquidity-usd"},vi=n("span",null,"Liquidity",-1),fi={class:"liquidity-ratio"},pi={class:"coin-ratio"},hi={class:"coin-a-ratio"},bi={class:"coin-b-ratio"},gi={class:"ratio-progress"},ki={class:"base-quote-num"},_i={class:"base-coin-num"},wi=n("span",null,"Base",-1),yi={alt:""},Ii={key:0,class:"after"},Ai={class:"quote-coin-num"},Ci=n("span",null,"Quote",-1),$i={alt:""},Si={key:0,class:"after"},Pi={class:"pending-yield"},Ti={class:"left"},Ni={class:"pending-yield-title"},Ri={key:0,class:"after"},Oi={class:"right"},qi={class:"fees-rewards"},Li={class:"fees-rewards-item"},Bi=n("span",null,"Fees",-1),Mi={key:0,class:"after"},Ui=n("span",null,"Fees",-1),ji={key:0,class:"after"},Ei=n("span",null,"Mining Rewards",-1),Di={style:{"margin-top":"5px"}},Fi={alt:""},Wi=n("span",null,"Mining Rewards",-1),Hi={alt:""},Xi={key:0,class:"after"},zi={key:0,class:"pending-yield"},Yi={class:"left"},Gi=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ji={key:0,class:"after"},Qi={class:"right"},Zi={key:1,class:"fees-rewards"},Ki={class:"fees-rewards-item"},Vi=n("span",null,"Mining Rewards",-1),xi={alt:""},es={key:0,class:"after"};function os(e,t,i,a,P,h){var p,u,b,z,oe,ne,Y,f,w,q,s,I,v,k,l,te,K,ie,W,$,B,N,H,x,Q,se,V,be,M,ge,Ie,Be,Me,$e,d,c,A,U,E,D,X,ee,ue,fe,_e,O,j,ce,pe,C,G,L,le,ae,we,Te,Ce,Re,Ee,De,Qe,Oe,je,Fe,We,Ze,Ae;const T=po,m=co,o=tn,r=wo("image");return y(),S("div",di,[n("div",ci,[n("div",mi,[vi,n("div",null,"$"+F(e.amountUSD),1)]),n("div",fi,[n("div",pi,[n("div",hi,[n("span",null,F(e.needReverse?(u=e.toCoin)==null?void 0:u.symbol:(p=e.fromCoin)==null?void 0:p.symbol),1),me(" "+F(e.needReverse?(z=e.positionInfo)==null?void 0:z.toPercent:(b=e.positionInfo)==null?void 0:b.fromPercent)+"% ",1)]),n("div",bi,[n("span",null,F(e.needReverse?(ne=e.fromCoin)==null?void 0:ne.symbol:(oe=e.toCoin)==null?void 0:oe.symbol),1),me(" "+F(e.needReverse?(f=e.positionInfo)==null?void 0:f.fromPercent:(Y=e.positionInfo)==null?void 0:Y.toPercent)+"% ",1)])]),n("div",gi,[n("div",{class:"from-percent",style:$o({width:e.needReverse?((q=e.positionInfo)==null?void 0:q.toPercent)+"%":((w=e.positionInfo)==null?void 0:w.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:$o({width:e.needReverse?((I=e.positionInfo)==null?void 0:I.fromPercent)+"%":((s=e.positionInfo)==null?void 0:s.toPercent)+"%"})},null,4)])])]),n("div",ki,[n("div",_i,[wi,n("div",null,[Pe(n("img",yi,null,512),[[r,(e.needReverse?(k=e.toCoin)==null?void 0:k.logo_url:(v=e.fromCoin)==null?void 0:v.logo_url)||e.getCoinIcon(e.needReverse?(te=e.positionInfo)==null?void 0:te.token_b:(l=e.positionInfo)==null?void 0:l.token_a)]]),re(T,{address:e.needReverse?($=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:$.address:(ie=(K=e.positionInfo)==null?void 0:K.token_a)==null?void 0:ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.needReverse?(N=e.positionInfo)==null?void 0:N.amountB:(B=e.positionInfo)==null?void 0:B.amountA,e.needReverse?(se=(Q=e.positionInfo)==null?void 0:Q.token_b)==null?void 0:se.decimals:(x=(H=e.positionInfo)==null?void 0:H.token_a)==null?void 0:x.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)?(y(),S("div",Ii,F(("addCommom"in e?e.addCommom:J(Z))(e.afterBase))+" after ",1)):de("",!0)]),n("div",Ai,[Ci,n("div",null,[Pe(n("img",$i,null,512),[[r,(e.needReverse?(be=e.fromCoin)==null?void 0:be.logo_url:(V=e.toCoin)==null?void 0:V.logo_url)||e.getCoinIcon(e.needReverse?(ge=e.positionInfo)==null?void 0:ge.token_a:(M=e.positionInfo)==null?void 0:M.token_b)]]),re(T,{address:e.needReverse?($e=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:$e.address:(Be=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:Be.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.needReverse?(c=e.positionInfo)==null?void 0:c.amountA:(d=e.positionInfo)==null?void 0:d.amountB,e.needReverse?(D=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:D.decimals:(U=(A=e.positionInfo)==null?void 0:A.token_b)==null?void 0:U.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)?(y(),S("div",Si,F(("addCommom"in e?e.addCommom:J(Z))(e.afterQuote))+" after ",1)):de("",!0)])]),n("div",Pi,[n("div",Ti,[n("div",Ni,F(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[me(" $"+F(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(y(),S("span",Ri,"$0 after")):de("",!0)])]),n("div",Oi,[re(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.canClaimYield==0,onClick:t[0]||(t[0]=he=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[me("Claim")]),_:1},8,["loading","disabled"])])]),n("div",qi,[n("div",Li,[n("div",null,[Bi,n("div",null,[Pe(n("img",null,null,512),[[r,(e.needReverse?(ee=e.toCoin)==null?void 0:ee.logo_url:(X=e.fromCoin)==null?void 0:X.logo_url)||e.getCoinIcon(e.needReverse?(fe=e.positionInfo)==null?void 0:fe.token_b:(ue=e.positionInfo)==null?void 0:ue.token_a)]]),re(T,{address:e.needReverse?(ce=(j=e.positionInfo)==null?void 0:j.token_b)==null?void 0:ce.address:(O=(_e=e.positionInfo)==null?void 0:_e.token_a)==null?void 0:O.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(L=(G=e.positionInfo)==null?void 0:G.token_b)==null?void 0:L.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(C=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:C.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",Mi," 0 after ")):de("",!0)]),n("div",null,[Ui,n("div",null,[Pe(n("img",null,null,512),[[r,(e.needReverse?(ae=e.fromCoin)==null?void 0:ae.logo_url:(le=e.toCoin)==null?void 0:le.logo_url)||e.getCoinIcon(e.needReverse?(Te=e.positionInfo)==null?void 0:Te.token_a:(we=e.positionInfo)==null?void 0:we.token_b)]]),re(T,{address:e.needReverse?(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.address:(Re=(Ce=e.positionInfo)==null?void 0:Ce.token_b)==null?void 0:Re.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(Fe=(je=e.positionInfo)==null?void 0:je.token_a)==null?void 0:Fe.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(Oe=(Qe=e.positionInfo)==null?void 0:Qe.token_b)==null?void 0:Oe.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",ji," 0 after ")):de("",!0)]),e.chainName=="Sui"?(y(),S(Ve,{key:0},[e.pendingRewarderArr.length==0&&((Ae=(Ze=(We=e.positionInfo)==null?void 0:We.poolInfo)==null?void 0:Ze.rewarderInfo)==null?void 0:Ae.length)>0?(y(!0),S(Ve,{key:0},to(e.positionInfo.poolInfo.rewarderInfo,he=>(y(),S("div",{key:he.coinAddress},[Ei,n("div",Di,[Pe(n("img",Fi,null,512),[[r,e.getCoinIcon({address:he.coinAddress})]]),re(T,{address:he.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),re(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):de("",!0),(y(!0),S(Ve,null,to(e.pendingRewarderArr,he=>(y(),S("div",{key:he},[Wi,n("div",null,[Pe(n("img",Hi,null,512),[[r,he.logo_url]]),re(T,{address:he.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(he.amount>0?("showNum"in e?e.showNum:J(Se))(he.amount,he.decimals):0),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",Xi," 0 after ")):de("",!0)]))),128))],64)):de("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(y(),S("div",zi,[n("div",Yi,[Gi,n("div",null,[me(" $"+F(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(y(),S("span",Ji,"$0 after")):de("",!0)])]),n("div",Qi,[re(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[me("Claim")]),_:1},8,["loading","disabled","onClick"])])])):de("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(y(),S("div",Zi,[n("div",Ki,[(y(!0),S(Ve,null,to(e.pendingRewarderArr,he=>(y(),S("div",{key:he},[Vi,n("div",null,[Pe(n("img",xi,null,512),[[r,he.logo_url]]),re(T,{address:he.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(he.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",es," 0 after ")):de("",!0)]))),128))])])):de("",!0)])}const Yo=Ye(ui,[["render",os]]),ns=ze({components:{AssetsCard:ho},setup(e,t){const i=R(""),a=R(""),P=Xe(),h=_(()=>P),T=_(()=>h.value.theme),m=xe(),o=_(()=>m),r=R(!1),p=R(!1),u=R(!0),b=_(()=>h.value.chainName),z=_(()=>b.value?eo(b.value):{}),oe=mo(),ne=_(()=>oe),Y=_(()=>h.value.slippage),f=R(),w=R(),q=_(()=>ne.value.assets&&f.value&&ne.value.assets[f.value.address]?Ao(ne.value.assets[f.value.address].balance,f.value.decimals):0),s=_(()=>ne.value.assets&&w.value&&ne.value.assets[w.value.address]?Ao(ne.value.assets[w.value.address].balance,w.value.decimals):0),I=c=>{c==="fromCoin"?(u.value=!0,b.value==="Aptos"?i.value=q.value>0?f.value.symbol=="APT"?new g(Number(q.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(q.value)).sub(new g(.1)).toString():String(q.value):"":i.value=q.value>0?f.value.symbol=="SUI"?new g(Number(q.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(q.value)).sub(new g(.05)).toString():String(q.value):""):(u.value=!1,b.value==="Aptos"?a.value=s.value>0?w.value.symbol=="APT"?new g(Number(s.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(s.value)).sub(new g(.1)).toString():String(s.value):"":a.value=s.value>0?w.value.symbol=="SUI"?new g(Number(s.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(s.value)).sub(new g(.05)).toString():String(s.value):"")},v=c=>{c==="fromCoin"?(u.value=!0,i.value=Ue(new g(Number(q.value)).div(2).toString(),f.value.decimals).toString()):(u.value=!1,a.value=Ue(new g(Number(s.value)).div(2).toString(),w.value.decimals).toString())},k=R({}),l=R(!0),te=R({}),K=R(),ie=R(),W=()=>{var j;if(!k.value||!i.value&&!a.value)return;const{TickMath:c,TickUtil:A}=z.value;let U=k.value.minPrice,E=k.value.maxPrice.indexOf("+")>0?"âˆž":k.value.maxPrice,D=Number(k.value.tick_lower_index),X=Number(k.value.tick_upper_index);const ee=Number(k.value.current_tick_index);let ue,fe,_e=Number(U).toString(),O=k.value.maxPrice.indexOf("+")>0||k.value.maxPrice==="âˆž"?"âˆž":Number(E);if(_e=="0"&&O=="âˆž"?(D=Number(k.value.tick_lower_index),X=Number(k.value.tick_upper_index)):(ue=c.priceToSqrtPriceX64(new g(U),f.value.decimals,w.value.decimals),fe=c.priceToSqrtPriceX64(new g(E),f.value.decimals,w.value.decimals)),K.value=D,ie.value=X,E!=="âˆž"&&D>=X){r.value=!0,i.value="",p.value=!0,a.value="";return}if(E=="âˆž"||ee>=D&&ee<X){r.value=!1,p.value=!1;let ce;if(i.value||a.value){if(u.value){const ae=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(ae)}else{const ae=new g(a.value).mul(Math.pow(10,w.value.decimals)).toString();ce=new qe(ae)}const{liquidityAmount:pe,tokenMaxA:C,tokenMaxB:G,tokenMaxAOrigin:L,tokenMaxBOrigin:le}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:w.value,lowerTick:D,upperTick:X,coinAmount:ce,iscoinA:l.value?u.value:!u.value,roundUp:!0,slippage:Number(Y.value)/100,curSqrtPrice:new qe(k.value.current_sqrt_price)});te.value={liquidityAmount:pe,tokenMaxA:C,tokenMaxB:G,tokenMaxAOrigin:L,tokenMaxBOrigin:le},l.value?u.value?a.value=Number(G)>0?G:"":i.value=Number(C)>0?C:"":u.value?a.value=C:i.value=G}}else if(ee>=X){if(i.value="",r.value=!0,p.value=!1,i.value||a.value){let ce;const pe=new g(a.value).mul(Math.pow(10,(j=w.value)==null?void 0:j.decimals)).toString();ce=new qe(pe),te.value={liquidityAmount:Bo(ue,fe,ce),tokenMaxA:0,tokenMaxB:a.value}}}else if(ee<D){if(r.value=!1,p.value=!0,a.value="",i.value||a.value){let ce;const pe=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(pe),te.value={liquidityAmount:Mo(ue,fe,ce),tokenMaxA:i.value,tokenMaxB:0}}}else r.value=!0,i.value="",p.value=!0,a.value="";m.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,c=>{if(c&&!ve(c)){k.value=c,f.value=k.value.token_a,w.value=k.value.token_b;let A=Number(k.value.tick_lower_index),U=Number(k.value.tick_upper_index);const E=Number(k.value.current_tick_index);(c.maxPrice.indexOf("+")>0||c.maxPrice==="âˆž"?"âˆž":c.maxPrice)=="âˆž"||E>=A&&E<U?(r.value=!1,p.value=!1):E>=U?(i.value="",r.value=!0,p.value=!1):E<A?(r.value=!1,p.value=!0,a.value=""):(r.value=!0,i.value="",p.value=!0,a.value=""),W()}},{immediate:!0}),ye(i,(c,A)=>{c&&W(),c==""&&(a.value="")}),ye(a,(c,A)=>{c&&W(),c==""&&(i.value="")});const $=_(()=>{var c,A;return(A=(c=k.value)==null?void 0:c.poolInfo)==null?void 0:A.needReverse}),B=_(()=>o.value.RATES),N=_(()=>{var X,ee,ue,fe;const c=((ee=B.value[(X=f.value)==null?void 0:X.address])==null?void 0:ee.price)||0,A=((fe=B.value[(ue=w.value)==null?void 0:ue.address])==null?void 0:fe.price)||0,U=new g(c).mul(new g(i.value||0)),E=new g(A).mul(new g(a.value||0)),D=U.add(E);return D.toNumber()?D.toNumber()>0&&D.toNumber()>.01?Z(D.toString(),2):"<0.01":"--"}),H=R(!1),{t:x,locale:Q}=yo(),se=_(()=>{const c=Number(i.value)>Number(q.value),A=Number(a.value)>Number(s.value);return!i.value&&!a.value?x("button.enterAmount"):c?x("button.insufficientBalance",{name:f.value.symbol}):A?x("button.insufficientBalance",{name:w.value.symbol}):x("newAdd.addMore")}),V=_(()=>{const c=Number(i.value)>Number(q.value),A=Number(a.value)>Number(s.value);return!!(!i.value&&!a.value||c||A)}),{setIsShowSuccess:be,setIsShowRejected:M,setIsShowWaiting:ge,setTransactionDesc:Ie,setTransactionTxid:Be,setPositiomNum:Me}=P,$e=R(!1);return{theme:T,showFromCoinLock:r,showToCoinLock:p,toCoinAmount:a,fromCoinAmount:i,fromCoinBlance:q,toCoinBlance:s,fromCoin:f,toCoin:w,maxBtnSelect:I,halfBtnSelect:v,fixedFromCoin:u,needReverse:$,totalAmount:N,wallet:ne,addLiquidityBtnText:se,isShowLiquidityModal:H,indexStore:P,positionInfo:k,actionLoading:$e,toAdd:async()=>{var X,ee,ue,fe,_e,O,j,ce,pe,C,G,L;H.value=!1,$e.value=!0,Be("");const c=r.value?"":`${i.value} ${(X=f.value)==null?void 0:X.symbol}`,A=p.value?"":`${a.value} ${(ee=w.value)==null?void 0:ee.symbol}`;Ie(x("tips.increaseLiquiditySuccess",{from:$.value?A:c,and:!r.value&&!p.value?"and":"",to:$.value?c:A})),ge(!0);const U=u.value,E=k.value.poolInfo.rewarder_infos;let D={};D.coinTypeC=E[0]?E[0].coinAddress:"",D.coinTypeD=E[1]?E[1].coinAddress:"",D.coinTypeE=E[2]?E[2].coinAddress:"";try{const le=await z.value.getAddLiquidityTransactionPayload({pool:{poolAddress:k.value.poolAddress,token_a:k.value.token_a,token_b:k.value.token_b},amount:U?te.value.tokenMaxA:te.value.tokenMaxB,fix_amount_a:U,tick_lower:K.value,tick_upper:ie.value,index:b.value==="Aptos"?k.value.index:k.value.pos_object_id,slippage:Number(Y.value)/100,roundUp:!0,collect_fee:!0,...D,curSqrtPrice:new qe(k==null?void 0:k.value.poolInfo.current_sqrt_price),positionInfo:k});let ae;if(b.value==="Aptos")ae=await ne.value.currentWallet.signAndSubmitTransaction(le);else{const we=await z.value.signAndExecuteTransactionBlock(ne.value.currentWallet,le==null?void 0:le.txb,le==null?void 0:le.payloadParams);ae=z.value.handleTx(we)}if(console.log("toAdd###tx###",ae),ae&&ae.hash){Be(ae.hash),ge(!1),be(!0);const we={title:"Supplied",desc:x("tips.addLiquiditySuccessText",{from:r.value?"":`${$.value?a.value:i.value} ${$.value?(fe=w==null?void 0:w.value)==null?void 0:fe.symbol:(ue=f.value)==null?void 0:ue.symbol}`,and:!r.value&&!p.value?"and":"",to:p.value?"":`${$.value?i.value:a.value} ${$.value?(O=f==null?void 0:f.value)==null?void 0:O.symbol:(_e=w.value)==null?void 0:_e.symbol}`}),hash:ae.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:$.value?`${(ce=w.value)==null?void 0:ce.address}`:`${(j=f.value)==null?void 0:j.address}`,numa:$.value?`- ${a.value}`:`- ${i.value}`,logoa:$.value?o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:$.value?`${(C=f.value)==null?void 0:C.address}`:`${(pe=w.value)==null?void 0:pe.address}`,numb:$.value?`- ${i.value}`:`- ${a.value}`,logob:$.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI},text:`Deopsit ${r.value?"":`${i.value} ${(G=f.value)==null?void 0:G.symbol}`} ${!r.value&&!p.value?"and":""} ${p.value?"":`${a.value} ${(L=w.value)==null?void 0:L.symbol}`}`};b.value!=="Aptos"&&(we.res=ae.res),z.value.showTransitionPending(we),await z.value.watchTransaction(we)&&setTimeout(()=>{t.emit("getDetails"),z.value.getAccount(ne.value.address)},1e3),Me()}else ge(!1),M(!0);i.value="",a.value="",$e.value=!1}catch(le){i.value="",a.value="",console.log("addError###",le),$e.value=!1,ge(!1),M(!0)}},addLiquidityBtnDisabled:V,poolStore:m}}});const ts={class:"new-position-asset"},is={class:"add-or-remove"},ss={class:"liquidity-action-tab"},as=n("div",{class:"increase tab-active"}," Increase ",-1),ls={class:"card-item"},rs={class:"card-item"},us={key:0,class:"add",src:gn},ds={key:1,class:"add",src:kn},cs={class:"total-amount"},ms=n("span",null,"Total Amount",-1);function vs(e,t,i,a,P,h){var p;const T=ho,m=hn,o=co,r=bn;return y(),S("div",ts,[n("div",is,[n("div",ss,[as,n("div",{class:"remove",onClick:t[0]||(t[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ls,[re(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=u=>{e.fromCoinAmount=u}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(y(),Ne(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),n("div",rs,[re(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=u=>{e.toCoinAmount=u}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(y(),Ne(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(y(),S("img",us)):de("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(y(),S("img",ds)):de("",!0)],2),n("div",cs,[ms,n("span",null,"$"+F(e.totalAmount),1)])]),e.wallet.connected?(y(),Ne(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=u=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(y(),Ne(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(y(),Ne(r,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):de("",!0)])}const Go=Ye(ns,[["render",vs]]),fs=ze({components:{AssetsCard:ho},setup(e,t){const i=R(""),a=R(""),P=Xe(),h=_(()=>P),T=_(()=>h.value.theme),m=xe(),o=_(()=>m),r=R(!1),p=R(!1),u=R(!0),b=_(()=>h.value.chainName),z=_(()=>b.value?eo(b.value):{}),oe=mo(),ne=_(()=>oe),Y=_(()=>h.value.slippage),f=R(),w=R(),q=_(()=>{var C,G;return(G=(C=l.value)==null?void 0:C.poolInfo)==null?void 0:G.needReverse}),s=_(()=>{var C;return ke(l==null?void 0:l.value.amountA,(C=l==null?void 0:l.value.token_a)==null?void 0:C.decimals)}),I=_(()=>{var C;return ke(l==null?void 0:l.value.amountB,(C=l==null?void 0:l.value.token_b)==null?void 0:C.decimals)}),v=C=>{C==="fromCoin"?u.value=!0:u.value=!1,N.value=100,x({value:1})},k=C=>{C==="fromCoin"?(u.value=!0,i.value=Ue(new g(Number(s.value)).div(2).toString(),f.value.decimals).toString()):(u.value=!1,a.value=Ue(new g(Number(I.value)).div(2).toString(),w.value.decimals).toString()),$.value=!1},l=R({}),te=R(!0),K=R({}),ie=R(),W=R(),$=R(!0),B=()=>{var Qe;if($.value||!l.value||!i.value&&!a.value||Number(i.value)>Number(s.value)||Number(a.value)>Number(I.value))return;if(i.value==s.value&&a.value==I.value){N.value=100,x({value:1}),$.value=!0;return}const{TickMath:C,TickUtil:G}=z.value;let L=l.value.minPrice,le=l.value.maxPrice.indexOf("+")>0?"âˆž":l.value.maxPrice,ae=Number(l.value.tick_lower_index),we=Number(l.value.tick_upper_index);const Te=Number(l.value.current_tick_index);let Ce,Re,Ee=Number(L).toString(),De=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="âˆž"?"âˆž":Number(le);if(Ee=="0"&&De=="âˆž"?(ae=Number(l.value.tick_lower_index),we=Number(l.value.tick_upper_index)):(Ce=C.priceToSqrtPriceX64(new g(L),f.value.decimals,w.value.decimals),Re=C.priceToSqrtPriceX64(new g(le),f.value.decimals,w.value.decimals)),ie.value=ae,W.value=we,le!=="âˆž"&&ae>=we){r.value=!0,i.value="",p.value=!0,a.value="";return}if(le=="âˆž"||Te>=ae&&Te<we){r.value=!1,p.value=!1;let Oe;if(i.value||a.value){if(u.value){const he=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(he)}else{const he=new g(a.value).mul(Math.pow(10,w.value.decimals)).toString();Oe=new qe(he)}const{liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:w.value,lowerTick:ae,upperTick:we,coinAmount:Oe,iscoinA:te.value?u.value:!u.value,roundUp:b.value!="Sui",slippage:Number(Y.value)/100,curSqrtPrice:new qe(l.value.current_sqrt_price)});K.value={liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae},te.value?u.value?a.value=Number(We)>0?We:"":i.value=Number(Fe)>0?Fe:"":u.value?a.value=Fe:i.value=We}}else if(Te>=we){if(i.value="",r.value=!0,p.value=!1,i.value||a.value){let Oe;const je=new g(a.value).mul(Math.pow(10,(Qe=w.value)==null?void 0:Qe.decimals)).toString();Oe=new qe(je),K.value={liquidityAmount:Bo(Ce,Re,Oe),tokenMaxA:0,tokenMaxB:a.value}}}else if(Te<ae){if(r.value=!1,p.value=!0,a.value="",i.value||a.value){let Oe;const je=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(je),K.value={liquidityAmount:Mo(Ce,Re,Oe),tokenMaxA:i.value,tokenMaxB:0}}}else r.value=!0,p.value=!0;$.value=!1,N.value=new g(K.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),H.value=K.value.liquidityAmount,m.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:a})},N=R(50),H=R("0"),x=C=>{if(!$.value)return;$.value=!0;const G=l.value.token_a.decimals,L=l.value.token_b.decimals,le=l.value.tick_lower_index,ae=l.value.tick_upper_index,we=So.tickIndexToSqrtPriceX64(le),Te=So.tickIndexToSqrtPriceX64(ae);let Ce="";C.value!==1?Ce=new g(l.value.liquidity).mul(C.value).toString():Ce=l.value.liquidity,Ce=Ue(Ce,0)||"0",H.value=Ce;const Re=cn.getCoinAmountFromLiquidity(new qe(Ce),new qe(l.value.current_sqrt_price),we,Te,b.value!="Sui"),Ee=new g(Re.coinA.toString()).div(Math.pow(10,G)).toString(),De=new g(Re.coinB.toString()).div(Math.pow(10,L)).toString();i.value=Number(Ee)>0?Ee:"",a.value=Number(De)>0?De:"",m.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,C=>{if(C&&!ve(C)){l.value=C,f.value=l.value.token_a,w.value=l.value.token_b,x({value:N.value/100});let G=Number(l.value.tick_lower_index),L=Number(l.value.tick_upper_index);const le=Number(l.value.current_tick_index);(C.maxPrice.indexOf("+")>0||C.maxPrice==="âˆž"?"âˆž":C.maxPrice)=="âˆž"||le>=G&&le<L?(r.value=!1,p.value=!1):le>=L?(i.value="",r.value=!0,p.value=!1):le<G?(r.value=!1,p.value=!0,a.value=""):(r.value=!0,i.value="",p.value=!0,a.value=""),B()}},{immediate:!0}),ye(i,(C,G)=>{C&&B(),C==""&&(a.value="",N.value=0)}),ye(a,(C,G)=>{C&&B(),C==""&&(i.value="",N.value=0)});const Q=_(()=>o.value.RATES),se=_(()=>{var we,Te,Ce,Re;const C=((Te=Q.value[(we=f.value)==null?void 0:we.address])==null?void 0:Te.price)||0,G=((Re=Q.value[(Ce=w.value)==null?void 0:Ce.address])==null?void 0:Re.price)||0,L=new g(C).mul(new g(i.value||0)),le=new g(G).mul(new g(a.value||0)),ae=L.add(le);return Z(ae.toString(),2)}),V=R(!1),{t:be,locale:M}=yo(),ge=_(()=>{const C=Number(i.value)>Number(s.value),G=Number(a.value)>Number(I.value);return!i.value&&!a.value?be("button.enterAmount"):C||G?"Invalid Amount":be("button.remove")}),Ie=_(()=>{const C=Number(i.value)>Number(s.value),G=Number(a.value)>Number(I.value);return!!(!i.value&&!a.value||C||G)}),{setIsShowSuccess:Be,setIsShowRejected:Me,setIsShowWaiting:$e,setTransactionDesc:d,setTransactionTxid:c,setPositiomNum:A,setTransactionDescText:U}=P,E=R(!1);ye(N,sn((C,G)=>{C!==G&&(Number(C)>100?N.value=100:C&&l.value?(N.value=C,x({value:N.value/100})):(i.value="",a.value=""))},300)),ye(Y,C=>{C&&l.value&&x({value:N.value/100})});const D=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],X=jo(),ee=_(()=>X),ue=_(()=>ee.value.status),fe=R(!1),_e=C=>{C.sources.forEach(L=>{const{pool_address:le,position_index:ae}=JSON.parse(L.blockchainAddress);le==l.value.poolAddress&&Number(ae)==Number(l.value.index)&&(fe.value=!0)})},O=async()=>{await X.getSources();let C;ee.value.allSources.forEach(G=>{const{pool_address:L,position_index:le}=JSON.parse(G.blockchainAddress);L==l.value.poolAddress&&le==l.value.index&&(C=G.id)}),X.deleteSource(C)};ye(()=>[ee.value.sourceGroups,l.value],([C,G])=>{C&&C.sources&&C.sources.length>0&&G&&!ve(G)&&_e(C)},{immediate:!0,deep:!0});const j=lo(),ce=fo();return{theme:T,showFromCoinLock:r,showToCoinLock:p,toCoinAmount:a,fromCoinAmount:i,fromCoinBlance:s,toCoinBlance:I,fromCoin:f,toCoin:w,maxBtnSelect:v,halfBtnSelect:k,fixedFromCoin:u,needReverse:q,totalAmount:se,wallet:ne,addLiquidityBtnText:ge,isShowLiquidityModal:V,indexStore:P,positionInfo:l,actionLoading:E,addLiquidityBtnDisabled:Ie,sliderVal:N,ratioArr:D,setPercent:x,poolStore:m,isSlider:$,toRemove:async()=>{var ae,we,Te,Ce,Re,Ee,De,Qe,Oe,je,Fe,We,Ze;E.value=!0,c("");const C=Z(i.value,f.value.decimals)==0?"":`${ke(i.value,f.value.decimals)} ${f.value.symbol}`,G=Z(a.value,w.value.decimals)==0?"":`${ke(a.value,w.value.decimals)} ${w.value.symbol}`;d(be("tips.removeLiquidiyText",{from:q.value?G:C,and:Z(i.value,f.value.decimals)==0||Z(a.value,w.value.decimals)==0?"":"and",to:q.value?C:G})),$e(!0);const L=l.value.poolInfo.rewarder_infos,le=L&&L.length>0&&b.value=="Sui"||L&&L.length>0&&N.value==100?be("modal.removeLiquidityText1"):be("modal.removeLiquidityText2");U(le);try{let Ae={};Ae={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:N.value==100?new qe(l.value.liquidity):new qe(Ue(H.value,0)),slippage:Number(Y.value),rewards_num:L.length,positionInfo:l.value},Ae.coinTypeC=L[0]?L[0].coinAddress:"",Ae.coinTypeD=L[1]?L[1].coinAddress:"",Ae.coinTypeE=L[2]?L[2].coinAddress:"";const he=await z.value.getRemoveLiquidityTransactionPayload(Ae);let He;if(b.value==="Aptos")He=await ne.value.currentWallet.signAndSubmitTransaction(he);else{const ro=await z.value.signAndExecuteTransactionBlock(ne.value.currentWallet,he.txb,he==null?void 0:he.payloadParams);He=z.value.handleTx(ro),console.log("0331###remove###tx####",He)}if(He&&He.hash){c(He.hash),$e(!1),Be(!0);const ro={title:be("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${i.value} ${(ae=f.value)==null?void 0:ae.symbol} and ${a.value} ${(we=w.value)==null?void 0:we.symbol} 
             from the pool`,sender:ne.value.address,chainName:b.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:q.value?`${(Ce=w.value)==null?void 0:Ce.address}`:`${(Te=f.value)==null?void 0:Te.address}`,numa:q.value?`+ ${a.value}`:`+ ${i.value}`,logoa:q.value?o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:q.value?`${(Re=f.value)==null?void 0:Re.address}`:`${(Ee=w.value)==null?void 0:Ee.address}`,numb:q.value?`+ ${i.value}`:`+ ${a.value}`,logob:q.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI},text:`Withdraw ${i.value} ${(De=f.value)==null?void 0:De.symbol} and ${a.value} ${(Qe=w.value)==null?void 0:Qe.symbol}`};b.value!=="Aptos"&&(ro.res=He.res),z.value.showTransitionPending(ro);const Io=await z.value.watchTransaction(ro);if(L.value&&L.value.length>0&&(Number((Oe=L[0])==null?void 0:Oe.amount)!==0||Ae.coinTypeD&&Number((je=L[1])==null?void 0:je.amount)!==0||Ae.coinTypeE&&Number((Fe=L[2])==null?void 0:Fe.amount)!==0)){const bo={title:be("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:L[0].symbol,numa:`+ ${Number(L[0].amount)}`,logoa:o.value.tokensObj&&L[0]&&L[0].address&&o.value.tokensObj[L[0].address]&&o.value.tokensObj[L[0].address].logoURI,tokenb:Ae.coinTypeD?L[1].symbol:"",numb:Ae.coinTypeD?`+ ${Number(L[1].amount)}`:"",logob:Ae.coinTypeD?o.value.tokensObj&&L[1]&&L[1].address&&o.value.tokensObj[L[1].address]&&o.value.tokensObj[L[1].address].logoURI:"",tokenc:Ae.coinTypeE?L[2].symbol:"",numc:Ae.coinTypeE?`+ ${Number(L[2].amount)}`:"",logoc:Ae.coinTypeE?o.value.tokensObj&&L[2]&&L[2].address&&o.value.tokensObj[L[2].address]&&o.value.tokensObj[L[2].address].logoURI:""},text:`Withdraw ${i.value} ${(We=f.value)==null?void 0:We.symbol} and ${a.value} ${(Ze=w.value)==null?void 0:Ze.symbol}`},Ko=await z.value.setTransations(bo)}if(Se(l.value.feeOwedA,l.value.token_a.decimals)!==0||Se(l.value.feeOwedB,l.value.token_b.decimals)!==0){const bo={title:"Claim",desc:"",hash:He.hash,chainName:b.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Z(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Se(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Z(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Z(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Se(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Z(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},Ko=await z.value.setTransations(bo)}Io&&Number(N.value)==100&&ue.value=="authenticated"&&fe.value&&(await X.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),O()),Io&&(i.value="",a.value="",setTimeout(()=>{Number(N.value)!==100&&t.emit("getDetails")},3e3),setTimeout(()=>{Number(N.value)!==100&&t.emit("getDetails")},6e3),Number(N.value)==100&&ce.name=="new-position-detail"&&(b.value==="Aptos"?j.push("/position"):j.push("/pool/position")),N.value=0)}else $e(!1),Me(!0);E.value=!1}catch(Ae){console.log("Remove error",Ae),E.value=!1,$e(!1),Me(!0)}},sFixD:Ue}}});const ps={class:"new-position-asset"},hs={class:"add-or-remove"},bs={class:"liquidity-action-tab"},gs=n("div",{class:"remove tab-active"},"Remove",-1),ks={class:"card-item"},_s={key:0,class:"assets-card-mask"},ws={class:"card-item"},ys={key:0,class:"assets-card-mask"},Is={class:"remove-ratio"},As=n("div",{class:"remove-ratio-title"},"Amount",-1),Cs={class:"remove-ratio-select"},$s={key:0,class:"ratio"},Ss={key:1,class:"ratio"},Ps={class:"ratio-list"},Ts=["onClick"];function Ns(e,t,i,a,P,h){const T=ho,m=an,o=co;return y(),S("div",ps,[n("div",hs,[n("div",bs,[n("div",{class:"increase",onClick:t[0]||(t[0]=r=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),gs]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ks,[re(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=r=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=r=>{e.fromCoinAmount=r,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(y(),S("div",_s)):de("",!0)]),n("div",ws,[re(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=r=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=r=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=r=>{e.toCoinAmount=r,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(y(),S("div",ys)):de("",!0)])],2),n("div",Is,[As,n("div",Cs,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(y(),S("div",$s,F(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))+"% ",1)):(y(),S("div",Ss," -- ")),n("div",Ps,[(y(!0),S(Ve,null,to(e.ratioArr,(r,p)=>(y(),S("div",{key:p,class:vo(["ratio-item",e.sliderVal==r.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=r.value}},F(r.name),11,Ts))),128))])]),re(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=r=>e.sliderVal=r)},null,8,["value"])])]),e.wallet.connected?(y(),Ne(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(y(),Ne(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=r=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1}))])}const Jo=Ye(fs,[["render",Ns]]),Rs=ze({setup(){const e=xe(),t=_(()=>e),i=Eo(),a=_(()=>i),P=lo(),h=_(()=>t.value.currentPositionInfo),T=R(),m=W=>{var $;return(($=t.value.tokensObj[W])==null?void 0:$.logo_url)||io("/image/coins/sui-unknown.png")},o=en("Sui"),r=R(),p=async W=>{r.value=0;try{const $=await o.calculateFarmingRewards([{pool_id:W.pool_id,position_nft_id:W.id}]),B=[];let N=new g(0);$[W.id].forEach((H,x)=>{var V;const Q=(V=t.value.tokensObj[H.rewarder_type])==null?void 0:V.decimals;let se=new g(H.rewarder_amount).div(Math.pow(10,Q)).toString();Number(se)>0&&b.value.rewarders[x]&&(N=N.add(se),B.push({...H,rewarderAmount:se,rewarderAmountPer:se}))}),r.value=N,T.value=B}catch($){console.log($,"getRewarder")}},u=_(()=>a.value.farmsPoolObj),b=_(()=>u.value[h.value.poolAddress]);ye(()=>[h.value,u.value,b.value],([W,$,B])=>{var N;!ve(W)&&W.positionSource=="farming"&&!ve(B)?p(W):!ve($)&&!ve(W)&&(T.value=(N=$[W.poolAddress])==null?void 0:N.rewarders)},{immediate:!0});const z=mo(),oe=_(()=>z),ne=Xe(),Y=eo("Sui"),{setIsShowSuccess:f,setIsShowRejected:w,setIsShowWaiting:q,setTransactionDesc:s,setTransactionTxid:I}=ne,v=R(!1),k=async()=>{v.value=!0,I(""),s("Claim rewards"),q(!0);const W={pool_id:h.value.pool_id,position_nft_id:h.value.id};try{const $=await o.harvestFarms(W),B=await Y.signAndExecuteTransactionBlock(oe.value.currentWallet,$.txb,$.payloadParams);console.log("0221###sui swap res###",B);let N=Y.handleTx(B);if(N&&N.hash){I(N.hash),q(!1),f(!0);let H={title:"Claim",res:N.res,hash:N.hash};Y.showTransitionPending(H),await Y.watchTransaction(H)&&setTimeout(()=>{p(h.value),Y.getAccount(oe.value.address)},2e3)}else q(!1),w(!0);v.value=!1}catch($){console.log("farmsDeposit error",$),q(!1),w(!0),v.value=!1}},l=async()=>{v.value=!0,I(""),s(`Unstake ${h.value.name}`),q(!0);const W=h.value.pool_id,$=h.value.id;try{const B=await o.farmsWithdraw(W,$),N=await Y.signAndExecuteTransactionBlock(oe.value.currentWallet,B.txb,B.payloadParams);console.log("0221###sui swap res###",N);let H=Y.handleTx(N);if(H&&H.hash){I(H.hash),q(!1),f(!0);let x={res:H.res,title:"Unstake",hash:H.hash};Y.showTransitionPending(x),await Y.watchTransaction(x)&&setTimeout(()=>{P.replace(`/new-position-detail?token=${h.value.tokenName}&address=${h.value.clmm_pool_id}&pos=${h.value.clmm_position_id}`),t.value.setCurrentPositionInfo(h.value.clmm_pool_id,"",h.value.tokenName,"Sui",h.value.clmm_position_id),r.value=0,v.value=!1},2e3)}else q(!1),w(!0)}catch(B){console.log("farmsDeposit error",B),q(!1),w(!0),v.value=!1}},te=async()=>{v.value=!0,I(""),s(`Stake ${h.value.name}`),q(!0);const W={clmm_pool_id:h.value.poolAddress,clmm_position_id:h.value.pos_object_id,coinTypeA:h.value.coin_type_a,coinTypeB:h.value.coin_type_b},$=u.value[h.value.poolAddress].id;try{const B=await o.farmsDeposit(W,$),N=await Y.signAndExecuteTransactionBlock(oe.value.currentWallet,B.txb,B.payloadParams);console.log("0221###sui swap res###",N);let H=Y.handleTx(N);if(H&&H.hash){I(H.hash),q(!1),f(!0);let x={res:H.res,title:"Staked",hash:H.hash};Y.showTransitionPending(x);const Q=await Y.watchTransaction(x,!0);let se;Q!=null&&Q.status&&setTimeout(async()=>{var V,be;(be=(V=Q==null?void 0:Q.res)==null?void 0:V.events)==null||be.forEach(M=>{M.type.indexOf("::pool::DepositEvent")>-1&&(se=M.parsedJson.wrapped_position_id)}),P.replace(`/new-position-detail?position_nft_id=${se}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",se,"farming"),v.value=!1},2e3)}else q(!1),w(!0)}catch(B){console.log("farmsDeposit error",B),q(!1),w(!0),v.value=!1}},K=_(()=>ne),ie=_(()=>K.value.addressLpTokens);return{getCoinIcon:m,rewardList:T,sFixD:Ue,addCommom:Z,claim:k,unStake:l,loading:v,totalRewardAmount:r,currentPositionInfo:h,stake:te,farmsPoolObj:u,addressLpTokens:ie,farmsPoolInfo:b}}});const oo=e=>(so("data-v-0cebeaf3"),e=e(),ao(),e),Os={key:0,class:"farms-position-detail"},qs={class:"farms-top"},Ls=oo(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),Bs={class:"right"},Ms={class:"apr"},Us={class:"apr-tips-box"},js=oo(()=>n("span",null,"View",-1)),Es=oo(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ds=[js,Es],Fs={class:"farms-bottom"},Ws=oo(()=>n("div",{class:"title"},"Farming Rewards",-1)),Hs={key:0,class:"reward-list"},Xs={key:0,class:"rewards-item-bg"},zs={class:"rewards-item-box"},Ys={alt:""},Gs={key:1},Js={class:"rewards-item-bg"},Qs={class:"rewards-item-box"},Zs={alt:""},Ks=oo(()=>n("span",null,"0",-1)),Vs={key:1,class:"reward-list"},xs={key:0,class:"rewards-item-bg"},ea={class:"rewards-item-box"},oa={alt:""},na=oo(()=>n("span",null,"0",-1)),ta={key:1},ia={class:"rewards-item-bg"},sa={class:"rewards-item-box"},aa={alt:""},la=oo(()=>n("span",null,"0",-1)),ra={class:"actions-box"};function ua(e,t,i,a,P,h){var p,u;const T=_n,m=co,o=qo,r=wo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(y(),S("div",Os,[n("div",qs,[Ls,n("div",Bs,[n("div",Ms,[me(" APRÂ  "),n("span",null,[me(F(("addCommom"in e?e.addCommom:J(Z))(e.farmsPoolInfo.total_apr*100,2))+"%Â  ",1),n("div",Us,[re(T,{"l-item":e.farmsPoolInfo,"rewarder-info":(u=(p=e.farmsPoolInfo)==null?void 0:p.rewarder)==null?void 0:u.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=b=>e.$router.push("/farms"))},Ds)])]),n("div",Fs,[Ws,e.rewardList&&e.rewardList.length>0?(y(),S("div",Hs,[(y(!0),S(Ve,null,to(e.rewardList,b=>(y(),S("div",{key:b,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(y(),S("div",Xs,[n("div",zs,[Pe(n("img",Ys,null,512),[[r,e.getCoinIcon(b.rewarder_type)]]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(b.rewarderAmount||0)),1)])])):(y(),S("div",Gs,[n("div",Js,[n("div",Qs,[Pe(n("img",Zs,null,512),[[r,e.getCoinIcon(b.reward_coin)]]),Ks])])]))]))),128))])):(y(),S("div",Vs,[(y(!0),S(Ve,null,to(e.currentPositionInfo.rewards,b=>(y(),S("div",{key:b,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(y(),S("div",xs,[n("div",ea,[Pe(n("img",oa,null,512),[[r,e.getCoinIcon(b.rewarder_type)]]),na])])):(y(),S("div",ta,[n("div",ia,[n("div",sa,[Pe(n("img",aa,null,512),[[r,e.getCoinIcon(b.reward_coin)]]),la])])]))]))),128))])),n("div",ra,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(y(),Ne(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[me("Unstake")]),_:1},8,["loading","onClick"])):de("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(y(),Ne(o,{key:1},{title:Le(()=>[me("Farming rewards are only available for active positions.")]),default:Le(()=>[re(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[me("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(y(),Ne(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[me("Stake")]),_:1},8,["loading","onClick"])):de("",!0),re(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Lo(e.claim,["stop"])},{default:Le(()=>[me("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):de("",!0)}const Qo=Ye(Rs,[["render",ua],["__scopeId","data-v-0cebeaf3"]]),da=ze({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=jo(),i=_(()=>t),a=_(()=>i.value.status),P=Xe(),h=R(!1);ye(()=>a.value,r=>{r=="authenticated",h.value=!1},{immediate:!0});const T=R(!1),m=async()=>{T.value=!T.value;const r={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},p=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(r,p,T.value)}catch{T.value=!T.value}},o=r=>{const p=r.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",p),T.value=p.some(u=>JSON.parse(u.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(u.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return lo(),ye(()=>[i.value.sourceGroups,e.positionInfo],([r,p])=>{T.value=!1,r&&r.length>0&&r[0]&&p&&!ve(p)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),o(r[0]))},{immediate:!0,deep:!0}),{importIcon:io,isShowSetUp:h,changeSwitch:m,checked:T,notifiStatus:a,store:P}}});const ca=e=>(so("data-v-1a37a36d"),e=e(),ao(),e),ma={class:"range-alerts"},va={class:"range-alerts-top"},fa={class:"title"},pa=ca(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ha={key:1,class:"h5-switch-box"},ba={class:"range-alerts-bottom"},ga={key:0,class:"pc-switch-box"};function ka(e,t,i,a,P,h){const T=co,m=ln;return y(),S("div",ma,[n("div",va,[n("div",fa,[pa,e.isShowSetUp||e.notifiStatus!=="authenticated"?(y(),Ne(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Lo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[me(" Set up ")]),_:1})):de("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(y(),S("div",ha,[re(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])]),n("div",ba,[me(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(y(),S("div",ga,[re(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])])}const Zo=Ye(da,[["render",ka],["__scopeId","data-v-1a37a36d"]]),_a=ze({components:{NewPositionTitle:Ho,NewPositionInfo:zo,NewPositionLiquidity:Yo,NewPositionAssetAdd:Go,NewPositionAssetRemove:Jo,NewPositionNotifi:Zo,FarmsPositionDetail:Qo},setup(){const e=R(),t=R(),i=R(),a=Xe(),P=_(()=>a),h=_(()=>P.value.chainName),T=xe(),m=_(()=>T),o=Eo(),r=_(()=>o),p=lo();Ro(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0)});const u=async()=>{m.value.setCurrentPositionLoading(!0);const s=p.currentRoute.value.query.token||"",I=p.currentRoute.value.query.collect||"",v=p.currentRoute.value.query.address||"",k=p.currentRoute.value.query.pos||"",l=p.currentRoute.value.query.id||"",te=p.currentRoute.value.query.positionSource||"",K=p.currentRoute.value.query.position_nft_id||"";h.value==="Aptos"?s&&I&&v&&m.value.setCurrentPositionInfo(v,I,s,h.value):s&&v&&k?m.value.setCurrentPositionInfo(v,I,s,h.value,k):l&&!te?m.value.setCurrentPositionInfo("","","",h.value,l):m.value.setCurrentPositionInfo("","","",h.value,K,te)};ye(()=>m.value.poolConfigObj,s=>{s&&!ve(s)&&u()},{immediate:!0});const b=_(()=>m.value.currentPositionLoading),z=_(()=>{var I,v,k;const s=((k=(v=(I=p==null?void 0:p.currentRoute)==null?void 0:I.value)==null?void 0:v.query)==null?void 0:k.address)||"";return s&&m.value.addressLpTokens&&!ve(m.value.addressLpTokens)&&m.value.addressLpTokens[s]?m.value.addressLpTokens[s]:null});ye(()=>z.value,(s,I)=>{s&&!ve(s)&&(e.value=s),s&&!ve(s)&&s.current_sqrt_price!==(I==null?void 0:I.current_sqrt_price)&&u()},{immediate:!0});const oe=fo();ye(()=>[m.value.currentPositionInfo,h.value],([s,I])=>{var v;(I=="Aptos"&&s||I=="Sui"&&s&&(s==null?void 0:s.nftHash)==((v=oe==null?void 0:oe.query)==null?void 0:v.pos))&&(e.value=s,t.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const ne=_(()=>m.value.positionDetailCurrentTab),Y=mo(),f=_(()=>Y);_(()=>P.value.theme);const w=_(()=>h.value?eo(h.value):{}),q=()=>{u(),f.value.address&&w.value.getAccount(f.value.address)};return ye(()=>e.value,s=>{var I,v,k,l;((s==null?void 0:s.positionSource)==="farming"||(I=s==null?void 0:s.poolInfo)!=null&&I.stable_farming)&&!((k=(v=r==null?void 0:r.value)==null?void 0:v.farmsPoolObj)!=null&&k[s==null?void 0:s.poolAddress])&&!((l=r==null?void 0:r.value)!=null&&l.farmsPoolListLoading)&&r.value.getFarmsPoolList(!1)},{deep:!0}),No(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:i,getDetails:u,currentPositionLoading:b,positionDetailCurrentTab:ne,clickRefresh:q,chainName:h}}});const wa={class:"new-position-detail"},ya={class:"new-position-content"},Ia={class:"left"},Aa={class:"right"},Ca={class:"loading-global"};function $a(e,t,i,a,P,h){const T=Ho,m=zo,o=Yo,r=Go,p=Jo,u=Qo,b=Zo,z=rn;return y(),S("div",wa,[re(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",ya,[n("div",Ia,[re(m),re(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",Aa,[e.positionDetailCurrentTab=="increase"?(y(),Ne(r,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(y(),Ne(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),re(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(y(),Ne(u,{key:2})):de("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(y(),Ne(b,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):de("",!0)])]),Pe(n("div",Ca,[re(z)],512),[[Oo,e.currentPositionLoading]])])}const tl=Ye(_a,[["render",$a],["__scopeId","data-v-4f69962b"]]);export{tl as default};
