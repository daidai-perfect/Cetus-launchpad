import{_ as No}from"./new-position-title.6495fd9f.js";import{_ as ao}from"./token-warning.b3e223d4.js";import{_ as Ro}from"./status-block.46294668.js";import{j as Go,n as zo,d as pe,e as oo,u as no,a as J,g as fo,c as he,s as Ue,m as Pe,b as Oe,p as Co,G as Oo,H as qo,T as Io,C as Yo}from"./pool.3ec98b50.js";import{s as xe,m as Qo,l as Jo,b as Zo,a as Ko}from"./transform.c672907f.js";import{D as b}from"./decimal.0bdeb344.js";import{u as Qe,a as so}from"./sha256.2d8fb4e4.js";import{a as Je,r as L,l as A,H as Bo,q as Ae,e as Ze,o as $,f as M,t as qe,N as Lo,h as a,p as yo,k as Ao,m as lo,s as Mo,i as de,u as Q,v as E,j as _e,x as fe,y as _o,a4 as Vo,b as uo,C as Xe,a8 as So,O as $o,w as Ye,F as po,E as ho,B as ro,A as go,c as je,D as xo,G as en,z as on,a1 as nn,Q as tn,S as an}from"./entry.1f9cb38c.js";import{i as eo}from"./import-icon.de3e6c66.js";import{_ as co}from"./assets-card.1e577cbb.js";import{_ as sn}from"./coin-lock.90d9da2a.js";import{a as ln}from"./new-add-or-create.fc18ae23.js";import{_ as un,a as rn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Uo}from"./notifi.42d11fdc.js";/* empty css              *//* empty css              */import"./back.0be18584.js";import"./swap-setting.ad19be9d.js";/* empty css              */import"./icon-error_2x.daf09642.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.55a21c70.js";import"./useWhale.da14bf82.js";import"./index.e9b9a23e.js";const bo=Math.PI,ko=2*bo,ze=1e-6,dn=ko-ze;function jo(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function cn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return jo;const i=10**t;return function(s){this._+=s[0];for(let R=1,S=s.length;R<S;++R)this._+=Math.round(arguments[R]*i)/i+s[R]}}class vn{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?jo:cn(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,s,R){this._append`Q${+t},${+i},${this._x1=+s},${this._y1=+R}`}bezierCurveTo(t,i,s,R,S,O){this._append`C${+t},${+i},${+s},${+R},${this._x1=+S},${this._y1=+O}`}arcTo(t,i,s,R,S){if(t=+t,i=+i,s=+s,R=+R,S=+S,S<0)throw new Error(`negative radius: ${S}`);let O=this._x1,v=this._y1,o=s-t,d=R-i,p=O-t,u=v-i,g=p*p+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(g>ze)if(!(Math.abs(u*o-d*p)>ze)||!S)this._append`L${this._x1=t},${this._y1=i}`;else{let z=s-O,ne=R-v,ee=o*o+d*d,ce=z*z+ne*ne,m=Math.sqrt(ee),c=Math.sqrt(g),q=S*Math.tan((bo-Math.acos((ee+g-ce)/(2*m*c)))/2),n=q/c,h=q/m;Math.abs(n-1)>ze&&this._append`L${t+n*p},${i+n*u}`,this._append`A${S},${S},0,0,${+(u*z>p*ne)},${this._x1=t+h*o},${this._y1=i+h*d}`}}arc(t,i,s,R,S,O){if(t=+t,i=+i,s=+s,O=!!O,s<0)throw new Error(`negative radius: ${s}`);let v=s*Math.cos(R),o=s*Math.sin(R),d=t+v,p=i+o,u=1^O,g=O?R-S:S-R;this._x1===null?this._append`M${d},${p}`:(Math.abs(this._x1-d)>ze||Math.abs(this._y1-p)>ze)&&this._append`L${d},${p}`,s&&(g<0&&(g=g%ko+ko),g>dn?this._append`A${s},${s},0,1,${u},${t-v},${i-o}A${s},${s},0,1,${u},${this._x1=d},${this._y1=p}`:g>ze&&this._append`A${s},${s},0,${+(g>=bo)},${u},${this._x1=t+s*Math.cos(S)},${this._y1=i+s*Math.sin(S)}`)}rect(t,i,s,R){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${s=+s}v${+R}h${-s}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function mn(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);t=s}return e},()=>new vn(t)}function fn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Eo(e){this._context=e}Eo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function pn(e){return new Eo(e)}function hn(e){return e[0]}function gn(e){return e[1]}function bn(e,t){var i=Ke(!0),s=null,R=pn,S=null,O=mn(v);e=typeof e=="function"?e:e===void 0?hn:Ke(e),t=typeof t=="function"?t:t===void 0?gn:Ke(t);function v(o){var d,p=(o=fn(o)).length,u,g=!1,z;for(s==null&&(S=R(z=O())),d=0;d<=p;++d)!(d<p&&i(u=o[d],d,o))===g&&((g=!g)?S.lineStart():S.lineEnd()),g&&S.point(+e(u,d,o),+t(u,d,o));if(z)return S=null,z+""||null}return v.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),v):e},v.y=function(o){return arguments.length?(t=typeof o=="function"?o:Ke(+o),v):t},v.defined=function(o){return arguments.length?(i=typeof o=="function"?o:Ke(!!o),v):i},v.curve=function(o){return arguments.length?(R=o,s!=null&&(S=R(s)),v):R},v.context=function(o){return arguments.length?(o==null?s=S=null:S=R(s=o),v):s},v}function To(){}function Do(e){this._context=e}Do.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function kn(e){return new Do(e)}function Po(e,t,i){const s=new b(10).pow(t-i);return new b(1.0001).pow(e).mul(s)}const wn=Je({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const i=L(1),s=L(""),R=L(""),S=A(()=>{var n,h,_;return u.sqrtPriceX64ToPrice((n=e.poolInfo)==null?void 0:n.current_sqrt_price,(h=e.poolInfo)==null?void 0:h.coinA.decimals,(_=e.poolInfo)==null?void 0:_.coinB.decimals).toString()}),O=A(()=>{let n=0;return e.direction?n=(Number(e.minPrice)/Number(S.value)-1)*100:n=(Number(e.minPrice)/Number(1/Number(S.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),v=A(()=>{let n=0;return e.direction?n=(Number(e.maxPrice)/Number(S.value)-1)*100:n=(Number(e.maxPrice)/Number(1/Number(S.value))-1)*100,n=n>0&&n<.1?.1:n,n=n<0&&n>-.1?-.1:n,n}),o=Qe(),d=A(()=>o),p=A(()=>d.value.chainName?oo(d.value.chainName):{}),{TickMath:u,getNearestTickByTick:g}=p.value,z=()=>{const n=i.value/2;i.value=n,ce(e.poolInfo,n)},ne=()=>{const n=i.value*2;i.value=n,ce(e.poolInfo,n)},ee=(n=[])=>{let h=6;const _=Math.abs(Number(n[0])-Number(n[n.length-1]));return _>=6?h=0:_>=1?h=1:_>=.1?h=2:_>=.01?h=3:_>=.001?h=4:_>=1e-4?h=5:_>=1e-5?h=6:_>=1e-6?h=7:_>=1e-7&&(h=8),h},ce=(n,h=1)=>{if(n&&n.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const _=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",_),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let y=_+100*h,l=_-100*h,V,G;if(e.maxPrice==="∞")G=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?G=u.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):G=u.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{G=443636}if(e.minPrice==="0")V=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=u.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=u.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=-443636}let ue=0;if(e.currentPriceTab!=="full range"){if(_>=V&&_<=G){const U=_-V,me=G-_;ue=Math.max(Math.abs(U),Math.abs(me))}else _<V?ue=Math.abs(G-_):ue=Math.abs(_-V);y=_+ue+100*h,l=_-ue-100*h,console.log(h,_,"===>zooms")}else{const U=(Math.abs(_)>5e3,2e4);y=_+U*h,l=_-U*h}l<-443636&&(l=-443636),y>443636&&(y=443636),console.log(l,y,"===>201");const x=new b(n.liquidity).div(Math.pow(10,8)).toString();console.log(x,"==>currentLiquity");const B=e.tickList;console.log("0117####drawChart####tick_info_array####",B);const W=[],Y=[];let oe={};for(let U=0;U<B.length;U++){if(oe=B[U],oe.index<=_&&oe.index>=l){if(W.length<1&&U!==0){const me=B[U-1];W.unshift({...me,index:l})}W.unshift(oe)}else if(oe.index>_&&oe.index<=y&&(Y.push(oe),W.length<1&&U!==0)){const me=B[U-1];W.push({...me,index:l})}if(oe.index>y){const me=B[U];if(Y.push({...me,index:y}),W.length<1&&U!==0){const we=B[U-1];W.push({...we,index:l})}break}}console.log(_,l,y,"===>currentTick");let le="0";for(let U=W.length-1;U>=0;U--)le=new b(le).plus(new b(W[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),W[U].liquityAmount=le;let K=x;for(let U=0;U<Y.length;U++)K=new b(K).plus(new b(Y[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),Y[U].liquityAmount=K;console.log(W.length,Y.length,"leftArray");let ie=[];const Z=B&&B.length>0?{index:_,liquityAmount:Number(x)}:{index:_,liquityAmount:0};(W.length>0||Y.length>0)&&(console.log([Z,...Y],"279===>"),ie=[...W.reverse(),Z,...Y],e.direction||(ie=ie.reverse()));const ge=[];B.forEach(U=>{ge.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",ge),console.log("0117####drawChart####currentLiquity####",x),console.log(ie,"===>chartData"),c(ie,l,y,V,G,_)}};let m=L(!1);Bo(()=>{document.body.clientWidth<750?m.value=!1:m.value=!0,window.onresize=()=>{document.body.clientWidth<750?m.value=!1:m.value=!0,ce(e.poolInfo,i.value)}});const c=(n,h,_,y,l,V)=>{console.log("0117####drawChart####chartData####",n),console.log("0117####drawChart####tickMin####",h),console.log("0117####drawChart####tickMax####",_),console.log("0117####drawChart####minPriceTick####",y),console.log("0117####drawChart####maxPriceTick####",l),console.log("0117####drawChart####currentTick####",V),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let G,ue;e.direction?(G=e.before7dContractPriceLowest?u.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?u.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(G=e.before7dContractPriceLowest?u.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ue=e.before7dContractPriceHighest?u.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const x={top:30,right:35,bottom:20,left:55};let B,W;m.value,B=340-x.left-x.right,W=205-x.top-x.bottom;const Y=_-h,oe=parseInt(String(Y/4));let le=[h+oe/4,h+oe,h+2*oe,_-oe,_-oe/4];const K=h,ie=_,Z=B/(ie-K);e.currentPriceTab==="full range"&&(le=[h,h+2*oe,_]),console.log("0117####drawChart####xArr####",le),console.log("0117####drawChart####utickMin####",K),console.log("0117####drawChart####utickMax####",ie),console.log("0117####drawChart####unit####",Z);const ge=le.map(T=>e.direction?Po(T,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(Po(T,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ee(ge),xe("#chart").selectAll("*").remove();const U=xe("#chart").attr("width",B+x.left+x.right).attr("height",W+x.top+x.bottom).append("g").attr("transform",`translate(${x.left},${x.right})`),me=Qo(n,function(T){return Number(Math.abs(T.liquityAmount))})||0,we=Jo().range([0,W]).domain([me,0]);Zo().rangeRound([0,B]).padding(.1);const r=U.append("g").attr("id","barsBox").selectAll("rect").data(n).enter().append("rect");d.value.theme=="default"?r.attr("x",function(T,N){return N===0?0:e.direction?Math.abs(T.index-K)*Z:Math.abs(ie-T.index)*Z}).attr("y",function(T,N){return e.direction?N===n.length-1?0:we(T.liquityAmount):N===n.length-1?0:we(n[N+1].liquityAmount)}).attr("width",function(T,N){return N===0&&n.length===1&&T.liquityAmount>0?B:(e.direction,N!==n.length-1?Math.abs(n[N+1].index-T.index)*Z:0)}).attr("height",function(T,N){return N===0&&n.length===1&&T.liquityAmount>0?W:e.direction?N===n.length-1?0:W-we(T.liquityAmount):N===n.length-1?0:W-we(n[N+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):r.attr("x",function(T,N){return N===0?0:e.direction?Math.abs(T.index-K)*Z:Math.abs(ie-T.index)*Z}).attr("y",function(T,N){return e.direction?N===n.length-1?0:we(Math.abs(T.liquityAmount)):N===n.length-1?0:we(Math.abs(n[N+1].liquityAmount))}).attr("width",function(T,N){return N===0&&n.length===1&&T.liquityAmount>0?B:(e.direction,N!==n.length-1?Math.abs(n[N+1].index-T.index)*Z:0)}).attr("height",function(T,N){if(N===0&&n.length===1&&T.liquityAmount>0)return W;if(e.direction)return N===n.length-1?0:Number(T.liquityAmount)?W-we(Math.abs(T.liquityAmount)):0;{if(N===n.length-1)return 0;const se=W-we(Math.abs(n[N+1].liquityAmount));return Number(n[N+1].liquityAmount)?se:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const f=U.append("g");f.append("line").attr("x1",0).attr("y1",155).attr("x2",B).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),f.append("g");let C=0;e.direction?C=Math.abs(V-K)*Z:C=Math.abs(V-ie)*Z,console.log(d.value.theme=="default","leftHandle#"),(d.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+C+", 0)"),xe("#triangle").attr("width",8).attr("height",4);let j=[[0,0],[4,4],[8,0]],D=bn().x(function(T){return T[0]}).y(function(T){return T[1]}).curve(kn);const P=C-4;U.append("path").attr("d",D(j)).style("fill",d.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+P+", 0)");let F,H,ae,re;e.direction?(console.log("0525###d3###select###minPriceTick###",y),console.log("0525###d3###select###maxPriceTick###",l),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),F=y<K?-100:parseInt(String(Math.abs(y-K)*Z)),H=l<K?-100:parseInt(String(Math.abs(l-K)*Z)),ae=G<K?-100:Math.abs(G-K)*Z,re=ue<K?-100:Math.abs(ue-K)*Z):(H=y<K?-100:Math.abs(ie-y)*Z,F=l<K?-100:Math.abs(ie-l)*Z,re=G<K?-100:Math.abs(ie-G)*Z,ae=ue<K?-100:Math.abs(ie-ue)*Z),e.minPrice==="0"&&(F=0),e.maxPrice==="∞"&&(H=B),m.value?s.value=B-F+60+"px":s.value=B-F+52+"px",R.value=H+74+"px",console.log(F,H,"##minPriceTickX"),G&&ae<B&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ae+", 0)"),ue&&re<B&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+re+", 0)");const be=Ko().extent([[0,0],[B,W]]).handleSize(30).on("end",ye);U.append("g").attr("class","brush").call(be).call(be.move,[F,H]);function ye(T){if(!T.sourceEvent||!T.selection)return;m.value?s.value=B-T.selection[0]+60+"px":s.value=B-T.selection[0]+52+"px",R.value=T.selection[1]+74+"px";let N,se;console.log("0525###d3###select###e.selection[0]###",T.selection[0]),console.log("0525###d3###select###e.selection[0]###",T.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",B),console.log("0525###d3###select###unit###",Z),console.log("0525###d3###select###utickMin###",K),console.log("0525###d3###select###utickMax###",ie),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ke=0,k=0;e.direction?(ke=g(parseInt(String(T.selection[0]/Z+K)),Number(e.poolInfo.tickSpacing)),N=u.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),k=g(parseInt(String(T.selection[1]/Z+K)),Number(e.poolInfo.tickSpacing)),se=u.tickIndexToPrice(k,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ke),console.log("0525###d3###select###maxTick###",k),console.log("0525###d3###select###minPrice###",N),console.log("0525###d3###select###maxPrice###",se)):(k=g(ie-T.selection[0]/Z,Number(e.poolInfo.tickSpacing)),N=1/u.tickIndexToPrice(k,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ke=g(ie-T.selection[1]/Z,Number(e.poolInfo.tickSpacing)),se=1/u.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(pe(String(N),6))),t.emit("onChangeMaxPrice",String(pe(String(se),6)))}d.value.theme=="default"?xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};L(""),Ae(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([n,h,_,y])=>{console.log(n,h,_,_>h,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),n&&h&&_&&ce(n,i.value)},{immediate:!0});const q=L(!0);return Ae(()=>e.chartLoading,(n,h)=>{n!==h&&(q.value=n)},{immediate:!0,deep:!0}),{store:d,loading:q,zoomOut:z,zoomIn:ne,rangeSizeLower:O,rangeSizeUpper:v,rangeSizeLowerPosition:s,rangeSizeUpperPosition:R,decimalFormat:Go,numberformat:zo}}});const yn=e=>(yo("data-v-59ae7c8b"),e=e(),Ao(),e),An={class:"chart-box"},_n={class:"chart"},Cn=yn(()=>a("svg",{id:"chart"},null,-1)),In=[Cn];function Sn(e,t,i,s,R,S){return $(),M("div",An,[qe(a("div",_n,In,512),[[Lo,!e.loading]])])}const Fo=Ze(wn,[["render",Sn],["__scopeId","data-v-59ae7c8b"]]),$n=Je({components:{StatusBlock:Ro,NewPositionChart:Fo,TokenWarning:ao},setup(e){const t=L(),i=L(),s=A(()=>{var n,h;return(h=(n=u.value)==null?void 0:n.poolInfo)==null?void 0:h.needReverse}),R=Qe(),S=A(()=>R),O=A(()=>S.value.currentExplorer),v=A(()=>S.value.theme),o=A(()=>S.value.chainName),d=no(),p=A(()=>d),u=L({}),g=lo();Ae(()=>[p.value.currentPositionInfo,o.value],([n,h])=>{var _;h=="Aptos"&&n?(u.value=n,t.value=u.value.token_a,i.value=u.value.token_b):h=="Sui"&&n&&(n==null?void 0:n.nftHash)==((_=g==null?void 0:g.query)==null?void 0:_.pos)&&(console.log(n,"==>newVal"),u.value=n,t.value=u.value.token_a,i.value=u.value.token_b,console.log(t.value,i.value,"###fromCoin.value"))},{immediate:!0});const z=n=>{var h;return(n==null?void 0:n.logoURI)||(n==null?void 0:n.logo_url)||((h=p.value.tokensObj[n==null?void 0:n.address])==null?void 0:h.logo_url)||(v.value==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},ne=A(()=>o.value?oo(o.value):{}),ee=L([]),ce=async n=>{console.log(n,"===>positionInfo.value.poolInfo");const h=await ne.value.getTicks(n),_=h?ne.value.getTickDataFromUrlData(h):[];console.log(_,"list===>"),ee.value=_};Ae(()=>[u.value,p.value.poolsObj],([n,h])=>{console.log(n,!he(n),"177111"),n&&!he(n)&&n.poolInfo&&h&&!he(h)&&(console.log(n,h,"==>poolConfigObj"),ce(h[n.poolAddress]))},{immediate:!0});const m=L(!0);console.log(u.value,"188---------->");const c=(n,h)=>n!=="0"&&h!=="∞"?Ue(1/(1-Number((n/h)**.25)),2)+"x":"1x",q=A(()=>u.value.minPrice&&u.value.maxPrice?c(u.value.minPrice,u.value.maxPrice):"--");return{needReverse:s,getCoinIcon:z,theme:v,indexStore:R,direct:m,addCommom:J,decimalUi:pe,tickList:ee,positionInfo:u,fromCoin:t,toCoin:i,getExplorerUrl:fo,lever:q,currentExplorer:O}}}),Tn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Pn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Nn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Rn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Fe=e=>(yo("data-v-742e1150"),e=e(),Ao(),e),On={class:"new-position-info"},qn={class:"pool-info"},Bn={class:"left"},Ln={class:"coin-a"},Mn={alt:""},Un={class:"coin-b"},jn={alt:""},En={class:"position-name"},Dn=["href"],Fn=Fe(()=>a("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Wn=[Fn],Hn={key:0,class:"pool-fee"},Xn=Fe(()=>a("span",null,"Fee tier",-1)),Gn={class:"right"},zn={class:"h5-pool-info"},Yn={class:"coin-info"},Qn={class:"coin-a"},Jn={alt:""},Zn={class:"coin-b"},Kn={alt:""},Vn={class:"position-name"},xn=["href"],et=Fe(()=>a("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),ot=[et],nt={key:0,class:"pool-fee"},tt={class:"price-info"},it={class:"price-and-chart"},at={class:"left"},st={class:"current-price"},lt=Fe(()=>a("span",null,"Current Price",-1)),ut={class:"coin-rate"},rt=Fe(()=>a("div",null,[a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),dt=Fe(()=>a("div",null,[a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),ct=[rt,dt],vt={key:0},mt={key:1},ft={key:0,class:"position-range"},pt=Fe(()=>a("div",{class:"position-range-title"}," Position Range ",-1)),ht={key:0},gt={key:1},bt={key:2,src:Tn,alt:""},kt={key:3,src:Pn,alt:""},wt={key:4},yt={key:5},At={key:1,class:"position-range position-range-warp"},_t={key:0,class:"position-range-title"},Ct={key:1,class:"position-range-title"},It={key:2},St={key:3},$t={class:"price-img"},Tt={key:0,src:Nn,alt:""},Pt={key:1,src:Rn,alt:""},Nt={key:4},Rt={key:5},Ot={class:"lever"},qt=Fe(()=>a("div",{class:"lever-title"},"Leverage",-1)),Bt={class:"lever-text"},Lt={class:"right"},Mt=Fe(()=>a("div",{class:"chat-mask"},null,-1));function Ut(e,t,i,s,R,S){var p,u,g,z,ne,ee,ce,m,c,q,n,h,_,y,l,V,G,ue,x,B,W,Y,oe,le,K,ie,Z,ge,U,me;const O=ao,v=Ro,o=Fo,d=Mo("image");return $(),M("div",On,[a("div",qn,[a("div",Bn,[a("div",Ln,[qe(a("img",Mn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(O,{address:e.needReverse?(z=(g=e.positionInfo)==null?void 0:g.token_b)==null?void 0:z.address:(u=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:u.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",Un,[qe(a("img",jn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(O,{address:e.needReverse?(m=(ce=e.positionInfo)==null?void 0:ce.token_a)==null?void 0:m.address:(ee=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:ee.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",En,[a("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Q(fo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},E((q=(c=e.positionInfo)==null?void 0:c.name)==null?void 0:q.split("|")[1]),9,Dn)]),($(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=we=>e.indexStore.copy(e.positionInfo.nftHash))},Wn)),e.positionInfo.fee?($(),M("div",Hn,[Xn,_e(" "+E(e.positionInfo.fee*100)+"% ",1)])):fe("",!0)]),a("div",Gn,[de(v,{"current-status":(n=e.positionInfo)==null?void 0:n.currentStatus},null,8,["current-status"])])]),a("div",zn,[a("div",null,[a("div",Yn,[a("div",Qn,[qe(a("img",Jn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(O,{address:e.needReverse?(l=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:l.address:(_=(h=e.positionInfo)==null?void 0:h.token_a)==null?void 0:_.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",Zn,[qe(a("img",Kn,null,512),[[d,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(O,{address:e.needReverse?(x=(ue=e.positionInfo)==null?void 0:ue.token_a)==null?void 0:x.address:(G=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),a("div",Vn,[a("div",null,[a("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:Q(fo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},E((W=(B=e.positionInfo)==null?void 0:B.name)==null?void 0:W.split("|")[1]),9,xn),($(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=we=>e.indexStore.copy(e.positionInfo.nftHash))},ot))]),e.positionInfo.fee?($(),M("div",nt,E(e.positionInfo.fee*100)+"%",1)):fe("",!0)])]),de(v,{"current-status":(Y=e.positionInfo)==null?void 0:Y.currentStatus},null,8,["current-status"])]),a("div",tt,[a("div",it,[a("div",at,[a("div",st,[a("div",null,[lt,a("div",ut,[a("div",{onClick:t[2]||(t[2]=we=>e.direct=!e.direct)},ct)])]),(e.needReverse?!e.direct:e.direct)?($(),M("div",vt,[_e(E(("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.positionInfo.currentPrice,6)))+"   ",1),a("span",null,E((oe=e.toCoin)==null?void 0:oe.symbol)+" per "+E((le=e.fromCoin)==null?void 0:le.symbol),1)])):($(),M("div",mt,[_e(E(("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.positionInfo.currentPriceReverse,6)))+"   ",1),a("span",null,E((K=e.fromCoin)==null?void 0:K.symbol)+" per "+E((ie=e.toCoin)==null?void 0:ie.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?($(),M("div",ft,[pt,a("div",null,[(e.needReverse?!e.direct:e.direct)?($(),M("div",ht,[_e(E(("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.positionInfo.minPrice,6)))+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",gt,[_e(E(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?($(),M("img",bt)):($(),M("img",kt)),(e.needReverse?!e.direct:e.direct)?($(),M("div",wt,[_e(E(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",yt,[_e(E(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):($(),M("div",At,[(e.needReverse?!e.direct:e.direct)?($(),M("span",_t," Position Range ")):($(),M("span",Ct," Position Range ")),(e.needReverse?!e.direct:e.direct)?($(),M("div",It,[_e(E(("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.positionInfo.minPrice,6)))+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",St,[_e(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),a("div",$t,[e.theme=="default"?($(),M("img",Tt)):($(),M("img",Pt))]),(e.needReverse?!e.direct:e.direct)?($(),M("div",Nt,[_e(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",Rt,[_e(E(((me=e.positionInfo)==null?void 0:me.minPrice)!=="0"?("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),_e("   ")]))])),a("div",Ot,[qt,a("div",Bt,E(e.lever),1)])]),a("div",Lt,[de(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Mt])])])])}const Wo=Ze($n,[["render",Ut],["__scopeId","data-v-742e1150"]]),jt=Je({components:{TokenWarning:ao},setup(e,t){const{t:i}=_o(),{$notify:s}=Vo(),R=Qe(),S=A(()=>R),O=no(),v=A(()=>O),o=L({}),d=L({}),p=L({}),u=A(()=>S.value.chainName),g=A(()=>u.value?oo(u.value):{}),z=lo(),ne=L(!1),ee=async(r=null)=>{const f=r||o.value;console.log(f,"===>posInfo");const C=v.value.addressLpTokens[f.poolAddress];if(C){const w=await g.value.getTickDataByIndex(C.ticks_handle,Number(f.tick_lower_index)),j=await g.value.getTickDataByIndex(C.ticks_handle,Number(f.tick_upper_index));let D={};u.value==="Aptos"?D=await g.value.getPosRewardersAmount({poolAddress:_.currentRoute.value.query.address,positionName:_.currentRoute.value.query.token,tickLowerData:w,tickUpperData:j}):D=await g.value.fetchPosRewardersAmount({poolAddress:f.poolAddress,positionId:f.pos_object_id,coinTypeA:f.coin_type_a,coinTypeB:f.coin_type_b,rewarderInfo:f.poolInfo.rewarder_infos});const P=[];let F=new b(0);D.forEach((H,ae)=>{var T,N;const re=(T=v.value.tokensObj[H.coin_address])==null?void 0:T.decimals,be=H.amount_owed.toString();let ye=new b(be).div(Math.pow(10,re)).toString();if(u.value=="Aptos"&&Number(ye)>999999999&&(ye="0"),f.poolInfo[`rewarder_display${ae+1}`]||Number(ye)>0){const se=v.value.tokensObj[H.coin_address],ke=((N=v.value.RATES[H.coin_address])==null?void 0:N.price)||0,k=new b(ye).mul(ke).toString();F=new b(F).plus(k),P.push({...H,...se,amount:Number(ye)>0?Pe(ye,re):0,amountUSD:Number(k)>0?Pe(k,2):0,amountUSDText:k})}}),y.value=P,console.log(P,"====>result722")}};Ae(()=>[v.value.currentPositionInfo,u.value],([r,f])=>{var C;f=="Aptos"&&r?(o.value=r,d.value=r==null?void 0:r.token_a,p.value=r==null?void 0:r.token_b):f=="Sui"&&r&&(r==null?void 0:r.nftHash)==((C=z==null?void 0:z.query)==null?void 0:C.pos)&&(console.log(r,"==>newVal"),o.value=r,d.value=r==null?void 0:r.token_a,p.value=r==null?void 0:r.token_b,ne.value=!1)},{immediate:!0}),Ae(()=>[o.value,v.value.addressLpTokens],([r,f])=>{!he(r)&&!he(f)&&ee(r)},{immediate:!0});const ce=A(()=>{var r,f,C,w,j,D,P,F;if(o.value&&!he(o.value)&&v.value.RATES){const H=o.value.amountA*((f=v.value.RATES[(r=o.value)==null?void 0:r.token_a.address])==null?void 0:f.price),ae=o.value.amountB*((w=v.value.RATES[(C=o.value)==null?void 0:C.token_b.address])==null?void 0:w.price);if((D=v.value.RATES[(j=o.value)==null?void 0:j.token_a.address])!=null&&D.price&&((F=v.value.RATES[(P=o.value)==null?void 0:P.token_b.address])!=null&&F.price)){const re=Number(H+ae);return re>0&&re<.01?"<0.01":J(Ue(H+ae,2),2)}else return" --"}else return" --"}),m=A(()=>{var r,f,C,w;return console.log((f=(r=o.value)==null?void 0:r.poolInfo)==null?void 0:f.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(w=(C=o.value)==null?void 0:C.poolInfo)==null?void 0:w.needReverse}),c=A(()=>v.value.RATES),q=A(()=>{var r,f;if(c.value&&d.value&&p.value&&!he(c.value)&&!he(d.value)&&!he(p.value)){const C=[],w=Number(o.value.feeOwedA)||0,j=Number(o.value.feeOwedB)||0;console.log(w,j,"===292"),console.log(c.value,d.value.address,"===293"),console.log(c.value[d.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(c.value[p.value.address],"===>RATES.value[toCoin.value.address]");const D=new b(w).mul(((r=c.value[d.value.address])==null?void 0:r.price)||0),P=new b(j).mul(((f=c.value[p.value.address])==null?void 0:f.price)||0);return console.log(D.toString(),P.toString(),"====>292"),C.push({amount:w,amountUSD:D.toString()},{amount:j,amountUSD:P.toString()}),C}return[]}),n=A(()=>{var f,C;let r=new b(0);return(f=q.value)==null||f.forEach(w=>{r=r.add(new b(w.amountUSD))}),u.value=="Sui"&&((C=y.value)==null||C.forEach(w=>{r=r.add(new b(w.amountUSDText))})),console.log(q.value,y.value,"===>pendingRewarderArr.value"),r.toNumber()}),h=A(()=>{var f;let r=new b(0);return(f=y.value)==null||f.forEach(C=>{r=r.add(new b(C.amountUSDText))}),r.toNumber()}),_=uo(),y=L([]),{setIsShowSuccess:l,setIsShowRejected:V,setIsShowWaiting:G,setTransactionDesc:ue,setTransactionTxid:x}=R,B=so(),W=A(()=>B),Y=async()=>{ne.value=!0;let r={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:y.value.length,collect_fee:!0};r.coinTypeC=y.value[0]?y.value[0].coin_address:"",r.coinTypeD=y.value[1]?y.value[1].coin_address:"",r.coinTypeE=y.value[2]?y.value[2].coin_address:"",G(!0),ue();try{let f;if(u.value==="Aptos"){const C=await g.value.getCollectRewarderTransactionPayload(r);f=await W.value.currentWallet.signAndSubmitTransaction(C)}else{r.pos_index=o.value.pos_object_id;const C=await g.value.getCollectRewarderTransactionPayload(r),w=await W.value.currentWallet.signAndExecuteTransactionBlock(C);f=g.value.handleTx(w)}if(f&&f.hash){x(f.hash),G(!1),l(!0);const C={title:"Claim",desc:"",hash:f.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(C.res=f.res),g.value.showTransitionPending(C);const w=await g.value.watchTransaction(C);console.log("0310###toClaimRewards###transitionStatus###",w),w&&t.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),G(!1),V(!0),ne.value=!1}catch(f){G(!1),V(!0),ne.value=!1,console.log(f,"error===>")}},oe=L(!1),le=async()=>{console.log("0310###toClaimRewards##start###",o.value),oe.value=!0;const r=y.value;let f={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:r.length};f.coinTypeC=r[0]?r[0].coin_address:"",f.coinTypeD=r[1]?r[1].coin_address:"",f.coinTypeE=r[2]?r[2].coin_address:"",console.log(f,"===>collectRewarderParams");try{let C;if(u.value==="Aptos"){const w=await g.value.getCollectRewarderTransactionPayload(f);C=await W.value.currentWallet.signAndSubmitTransaction(w)}else{f.pos_index=o.value.pos_object_id;const w=await g.value.getCollectRewarderTransactionPayload(f),j=await W.value.currentWallet.signAndExecuteTransactionBlock(w);C=g.value.handleTx(j)}if(console.log("0310###toClaimRewards##tx###",C),C&&C.hash){x(C.hash),G(!1),l(!0);const w=r[0].amount+r[0].symbol,j=f.coinTypeD?" and "+r[1].amount+r[1].symbol:"",D=f.coinTypeE?" and "+r[2].amount+r[2].symbol:"",P={title:"Claim",desc:"",hash:C.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:r[0].address,numa:`+ ${Number(r[0].amount)}`,logoa:v.value.tokensObj&&r[0]&&r[0].address&&v.value.tokensObj[r[0].address]&&v.value.tokensObj[r[0].address].logoURI,tokenb:r[1]&&r[1].address,numb:f.coinTypeD?`+ ${Number(r[1].amount)}`:"",logob:f.coinTypeD?v.value.tokensObj&&r[1]&&r[1].address&&v.value.tokensObj[r[1].address]&&v.value.tokensObj[r[1].address].logoURI:"",tokenc:r[2]&&r[2].address,numc:f.coinTypeE?`+ ${Number(r[2].amount)}`:"",logoc:f.coinTypeE?v.value.tokensObj&&r[2]&&r[2].address&&v.value.tokensObj[r[2].address]&&v.value.tokensObj[r[2].address].logoURI:""},text:w+j+D};u.value!=="Aptos"&&(P.res=C.res),g.value.showTransitionPending(P);const F=await g.value.watchTransaction(P);console.log("0310###toClaimRewards###transitionStatus###",F),F&&setTimeout(()=>{t.emit("getDetails"),g.value.getAccount(W.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),G(!1),V(!0);oe.value=!1}catch(C){console.log("0310###collectRewarderParams Error###",C),oe.value=!1,G(!1),V(!0)}},K=A(()=>v.value.positionDetailCurrentTab),ie=A(()=>{var C,w,j,D,P,F;const r=pe(m.value?(w=o.value)==null?void 0:w.amountB:(C=o.value)==null?void 0:C.amountA,m.value?(F=(P=o.value)==null?void 0:P.token_b)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_a)==null?void 0:D.decimals),f=m.value?v.value.positionActionAmount.toCoinAmount||0:v.value.positionActionAmount.fromCoinAmount||0;if(K.value=="increase")return f?new b(r).add(new b(f)).toString():"";if(f){const H=new b(r).minus(new b(f)).toString();return H<0?"0":String(H)}else return""}),Z=A(()=>{var C,w,j,D,P,F;const r=pe(m.value?(w=o.value)==null?void 0:w.amountA:(C=o.value)==null?void 0:C.amountB,m.value?(F=(P=o.value)==null?void 0:P.token_a)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_b)==null?void 0:D.decimals),f=m.value?v.value.positionActionAmount.fromCoinAmount||0:v.value.positionActionAmount.toCoinAmount||0;if(console.log(r,f,"===>427"),K.value=="increase")return f?new b(r).add(new b(f)).toString():"";if(f){const H=new b(r).minus(new b(f)).toString();return H<0?"0":String(H)}else return""}),ge=A(()=>m.value?v.value.positionActionAmount.toCoinAmount:v.value.positionActionAmount.fromCoinAmount),U=A(()=>m.value?v.value.positionActionAmount.fromCoinAmount:v.value.positionActionAmount.toCoinAmount),me=r=>{var f;return(r==null?void 0:r.logoURI)||(r==null?void 0:r.logo_url)||((f=v.value.tokensObj[r==null?void 0:r.address])==null?void 0:f.logo_url)||(S.value.theme==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},we=A(()=>{var D,P,F,H,ae,re,be,ye,T,N,se,ke;const{fromCoinAmount:r,toCoinAmount:f}=v.value.positionActionAmount,C=v.value.positionDetailCurrentTab,w=pe(m.value?(P=o.value)==null?void 0:P.amountB:(D=o.value)==null?void 0:D.amountA,m.value?(re=(ae=o.value)==null?void 0:ae.token_b)==null?void 0:re.decimals:(H=(F=o.value)==null?void 0:F.token_a)==null?void 0:H.decimals),j=pe(m.value?(ye=o.value)==null?void 0:ye.amountA:(be=o.value)==null?void 0:be.amountB,m.value?(ke=(se=o.value)==null?void 0:se.token_a)==null?void 0:ke.decimals:(N=(T=o.value)==null?void 0:T.token_b)==null?void 0:N.decimals);return console.log(w,j,r,f,"621===>"),u.value=="Sui"||C=="remove"&&u.value=="Aptos"&&r==w&&f==j});return{amountUSD:ce,needReverse:m,decimalUi:pe,pendingFees:q,positionInfo:o,pendingRewarderArr:y,pendingYieldAmount:n,toClaim:async()=>{ne.value=!0;const r=J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,f=J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;ue(i("newAdd.claimWaitingText",{from:m.value?f:r,and:J(o.value.feeOwedA,o.value.token_a.decimals)==0||J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:m.value?r:f})),G(!0);let C;const w={pool:o.value.poolInfo,position:o.value};try{const j=await g.value.getCollectFeeTransactionPayload(w);if(u.value==="Aptos")C=await W.value.currentWallet.signAndSubmitTransaction(j);else{const D=await W.value.currentWallet.signAndExecuteTransactionBlock(j);C=g.value.handleTx(D)}if(C){x(C.hash),G(!1),l(!0);const D={title:"Claim",desc:"",hash:C.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":v.value.tokensObj&&o.value&&o.value.token_a.address&&v.value.tokensObj[o.value.token_a.address]&&v.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":v.value.tokensObj&&o.value&&o.value.token_b.address&&v.value.tokensObj[o.value.token_b.address]&&v.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${J(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${J(o.value.feeOwedA,o.value.token_a.decimals)==0||J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${J(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(D.res=C.res),g.value.showTransitionPending(D);const P=await g.value.watchTransaction(D);console.log("0310##toClaim###transitionStatus####",P),P&&setTimeout(()=>{t.emit("getDetails")},1e3)}else G(!1),V(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});ne.value=!1,console.log("claim####test###",C)}catch(j){console.log("claim###error####",j),ne.value=!1,G(!1),V(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:Y,fromCoin:d,toCoin:p,showNum:Pe,claimLoading:ne,addCommom:J,afterBase:ie,afterQuote:Z,fromCoinAmount:ge,toCoinAmount:U,checkNullObj:he,getCoinIcon:me,chainName:u,isShowAfterAmount:we,pendingRewarderAmount:h,toClaimRewards:le,rewarderLoading:oe}}});const Et={class:"liquidity-card"},Dt={class:"liquidity-title"},Ft={class:"liquidity-usd"},Wt=a("span",null,"Liquidity",-1),Ht={class:"liquidity-ratio"},Xt={class:"coin-ratio"},Gt={class:"coin-a-ratio"},zt={class:"coin-b-ratio"},Yt={class:"ratio-progress"},Qt={class:"base-quote-num"},Jt={class:"base-coin-num"},Zt=a("span",null,"Base",-1),Kt={alt:""},Vt={key:0,class:"after"},xt={class:"quote-coin-num"},ei=a("span",null,"Quote",-1),oi={alt:""},ni={key:0,class:"after"},ti={class:"pending-yield"},ii={class:"left"},ai={class:"pending-yield-title"},si={key:0,class:"after"},li={class:"right"},ui={class:"fees-rewards"},ri={class:"fees-rewards-item"},di=a("span",null,"Fees",-1),ci={key:0,class:"after"},vi=a("span",null,"Fees",-1),mi={key:0,class:"after"},fi=a("span",null,"Bonus",-1),pi={alt:""},hi={key:0,class:"after"},gi={key:0,class:"pending-yield"},bi={class:"left"},ki=a("div",{class:"pending-yield-title"},"Pending rewards",-1),wi={key:0,class:"after"},yi={class:"right"},Ai={key:1,class:"fees-rewards"},_i={class:"fees-rewards-item"},Ci=a("span",null,"Bonus",-1),Ii={alt:""},Si={key:0,class:"after"};function $i(e,t,i,s,R,S){var d,p,u,g,z,ne,ee,ce,m,c,q,n,h,_,y,l,V,G,ue,x,B,W,Y,oe,le,K,ie,Z,ge,U,me,we,De,r,f,C,w,j,D,P,F,H,ae,re,be,ye,T,N,se,ke,k,X,I,te,ve,Se,Ne,Ce,Te,Be,Le,We,Re,Me;const O=ao,v=ro,o=Mo("image");return $(),M("div",Et,[a("div",Dt,[a("div",Ft,[Wt,a("div",null,"$"+E(e.amountUSD),1)]),a("div",Ht,[a("div",Xt,[a("div",Gt,[a("span",null,E(e.needReverse?(p=e.toCoin)==null?void 0:p.symbol:(d=e.fromCoin)==null?void 0:d.symbol),1),_e(" "+E(e.needReverse?(g=e.positionInfo)==null?void 0:g.toPercent:(u=e.positionInfo)==null?void 0:u.fromPercent)+"% ",1)]),a("div",zt,[a("span",null,E(e.needReverse?(ne=e.fromCoin)==null?void 0:ne.symbol:(z=e.toCoin)==null?void 0:z.symbol),1),_e(" "+E(e.needReverse?(ce=e.positionInfo)==null?void 0:ce.fromPercent:(ee=e.positionInfo)==null?void 0:ee.toPercent)+"% ",1)])]),a("div",Yt,[a("div",{class:"from-percent",style:$o({width:e.needReverse?((c=e.positionInfo)==null?void 0:c.toPercent)+"%":((m=e.positionInfo)==null?void 0:m.fromPercent)+"%"})},null,4),a("div",{class:"to-percent",style:$o({width:e.needReverse?((n=e.positionInfo)==null?void 0:n.fromPercent)+"%":((q=e.positionInfo)==null?void 0:q.toPercent)+"%"})},null,4)])])]),a("div",Qt,[a("div",Jt,[Zt,a("div",null,[qe(a("img",Kt,null,512),[[o,(e.needReverse?(_=e.toCoin)==null?void 0:_.logo_url:(h=e.fromCoin)==null?void 0:h.logo_url)||e.getCoinIcon(e.needReverse?(l=e.positionInfo)==null?void 0:l.token_b:(y=e.positionInfo)==null?void 0:y.token_a)]]),de(O,{address:e.needReverse?(x=(ue=e.positionInfo)==null?void 0:ue.token_b)==null?void 0:x.address:(G=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:G.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.needReverse?(W=e.positionInfo)==null?void 0:W.amountB:(B=e.positionInfo)==null?void 0:B.amountA,e.needReverse?(K=(le=e.positionInfo)==null?void 0:le.token_b)==null?void 0:K.decimals:(oe=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:oe.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:Q(he))(e.positionInfo)?($(),M("div",Vt,E(("addCommom"in e?e.addCommom:Q(J))(e.afterBase))+" after ",1)):fe("",!0)]),a("div",xt,[ei,a("div",null,[qe(a("img",oi,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(ie=e.toCoin)==null?void 0:ie.logo_url)||e.getCoinIcon(e.needReverse?(U=e.positionInfo)==null?void 0:U.token_a:(ge=e.positionInfo)==null?void 0:ge.token_b)]]),de(O,{address:e.needReverse?(r=(De=e.positionInfo)==null?void 0:De.token_a)==null?void 0:r.address:(we=(me=e.positionInfo)==null?void 0:me.token_b)==null?void 0:we.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(("addCommom"in e?e.addCommom:Q(J))(("decimalUi"in e?e.decimalUi:Q(pe))(e.needReverse?(C=e.positionInfo)==null?void 0:C.amountA:(f=e.positionInfo)==null?void 0:f.amountB,e.needReverse?(P=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:P.decimals:(j=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:j.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:Q(he))(e.positionInfo)?($(),M("div",ni,E(("addCommom"in e?e.addCommom:Q(J))(e.afterQuote))+" after ",1)):fe("",!0)])]),a("div",ti,[a("div",ii,[a("div",ai,E(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),a("div",null,[_e(" $"+E(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Q(J))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?($(),M("span",si,"$0 after")):fe("",!0)])]),a("div",li,[de(v,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:t[0]||(t[0]=Ie=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Ye(()=>[_e("Claim")]),_:1},8,["loading","disabled"])])]),a("div",ui,[a("div",ri,[a("div",null,[di,a("div",null,[qe(a("img",null,null,512),[[o,(e.needReverse?(H=e.toCoin)==null?void 0:H.logo_url:(F=e.fromCoin)==null?void 0:F.logo_url)||e.getCoinIcon(e.needReverse?(re=e.positionInfo)==null?void 0:re.token_b:(ae=e.positionInfo)==null?void 0:ae.token_a)]]),de(O,{address:e.needReverse?(N=(T=e.positionInfo)==null?void 0:T.token_b)==null?void 0:N.address:(ye=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(e.needReverse?("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedB,(X=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:X.decimals):("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedA,(ke=(se=e.positionInfo)==null?void 0:se.token_a)==null?void 0:ke.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",ci," 0 after ")):fe("",!0)]),a("div",null,[vi,a("div",null,[qe(a("img",null,null,512),[[o,(e.needReverse?(te=e.fromCoin)==null?void 0:te.logo_url:(I=e.toCoin)==null?void 0:I.logo_url)||e.getCoinIcon(e.needReverse?(Se=e.positionInfo)==null?void 0:Se.token_a:(ve=e.positionInfo)==null?void 0:ve.token_b)]]),de(O,{address:e.needReverse?(Be=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:Be.address:(Ce=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(e.needReverse?("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedA,(Me=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Me.decimals):("showNum"in e?e.showNum:Q(Pe))(e.positionInfo.feeOwedB,(We=(Le=e.positionInfo)==null?void 0:Le.token_b)==null?void 0:We.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",mi," 0 after ")):fe("",!0)]),e.chainName=="Sui"?($(!0),M(po,{key:0},ho(e.pendingRewarderArr,Ie=>($(),M("div",{key:Ie},[fi,a("div",null,[qe(a("img",pi,null,512),[[o,Ie.logo_url]]),de(O,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",hi," 0 after ")):fe("",!0)]))),128)):fe("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?($(),M("div",gi,[a("div",bi,[ki,a("div",null,[_e(" $"+E(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:Q(J))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?($(),M("span",wi,"$0 after")):fe("",!0)])]),a("div",yi,[de(v,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Ye(()=>[_e("Claim")]),_:1},8,["loading","disabled","onClick"])])])):fe("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?($(),M("div",Ai,[a("div",_i,[($(!0),M(po,null,ho(e.pendingRewarderArr,Ie=>($(),M("div",{key:Ie},[Ci,a("div",null,[qe(a("img",Ii,null,512),[[o,Ie.logo_url]]),de(O,{address:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(Ie.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:Q(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",Si," 0 after ")):fe("",!0)]))),128))])])):fe("",!0)])}const Ho=Ze(jt,[["render",$i]]),Ti=Je({components:{AssetsCard:co},setup(e,t){const i=L(""),s=L(""),R=Qe(),S=A(()=>R),O=A(()=>S.value.theme),v=no(),o=A(()=>v),d=L(!1),p=L(!1),u=L(!0),g=A(()=>S.value.chainName),z=A(()=>g.value?oo(g.value):{}),ne=so(),ee=A(()=>ne),ce=A(()=>S.value.slippage),m=L(),c=L(),q=A(()=>ee.value.assets&&m.value&&ee.value.assets[m.value.address]?Co(ee.value.assets[m.value.address].balance,m.value.decimals):0),n=A(()=>ee.value.assets&&c.value&&ee.value.assets[c.value.address]?Co(ee.value.assets[c.value.address].balance,c.value.decimals):0),h=w=>{w==="fromCoin"?(u.value=!0,g.value==="Aptos"?i.value=q.value>0?m.value.symbol=="APT"?new b(Number(q.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(q.value)).sub(new b(.1)).toString():String(q.value):"":i.value=q.value>0?m.value.symbol=="SUI"?new b(Number(q.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(q.value)).sub(new b(.05)).toString():String(q.value):""):(u.value=!1,g.value==="Aptos"?s.value=n.value>0?c.value.symbol=="APT"?new b(Number(n.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(n.value)).sub(new b(.1)).toString():String(n.value):"":s.value=n.value>0?c.value.symbol=="SUI"?new b(Number(n.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(n.value)).sub(new b(.05)).toString():String(n.value):"")},_=w=>{w==="fromCoin"?(u.value=!0,i.value=Ue(new b(Number(q.value)).div(2).toString(),m.value.decimals).toString()):(u.value=!1,s.value=Ue(new b(Number(n.value)).div(2).toString(),c.value.decimals).toString())},y=L({}),l=L(!0),V=L({}),G=L(),ue=L(),x=()=>{var N;if(!y.value||!i.value&&!s.value)return;const{TickMath:w,TickUtil:j}=z.value;console.log(i.value,s.value,"====>369"),console.log(y.value,"===>positionInfo.value339");let D=y.value.minPrice,P=y.value.maxPrice.indexOf("+")>0?"∞":y.value.maxPrice;console.log(y.value,"positionInfo.value====>");let F=Number(y.value.tick_lower_index),H=Number(y.value.tick_upper_index);const ae=Number(y.value.current_tick_index);let re,be,ye=Number(D).toString(),T=y.value.maxPrice.indexOf("+")>0||y.value.maxPrice==="∞"?"∞":Number(P);if(ye=="0"&&T=="∞"?(F=Number(y.value.tick_lower_index),H=Number(y.value.tick_upper_index)):(re=w.priceToSqrtPriceX64(new b(D),m.value.decimals,c.value.decimals),be=w.priceToSqrtPriceX64(new b(P),m.value.decimals,c.value.decimals)),G.value=F,ue.value=H,console.log(F,H,"tick_lowertick_lower"),P!=="∞"&&F>=H){d.value=!0,i.value="",p.value=!0,s.value="";return}if(P=="∞"||ae>=F&&ae<=H){console.log("0413###increase###11111"),d.value=!1,p.value=!1;let se;if(i.value||s.value){if(u.value){const ve=new b(i.value).mul(Math.pow(10,m.value.decimals)).toString();se=new Oe(ve)}else{const ve=new b(s.value).mul(Math.pow(10,c.value.decimals)).toString();se=new Oe(ve)}const{liquidityAmount:ke,tokenMaxA:k,tokenMaxB:X,tokenMaxAOrigin:I,tokenMaxBOrigin:te}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:m.value,tokenB:c.value,lowerTick:F,upperTick:H,coinAmount:se,iscoinA:l.value?u.value:!u.value,roundUp:!0,slippage:Number(ce.value)/100,curSqrtPrice:new Oe(y.value.current_sqrt_price)});V.value={liquidityAmount:ke,tokenMaxA:k,tokenMaxB:X,tokenMaxAOrigin:I,tokenMaxBOrigin:te},l.value?u.value?s.value=Number(X)>0?X:"":i.value=Number(k)>0?k:"":u.value?s.value=k:i.value=X}}else if(ae>H){if(console.log("0413###increase###22222"),i.value="",d.value=!0,p.value=!1,i.value||s.value){let se;const ke=new b(s.value).mul(Math.pow(10,(N=c.value)==null?void 0:N.decimals)).toString();se=new Oe(ke),V.value={liquidityAmount:Oo(re,be,se),tokenMaxA:0,tokenMaxB:s.value}}}else if(ae<F){if(console.log("0413###increase###33333"),d.value=!1,p.value=!0,s.value="",i.value||s.value){let se;const ke=new b(i.value).mul(Math.pow(10,m.value.decimals)).toString();se=new Oe(ke),V.value={liquidityAmount:qo(re,be,se),tokenMaxA:i.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),d.value=!0,i.value="",p.value=!0,s.value="";v.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s}),console.log(V.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};Ae(()=>o.value.currentPositionInfo,w=>{if(w&&!he(w)){y.value=w,console.log(w,"newVal===>"),m.value=y.value.token_a,c.value=y.value.token_b;let j=Number(y.value.tick_lower_index),D=Number(y.value.tick_upper_index);const P=Number(y.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="∞"?"∞":w.maxPrice)=="∞"||P>=j&&P<=D?(d.value=!1,p.value=!1):P>D?(i.value="",d.value=!0,p.value=!1):P<j?(d.value=!1,p.value=!0,s.value=""):(d.value=!0,i.value="",p.value=!0,s.value=""),x()}},{immediate:!0}),Ae(i,(w,j)=>{w&&x(),w==""&&(s.value="")}),Ae(s,(w,j)=>{w&&x(),w==""&&(i.value="")});const B=A(()=>{var w,j,D,P;return console.log((j=(w=y.value)==null?void 0:w.poolInfo)==null?void 0:j.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(P=(D=y.value)==null?void 0:D.poolInfo)==null?void 0:P.needReverse}),W=A(()=>o.value.RATES),Y=A(()=>{var H,ae,re,be;const w=((ae=W.value[(H=m.value)==null?void 0:H.address])==null?void 0:ae.price)||0,j=((be=W.value[(re=c.value)==null?void 0:re.address])==null?void 0:be.price)||0,D=new b(w).mul(new b(i.value||0)),P=new b(j).mul(new b(s.value||0)),F=D.add(P);return console.log(w,j,D.toString(),P.toString(),"====>amount"),F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?J(F.toString(),2):"<0.01":"--"}),oe=L(!1),{t:le,locale:K}=_o(),ie=A(()=>{const w=Number(i.value)>Number(q.value),j=Number(s.value)>Number(n.value);return!i.value&&!s.value?le("button.enterAmount"):w?le("button.insufficientBalance",{name:m.value.symbol}):j?le("button.insufficientBalance",{name:c.value.symbol}):le("newAdd.addMore")}),Z=A(()=>{const w=Number(i.value)>Number(q.value),j=Number(s.value)>Number(n.value);return!!(!i.value&&!s.value||w||j)}),{setIsShowSuccess:ge,setIsShowRejected:U,setIsShowWaiting:me,setTransactionDesc:we,setTransactionTxid:De,setPositiomNum:r}=R,f=L(!1);return{theme:O,showFromCoinLock:d,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:q,toCoinBlance:n,fromCoin:m,toCoin:c,maxBtnSelect:h,halfBtnSelect:_,fixedFromCoin:u,needReverse:B,totalAmount:Y,wallet:ee,addLiquidityBtnText:ie,isShowLiquidityModal:oe,indexStore:R,positionInfo:y,actionLoading:f,toAdd:async()=>{var H,ae,re,be,ye,T,N,se,ke,k;oe.value=!1,f.value=!0,De("");const w=d.value?"":`${i.value} ${(H=m.value)==null?void 0:H.symbol}`,j=p.value?"":`${s.value} ${(ae=c.value)==null?void 0:ae.symbol}`;we(le("tips.increaseLiquiditySuccess",{from:B.value?j:w,and:!d.value&&!p.value?"and":"",to:B.value?w:j})),me(!0);const D=u.value;console.log(D,"===>fix_amount_a"),console.log(G.value,"tickLower.value===>"),console.log(ue.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",y);const P=y.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=P[0]?P[0].coinAddress:"",F.coinTypeD=P[1]?P[1].coinAddress:"",F.coinTypeE=P[2]?P[2].coinAddress:"";try{const X=await z.value.getAddLiquidityTransactionPayload({pool:{poolAddress:y.value.poolAddress,token_a:y.value.token_a,token_b:y.value.token_b},amount:D?V.value.tokenMaxA:V.value.tokenMaxB,fix_amount_a:D,tick_lower:G.value,tick_upper:ue.value,index:g.value==="Aptos"?y.value.index:y.value.pos_object_id,slippage:Number(ce.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new Oe(y==null?void 0:y.value.poolInfo.current_sqrt_price)});console.log(X,"===>payloadAdd11111");let I;if(g.value==="Aptos")I=await ee.value.currentWallet.signAndSubmitTransaction(X);else{const te=await ee.value.currentWallet.signAndExecuteTransactionBlock(X);I=z.value.handleTx(te)}if(console.log("toAdd###tx###",I),I&&I.hash){De(I.hash),me(!1),ge(!0),console.log(y,"===>positionInfo");const te={title:"Supplied",desc:le("tips.addLiquiditySuccessText",{from:d.value?"":`${i.value} ${(re=m.value)==null?void 0:re.symbol}`,and:!d.value&&!p.value?"and":"",to:p.value?"":`${s.value} ${(be=c.value)==null?void 0:be.symbol}`}),hash:I.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:B.value?`${(T=c.value)==null?void 0:T.address}`:`${(ye=m.value)==null?void 0:ye.address}`,numa:B.value?`- ${s.value}`:`- ${i.value}`,logoa:B.value?o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI:o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI,tokenb:B.value?`${(se=m.value)==null?void 0:se.address}`:`${(N=c.value)==null?void 0:N.address}`,numb:B.value?`- ${i.value}`:`- ${s.value}`,logob:B.value?o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI:o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI},text:`Deopsit ${d.value?"":`${i.value} ${(ke=m.value)==null?void 0:ke.symbol}`} ${!d.value&&!p.value?"and":""} ${p.value?"":`${s.value} ${(k=c.value)==null?void 0:k.symbol}`}`};g.value!=="Aptos"&&(te.res=I.res),z.value.showTransitionPending(te),await z.value.watchTransaction(te)&&setTimeout(()=>{t.emit("getDetails"),z.value.getAccount(ee.value.address)},1e3),r()}else me(!1),U(!0);i.value="",s.value="",f.value=!1}catch(X){i.value="",s.value="",console.log("addError###",X),f.value=!1,me(!1),U(!0)}},addLiquidityBtnDisabled:Z,poolStore:v}}});const Pi={class:"new-position-asset"},Ni={class:"add-or-remove"},Ri={class:"liquidity-action-tab"},Oi=a("div",{class:"increase tab-active"}," Increase ",-1),qi={class:"card-item"},Bi={class:"card-item"},Li={key:0,class:"add",src:un},Mi={key:1,class:"add",src:rn},Ui={class:"total-amount"},ji=a("span",null,"Total Amount",-1);function Ei(e,t,i,s,R,S){var p;const O=co,v=sn,o=ro,d=ln;return $(),M("div",Pi,[a("div",Ni,[a("div",Ri,[Oi,a("div",{class:"remove",onClick:t[0]||(t[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),a("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[a("div",qi,[de(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=u=>{e.fromCoinAmount=u}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?($(),je(v,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),a("div",Bi,[de(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=u=>{e.toCoinAmount=u}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?($(),je(v,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?($(),M("img",Li)):fe("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?($(),M("img",Mi)):fe("",!0)],2),a("div",Ui,[ji,a("span",null,"$"+E(e.totalAmount),1)])]),e.wallet.connected?($(),je(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=u=>e.isShowLiquidityModal=!0)},{default:Ye(()=>[a("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):($(),je(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[a("span",null,E(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?($(),je(d,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):fe("",!0)])}const wo=Ze(Ti,[["render",Ei]]),Di=Je({components:{AssetsCard:co},setup(e,t){const i=L(""),s=L(""),R=Qe(),S=A(()=>R),O=A(()=>S.value.theme),v=no(),o=A(()=>v),d=L(!1),p=L(!1),u=L(!0),g=A(()=>S.value.chainName),z=A(()=>g.value?oo(g.value):{}),ne=so(),ee=A(()=>ne),ce=A(()=>S.value.slippage),m=L(),c=L(),q=A(()=>{var k,X;return(X=(k=l.value)==null?void 0:k.poolInfo)==null?void 0:X.needReverse}),n=A(()=>{var k;return console.log(l==null?void 0:l.value,"==>positionInfo?.value"),console.log(!q.value,"===>!needReverse.value"),pe(l==null?void 0:l.value.amountA,(k=l==null?void 0:l.value.token_a)==null?void 0:k.decimals)}),h=A(()=>{var k;return pe(l==null?void 0:l.value.amountB,(k=l==null?void 0:l.value.token_b)==null?void 0:k.decimals)}),_=k=>{k==="fromCoin"?u.value=!0:u.value=!1,Y.value=100,le({value:1})},y=k=>{k==="fromCoin"?(u.value=!0,i.value=Ue(new b(Number(n.value)).div(2).toString(),m.value.decimals).toString()):(u.value=!1,s.value=Ue(new b(Number(h.value)).div(2).toString(),c.value.decimals).toString()),B.value=!1},l=L({}),V=L(!0),G=L({}),ue=L(),x=L(),B=L(!0),W=()=>{var We;if(B.value||!l.value||!i.value&&!s.value||(console.log(i.value>n.value,Number(s.value)>Number(h.value),"==>toCoinAmount.value"),Number(i.value)>Number(n.value)||Number(s.value)>Number(h.value)))return;if(i.value==n.value&&s.value==h.value){Y.value=100,le({value:1}),B.value=!0;return}const{TickMath:k,TickUtil:X}=z.value;console.log(i.value,s.value,"====>369"),console.log(l.value,"===>positionInfo.value339");let I=l.value.minPrice,te=l.value.maxPrice.indexOf("+")>0?"∞":l.value.maxPrice;console.log(l.value,"positionInfo.value====>");let ve=Number(l.value.tick_lower_index),Se=Number(l.value.tick_upper_index);const Ne=Number(l.value.current_tick_index);let Ce,Te,Be=Number(I).toString(),Le=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="∞"?"∞":Number(te);if(Be=="0"&&Le=="∞"?(ve=Number(l.value.tick_lower_index),Se=Number(l.value.tick_upper_index)):(Ce=k.priceToSqrtPriceX64(new b(I),m.value.decimals,c.value.decimals),Te=k.priceToSqrtPriceX64(new b(te),m.value.decimals,c.value.decimals)),ue.value=ve,x.value=Se,console.log(ve,Se,"tick_lowertick_lower"),te!=="∞"&&ve>=Se){d.value=!0,i.value="",p.value=!0,s.value="";return}if(te=="∞"||Ne>=ve&&Ne<=Se){console.log("0413###increase###11111"),console.log(i.value,"==>341"),console.log(s.value,"==>341"),d.value=!1,p.value=!1;let Re;if(i.value||s.value){if(u.value){const Ge=new b(i.value).mul(Math.pow(10,m.value.decimals)).toString();Re=new Oe(Ge)}else{const Ge=new b(s.value).mul(Math.pow(10,c.value.decimals)).toString();Re=new Oe(Ge)}const{liquidityAmount:Me,tokenMaxA:Ie,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:$e}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:m.value,tokenB:c.value,lowerTick:ve,upperTick:Se,coinAmount:Re,iscoinA:V.value?u.value:!u.value,roundUp:g.value!="Sui",slippage:Number(ce.value)/100,curSqrtPrice:new Oe(l.value.current_sqrt_price)});G.value={liquidityAmount:Me,tokenMaxA:Ie,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:$e},console.log(He,Ie,"362===>"),V.value?u.value?s.value=Number(He)>0?He:"":i.value=Number(Ie)>0?Ie:"":u.value?s.value=Ie:i.value=He}}else if(Ne>Se){if(console.log("0413###increase###22222"),i.value="",d.value=!0,p.value=!1,i.value||s.value){let Re;const Me=new b(s.value).mul(Math.pow(10,(We=c.value)==null?void 0:We.decimals)).toString();Re=new Oe(Me),G.value={liquidityAmount:Oo(Ce,Te,Re),tokenMaxA:0,tokenMaxB:s.value}}}else if(Ne<ve){if(console.log("0413###increase###33333"),d.value=!1,p.value=!0,s.value="",i.value||s.value){let Re;const Me=new b(i.value).mul(Math.pow(10,m.value.decimals)).toString();Re=new Oe(Me),G.value={liquidityAmount:qo(Ce,Te,Re),tokenMaxA:i.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),d.value=!0,p.value=!0;B.value=!1,Y.value=new b(G.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),oe.value=G.value.liquidityAmount,console.log(Y.value,"===>sliderVal.value"),console.log(G.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),v.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s}),console.log(Y.value,"===>sliderVal.value")},Y=L(50),oe=L("0"),le=k=>{if(!B.value)return;B.value=!0;const X=l.value.token_a.decimals,I=l.value.token_b.decimals,te=l.value.tick_lower_index,ve=l.value.tick_upper_index,Se=Io.tickIndexToSqrtPriceX64(te),Ne=Io.tickIndexToSqrtPriceX64(ve);let Ce="";k.value!==1?Ce=new b(l.value.liquidity).mul(k.value).toString():Ce=l.value.liquidity,Ce=Ue(Ce,0)||"0",oe.value=Ce;const Te=Yo.getCoinAmountFromLiquidity(new Oe(Ce),new Oe(l.value.current_sqrt_price),Se,Ne,g.value!="Sui");console.log(Te.coinA.toString(),Te.coinB.toString(),X,I,"===>amountInfo");const Be=new b(Te.coinA.toString()).div(Math.pow(10,X)).toString(),Le=new b(Te.coinB.toString()).div(Math.pow(10,I)).toString();console.log(Be,Le,"amountA121212"),i.value=Number(Be)>0?Be:"",s.value=Number(Le)>0?Le:"",v.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};Ae(()=>o.value.currentPositionInfo,k=>{if(k&&!he(k)){l.value=k,console.log(k,"newVal===>"),m.value=l.value.token_a,c.value=l.value.token_b,le({value:Y.value/100});let X=Number(l.value.tick_lower_index),I=Number(l.value.tick_upper_index);const te=Number(l.value.current_tick_index);(k.maxPrice.indexOf("+")>0||k.maxPrice==="∞"?"∞":k.maxPrice)=="∞"||te>=X&&te<=I?(d.value=!1,p.value=!1):te>I?(i.value="",d.value=!0,p.value=!1):te<X?(d.value=!1,p.value=!0,s.value=""):(d.value=!0,i.value="",p.value=!0,s.value=""),W()}},{immediate:!0}),Ae(i,(k,X)=>{k&&W(),k==""&&(s.value="",Y.value=0)}),Ae(s,(k,X)=>{k&&W(),k==""&&(i.value="",Y.value=0)});const K=A(()=>o.value.RATES),ie=A(()=>{var Se,Ne,Ce,Te;const k=((Ne=K.value[(Se=m.value)==null?void 0:Se.address])==null?void 0:Ne.price)||0,X=((Te=K.value[(Ce=c.value)==null?void 0:Ce.address])==null?void 0:Te.price)||0,I=new b(k).mul(new b(i.value||0)),te=new b(X).mul(new b(s.value||0)),ve=I.add(te);return console.log(k,X,I.toString(),te.toString(),"====>amount"),J(ve.toString(),2)}),Z=L(!1),{t:ge,locale:U}=_o(),me=A(()=>{const k=Number(i.value)>Number(n.value),X=Number(s.value)>Number(h.value);return!i.value&&!s.value?ge("button.enterAmount"):k||X?"Invalid Amount":ge("button.remove")}),we=A(()=>{const k=Number(i.value)>Number(n.value),X=Number(s.value)>Number(h.value);return!!(!i.value&&!s.value||k||X)}),{setIsShowSuccess:De,setIsShowRejected:r,setIsShowWaiting:f,setTransactionDesc:C,setTransactionTxid:w,setPositiomNum:j,setTransactionDescText:D}=R,P=L(!1);Ae(Y,xo((k,X)=>{k!==X&&(Number(k)>100?Y.value=100:k&&l.value?(console.log("687===>"),Y.value=k,le({value:Y.value/100})):(i.value="",s.value=""))},300)),Ae(ce,k=>{k&&l.value&&le({value:Y.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],H=Uo(),ae=A(()=>H),re=A(()=>ae.value.status),be=L(!1),ye=k=>{const X=k.sources;X.forEach(I=>{const{pool_address:te,position_index:ve}=JSON.parse(I.blockchainAddress);console.log(te,ve,"===>pool_address, position_index"),console.log(l.value.poolAddress,l.value.index,"===>positionInfo.value.index"),te==l.value.poolAddress&&Number(ve)==Number(l.value.index)&&(be.value=!0)}),console.log(X,"===>sources")},T=async()=>{await H.getSources();let k;ae.value.allSources.forEach(X=>{const{pool_address:I,position_index:te}=JSON.parse(X.blockchainAddress);I==l.value.poolAddress&&te==l.value.index&&(k=X.id)}),console.log(k,"sourceID649==>"),H.deleteSource(k)};Ae(()=>[ae.value.sourceGroups,l.value],([k,X])=>{k&&k.sources&&k.sources.length>0&&X&&!he(X)&&ye(k)},{immediate:!0,deep:!0});const N=uo(),se=lo();return{theme:O,showFromCoinLock:d,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:n,toCoinBlance:h,fromCoin:m,toCoin:c,maxBtnSelect:_,halfBtnSelect:y,fixedFromCoin:u,needReverse:q,totalAmount:ie,wallet:ee,addLiquidityBtnText:me,isShowLiquidityModal:Z,indexStore:R,positionInfo:l,actionLoading:P,addLiquidityBtnDisabled:we,sliderVal:Y,ratioArr:F,setPercent:le,poolStore:v,isSlider:B,toRemove:async()=>{var ve,Se,Ne,Ce,Te,Be,Le,We,Re,Me,Ie,He,to;P.value=!0,w("");const k=J(i.value,m.value.decimals)==0?"":`${pe(i.value,m.value.decimals)} ${m.value.symbol}`,X=J(s.value,c.value.decimals)==0?"":`${pe(s.value,c.value.decimals)} ${c.value.symbol}`;C(ge("tips.removeLiquidiyText",{from:q.value?X:k,and:J(i.value,m.value.decimals)==0||J(s.value,c.value.decimals)==0?"":"and",to:q.value?k:X})),f(!0),console.log(l.value,"==>positionInfo.value");const I=l.value.poolInfo.rewarder_infos,te=I&&I.length>0&&g.value=="Sui"||I&&I.length>0&&Y.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");D(te);try{let $e={};$e={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:Y.value==100?new Oe(l.value.liquidity):new Oe(Ue(oe.value,0)),slippage:Number(ce.value),rewards_num:I.length},console.log(I,"===>pendingRewarderArr"),$e.coinTypeC=I[0]?I[0].coinAddress:"",$e.coinTypeD=I[1]?I[1].coinAddress:"",$e.coinTypeE=I[2]?I[2].coinAddress:"",console.log($e,"===>params");const Ge=await z.value.getRemoveLiquidityTransactionPayload($e);console.log(Ge,"===>payload");let Ee;if(g.value==="Aptos")Ee=await ee.value.currentWallet.signAndSubmitTransaction(Ge);else{const Ve=await ee.value.currentWallet.signAndExecuteTransactionBlock(Ge);Ee=z.value.handleTx(Ve),console.log("0331###remove###tx####",Ee)}if(Ee&&Ee.hash){w(Ee.hash),f(!1),De(!0);const Ve={title:ge("common.removeLiquidity"),desc:"",hash:Ee.hash,descTransactions:`Remove ${i.value} ${(ve=m.value)==null?void 0:ve.symbol} and ${s.value} ${(Se=c.value)==null?void 0:Se.symbol} 
             from the pool`,sender:ee.value.address,chainName:g.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:q.value?`${(Ce=c.value)==null?void 0:Ce.address}`:`${(Ne=m.value)==null?void 0:Ne.address}`,numa:q.value?`+ ${s.value}`:`+ ${i.value}`,logoa:q.value?o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI:o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI,tokenb:q.value?`${(Te=m.value)==null?void 0:Te.address}`:`${(Be=c.value)==null?void 0:Be.address}`,numb:q.value?`+ ${i.value}`:`+ ${s.value}`,logob:q.value?o.value.tokensObj&&m.value&&m.value.address&&o.value.tokensObj[m.value.address]&&o.value.tokensObj[m.value.address].logoURI:o.value.tokensObj&&c.value&&c.value.address&&o.value.tokensObj[c.value.address]&&o.value.tokensObj[c.value.address].logoURI},text:`Withdraw ${i.value} ${(Le=m.value)==null?void 0:Le.symbol} and ${s.value} ${(We=c.value)==null?void 0:We.symbol}`};g.value!=="Aptos"&&(Ve.res=Ee.res),z.value.showTransitionPending(Ve);const io=await z.value.watchTransaction(Ve);if(I.value&&I.value.length>0&&(Number((Re=I[0])==null?void 0:Re.amount)!==0||$e.coinTypeD&&Number((Me=I[1])==null?void 0:Me.amount)!==0||$e.coinTypeE&&Number((Ie=I[2])==null?void 0:Ie.amount)!==0)){const vo={title:ge("common.removeLiquidity"),desc:"",hash:Ee.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:I[0].symbol,numa:`+ ${Number(I[0].amount)}`,logoa:o.value.tokensObj&&I[0]&&I[0].address&&o.value.tokensObj[I[0].address]&&o.value.tokensObj[I[0].address].logoURI,tokenb:$e.coinTypeD?I[1].symbol:"",numb:$e.coinTypeD?`+ ${Number(I[1].amount)}`:"",logob:$e.coinTypeD?o.value.tokensObj&&I[1]&&I[1].address&&o.value.tokensObj[I[1].address]&&o.value.tokensObj[I[1].address].logoURI:"",tokenc:$e.coinTypeE?I[2].symbol:"",numc:$e.coinTypeE?`+ ${Number(I[2].amount)}`:"",logoc:$e.coinTypeE?o.value.tokensObj&&I[2]&&I[2].address&&o.value.tokensObj[I[2].address]&&o.value.tokensObj[I[2].address].logoURI:""},text:`Withdraw ${i.value} ${(He=m.value)==null?void 0:He.symbol} and ${s.value} ${(to=c.value)==null?void 0:to.symbol}`},mo=await z.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}if(Pe(l.value.feeOwedA,l.value.token_a.decimals)!==0||Pe(l.value.feeOwedB,l.value.token_b.decimals)!==0){const vo={title:"Claim",desc:"",hash:Ee.hash,chainName:g.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:J(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Pe(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:J(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:J(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Pe(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:J(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},mo=await z.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}io&&Number(Y.value)==100&&re.value=="authenticated"&&be.value&&(await H.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),T()),io&&(i.value="",s.value="",setTimeout(()=>{t.emit("getDetails")},3e3),setTimeout(()=>{t.emit("getDetails")},6e3),console.log(Y.value,se.name,g.value,"998===>"),Number(Y.value)==100&&se.name=="new-position-detail"&&(g.value==="Aptos"?N.push("/position"):N.push("/pool/position")),Y.value=0)}else f(!1),r(!0);P.value=!1}catch($e){console.log("Remove error",$e),P.value=!1,f(!1),r(!0)}},sFixD:Ue}}});const Fi={class:"new-position-asset"},Wi={class:"add-or-remove"},Hi={class:"liquidity-action-tab"},Xi=a("div",{class:"remove tab-active"},"Remove",-1),Gi={class:"card-item"},zi={key:0,class:"assets-card-mask"},Yi={class:"card-item"},Qi={key:0,class:"assets-card-mask"},Ji={class:"remove-ratio"},Zi=a("div",{class:"remove-ratio-title"},"Amount",-1),Ki={class:"remove-ratio-select"},Vi={key:0,class:"ratio"},xi={key:1,class:"ratio"},ea={class:"ratio-list"},oa=["onClick"];function na(e,t,i,s,R,S){const O=co,v=en,o=ro;return $(),M("div",Fi,[a("div",Wi,[a("div",Hi,[a("div",{class:"increase",onClick:t[0]||(t[0]=d=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Xi]),a("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[a("div",Gi,[de(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=d=>{e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?($(),M("div",zi)):fe("",!0)]),a("div",Yi,[de(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=d=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=d=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=d=>{e.toCoinAmount=d,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?($(),M("div",Qi)):fe("",!0)])],2),a("div",Ji,[Zi,a("div",Ki,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?($(),M("div",Vi,E(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:Q(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:Q(Ue))(e.sliderVal,2))+"% ",1)):($(),M("div",xi," -- ")),a("div",ea,[($(!0),M(po,null,ho(e.ratioArr,(d,p)=>($(),M("div",{key:p,class:go(["ratio-item",e.sliderVal==d.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=d.value}},E(d.name),11,oa))),128))])]),de(v,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=d=>e.sliderVal=d)},null,8,["value"])])]),e.wallet.connected?($(),je(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Ye(()=>[a("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):($(),je(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[a("span",null,E(e.$t("button.connectWallet")),1)]),_:1}))])}const ta=Ze(Di,[["render",na]]),ia=Je({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=Uo(),i=A(()=>t),s=A(()=>i.value.status),R=Qe();Ae(()=>[i.value.targetGroups],p=>{console.log("0327###watch###newTargetGoups###",p)},{immediate:!0});const S=L(!1);Ae(()=>s.value,p=>{p=="authenticated",S.value=!1},{immediate:!0});const O=L(!1),v=async()=>{O.value=!O.value,console.log(O.value,"===>checked.value");const p={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},u=e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await t.subscribePosition(p,u,O.value)}catch{O.value=!O.value}},o=p=>{const u=p.sources;O.value=u.some(g=>JSON.parse(g.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(g.blockchainAddress).position_index)==Number(e.positionInfo.index))},d=uo();return console.log(d.currentRoute.value.query.token,"===>rouyter"),Ae(()=>[i.value.sourceGroups,e.positionInfo],([p,u])=>{var g,z,ne;console.log(p,"==>newSourceGroups169"),console.log(u,"===>positionInfo170"),O.value=!1,p&&p.length>0&&p[0]&&u&&!he(u)&&((ne=(z=(g=d==null?void 0:d.currentRoute)==null?void 0:g.value)==null?void 0:z.query)==null?void 0:ne.token)==(u==null?void 0:u.name)&&(console.log("触发"),console.log(p,"==>newSourceGroups"),console.log(u,"===>positionInfo"),o(p[0]))},{immediate:!0,deep:!0}),{importIcon:eo,isShowSetUp:S,changeSwitch:v,checked:O,notifiStatus:s,store:R}}});const aa=e=>(yo("data-v-8f838b7e"),e=e(),Ao(),e),sa={class:"range-alerts"},la={class:"range-alerts-top"},ua={class:"title"},ra=aa(()=>a("div",{class:"title-all"},[a("span",{class:"Range"},"Range Alerts")],-1)),da={key:1,class:"h5-switch-box"},ca={class:"range-alerts-bottom"},va={key:0,class:"pc-switch-box"};function ma(e,t,i,s,R,S){const O=ro,v=nn;return $(),M("div",sa,[a("div",la,[a("div",ua,[ra,e.isShowSetUp||e.notifiStatus!=="authenticated"?($(),je(O,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=on(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Ye(()=>[_e(" Set up ")]),_:1})):fe("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?($(),M("div",da,[de(v,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])]),a("div",ca,[_e(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?($(),M("div",va,[de(v,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])])}const Xo=Ze(ia,[["render",ma],["__scopeId","data-v-8f838b7e"]]),fa=Je({components:{NewPositionTitle:No,NewPositionInfo:Wo,NewPositionLiquidity:Ho,NewPositionAssetAdd:wo,NewPositionAssetRemove:wo,NewPositionNotifi:Xo},setup(){const e=L(),t=L(),i=L(),s=Qe(),R=A(()=>s),S=A(()=>R.value.chainName),O=no(),v=A(()=>O),o=uo();Bo(()=>{e.value={},O.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),v.value.setCurrentPositionLoading(!0)});const d=async()=>{v.value.setCurrentPositionLoading(!0);const c=o.currentRoute.value.query.token||"",q=o.currentRoute.value.query.collect||"",n=o.currentRoute.value.query.address||"",h=o.currentRoute.value.query.pos||"",_=o.currentRoute.value.query.id||"";S.value==="Aptos"?c&&q&&n&&v.value.setCurrentPositionInfo(n,q,c,S.value):(console.log("0414###position-detail###id#####",_),console.log("0414###position-detail###name#####",c),console.log("0414###position-detail###pool_address#####",n),console.log("0414###position-detail###pos#####",h),c&&n&&h?v.value.setCurrentPositionInfo(n,q,c,S.value,h):_&&v.value.setCurrentPositionInfo("","","",S.value,_))};Ae(()=>v.value.poolConfigObj,c=>{c&&!he(c)&&d()},{immediate:!0});const p=A(()=>v.value.currentPositionLoading),u=A(()=>{var q,n,h;const c=((h=(n=(q=o==null?void 0:o.currentRoute)==null?void 0:q.value)==null?void 0:n.query)==null?void 0:h.address)||"";return c&&v.value.addressLpTokens&&!he(v.value.addressLpTokens)&&v.value.addressLpTokens[c]?v.value.addressLpTokens[c]:null});Ae(()=>u.value,(c,q)=>{c&&!he(c)&&(e.value=c),c&&!he(c)&&c.current_sqrt_price!==(q==null?void 0:q.current_sqrt_price)&&d()},{immediate:!0});const g=lo();Ae(()=>[v.value.currentPositionInfo,S.value],([c,q])=>{var n;q=="Aptos"&&c?(e.value=c,t.value=e.value.token_a,i.value=e.value.token_b):q=="Sui"&&c&&(c==null?void 0:c.nftHash)==((n=g==null?void 0:g.query)==null?void 0:n.pos)&&(console.log(c,"==>newVal"),e.value=c,t.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const z=A(()=>v.value.positionDetailCurrentTab),ne=so(),ee=A(()=>ne),ce=A(()=>R.value.theme);return tn(()=>{ee.value.connected||(ce.value==="default"?o.push("/position"):o.push("/pool/position"))}),console.log(JSON.stringify(e.value),"===>positionInfo.value135"),{positionInfo:e,fromCoin:t,toCoin:i,getDetails:d,currentPositionLoading:p,positionDetailCurrentTab:z,clickRefresh:()=>{d()},chainName:S}}});const pa={class:"new-position-detail"},ha={class:"new-position-content"},ga={class:"left"},ba={class:"right"},ka={class:"loading-global"};function wa(e,t,i,s,R,S){const O=No,v=Wo,o=Ho,d=wo,p=ta,u=Xo,g=an;return $(),M("div",pa,[de(O,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),a("div",ha,[a("div",ga,[de(v),de(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),a("div",ba,[e.positionDetailCurrentTab=="increase"?($(),je(d,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):($(),je(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),de(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?($(),je(u,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):fe("",!0)])]),qe(a("div",ka,[de(g)],512),[[Lo,e.currentPositionLoading]])])}const Qa=Ze(fa,[["render",wa],["__scopeId","data-v-f85efb72"]]);export{Qa as default};
