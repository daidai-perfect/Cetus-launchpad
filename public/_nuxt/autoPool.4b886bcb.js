import{l as fo,R as To,a6 as ho}from"./entry.a6654d09.js";import{h as _,b as xo,j as wo,s as N,a as go}from"./sha256.91c60824.js";import{x as Bo,q as vo,y as ko,b as E,z as J,T as Ao,C as So,V as oo,u as Lo,a as bo,c as qo,p as ao}from"./pool.58e56ed3.js";import{D as e}from"./decimal.0bdeb344.js";function yo(i){const d={launchpad:_[i||"Sui"].launchpad,ido:_[i||"Sui"].ido,xcetus:_[i||"Sui"].xcetus,xcetus_dividends:_[i||"Sui"].xcetus_dividends,cetus_faucet:_[i||"Sui"].cetus_faucet,xtoken:_[i||"Sui"].xtoken,xtoken_dividends:_[i||"Sui"].xtoken_dividends,token_faucet:_[i||"Sui"].token_faucet,booster:_[i||"Sui"].booster,maker_bonus:_[i||"Sui"].maker_bonus,liquidity_stratefy:_[i||"Sui"].liquidity_stratefy,vaults:_[i||"Sui"].vaults,haedal:_[i||"Sui"].haedal,frams:_[i||"Sui"].frams},S={fullRpcUrl:localStorage.getItem(`${i}-currentRpclocal2`)||_[i||"Sui"].fullRpcUrl,simulationAccount:_[i||"Sui"].simulationAccount,cetus_config:_[i||"Sui"].cetus_config,clmm_pool:_[i||"Sui"].clmm_pool,integrate:_[i||"Sui"].integrate,deepbook:_[i||"Sui"].deepbook,deepbook_endpoint_v2:_[i||"Sui"].deepbook_endpoint_v2,aggregatorUrl:_[i||"Sui"].aggregatorUrl},p=new Bo(S),n=new vo(d,p),r=xo(),O=fo(()=>r);To(()=>{O.value.address&&(p.senderAddress=O.value.address)});const R=async()=>{console.log(n,"sdk###");const t=await n.Vaults.getVaultList();return console.log("result.data:",t.data),t&&t.data||[]},j=async t=>{const s=await n.Vaults.getVault(t);return console.log(s,"vault##"),{...s,quota_based_type:ko(s.quota_based_type).full_address}},u=async t=>{if(console.log(t,"###coinType"),p.senderAddress){const s=await n.ClmmSDK.fullClient.getBalance({owner:p.senderAddress,coinType:t});return s&&s.totalBalance}else return 0},o=t=>({transactionBlock:t,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}});return{getAutoPools:R,getLpBalance:u,getVault:async t=>{const s=await n.Vaults.getVault(t);return console.log(s,"vault##292"),s},deposit:async t=>{const{lowerTick:s,upperTick:g,slippage:b,rewarder_coin_types:v,isOnlyA:P,isOnlyB:h,currentTickIndex:f,decimal_b:I,request_id:T,staking_id:V,shouldRequestStake:C,farming_pool:$}=t;console.log(t,"params###");let l=t.fix_amount_a,c,a,Q,q=f;if(P||h){let w;try{w=await n.Vaults.calculateDepositSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:t.curSqrtPrice,fix_amount_a:t.fix_amount_a,input_amount:t.coinAmount,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,clmm_pool:t.clmm_pool,use_route:!0,priceSplitPoint:b,request_id:T,staking_id:V,shouldRequestStake:C},!0)}catch{w=await n.Vaults.calculateDepositSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:t.curSqrtPrice,fix_amount_a:t.fix_amount_a,input_amount:t.coinAmount,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,clmm_pool:t.clmm_pool,use_route:!1,priceSplitPoint:b,request_id:T,staking_id:V,shouldRequestStake:C},!0)}console.log(w,"swapResut##211"),w?(a=new E(w.afterSqrtPrice),c=w.fixAmountA===l?new E(J(t.coinAmount).sub(w.swapInAmount).toString()):new E(w.swapOutAmount),Q={swap_amount:w.swapInAmount,a2b:l,input_amount:t.coinAmount,route_obj:w.routeObj,staking_id:w.staking_id},l=w.fixAmountA,q=Ao.sqrtPriceX64ToTickIndex(new E(w.afterSqrtPrice))):(a=new E(t.curSqrtPrice),c=new E(t.coinAmount))}else a=t.curSqrtPrice,c=new E(t.coinAmount);let m,k,L;console.log(s,f,g,"####138"),q>=s&&q<=g?(m=So.estLiquidityAndcoinAmountFromOneAmounts(s,g,c,l,!0,b,a),k=l?c.toString():m.tokenMaxA.toString(),L=l?m.tokenMaxB.toString():c.toString()):q<s?(k=c.toNumber(),L=0):q>g&&(k=0,L=c.toNumber()),console.log({lowerTick:s,upperTick:g,vault_id:t.id,clmm_pool:t.clmm_pool,farming_pool:$,lp_token_type:t.lp_token_type,amount_a:k,amount_b:L,fix_amount_a:l,slippage:b,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,swapParams:Q},"params171");const X=await n.Vaults.deposit({lowerTick:s,upperTick:g,vault_id:t.id,clmm_pool:t.clmm_pool,lp_token_type:t.lp_token_type,amount_a:k,amount_b:L,fix_amount_a:l,slippage:b,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,swapParams:Q,farming_pool:$});return o(X)},remove:async t=>{const{lowerTick:s,upperTick:g,coinTypeA:b,coinTypeB:v,receiveAmount:P,clmm_pool:h,lowerSqrtPrice:f,upperSqrtPrice:I,fix_amount_a:T,curSqrtPrice:V,slippage:C,rewarder_coin_types:$,id:l,liquidity:c,swapParams:a,isOnlyA:Q,isOnlyB:q,sliderVal:m,positionInfo:k,maxLiquidity:L,request_id:X,farming_pool:w}=t;console.log(m,"sliderVal##");const F=await j(l),Y=await p.Pool.getPool(F.pool_id);let U,x,H,to,Z,K,D;const G=oo.get_share_liquidity_by_amount(F,m==100?k.balance:t.lpTokenAmount);if(console.log(P,"##receiveAmount"),Q||q){try{U=await n.Vaults.calculateRemoveSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:Y.current_sqrt_price,fix_amount_a:T,receive_amount:P,coinTypeA:b,coinTypeB:v,clmm_pool:h,use_route:!0,priceSplitPoint:C,removeLiquidity:m==100?G:"",maxLiquidity:L,request_id:X})}catch(eo){console.log(eo,"e251"),U=await n.Vaults.calculateRemoveSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:Y.current_sqrt_price,fix_amount_a:T,receive_amount:P,coinTypeA:b,coinTypeB:v,clmm_pool:h,use_route:!1,priceSplitPoint:C,removeLiquidity:m==100?G:"",maxLiquidity:L,request_id:X})}if(console.log(U,"swapResut###"),U){const eo=oo.get_share_liquidity_by_amount(F,k.balance);x=So.getCoinAmountFromLiquidity(new E(m==100?eo:U.liquidity),new E(Y.current_sqrt_price),f,I,!1),H=oo.get_protocol_fee_amount(F,x.coinA.toString()),to=oo.get_protocol_fee_amount(F,x.coinB.toString()),Z=m==100?k.balance:oo.get_lp_amount_by_liquidity(F,U.liquidity),K=J(x.coinA.toString()).mul(J(1-t.slippage)),D=J(x.coinB.toString()).mul(J(1-t.slippage)),console.log(K.toString(),"##minAmountA"),console.log(D.toString(),"##minAmountA")}}else console.log(G,"#removeLiquidity"),x=So.getCoinAmountFromLiquidity(new E(G),new E(Y.current_sqrt_price),f,I,!1),console.log(x,"#coinAmountscoinAmounts"),Z=t.lpTokenAmount,K=J(x.coinA.toString()).mul(J(1-t.slippage)),D=J(x.coinB.toString()).mul(J(1-t.slippage)),console.log(H,to,"##protocol_fee_amount_b"),console.log(K.toString(),"##minAmountA"),console.log(D.toString(),"##minAmountA"),console.log(t,"params###246");console.log(Z,"lpTokenAmount remove");const M={vault_id:t.id,clmm_pool:t.clmm_pool,lp_token_type:t.lp_token_type,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,lp_token_amount:Z,min_amount_a:wo(K,0)||"",min_amount_b:wo(D,0)||"",rewarder_coin_types:[],slippage:t.slippage,farming_pool:w};console.log(M,"##removeParams"),(Q||q)&&(M.swapParams={a2b:!T,swap_amount:U==null?void 0:U.swapInAmount,route_obj:U.routeObj});const W=await n.Vaults.remove(M);return o(W)},getAutoPool:j,calculateDepositSwapAmount:async t=>{const{lowerTick:s,upperTick:g,curSqrtPrice:b,fix_amount_a:v,input_amount:P,coinTypeA:h,coinTypeB:f,clmm_pool:I,slippage:T,decimals:V,request_id:C,staking_id:$,shouldRequestStake:l}=t;console.log(t,"params###");let c;try{c=await n.Vaults.calculateDepositSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:b,fix_amount_a:v,input_amount:P,coinTypeA:h,coinTypeB:f,clmm_pool:I,use_route:!0,priceSplitPoint:T,request_id:C,staking_id:$,shouldRequestStake:l},!0)}catch(a){if(console.log(a,"calculateDepositSwapAmount error"),String(a)=="Error: route unavailable"&&(console.log(a,"e432"),c=await n.Vaults.calculateDepositSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:b,fix_amount_a:v,input_amount:P,coinTypeA:h,coinTypeB:f,clmm_pool:I,use_route:!1,priceSplitPoint:T,request_id:C,staking_id:$,shouldRequestStake:l},!0)),String(a)=="Error: HaedalStakeSuiAmountError")return"HaedalStakeSuiAmountError"}if(console.log(c,"##swapResut"),c){const a=new e(c.swapOutAmount);return{...c,swapOutAmountLimit:N(a.sub(a.mul(T)).toNumber(),V)}}return c},calculateRemoveSwapAmount:async t=>{const{lowerTick:s,upperTick:g,curSqrtPrice:b,fix_amount_a:v,receiveAmount:P,coinTypeA:h,coinTypeB:f,clmm_pool:I,slippage:T,decimals:V,liquidity:C,maxLiquidity:$,request_id:l}=t;console.log(t,"params###");let c;try{c=await n.Vaults.calculateRemoveSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:b,fix_amount_a:v,receive_amount:P,coinTypeA:h,coinTypeB:f,clmm_pool:I,use_route:!0,priceSplitPoint:T,removeLiquidity:C,maxLiquidity:$,request_id:l})}catch(a){String(a)=="Error: route unavailable"&&(console.log(a,"e432"),c=await n.Vaults.calculateRemoveSwapAmount({lowerTick:s,upperTick:g,curSqrtPrice:b,fix_amount_a:v,receive_amount:P,coinTypeA:h,coinTypeB:f,clmm_pool:I,use_route:!1,priceSplitPoint:T,removeLiquidity:C,maxLiquidity:$,request_id:l}))}if(console.log(c,"###swapResut calculateRemoveSwapAmount"),c){const a=new e(c.swapOutAmount);return console.log(a.toNumber(),"swapOutAmount.toNumber()"),{...c,swapOutAmountLimit:N(a.sub(a.mul(T)).toNumber(),V)}}return c}}}const Oo=ho("autoPool",{state:()=>({autoPoolList:[],autoPoolObj:{},positionInfoObj:{},positionInfoList:[],positionUSDObj:{},apyObj:{},currentAutoPoolStatus:"STATUS_RUNNING",slippage:localStorage.getItem("cetus-auto-slippage")||"0.1",autoPoolLoading:!1}),getters:{getPoolStore(){return Lo()}},actions:{async getAutoPoolList(){const d=await yo("Sui").getAutoPools();console.log(d,"list###");const S=this.getPoolStore,p=_.Sui.vaultFilter,{data:n}=await fetch(`${_.Sui.api}/v2/sui/auto_pools`).then(u=>u.json());console.log(n,"data##37");const r=(n==null?void 0:n.pools)||[],O=d.filter(u=>r.some(o=>o.object_id===u.id)),R=_.Sui.haedal.config.support_stakings;console.log("supportStakingsList:",R),console.log(O,"##openPoolList");const j=(p?O:d).map(u=>{var A;const o=S.poolConfigObj[u.pool_id];console.log("autoPoolList map",u,o);const y=[o!=null&&o.needReverse?o==null?void 0:o.coin_b_address:o==null?void 0:o.coin_a_address,o!=null&&o.needReverse?o==null?void 0:o.coin_a_address:o==null?void 0:o.coin_b_address];return o==null||o.rewarderInfo.forEach(B=>{B.emissionsEveryDay>0&&y.push(B.coinAddress)}),(A=o==null?void 0:o.stable_farming)==null||A.stable_rewarder.forEach(B=>{B.amount_second>0&&y.push(B.coin)}),{...o,id:u.id,lp_token_type:u.lp_token_type,autoPoolPositionInfo:u.position,is_pause:u.is_pause,total_supply:u.total_supply,liquidity:u.liquidity,protocol_fee_rate:u.protocol_fee_rate,max_quota:u.max_quota,staking_id:u.staking_id,quota_based_type:ko(u.quota_based_type).full_address,supportHaedalStake:R.filter(B=>B.staking_id==u.staking_id).length>0,isTokenA:o!=null&&o.needReverse?(o==null?void 0:o.coin_b_address)=="0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":(o==null?void 0:o.coin_a_address)=="0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",rewardList:Array.from(new Set(y))}});this.autoPoolList=j,this.autoPoolObj=Object.fromEntries(j.map((u,o)=>[u.address,u])),this.getMyAutoPoolPosition(),console.log(j,"##autoPoolList")},async getMyAutoPoolPosition(){var r,O,R,j;const i=yo("Sui"),d=this.autoPoolList,S=bo("Sui"),p=[],{RATES:n}=this.getPoolStore;for(let u=0;u<d.length;u++){const o=d[u];console.log(o,"poolINfo###");const y=await S.getPool(o.address),A=await i.getLpBalance(d[u].lp_token_type);console.log(A,"balance##");const B=(await S.getTokenListByCoinType([d[u].lp_token_type]))[0];console.log(B,"lpInfo##");const io=((r=n[o.coinA.address])==null?void 0:r.price)||"",z=((O=n[o.coinB.address])==null?void 0:O.price)||"",t=o.autoPoolPositionInfo.tick_lower_index,s=o.autoPoolPositionInfo.tick_upper_index,g=Number(A)>0?oo.get_share_liquidity_by_amount({liquidity:o==null?void 0:o.liquidity,total_supply:o==null?void 0:o.total_supply},A):0,b={tick_lower_index:t,tick_upper_index:s,current_sqrt_price:y==null?void 0:y.current_sqrt_price,liquidity:g};console.log(o,"poolInfo##94");const v=await S.getCoinAmountFromLiquidity({pool:{...o,current_sqrt_price:y==null?void 0:y.current_sqrt_price},position:b,roundUp:!1});console.log(v,"##amountInfo");const P=v.coinaAmount,h=v.coinbAmount,f=P,I=h,T=o.coinA.decimals,V=o.coinB.decimals,C=S.TickMath.tickIndexToPrice(Number(t),T,V).toString(),$=S.TickMath.tickIndexToPrice(Number(s),T,V).toString(),l=new e(io).mul(new e(P)).toNumber(),c=new e(z).mul(new e(h)).toNumber(),a=l>0&&l<.01?"<$0.01":`$${go(N(l,2))}`,Q=c>0&&c<.01?"<$0.01":`$${go(N(c,2))}`,q=Ao.sqrtPriceX64ToPrice(y.current_sqrt_price,T,V),m=await S.getCoinAmountFromLiquidity({pool:{...o,tick_lower_index:t,tick_upper_index:s,current_sqrt_price:y==null?void 0:y.current_sqrt_price},position:{...b,liquidity:o.liquidity},roundUp:!1}),k=new e(m.coinaAmount).toNumber(),L=new e(m.coinbAmount).toNumber();console.log(k,L,q.toString(),"###116");const X=N(new e(k).mul(new e(io)).toNumber(),2),w=N(new e(L).mul(new e(z)).toNumber(),2);console.log(y,"newPool##"),console.log(k,L,io,z,Number(X)+Number(w),"###poolCoinBNum");const{ratioA:F,ratioB:Y}=oo.calculateDepositRatio(t,s,new E.BN(y==null?void 0:y.current_sqrt_price));console.log(F,Y.toString(),"###139");const U=F.mul(100).toNumber().toFixed(0),x=100-Number(U);console.log(k,L,U,x,"###147");let H=0;Number(A)>0&&(H=new e(A).div(Math.pow(10,B.decimals)));const to=new e(l).add(new e(c)).toNumber(),Z=io&&z?to>0&&to<.01?"<0.01":N(new e(l).add(new e(c)).toString(),2):"--",K=o.total_supply;let D=0;H>0&&K>0&&(D=new e(H).mul(Math.pow(10,B.decimals)).div(new e(K)).mul(100).toNumber()),console.log(D,"##myShare");const G=new e(1).div(Math.pow(10,o.decimals)).toNumber();let M=0;if(D>1)M=N(D,2);else if(D>0&&D<G)M=`<${G}`;else if(D==0)M=0;else{const lo=qo(D),_o=lo==-1?2:lo+2;M=N(D,_o)}console.log(A,H.toString(),"###balance");const W=(await S.getTokenListByCoinType([o.quota_based_type]))[0],eo=ao(o.max_quota,W.decimals);console.log(o.quota_based_type,W,eo,"##quoteCoinInfo");const uo=W.address==o.coin_b_address,co=uo?new e(m.coinaAmount).mul(o.price).add(m.coinbAmount):new e(m.coinaAmount).mul(1/o.price).add(m.coinbAmount),po=((R=n[W.address])==null?void 0:R.price)||"",no=co.mul(new e(po)).toNumber();console.log(uo,no,"#isQuotaCoin");const so=eo,mo=uo?new e(m.coinaAmount).mul(o.price).add(m.coinbAmount):new e(m.coinaAmount).mul(1/o.price).add(m.coinbAmount),ro=new e(so).sub(mo).mul(z).toNumber();console.log(ro,"remainingTokenUSD##"),console.log(co.toNumber(),"#poolTokenNum"),this.positionInfoObj[o.id]={tick_lower_index:t,tick_upper_index:s,current_sqrt_price:y.current_sqrt_price,myLiquidity:ao(A,B.decimals),amountA:f,amountB:I,...o,lpInfo:B,myAmountAUSD:a,myAmountBUSD:Q,myLiquidityUSD:Z,myShare:M,minPrice:C,maxPrice:$,poolCoinARatio:U,poolCoinBRatio:x,poolCoinANum:k,poolCoinBNum:L,poolCoinAUSD:X,poolCoinBUSD:w,quoteUSD:so,poolUSD:no,balance:A,quoteCoinInfo:W,remainingTokenUSD:ro,currentDeposit:no,positionLiquidity:g},p.push({tick_lower_index:t,tick_upper_index:s,current_sqrt_price:(j=o==null?void 0:o.object)==null?void 0:j.current_sqrt_price,myLiquidity:ao(A,B.decimals),amountA:f,amountB:I,...o,lpInfo:B,myAmountAUSD:a,myAmountBUSD:Q,myLiquidityUSD:Z,myShare:M,minPrice:C,maxPrice:$,poolCoinARatio:U,poolCoinBRatio:x,poolCoinANum:k,poolCoinBNum:L,poolCoinAUSD:X,poolCoinBUSD:w,quoteUSD:so,poolUSD:no,balance:A})}this.positionInfoList=p,console.log(this.positionInfoObj,"this.positionInfoObj###"),console.log(this.positionInfoList,"###this.positionInfoList")},async updatePositionItem(i){var co,po,no,so,mo,ro,lo;const d=yo("Sui"),S=bo("Sui"),p=await d.getAutoPool(i),n=await S.getPool(p.pool_id);console.log("newPoolInfo:",p),console.log("newPool:",n),console.log("this.positionInfoObj[id]:",this.positionInfoObj[i]);const r={...this.positionInfoObj[i],autoPoolPositionInfo:p.position,...n},O=await d.getLpBalance(r.lp_token_type);console.log(O,"updatePositionItem lp balance");const R=(await S.getTokenListByCoinType([r.lp_token_type]))[0];console.log(O,"###balance updatePositionItem");const j=r.autoPoolPositionInfo.tick_lower_index,u=r.autoPoolPositionInfo.tick_upper_index;let o;p.total_supply==0?o=0:o=oo.get_share_liquidity_by_amount(p,String(O)),console.log(o,"##liquidity");const y={tick_lower_index:j,tick_upper_index:u,current_sqrt_price:n.current_sqrt_price,liquidity:o},A=S.getCoinAmountFromLiquidity({pool:{current_sqrt_price:n.current_sqrt_price,...r},position:y,roundUp:!1}),B=A.coinaAmount,io=A.coinbAmount,{RATES:z}=this.getPoolStore,t=p.total_supply,s=Ao.sqrtPriceX64ToPrice(n.current_sqrt_price,(co=r==null?void 0:r.coinA)==null?void 0:co.decimals,(po=r==null?void 0:r.coinB)==null?void 0:po.decimals),g=2,b=2,v=((so=z[(no=r==null?void 0:r.coinA)==null?void 0:no.address])==null?void 0:so.price)||0,P=((ro=z[(mo=r==null?void 0:r.coinB)==null?void 0:mo.address])==null?void 0:ro.price)||0,h=new e(v).mul(new e(A==null?void 0:A.coinaAmount)).toNumber(),f=new e(P).mul(new e(A==null?void 0:A.coinbAmount)).toNumber(),I=h>0&&h<.01?"<$0.01":`$${go(N(h,2))}`,T=f>0&&f<.01?"<$0.01":`$${go(N(f,2))}`;let V=new e(0);Number(O)>0&&(V=new e(O).div(Math.pow(10,R==null?void 0:R.decimals)));const C=new e(h).add(new e(f)).toNumber(),$=v&&P?C>0&&C<.01?"<0.01":N(new e(h).add(new e(f)).toString(),2):"--";let l=0;V.toNumber()>0&&t>0&&(l=new e(V).mul(Math.pow(10,R.decimals)).div(new e(t)).mul(100).toNumber()),console.log(l,"##myShare");const c=new e(1).div(Math.pow(10,r.decimals)).toNumber();let a=0;if(l>1)a=N(l,2);else if(l>0&&l<c)a=`<${c}`;else if(l==0)a=0;else{const _o=qo(l),Po=_o==-1?2:_o+2;a=N(l,Po)}const Q=Ao.sqrtPriceX64ToPrice(n.current_sqrt_price,g,b),q=await S.getCoinAmountFromLiquidity({pool:{...r,tick_lower_index:j,tick_upper_index:u,current_sqrt_price:n==null?void 0:n.current_sqrt_price},position:{...y,liquidity:p.liquidity},roundUp:!1}),m=new e(q.coinaAmount).toNumber(),k=new e(q.coinbAmount).toNumber();console.log(m,k,Q.toString(),"###116");const L=N(new e(m).mul(new e(v)).toNumber(),2),X=N(new e(k).mul(new e(P)).toNumber(),2);console.log(n,"newPool##"),console.log(m,k,v,P,Number(L)+Number(X),"###poolCoinBNum");const{ratioA:w,ratioB:F}=oo.calculateDepositRatio(j,u,new E.BN(n==null?void 0:n.current_sqrt_price));console.log(w,F.toString(),"###139");const Y=w.mul(100).toNumber().toFixed(0),U=100-Number(Y),x=(await S.getTokenListByCoinType([p.quota_based_type]))[0],H=ao(p.max_quota,x.decimals);console.log(p.quota_based_type,x,H,"##quoteCoinInfo");const to=x.address==r.coin_b_address,Z=to?new e(q.coinaAmount).mul(r.price).add(q.coinbAmount):new e(q.coinaAmount).mul(1/r.price).add(q.coinbAmount),K=((lo=z[x.address])==null?void 0:lo.price)||"",D=Z.mul(new e(K)).toNumber(),G=H,M=to?new e(q.coinaAmount).mul(r.price).add(q.coinbAmount):new e(q.coinaAmount).mul(1/r.price).add(q.coinbAmount),W=new e(G).sub(M).mul(P).toNumber();console.log(W,"remainingTokenUSD##");const eo=S.TickMath.tickIndexToPrice(Number(j),g,b).toString(),uo=S.TickMath.tickIndexToPrice(Number(u),g,b).toString();this.positionInfoObj[i]={...r,tick_lower_index:j,tick_upper_index:u,current_sqrt_price:n.current_sqrt_price,myLiquidity:ao(O,R==null?void 0:R.decimals),amountA:B,amountB:io,myShare:a,myAmountAUSD:I,myAmountBUSD:T,myLiquidityUSD:$,poolCoinARatio:Y,poolCoinBRatio:U,poolCoinANum:m,poolCoinBNum:k,poolCoinAUSD:L,poolCoinBUSD:X,quoteUSD:G,balance:O,price:s,quoteCoinInfo:x,remainingTokenUSD:W,currentDeposit:D,poolUSD:D,positionLiquidity:o,liquidity:p==null?void 0:p.liquidity,minPrice:eo,maxPrice:uo},this.autoPoolLoading=!1,console.log(this.positionInfoObj[i],"###this.positionInfoObj[id]")},async getAutoPoolAPY(){try{const{data:i}=await fetch(`${_.Sui.api}/v2/sui/auto_pools`).then(d=>d.json());i&&i.pools&&i.pools.length>0&&(this.apyObj=Object.fromEntries(i.pools.map((d,S)=>[d.object_id,{...d,apr:d.apr.replace("%","")>0&&d.apr.replace("%","")<.01?"<0.01%":N(d.apr.replace("%",""),2)+"%",resultApr:d.apr.replace("%","")}])),console.log(this.apyObj,"data##"))}catch{this.apyObj={}}},async getVault(i,d){const S=yo("Sui");d||(this.autoPoolLoading=!0);const{status:p}=await S.getVault(i);this.currentAutoPoolStatus=p,this.updatePositionItem(i),console.log(p,"status##")},setSlippage(i){console.log(i,"slippage##"),this.slippage=i,localStorage.setItem("cetus-auto-slippage",i)},logout(){this.getMyAutoPoolPosition(),this.positionUSDObj={}}}});export{yo as a,Oo as u};
