import{_ as re}from"./upgrade-select-input.340cedb9.js";import{_ as ue}from"./upgrade-loading.04a62a42.js";import{_ as ie}from"./upgrade-position-item.19406a72.js";import{a as ce,r as p,y as de,b as me,l as m,q as $,H as ve,K as pe,Q as ge,X as he,e as be,o as l,f as n,h as v,F as j,E as V,x as A,i as I,z as K,v as w,A as M,j as H,w as fe,B as _e,c as ye,p as ke,k as Le}from"./entry.2356a469.js";import{u as Se,a as Ae,c as we}from"./sha256.0b273565.js";import{u as Te}from"./notifi.6e8e1ba3.js";import{u as Pe,c as Oe}from"./pool.bb70887e.js";import{i as Q}from"./import-icon.de3e6c66.js";import{_ as X}from"./icon_on_2x.5e96733d.js";import{_ as Ue,a as $e}from"./img-no-Positions_2x.699e9e30.js";import{_ as Re,a as Be}from"./img-connect-wallet_2x.f40ec36c.js";import"./coin-select.09f4c5b4.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";import"./status-block.c845c5bb.js";import"./decimal.0bdeb344.js";import"./icon-arrow_2x.948aedb2.js";import"./icon-arrow_2x.4ffddb8e.js";import"./useWhale.40c71e88.js";import"./index.128f5049.js";const Ce=ce({setup(){const o=p(!1),{t:u}=de(),W=p(["position"]),P=me(),q=p(""),R=Se(),g=m(()=>R),E=m(()=>g.value.chainName?we[g.value.chainName]:{});let i=p([]);const _=Pe(),a=m(()=>_),y=Ae(),h=m(()=>y),D=p(!1),O=p(u("tab.all")),G=p([u("tab.layerZero"),u("tab.wormhole"),u("tab.celer")]),B=p(!0),Y=p("TVL"),z=()=>{o.value=!0,i.value=[],h.value.address&&_.getMyPositons(h.value.address,a.value.poolsObj,g.value.chainName),setTimeout(()=>{o.value=!1},1e3)},x=m(()=>{const s=Array.from(new Set(a.value.poolConfigList.flatMap(e=>!e.category||e.category==""?"All":e.category)));return console.log(s,"newArr"),s.length<=1?[]:s}),ee=s=>{a.value.setCurrentPoolTab(s)};$(()=>g.value.isRefresh,s=>{var e;s&&((e=P==null?void 0:P.currentRoute)==null?void 0:e.value.name.split("-")[1])=="position"&&z()}),ve(()=>{i.value=[],document.addEventListener("click",()=>{D.value=!1}),_.setMyPositionsLoading(!0)}),pe(()=>{document.addEventListener("click",()=>{D.value=!1})}),ge(()=>{h.value.connected||(i.value=[])});const F=()=>{o.value=!0;let s=[];a.value.myPositions.forEach(e=>{var f,T,C,N;let t,r;const c=e.amountA*((f=a.value.RATES[e.token_a.address])==null?void 0:f.price),d=e.amountB*((T=a.value.RATES[e.token_b.address])==null?void 0:T.price);(C=a.value.RATES[e.token_a.address])!=null&&C.price&&((N=a.value.RATES[e.token_b.address])!=null&&N.price)?(t=c+d,r=c+d):(t=" --",r=0),console.log(a.value.currentPoolTab,"##pools.value.currentPoolTab"),(a.value.currentPoolTab=="All"||a.value.currentPoolTab!=="All"&&e.category==a.value.currentPoolTab)&&s.push({...e,amountUSD:t,amountUSDOrigin:r,tokenARates:c,tokenBRates:d})}),O.value!="All"?B.value?(i.value=s.sort((e,t)=>Number(t.amountUSDOrigin)-Number(e.amountUSDOrigin)),o.value=!1):(i.value=s.sort((e,t)=>Number(e.amountUSDOrigin)-Number(t.amountUSDOrigin)),o.value=!1):B.value?(i.value=s.sort((e,t)=>t.amountUSDOrigin-e.amountUSDOrigin),o.value=!1):(i.value=s.sort((e,t)=>e.amountUSDOrigin-t.amountUSDOrigin),o.value=!1),console.log(i.value,"list.value========>")};$(()=>[a.value.myPositions,a.value.RATES],([s,e])=>{s&&e&&(console.log("0605==>updateLpList9099999"),F())},{immediate:!0}),$(()=>[h.value.address,a.value.poolConfigList,a.value.poolsObj,g.value.chainName],([s,e,t,r])=>{var c,d,f;s&&e&&e.length>0&&r&&(r!=null&&r.toLowerCase().includes((c=e[0])==null?void 0:c.chain))&&!Oe(t)&&(r==="Aptos"?e.length===Object.values(t).length:(f=(d=Object.values(t)[0])==null?void 0:d.chain)!=null&&f.includes("sui"))&&(console.log(t,e,"0605==>getMyPositons9099999"),_.getMyPositons(h.value.address,t,r))},{immediate:!0,deep:!0}),$(()=>[O.value,B.value,a.value.currentPoolTab],([s])=>{F()});const oe=s=>{const e=[];G.value.forEach((t,r)=>{t==s?e[r]=O.value:e[r]=t}),G.value=e,O.value=s},U=Te(),b=m(()=>U),J=m(()=>_),se=async s=>{await U.getSourceGroups();const e=b.value.sourceGroups&&b.value.sourceGroups.length>0&&b.value.sourceGroups[0]&&b.value.sourceGroups[0].sources||[];for(let t=0;t<e.length;t++){const{pool_address:r,position_index:c}=JSON.parse(e[t].blockchainAddress);let d=!1,f;for(let T=0;T<s.length;T++){const{poolAddress:C,index:N}=s[T];r==C&&Number(N)==Number(c)&&(d=!0),f={pool_address:r,position_index:c}}d||await U.subscribePosition(f,"",!1,!1)}},te=async()=>{await U.getSourceGroups();const s=b.value.sourceGroups&&b.value.sourceGroups.length>0&&b.value.sourceGroups[0]&&b.value.sourceGroups[0].sources||[];for(let e=0;e<s.length;e++){const{pool_address:t,position_index:r}=JSON.parse(s[e].blockchainAddress),{name:c}=s[e],d={pool_address:t,position_index:r};await U.subscribePosition(d,c,!1,!1)}},ae=m(()=>J.value.myPositionsLoading);$(()=>J.value.myPositions,(s,e)=>{E.value.hasNotifi&&(s&&s.length>0&&e&&e.length!==s.length?se(s):s&&s.length==0&&!ae.value&&te())},{immediate:!0});const le=s=>{var e;return(s==null?void 0:s.logoURI)||(s==null?void 0:s.logo_url)||((e=a.value.tokensObj[s==null?void 0:s.address])==null?void 0:e.logo_url)||(g.value.theme==="default"?Q("/image/coins/unknown.png"):Q("/image/coins/sui-unknown.png"))},k=p(null),L=m(()=>k.value&&k.value.firstToken?k.value.firstToken:null),S=m(()=>k.value&&k.value.lastToken?k.value.lastToken:null),ne=m(()=>{let s=[];s=i.value;const e=s.filter((t,r)=>L.value&&S.value?t.coinA.symbol==L.value.symbol&&t.coinB.symbol==S.value.symbol||t.coinA.symbol==S.value.symbol&&t.coinB.symbol==L.value.symbol:L.value?t.coinA.symbol.toLowerCase().includes(L.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(L.value.symbol.toLowerCase()):S.value?t.coinA.symbol.toLowerCase().includes(S.value.symbol.toLowerCase())||t.coinB.symbol.toLowerCase().includes(S.value.symbol.toLowerCase()):s);return a.value.myPositionsLoading||R.setPositiomAmount(e.length),e});return he(()=>{R.setPositiomAmount("--")}),{tabArr:x,changeTab:ee,showList:ne,childTokenSelectRef:k,firstToken:L,lastToken:S,getCoinIcon:le,changeSortLabel:oe,label:D,labelList:G,labelValue:O,select:B,selectValue:Y,t:u,pools:a,store:g,wallet:h,list:i,clickRefresh:z,refresh:o,current:W,router:P,searchKey:q}}});const Z=o=>(ke("data-v-51c1fc0d"),o=o(),Le(),o),Ne={class:"upgrade-position-list-container"},Ee={class:"content-top"},De={class:"content-top-left"},Ge={key:0,class:"tag-list"},je=["onClick"],Ve={class:"content-top-right"},Ie={class:"value"},We=Z(()=>v("use",{"xlink:href":"#icon-icon_on"},null,-1)),qe=[We],ze={key:0,class:"select-item"},Fe=["onClick"],Je={class:"search-select-box"},Ke=Z(()=>v("span",null,"TVL",-1)),Me={key:0,src:X,alt:""},He={key:1,class:"fan-img",src:X,alt:""},Qe={key:0,class:"upgrade-loading"},Xe={key:1,class:"position-list"},Ze={key:2,class:"no-data"},Ye={key:0,src:Ue,alt:""},xe={key:1,src:$e,alt:""},eo={key:3,class:"no-data"},oo={key:0,src:Re,alt:""},so={key:1,src:Be,alt:""};function to(o,u,W,P,q,R){const g=re,E=ue,i=ie,_=_e;return l(),n("div",Ne,[v("div",Ee,[v("div",De,[o.tabArr.length>1?(l(),n("div",Ge,[(l(!0),n(j,null,V(o.tabArr,(a,y)=>(l(),n("div",{key:y,class:M(["tag-item",a==o.pools.currentPoolTab?`tag-active tab-num-${o.tabArr.length}`:`tab-num-${o.tabArr.length}`]),onClick:h=>o.changeTab(a)},w(a),11,je))),128))])):A("",!0),I(g,{ref:"childTokenSelectRef"},null,512)]),v("div",Ve,[o.store.theme=="default"?(l(),n("div",{key:0,class:"search-label",onClick:u[0]||(u[0]=K(a=>o.label=!o.label,["stop"]))},[v("span",null,w(o.$t("newAdd.label")),1),v("div",Ie,w(o.labelValue),1),(l(),n("svg",{"aria-hidden":"true",class:M(o.label?"show-icon icon":"icon")},qe,2)),o.label?(l(),n("div",ze,[(l(!0),n(j,null,V(o.labelList,(a,y)=>(l(),n("div",{key:y,class:"select-menu-item",onClick:h=>o.changeSortLabel(a)},w(a),9,Fe))),128))])):A("",!0)])):A("",!0),v("div",Je,[v("div",{class:"search-select",onClick:u[1]||(u[1]=K(a=>o.select=!o.select,["stop"]))},[H(w(o.$t("newAdd.sortBy"))+" ",1),v("div",null,[Ke,o.select?(l(),n("img",Me)):(l(),n("img",He))])])])])]),o.pools.myPositionsLoading&&o.wallet.connected?(l(),n("div",Qe,[I(E,{loading:o.pools.myPositionsLoading,type:"position"},null,8,["loading"])])):A("",!0),o.showList&&o.showList.length>0&&o.wallet.connected&&!o.pools.myPositionsLoading?(l(),n("div",Xe,[(l(!0),n(j,null,V(o.showList,(a,y)=>(l(),ye(i,{key:y,"p-item":a},null,8,["p-item"]))),128))])):A("",!0),o.showList&&o.showList.length<=0&&!o.pools.myPositionsLoading&&o.wallet.connected?(l(),n("div",Ze,[o.store.theme=="default"?(l(),n("img",Ye)):(l(),n("img",xe)),v("span",null,w(o.$t("common.noLiquidityPositions")),1)])):A("",!0),o.wallet.connected?A("",!0):(l(),n("div",eo,[o.store.theme=="default"?(l(),n("img",oo)):(l(),n("img",so)),I(_,{class:"connect-wallet",onClick:u[2]||(u[2]=a=>o.wallet.setIsShowWalletModal(!0))},{default:fe(()=>[H(w(o.$t("button.connectWallet")),1)]),_:1})]))])}const Oo=be(Ce,[["render",to],["__scopeId","data-v-51c1fc0d"]]);export{Oo as default};
