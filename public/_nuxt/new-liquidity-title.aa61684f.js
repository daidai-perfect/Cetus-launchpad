import{_ as ce}from"./token-warning.f7842a11.js";import{a as O,z as de,c as x,y as le,e as pe,d as re}from"./common.831588b7.js";import{a as ee,z as ge,m as d,a2 as _e,a3 as be,r as R,A as J,L as te,e as oe,C as he,o as u,f as $,h as n,c as E,x as k,y as Q,I as ke,G as M,i as Z,w as W,u as K,j as H,K as ye,O as Ce,S as Se,B as we,a4 as $e,p as me,k as fe,N as ue,P as Pe,q as Ie,s as Te,b as Ae}from"./entry.81366e87.js";import"./index.ca5a11a6.js";/* empty css              *//* empty css              */import{i as X}from"./import-icon.de3e6c66.js";import{u as Ne,b as Y}from"./index.3a5cc2eb.js";import{u as ne,a as ae,b as Oe}from"./index.ab348efd.js";import{D as h}from"./decimal.765d8738.js";import{u as Re}from"./useDebounceFunction.838360ca.js";/* empty css              */import"./decimal.a2826370.js";import{_ as je}from"./swap-setting.ac3e2f84.js";const Be=ee({components:{TokenWarning:ce},props:{inputValue:{type:String,default:""},inputDisabled:{type:Boolean,default:!1},coinName:{type:String,default:""},coinSymbol:{type:String,default:""},balance:{type:Number,default:null},coinIcon:{type:String,default:""},havemax:{type:Boolean,default:!0},hasArrow:{type:Boolean,default:!0},isTotal:{type:Boolean,default:!1},importPage:{type:String,default:""},address:{type:String,default:""}},setup(e,s){const{t:y,locale:j}=ge(),m=ne(),c=d(()=>m),o=d(()=>new h(Number(e.balance)).div(2)),f=_e(be,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});function P(){this.$emit("onSelect")}const N=Re(t=>{s.emit("onInput",t),s.emit("onInputLoading",!1)},500),g=R(""),L=t=>{const i=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${(l==null?void 0:l.value)&&(l==null?void 0:l.value)}})?).*$`),w=t.target.value.replace(/,/g,"").replace(i,"$1");s.emit("onInputLoading",!0),N(w)},v=t=>{var se;const i=t.target.selectionStart,w=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${(l==null?void 0:l.value)&&(l==null?void 0:l.value)}})?).*$`);console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ event.target.value:",t.target.value);let r=t.target.value.replace(/,/g,"").replace(w,"$1");console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ value:",r);let b=r.includes(".")&&String(O(r))==="0"?r:String(O(r));const A=le(t.target.value),B=le(b),G=B.length-A.length;let z=i+G;if((se=t==null?void 0:t.inputType)!=null&&se.includes("delete")&&G>0&&i===B[B.length-1]){const ve=t.target.value.slice(0,i-1)+t.target.value.slice(i);b=String(O(ve.replace(/,/g,""))),z=z-2}console.log("ðŸš€ ~ file: assets-card.vue:287 ~ handleInput ~ fValue:",b),g.value=b,setTimeout(()=>{t.target.setSelectionRange(z<0?0:z,z<0?0:z)},0)};J(()=>e.inputValue,t=>{console.log("ðŸš€ ~ file: assets-card.vue:287 ~ setup ~ newValue:",t);const i=t.includes(".")&&String(O(t))==="0"?t:String(O(t));console.log("ðŸš€ ~ file: assets-card.vue:287 ~ setup ~ fValue:",i),console.log("ðŸš€ ~ file: assets-card.vue:287 ~ setup ~ addCommom(newValue):",O(t)),i!==g.value&&(g.value=i)},{immediate:!0});const p=Ne(),C=d(()=>p),F=ae(),a=d(()=>F),D=d(()=>a.value.tokensWarningObj);let _=R({});J(()=>a.value.RATES,t=>{t&&(_.value=t)},{immediate:!0,deep:!0});const V=d(()=>{var t,i,w;return pe(Number(e.inputValue)*Number((_==null?void 0:_.value)&&((t=_==null?void 0:_.value)==null?void 0:t[e.address])&&((w=(i=_==null?void 0:_.value)==null?void 0:i[e.address])==null?void 0:w.price)),2)}),q=d(()=>{var t,i;return a.value.tokensObj&&e.address&&a.value.tokensObj[e.address]&&((t=a.value.tokensObj[e.address])==null?void 0:t.labels)&&((i=a.value.tokensObj[e.address])==null?void 0:i.labels[0])}),l=d(()=>{var t;return a.value.tokensObj&&e.address&&a.value.tokensObj[e.address]&&((t=a.value.tokensObj[e.address])==null?void 0:t.decimals)}),U=d(()=>{var t,i,w,r;return e.coinIcon||((i=(t=a==null?void 0:a.value)==null?void 0:t.tokensObj[e.address])==null?void 0:i.logo_url)||((r=(w=a==null?void 0:a.value)==null?void 0:w.tokensObj[e.address])==null?void 0:r.logoURI)||(c.value.theme==="default"?X("/image/coins/unknown.png"):X("/image/coins/sui-unknown.png"))}),I=d(()=>a.value.tokensObj),S=d(()=>c.value.theme);return{route:te(),theme:S,currentIcon:U,tokensObj:I,pool:a,halfBalance:o,coinLabels:q,t:y,addCommom:O,store:c,wallet:C,indicator:f,inputChange:L,importIcon:X,selectCoin:P,amountPirce:V,coinDecimals:l,formatNumber:de,tokensWarningObj:D,checkNullObj:x,handleInput:v,formattedValue:g}}});const Le=e=>(me("data-v-2cb78902"),e=e(),fe(),e),Ve={class:"card"},qe={class:"top"},Fe={key:1,class:"input-div"},Me={key:0},De={class:"loading-token"},ze={key:1},Ee={key:0},Ue=Le(()=>n("use",{"xlink:href":"#icon-icon_on"},null,-1)),We=[Ue],He={class:"bottom"},Ge={key:0,class:"amount-price"},Ke={key:1},Je={class:"top"},Qe={class:"right"},Xe={class:"balance"};function Ye(e,s,y,j,m,c){const o=ye,f=Ce,P=$e,N=ce,g=Se,L=we,v=he("image");return u(),$("div",Ve,[n("div",qe,[e.inputDisabled?(u(),$("div",Fe,[e.inputValue?(u(),$("span",Me,k(e.inputValue),1)):(u(),E(f,{key:1,indicator:e.indicator},null,8,["indicator"]))])):(u(),E(o,{key:0,value:e.inputValue=="InsufficientLiquidity"?"":e.formattedValue,placeholder:"0.0",disabled:e.inputDisabled,onChange:e.inputChange,onInput:e.handleInput,onFocus:s[0]||(s[0]=p=>e.$emit("onFocus"))},null,8,["value","disabled","onChange","onInput"])),n("div",{class:Q(["left",[e.hasArrow?"":"nohands",e.route.name=="swap"?"left-opcity":""].join("")]),onClick:s[1]||(s[1]=p=>e.pool.isTokenLoading?"":e.selectCoin())},[n("div",De,[e.pool.isTokenLoading?(u(),E(P,{key:0,active:"",size:"small",paragraph:!1})):e.address?ke((u(),$("img",ze,null,512)),[[v,e.currentIcon]]):M("",!0),Z(N,{address:e.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"0px"}},null,8,["address"]),Z(g,{loading:e.pool.isTokenLoading,class:"loading-token-skeleton",active:"",paragraph:!1},{default:W(()=>[n("div",null,[n("p",null,k(e.coinSymbol?e.coinSymbol:e.$t("modal.selectTokenModalTitle")),1),e.coinLabels?(u(),$("p",Ee,k(e.coinLabels),1)):M("",!0)])]),_:1},8,["loading"])]),e.hasArrow?(u(),$("svg",{key:0,class:Q(["icon",e.pool.isTokenLoading?"loading-drop-icon":""]),"aria-hidden":"true"},We,2)):M("",!0)],2)]),n("div",He,[e.inputValue&&e.amountPirce!="--"?(u(),$("div",Ge," $"+k(("formatNumber"in e?e.formatNumber:K(de))(e.amountPirce)),1)):(u(),$("div",Ke)),n("div",Je,[n("div",Qe,[H(k(e.isTotal?e.$t("common.total"):e.$t("common.balance"))+" ",1),n("span",Xe,k(e.wallet.connected?("addCommom"in e?e.addCommom:K(O))(e.balance,e.coinDecimals):"0"),1),e.havemax&&e.wallet.connected?(u(),E(L,{key:0,disabled:!e.coinName||("addCommom"in e?e.addCommom:K(O))(e.halfBalance,e.coinDecimals)==0,class:"max-btn",onClick:s[2]||(s[2]=p=>e.$emit("onHalf"))},{default:W(()=>[H(k("Half"))]),_:1},8,["disabled"])):M("",!0),e.havemax&&e.wallet.connected?(u(),E(L,{key:1,disabled:!e.coinName||("addCommom"in e?e.addCommom:K(O))(e.balance,e.coinDecimals)==0,class:"max-btn",onClick:s[3]||(s[3]=p=>e.$emit("onMax"))},{default:W(()=>[H(k(e.$t("button.max")),1)]),_:1},8,["disabled"])):M("",!0)])])])])}const Ot=oe(Be,[["render",Ye],["__scopeId","data-v-2cb78902"]]),Ze=ee({props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},fixedFromCoin:{type:Boolean,defalut:!0},isInputTotalAmount:{type:Boolean,default:!1},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},createPoolInfo:{type:Object,default:()=>({})},currentPrice:{type:Number,default:0},currentPriceReverse:{type:Number,default:0},currentPriceTab:{type:String,default:""}},setup(e){const s=ae(),y=d(()=>s),j=ne(),m=d(()=>j),c=te(),o=d(()=>{let v=null;if(c.name=="liquidity-create")v=e.createPoolInfo;else for(const p in y.value.poolsObj){const C=y.value.poolsObj[p];C.address==c.query.poolAddress&&(v=C)}return v}),f=d(()=>m.value.chainName?Oe(m.value.chainName):{}),P=d(()=>m.value.slippage),N=R(),g=R(),L=async()=>{var w;if(!e.minPrice&&!e.maxPrice)return;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-deposit-ratio.vue:170 ~ getRatio ~ poolInfo.value:",o.value);const{TickUtil:v,TickMath:p,getNearestTickByTick:C}=f.value,F=o.value.token_a.decimals,a=o.value.token_b.decimals;let D,_,V,q,l,U,I,S=1,T=1;const t=o.value.current_tick_index;let i=y.value.poolPriceConfigObj&&y.value.poolPriceConfigObj[o.value.address]&&y.value.poolPriceConfigObj[o.value.address].recommend_ranges||{};if(o.value.token_a.address.toLowerCase()===e.fromCoin.address.toLowerCase()&&o.value.token_b.address.toLowerCase()===e.toCoin.address.toLowerCase()?I=!0:I=!1,e.minPrice==="0"&&e.maxPrice==="âˆž")V=v.getMinIndex(o.value.tickSpacing),q=v.getMaxIndex(o.value.tickSpacing);else if(e.currentPriceTab=="custom"){I?(D=e.minPrice,_=e.maxPrice):(D=e.maxPrice!=="âˆž"?new h(1).div(e.maxPrice).toString():1/0,_=new h(1).div(e.minPrice).toString());try{l=p.priceToTickIndex(new h(D),F,a)}catch{l=-443636}try{U=p.priceToTickIndex(new h(_),F,a)}catch{U=443636}D==0&&(l=-443636),V=C(l,Number(o.value.tickSpacing),!0),q=C(U,Number(o.value.tickSpacing),!0)}else V=i&&i[e.currentPriceTab]&&i[e.currentPriceTab].lower,q=i&&i[e.currentPriceTab]&&i[e.currentPriceTab].upper;if(e.maxPrice==="âˆž"||t>=V&&t<=q){let r;if(e.fixedFromCoin){const B=new h(Number(e.fromCoinAmount)==0?1:e.fromCoinAmount).mul(Math.pow(10,e.fromCoin.decimals)).toString();r=new Y(B)}else{const B=new h(Number(e.toCoinAmount)==0?1:e.toCoinAmount).mul(Math.pow(10,e.toCoin.decimals)).toString();r=new Y(B)}if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-liquidity-deposit-ratio.vue:262 ~ getRatio ~ poolInfo.value.current_sqrt_price:",o.value.current_sqrt_price),((w=o==null?void 0:o.value)==null?void 0:w.current_sqrt_price)<=0)return!1;const{tokenMaxA:b,tokenMaxB:A}=await f.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:o.value.token_a,tokenB:o.value.token_b,lowerTick:V,upperTick:q,coinAmount:r,iscoinA:I?e.fixedFromCoin:!e.fixedFromCoin,roundUp:!0,slippage:Number(P.value)/100,curSqrtPrice:new Y(o.value.current_sqrt_price)});I?e.fixedFromCoin?(T=Number(A)>0?A:"",S=Number(b)>0?b:""):(S=Number(b)>0?b:"",T=Number(A)>0?A:""):(e.fixedFromCoin,T=b,S=A)}else t>q?I?(T=1,S=0):(S=1,T=0):t<V&&(I?(T=0,S=1):(T=1,S=0));if(e.minPrice=="0"&&e.maxPrice=="âˆž")N.value=50,g.value=50;else{const r=S?Number(S):0,b=T?Number(T):0,A=new h(b).add(new h(I?new h(r*e.currentPrice):new h(r*e.currentPriceReverse))),B=re(new h(r).mul(new h(I?e.currentPrice:e.currentPriceReverse)).div(A).mul(100).toNumber().toFixed(2),2),G=re(new h(b).div(A).mul(100).toNumber().toFixed(2),2);N.value=B,g.value=G}};return J(()=>[o.value,e.minPrice,e.maxPrice,e.fromCoinAmount,e.toCoinAmount,e.isInputTotalAmount],([v,p,C,F,a])=>{p&&C&&v&&!x(v)&&(p!=="0"||C!=="0")?L():(N.value="",g.value="")},{immediate:!0,deep:!0}),{fromCoinRatio:N,toCoinRatio:g}}});const xe={class:"deposit-ratio"},et={class:"deposit-ratio-text"},tt=n("span",null,"Deposit Ratio",-1),ot=n("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon-tips1"})],-1),nt={class:"deposit-ratio-content"},at={class:"coin-ratio"},it={class:"coin-a-ratio"},st={class:"coin-b-ratio"},lt={class:"ratio-progress"};function rt(e,s,y,j,m,c){var f,P;const o=Pe;return u(),$("div",xe,[n("div",et,[tt,Z(o,{placement:"bottom","arrow-point-at-center":""},{title:W(()=>[n("span",null,k(e.$t("newAdd.depositRatioTips")),1)]),default:W(()=>[ot]),_:1})]),n("div",nt,[n("div",at,[n("div",it,[n("span",null,k((f=e.fromCoin)==null?void 0:f.symbol),1),H(" "+k(e.fromCoinRatio)+"% ",1)]),n("div",st,[n("span",null,k((P=e.toCoin)==null?void 0:P.symbol),1),H(" "+k(e.toCoinRatio)+"% ",1)])]),n("div",lt,[n("div",{class:"from-percent",style:ue({width:e.fromCoinRatio+"%"})},null,4),n("div",{class:"to-percent",style:ue({width:e.toCoinRatio+"%"})},null,4)])])])}const Rt=oe(Ze,[["render",rt]]),ut=ee({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,s){const y=R(!1),j=R(null),m=R(0);let c=R(!1);const o=R(20),f=ae(),P=ne(),N=R(!1);Ie(()=>{}),Te(()=>{clearInterval(j.value)});const g=()=>{c.value=!1,j.value=setInterval(()=>{var a;N.value||m.value<o.value&&(m.value+=1,m.value===o.value&&(c.value=!0,(a=e==null?void 0:e.poolInfo)!=null&&a.poolAddress&&f.updateCurrentPools(e.poolInfo.poolAddress,P.chainName),m.value=0,setTimeout(()=>{c.value=!1},1e3)))},1e3)},L=d(()=>P.slippage),v=()=>{s.emit("clearAll")},p=()=>{c.value||(c.value=!0,m.value=0,s.emit("clickRefresh"),setTimeout(()=>{c.value=!1,g()},1e3))};J(()=>e.poolInfo,a=>{a&&!j.value&&g()},{immediate:!0});const C=Ae(),F=te();return{refresh:c,clickRefresh:p,isShowSwapSetting:y,countdown:m,autoRefreshTime:o,slippage:L,clearAll:v,checkNullObj:x,router:C,route:F}}});const ie=e=>(me("data-v-906fb979"),e=e(),fe(),e),ct={class:"title"},dt=ie(()=>n("div",{class:"left"},[n("span",null,"Deposit Amounts")],-1)),mt=ie(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),ft={key:0,class:"deposit-progress"},vt=ie(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),pt=[vt];function gt(e,s,y,j,m,c){const o=je;return u(),$("div",ct,[dt,n("div",{class:Q(["right title-right deposit-setting",e.poolInfo?"havePoolInfo":"noPoolInfo"])},[n("div",{class:"slippage-icon",onClick:s[0]||(s[0]=f=>e.isShowSwapSetting=!0)},[mt,n("span",null,k(e.slippage)+"%",1)]),e.route.name!=="liquidity-create"?(u(),$("div",ft,[(u(),$("svg",{"aria-hidden":"true",class:Q(e.refresh?"refresh-icon refresh":"refresh-icon"),onClick:s[1]||(s[1]=(...f)=>e.clickRefresh&&e.clickRefresh(...f))},pt,2))])):M("",!0)],2),e.isShowSwapSetting?(u(),E(o,{key:0,onOnClose:s[2]||(s[2]=f=>e.isShowSwapSetting=!1)})):M("",!0)])}const jt=oe(ut,[["render",gt],["__scopeId","data-v-906fb979"]]);export{jt as _,Rt as a,Ot as b};
