import{_ as Vo}from"./back.a8c7a7ad.js";import{_ as xo}from"./swap-setting.bbf29e0d.js";import{b as Xe,u as xe,c as eo,g as bo,p as Ao,d as en}from"./pool.73243d89.js";import{a as Ye,r as R,m as _,e as ze,o as y,f as S,h as n,v as W,c as Ne,x as de,p as so,k as ao,E as No,G as ye,b as lo,i as re,z as vo,y as Ro,t as Pe,H as Oo,W as fo,q as wo,u as J,j as me,w as Le,Q as qo,l as yo,$ as on,U as Ge,V as nn,a4 as Co,J as $o,F as Ve,s as to,B as co,Y as tn,a5 as sn,a6 as an,O as Lo,a2 as ln,S as rn}from"./entry.f1d335d0.js";import{i as ve,w as un,x as dn,b as ke,g as Z,k as Ue,u as mo,B as Se,m as qe,D as Bo,E as Mo,T as So,G as cn}from"./index.b02d129f.js";import{_ as po}from"./token-warning.9bd2828a.js";import{_ as Uo}from"./status-block.bc9eac3d.js";import{s as uo,m as mn,l as vn,b as fn,a as pn}from"./transform.c672907f.js";import{D as g}from"./decimal.0bdeb344.js";/* empty css              */import{i as io}from"./import-icon.de3e6c66.js";import"./index.206efd4d.js";import{_ as ho}from"./assets-card.f9af4e7d.js";import{_ as hn}from"./coin-lock.d781327f.js";import{_ as gn,a as bn,b as kn}from"./icon-Add-Liquidity_2x.163f545d.js";/* empty css              */import{u as jo}from"./notifi.711bb630.js";import{_ as _n}from"./apr-tips.d5bb9d77.js";import{u as Eo}from"./farms.0be9a35b.js";/* empty css              *//* empty css              *//* empty css              */import"./icon-warning_2x.28d04e31.js";import"./icon-error_2x.5e1b70e6.js";import"./useDebounceFunction.86687629.js";import"./img-lock_2x.a28135f4.js";import"./useWhale.9c5cce00.js";import"./icon_fee_2x.c09473e0.js";import"./icon_rewards_2x.ed2dfeb6.js";const ko=Math.PI,_o=2*ko,Ke=1e-6,wn=_o-Ke;function Do(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function yn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Do;const s=10**t;return function(a){this._+=a[0];for(let P=1,h=a.length;P<h;++P)this._+=Math.round(arguments[P]*s)/s+a[P]}}class In{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Do:yn(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,a,P){this._append`Q${+t},${+s},${this._x1=+a},${this._y1=+P}`}bezierCurveTo(t,s,a,P,h,T){this._append`C${+t},${+s},${+a},${+P},${this._x1=+h},${this._y1=+T}`}arcTo(t,s,a,P,h){if(t=+t,s=+s,a=+a,P=+P,h=+h,h<0)throw new Error(`negative radius: ${h}`);let T=this._x1,m=this._y1,o=a-t,r=P-s,p=T-t,u=m-s,b=p*p+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(b>Ke)if(!(Math.abs(u*o-r*p)>Ke)||!h)this._append`L${this._x1=t},${this._y1=s}`;else{let L=a-T,oe=P-m,ne=o*o+r*r,z=L*L+oe*oe,f=Math.sqrt(ne),w=Math.sqrt(b),q=h*Math.tan((ko-Math.acos((ne+b-z)/(2*f*w)))/2),i=q/w,I=q/f;Math.abs(i-1)>Ke&&this._append`L${t+i*p},${s+i*u}`,this._append`A${h},${h},0,0,${+(u*L>p*oe)},${this._x1=t+I*o},${this._y1=s+I*r}`}}arc(t,s,a,P,h,T){if(t=+t,s=+s,a=+a,T=!!T,a<0)throw new Error(`negative radius: ${a}`);let m=a*Math.cos(P),o=a*Math.sin(P),r=t+m,p=s+o,u=1^T,b=T?P-h:h-P;this._x1===null?this._append`M${r},${p}`:(Math.abs(this._x1-r)>Ke||Math.abs(this._y1-p)>Ke)&&this._append`L${r},${p}`,a&&(b<0&&(b=b%_o+_o),b>wn?this._append`A${a},${a},0,1,${u},${t-m},${s-o}A${a},${a},0,1,${u},${this._x1=r},${this._y1=p}`:b>Ke&&this._append`A${a},${a},0,${+(b>=ko)},${u},${this._x1=t+a*Math.cos(h)},${this._y1=s+a*Math.sin(h)}`)}rect(t,s,a,P){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${a=+a}v${+P}h${-a}Z`}toString(){return this._}}function no(e){return function(){return e}}function An(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const a=Math.floor(s);if(!(a>=0))throw new RangeError(`invalid digits: ${s}`);t=a}return e},()=>new In(t)}function Cn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fo(e){this._context=e}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $n(e){return new Fo(e)}function Sn(e){return e[0]}function Pn(e){return e[1]}function Tn(e,t){var s=no(!0),a=null,P=$n,h=null,T=An(m);e=typeof e=="function"?e:e===void 0?Sn:no(e),t=typeof t=="function"?t:t===void 0?Pn:no(t);function m(o){var r,p=(o=Cn(o)).length,u,b=!1,L;for(a==null&&(h=P(L=T())),r=0;r<=p;++r)!(r<p&&s(u=o[r],r,o))===b&&((b=!b)?h.lineStart():h.lineEnd()),b&&h.point(+e(u,r,o),+t(u,r,o));if(L)return h=null,L+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:no(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:no(+o),m):t},m.defined=function(o){return arguments.length?(s=typeof o=="function"?o:no(!!o),m):s},m.curve=function(o){return arguments.length?(P=o,a!=null&&(h=P(a)),m):P},m.context=function(o){return arguments.length?(o==null?a=h=null:h=P(a=o),m):a},m}function Po(){}function Wo(e){this._context=e}Wo.prototype={areaStart:Po,areaEnd:Po,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Nn(e){return new Wo(e)}const Rn=Ye({setup(){const e=Xe(),t=R(!1),s=_(()=>e);return{slippage:_(()=>s.value.slippage),isShowSwapSetting:t}}});const On=e=>(so("data-v-82585f8b"),e=e(),ao(),e),qn=On(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Ln(e,t,s,a,P,h){const T=xo;return y(),S("div",{class:"slippage-icon",onClick:t[1]||(t[1]=m=>e.isShowSwapSetting=!0)},[qn,n("span",null,W(e.slippage)+"%",1),e.isShowSwapSetting?(y(),Ne(T,{key:0,onOnClose:t[0]||(t[0]=m=>e.isShowSwapSetting=!1)})):de("",!0)])}const Bn=ze(Rn,[["render",Ln],["__scopeId","data-v-82585f8b"]]),Mn=Ye({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const s=R(!1),a=R(null),P=R(0),h=R(20),T=xe(),m=Xe(),o=R(!1);No(()=>{clearInterval(a.value)});const r=()=>{a.value=setInterval(()=>{var z;o.value||P.value<h.value&&(P.value+=1,P.value===h.value&&((z=e==null?void 0:e.poolInfo)!=null&&z.poolAddress&&T.updateCurrentPools(e.poolInfo.poolAddress,m.chainName),P.value=0))},1e3)},p=_(()=>m.slippage),u=()=>{t.emit("clearAll")},b=R(!1),L=()=>{P.value=0,b.value=!0,t.emit("clickRefresh"),setTimeout(()=>{b.value=!1},1e3)};ye(()=>e.poolInfo,z=>{z&&!a.value&&r()},{immediate:!0});const oe=lo(),ne=_(()=>m.chainName);return{clickRefresh:L,isShowSwapSetting:s,countdown:P,autoRefreshTime:h,slippage:p,clearAll:u,checkNullObj:ve,router:oe,loading:o,chainName:ne,refresh:b}}});const Un=e=>(so("data-v-ca768f9b"),e=e(),ao(),e),jn={class:"new-position-title"},En={class:"left"},Dn={class:"right"},Fn=Un(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Wn=[Fn];function Hn(e,t,s,a,P,h){const T=Vo,m=Bn;return y(),S("div",jn,[n("div",En,[re(T)]),n("div",Dn,[re(m),(y(),S("svg",{"aria-hidden":"true",class:vo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:t[0]||(t[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Wn,2))])])}const Ho=ze(Mn,[["render",Hn],["__scopeId","data-v-ca768f9b"]]);function To(e,t,s){const a=new g(10).pow(t-s);return new g(1.0001).pow(e).mul(a)}const Xn=Ye({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const s=R(1),a=R(""),P=R(""),h=_(()=>{var i,I,v;return u.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(I=e.poolInfo)==null?void 0:I.coinA.decimals,(v=e.poolInfo)==null?void 0:v.coinB.decimals).toString()}),T=_(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(h.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(h.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),m=_(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(h.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(h.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=Xe(),r=_(()=>o),p=_(()=>r.value.chainName?eo(r.value.chainName):{}),{TickMath:u,getNearestTickByTick:b}=p.value,L=()=>{const i=s.value/2;s.value=i,z(e.poolInfo,i)},oe=()=>{const i=s.value*2;s.value=i,z(e.poolInfo,i)},ne=(i=[])=>{let I=6;const v=Math.abs(Number(i[0])-Number(i[i.length-1]));return v>=6?I=0:v>=1?I=1:v>=.1?I=2:v>=.01?I=3:v>=.001?I=4:v>=1e-4?I=5:v>=1e-5?I=6:v>=1e-6?I=7:v>=1e-7&&(I=8),I},z=(i,I=1)=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:189 ~ dataProcessing ~ zooms:",I),i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const v=Number(e.poolInfo.current_tick_index);let k=v+100*I,l=v-100*I,te,K;if(e.maxPrice==="âˆž")K=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?K=u.priceToTickIndex(new g(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):K=u.priceToTickIndex(new g(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{K=443636}if(e.minPrice==="0")te=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?te=u.priceToTickIndex(new g(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):te=u.priceToTickIndex(new g(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{te=-443636}let ie=0;if(e.currentPriceTab!=="full range"){if(v>=te&&v<=K){const U=v-te,be=K-v;ie=Math.max(Math.abs(U),Math.abs(be))}else v<te?ie=Math.abs(K-v):ie=Math.abs(v-te);k=v+ie+20*I,l=v-ie-20*I}else{const U=(Math.abs(v)>5e3,2e4);k=v+U*I,l=v-U*I}l<-443636&&(l=-443636),k>443636&&(k=443636);const H=new g(i.liquidity).div(Math.pow(10,8)).toString(),A=e.tickList,M=[],N=[];let X={};for(let U=0;U<A.length;U++){if(X=A[U],X.index<=v&&X.index>=l){if(M.length<1&&U!==0){const be=A[U-1];M.unshift({...be,index:l})}M.unshift(X)}else if(X.index>v&&X.index<=k&&(N.push(X),M.length<1&&U!==0)){const be=A[U-1];M.push({...be,index:l})}if(X.index>k){const be=A[U];if(N.push({...be,index:k}),M.length<1&&U!==0){const Ie=A[U-1];M.push({...Ie,index:l})}break}}let x="0";for(let U=M.length-1;U>=0;U--)x=new g(x).plus(new g(M[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),M[U].liquityAmount=x;let Q=H;for(let U=0;U<N.length;U++)Q=new g(Q).plus(new g(N[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),N[U].liquityAmount=Q;let se=[];const V=A&&A.length>0?{index:v,liquityAmount:Number(H)}:{index:v,liquityAmount:0};(M.length>0||N.length>0)&&(se=[...M.reverse(),V,...N],e.direction||(se=se.reverse()));const ge=[];A.forEach(U=>{ge.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:384 ~ dataProcessing ~ tickMin, tickMax, minPriceTick, maxPriceTick:",l,k,te,K,v),w(se,l,k,te,K,v)}};let f=R(!0);Ro(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,z(e.poolInfo,s.value)}});const w=(i,I,v,k,l,te)=>{let K,ie;e.direction?(K=e.before7dContractPriceLowest?u.priceToTickIndex(new g(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ie=e.before7dContractPriceHighest?u.priceToTickIndex(new g(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(K=e.before7dContractPriceLowest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ie=e.before7dContractPriceHighest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const H={top:30,right:35,bottom:20,left:55};let A,M;f.value,A=340-H.left-H.right,M=205-H.top-H.bottom;const N=v-I,X=parseInt(String(N/4));let x=[I+X/4,I+X,I+2*X,v-X,v-X/4];const Q=I,se=v,V=A/(se-Q);e.currentPriceTab==="full range"&&(x=[I,I+2*X,v]);const ge=x.map(O=>e.direction?To(O,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new g(1).div(To(O,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ne(ge),uo("#chart").selectAll("*").remove();const U=uo("#chart").attr("width",A+H.left+H.right).attr("height",M+H.top+H.bottom).append("g").attr("transform",`translate(${H.left},${H.right})`),be=mn(i,function(O){return Number(Math.abs(O.liquityAmount))})||0,Ie=vn().range([0,M]).domain([be,0]);fn().rangeRound([0,A]).padding(.1);const Me=U.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");r.value.theme=="default"?Me.attr("x",function(O,E){return E===0?0:e.direction?Math.abs(O.index-Q)*V:Math.abs(se-O.index)*V}).attr("y",function(O,E){return e.direction?E===i.length-1?0:Ie(O.liquityAmount):E===i.length-1?0:Ie(i[E+1].liquityAmount)}).attr("width",function(O,E){return E===0&&i.length===1&&O.liquityAmount>0?A:(e.direction,E!==i.length-1?Math.abs(i[E+1].index-O.index)*V:0)}).attr("height",function(O,E){return E===0&&i.length===1&&O.liquityAmount>0?M:e.direction?E===i.length-1?0:M-Ie(O.liquityAmount):E===i.length-1?0:M-Ie(i[E+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Me.attr("x",function(O,E){return E===0?0:e.direction?Math.abs(O.index-Q)*V:Math.abs(se-O.index)*V}).attr("y",function(O,E){return e.direction?E===i.length-1?0:Ie(Math.abs(O.liquityAmount)):E===i.length-1?0:Ie(Math.abs(i[E+1].liquityAmount))}).attr("width",function(O,E){return E===0&&i.length===1&&O.liquityAmount>0?A:(e.direction,E!==i.length-1?Math.abs(i[E+1].index-O.index)*V:0)}).attr("height",function(O,E){if(E===0&&i.length===1&&O.liquityAmount>0)return M;if(e.direction)return E===i.length-1?0:Number(O.liquityAmount)?M-Ie(Math.abs(O.liquityAmount)):0;{if(E===i.length-1)return 0;const ce=M-Ie(Math.abs(i[E+1].liquityAmount));return Number(i[E+1].liquityAmount)?ce:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const $e=U.append("g");$e.append("line").attr("x1",0).attr("y1",155).attr("x2",A).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),$e.append("g");let d=0;e.direction?d=Math.abs(te-Q)*V:d=Math.abs(te-se)*V,(r.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+d+", 0)"),uo("#triangle").attr("width",8).attr("height",4);let C=[[0,0],[4,4],[8,0]],j=Tn().x(function(O){return O[0]}).y(function(O){return O[1]}).curve(Nn);const D=d-4;U.append("path").attr("d",j(C)).style("fill",r.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+D+", 0)");let F,Y,ee,ue;e.direction?(F=k<Q?-100:parseInt(String(Math.abs(k-Q)*V)),Y=l<Q?-100:parseInt(String(Math.abs(l-Q)*V)),ee=K<Q?-100:Math.abs(K-Q)*V,ue=ie<Q?-100:Math.abs(ie-Q)*V):(Y=k<Q?-100:Math.abs(se-k)*V,F=l<Q?-100:Math.abs(se-l)*V,ue=K<Q?-100:Math.abs(se-K)*V,ee=ie<Q?-100:Math.abs(se-ie)*V),e.minPrice==="0"&&(F=0),e.maxPrice==="âˆž"&&(Y=A),f.value?a.value=A-F+60+"px":a.value=A-F+52+"px",P.value=Y+74+"px",K&&ee<A&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ee+", 0)"),ie&&ue<A&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ue+", 0)");const fe=pn().extent([[0,0],[A,M]]).handleSize(30).on("end",_e);U.append("g").attr("class","brush").call(fe).call(fe.move,[F,Y]);function _e(O){if(!O.sourceEvent||!O.selection)return;f.value?a.value=A-O.selection[0]+60+"px":a.value=A-O.selection[0]+52+"px",P.value=O.selection[1]+74+"px";let E,ce,pe=0,$=0;e.direction?(pe=b(parseInt(String(O.selection[0]/V+Q)),Number(e.poolInfo.tickSpacing)),E=u.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),$=b(parseInt(String(O.selection[1]/V+Q)),Number(e.poolInfo.tickSpacing)),ce=u.tickIndexToPrice($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):($=b(se-O.selection[0]/V,Number(e.poolInfo.tickSpacing)),E=1/u.tickIndexToPrice($,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=b(se-O.selection[1]/V,Number(e.poolInfo.tickSpacing)),ce=1/u.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ke(String(E),6))),t.emit("onChangeMaxPrice",String(ke(String(ce),6)))}r.value.theme=="default"?uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};R(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,I,v,k,l])=>{i&&I&&v&&k&&l&&l.length>0&&z(i,s.value)},{immediate:!0});const q=R(!0);return ye(()=>e.chartLoading,(i,I)=>{i!==I&&(q.value=i)},{immediate:!0,deep:!0}),{store:r,loading:q,zoomOut:L,zoomIn:oe,rangeSizeLower:T,rangeSizeUpper:m,rangeSizeLowerPosition:a,rangeSizeUpperPosition:P,decimalFormat:un,numberformat:dn}}});const Yn=e=>(so("data-v-992b1bf2"),e=e(),ao(),e),zn={class:"chart-box"},Gn={class:"chart"},Jn=Yn(()=>n("svg",{id:"chart"},null,-1)),Qn=[Jn];function Zn(e,t,s,a,P,h){return y(),S("div",zn,[Pe(n("div",Gn,Qn,512),[[Oo,!e.loading]])])}const Xo=ze(Xn,[["render",Zn],["__scopeId","data-v-992b1bf2"]]),Kn=Ye({components:{StatusBlock:Uo,NewPositionChart:Xo,TokenWarning:po},setup(e){const t=R(),s=R(),a=_(()=>{var v,k;return(k=(v=u.value)==null?void 0:v.poolInfo)==null?void 0:k.needReverse}),P=Xe(),h=_(()=>P),T=_(()=>h.value.currentExplorer),m=_(()=>h.value.theme),o=_(()=>h.value.chainName),r=xe(),p=_(()=>r),u=R({}),b=fo();ye(()=>[p.value.currentPositionInfo,o.value],([v,k])=>{var l;(k=="Aptos"&&v||k=="Sui"&&v&&(v==null?void 0:v.nftHash)==((l=b==null?void 0:b.query)==null?void 0:l.pos))&&(u.value=v,t.value=u.value.token_a,s.value=u.value.token_b)},{immediate:!0});const L=v=>{var k;return(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||((k=p.value.tokensObj[v==null?void 0:v.address])==null?void 0:k.logo_url)||(m.value==="default"?io("/image/coins/unknown.png"):io("/image/coins/sui-unknown.png"))},oe=_(()=>o.value?eo(o.value):{}),ne=R([]),z=async v=>{const{list:k}=await oe.value.getTicks(v),l=k?oe.value.getTickDataFromUrlData(k):[];ne.value=l};ye(()=>[u.value,p.value.poolsObj],([v,k])=>{v&&!ve(v)&&v.poolInfo&&k&&!ve(k)&&z(k[v.poolAddress])},{immediate:!0});const f=R(!0),w=(v,k)=>v!=="0"&&k!=="âˆž"?Ue(1/(1-Number((v/k)**.25)),2)+"x":"1x",q=_(()=>u.value.minPrice&&u.value.maxPrice?w(u.value.minPrice,u.value.maxPrice):"--"),i=_(()=>u.value.maxPrice!=="âˆž"?new g(1).div(new g(u.value.maxPrice)).toString():"âˆž"),I=_(()=>u.value.minPrice>0?new g(1).div(new g(u.value.minPrice)).toString():"0");return{needReverse:a,getCoinIcon:L,theme:m,indexStore:P,direct:f,addCommom:Z,decimalUi:ke,tickList:ne,positionInfo:u,fromCoin:t,toCoin:s,getExplorerUrl:bo,lever:q,currentExplorer:T,minPriceResever:i,maxPriceResever:I}}}),Vn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),xn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),et=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),ot=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Je=e=>(so("data-v-500e09ec"),e=e(),ao(),e),nt={class:"new-position-info"},tt={class:"pool-info"},it={class:"left"},st={class:"coin-a"},at={alt:""},lt={class:"coin-b"},rt={alt:""},ut={class:"position-name"},dt=["href"],ct=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),mt=[ct],vt={key:0,class:"pool-fee"},ft=Je(()=>n("span",null,"Fee tier",-1)),pt={class:"right"},ht={class:"h5-pool-info"},gt={class:"coin-info"},bt={class:"coin-a"},kt={alt:""},_t={class:"coin-b"},wt={alt:""},yt={class:"position-name"},It=["href"],At=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Ct=[At],$t={key:0,class:"pool-fee"},St={class:"price-info"},Pt={class:"price-and-chart"},Tt={class:"left"},Nt={class:"current-price"},Rt=Je(()=>n("span",null,"Current Price",-1)),Ot={class:"coin-rate"},qt=Je(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Lt=Je(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Bt=[qt,Lt],Mt={key:0},Ut={key:1},jt={key:0,class:"position-range"},Et=Je(()=>n("div",{class:"position-range-title"},"Position Range",-1)),Dt={key:0},Ft={key:1},Wt={key:2,src:Vn,alt:""},Ht={key:3,src:xn,alt:""},Xt={key:4},Yt={key:5},zt={key:1,class:"position-range position-range-warp"},Gt={key:0,class:"position-range-title"},Jt={key:1,class:"position-range-title"},Qt={key:2},Zt={key:3},Kt={class:"price-img"},Vt={key:0,src:et,alt:""},xt={key:1,src:ot,alt:""},ei={key:4},oi={key:5},ni={class:"lever"},ti={class:"lever-title"},ii=Je(()=>n("div",null,[n("span",null," Leverage "),n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),si={class:"lever-text"},ai={class:"right"},li=Je(()=>n("div",{class:"chat-mask"},null,-1));function ri(e,t,s,a,P,h){var u,b,L,oe,ne,z,f,w,q,i,I,v,k,l,te,K,ie,H,A,M,N,X,x,Q,se,V,ge,U,be,Ie;const T=po,m=Uo,o=qo,r=Xo,p=wo("image");return y(),S("div",nt,[n("div",tt,[n("div",it,[n("div",st,[Pe(n("img",at,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(oe=(L=e.positionInfo)==null?void 0:L.token_b)==null?void 0:oe.address:(b=(u=e.positionInfo)==null?void 0:u.token_a)==null?void 0:b.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",lt,[Pe(n("img",rt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(w=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:w.address:(z=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:z.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ut,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash||e.positionInfo.id),target:"_blank"},W((i=(q=e.positionInfo)==null?void 0:q.name)==null?void 0:i.split("|")[1]),9,dt)]),(y(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.id))},mt)),e.positionInfo.fee?(y(),S("div",vt,[ft,me(" "+W(e.positionInfo.fee*100)+"% ",1)])):de("",!0)]),n("div",pt,[re(m,{"current-status":(I=e.positionInfo)==null?void 0:I.currentStatus},null,8,["current-status"])])]),n("div",ht,[n("div",null,[n("div",gt,[n("div",bt,[Pe(n("img",kt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(te=(l=e.positionInfo)==null?void 0:l.token_b)==null?void 0:te.address:(k=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:k.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",_t,[Pe(n("img",wt,null,512),[[p,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(A=(H=e.positionInfo)==null?void 0:H.token_a)==null?void 0:A.address:(ie=(K=e.positionInfo)==null?void 0:K.token_b)==null?void 0:ie.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",yt,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash||e.positionInfo.id),target:"_blank"},W((N=(M=e.positionInfo)==null?void 0:M.name)==null?void 0:N.split("|")[1]),9,It),(y(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.id))},Ct))]),e.positionInfo.fee?(y(),S("div",$t,W(e.positionInfo.fee*100)+"% ",1)):de("",!0)])]),re(m,{"current-status":(X=e.positionInfo)==null?void 0:X.currentStatus},null,8,["current-status"])]),n("div",St,[n("div",Pt,[n("div",Tt,[n("div",Nt,[n("div",null,[Rt,n("div",Ot,[n("div",{onClick:t[2]||(t[2]=Be=>e.direct=!e.direct)},Bt)])]),(e.needReverse?!e.direct:e.direct)?(y(),S("div",Mt,[me(W(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,W((x=e.toCoin)==null?void 0:x.symbol)+" per "+W((Q=e.fromCoin)==null?void 0:Q.symbol),1)])):(y(),S("div",Ut,[me(W(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,W((se=e.fromCoin)==null?void 0:se.symbol)+" per "+W((V=e.toCoin)==null?void 0:V.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(y(),S("div",jt,[Et,n("div",null,[(e.needReverse?!e.direct:e.direct)?(y(),S("div",Dt,[me(W(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",Ft,[me(W(((ge=e.positionInfo)==null?void 0:ge.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(y(),S("img",Wt)):(y(),S("img",Ht)),(e.needReverse?!e.direct:e.direct)?(y(),S("div",Xt,[me(W(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",Yt,[me(W(((be=e.positionInfo)==null?void 0:be.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(y(),S("div",zt,[(e.needReverse?!e.direct:e.direct)?(y(),S("span",Gt," Position Range ")):(y(),S("span",Jt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(y(),S("div",Qt,[me(W(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",Zt,[me(W(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPriceResever,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Kt,[e.theme=="default"?(y(),S("img",Vt)):(y(),S("img",xt))]),(e.needReverse?!e.direct:e.direct)?(y(),S("div",ei,[me(W(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(y(),S("div",oi,[me(W(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPriceResever,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),me(" Â  ")]))])),n("div",ni,[n("div",ti,[re(o,{"overlay-class-name":"lever-tooltip"},{title:Le(()=>[me("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Le(()=>[ii]),_:1})]),n("div",si,W(e.lever),1)])]),n("div",ai,[re(r,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse?e.minPriceResever:e.positionInfo.minPrice,"max-price":e.needReverse?e.maxPriceResever:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),li])])])])}const Yo=ze(Kn,[["render",ri],["__scopeId","data-v-500e09ec"]]),ui=Ye({components:{TokenWarning:po},setup(e,t){const{t:s}=yo(),{$notify:a}=on(),P=Xe(),h=_(()=>P),T=xe(),m=_(()=>T),o=R({}),r=R({}),p=R({}),u=_(()=>h.value.chainName),b=_(()=>u.value?eo(u.value):{}),L=fo(),oe=R(!1),ne=async(d=null)=>{var j,D;const c=d||o.value,C=m.value.addressLpTokens[c.poolAddress];if(C){const F=await b.value.getTickDataByIndex(C.ticks_handle||((j=c==null?void 0:c.poolInfo)==null?void 0:j.ticks_handle),Number(c.tick_lower_index)),Y=await b.value.getTickDataByIndex(C.ticks_handle||((D=c==null?void 0:c.poolInfo)==null?void 0:D.ticks_handle),Number(c.tick_upper_index));let ee={};u.value==="Aptos"?ee=await b.value.getPosRewardersAmount({poolAddress:k.currentRoute.value.query.address,positionName:k.currentRoute.value.query.token,tickLowerData:F,tickUpperData:Y}):ee=await b.value.fetchPosRewardersAmount({poolAddress:c.poolAddress,positionId:c.pos_object_id||c.clmm_position_id,coinTypeA:c.coin_type_a||c.coinTypeA,coinTypeB:c.coin_type_b||c.coinTypeB,rewarderInfo:c.poolInfo.rewarder_infos});const ue=[];let fe=new g(0);ee.forEach((_e,O)=>{var $,G;const E=($=m.value.tokensObj[_e.coin_address])==null?void 0:$.decimals,ce=_e.amount_owed.toString();let pe=new g(ce).div(Math.pow(10,E)).toString();if(u.value=="Aptos"&&Number(pe)>999999999&&(pe="0"),c.poolInfo[`rewarder_display${O+1}`]||Number(pe)>0){const B=m.value.tokensObj[_e.coin_address],le=((G=m.value.RATES[_e.coin_address])==null?void 0:G.price)||0,ae=new g(pe).mul(le).toString();fe=new g(fe).plus(ae),ue.push({..._e,...B,amount:Number(pe)>0?pe:0,amountUSD:Number(ae)>0?Se(ae,2):0,amountUSDText:ae})}}),l.value=ue}};ye(()=>[m.value.currentPositionInfo,u.value],([d,c])=>{var C;c=="Aptos"&&d?(o.value=d,r.value=d==null?void 0:d.token_a,p.value=d==null?void 0:d.token_b):c=="Sui"&&d&&(d==null?void 0:d.nftHash)==((C=L==null?void 0:L.query)==null?void 0:C.pos)&&(o.value=d,r.value=d==null?void 0:d.token_a,p.value=d==null?void 0:d.token_b,oe.value=!1)},{immediate:!0}),ye(()=>[o.value,m.value.addressLpTokens],([d,c])=>{!ve(d)&&!ve(c)&&ne(d)},{immediate:!0});const z=_(()=>{var d,c,C,j,D,F,Y,ee;if(o.value&&!ve(o.value)&&m.value.RATES){const ue=o.value.amountA*((c=m.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:c.price),fe=o.value.amountB*((j=m.value.RATES[(C=o.value)==null?void 0:C.token_b.address])==null?void 0:j.price);if((F=m.value.RATES[(D=o.value)==null?void 0:D.token_a.address])!=null&&F.price&&((ee=m.value.RATES[(Y=o.value)==null?void 0:Y.token_b.address])!=null&&ee.price)){const _e=Number(ue+fe);return _e>0&&_e<.01?"<0.01":Z(Ue(ue+fe,2),2)}else return" --"}else return" --"}),f=_(()=>{var d,c;return(c=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:c.needReverse}),w=_(()=>m.value.RATES),q=_(()=>{var d,c;if(w.value&&r.value&&p.value&&!ve(w.value)&&!ve(r.value)&&!ve(p.value)){const C=[],j=Number(o.value.feeOwedA)||0,D=Number(o.value.feeOwedB)||0,F=new g(j).mul(((d=w.value[r.value.address])==null?void 0:d.price)||0),Y=new g(D).mul(((c=w.value[p.value.address])==null?void 0:c.price)||0);return C.push({amount:j,amountUSD:F.toString()},{amount:D,amountUSD:Y.toString()}),C}return[]}),i=_(()=>{var c,C;let d=new g(0);return(c=q==null?void 0:q.value)==null||c.forEach(j=>{d=d.add(new g(j.amount))}),u.value=="Sui"&&((C=l==null?void 0:l.value)==null||C.forEach(j=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:622 ~ canClaimYield ~ ele:",j),d=d.add(new g(j.amount))})),d.toNumber()}),I=_(()=>{var c,C;let d=new g(0);return(c=q==null?void 0:q.value)==null||c.forEach(j=>{d=d.add(new g(j.amountUSD))}),u.value=="Sui"&&((C=l==null?void 0:l.value)==null||C.forEach(j=>{d=d.add(new g(j.amountUSDText))})),d.toNumber()}),v=_(()=>{var c;let d=new g(0);return(c=l.value)==null||c.forEach(C=>{d=d.add(new g(C.amountUSDText))}),d.toNumber()}),k=lo(),l=R([]),{setIsShowSuccess:te,setIsShowRejected:K,setIsShowWaiting:ie,setTransactionDesc:H,setTransactionTxid:A}=P,M=mo(),N=_(()=>M),X=async()=>{oe.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:l.value.length,collect_fee:!0};d.coinTypeC=l.value[0]?l.value[0].coin_address:"",d.coinTypeD=l.value[1]?l.value[1].coin_address:"",d.coinTypeE=l.value[2]?l.value[2].coin_address:"",ie(!0),H();try{let c;if(u.value==="Aptos"){const C=await b.value.getCollectRewarderTransactionPayload(d);c=await N.value.currentWallet.signAndSubmitTransaction(C)}else{d.pos_index=o.value.pos_object_id;const C=await b.value.getCollectRewarderTransactionPayload(d,o.value),j=await b.value.signAndExecuteTransactionBlock(N.value.currentWallet,C.txb,C.payloadParams);c=b.value.handleTx(j)}if(c&&c.hash){A(c.hash),ie(!1),te(!0);const C={title:"Claim",desc:"",hash:c.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(C.res=c.res),b.value.showTransitionPending(C),await b.value.watchTransaction(C)&&(t.emit("getDetails"),setTimeout(()=>{b.value.getAccount(N.value.address)},3e3))}else console.log("0310###toClaimRewards###else###"),ie(!1),K(!0),oe.value=!1}catch(c){ie(!1),K(!0),oe.value=!1,console.log(c,"error===>")}},x=R(!1),Q=async()=>{x.value=!0;const d=l.value;let c={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};c.coinTypeC=d[0]?d[0].coin_address:"",c.coinTypeD=d[1]?d[1].coin_address:"",c.coinTypeE=d[2]?d[2].coin_address:"";try{let C;if(u.value==="Aptos"){const j=await b.value.getCollectRewarderTransactionPayload(c);C=await N.value.currentWallet.signAndSubmitTransaction(j)}else{c.pos_index=o.value.pos_object_id;const j=await b.value.getCollectRewarderTransactionPayload(c),D=await b.value.signAndExecuteTransactionBlock(N.value.currentWallet,j.txb,j.payloadParams);C=b.value.handleTx(D)}if(C&&C.hash){A(C.hash),ie(!1),te(!0);const j=d[0].amount+d[0].symbol,D=c.coinTypeD?" and "+d[1].amount+d[1].symbol:"",F=c.coinTypeE?" and "+d[2].amount+d[2].symbol:"",Y={title:"Claim",desc:"",hash:C.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:m.value.tokensObj&&d[0]&&d[0].address&&m.value.tokensObj[d[0].address]&&m.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:c.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:c.coinTypeD?m.value.tokensObj&&d[1]&&d[1].address&&m.value.tokensObj[d[1].address]&&m.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:c.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:c.coinTypeE?m.value.tokensObj&&d[2]&&d[2].address&&m.value.tokensObj[d[2].address]&&m.value.tokensObj[d[2].address].logoURI:""},text:j+D+F};u.value!=="Aptos"&&(Y.res=C.res),b.value.showTransitionPending(Y),await b.value.watchTransaction(Y)&&setTimeout(()=>{t.emit("getDetails"),b.value.getAccount(N.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),ie(!1),K(!0);x.value=!1}catch(C){console.log("0310###collectRewarderParams Error###",C),x.value=!1,ie(!1),K(!0)}},se=_(()=>m.value.positionDetailCurrentTab),V=_(()=>{var C,j,D,F,Y,ee;const d=ke(f.value?(j=o.value)==null?void 0:j.amountB:(C=o.value)==null?void 0:C.amountA,f.value?(ee=(Y=o.value)==null?void 0:Y.token_b)==null?void 0:ee.decimals:(F=(D=o.value)==null?void 0:D.token_a)==null?void 0:F.decimals),c=f.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(se.value=="increase")return c?new g(d).add(new g(c)).toString():"";if(c){const ue=new g(d).minus(new g(c)).toString();return ue<0?"0":String(ue)}else return""}),ge=_(()=>{var C,j,D,F,Y,ee;const d=ke(f.value?(j=o.value)==null?void 0:j.amountA:(C=o.value)==null?void 0:C.amountB,f.value?(ee=(Y=o.value)==null?void 0:Y.token_a)==null?void 0:ee.decimals:(F=(D=o.value)==null?void 0:D.token_b)==null?void 0:F.decimals),c=f.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(se.value=="increase")return c?new g(d).add(new g(c)).toString():"";if(c){const ue=new g(d).minus(new g(c)).toString();return ue<0?"0":String(ue)}else return""}),U=_(()=>f.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),be=_(()=>f.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),Ie=d=>{var c;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((c=m.value.tokensObj[d==null?void 0:d.address])==null?void 0:c.logo_url)||(h.value.theme==="default"?io("/image/coins/unknown.png"):io("/image/coins/sui-unknown.png"))},Be=_(()=>{var F,Y,ee,ue,fe,_e,O,E,ce,pe,$,G;const{fromCoinAmount:d,toCoinAmount:c}=m.value.positionActionAmount,C=m.value.positionDetailCurrentTab,j=ke(f.value?(Y=o.value)==null?void 0:Y.amountB:(F=o.value)==null?void 0:F.amountA,f.value?(_e=(fe=o.value)==null?void 0:fe.token_b)==null?void 0:_e.decimals:(ue=(ee=o.value)==null?void 0:ee.token_a)==null?void 0:ue.decimals),D=ke(f.value?(E=o.value)==null?void 0:E.amountA:(O=o.value)==null?void 0:O.amountB,f.value?(G=($=o.value)==null?void 0:$.token_a)==null?void 0:G.decimals:(pe=(ce=o.value)==null?void 0:ce.token_b)==null?void 0:pe.decimals);return u.value=="Sui"||C=="remove"&&u.value=="Aptos"&&d==j&&c==D}),Me=async()=>{oe.value=!0;const d=Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,c=Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;H(s("newAdd.claimWaitingText",{from:f.value?c:d,and:Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?d:c})),ie(!0);let C;const j={pool:o.value.poolInfo,position:o.value};try{const D=await b.value.getCollectFeeTransactionPayload(j);if(u.value==="Aptos")C=await N.value.currentWallet.signAndSubmitTransaction(D);else{const F=await b.value.signAndExecuteTransactionBlock(N.value.currentWallet,D);C=b.value.handleTx(F)}if(C){A(C.hash),ie(!1),te(!0);const F={title:"Claim",desc:"",hash:C.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(F.res=C.res),b.value.showTransitionPending(F);const Y=await b.value.watchTransaction(F);console.log("0310##toClaim###transitionStatus####",Y),Y&&setTimeout(()=>{t.emit("getDetails")},1e3)}else ie(!1),K(!0),a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Co.global.t("newAdd.claimFailed")},null)]),description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});oe.value=!1,console.log("claim####test###",C)}catch(D){console.log("claim###error####",D),oe.value=!1,ie(!1),K(!0),a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Co.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},$e=Ge(nn,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:z,needReverse:f,decimalUi:ke,pendingFees:q,positionInfo:o,pendingRewarderArr:l,pendingYieldAmount:I,toClaim:Me,claimAll:X,fromCoin:r,toCoin:p,showNum:Se,claimLoading:oe,addCommom:Z,afterBase:V,afterQuote:ge,fromCoinAmount:U,toCoinAmount:be,checkNullObj:ve,getCoinIcon:Ie,chainName:u,isShowAfterAmount:Be,pendingRewarderAmount:v,toClaimRewards:Q,rewarderLoading:x,indicator:$e,canClaimYield:i}}});const di={class:"liquidity-card"},ci={class:"liquidity-title"},mi={class:"liquidity-usd"},vi=n("span",null,"Liquidity",-1),fi={class:"liquidity-ratio"},pi={class:"coin-ratio"},hi={class:"coin-a-ratio"},gi={class:"coin-b-ratio"},bi={class:"ratio-progress"},ki={class:"base-quote-num"},_i={class:"base-coin-num"},wi=n("span",null,"Base",-1),yi={alt:""},Ii={key:0,class:"after"},Ai={class:"quote-coin-num"},Ci=n("span",null,"Quote",-1),$i={alt:""},Si={key:0,class:"after"},Pi={class:"pending-yield"},Ti={class:"left"},Ni={class:"pending-yield-title"},Ri={key:0,class:"after"},Oi={class:"right"},qi={class:"fees-rewards"},Li={class:"fees-rewards-item"},Bi=n("span",null,"Fees",-1),Mi={key:0,class:"after"},Ui=n("span",null,"Fees",-1),ji={key:0,class:"after"},Ei=n("span",null,"Mining Rewards",-1),Di={style:{"margin-top":"5px"}},Fi={alt:""},Wi=n("span",null,"Mining Rewards",-1),Hi={alt:""},Xi={key:0,class:"after"},Yi={key:0,class:"pending-yield"},zi={class:"left"},Gi=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ji={key:0,class:"after"},Qi={class:"right"},Zi={key:1,class:"fees-rewards"},Ki={class:"fees-rewards-item"},Vi=n("span",null,"Mining Rewards",-1),xi={alt:""},es={key:0,class:"after"};function os(e,t,s,a,P,h){var p,u,b,L,oe,ne,z,f,w,q,i,I,v,k,l,te,K,ie,H,A,M,N,X,x,Q,se,V,ge,U,be,Ie,Be,Me,$e,d,c,C,j,D,F,Y,ee,ue,fe,_e,O,E,ce,pe,$,G,B,le,ae,we,Te,Ce,Re,Ee,De,Qe,Oe,je,Fe,We,Ze,Ae;const T=po,m=co,o=tn,r=wo("image");return y(),S("div",di,[n("div",ci,[n("div",mi,[vi,n("div",null,"$"+W(e.amountUSD),1)]),n("div",fi,[n("div",pi,[n("div",hi,[n("span",null,W(e.needReverse?(u=e.toCoin)==null?void 0:u.symbol:(p=e.fromCoin)==null?void 0:p.symbol),1),me(" "+W(e.needReverse?(L=e.positionInfo)==null?void 0:L.toPercent:(b=e.positionInfo)==null?void 0:b.fromPercent)+"% ",1)]),n("div",gi,[n("span",null,W(e.needReverse?(ne=e.fromCoin)==null?void 0:ne.symbol:(oe=e.toCoin)==null?void 0:oe.symbol),1),me(" "+W(e.needReverse?(f=e.positionInfo)==null?void 0:f.fromPercent:(z=e.positionInfo)==null?void 0:z.toPercent)+"% ",1)])]),n("div",bi,[n("div",{class:"from-percent",style:$o({width:e.needReverse?((q=e.positionInfo)==null?void 0:q.toPercent)+"%":((w=e.positionInfo)==null?void 0:w.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:$o({width:e.needReverse?((I=e.positionInfo)==null?void 0:I.fromPercent)+"%":((i=e.positionInfo)==null?void 0:i.toPercent)+"%"})},null,4)])])]),n("div",ki,[n("div",_i,[wi,n("div",null,[Pe(n("img",yi,null,512),[[r,(e.needReverse?(k=e.toCoin)==null?void 0:k.logo_url:(v=e.fromCoin)==null?void 0:v.logo_url)||e.getCoinIcon(e.needReverse?(te=e.positionInfo)==null?void 0:te.token_b:(l=e.positionInfo)==null?void 0:l.token_a)]]),re(T,{address:e.needReverse?(A=(H=e.positionInfo)==null?void 0:H.token_b)==null?void 0:A.address:(ie=(K=e.positionInfo)==null?void 0:K.token_a)==null?void 0:ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.needReverse?(N=e.positionInfo)==null?void 0:N.amountB:(M=e.positionInfo)==null?void 0:M.amountA,e.needReverse?(se=(Q=e.positionInfo)==null?void 0:Q.token_b)==null?void 0:se.decimals:(x=(X=e.positionInfo)==null?void 0:X.token_a)==null?void 0:x.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)?(y(),S("div",Ii,W(("addCommom"in e?e.addCommom:J(Z))(e.afterBase))+" after ",1)):de("",!0)]),n("div",Ai,[Ci,n("div",null,[Pe(n("img",$i,null,512),[[r,(e.needReverse?(ge=e.fromCoin)==null?void 0:ge.logo_url:(V=e.toCoin)==null?void 0:V.logo_url)||e.getCoinIcon(e.needReverse?(be=e.positionInfo)==null?void 0:be.token_a:(U=e.positionInfo)==null?void 0:U.token_b)]]),re(T,{address:e.needReverse?($e=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:$e.address:(Be=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:Be.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.needReverse?(c=e.positionInfo)==null?void 0:c.amountA:(d=e.positionInfo)==null?void 0:d.amountB,e.needReverse?(F=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:F.decimals:(j=(C=e.positionInfo)==null?void 0:C.token_b)==null?void 0:j.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)?(y(),S("div",Si,W(("addCommom"in e?e.addCommom:J(Z))(e.afterQuote))+" after ",1)):de("",!0)])]),n("div",Pi,[n("div",Ti,[n("div",Ni,W(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[me(" $"+W(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(y(),S("span",Ri,"$0 after")):de("",!0)])]),n("div",Oi,[re(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.canClaimYield==0,onClick:t[0]||(t[0]=he=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[me("Claim")]),_:1},8,["loading","disabled"])])]),n("div",qi,[n("div",Li,[n("div",null,[Bi,n("div",null,[Pe(n("img",null,null,512),[[r,(e.needReverse?(ee=e.toCoin)==null?void 0:ee.logo_url:(Y=e.fromCoin)==null?void 0:Y.logo_url)||e.getCoinIcon(e.needReverse?(fe=e.positionInfo)==null?void 0:fe.token_b:(ue=e.positionInfo)==null?void 0:ue.token_a)]]),re(T,{address:e.needReverse?(ce=(E=e.positionInfo)==null?void 0:E.token_b)==null?void 0:ce.address:(O=(_e=e.positionInfo)==null?void 0:_e.token_a)==null?void 0:O.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(B=(G=e.positionInfo)==null?void 0:G.token_b)==null?void 0:B.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,($=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:$.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",Mi," 0 after ")):de("",!0)]),n("div",null,[Ui,n("div",null,[Pe(n("img",null,null,512),[[r,(e.needReverse?(ae=e.fromCoin)==null?void 0:ae.logo_url:(le=e.toCoin)==null?void 0:le.logo_url)||e.getCoinIcon(e.needReverse?(Te=e.positionInfo)==null?void 0:Te.token_a:(we=e.positionInfo)==null?void 0:we.token_b)]]),re(T,{address:e.needReverse?(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.address:(Re=(Ce=e.positionInfo)==null?void 0:Ce.token_b)==null?void 0:Re.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(Fe=(je=e.positionInfo)==null?void 0:je.token_a)==null?void 0:Fe.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(Oe=(Qe=e.positionInfo)==null?void 0:Qe.token_b)==null?void 0:Oe.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",ji," 0 after ")):de("",!0)]),e.chainName=="Sui"?(y(),S(Ve,{key:0},[e.pendingRewarderArr.length==0&&((Ae=(Ze=(We=e.positionInfo)==null?void 0:We.poolInfo)==null?void 0:Ze.rewarderInfo)==null?void 0:Ae.length)>0?(y(!0),S(Ve,{key:0},to(e.positionInfo.poolInfo.rewarderInfo,he=>(y(),S("div",{key:he.coinAddress},[Ei,n("div",Di,[Pe(n("img",Fi,null,512),[[r,e.getCoinIcon({address:he.coinAddress})]]),re(T,{address:he.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),re(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):de("",!0),(y(!0),S(Ve,null,to(e.pendingRewarderArr,he=>(y(),S("div",{key:he},[Wi,n("div",null,[Pe(n("img",Hi,null,512),[[r,he.logo_url]]),re(T,{address:he.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(he.amount>0?("showNum"in e?e.showNum:J(Se))(he.amount,he.decimals):0),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",Xi," 0 after ")):de("",!0)]))),128))],64)):de("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(y(),S("div",Yi,[n("div",zi,[Gi,n("div",null,[me(" $"+W(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(y(),S("span",Ji,"$0 after")):de("",!0)])]),n("div",Qi,[re(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[me("Claim")]),_:1},8,["loading","disabled","onClick"])])])):de("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(y(),S("div",Zi,[n("div",Ki,[(y(!0),S(Ve,null,to(e.pendingRewarderArr,he=>(y(),S("div",{key:he},[Vi,n("div",null,[Pe(n("img",xi,null,512),[[r,he.logo_url]]),re(T,{address:he.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(he.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(y(),S("div",es," 0 after ")):de("",!0)]))),128))])])):de("",!0)])}const zo=ze(ui,[["render",os]]),ns=Ye({components:{AssetsCard:ho},setup(e,t){const s=R(""),a=R(""),P=Xe(),h=_(()=>P),T=_(()=>h.value.theme),m=xe(),o=_(()=>m),r=R(!1),p=R(!1),u=R(!0),b=_(()=>h.value.chainName),L=_(()=>b.value?eo(b.value):{}),oe=mo(),ne=_(()=>oe),z=_(()=>h.value.slippage),f=R(),w=R(),q=_(()=>ne.value.assets&&f.value&&ne.value.assets[f.value.address]?Ao(ne.value.assets[f.value.address].balance,f.value.decimals):0),i=_(()=>ne.value.assets&&w.value&&ne.value.assets[w.value.address]?Ao(ne.value.assets[w.value.address].balance,w.value.decimals):0),I=c=>{c==="fromCoin"?(u.value=!0,b.value==="Aptos"?s.value=q.value>0?f.value.symbol=="APT"?new g(Number(q.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(q.value)).sub(new g(.1)).toString():String(q.value):"":s.value=q.value>0?f.value.symbol=="SUI"?new g(Number(q.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(q.value)).sub(new g(.05)).toString():String(q.value):""):(u.value=!1,b.value==="Aptos"?a.value=i.value>0?w.value.symbol=="APT"?new g(Number(i.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(i.value)).sub(new g(.1)).toString():String(i.value):"":a.value=i.value>0?w.value.symbol=="SUI"?new g(Number(i.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(i.value)).sub(new g(.05)).toString():String(i.value):"")},v=c=>{c==="fromCoin"?(u.value=!0,s.value=Ue(new g(Number(q.value)).div(2).toString(),f.value.decimals).toString()):(u.value=!1,a.value=Ue(new g(Number(i.value)).div(2).toString(),w.value.decimals).toString())},k=R({}),l=R(!0),te=R({}),K=R(),ie=R(),H=()=>{var E;if(!k.value||!s.value&&!a.value)return;const{TickMath:c,TickUtil:C}=L.value;let j=k.value.minPrice,D=k.value.maxPrice.indexOf("+")>0?"âˆž":k.value.maxPrice,F=Number(k.value.tick_lower_index),Y=Number(k.value.tick_upper_index);const ee=Number(k.value.current_tick_index);let ue,fe,_e=Number(j).toString(),O=k.value.maxPrice.indexOf("+")>0||k.value.maxPrice==="âˆž"?"âˆž":Number(D);if(_e=="0"&&O=="âˆž"?(F=Number(k.value.tick_lower_index),Y=Number(k.value.tick_upper_index)):(ue=c.priceToSqrtPriceX64(new g(j),f.value.decimals,w.value.decimals),fe=c.priceToSqrtPriceX64(new g(D),f.value.decimals,w.value.decimals)),K.value=F,ie.value=Y,D!=="âˆž"&&F>=Y){r.value=!0,s.value="",p.value=!0,a.value="";return}if(D=="âˆž"||ee>=F&&ee<Y){r.value=!1,p.value=!1;let ce;if(s.value||a.value){if(u.value){const ae=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(ae)}else{const ae=new g(a.value).mul(Math.pow(10,w.value.decimals)).toString();ce=new qe(ae)}const{liquidityAmount:pe,tokenMaxA:$,tokenMaxB:G,tokenMaxAOrigin:B,tokenMaxBOrigin:le}=L.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:w.value,lowerTick:F,upperTick:Y,coinAmount:ce,iscoinA:l.value?u.value:!u.value,roundUp:!0,slippage:Number(z.value)/100,curSqrtPrice:new qe(k.value.current_sqrt_price)});te.value={liquidityAmount:pe,tokenMaxA:$,tokenMaxB:G,tokenMaxAOrigin:B,tokenMaxBOrigin:le},l.value?u.value?a.value=Number(G)>0?G:"":s.value=Number($)>0?$:"":u.value?a.value=$:s.value=G}}else if(ee>=Y){if(s.value="",r.value=!0,p.value=!1,s.value||a.value){let ce;const pe=new g(a.value).mul(Math.pow(10,(E=w.value)==null?void 0:E.decimals)).toString();ce=new qe(pe),te.value={liquidityAmount:Bo(ue,fe,ce),tokenMaxA:0,tokenMaxB:a.value}}}else if(ee<F){if(r.value=!1,p.value=!0,a.value="",s.value||a.value){let ce;const pe=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(pe),te.value={liquidityAmount:Mo(ue,fe,ce),tokenMaxA:s.value,tokenMaxB:0}}}else r.value=!0,s.value="",p.value=!0,a.value="";m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,c=>{if(c&&!ve(c)){k.value=c,f.value=k.value.token_a,w.value=k.value.token_b;let C=Number(k.value.tick_lower_index),j=Number(k.value.tick_upper_index);const D=Number(k.value.current_tick_index);(c.maxPrice.indexOf("+")>0||c.maxPrice==="âˆž"?"âˆž":c.maxPrice)=="âˆž"||D>=C&&D<j?(r.value=!1,p.value=!1):D>=j?(s.value="",r.value=!0,p.value=!1):D<C?(r.value=!1,p.value=!0,a.value=""):(r.value=!0,s.value="",p.value=!0,a.value=""),H()}},{immediate:!0}),ye(s,(c,C)=>{c&&H(),c==""&&(a.value="")}),ye(a,(c,C)=>{c&&H(),c==""&&(s.value="")});const A=_(()=>{var c,C;return(C=(c=k.value)==null?void 0:c.poolInfo)==null?void 0:C.needReverse}),M=_(()=>o.value.RATES),N=_(()=>{var Y,ee,ue,fe;const c=((ee=M.value[(Y=f.value)==null?void 0:Y.address])==null?void 0:ee.price)||0,C=((fe=M.value[(ue=w.value)==null?void 0:ue.address])==null?void 0:fe.price)||0,j=new g(c).mul(new g(s.value||0)),D=new g(C).mul(new g(a.value||0)),F=j.add(D);return F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?Z(F.toString(),2):"<0.01":"--"}),X=R(!1),{t:x,locale:Q}=yo(),se=_(()=>{const c=Number(s.value)>Number(q.value),C=Number(a.value)>Number(i.value);return!s.value&&!a.value?x("button.enterAmount"):c?x("button.insufficientBalance",{name:f.value.symbol}):C?x("button.insufficientBalance",{name:w.value.symbol}):x("newAdd.addMore")}),V=_(()=>{const c=Number(s.value)>Number(q.value),C=Number(a.value)>Number(i.value);return!!(!s.value&&!a.value||c||C)}),{setIsShowSuccess:ge,setIsShowRejected:U,setIsShowWaiting:be,setTransactionDesc:Ie,setTransactionTxid:Be,setPositiomNum:Me}=P,$e=R(!1);return{theme:T,showFromCoinLock:r,showToCoinLock:p,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:q,toCoinBlance:i,fromCoin:f,toCoin:w,maxBtnSelect:I,halfBtnSelect:v,fixedFromCoin:u,needReverse:A,totalAmount:N,wallet:ne,addLiquidityBtnText:se,isShowLiquidityModal:X,indexStore:P,positionInfo:k,actionLoading:$e,toAdd:async()=>{var Y,ee,ue,fe,_e,O,E,ce,pe,$,G,B;X.value=!1,$e.value=!0,Be("");const c=r.value?"":`${s.value} ${(Y=f.value)==null?void 0:Y.symbol}`,C=p.value?"":`${a.value} ${(ee=w.value)==null?void 0:ee.symbol}`;Ie(x("tips.increaseLiquiditySuccess",{from:A.value?C:c,and:!r.value&&!p.value?"and":"",to:A.value?c:C})),be(!0);const j=u.value,D=k.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=D[0]?D[0].coinAddress:"",F.coinTypeD=D[1]?D[1].coinAddress:"",F.coinTypeE=D[2]?D[2].coinAddress:"";try{const le=await L.value.getAddLiquidityTransactionPayload({pool:{poolAddress:k.value.poolAddress,token_a:k.value.token_a,token_b:k.value.token_b},amount:j?te.value.tokenMaxA:te.value.tokenMaxB,fix_amount_a:j,tick_lower:K.value,tick_upper:ie.value,index:b.value==="Aptos"?k.value.index:k.value.pos_object_id,slippage:Number(z.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new qe(k==null?void 0:k.value.poolInfo.current_sqrt_price),positionInfo:k});let ae;if(b.value==="Aptos")ae=await ne.value.currentWallet.signAndSubmitTransaction(le);else{const we=await L.value.signAndExecuteTransactionBlock(ne.value.currentWallet,le==null?void 0:le.txb,le==null?void 0:le.payloadParams);ae=L.value.handleTx(we)}if(console.log("toAdd###tx###",ae),ae&&ae.hash){Be(ae.hash),be(!1),ge(!0);const we={title:"Supplied",desc:x("tips.addLiquiditySuccessText",{from:r.value?"":`${A.value?a.value:s.value} ${A.value?(fe=w==null?void 0:w.value)==null?void 0:fe.symbol:(ue=f.value)==null?void 0:ue.symbol}`,and:!r.value&&!p.value?"and":"",to:p.value?"":`${A.value?s.value:a.value} ${A.value?(O=f==null?void 0:f.value)==null?void 0:O.symbol:(_e=w.value)==null?void 0:_e.symbol}`}),hash:ae.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:A.value?`${(ce=w.value)==null?void 0:ce.address}`:`${(E=f.value)==null?void 0:E.address}`,numa:A.value?`- ${a.value}`:`- ${s.value}`,logoa:A.value?o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:A.value?`${($=f.value)==null?void 0:$.address}`:`${(pe=w.value)==null?void 0:pe.address}`,numb:A.value?`- ${s.value}`:`- ${a.value}`,logob:A.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI},text:`Deopsit ${r.value?"":`${s.value} ${(G=f.value)==null?void 0:G.symbol}`} ${!r.value&&!p.value?"and":""} ${p.value?"":`${a.value} ${(B=w.value)==null?void 0:B.symbol}`}`};b.value!=="Aptos"&&(we.res=ae.res),L.value.showTransitionPending(we),await L.value.watchTransaction(we)&&setTimeout(()=>{t.emit("getDetails"),L.value.getAccount(ne.value.address)},1e3),Me()}else be(!1),U(!0);s.value="",a.value="",$e.value=!1}catch(le){s.value="",a.value="",console.log("addError###",le),$e.value=!1,be(!1),U(!0)}},addLiquidityBtnDisabled:V,poolStore:m}}});const ts={class:"new-position-asset"},is={class:"add-or-remove"},ss={class:"liquidity-action-tab"},as=n("div",{class:"increase tab-active"}," Increase ",-1),ls={class:"card-item"},rs={class:"card-item"},us={key:0,class:"add",src:gn},ds={key:1,class:"add",src:bn},cs={class:"total-amount"},ms=n("span",null,"Total Amount",-1);function vs(e,t,s,a,P,h){var p;const T=ho,m=hn,o=co,r=kn;return y(),S("div",ts,[n("div",is,[n("div",ss,[as,n("div",{class:"remove",onClick:t[0]||(t[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ls,[re(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=u=>{e.fromCoinAmount=u}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(y(),Ne(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),n("div",rs,[re(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=u=>{e.toCoinAmount=u}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(y(),Ne(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(y(),S("img",us)):de("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(y(),S("img",ds)):de("",!0)],2),n("div",cs,[ms,n("span",null,"$"+W(e.totalAmount),1)])]),e.wallet.connected?(y(),Ne(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=u=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(y(),Ne(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(y(),Ne(r,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):de("",!0)])}const Go=ze(ns,[["render",vs]]),fs=Ye({components:{AssetsCard:ho},setup(e,t){const s=R(""),a=R(""),P=Xe(),h=_(()=>P),T=_(()=>h.value.theme),m=xe(),o=_(()=>m),r=R(!1),p=R(!1),u=R(!0),b=_(()=>h.value.chainName),L=_(()=>b.value?eo(b.value):{}),oe=mo(),ne=_(()=>oe),z=_(()=>h.value.slippage),f=R(),w=R(),q=_(()=>{var $,G;return(G=($=l.value)==null?void 0:$.poolInfo)==null?void 0:G.needReverse}),i=_(()=>{var $;return ke(l==null?void 0:l.value.amountA,($=l==null?void 0:l.value.token_a)==null?void 0:$.decimals)}),I=_(()=>{var $;return ke(l==null?void 0:l.value.amountB,($=l==null?void 0:l.value.token_b)==null?void 0:$.decimals)}),v=$=>{$==="fromCoin"?(u.value=!0,A.value||(b.value==="Aptos"||console.log(i.value,"213===>"),s.value=String(i.value))):(u.value=!1,A.value||(b.value,a.value=String(I.value))),N.value=100,x({value:1})},k=$=>{$==="fromCoin"?(u.value=!0,s.value=Ue(new g(Number(i.value)).div(2).toString(),f.value.decimals).toString()):(u.value=!1,a.value=Ue(new g(Number(I.value)).div(2).toString(),w.value.decimals).toString()),A.value=!1},l=R({}),te=R(!0),K=R({}),ie=R(),H=R(),A=R(!0),M=()=>{var Qe;if(A.value||!l.value||!s.value&&!a.value||Number(s.value)>Number(i.value)||Number(a.value)>Number(I.value))return;if(s.value==i.value&&a.value==I.value){N.value=100,x({value:1}),A.value=!0;return}const{TickMath:$,TickUtil:G}=L.value;let B=l.value.minPrice,le=l.value.maxPrice.indexOf("+")>0?"âˆž":l.value.maxPrice,ae=Number(l.value.tick_lower_index),we=Number(l.value.tick_upper_index);const Te=Number(l.value.current_tick_index);let Ce,Re,Ee=Number(B).toString(),De=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="âˆž"?"âˆž":Number(le);if(Ee=="0"&&De=="âˆž"?(ae=Number(l.value.tick_lower_index),we=Number(l.value.tick_upper_index)):(Ce=$.priceToSqrtPriceX64(new g(B),f.value.decimals,w.value.decimals),Re=$.priceToSqrtPriceX64(new g(le),f.value.decimals,w.value.decimals)),ie.value=ae,H.value=we,le!=="âˆž"&&ae>=we){r.value=!0,s.value="",p.value=!0,a.value="";return}if(le=="âˆž"||Te>=ae&&Te<we){r.value=!1,p.value=!1;let Oe;if(s.value||a.value){if(u.value){const he=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(he)}else{const he=new g(a.value).mul(Math.pow(10,w.value.decimals)).toString();Oe=new qe(he)}const{liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae}=L.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:w.value,lowerTick:ae,upperTick:we,coinAmount:Oe,iscoinA:te.value?u.value:!u.value,roundUp:b.value!="Sui",slippage:Number(z.value)/100,curSqrtPrice:new qe(l.value.current_sqrt_price)});K.value={liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae},te.value?u.value?a.value=Number(We)>0?We:"":s.value=Number(Fe)>0?Fe:"":u.value?a.value=Fe:s.value=We}}else if(Te>=we){if(s.value="",r.value=!0,p.value=!1,s.value||a.value){let Oe;const je=new g(a.value).mul(Math.pow(10,(Qe=w.value)==null?void 0:Qe.decimals)).toString();Oe=new qe(je),K.value={liquidityAmount:Bo(Ce,Re,Oe),tokenMaxA:0,tokenMaxB:a.value}}}else if(Te<ae){if(r.value=!1,p.value=!0,a.value="",s.value||a.value){let Oe;const je=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(je),K.value={liquidityAmount:Mo(Ce,Re,Oe),tokenMaxA:s.value,tokenMaxB:0}}}else r.value=!0,p.value=!0;A.value=!1,N.value=new g(K.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),X.value=K.value.liquidityAmount,m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})},N=R(0),X=R("0"),x=$=>{if(console.log("setPercent isSlider.value: ",A.value),!A.value)return;A.value=!0;const G=l.value.token_a.decimals,B=l.value.token_b.decimals,le=l.value.tick_lower_index,ae=l.value.tick_upper_index,we=So.tickIndexToSqrtPriceX64(le),Te=So.tickIndexToSqrtPriceX64(ae);let Ce="";$.value!==1?Ce=new g(l.value.liquidity).mul($.value).toString():Ce=l.value.liquidity,Ce=Ue(Ce,0)||"0",X.value=Ce;const Re=cn.getCoinAmountFromLiquidity(new qe(Ce),new qe(l.value.current_sqrt_price),we,Te,b.value!="Sui"),Ee=new g(Re.coinA.toString()).div(Math.pow(10,G)).toString(),De=new g(Re.coinB.toString()).div(Math.pow(10,B)).toString();s.value=Number(Ee)>0?Ee:"",a.value=Number(De)>0?De:"",m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,$=>{if($&&!ve($)){l.value=$,f.value=l.value.token_a,w.value=l.value.token_b,x({value:N.value/100});let G=Number(l.value.tick_lower_index),B=Number(l.value.tick_upper_index);const le=Number(l.value.current_tick_index);($.maxPrice.indexOf("+")>0||$.maxPrice==="âˆž"?"âˆž":$.maxPrice)=="âˆž"||le>=G&&le<B?(r.value=!1,p.value=!1):le>=B?(s.value="",r.value=!0,p.value=!1):le<G?(r.value=!1,p.value=!0,a.value=""):(r.value=!0,s.value="",p.value=!0,a.value=""),M()}},{immediate:!0}),ye(s,($,G)=>{$&&M(),$==""&&(a.value="",N.value=0)}),ye(a,($,G)=>{$&&M(),$==""&&(s.value="",N.value=0)});const Q=_(()=>o.value.RATES),se=_(()=>{var we,Te,Ce,Re;const $=((Te=Q.value[(we=f.value)==null?void 0:we.address])==null?void 0:Te.price)||0,G=((Re=Q.value[(Ce=w.value)==null?void 0:Ce.address])==null?void 0:Re.price)||0,B=new g($).mul(new g(s.value||0)),le=new g(G).mul(new g(a.value||0)),ae=B.add(le);return Z(ae.toString(),2)}),V=R(!1),{t:ge,locale:U}=yo(),be=_(()=>{const $=Number(s.value)>Number(i.value),G=Number(a.value)>Number(I.value);return!s.value&&!a.value?ge("button.enterAmount"):$||G?"Invalid Amount":ge("button.remove")}),Ie=_(()=>{const $=Number(s.value)>Number(i.value),G=Number(a.value)>Number(I.value);return!!(!s.value&&!a.value||$||G)}),{setIsShowSuccess:Be,setIsShowRejected:Me,setIsShowWaiting:$e,setTransactionDesc:d,setTransactionTxid:c,setPositiomNum:C,setTransactionDescText:j}=P,D=R(!1);ye(N,sn(($,G)=>{$!==G&&(Number($)>100?N.value=100:$&&l.value?(N.value=$,x({value:N.value/100})):(s.value="",a.value=""))},300)),ye(z,$=>{$&&l.value&&x({value:N.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],Y=jo(),ee=_(()=>Y),ue=_(()=>ee.value.status),fe=R(!1),_e=$=>{$.sources.forEach(B=>{const{pool_address:le,position_index:ae}=JSON.parse(B.blockchainAddress);le==l.value.poolAddress&&Number(ae)==Number(l.value.index)&&(fe.value=!0)})},O=async()=>{await Y.getSources();let $;ee.value.allSources.forEach(G=>{const{pool_address:B,position_index:le}=JSON.parse(G.blockchainAddress);B==l.value.poolAddress&&le==l.value.index&&($=G.id)}),Y.deleteSource($)};ye(()=>[ee.value.sourceGroups,l.value],([$,G])=>{$&&$.sources&&$.sources.length>0&&G&&!ve(G)&&_e($)},{immediate:!0,deep:!0});const E=lo(),ce=fo();return{theme:T,showFromCoinLock:r,showToCoinLock:p,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:i,toCoinBlance:I,fromCoin:f,toCoin:w,maxBtnSelect:v,halfBtnSelect:k,fixedFromCoin:u,needReverse:q,totalAmount:se,wallet:ne,addLiquidityBtnText:be,isShowLiquidityModal:V,indexStore:P,positionInfo:l,actionLoading:D,addLiquidityBtnDisabled:Ie,sliderVal:N,ratioArr:F,setPercent:x,poolStore:m,isSlider:A,toRemove:async()=>{var ae,we,Te,Ce,Re,Ee,De,Qe,Oe,je,Fe,We,Ze;D.value=!0,c("");const $=Z(s.value,f.value.decimals)==0?"":`${ke(s.value,f.value.decimals)} ${f.value.symbol}`,G=Z(a.value,w.value.decimals)==0?"":`${ke(a.value,w.value.decimals)} ${w.value.symbol}`;d(ge("tips.removeLiquidiyText",{from:q.value?G:$,and:Z(s.value,f.value.decimals)==0||Z(a.value,w.value.decimals)==0?"":"and",to:q.value?$:G})),$e(!0);const B=l.value.poolInfo.rewarder_infos,le=B&&B.length>0&&b.value=="Sui"||B&&B.length>0&&N.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");j(le);try{let Ae={};Ae={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:N.value==100?new qe(l.value.liquidity):new qe(Ue(X.value,0)),slippage:Number(z.value),rewards_num:B.length,positionInfo:l.value},Ae.coinTypeC=B[0]?B[0].coinAddress:"",Ae.coinTypeD=B[1]?B[1].coinAddress:"",Ae.coinTypeE=B[2]?B[2].coinAddress:"";const he=await L.value.getRemoveLiquidityTransactionPayload(Ae);let He;if(b.value==="Aptos")He=await ne.value.currentWallet.signAndSubmitTransaction(he);else{const ro=await L.value.signAndExecuteTransactionBlock(ne.value.currentWallet,he.txb,he==null?void 0:he.payloadParams);He=L.value.handleTx(ro),console.log("0331###remove###tx####",He)}if(He&&He.hash){c(He.hash),$e(!1),Be(!0);const ro={title:ge("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${s.value} ${(ae=f.value)==null?void 0:ae.symbol} and ${a.value} ${(we=w.value)==null?void 0:we.symbol} 
             from the pool`,sender:ne.value.address,chainName:b.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:q.value?`${(Ce=w.value)==null?void 0:Ce.address}`:`${(Te=f.value)==null?void 0:Te.address}`,numa:q.value?`+ ${a.value}`:`+ ${s.value}`,logoa:q.value?o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:q.value?`${(Re=f.value)==null?void 0:Re.address}`:`${(Ee=w.value)==null?void 0:Ee.address}`,numb:q.value?`+ ${s.value}`:`+ ${a.value}`,logob:q.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&w.value&&w.value.address&&o.value.tokensObj[w.value.address]&&o.value.tokensObj[w.value.address].logoURI},text:`Withdraw ${s.value} ${(De=f.value)==null?void 0:De.symbol} and ${a.value} ${(Qe=w.value)==null?void 0:Qe.symbol}`};b.value!=="Aptos"&&(ro.res=He.res),L.value.showTransitionPending(ro);const Io=await L.value.watchTransaction(ro);if(B.value&&B.value.length>0&&(Number((Oe=B[0])==null?void 0:Oe.amount)!==0||Ae.coinTypeD&&Number((je=B[1])==null?void 0:je.amount)!==0||Ae.coinTypeE&&Number((Fe=B[2])==null?void 0:Fe.amount)!==0)){const go={title:ge("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:B[0].symbol,numa:`+ ${Number(B[0].amount)}`,logoa:o.value.tokensObj&&B[0]&&B[0].address&&o.value.tokensObj[B[0].address]&&o.value.tokensObj[B[0].address].logoURI,tokenb:Ae.coinTypeD?B[1].symbol:"",numb:Ae.coinTypeD?`+ ${Number(B[1].amount)}`:"",logob:Ae.coinTypeD?o.value.tokensObj&&B[1]&&B[1].address&&o.value.tokensObj[B[1].address]&&o.value.tokensObj[B[1].address].logoURI:"",tokenc:Ae.coinTypeE?B[2].symbol:"",numc:Ae.coinTypeE?`+ ${Number(B[2].amount)}`:"",logoc:Ae.coinTypeE?o.value.tokensObj&&B[2]&&B[2].address&&o.value.tokensObj[B[2].address]&&o.value.tokensObj[B[2].address].logoURI:""},text:`Withdraw ${s.value} ${(We=f.value)==null?void 0:We.symbol} and ${a.value} ${(Ze=w.value)==null?void 0:Ze.symbol}`},Ko=await L.value.setTransations(go)}if(Se(l.value.feeOwedA,l.value.token_a.decimals)!==0||Se(l.value.feeOwedB,l.value.token_b.decimals)!==0){const go={title:"Claim",desc:"",hash:He.hash,chainName:b.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Z(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Se(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Z(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Z(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Se(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Z(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},Ko=await L.value.setTransations(go)}Io&&Number(N.value)==100&&ue.value=="authenticated"&&fe.value&&(await Y.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),O()),Io&&(s.value="",a.value="",setTimeout(()=>{Number(N.value)!==100&&t.emit("getDetails")},3e3),setTimeout(()=>{Number(N.value)!==100&&t.emit("getDetails")},6e3),Number(N.value)==100&&ce.name=="new-position-detail"&&(b.value==="Aptos"?E.push("/position"):E.push("/pool/position")),N.value=0)}else $e(!1),Me(!0);D.value=!1}catch(Ae){console.log("Remove error",Ae),D.value=!1,$e(!1),Me(!0)}},sFixD:Ue}}});const ps={class:"new-position-asset"},hs={class:"add-or-remove"},gs={class:"liquidity-action-tab"},bs=n("div",{class:"remove tab-active"},"Remove",-1),ks={class:"card-item"},_s={key:0,class:"assets-card-mask"},ws={class:"card-item"},ys={key:0,class:"assets-card-mask"},Is={class:"remove-ratio"},As=n("div",{class:"remove-ratio-title"},"Amount",-1),Cs={class:"remove-ratio-select"},$s={key:0,class:"ratio"},Ss={key:1,class:"ratio"},Ps={class:"ratio-list"},Ts=["onClick"];function Ns(e,t,s,a,P,h){const T=ho,m=an,o=co;return y(),S("div",ps,[n("div",hs,[n("div",gs,[n("div",{class:"increase",onClick:t[0]||(t[0]=r=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),bs]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ks,[re(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=r=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=r=>{e.fromCoinAmount=r,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(y(),S("div",_s)):de("",!0)]),n("div",ws,[re(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=r=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=r=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=r=>{e.toCoinAmount=r,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(y(),S("div",ys)):de("",!0)])],2),n("div",Is,[As,n("div",Cs,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(y(),S("div",$s,W(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))+"% ",1)):(y(),S("div",Ss," -- ")),n("div",Ps,[(y(!0),S(Ve,null,to(e.ratioArr,(r,p)=>(y(),S("div",{key:p,class:vo(["ratio-item",e.sliderVal==r.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=r.value}},W(r.name),11,Ts))),128))])]),re(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=r=>e.sliderVal=r)},null,8,["value"])])]),e.wallet.connected?(y(),Ne(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(y(),Ne(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=r=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1}))])}const Jo=ze(fs,[["render",Ns]]),Rs=Ye({setup(){const e=xe(),t=_(()=>e),s=Eo(),a=_(()=>s),P=lo(),h=_(()=>t.value.currentPositionInfo),T=R(),m=H=>{var A;return((A=t.value.tokensObj[H])==null?void 0:A.logo_url)||io("/image/coins/sui-unknown.png")},o=en("Sui"),r=R(),p=async H=>{r.value=0;try{const A=await o.calculateFarmingRewards([{pool_id:H.pool_id,position_nft_id:H.id}]),M=[];let N=new g(0);A[H.id].forEach((X,x)=>{var V;const Q=(V=t.value.tokensObj[X.rewarder_type])==null?void 0:V.decimals;let se=new g(X.rewarder_amount).div(Math.pow(10,Q)).toString();Number(se)>0&&b.value.rewarders[x]&&(N=N.add(se),M.push({...X,rewarderAmount:se,rewarderAmountPer:se}))}),r.value=N,T.value=M}catch(A){console.log(A,"getRewarder")}},u=_(()=>a.value.farmsPoolObj),b=_(()=>u.value[h.value.poolAddress]);ye(()=>[h.value,u.value,b.value],([H,A,M])=>{var N;!ve(H)&&H.positionSource=="farming"&&!ve(M)?p(H):!ve(A)&&!ve(H)&&(T.value=(N=A[H.poolAddress])==null?void 0:N.rewarders)},{immediate:!0});const L=mo(),oe=_(()=>L),ne=Xe(),z=eo("Sui"),{setIsShowSuccess:f,setIsShowRejected:w,setIsShowWaiting:q,setTransactionDesc:i,setTransactionTxid:I}=ne,v=R(!1),k=async()=>{v.value=!0,I(""),i("Claim rewards"),q(!0);const H={pool_id:h.value.pool_id,position_nft_id:h.value.id};try{const A=await o.harvestFarms(H),M=await z.signAndExecuteTransactionBlock(oe.value.currentWallet,A.txb,A.payloadParams);console.log("0221###sui swap res###",M);let N=z.handleTx(M);if(N&&N.hash){I(N.hash),q(!1),f(!0);let X={title:"Claim",res:N.res,hash:N.hash};z.showTransitionPending(X),await z.watchTransaction(X)&&setTimeout(()=>{p(h.value),z.getAccount(oe.value.address)},2e3)}else q(!1),w(!0);v.value=!1}catch(A){console.log("farmsDeposit error",A),q(!1),w(!0),v.value=!1}},l=async()=>{v.value=!0,I(""),i(`Unstake ${h.value.name}`),q(!0);const H=h.value.pool_id,A=h.value.id;try{const M=await o.farmsWithdraw(H,A),N=await z.signAndExecuteTransactionBlock(oe.value.currentWallet,M.txb,M.payloadParams);console.log("0221###sui swap res###",N);let X=z.handleTx(N);if(X&&X.hash){I(X.hash),q(!1),f(!0);let x={res:X.res,title:"Unstake",hash:X.hash};z.showTransitionPending(x),await z.watchTransaction(x)&&setTimeout(()=>{P.replace(`/new-position-detail?token=${h.value.tokenName}&address=${h.value.clmm_pool_id}&pos=${h.value.clmm_position_id}`),t.value.setCurrentPositionInfo(h.value.clmm_pool_id,"",h.value.tokenName,"Sui",h.value.clmm_position_id),r.value=0,v.value=!1},2e3)}else q(!1),w(!0)}catch(M){console.log("farmsDeposit error",M),q(!1),w(!0),v.value=!1}},te=async()=>{v.value=!0,I(""),i(`Stake ${h.value.name}`),q(!0);const H={clmm_pool_id:h.value.poolAddress,clmm_position_id:h.value.pos_object_id,coinTypeA:h.value.coin_type_a,coinTypeB:h.value.coin_type_b},A=u.value[h.value.poolAddress].id;try{const M=await o.farmsDeposit(H,A),N=await z.signAndExecuteTransactionBlock(oe.value.currentWallet,M.txb,M.payloadParams);console.log("0221###sui swap res###",N);let X=z.handleTx(N);if(X&&X.hash){I(X.hash),q(!1),f(!0);let x={res:X.res,title:"Staked",hash:X.hash};z.showTransitionPending(x);const Q=await z.watchTransaction(x,!0);let se;Q!=null&&Q.status&&setTimeout(async()=>{var V,ge;(ge=(V=Q==null?void 0:Q.res)==null?void 0:V.events)==null||ge.forEach(U=>{U.type.indexOf("::pool::DepositEvent")>-1&&(se=U.parsedJson.wrapped_position_id)}),P.replace(`/new-position-detail?position_nft_id=${se}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",se,"farming"),v.value=!1},2e3)}else q(!1),w(!0)}catch(M){console.log("farmsDeposit error",M),q(!1),w(!0),v.value=!1}},K=_(()=>ne),ie=_(()=>K.value.addressLpTokens);return{getCoinIcon:m,rewardList:T,sFixD:Ue,addCommom:Z,claim:k,unStake:l,loading:v,totalRewardAmount:r,currentPositionInfo:h,stake:te,farmsPoolObj:u,addressLpTokens:ie,farmsPoolInfo:b}}});const oo=e=>(so("data-v-b105cc87"),e=e(),ao(),e),Os={key:0,class:"farms-position-detail"},qs={class:"farms-top"},Ls=oo(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),Bs={class:"right"},Ms={class:"apr"},Us={class:"apr-tips-box"},js=oo(()=>n("span",null,"View",-1)),Es=oo(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ds=[js,Es],Fs={class:"farms-bottom"},Ws=oo(()=>n("div",{class:"title"},"Farming Rewards",-1)),Hs={key:0,class:"reward-list"},Xs={key:0,class:"rewards-item-bg"},Ys={class:"rewards-item-box"},zs={alt:""},Gs={key:1},Js={class:"rewards-item-bg"},Qs={class:"rewards-item-box"},Zs={alt:""},Ks=oo(()=>n("span",null,"0",-1)),Vs={key:1,class:"reward-list"},xs={key:0,class:"rewards-item-bg"},ea={class:"rewards-item-box"},oa={alt:""},na=oo(()=>n("span",null,"0",-1)),ta={key:1},ia={class:"rewards-item-bg"},sa={class:"rewards-item-box"},aa={alt:""},la=oo(()=>n("span",null,"0",-1)),ra={class:"actions-box"};function ua(e,t,s,a,P,h){var p,u,b;const T=_n,m=co,o=qo,r=wo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(y(),S("div",Os,[n("div",qs,[Ls,n("div",Bs,[n("div",Ms,[me(" APRÂ  "),n("span",null,[me(W(("addCommom"in e?e.addCommom:J(Z))(((p=e.farmsPoolInfo)==null?void 0:p.total_apr)*100,2))+"%Â  ",1),n("div",Us,[re(T,{"l-item":e.farmsPoolInfo,"rewarder-info":(b=(u=e.farmsPoolInfo)==null?void 0:u.rewarder)==null?void 0:b.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=L=>e.$router.push("/farms"))},Ds)])]),n("div",Fs,[Ws,e.rewardList&&e.rewardList.length>0?(y(),S("div",Hs,[(y(!0),S(Ve,null,to(e.rewardList,L=>(y(),S("div",{key:L,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(y(),S("div",Xs,[n("div",Ys,[Pe(n("img",zs,null,512),[[r,e.getCoinIcon(L.rewarder_type)]]),n("span",null,W(("addCommom"in e?e.addCommom:J(Z))(L.rewarderAmount||0)),1)])])):(y(),S("div",Gs,[n("div",Js,[n("div",Qs,[Pe(n("img",Zs,null,512),[[r,e.getCoinIcon(L.reward_coin)]]),Ks])])]))]))),128))])):(y(),S("div",Vs,[(y(!0),S(Ve,null,to(e.currentPositionInfo.rewards,L=>(y(),S("div",{key:L,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(y(),S("div",xs,[n("div",ea,[Pe(n("img",oa,null,512),[[r,e.getCoinIcon(L.rewarder_type)]]),na])])):(y(),S("div",ta,[n("div",ia,[n("div",sa,[Pe(n("img",aa,null,512),[[r,e.getCoinIcon(L.reward_coin)]]),la])])]))]))),128))])),n("div",ra,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(y(),Ne(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[me("Unstake")]),_:1},8,["loading","onClick"])):de("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(y(),Ne(o,{key:1},{title:Le(()=>[me("Farming rewards are only available for active positions.")]),default:Le(()=>[re(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[me("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(y(),Ne(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[me("Stake")]),_:1},8,["loading","onClick"])):de("",!0),re(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Lo(e.claim,["stop"])},{default:Le(()=>[me("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):de("",!0)}const Qo=ze(Rs,[["render",ua],["__scopeId","data-v-b105cc87"]]),da=Ye({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=jo(),s=_(()=>t),a=_(()=>s.value.status),P=Xe(),h=R(!1);ye(()=>a.value,r=>{r=="authenticated",h.value=!1},{immediate:!0});const T=R(!1),m=async()=>{T.value=!T.value;const r={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},p=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(r,p,T.value)}catch{T.value=!T.value}},o=r=>{const p=r.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",p),T.value=p.some(u=>JSON.parse(u.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(u.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return lo(),ye(()=>[s.value.sourceGroups,e.positionInfo],([r,p])=>{T.value=!1,r&&r.length>0&&r[0]&&p&&!ve(p)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),o(r[0]))},{immediate:!0,deep:!0}),{importIcon:io,isShowSetUp:h,changeSwitch:m,checked:T,notifiStatus:a,store:P}}});const ca=e=>(so("data-v-1a37a36d"),e=e(),ao(),e),ma={class:"range-alerts"},va={class:"range-alerts-top"},fa={class:"title"},pa=ca(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ha={key:1,class:"h5-switch-box"},ga={class:"range-alerts-bottom"},ba={key:0,class:"pc-switch-box"};function ka(e,t,s,a,P,h){const T=co,m=ln;return y(),S("div",ma,[n("div",va,[n("div",fa,[pa,e.isShowSetUp||e.notifiStatus!=="authenticated"?(y(),Ne(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Lo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[me(" Set up ")]),_:1})):de("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(y(),S("div",ha,[re(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])]),n("div",ga,[me(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(y(),S("div",ba,[re(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])])}const Zo=ze(da,[["render",ka],["__scopeId","data-v-1a37a36d"]]),_a=Ye({components:{NewPositionTitle:Ho,NewPositionInfo:Yo,NewPositionLiquidity:zo,NewPositionAssetAdd:Go,NewPositionAssetRemove:Jo,NewPositionNotifi:Zo,FarmsPositionDetail:Qo},setup(){const e=R(),t=R(),s=R(),a=Xe(),P=_(()=>a),h=_(()=>P.value.chainName),T=xe(),m=_(()=>T),o=Eo(),r=_(()=>o),p=lo();Ro(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0)});const u=async()=>{m.value.setCurrentPositionLoading(!0);const i=p.currentRoute.value.query.token||"",I=p.currentRoute.value.query.collect||"",v=p.currentRoute.value.query.address||"",k=p.currentRoute.value.query.pos||"",l=p.currentRoute.value.query.id||"",te=p.currentRoute.value.query.positionSource||"",K=p.currentRoute.value.query.position_nft_id||"";h.value==="Aptos"?i&&I&&v&&m.value.setCurrentPositionInfo(v,I,i,h.value):i&&v&&k?m.value.setCurrentPositionInfo(v,I,i,h.value,k):l&&!te?m.value.setCurrentPositionInfo("","","",h.value,l):m.value.setCurrentPositionInfo("","","",h.value,K,te)};ye(()=>m.value.poolConfigObj,i=>{i&&!ve(i)&&u()},{immediate:!0});const b=_(()=>m.value.currentPositionLoading),L=_(()=>{var I,v,k;const i=((k=(v=(I=p==null?void 0:p.currentRoute)==null?void 0:I.value)==null?void 0:v.query)==null?void 0:k.address)||"";return i&&m.value.addressLpTokens&&!ve(m.value.addressLpTokens)&&m.value.addressLpTokens[i]?m.value.addressLpTokens[i]:null});ye(()=>L.value,(i,I)=>{i&&!ve(i)&&(e.value=i),i&&!ve(i)&&i.current_sqrt_price!==(I==null?void 0:I.current_sqrt_price)&&u()},{immediate:!0});const oe=fo();ye(()=>[m.value.currentPositionInfo,h.value],([i,I])=>{var v;(I=="Aptos"&&i||I=="Sui"&&i&&(i==null?void 0:i.nftHash)==((v=oe==null?void 0:oe.query)==null?void 0:v.pos))&&(e.value=i,t.value=e.value.token_a,s.value=e.value.token_b)},{immediate:!0});const ne=_(()=>m.value.positionDetailCurrentTab),z=mo(),f=_(()=>z);_(()=>P.value.theme);const w=_(()=>h.value?eo(h.value):{}),q=()=>{u(),f.value.address&&w.value.getAccount(f.value.address)};return ye(()=>e.value,i=>{var I,v,k,l;((i==null?void 0:i.positionSource)==="farming"||(I=i==null?void 0:i.poolInfo)!=null&&I.stable_farming)&&!((k=(v=r==null?void 0:r.value)==null?void 0:v.farmsPoolObj)!=null&&k[i==null?void 0:i.poolAddress])&&!((l=r==null?void 0:r.value)!=null&&l.farmsPoolListLoading)&&r.value.getFarmsPoolList(!1)},{deep:!0}),No(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:s,getDetails:u,currentPositionLoading:b,positionDetailCurrentTab:ne,clickRefresh:q,chainName:h}}});const wa={class:"new-position-detail"},ya={class:"new-position-content"},Ia={class:"left"},Aa={class:"right"},Ca={class:"loading-global"};function $a(e,t,s,a,P,h){const T=Ho,m=Yo,o=zo,r=Go,p=Jo,u=Qo,b=Zo,L=rn;return y(),S("div",wa,[re(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",ya,[n("div",Ia,[re(m),re(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",Aa,[e.positionDetailCurrentTab=="increase"?(y(),Ne(r,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(y(),Ne(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),re(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(y(),Ne(u,{key:2})):de("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(y(),Ne(b,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):de("",!0)])]),Pe(n("div",Ca,[re(L)],512),[[Oo,e.currentPositionLoading]])])}const nl=ze(_a,[["render",$a],["__scopeId","data-v-4f69962b"]]);export{nl as default};
