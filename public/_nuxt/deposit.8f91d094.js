import{a as st,r as T,m as f,q as Et,A as Ie,e as lt,o as B,f as W,I as ii,M as ni,h as s,N as Ot,x as D,u as be,G as ye,c as rt,p as Ct,k as It,O as Dt,z as Ht,L as Ft,s as Xt,l as Se,i as ue,F as $t,E as Bt,j as gt,y as vt,S as oi,Y as xt,w as it,P as Wt,$ as ai,b as Zt,B as Gt,a0 as ri}from"./entry.c44b21e1.js";/* empty css              */import{positionError as ct,fromCoin as _,toCoin as h,tickList as ut,currentPrice as mt,currentPriceReverse as wt,direction as _e,currentPriceTab as X,defaultMinPrice as qt,defaultMaxPrice as Nt,minPrice as w,maxPrice as b,toggle as Jt,isStableFarmingRange as Re,isInputTotalAmount as Xe,priceConfigObj as at,fromCoinAmount as F,toCoinAmount as R,fixedFromCoin as Oe,resetTickList as jt,resetData as si}from"./data.58a811ee.js";import{g as Kt,n as Mt,d as ke,a as Te,c as re,b as Yt,o as li,s as ui,p as Ut}from"./common.2e5eaeac.js";/* empty css              */import"./index.4c764fc8.js";/* empty css              */import{u as dt,b as Rt,a as St}from"./index.c5a5bd81.js";import{T as yt,g as ci,c as di,u as vi,b as Ue}from"./index.556eb1a4.js";import"./decimal.a2826370.js";import{s as Pt,m as mi,l as fi,b as gi,a as pi}from"./transform.c672907f.js";import{D as m}from"./decimal.765d8738.js";import{R as bi,c as ki,S as hi,a as _i,b as yi}from"./sui-liquidity-price.628378b5.js";import{i as ft}from"./import-icon.de3e6c66.js";import{u as Tt}from"./farms.7e1eb618.js";import{_ as Qt}from"./icon_farms_2x.0dc8465b.js";import{_ as Pi}from"./coin-select.daadd68b.js";import{I as wi}from"./icon-tooltip.3cfdbd2d.js";import{_ as Ci}from"./status-block.1c8eb6f9.js";import{C as Ii}from"./coin-img.71f49c95.js";import{_ as Vt}from"./icon-arrow_2x.4ffddb8e.js";import{I as Si}from"./input-lock.befb33c2.js";import{u as Ti}from"./notifi.d27d3e26.js";import{T as Ai}from"./token-input-block.98b3af14.js";import{_ as Li}from"./lock.35e1d915.js";import"./icon-slippage.f3e90b68.js";import"./swap-setting.16500fe0.js";/* empty css              */import"./icon-error_2x.211e21cf.js";import"./icon-refresh.492528a0.js";import"./coin-img-warning.535e3e69.js";import"./token.1f9d0593.js";import"./deposit-ratio.63016f45.js";import"./sui-status-block.9bd1fb2a.js";import"./token-warning_2x.e34d7e22.js";import"./img-no-Positions_2x.104e09b5.js";import"./img-no-Positions_2x.6290f511.js";import"./useWhale.dd192876.js";import"./token-dropdown-select.aa7268fe.js";import"./useDebounceFunction.b574ba21.js";function zt(e,c,G){const x=new m(10).pow(c-G);return new m(1.0001).pow(e).mul(x)}const qi=st({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""},zoom:{type:Number,default:1}},setup(e,c){const G=T(""),x=T(""),A=f(()=>{var a,P,g,Z,H,ce;return(a=e.poolInfo)!=null&&a.current_sqrt_price&&((P=e.poolInfo)!=null&&P.coinA)&&((g=e.poolInfo)!=null&&g.coinB)?n.sqrtPriceX64ToPrice((Z=e.poolInfo)==null?void 0:Z.current_sqrt_price,(H=e.poolInfo)==null?void 0:H.coinA.decimals,(ce=e.poolInfo)==null?void 0:ce.coinB.decimals).toString():"0"}),Q=f(()=>{let a=0;return e.direction?a=(Number(e.minPrice)/Number(A.value)-1)*100:a=(Number(e.minPrice)/Number(1/Number(A.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),L=f(()=>{let a=0;return e.direction?a=(Number(e.maxPrice)/Number(A.value)-1)*100:a=(Number(e.maxPrice)/Number(1/Number(A.value))-1)*100,a=a>0&&a<.1?.1:a,a=a<0&&a>-.1?-.1:a,a}),q=dt(),y=f(()=>q),J=f(()=>y.value.chainName?Rt(y.value.chainName):{}),{TickMath:n,getNearestTickByTick:p}=J.value,N=(a=[])=>{let P=6;const g=Math.abs(Number(a[0])-Number(a[a.length-1]));return g>=6?P=0:g>=1?P=1:g>=.1?P=2:g>=.01?P=3:g>=.001?P=4:g>=1e-4?P=5:g>=1e-5?P=6:g>=1e-6?P=7:g>=1e-7&&(P=8),P},j=(a,P=1)=>{if(a&&a.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const g=Number(e.poolInfo.current_tick_index);let Z=g+100*P,H=g-100*P,ce,k;if(e.maxPrice==="âˆž")k=J.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?k=n.priceToTickIndex(new m(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):k=n.priceToTickIndex(new m(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{k=443636}if(e.minPrice==="0")ce=J.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ce=n.priceToTickIndex(new m(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ce=n.priceToTickIndex(new m(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ce=-443636}let me=0;if(e.currentPriceTab!=="full range"){if(g>=ce&&g<=k){const C=g-ce,V=k-g;me=Math.max(Math.abs(C),Math.abs(V))}else g<ce?me=Math.abs(k-g):me=Math.abs(g-ce);Z=g+me+100*P,H=g-me-100*P}else{const C=(Math.abs(g)>5e3,2e4);Z=g+C*P,H=g-C*P}H<-443636&&(H=-443636),Z>443636&&(Z=443636);const K=new m(a.liquidity).div(Math.pow(10,8)).toString(),M=e.tickList,S=[],te=[];let fe={};for(let C=0;C<M.length;C++){if(fe=M[C],fe.index<=g&&fe.index>=H){if(S.length<1&&C!==0){const V=M[C-1];S.unshift({...V,index:H,source:"left"})}S.unshift(fe)}else if(fe.index>g&&fe.index<=Z&&(te.push(fe),S.length<1&&C!==0)){const V=M[C-1];S.push({...V,index:H,source:"left"})}if(fe.index>Z){const V=M[C];if(te.push({...V,index:Z,source:"right"}),S.length<1&&C!==0){const ze=M[C-1];S.push({...ze,index:H,source:"left"})}break}}let O="0";for(let C=S.length-1;C>=0;C--)O=new m(O).plus(new m(S[C].liquidityNet.toString()).div(Math.pow(10,8))).toString(),S[C].liquityAmount=O;let $=K;for(let C=0;C<te.length;C++)$=new m($).plus(new m(te[C].liquidityNet.toString()).div(Math.pow(10,8))).toString(),te[C].liquityAmount=$;let ie=[];const U=M&&M.length>0?{index:g,liquityAmount:Number(K)}:{index:g,liquityAmount:0};(S.length>0||te.length>0)&&(ie=[...S.reverse(),U,...te],e.direction||(ie=ie.reverse()));const Ae=[];M.forEach(C=>{Ae.push({...C,liquidityGross:C.liquidityGross.toString(),liquidityNet:C.liquidityNet.toString()})}),d(ie,H,Z,ce,k,g)}};let ee=T(!1);const Pe=T(!1);Et(()=>{const a=document.body.clientWidth;Pe.value=!0,a<750?ee.value=!1:ee.value=!0,window.onresize=()=>{document.body.clientWidth<750?ee.value=!1:ee.value=!0,j(e.poolInfo,e.zoom)}});const d=(a,P,g,Z,H,ce)=>{let k,me;e.direction?(k=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new m(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",me=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new m(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(k=Number(e.before7dContractPriceLowest)!==0?n.priceToTickIndex(new m(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",me=Number(e.before7dContractPriceHighest)!==0?n.priceToTickIndex(new m(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const K={top:30,right:35,bottom:58,left:80};let M,S;ee.value?(M=528-K.left-K.right,S=242-K.top-K.bottom):(M=340-K.left-K.right,S=205-K.top-K.bottom);const te=g-P,fe=parseInt(String(te/4));let O=[P+fe/4,P+fe,P+2*fe,g-fe,g-fe/4];const $=P,ie=g,U=M/(ie-$);e.currentPriceTab==="full range"&&(O=[P,P+2*fe,g]);const Ae=O.map(o=>e.direction?zt(o,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new m(1).div(zt(o,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString()),C=N(Ae);Pt("#chart").selectAll("*").remove();const V=Pt("#chart").attr("width",M+K.left+K.right).attr("height",S+K.top+K.bottom).append("g").attr("transform",`translate(${K.left},${K.right})`),ze=mi(a,function(o){return Number(Math.abs(o.liquityAmount))})||0,Le=fi().range([0,S]).domain([ze,0]);gi().rangeRound([0,M]).padding(.1);const Ge=V.append("g").attr("id","barsBox").selectAll("rect").data(a).enter().append("rect");y.value.theme=="default"?Ge.attr("x",function(o,r){return r===0?0:e.direction?Math.abs(o.index-$)*U:Math.abs(ie-o.index)*U}).attr("y",function(o,r){return e.direction?r===a.length-1?0:Le(o.liquityAmount):r===a.length-1?0:Le(a[r+1].liquityAmount)}).attr("width",function(o,r){return r===0&&a.length===1&&o.liquityAmount>0?M:(e.direction,r!==a.length-1?Math.abs(a[r+1].index-o.index)*U:0)}).attr("height",function(o,r){return r===0&&a.length===1&&o.liquityAmount>0?S:e.direction?r===a.length-1?0:S-Le(o.liquityAmount):r===a.length-1?0:S-Le(a[r+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Ge.attr("x",function(o,r){return r===0?0:e.direction?Math.abs(o.index-$)*U:Math.abs(ie-o.index)*U}).attr("y",function(o,r){return e.direction?r===a.length-1?0:Le(Math.abs(o.liquityAmount)):r===a.length-1?0:Le(Math.abs(a[r+1].liquityAmount))}).attr("width",function(o,r){return r===0&&a.length===1&&o.liquityAmount>0?M:(e.direction,r!==a.length-1?Math.abs(a[r+1].index-o.index)*U:0)}).attr("height",function(o,r){if(r===0&&a.length===1&&o.liquityAmount>0)return S;if(e.direction)return r===a.length-1?0:Number(o.liquityAmount)?S-Le(Math.abs(o.liquityAmount)):0;{if(r===a.length-1)return 0;const z=S-Le(Math.abs(a[r+1].liquityAmount));return Number(a[r+1].liquityAmount)?z:0}}).attr("fill",function(o,r){return"#417494"}).attr("class","bars").attr("stroke-width",1).attr("stroke",function(o,r){return"#417494"});const Ee=V.append("g");Ee.append("line").attr("x1",0).attr("y1",155).attr("x2",M).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D");const nt=Ee.append("g");let Be=0;if(e.direction){for(let o=0;o<O.length;o++){const r=ke(Ae[o],C)||"0";Ae.push(r);const z=Math.abs(O[o]-$)*U;let E=0;for(let ne=0;ne<r.length;ne++)r[ne]==="1"?E+=4.02:r[ne]==="."?E+=2.64:r[ne]==="7"?E+=5.48:E+=6;nt.append("text").text(r).attr("x",z-E/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}Be=Math.abs(ce-$)*U}else{for(let o=O.length-1;o>=0;o--){const r=ke(Ae[o],C)||0;Ae.push(r);const z=Math.abs(O[o]-ie)*U;let E=0;for(let ne=0;ne<r.length;ne++)r[ne]==="1"?E+=4.02:r[ne]==="."?E+=2.64:r[ne]==="7"?E+=5.48:E+=6;nt.append("text").text(r).attr("x",z-E/2).attr("y",168).attr("fill","rgba(255, 255, 255, 0.5").style("font-size","10")}Be=Math.abs(ce-ie)*U}(y.value.theme=="default"?V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+Be+", 0)");let De,xe,We,He;e.direction?(De=Z<$?-100:parseInt(String(Math.abs(Z-$)*U)),xe=H<$?-100:parseInt(String(Math.abs(H-$)*U)),We=k<$?-100:Math.abs(k-$)*U,He=me<$?-100:Math.abs(me-$)*U):(xe=Z<$?-100:Math.abs(ie-Z)*U,De=H<$?-100:Math.abs(ie-H)*U,He=k>ie?-100:Math.abs(ie-k)*U,We=me>ie?-100:Math.abs(ie-me)*U),e.minPrice==="0"&&(De=0),e.maxPrice==="âˆž"&&(xe=M),ee.value?G.value=M-De+94+"px":G.value=M-De+87+"px",x.value=xe+98+"px",k&&We<M&&V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+We+", 0)"),me&&He<M&&V.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+He+", 0)");const qe=V.append("g").attr("id","left-handle"),t=V.append("g").attr("id","right-handle");y.value.theme=="default"?(qe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),qe.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(-1, 20) rotate(180)"),qe.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",6).attr("fill","#68FFD8"),qe.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",4.5).attr("fill","#68FFD8"),t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#68FFD8"),t.append("path").attr("d","M0 0 L12 0 L12 20 L0 20 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(1, 0)"),t.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",6).attr("fill","#68FFD8"),t.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",4.5).attr("fill","#68FFD8")):(qe.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),qe.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(-1, 24) rotate(180)"),qe.append("rect").attr("width",1).attr("height",7).attr("x",-9).attr("y",8).attr("fill","#76C8FF"),qe.append("rect").attr("width",1).attr("height",10).attr("x",-7).attr("y",6.5).attr("fill","#76C8FF"),t.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-dasharray","5, 5").attr("stroke-width",2).attr("stroke","#76C8FF"),t.append("path").attr("d","M0 0 L12 0 L12 24 L0 24 Z").attr("fill","#23252C").attr("stroke","#23252C").attr("transform","translate(1, 0)"),t.append("rect").attr("width",1).attr("height",7).attr("x",7).attr("y",8).attr("fill","#76C8FF"),t.append("rect").attr("width",1).attr("height",10).attr("x",5).attr("y",6.5).attr("fill","#76C8FF")),qe.attr("transform","translate("+De+", 0)"),t.attr("transform","translate("+xe+", 0)");const u=pi().extent([[0,0],[M,S]]).handleSize(30).on("end",I);V.append("g").attr("class","brush").call(u).call(u.move,[De,xe]);function I(o){if(!o.sourceEvent||!o.selection)return;qe.attr("transform","translate("+o.selection[0]+", 0)"),t.attr("transform","translate("+o.selection[1]+", 0)"),ee.value,G.value=M-o.selection[0]+87+"px",x.value=o.selection[1]+74+"px";let r,z,E=0,ne=0;e.direction?(E=p(parseInt(String(o.selection[0]/U+$)),Number(e.poolInfo.tickSpacing)),r=n.tickIndexToPrice(E,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ne=p(parseInt(String(o.selection[1]/U+$)),Number(e.poolInfo.tickSpacing)),z=n.tickIndexToPrice(ne,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(ne=p(ie-o.selection[0]/U,Number(e.poolInfo.tickSpacing)),r=1/n.tickIndexToPrice(ne,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),E=p(ie-o.selection[1]/U,Number(e.poolInfo.tickSpacing)),z=1/n.tickIndexToPrice(E,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),c.emit("onChangeMinPrice",String(ke(String(r),6))),c.emit("onChangeMaxPrice",String(ke(String(z),6)))}y.value.theme=="default"?Pt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):Pt(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#152632")};return T(""),Ie(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.zoom,e.tickList],([a,P,g,Z,H,ce])=>{a&&P&&g&&(a!=null&&a.liquidity)&&j(a,H)},{immediate:!0}),{store:y,loading:Pe,rangeSizeLower:Q,rangeSizeUpper:L,rangeSizeLowerPosition:G,rangeSizeUpperPosition:x,decimalFormat:Kt,numberformat:Mt}}});const Ni=e=>(Ct("data-v-edb98a83"),e=e(),It(),e),$i={class:"chart-box"},Mi={class:"chart"},Fi=Ni(()=>s("svg",{id:"chart"},null,-1));function Ri(e,c,G,x,A,Q){const L=Dt;return B(),W("div",$i,[ii(s("div",Mi,[e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(B(),W("div",{key:0,class:"range-size range-size-lower",style:Ot({right:e.rangeSizeLowerPosition})},D(("numberformat"in e?e.numberformat:be(Mt))(e.rangeSizeLower.toFixed(1),1))+"% ",5)):ye("",!0),e.currentPriceTab!=="full range"&&e.minPrice!=="0"&&e.maxPrice!=="âˆž"?(B(),W("div",{key:1,class:"range-size range-size-upper",style:Ot({left:e.rangeSizeUpperPosition})},D(("numberformat"in e?e.numberformat:be(Mt))(e.rangeSizeUpper.toFixed(1),1))+"% ",5)):ye("",!0),Fi],512),[[ni,!e.chartLoading]]),e.chartLoading?(B(),rt(L,{key:0})):ye("",!0)])}const Oi=lt(qi,[["render",Ri],["__scopeId","data-v-edb98a83"]]),Bi=st({components:{SuiLiquidityD3Chart:Oi,RectangleTab:bi,SuiLiquidityPrice:ki},setup(){var qe;const{t:e,locale:c}=Ht(),G=T("liquidity"),x=dt(),A=f(()=>x),Q=f(()=>A.value.chainName),L=St(),q=f(()=>L),y=f(()=>A.value.chainName?Rt(A.value.chainName):{});Et(()=>{ct.value=!1});const J=Ft(),n=f(()=>{let t=null;for(let u=0;u<q.value.poolConfigList.length;u++){const I=q.value.poolConfigList[u];I.address==J.query.poolAddress&&(t=I)}return t}),p=f(()=>{let t=null;console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-left.vue:481 ~ constpoolInfo:any=computed ~ pools.value.poolsObj:",q.value.poolsObj);for(const u in q.value.poolsObj){const I=q.value.poolsObj[u];I.address==J.query.poolAddress&&(t=I)}return t}),N=T(),j=T(!0),ee=async(t,u)=>{var I,o,r,z,E,ne,Ve,ot,Je,et,bt,kt;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-left.vue:497 ~ watchPoolInfo ~ pool:",t),t&&(_.value=t.needReverse?t.token_b:t.token_a,h.value=t.needReverse?t.token_a:t.token_b),u&&t.current_tick_index){j.value=!0,ut.value=[],d.value=[],Re.value=!1;const ht=t.token_a.decimals,At=t.token_b.decimals;mt.value=yt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((I=t==null?void 0:t.object)==null?void 0:I.current_sqrt_price),ht,At).toString(),wt.value=new m(1).div(yt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((o=t==null?void 0:t.object)==null?void 0:o.current_sqrt_price),ht,At)).toString(),N.value=t.needReverse,((z=(r=t==null?void 0:t.token_a)==null?void 0:r.address)==null?void 0:z.toLowerCase())===((Ve=(ne=(E=_)==null?void 0:E.value)==null?void 0:ne.address)==null?void 0:Ve.toLowerCase())&&((Je=(ot=t==null?void 0:t.token_b)==null?void 0:ot.address)==null?void 0:Je.toLowerCase())===((kt=(bt=(et=h)==null?void 0:et.value)==null?void 0:bt.address)==null?void 0:kt.toLowerCase())?_e.value=!0:_e.value=!1;let i={poolAddress:t.address,coinTypeA:t.coin_a_address,coinTypeB:t.coin_b_address};const{list:l,address:v}=await y.value.getTicks(i);ut.value=l&&v==t.address?y.value.getTickDataFromUrlData(l):[],t!=null&&t.current_tick_index&&(P(t),j.value=!1)}},Pe=t=>{var o,r;const u=t.token_a.decimals,I=t.token_b.decimals;mt.value=yt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((o=t==null?void 0:t.object)==null?void 0:o.current_sqrt_price),u,I).toString(),wt.value=new m(1).div(yt.sqrtPriceX64ToPrice((t==null?void 0:t.current_sqrt_price)||((r=t==null?void 0:t.object)==null?void 0:r.current_sqrt_price),u,I)).toString()},d=T([]),a=T(),P=async t=>{const u=t.token_a.decimals,I=t.token_b.decimals;let o=q.value.poolPriceConfigObj&&q.value.poolPriceConfigObj[t.address]&&q.value.poolPriceConfigObj[t.address].recommend_ranges||{};const r=q.value.poolPriceConfigObj&&q.value.poolPriceConfigObj[t.address]&&q.value.poolPriceConfigObj[t.address].type||"";let z,E;const ne=ci(t.current_tick_index,t.tickSpacing);a.value=t.current_tick_index,z=ne-Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3),E=ne+Number(t.type=="unstable"?Number(t.tickSpacing)*2:Number(t.tickSpacing)*3);const Ve=y.value.TickMath.tickIndexToPrice(z,u,I).toString(),ot=y.value.TickMath.tickIndexToPrice(E,u,I).toString();o["full range"]={lower:y.value.TickUtil.getMinIndex(Number(p.value.tickSpacing)),upper:y.value.TickUtil.getMaxIndex(Number(p.value.tickSpacing))},o.custom={lower:z,upper:E,minPrice:Ve,maxPrice:ot};const Je=[];for(let et in o)o[et]&&Je.push({...o[et],key:et});r&&Je&&Je.length>2?t.isSelfBuilt?X.value="custom":r=="stable"?X.value="suggested":X.value="passive":X.value="custom",d.value=Je||{},at.value=o,H({key:X.value,...o[X.value]})},g=T(""),Z=T(""),H=t=>{X.value=t.key.toLowerCase();const u=p.value.token_a.decimals,I=p.value.token_b.decimals,{lower:o,upper:r}=t;Xe.value=!1;const z=y.value.TickMath.tickIndexToPrice(o,u,I).toString(),E=y.value.TickMath.tickIndexToPrice(r,u,I).toString();if(t.key=="full range"){g.value=o,Z.value=r,ce();return}_e.value?(qt.value=String(z),w.value=String(z),Nt.value=String(E),b.value=String(E),g.value=o,Z.value=r):(qt.value=new m(1).div(new m(E)).toString(),w.value=new m(1).div(new m(E)).toString(),Nt.value=new m(1).div(new m(z)).toString(),b.value=new m(1).div(new m(z)).toString(),g.value=y.value.TickMath.priceToTickIndex(new m(1/Number(E)),u,I),Z.value=y.value.TickMath.priceToTickIndex(new m(1/Number(z)),u,I))},ce=t=>{w.value="0",b.value="âˆž"};Ie(()=>p.value,(t,u)=>{(!u&&t&&!re(t)||u&&t&&(!(u!=null&&u.current_tick_index)||(u==null?void 0:u.address)!==(t==null?void 0:t.address)))&&ee(t,!u||!(u!=null&&u.current_tick_index)||(u==null?void 0:u.address)!==(t==null?void 0:t.address)),t&&!re(t)&&Pe(t),t||(ut.value=[])},{immediate:!0}),Xt(()=>{_.value=T(),h.value=T(),ut.value=[]}),Ie(()=>n.value,(t,u)=>{t&&L.setSinglePool(t,{},Q.value)},{immediate:!0});const k=t=>{switch(t){case"passive":return"/sui-image/icon_conservative@2x.png";case"active":return"/sui-image/icon_active@2x.png";case"full range":return"/sui-image/icon_fullrange@2x.png";case"custom":return"/sui-image/icon_costom@2x.png";case"suggested":return"/sui-image/icon_stabel@2x.png"}},me=t=>{switch(t){case"passive":return"/sui-image/img_conservative_def@2x.png";case"active":return"/sui-image/img_active_def@2x.png";case"full range":return"/sui-image/img_fullrange_def.png";case"custom":return"/sui-image/img_custom_def.png";case"suggested":return"/sui-image/icon_stabel_def@2x.png"}},K=t=>{switch(t){case"suggested":return e("newAdd.suggested");case"active":return e("newAdd.active");case"passive":return e("newAdd.conservative");case"full range":return e("newAdd.fullRange");case"custom":return e("newAdd.custom")}},M=t=>{var I,o;const u=q.value.poolPriceConfigObj&&q.value.poolPriceConfigObj[(I=p.value)==null?void 0:I.address]&&q.value.poolPriceConfigObj[(o=p.value)==null?void 0:o.address].type||"";if(d.value.length>2)if(u=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"suggested":return{top:"25%"};case"full range":return{top:"49%"};case"custom":return{top:"75%"}}else if(u=="unstable")switch(t){case"active":return{top:"38%"};case"passive":return{top:"13%"};case"full range":return{top:"63%"};case"custom":return{top:"87%"}}else switch(t){case"full range":return{top:"35%"};case"custom":return{top:"60%"}}},S=T(1),te=()=>{const t=S.value/2;S.value=t},fe=()=>{const t=S.value*2;S.value=t},O=f(()=>{var t,u,I;return!p.value||re(A.value.addressHistTokens)||!A.value.addressHistTokens[(t=p.value)==null?void 0:t.poolAddress]?null:Object.fromEntries((I=A.value.addressHistTokens[(u=p.value)==null?void 0:u.poolAddress])==null?void 0:I.data.map(o=>[o.key,o.value]))}),$=T(30),ie=T("30D"),U=f(()=>_e.value?O.value&&ke($.value==7?O.value.before_7_d_contract_price_lowest:$.value==24?O.value.before_24_h_contract_price_lowest:O.value.before_30_d_contract_price_lowest,6)||0:O.value&&ke(new m(1).div($.value==7?O.value.before_7_d_contract_price_highest:$.value==24?O.value.before_24_h_contract_price_highest:O.value.before_30_d_contract_price_highest).toString(),6)||0),Ae=f(()=>_e.value?O.value&&ke($.value==7?O.value.before_7_d_contract_price_highest:$.value==24?O.value.before_24_h_contract_price_highest:O.value.before_30_d_contract_price_highest,6)||0:(O.value&&ke(1/Number($.value==7?O.value.before_7_d_contract_price_lowest:$.value==24?O.value.before_24_h_contract_price_lowest:O.value.before_30_d_contract_price_lowest),6))==1/0?0:O.value&&ke(1/Number($.value==7?O.value.before_7_d_contract_price_lowest:$.value==24?O.value.before_24_h_contract_price_lowest:O.value.before_30_d_contract_price_lowest),6)||0),C=f(()=>{const t=Number(w.value),u=Number(b.value);if(w.value=="0"&&b.value=="âˆž"||X.value=="full range")return"1x";if(w.value==b.value||X.value=="full range")return"--";if(w.value&&b.value&&w.value!=="0"&&b.value!=="âˆž"){const I=Yt(1/(1-Number((t/u)**.25)),2);return Number(I)>0?I+"x":"--"}else return 1}),V=f(()=>{var t,u,I,o,r,z;return((t=_.value)==null?void 0:t.isSelfBuilt)||((u=h.value)==null?void 0:u.isSelfBuilt)||((o=q.value.tokensObj[(I=_.value)==null?void 0:I.address])==null?void 0:o.isSelfBuilt)||((z=q.value.tokensObj[(r=h.value)==null?void 0:r.address])==null?void 0:z.isSelfBuilt)}),ze=(t,u)=>{t!==w.value&&X.value=="full range"?H({key:"custom",...d.value.custom}):X.value!=="full range"&&X.value!=="custom"?(X.value="custom",w.value=t):w.value=t,we.value&&(Re.value?(_e.value&&w.value!==we.value.minPrice&&(Re.value=!1),!_e.value&&Number(w.value)!==1/Number(we.value.maxPrice)&&(Re.value=!1)):(_e.value&&w.value==we.value.minPrice&&b.value==we.value.maxPrice&&(Re.value=!0),!_e.value&&Number(w.value)==1/Number(we.value.maxPrice)&&Number(b.value)==1/Number(we.value.minPrice)&&(Re.value=!0)))},Le=(t,u)=>{t!==b.value&&X.value=="full range"?H({key:"custom",...d.value.custom}):X.value!=="full range"&&X.value!=="custom"?(X.value="custom",t=="0"?b.value="âˆž":b.value=t):t=="0"?b.value="âˆž":b.value=t,we.value&&(Re.value?(_e.value&&b.value!==we.value.maxPrice&&(Re.value=!1),!_e.value&&Number(b.value)!==1/Number(we.value.minPrice)&&(Re.value=!1)):(_e.value&&w.value==we.value.minPrice&&b.value==we.value.maxPrice&&(Re.value=!0),!_e.value&&Number(w.value)==1/Number(we.value.maxPrice)&&Number(b.value)==1/Number(we.value.minPrice)&&(Re.value=!0)))},Qe=t=>{var u;return console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-left.vue:1215 ~ getCoinIcon ~ info:",t),(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((u=q.value.tokensObj[t==null?void 0:t.address])==null?void 0:u.logo_url)||(A.value.theme==="default"?ft("/image/coins/unknown.png"):ft("/image/coins/sui-unknown.png"))},Ge=t=>{switch(t){case"active":return e("newAdd.activeTips");case"passive":return e("newAdd.passiveTips");case"full range":return e("newAdd.fullRangTips");case"suggested":return e("newAdd.suggestedTips");case"custom":return e("newAdd.customTips")}},Ee=[{label:"24H",value:24},{label:"7D",value:7},{label:"30D",value:30}],nt=Tt(),Be=f(()=>nt),we=f(()=>{var t;return Be.value.farmsPoolObj[(t=p==null?void 0:p.value)==null?void 0:t.address]}),De=f(()=>q.value.poolPriceConfigObj);Ie(()=>[Re.value,p.value,d.value,De.value,we.value,_e.value],(t,u)=>{var I,o;if(t[0]&&t[4]&&!re(t[4]))X.value="custom",w.value=t[5]?t[4].minPrice:String(1/t[4].maxPrice),b.value=t[5]?t[4].maxPrice:String(1/t[4].minPrice);else if(t[1]&&!re(t[1])&&t[2]&&!re(t[2])&&t[3]&&!re(t[3])&&t[4]&&!re(t[4])){t[3]&&t[3][(I=t[1])==null?void 0:I.address]&&t[3][(o=t[1])==null?void 0:o.address].type;const r=t[2].filter(z=>z.key===(t[2].length==4?"passive":"suggested"));r!=null&&r[0]&&(!u||u[0]!==t[0])&&H({...r[0]})}},{immediate:!0});const xe=f(()=>q.value.poolsLoading),We=f(()=>{var t,u,I,o,r,z;return[{label:(t=_.value)==null?void 0:t.symbol,value:(u=_.value)==null?void 0:u.address,logo:(I=_.value)==null?void 0:I.logo_url},{label:(o=h.value)==null?void 0:o.symbol,value:(r=h.value)==null?void 0:r.address,logo:(z=h.value)==null?void 0:z.logo_url}]});return{currentRectangleTab:T((qe=_.value)==null?void 0:qe.address),rectangleTabList:We,positionError:ct,getCoinIcon:Qe,chainName:Q,store:A,currentTab:G,currentPrice:mt,currentPriceReverse:wt,fromCoin:_,toCoin:h,direction:_e,needReverse:N,addCommom:Te,decimalUi:ke,priceTabList:d,currentPriceTab:X,sliderStyle:M,poolInfo:p,tickList:ut,getPriceTabImage:k,getPriceTabDefImage:me,getPriceTabText:K,defaultMinPrice:qt,defaultMaxPrice:Nt,minPrice:w,maxPrice:b,currentTick:a,chartLoading:j,zoomOut:te,zoomIn:fe,zoom:S,priceTab:H,before7dContractPriceLowest:U,before7dContractPriceHighest:Ae,aprRewardsTime:ie,lever:C,aprRewardsParameter:$,isSelfBuilt:V,priceRangeChangeMin:ze,priceRangeChangeMax:Le,toggle:Jt,getPirceTabTips:Ge,timeList:Ee,farmsPoolInfo:we,checkNullObj:re,isStableFarmingRange:Re,poolsLoading:xe}}});const ji={class:"sui-liquidity-left"},Ui={class:"title-box"},zi=s("span",{class:"selectRange"},"Select Range",-1),Ei={key:0,class:"tab-box"},Di={class:"range-top"},Hi={class:"price-tab-list"},Xi=["onClick"],xi={class:"block"},Wi=["src"],Zi={class:"price-leverage"},Gi={class:"price-info"},Ji={class:"left"},Ki={class:"current-price"},Yi=s("div",{class:"current-price-title"},"Current Price",-1),Qi={key:0,class:"from-pre-to"},Vi={class:"right"},en={class:"chart-box"},tn={class:"leverage"},nn={class:"right-time"},on={class:"day-7-price-range"},an=s("i",null,null,-1),rn={class:"gray"},sn={key:0},ln={key:1,class:"skeleton"},un={class:"time-list"},cn=["onClick"],dn={class:"range"},vn={key:0,class:"position-tips"},mn={class:"error"},fn={key:1,class:"stable-farming-range pc-stable-farming-range"},gn={class:"value"},pn=s("img",{src:Qt},null,-1),bn=s("span",{class:"text"},"Farm rewards rangeï¼š",-1),kn={class:"text"},hn={class:"check-box-active plus-switch plus-liquidity-switch"};function _n(e,c,G,x,A,Q){var N,j,ee,Pe;const L=Se("RectangleTab"),q=Wt,y=Se("SuiLiquidityD3Chart"),J=oi,n=Se("SuiLiquidityPrice"),p=xt;return B(),W("div",ji,[s("div",Ui,[zi,e.fromCoin&&e.toCoin?(B(),W("div",Ei,[ue(L,{"current-rectangle-tab":e.currentRectangleTab,"rectangle-tab-list":e.rectangleTabList,onClickTab:c[0]||(c[0]=d=>{e.toggle()})},null,8,["current-rectangle-tab","rectangle-tab-list"])])):ye("",!0)]),s("div",Di,[s("div",Hi,[(B(!0),W($t,null,Bt(e.priceTabList,d=>(B(),W("div",{key:d.key,class:vt(["price-tab-item",e.currentPriceTab==d.key?"price-tab-item-active":""]),onClick:a=>e.priceTab(d)},[ue(q,{placement:"top","arrow-point-at-center":""},{title:it(()=>[gt(D(e.getPirceTabTips(d.key)),1)]),default:it(()=>[s("div",xi,[s("img",{src:e.currentPriceTab==d.key?e.getPriceTabImage(d.key):e.getPriceTabDefImage(d.key),alt:""},null,8,Wi),s("span",null,D(e.getPriceTabText(d.key)),1)])]),_:2},1024)],10,Xi))),128))]),s("div",Zi,[s("div",Gi,[s("div",Ji,[s("div",Ki,[Yi,s("div",null,[s("span",null,D(e.poolInfo?e.direction?("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(e.currentPrice,6)):("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(e.currentPriceReverse,6)):"--"),1),e.fromCoin&&e.toCoin?(B(),W("span",Qi,D((N=e.toCoin)==null?void 0:N.symbol)+" per "+D((j=e.fromCoin)==null?void 0:j.symbol),1)):ye("",!0)])])]),s("div",Vi,[e.currentTab=="liquidity"?(B(),W("div",{key:0,class:"zoom-out",onClick:c[1]||(c[1]=(...d)=>e.zoomOut&&e.zoomOut(...d))}," + ")):ye("",!0),e.currentTab=="liquidity"?(B(),W("div",{key:1,class:"zoom-in",onClick:c[2]||(c[2]=(...d)=>e.zoomIn&&e.zoomIn(...d))}," - ")):ye("",!0)])]),s("div",en,[e.poolInfo?(B(),rt(y,{key:0,"pool-info":e.poolInfo,"min-price":e.minPrice,"max-price":e.maxPrice,direction:e.direction,"current-price-tab":e.currentPriceTab,"tick-list":e.tickList,"current-tick":e.currentTick,"chart-loading":e.chartLoading,zoom:e.zoom,"before7d-contract-price-lowest":e.before7dContractPriceLowest,"before7d-contract-price-highest":e.before7dContractPriceHighest,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["pool-info","min-price","max-price","direction","current-price-tab","tick-list","current-tick","chart-loading","zoom","before7d-contract-price-lowest","before7d-contract-price-highest","onOnChangeMinPrice","onOnChangeMaxPrice"])):ye("",!0),s("div",tn,[s("div",nn,[s("div",null,[s("div",on,[an,s("span",rn,D(e.aprRewardsParameter==7?"7D":e.aprRewardsParameter==24?"24H":"30D")+" Price Range",1),e.poolInfo&&(e.before7dContractPriceLowest||e.before7dContractPriceHighest)?(B(),W("span",sn,D(("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(e.before7dContractPriceLowest,6)))+" - "+D(("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(e.before7dContractPriceHighest,6))),1)):(B(),W("div",ln,[ue(J,{loading:!0,size:"large",active:"",paragraph:!1})]))])]),s("div",un,[(B(!0),W($t,null,Bt(e.timeList,d=>(B(),W("div",{key:d.value,class:vt(["time-item",d.value==e.aprRewardsParameter?"time-item-active":""]),onClick:a=>e.aprRewardsParameter=d.value},D(d.label),11,cn))),128))])])])])])]),s("div",{class:vt(["apr-and-price",e.positionError&&e.poolInfo?"padding-apr-and-price":""])},[s("div",dn,[ue(n,{min:e.minPrice,max:e.maxPrice,"from-coin":e.fromCoin,"to-coin":e.toCoin,direct:e.direction,"default-min-price":e.defaultMinPrice,"default-max-price":e.defaultMaxPrice,"pool-info":e.poolInfo,loading:e.chartLoading,"current-price-tab":e.currentPriceTab,onOnChangeMinPrice:e.priceRangeChangeMin,onOnChangeMaxPrice:e.priceRangeChangeMax},null,8,["min","max","from-coin","to-coin","direct","default-min-price","default-max-price","pool-info","loading","current-price-tab","onOnChangeMinPrice","onOnChangeMaxPrice"]),e.positionError&&e.poolInfo?(B(),W("div",vn,[s("p",mn,D(e.$t("tips.positionError")),1)])):ye("",!0),e.farmsPoolInfo&&!("checkNullObj"in e?e.checkNullObj:be(re))(e.farmsPoolInfo)&&e.fromCoin&&e.toCoin?(B(),W("div",fn,[s("div",gn,[pn,bn,gt(" "+D(("decimalUi"in e?e.decimalUi:be(ke))(e.direction?e.farmsPoolInfo.minPrice:1/e.farmsPoolInfo.maxPrice,6))+"- "+D(("decimalUi"in e?e.decimalUi:be(ke))(e.direction?e.farmsPoolInfo.maxPrice:1/e.farmsPoolInfo.minPrice,6))+" ",1),s("div",kn,"Â Â "+D((ee=e.toCoin)==null?void 0:ee.symbol)+" per "+D((Pe=e.fromCoin)==null?void 0:Pe.symbol),1)]),s("div",hn,[ue(p,{class:"liquidity-switch",checked:e.isStableFarmingRange,onClick:c[3]||(c[3]=d=>e.isStableFarmingRange=!e.isStableFarmingRange)},null,8,["checked"])])])):ye("",!0)])],2)])}const yn=lt(Bi,[["render",_n]]),Pn=st({components:{IconTooltip:wi},props:{lever:{type:String,default:""}},setup(){return{}}});const wn=e=>(Ct("data-v-b9dd9cb0"),e=e(),It(),e),Cn={class:"lever"},In={class:"left"},Sn=wn(()=>s("span",{class:"lever-title"},"Leverage",-1)),Tn={class:"lever-text"};function An(e,c,G,x,A,Q){const L=Se("IconTooltip");return B(),W("div",Cn,[s("div",In,[Sn,ue(L,{type:"leverage","xlink-href":"#icon-icon_tips"})]),s("div",Tn,D(e.lever),1)])}const Ln=lt(Pn,[["render",An],["__scopeId","data-v-b9dd9cb0"]]),qn=st({components:{Modal:ai,CoinImg:Ii},props:{positionInfo:{type:Object,default:()=>({})},poolInfo:{type:Object,required:!0},farmPoolInfo:{type:Object,default:()=>({})},isAutoStakeFarming:{type:Boolean,default:!0}},setup(e){const c=dt(),G=f(()=>c),x=f(()=>G.value.chainName),A=f(()=>di[x.value]);let Q=T(!0);const L=St(),q=f(()=>L),y=Zt(),J=f(()=>{var j;return(j=e.poolInfo)==null?void 0:j.needResever}),n=f(()=>e.farmPoolInfo&&e.isAutoStakeFarming?`/new-position-detail?position_nft_id=${e.positionInfo.id}&positionSource=farming`:`/new-position-detail?collect=${e.positionInfo.collectionName}&&token=${e.positionInfo.tokenName}&&address=${e.positionInfo.pool}&pos=${e.positionInfo.pos_object_id}`),p=j=>{var ee;return(j==null?void 0:j.logoURI)||(j==null?void 0:j.logo_url)||((ee=q.value.tokensObj[j==null?void 0:j.address])==null?void 0:ee.logo_url)||(G.value.theme==="default"?ft("/image/coins/unknown.png"):ft("/image/coins/sui-unknown.png"))},N=f(()=>G.value.currentExplorer);return{getExplorerUrl:li,addCommom:Te,router:y,pools:q,decimalFormat:Kt,rateChange:Q,config:A,importIcon:ft,store:G,chainName:x,checkNullObj:re,needReverse:J,getCoinIcon:p,decimalUi:ke,currentExplorer:N,positionDetailUrl:n}}});const pt=e=>(Ct("data-v-b1a140e9"),e=e(),It(),e),Nn=pt(()=>s("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),$n={class:"view-detail-box"},Mn=pt(()=>s("div",{class:"coin-pair"},null,-1)),Fn={class:"coin-pair"},Rn={class:"fee"},On={class:"status"},Bn={class:"min-and-max"},jn={key:0},Un={class:"text"},zn=pt(()=>s("img",{src:Vt,alt:""},null,-1)),En={class:"text"},Dn={key:1},Hn={class:"text"},Xn=pt(()=>s("img",{src:Vt,alt:""},null,-1)),xn={class:"text"},Wn=pt(()=>s("use",{"xlink:href":"#icon-icon_swap2"},null,-1)),Zn=[Wn];function Gn(e,c,G,x,A,Q){const L=Se("CoinImg"),q=Ci,y=Gt,J=Se("Modal");return B(),rt(J,{visible:!0,class:"transiaction-rejected",centered:"",title:e.$t("newAdd.openPositionSuccessful"),width:"340px",footer:null,onCancel:c[2]||(c[2]=n=>e.$emit("onClose"))},{closeIcon:it(()=>[Nn]),default:it(()=>{var n,p,N,j,ee,Pe,d,a,P,g,Z,H,ce,k,me,K,M,S,te,fe,O,$,ie,U,Ae,C,V,ze,Le,Qe;return[s("div",$n,[Mn,s("div",{class:vt(["left",`position-status-${e.positionInfo&&e.positionInfo.currentStatus&&e.positionInfo.currentStatus.toLowerCase()}`])},[s("div",Fn,[s("div",null,[ue(L,{url:e.getCoinIcon(e.needReverse?(p=e.positionInfo)==null?void 0:p.token_b:(n=e.positionInfo)==null?void 0:n.token_a)},null,8,["url"]),ue(L,{url:e.getCoinIcon(e.needReverse?(j=e.positionInfo)==null?void 0:j.token_a:(N=e.positionInfo)==null?void 0:N.token_b)},null,8,["url"])]),s("span",null,D(e.needReverse?(a=(d=e.positionInfo)==null?void 0:d.token_b)==null?void 0:a.symbol:(Pe=(ee=e.positionInfo)==null?void 0:ee.token_a)==null?void 0:Pe.symbol)+" - "+D(e.needReverse?(H=(Z=e.positionInfo)==null?void 0:Z.token_a)==null?void 0:H.symbol:(g=(P=e.positionInfo)==null?void 0:P.token_b)==null?void 0:g.symbol),1)]),s("div",Rn,D(e.$t("common.fee"))+" "+D(e.poolInfo.fee*100)+"%",1)],2),s("div",On,[ue(q,{"current-status":e.positionInfo.currentStatus||""},null,8,["current-status"])]),s("div",Bn,[(e.needReverse?!e.rateChange:e.rateChange)?(B(),W("div",jn,[s("div",Un,D(("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(String(e.positionInfo&&e.positionInfo.minPrice),6))),1),zn,s("div",En,D(e.positionInfo&&((k=(ce=e.positionInfo)==null?void 0:ce.maxPrice)==null?void 0:k.indexOf("âˆž"))>-1||e.positionInfo&&((K=(me=e.positionInfo)==null?void 0:me.maxPrice)==null?void 0:K.indexOf("+"))>-1?"âˆž":("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(String(e.positionInfo&&((M=e.positionInfo)==null?void 0:M.maxPrice)),6)))+" "+D((te=(S=e.positionInfo)==null?void 0:S.token_b)==null?void 0:te.symbol)+" per "+D((O=(fe=e.positionInfo)==null?void 0:fe.token_a)==null?void 0:O.symbol),1)])):(B(),W("div",Dn,[s("div",Hn,D(("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(String(1/Number(e.positionInfo&&(($=e.positionInfo)==null?void 0:$.maxPrice))),6))),1),Xn,s("div",xn,D(e.positionInfo&&((ie=e.positionInfo.maxPrice)==null?void 0:ie.indexOf("âˆž"))>-1||e.positionInfo&&((U=e.positionInfo.maxPrice)==null?void 0:U.indexOf("+"))>-1?"âˆž":("addCommom"in e?e.addCommom:be(Te))(("decimalUi"in e?e.decimalUi:be(ke))(String(1/Number(e.positionInfo&&((Ae=e.positionInfo)==null?void 0:Ae.minPrice))),6)))+" "+D((V=(C=e.positionInfo)==null?void 0:C.token_a)==null?void 0:V.symbol)+" per "+D((Le=(ze=e.positionInfo)==null?void 0:ze.token_b)==null?void 0:Le.symbol),1)])),(B(),W("svg",{class:"icon-change","aria-hidden":"true",onClick:c[0]||(c[0]=Ge=>e.rateChange=!e.rateChange)},Zn))])]),ue(y,{disabled:("checkNullObj"in e?e.checkNullObj:be(re))(e.positionInfo)||e.isAutoStakeFarming&&!((Qe=e.positionInfo)!=null&&Qe.clmm_pool_id),onClick:c[1]||(c[1]=Ge=>e.router.push(e.positionDetailUrl))},{default:it(()=>[gt(D(e.$t("newAdd.viewDetail")),1)]),_:1},8,["disabled"])]}),_:1},8,["title"])}const Jn=lt(qn,[["render",Gn],["__scopeId","data-v-b1a140e9"]]),Kn=st({props:{poolInfo:{type:Object,default:()=>({})},isActive:{type:Boolean,default:!0}},setup(e,c){const G=Tt();f(()=>G);const x=T(!1),A=T(),Q=T(!0),L=dt(),q=f(()=>L),y=f(()=>q.value.newTopPoolsObj),J=p=>{var ee,Pe,d,a;const N=p[(ee=e==null?void 0:e.poolInfo)==null?void 0:ee.poolAddress]||{};let j=0;N&&!re(N)&&((d=(Pe=N==null?void 0:N.stable_farming)==null?void 0:Pe.stable_rewarder)==null||d.forEach(P=>{P.amount_second>0&&(j+=P.amount_second)}),j>0?(x.value=!0,A.value={id:N.stable_farming.stable_farming_pool,clmm_pool_id:(a=e==null?void 0:e.poolInfo)==null?void 0:a.poolAddress},c.emit("sendFarmsPoolInfo",Q.value&&e.isActive?A.value:"")):(x.value=!1,c.emit("sendFarmsPoolInfo","")))};return Ie(()=>[y.value,e.poolInfo],([p,N])=>{p&&!re(p)&&N&&!re(N)&&J(p)},{immediate:!0}),Ie(()=>[e.isActive,Q.value,A.value],([p,N,j])=>{c.emit("sendFarmsPoolInfo",N&&e.isActive?j:"")},{immediate:!0}),{isShowAutoStake:x,changeIsOpen:()=>{Q.value=!Q.value,c.emit("sendFarmsPoolInfo",Q.value&&e.isActive?A.value:"")},isOpen:Q}}});const Yn=e=>(Ct("data-v-489098d8"),e=e(),It(),e),Qn={key:0,class:"farms-auto-stake"},Vn=Yn(()=>s("div",{class:"icon-desc"},[s("img",{class:"farms-icon",src:Qt,alt:""}),s("div",{class:"desc"},"Automatically stake your position into the farm to enjoy higher yield.")],-1)),eo={class:"switch-box"},to={key:0,class:"check-box-active plus-switch plus-liquidity-switch"},io={class:"check-box-active plus-switch plus-liquidity-switch"};function no(e,c,G,x,A,Q){const L=xt,q=Wt;return e.isShowAutoStake?(B(),W("div",Qn,[Vn,s("div",eo,[e.isActive?(B(),W("div",to,[ue(L,{class:"liquidity-switch",checked:e.isOpen,onClick:e.changeIsOpen},null,8,["checked","onClick"])])):(B(),rt(q,{key:1,"overlay-style":{"min-width":"200px"},"overlay-class-name":"ant-tooltip-text-color"},ri({default:it(()=>[s("div",io,[ue(L,{class:"liquidity-switch",checked:!1,onClick:()=>{}})])]),_:2},[e.isActive?void 0:{name:"title",fn:it(()=>[gt("Farming rewards only available for active positions.")]),key:"0"}]),1024))])])):ye("",!0)}const oo=lt(Kn,[["render",no],["__scopeId","data-v-489098d8"]]),ao=st({components:{SuiLiquidityTitle:hi,SuiLiquidityDepositRatio:_i,InputLock:Si,SuiAddOrCreate:yi,SuiFarmsAutoStake:oo,TokenInputBlock:Ai,SuiLiquidityLever:Ln,SuiViewDetail:Jn},setup(){const{t:e,locale:c}=Ht(),G=dt(),x=f(()=>G),A=f(()=>x.value.chainName),Q=St(),L=f(()=>Q),q=vi(),y=f(()=>q),J=Ft(),n=f(()=>{let i=null;for(const l in L.value.poolsObj){const v=L.value.poolsObj[l];v.address==J.query.poolAddress&&(i=v)}return console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:272 ~ constpoolInfo:any=computed ~ info:",i),i}),p=T(!1),N=T(!1),j=f(()=>x.value.theme),ee=async(i,l)=>{_.value=i.needReverse?i.token_b:i.token_a,h.value=i.needReverse?i.token_a:i.token_b,F.value="",R.value=""},Pe=f(()=>y.value.assets&&_.value&&y.value.assets[_.value.address]?Ut(y.value.assets[_.value.address].balance,_.value.decimals):"0"),d=f(()=>y.value.assets&&h.value&&y.value.assets[h.value.address]?Ut(y.value.assets[h.value.address].balance,h.value.decimals):"0"),a=T(),P=T(),g=T(),Z=T(!1),H=i=>{var l,v,de,Y;a.value=i,i==="fromCoin"?(P.value=((l=h.value)==null?void 0:l.address)||"",g.value=J.query.actions=="new-position"?(v=_.value)==null?void 0:v.address:n.value.needReverse?n.value.token_b.address:n.value.token_a.address):(P.value=((de=_.value)==null?void 0:de.address)||"",g.value=J.query.actions=="new-position"?(Y=h.value)==null?void 0:Y.address:n.value.needReverse?n.value.token_a.address:n.value.token_b.address),Z.value=!0},ce=i=>{var de,Y,ve,ge,se,oe,he,Ce;const l=n.value.needReverse?n.value.token_b:n.value.token_a,v=n.value.needReverse?n.value.token_a:n.value.token_b;a.value==="fromCoin"?(((de=_.value)==null?void 0:de.address)===(l==null?void 0:l.address)||!((Y=_.value)!=null&&Y.address)?(h.value&&i.address.toLowerCase()===((ve=h)==null?void 0:ve.value.address.toLowerCase())&&(h.value=null),_.value=i):(_.value&&i.address.toLowerCase()===((ge=_)==null?void 0:ge.value.address.toLowerCase())&&(_.value=null),h.value=i),J.query.action||(J.query.fee="")):((se=h.value)==null?void 0:se.address)===(v==null?void 0:v.address)||!((oe=h.value)!=null&&oe.address)?(_.value&&i.address.toLowerCase()===((he=_)==null?void 0:he.value.address.toLowerCase())&&(_.value=null),h.value=i):(h.value&&i.address.toLowerCase()===((Ce=h)==null?void 0:Ce.value.address.toLowerCase())&&(h.value=null),_.value=i),Z.value=!1},k=f(()=>x.value.chainName?Rt(x.value.chainName):{}),me=f(()=>x.value.slippage),K=T(),M=async()=>{var je,$e,Me,Ke;if(Xe.value||!w.value&&!b.value)return!1;if(!F.value&&!R.value&&!w.value&&!b.value)return;const i=n.value||{};if(re(i))return;const{TickUtil:l,TickMath:v,getNearestTickByTick:de}=k.value,Y=i==null?void 0:i.token_a.decimals,ve=i==null?void 0:i.token_b.decimals;let ge,se,oe,he,Ce,Ne,Ze,tt,pe=i==null?void 0:i.current_tick_index;if(!pe)return;let ae;if(i.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===h.value.address.toLowerCase()?ae=!0:ae=!1,w.value==="0"&&b.value==="âˆž")oe=l.getMinIndex(Number(i.tickSpacing)),he=l.getMaxIndex(Number(i.tickSpacing)),Ce=v.tickIndexToSqrtPriceX64(oe),Ne=v.tickIndexToSqrtPriceX64(he);else if(X.value=="custom"){ae?(ge=w.value,se=b.value):(ge=b.value!=="âˆž"?new m(1).div(b.value).toString():1/0,se=new m(1).div(w.value).toString());try{Ze=new m(ge).equals(new m(0))?-443636:v.priceToTickIndex(new m(ge),Y,ve)}catch{Ze=-443636}try{tt=v.priceToTickIndex(new m(se),Y,ve)}catch{tt=443636}oe=de(Ze,Number(i.tickSpacing),!0),he=de(tt,Number(i.tickSpacing),!0);try{Ce=v.priceToSqrtPriceX64(new m(ge),Y,ve)}catch{(se===1/0||se==="âˆž")&&(Ce=v.tickIndexToSqrtPriceX64(l.getMinIndex(Number(i.tickSpacing))))}try{Ne=v.priceToSqrtPriceX64(new m(se),Y,ve)}catch{(se===1/0||se==="âˆž")&&(Ne=v.tickIndexToSqrtPriceX64(l.getMaxIndex(Number(i.tickSpacing))))}}else oe=(je=at.value[X.value])==null?void 0:je.lower,he=($e=at.value[X.value])==null?void 0:$e.upper,Ce=v.tickIndexToSqrtPriceX64(oe),Ne=v.tickIndexToSqrtPriceX64(he);if(b.value!=="âˆž"&&oe>=he){console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:639 ~ updateAmounts ~",b.value!=="âˆž"&&oe>=he),p.value=!0,F.value="",N.value=!0,R.value="";return}if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:708 ~ updateAmounts ~ currentTickIndex:",pe),b.value==="âˆž"||pe>=oe&&pe<he){p.value=!1,N.value=!1;let le;if(F.value||R.value){if(Oe.value){const Lt=new m(F.value).mul(Math.pow(10,_.value.decimals)).toString();le=new Ue(Lt)}else{const Lt=new m(R.value).mul(Math.pow(10,h.value.decimals)).toString();le=new Ue(Lt)}v.tickIndexToSqrtPriceX64(n.value.current_tick_index);const{liquidityAmount:Fe,tokenMaxA:Ye,tokenMaxB:_t,tokenMaxAOrigin:ei,tokenMaxBOrigin:ti}=k.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:i.token_a,tokenB:i.token_b,lowerTick:oe,upperTick:he,coinAmount:le,iscoinA:ae?Oe.value:!Oe.value,roundUp:!0,slippage:Number(me.value)/100,curSqrtPrice:new Ue(n.value.current_sqrt_price)});K.value={liquidityAmount:Fe,tokenMaxA:Ye,tokenMaxB:_t,tokenMaxAOrigin:ei,tokenMaxBOrigin:ti},ae?Oe.value?R.value=Number(_t)>0?_t:"":F.value=Number(Ye)>0?Ye:"":Oe.value?R.value=Ye:F.value=_t}}else if(pe>=he){if(ae?F.value="":R.value="",p.value=ae,N.value=!ae,F.value||R.value){let le;if(ae){const Fe=new m(R.value).mul(Math.pow(10,(Me=h.value)==null?void 0:Me.decimals)).toString();le=new Ue(Fe),K.value={liquidityAmount:k.value.estimateLiquidityForCoinB(Ce,Ne,le),tokenMaxA:0,tokenMaxB:R.value}}else{const Fe=new m(F.value).mul(Math.pow(10,(Ke=_.value)==null?void 0:Ke.decimals)).toString();le=new Ue(Fe),K.value={liquidityAmount:k.value.estimateLiquidityForCoinB(Ce,Ne,le),tokenMaxA:0,tokenMaxB:F.value}}}}else if(pe<oe){if(p.value=!ae,N.value=ae,ae?R.value="":F.value="",F.value||R.value){let le;if(ae){const Fe=new m(F.value).mul(Math.pow(10,_.value.decimals)).toString();le=new Ue(Fe),K.value={liquidityAmount:k.value.estimateLiquidityForCoinA(Ce,Ne,le),tokenMaxA:F.value,tokenMaxB:0}}else{const Fe=new m(R.value).mul(Math.pow(10,h.value.decimals)).toString();le=new Ue(Fe),K.value={liquidityAmount:k.value.estimateLiquidityForCoinA(Ce,Ne,le),tokenMaxA:R.value,tokenMaxB:0}}}}else p.value=!0,console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:783 ~ updateAmounts ~ showFromCoinLock.value:",p.value),F.value="",N.value=!0,R.value=""};Ie(()=>n.value,(i,l)=>{(!l&&i&&!re(i)||l&&i&&l.address!==i.address)&&ee(i,!l||i.address!==l.address),i&&!re(i)&&M()},{immediate:!0}),Ie(F,(i,l)=>{i==""&&Oe.value&&(R.value=""),i&&Oe.value&&!Xe.value&&M()}),Ie(R,(i,l)=>{i==""&&!Oe.value&&(F.value=""),i&&!Oe.value&&!Xe.value&&M()}),Ie(()=>_e.value,(i,l)=>{M()}),Ie(()=>[_.value,h.value],([i,l])=>{i&&l&&(p.value=!1,N.value=!1)});const S=T("--"),te=f(()=>L.value.RATES),fe=()=>{var v,de,Y,ve;const i=te.value&&te.value[(v=_.value)==null?void 0:v.address]&&te.value[(de=_.value)==null?void 0:de.address].price,l=te.value&&te.value[(Y=h.value)==null?void 0:Y.address]&&te.value[(ve=h.value)==null?void 0:ve.address].price;if(i&&l){const ge=new m(F.value>0?F.value:0).mul(i),se=new m(R.value>0?R.value:0).mul(l),oe=ge.add(se).toNumber();S.value=oe>0&&oe<.01?"<$0.01":"$"+Te(oe,2)}else S.value="--"};Ie(()=>[F.value,R.value,Xe.value],([i,l,v])=>{(i||l)&&!v?fe():(!i||!l)&&!v&&(S.value="--")},{immediate:!0});const O=T(),$=async()=>{var ae,je;if(!w.value&&!b.value)return!1;if(!F.value&&!R.value&&!w.value&&!b.value)return;const i=n.value;if(re(i))return;const{TickUtil:l,TickMath:v,getNearestTickByTick:de}=k.value,Y=i==null?void 0:i.token_a.decimals,ve=i==null?void 0:i.token_b.decimals;let ge,se,oe,he,Ce,Ne,Ze;if(i.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&i.token_b.address.toLowerCase()===h.value.address.toLowerCase()?Ze=!0:Ze=!1,w.value==="0"&&b.value==="âˆž")oe=l.getMinIndex(Number(i.tickSpacing)),he=l.getMaxIndex(Number(i.tickSpacing));else if(X.value=="custom"){Ze?(ge=Number(w.value),se=Number(b.value)):(ge=new m(1).div(b.value).toString(),se=new m(1).div(w.value).toString());try{Ce=ge==0?-443636:v.priceToTickIndex(new m(ge),Y,ve)}catch{Ce=-443636}try{Ne=v.priceToTickIndex(new m(se),Y,ve)}catch{Ne=443636}oe=de(Ce,Number(i.tickSpacing),!0),he=de(Ne,Number(i.tickSpacing),!0)}else oe=(ae=at.value[X.value])==null?void 0:ae.lower,he=(je=at.value[X.value])==null?void 0:je.upper;const tt=te.value[i==null?void 0:i.token_a.address].price,pe=te.value[i==null?void 0:i.token_b.address].price;_e.value?new Ue(i.current_sqrt_price):new Ue(1/i.current_sqrt_price);try{const{amountA:$e,amountB:Me,tokenAmountsInfo:Ke}=await k.value.estCoinAmountsFromTotalAmount({lowerTick:oe,upperTick:he,decimalsA:Y,decimalsB:ve,curSqrtPrice:new Ue(i.current_sqrt_price),totalAmount:S.value.replace(/[^\d.]/g,""),tokenPriceA:tt,tokenPriceB:pe});O.value=Ke,i.needReverse?_e.value?(F.value=$e,R.value=Me):(F.value=Me,R.value=$e):(F.value=$e,R.value=Me)}catch($e){console.log($e,"e===>")}};Ie([w,b],([i,l])=>{Xe.value?Xe.value&&$():M(),l!=="âˆž"&&Number(i)!==0&&Number(l)!==0&&Number(i)>=Number(l)?ct.value=!0:ct.value=!1,Number(i)==0&&Number(l)==0&&mt.value&&(ct.value=!0)},{deep:!0,immediate:!0});const ie=i=>{const l=i.replace(/[^\d.]/g,""),v="$"+Te(l);Xe.value=!0,S.value=v,l>0?$():(F.value="",R.value="")},U=T(!1),{setTransactionTxid:Ae,setTransactionDesc:C,setIsShowWaiting:V,setIsShowSuccess:ze,setPositiomNum:Le,setIsShowRejected:Qe}=G,Ge=Ti(),Ee=f(()=>L.value.currentPositionInfo),nt=T(!1),Be=T(!0),we=Tt(),De=f(()=>we),xe=f(()=>De.value.farmsPoolObj);Ie(()=>[xe.value,n.value],([i,l])=>{i&&!re(i)&&l&&!re(l)&&(i[l.address]||(Be.value=!1))},{immediate:!0});const We=T(),He=T(),qe=i=>{We.value=i,i?Be.value=!0:Be.value=!1},t=async(i,l,v,de)=>{try{l=="farming"?await L.value.setCurrentPositionInfo("","","","Sui",v,"farming"):await L.value.setCurrentPositionInfo(i,"","",A.value,de),await ui(3e3),Be.value?await Ge.subscribePosition({pool_address:Ee.value.clmm_pool_id,position_index:Ee.value.name.split("-")[1]},Ee.value.clmm_position_id):await Ge.subscribePosition({pool_address:Ee.value.poolAddress,position_index:Ee.value.index},Ee.value.nftHash)}catch(Y){console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1151 ~ notifiSubscribePosition ~ error:",Y)}},u=async i=>{var Ce,Ne,Ze,tt;U.value=!1,L.value.currentPositionInfo={},Ae(""),C(e("tips.increaseLiquiditySuccess",{from:p.value?"":`${Te(F.value)} ${(Ce=_.value)==null?void 0:Ce.symbol}`,and:!p.value&&!N.value?"and":"",to:N.value?"":`${Te(R.value)} ${(Ne=h.value)==null?void 0:Ne.symbol}`})),V(!0);const l=_e.value?Oe.value:!Oe.value;let v,de,Y,ve,ge,se;const oe=n.value.token_a.decimals,he=n.value.token_b.decimals;if(w.value==="0"&&b.value==="âˆž")Y=k.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)),ve=k.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing));else if(X.value=="custom"){_e.value?(v=w.value,de=b.value):(v=new m(1).div(b.value).toString(),de=new m(1).div(w.value).toString());try{ge=v==0?k.value.TickUtil.getMinIndex(Number(n.value.tickSpacing)):k.value.TickMath.priceToTickIndex(new m(v),oe,he)}catch{ge=k.value.TickUtil.getMinIndex(Number(n.value.tickSpacing))}try{se=k.value.TickMath.priceToTickIndex(new m(de),oe,he)}catch{se=k.value.TickUtil.getMaxIndex(Number(n.value.tickSpacing))}Y=k.value.getNearestTickByTick(ge,Number(n.value.tickSpacing),!0),ve=k.value.getNearestTickByTick(se,Number(n.value.tickSpacing),!0)}else Y=at.value[X.value].lower,ve=at.value[X.value].upper;try{let pe;Xe.value?pe=await k.value.getCreateAddLiquidityPayload({pool:n.value,curSqrtPrice:new Ue(n.value.current_sqrt_price),tickLower:Y,tickUpper:ve,slippage:Number(me.value)/100,tokenAmounts:O.value}):pe=await k.value.getAddLiquidityTransactionPayload({pool:{poolAddress:n.value.poolAddress,token_a:n.value.token_a,token_b:n.value.token_b},amount:Oe.value?F.value:R.value,fix_amount_a:l,tick_lower:Y,tick_upper:ve,index:0,slippage:Number(me.value)/100,roundUp:!0,collect_fee:!1,curSqrtPrice:new Ue(n.value.current_sqrt_price),farmPoolInfo:We.value});let ae;if(A.value==="Aptos")ae=await y.value.currentWallet.signAndSubmitTransaction(pe);else{const je=await k.value.signAndExecuteTransactionBlock(y.value.currentWallet,pe==null?void 0:pe.txb,pe==null?void 0:pe.payloadParams);ae=k.value.handleTx(je)}if(console.log("0410###tx###",ae),ae&&ae.hash){Ae(ae.hash),V(!1),ze(!0);let je;n.value.needReverse?n.value.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===h.value.address.toLowerCase()?je=!1:je=!0:n.value.token_a.address.toLowerCase()===_.value.address.toLowerCase()&&n.value.token_b.address.toLowerCase()===h.value.address.toLowerCase()?je=!0:je=!1;const $e={title:"Supplied",desc:e("tips.addLiquiditySuccessText",{from:p.value?"":`${Te(F.value)} ${(Ze=_.value)==null?void 0:Ze.symbol}`,and:!p.value&&!N.value?"and":"",to:N.value?"":`${Te(R.value)} ${(tt=h.value)==null?void 0:tt.symbol}`}),hash:ae.hash,tit:"Position Created",icon:"icon-icon-Position-Created"};A.value!=="Aptos"&&($e.res=ae.res),k.value.showTransitionPending($e),console.log($e,"toAdd params###");const Me=await k.value.watchTransaction($e,!0);if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1295 ~ toAdd ~ watchInfo:",Me),Me.status){ze(!1),L.value.setCurrentPositionLoading(!0);let Ke,le;A.value==="Aptos"?He.value={token_a:n.value.token_a,token_b:n.value.token_b,minPrice:w.value,maxPrice:b.value,pool:n.value.address,collection:Me.nftInfo[0].data.id.collection,tokenName:Me.nftInfo[0].data.name}:(le=Me.nftInfo,console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1319 ~ toAdd ~ nftInfo:",le),Be.value?(Me.res.events.forEach(Ye=>{Ye.type.indexOf("::pool::DepositEvent")>-1&&(Ke=Ye.parsedJson.wrapped_position_id)}),He.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:w.value,maxPrice:b.value,id:Ke,clmm_pool_id:n.value.address,pool:n.value.address}):He.value={token_a:n.value.needReverse?n.value.token_b:n.value.token_a,token_b:n.value.needReverse?n.value.token_a:n.value.token_b,minPrice:w.value,maxPrice:b.value,pos_object_id:le.position,pool:n.value.address},console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1389 ~ toAdd ~ positionInfoDetail:",He.value)),nt.value=!0;const Fe=n.value.poolAddress;setTimeout(()=>{if(i){const Ye=Ke?"farming":"clmm";console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1400 ~ setTimeout ~ poolInfo.value.poolAddress:",Fe),t(Fe,Ye,Ke,le==null?void 0:le.position)}},3e3),setTimeout(()=>{Q.updateCurrentPools(Fe,A.value),k.value.getAccount(y.value.address)},3e3),setTimeout(async()=>{jt(k,n)},7e3)}Le()}else V(!1),Qe(!0);F.value="",R.value=""}catch(pe){F.value="",R.value="",console.log("0330###Add liquidity Error###",pe),V(!1),Qe(!0)}},I=f(()=>!!(!F.value&&!R.value||Number(F.value)>Number(Pe.value)||Number(R.value)>Number(d.value)||r.value!==e("button.addLiquidity")&&r.value!==e("newAdd.preview")||n.value&&n.value&&n.value.is_pause||Number(F.value)<=0&&Number(R.value)<=0||!p.value&&Number(F.value)==0||!N.value&&Number(R.value)==0)),o=f(()=>!_.value||!h.value),r=f(()=>n.value&&n.value.is_pause?"Pool Closed":!_.value||!h.value||o.value?e("modal.selectTokenModalTitle"):Number(F.value)>Number(Pe.value)?e("button.insufficientBalance",{name:_.value.symbol}):Number(R.value)>Number(d.value)?e("button.insufficientBalance",{name:h.value.symbol}):!Number(F.value)&&!Number(R.value)?e("button.enterAmount"):b.value!=="âˆž"&&Number(w.value)>=Number(b.value)?e("newAdd.invalidRange"):e("button.addLiquidity")),z=T({}),E=T({}),ne=T(!1),Ve=(i,l)=>{const v=localStorage.getItem(i.address);console.log("ðŸš€ðŸš€ðŸš€ ~ file: sui-liquidity-right.vue:1518 ~ getTokenSource ~ coinLocak:",v,i),i!=null&&i.isSelfBuilt&&!v&&(l=="fromCoin"&&(z.value=i),l=="toCoin"&&(E.value=i),ne.value=!0)};Ie(()=>[_.value,h.value],([i,l])=>{i&&!re(i)&&Ve(i,"fromCoin"),l&&!re(l)&&Ve(l,"toCoin")},{immediate:!0});const ot=Zt(),Je=()=>{A.value!=="Aptos"?ot.push("/pool/list"):ot.push("/pools")},et=i=>{Xe.value,u(i)},bt=()=>{J.query.action!=="create-pool"&&J.query.actions!=="new-position"&&(jt(k,n),M(),y.value.address&&k.value.getAccount(y.value.address),Q.updateCurrentPools(n.value.poolAddress,A.value)),Q.setPoolConfigList(A.value,x.value.filterCoinsObj)},kt=f(()=>{var v,de,Y,ve,ge,se;const i=(Y=te.value[(de=(v=_)==null?void 0:v.value)==null?void 0:de.address])==null?void 0:Y.price,l=(se=te.value[(ge=(ve=h)==null?void 0:ve.value)==null?void 0:ge.address])==null?void 0:se.price;return!!(i&&l)});Ie(()=>[J,L.value.tokensObj],([i,l])=>{var v;l&&!re(l)&&(h.value||(h.value=L.value.tokensObj[(v=i==null?void 0:i.query)==null?void 0:v.toCoin]))},{immediate:!0,deep:!0});const ht=T(!1);return{lever:f(()=>{const i=Number(w.value),l=Number(b.value);if(w.value=="0"&&b.value=="âˆž"||X.value=="full range")return"1x";if(w.value==b.value||X.value=="full range")return"--";if(w.value&&b.value&&w.value!=="0"&&b.value!=="âˆž"){const v=Yt(1/(1-Number((i/l)**.25)),2);return Number(v)>0?v+"x":"--"}else return 1}),isInputActive:ht,positionError:ct,decimalUi:ke,poolInfo:n,fromCoinAmount:F,toCoinAmount:R,fromCoin:_,toCoin:h,theme:j,showFromCoinLock:p,showToCoinLock:N,fromCoinBlance:Pe,toCoinBlance:d,fixedFromCoin:Oe,openCoinSelect:H,currentCoinKey:a,existingCoins:P,lastSelectCoin:g,showCoinSelect:Z,onCoinSelect:ce,liquidityTotalAmount:S,toggle:Jt,onInput:ie,isInputTotalAmount:Xe,isViewDetail:nt,addLiquidityBtnDisabled:I,addLiquidityBtnText:r,isShowTokenWarning:ne,chainName:A,closeTokenWarning:Je,warningFromCoin:z,warningToCoin:E,isShowLiquidityModal:U,currentPrice:mt,currentPriceReverse:wt,currentPriceTab:X,minPrice:w,maxPrice:b,toAdd:u,direction:_e,wallet:y,getAddLiquidityType:et,clickRefresh:bt,isShowtotalAmount:kt,isAutoStakeFarming:Be,farmPoolInfo:We,getFarmsPoolInfo:qe,positionInfoDetail:He,getTokenSource:Ve}}});const ro={class:"sui-liquidity-right-box"},so={class:"sui-liquidity-right"},lo={class:"deposit-title"},uo={key:0,class:"create-pool-lock"},co=s("img",{src:Li,alt:""},null,-1),vo=[co],mo={key:0,class:"from-lock"},fo={key:1,class:"to-lock"},go=s("div",{class:"exchange-new"},[s("svg",{class:"icon icon-down","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_add1"})])],-1),po=[go],bo={class:"show-info"},ko={key:0,class:"total-amount"},ho=s("span",null,"Total Amount",-1);function _o(e,c,G,x,A,Q){const L=Se("SuiLiquidityTitle"),q=Se("TokenInputBlock"),y=Se("InputLock"),J=Se("SuiLiquidityDepositRatio"),n=Se("SuiLiquidityLever"),p=Gt,N=Pi,j=Se("SuiViewDetail"),ee=Se("SuiAddOrCreate"),Pe=Se("SuiFarmsAutoStake");return B(),W("div",ro,[s("div",so,[s("div",lo,[ue(L,{"pool-info":e.poolInfo,onClickRefresh:e.clickRefresh},null,8,["pool-info","onClickRefresh"])]),e.positionError?(B(),W("div",uo,vo)):ye("",!0),s("div",{class:vt(["card-container",e.isInputActive?e.fixedFromCoin?"input-block-add-top":"input-block-add-bottom":"input-block-add-top input-block-inactive"])},[ue(q,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":c[0]||(c[0]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"token-info":e.fromCoin||null,"has-arrow":!1,onOnInput:c[1]||(c[1]=d=>{e.isInputActive=!0,e.fromCoinAmount=d,e.fixedFromCoin=!0,e.isInputTotalAmount=!1}),onOnFocus:c[2]||(c[2]=()=>{e.isInputActive=!0,e.fixedFromCoin=!0}),onOnBlur:c[3]||(c[3]=()=>{e.isInputActive=!1})},null,8,["modelValue","input-value","token-info"]),ue(q,{modelValue:e.toCoinAmount,"onUpdate:modelValue":c[4]||(c[4]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"token-info":e.toCoin||null,"has-arrow":!1,onOnInput:c[5]||(c[5]=d=>{e.isInputActive=!0,e.toCoinAmount=d,e.fixedFromCoin=!1,e.isInputTotalAmount=!1}),onOnFocus:c[6]||(c[6]=()=>{e.isInputActive=!0,e.fixedFromCoin=!1}),onOnBlur:c[7]||(c[7]=()=>{e.isInputActive=!1})},null,8,["modelValue","input-value","token-info"]),e.showFromCoinLock&&!e.positionError?(B(),W("div",mo,[ue(y,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])])):ye("",!0),e.showToCoinLock&&!e.positionError?(B(),W("div",fo,[ue(y,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"pool-info":e.poolInfo},null,8,["from-coin","to-coin","pool-info"])])):ye("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(B(),W("div",{key:2,class:"new-sui-exchange to-add-logo",onClick:c[8]||(c[8]=(...d)=>e.toggle&&e.toggle(...d))},po)):ye("",!0)],2),s("div",bo,[e.isShowtotalAmount?(B(),W("div",ko,[ho,s("span",null,D(e.liquidityTotalAmount),1)])):ye("",!0),ue(J,{"from-coin":e.fromCoin,"to-coin":e.toCoin,"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"fixed-from-coin":e.fixedFromCoin,"is-input-total-amount":e.isInputTotalAmount,"min-price":e.minPrice,"max-price":e.maxPrice,"current-price-tab":e.currentPriceTab,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","fixed-from-coin","is-input-total-amount","min-price","max-price","current-price-tab","current-price","current-price-reverse"]),ue(n,{lever:e.lever},null,8,["lever"])]),ue(p,{class:"big-btn",disabled:e.wallet.connected?e.addLiquidityBtnDisabled:!1,onClick:c[9]||(c[9]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:it(()=>[gt(D(e.wallet.connected?e.addLiquidityBtnText:e.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),e.showCoinSelect?(B(),rt(N,{key:1,"existing-coins":e.existingCoins,"last-select-coin":e.lastSelectCoin,onOnSelect:e.onCoinSelect,onOnClose:c[10]||(c[10]=d=>e.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):ye("",!0),e.isViewDetail?(B(),rt(j,{key:2,"pool-info":e.poolInfo,"farm-pool-info":e.farmPoolInfo,"position-info":e.positionInfoDetail,"is-auto-stake-farming":e.isAutoStakeFarming,onOnClose:c[11]||(c[11]=d=>e.isViewDetail=!1)},null,8,["pool-info","farm-pool-info","position-info","is-auto-stake-farming"])):ye("",!0),e.isShowLiquidityModal?(B(),rt(ee,{key:3,"pool-info":e.poolInfo,title:e.$t("button.addLiquidity"),"from-coin-amount":e.fromCoinAmount,"to-coin-amount":e.toCoinAmount,"from-coin":e.fromCoin,"to-coin":e.toCoin,"fixed-from-coin":e.fixedFromCoin,"current-price":e.currentPrice,"current-price-reverse":e.currentPriceReverse,"current-price-tab":e.currentPriceTab,"min-price":e.minPrice,"max-price":e.maxPrice,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"current-direct":e.direction,"is-increase":!1,onToAdd:e.getAddLiquidityType,onOnClose:c[12]||(c[12]=d=>e.isShowLiquidityModal=!1)},null,8,["pool-info","title","from-coin-amount","to-coin-amount","from-coin","to-coin","fixed-from-coin","current-price","current-price-reverse","current-price-tab","min-price","max-price","show-from-coin-lock","show-to-coin-lock","current-direct","onToAdd"])):ye("",!0)]),ue(Pe,{"pool-info":e.poolInfo,"is-active":!e.showFromCoinLock&&!e.showToCoinLock,"is-auto-stake-farming":e.isAutoStakeFarming,onSendFarmsPoolInfo:e.getFarmsPoolInfo},null,8,["pool-info","is-active","is-auto-stake-farming","onSendFarmsPoolInfo"])])}const yo=lt(ao,[["render",_o]]),Po=st({components:{SuiLiquidityLeft:yn,SuiLiquidityRight:yo},setup(){const e=Tt(),c=f(()=>e),G=f(()=>c.value.farmsPoolObj);Xt(()=>{si(),Q.setPoolsLoading(!0)}),Ie(()=>G.value,L=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: deposit.vue:41 ~ watch ~ newVal:",L),L&&re(L)&&e.getFarmsPoolList(!0)},{immediate:!0});const x=Ft(),A=dt();f(()=>A);const Q=St();return{tickList:ut,route:x}}});const wo={key:0,class:"loading-spin-liquidity loading-global"},Co={class:"privide-liquidity"};function Io(e,c,G,x,A,Q){var J,n;const L=Dt,q=Se("SuiLiquidityLeft"),y=Se("SuiLiquidityRight");return B(),W($t,null,[!e.tickList&&((n=(J=e.route)==null?void 0:J.query)!=null&&n.poolAddress)?(B(),W("div",wo,[ue(L)])):ye("",!0),s("div",Co,[ue(q),ue(y)])],64)}const va=lt(Po,[["render",Io],["__scopeId","data-v-d32d60da"]]);export{va as default};
