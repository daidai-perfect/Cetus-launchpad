import{_ as No}from"./new-position-title.f6e3f1f1.js";import{_ as co}from"./token-warning.792e98a7.js";import{_ as Ro}from"./status-block.1f7dc367.js";import{u as Ye,e as Zo,n as Ko,d as ge,a as Q,c as fe,s as Me,b as lo,k as $e}from"./sha256.91c60824.js";import{s as ao,m as Vo,l as xo,b as en,a as on}from"./transform.c672907f.js";import{D as b}from"./decimal.0bdeb344.js";import{a as to,u as io,g as bo,b as Oe,p as Io,r as Oo,s as qo,T as Co,C as nn,e as tn}from"./pool.58e56ed3.js";import{a as Je,r as L,l as A,H as Lo,q as ye,e as Qe,o as _,f as S,t as Se,N as Bo,h as n,p as mo,k as vo,m as fo,s as wo,i as ae,u as J,v as W,j as ve,x as de,y as yo,a4 as sn,b as ro,C as Xe,L as an,a7 as $o,O as So,w as Le,F as Ve,E as oo,B as uo,M as ln,A as ko,c as qe,D as rn,G as un,z as Mo,P as dn,$ as cn,K as mn,S as vn}from"./entry.a6654d09.js";import{i as no}from"./import-icon.de3e6c66.js";import"./index.43c7dce9.js";import{_ as po}from"./assets-card.2cba78b7.js";import{_ as fn}from"./coin-lock.faf6a839.js";import{a as pn}from"./new-add-or-create.6fecfdc7.js";import{_ as hn,a as bn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Uo}from"./notifi.4fdf219a.js";import{_ as kn}from"./apr-tips.db2354eb.js";import{u as jo}from"./farms.0602fe26.js";/* empty css              *//* empty css              */import"./back.2a1ecf6f.js";import"./swap-setting.a8ac71eb.js";/* empty css              */import"./icon-error_2x.ef020134.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.358ebd27.js";import"./useWhale.bbbe018d.js";import"./icon_rewards_2x.90e463e8.js";const go=Math.PI,_o=2*go,Ke=1e-6,gn=_o-Ke;function Eo(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function _n(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Eo;const s=10**t;return function(a){this._+=a[0];for(let q=1,h=a.length;q<h;++q)this._+=Math.round(arguments[q]*s)/s+a[q]}}class wn{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Eo:_n(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,a,q){this._append`Q${+t},${+s},${this._x1=+a},${this._y1=+q}`}bezierCurveTo(t,s,a,q,h,T){this._append`C${+t},${+s},${+a},${+q},${this._x1=+h},${this._y1=+T}`}arcTo(t,s,a,q,h){if(t=+t,s=+s,a=+a,q=+q,h=+h,h<0)throw new Error(`negative radius: ${h}`);let T=this._x1,m=this._y1,o=a-t,l=q-s,v=T-t,d=m-s,w=v*v+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(w>Ke)if(!(Math.abs(d*o-l*v)>Ke)||!h)this._append`L${this._x1=t},${this._y1=s}`;else{let z=a-T,se=q-m,ne=o*o+l*l,ee=z*z+se*se,r=Math.sqrt(ne),f=Math.sqrt(w),N=h*Math.tan((go-Math.acos((ne+w-ee)/(2*r*f)))/2),i=N/f,g=N/r;Math.abs(i-1)>Ke&&this._append`L${t+i*v},${s+i*d}`,this._append`A${h},${h},0,0,${+(d*z>v*se)},${this._x1=t+g*o},${this._y1=s+g*l}`}}arc(t,s,a,q,h,T){if(t=+t,s=+s,a=+a,T=!!T,a<0)throw new Error(`negative radius: ${a}`);let m=a*Math.cos(q),o=a*Math.sin(q),l=t+m,v=s+o,d=1^T,w=T?q-h:h-q;this._x1===null?this._append`M${l},${v}`:(Math.abs(this._x1-l)>Ke||Math.abs(this._y1-v)>Ke)&&this._append`L${l},${v}`,a&&(w<0&&(w=w%_o+_o),w>gn?this._append`A${a},${a},0,1,${d},${t-m},${s-o}A${a},${a},0,1,${d},${this._x1=l},${this._y1=v}`:w>Ke&&this._append`A${a},${a},0,${+(w>=go)},${d},${this._x1=t+a*Math.cos(h)},${this._y1=s+a*Math.sin(h)}`)}rect(t,s,a,q){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${a=+a}v${+q}h${-a}Z`}toString(){return this._}}function eo(e){return function(){return e}}function yn(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const a=Math.floor(s);if(!(a>=0))throw new RangeError(`invalid digits: ${s}`);t=a}return e},()=>new wn(t)}function An(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Do(e){this._context=e}Do.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function In(e){return new Do(e)}function Cn(e){return e[0]}function $n(e){return e[1]}function Sn(e,t){var s=eo(!0),a=null,q=In,h=null,T=yn(m);e=typeof e=="function"?e:e===void 0?Cn:eo(e),t=typeof t=="function"?t:t===void 0?$n:eo(t);function m(o){var l,v=(o=An(o)).length,d,w=!1,z;for(a==null&&(h=q(z=T())),l=0;l<=v;++l)!(l<v&&s(d=o[l],l,o))===w&&((w=!w)?h.lineStart():h.lineEnd()),w&&h.point(+e(d,l,o),+t(d,l,o));if(z)return h=null,z+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:eo(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:eo(+o),m):t},m.defined=function(o){return arguments.length?(s=typeof o=="function"?o:eo(!!o),m):s},m.curve=function(o){return arguments.length?(q=o,a!=null&&(h=q(a)),m):q},m.context=function(o){return arguments.length?(o==null?a=h=null:h=q(a=o),m):a},m}function Po(){}function Fo(e){this._context=e}Fo.prototype={areaStart:Po,areaEnd:Po,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Pn(e){return new Fo(e)}function To(e,t,s){const a=new b(10).pow(t-s);return new b(1.0001).pow(e).mul(a)}const Tn=Je({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const s=L(1),a=L(""),q=L(""),h=A(()=>{var i,g,I;return d.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(g=e.poolInfo)==null?void 0:g.coinA.decimals,(I=e.poolInfo)==null?void 0:I.coinB.decimals).toString()}),T=A(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(h.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(h.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),m=A(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(h.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(h.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=Ye(),l=A(()=>o),v=A(()=>l.value.chainName?to(l.value.chainName):{}),{TickMath:d,getNearestTickByTick:w}=v.value,z=()=>{const i=s.value/2;s.value=i,ee(e.poolInfo,i)},se=()=>{const i=s.value*2;s.value=i,ee(e.poolInfo,i)},ne=(i=[])=>{let g=6;const I=Math.abs(Number(i[0])-Number(i[i.length-1]));return I>=6?g=0:I>=1?g=1:I>=.1?g=2:I>=.01?g=3:I>=.001?g=4:I>=1e-4?g=5:I>=1e-5?g=6:I>=1e-6?g=7:I>=1e-7&&(g=8),g},ee=(i,g=1)=>{if(i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const I=Number(e.poolInfo.current_tick_index);let C=I+100*g,c=I-100*g,te,G;if(e.maxPrice==="∞")G=v.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?G=d.priceToTickIndex(new b(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):G=d.priceToTickIndex(new b(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{G=443636}if(e.minPrice==="0")te=v.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?te=d.priceToTickIndex(new b(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):te=d.priceToTickIndex(new b(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{te=-443636}let re=0;if(e.currentPriceTab!=="full range"){if(I>=te&&I<=G){const U=I-te,he=G-I;re=Math.max(Math.abs(U),Math.abs(he))}else I<te?re=Math.abs(G-I):re=Math.abs(I-te);C=I+re+100*g,c=I-re-100*g}else{const U=(Math.abs(I)>5e3,2e4);C=I+U*g,c=I-U*g}c<-443636&&(c=-443636),C>443636&&(C=443636);const H=new b(i.liquidity).div(Math.pow(10,8)).toString(),$=e.tickList,R=[],B=[];let F={};for(let U=0;U<$.length;U++){if(F=$[U],F.index<=I&&F.index>=c){if(R.length<1&&U!==0){const he=$[U-1];R.unshift({...he,index:c})}R.unshift(F)}else if(F.index>I&&F.index<=C&&(B.push(F),R.length<1&&U!==0)){const he=$[U-1];R.push({...he,index:c})}if(F.index>C){const he=$[U];if(B.push({...he,index:C}),R.length<1&&U!==0){const _e=$[U-1];R.push({..._e,index:c})}break}}let oe="0";for(let U=R.length-1;U>=0;U--)oe=new b(oe).plus(new b(R[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[U].liquityAmount=oe;let Y=H;for(let U=0;U<B.length;U++)Y=new b(Y).plus(new b(B[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),B[U].liquityAmount=Y;let ie=[];const Z=$&&$.length>0?{index:I,liquityAmount:Number(H)}:{index:I,liquityAmount:0};(R.length>0||B.length>0)&&(ie=[...R.reverse(),Z,...B],e.direction||(ie=ie.reverse()));const pe=[];$.forEach(U=>{pe.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),f(ie,c,C,te,G,I)}};let r=L(!1);Lo(()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,window.onresize=()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,ee(e.poolInfo,s.value)}});const f=(i,g,I,C,c,te)=>{let G,re;e.direction?(G=e.before7dContractPriceLowest?d.priceToTickIndex(new b(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?d.priceToTickIndex(new b(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(G=e.before7dContractPriceLowest?d.priceToTickIndex(new b(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?d.priceToTickIndex(new b(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const H={top:30,right:35,bottom:20,left:55};let $,R;r.value,$=340-H.left-H.right,R=205-H.top-H.bottom;const B=I-g,F=parseInt(String(B/4));let oe=[g+F/4,g+F,g+2*F,I-F,I-F/4];const Y=g,ie=I,Z=$/(ie-Y);e.currentPriceTab==="full range"&&(oe=[g,g+2*F,I]);const pe=oe.map(P=>e.direction?To(P,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new b(1).div(To(P,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ne(pe),ao("#chart").selectAll("*").remove();const U=ao("#chart").attr("width",$+H.left+H.right).attr("height",R+H.top+H.bottom).append("g").attr("transform",`translate(${H.left},${H.right})`),he=Vo(i,function(P){return Number(Math.abs(P.liquityAmount))})||0,_e=xo().range([0,R]).domain([he,0]);en().rangeRound([0,$]).padding(.1);const Be=U.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");l.value.theme=="default"?Be.attr("x",function(P,M){return M===0?0:e.direction?Math.abs(P.index-Y)*Z:Math.abs(ie-P.index)*Z}).attr("y",function(P,M){return e.direction?M===i.length-1?0:_e(P.liquityAmount):M===i.length-1?0:_e(i[M+1].liquityAmount)}).attr("width",function(P,M){return M===0&&i.length===1&&P.liquityAmount>0?$:(e.direction,M!==i.length-1?Math.abs(i[M+1].index-P.index)*Z:0)}).attr("height",function(P,M){return M===0&&i.length===1&&P.liquityAmount>0?R:e.direction?M===i.length-1?0:R-_e(P.liquityAmount):M===i.length-1?0:R-_e(i[M+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Be.attr("x",function(P,M){return M===0?0:e.direction?Math.abs(P.index-Y)*Z:Math.abs(ie-P.index)*Z}).attr("y",function(P,M){return e.direction?M===i.length-1?0:_e(Math.abs(P.liquityAmount)):M===i.length-1?0:_e(Math.abs(i[M+1].liquityAmount))}).attr("width",function(P,M){return M===0&&i.length===1&&P.liquityAmount>0?$:(e.direction,M!==i.length-1?Math.abs(i[M+1].index-P.index)*Z:0)}).attr("height",function(P,M){if(M===0&&i.length===1&&P.liquityAmount>0)return R;if(e.direction)return M===i.length-1?0:Number(P.liquityAmount)?R-_e(Math.abs(P.liquityAmount)):0;{if(M===i.length-1)return 0;const ue=R-_e(Math.abs(i[M+1].liquityAmount));return Number(i[M+1].liquityAmount)?ue:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const u=U.append("g");u.append("line").attr("x1",0).attr("y1",155).attr("x2",$).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),u.append("g");let k=0;e.direction?k=Math.abs(te-Y)*Z:k=Math.abs(te-ie)*Z,(l.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+k+", 0)"),ao("#triangle").attr("width",8).attr("height",4);let j=[[0,0],[4,4],[8,0]],K=Sn().x(function(P){return P[0]}).y(function(P){return P[1]}).curve(Pn);const E=k-4;U.append("path").attr("d",K(j)).style("fill",l.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+E+", 0)");let D,V,x,ce;e.direction?(D=C<Y?-100:parseInt(String(Math.abs(C-Y)*Z)),V=c<Y?-100:parseInt(String(Math.abs(c-Y)*Z)),x=G<Y?-100:Math.abs(G-Y)*Z,ce=re<Y?-100:Math.abs(re-Y)*Z):(V=C<Y?-100:Math.abs(ie-C)*Z,D=c<Y?-100:Math.abs(ie-c)*Z,ce=G<Y?-100:Math.abs(ie-G)*Z,x=re<Y?-100:Math.abs(ie-re)*Z),e.minPrice==="0"&&(D=0),e.maxPrice==="∞"&&(V=$),r.value?a.value=$-D+60+"px":a.value=$-D+52+"px",q.value=V+74+"px",G&&x<$&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+x+", 0)"),re&&ce<$&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ce+", 0)");const me=on().extent([[0,0],[$,R]]).handleSize(30).on("end",Pe);U.append("g").attr("class","brush").call(me).call(me.move,[D,V]);function Pe(P){if(!P.sourceEvent||!P.selection)return;r.value?a.value=$-P.selection[0]+60+"px":a.value=$-P.selection[0]+52+"px",q.value=P.selection[1]+74+"px";let M,ue,we=0,y=0;e.direction?(we=w(parseInt(String(P.selection[0]/Z+Y)),Number(e.poolInfo.tickSpacing)),M=d.tickIndexToPrice(we,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),y=w(parseInt(String(P.selection[1]/Z+Y)),Number(e.poolInfo.tickSpacing)),ue=d.tickIndexToPrice(y,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(y=w(ie-P.selection[0]/Z,Number(e.poolInfo.tickSpacing)),M=1/d.tickIndexToPrice(y,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),we=w(ie-P.selection[1]/Z,Number(e.poolInfo.tickSpacing)),ue=1/d.tickIndexToPrice(we,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ge(String(M),6))),t.emit("onChangeMaxPrice",String(ge(String(ue),6)))}l.value.theme=="default"?ao(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):ao(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};L(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,g,I,C])=>{i&&g&&I&&ee(i,s.value)},{immediate:!0});const N=L(!0);return ye(()=>e.chartLoading,(i,g)=>{i!==g&&(N.value=i)},{immediate:!0,deep:!0}),{store:l,loading:N,zoomOut:z,zoomIn:se,rangeSizeLower:T,rangeSizeUpper:m,rangeSizeLowerPosition:a,rangeSizeUpperPosition:q,decimalFormat:Zo,numberformat:Ko}}});const Nn=e=>(mo("data-v-5f6dd244"),e=e(),vo(),e),Rn={class:"chart-box"},On={class:"chart"},qn=Nn(()=>n("svg",{id:"chart"},null,-1)),Ln=[qn];function Bn(e,t,s,a,q,h){return _(),S("div",Rn,[Se(n("div",On,Ln,512),[[Bo,!e.loading]])])}const Wo=Qe(Tn,[["render",Bn],["__scopeId","data-v-5f6dd244"]]),Mn=Je({components:{StatusBlock:Ro,NewPositionChart:Wo,TokenWarning:co},setup(e){const t=L(),s=L(),a=A(()=>{var i,g;return(g=(i=d.value)==null?void 0:i.poolInfo)==null?void 0:g.needReverse}),q=Ye(),h=A(()=>q),T=A(()=>h.value.currentExplorer),m=A(()=>h.value.theme),o=A(()=>h.value.chainName),l=io(),v=A(()=>l),d=L({}),w=fo();ye(()=>[v.value.currentPositionInfo,o.value],([i,g])=>{var I;(g=="Aptos"&&i||g=="Sui"&&i&&(i==null?void 0:i.nftHash)==((I=w==null?void 0:w.query)==null?void 0:I.pos))&&(d.value=i,t.value=d.value.token_a,s.value=d.value.token_b)},{immediate:!0});const z=i=>{var g;return(i==null?void 0:i.logoURI)||(i==null?void 0:i.logo_url)||((g=v.value.tokensObj[i==null?void 0:i.address])==null?void 0:g.logo_url)||(m.value==="default"?no("/image/coins/unknown.png"):no("/image/coins/sui-unknown.png"))},se=A(()=>o.value?to(o.value):{}),ne=L([]),ee=async i=>{const{list:g}=await se.value.getTicks(i),I=g?se.value.getTickDataFromUrlData(g):[];ne.value=I};ye(()=>[d.value,v.value.poolsObj],([i,g])=>{i&&!fe(i)&&i.poolInfo&&g&&!fe(g)&&ee(g[i.poolAddress])},{immediate:!0});const r=L(!0),f=(i,g)=>i!=="0"&&g!=="∞"?Me(1/(1-Number((i/g)**.25)),2)+"x":"1x",N=A(()=>d.value.minPrice&&d.value.maxPrice?f(d.value.minPrice,d.value.maxPrice):"--");return{needReverse:a,getCoinIcon:z,theme:m,indexStore:q,direct:r,addCommom:Q,decimalUi:ge,tickList:ne,positionInfo:d,fromCoin:t,toCoin:s,getExplorerUrl:bo,lever:N,currentExplorer:T}}}),Un=""+globalThis.__publicAssetsURL("image/aptos-price.png"),jn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),En=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),Dn=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const ze=e=>(mo("data-v-06ed9681"),e=e(),vo(),e),Fn={class:"new-position-info"},Wn={class:"pool-info"},Hn={class:"left"},Xn={class:"coin-a"},zn={alt:""},Gn={class:"coin-b"},Yn={alt:""},Jn={class:"position-name"},Qn=["href"],Zn=ze(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Kn=[Zn],Vn={key:0,class:"pool-fee"},xn=ze(()=>n("span",null,"Fee tier",-1)),et={class:"right"},ot={class:"h5-pool-info"},nt={class:"coin-info"},tt={class:"coin-a"},it={alt:""},st={class:"coin-b"},at={alt:""},lt={class:"position-name"},rt=["href"],ut=ze(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),dt=[ut],ct={key:0,class:"pool-fee"},mt={class:"price-info"},vt={class:"price-and-chart"},ft={class:"left"},pt={class:"current-price"},ht=ze(()=>n("span",null,"Current Price",-1)),bt={class:"coin-rate"},kt=ze(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),gt=ze(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),_t=[kt,gt],wt={key:0},yt={key:1},At={key:0,class:"position-range"},It=ze(()=>n("div",{class:"position-range-title"}," Position Range ",-1)),Ct={key:0},$t={key:1},St={key:2,src:Un,alt:""},Pt={key:3,src:jn,alt:""},Tt={key:4},Nt={key:5},Rt={key:1,class:"position-range position-range-warp"},Ot={key:0,class:"position-range-title"},qt={key:1,class:"position-range-title"},Lt={key:2},Bt={key:3},Mt={class:"price-img"},Ut={key:0,src:En,alt:""},jt={key:1,src:Dn,alt:""},Et={key:4},Dt={key:5},Ft={class:"lever"},Wt=ze(()=>n("div",{class:"lever-title"},"Leverage",-1)),Ht={class:"lever-text"},Xt={class:"right"},zt=ze(()=>n("div",{class:"chat-mask"},null,-1));function Gt(e,t,s,a,q,h){var v,d,w,z,se,ne,ee,r,f,N,i,g,I,C,c,te,G,re,H,$,R,B,F,oe,Y,ie,Z,pe,U,he;const T=co,m=Ro,o=Wo,l=wo("image");return _(),S("div",Fn,[n("div",Wn,[n("div",Hn,[n("div",Xn,[Se(n("img",zn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(T,{address:e.needReverse?(z=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:z.address:(d=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:d.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Gn,[Se(n("img",Yn,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(T,{address:e.needReverse?(r=(ee=e.positionInfo)==null?void 0:ee.token_a)==null?void 0:r.address:(ne=(se=e.positionInfo)==null?void 0:se.token_b)==null?void 0:ne.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",Jn,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},W((N=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:N.split("|")[1]),9,Qn)]),(_(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=_e=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},Kn)),e.positionInfo.fee?(_(),S("div",Vn,[xn,ve(" "+W(e.positionInfo.fee*100)+"% ",1)])):de("",!0)]),n("div",et,[ae(m,{"current-status":(i=e.positionInfo)==null?void 0:i.currentStatus},null,8,["current-status"])])]),n("div",ot,[n("div",null,[n("div",nt,[n("div",tt,[Se(n("img",it,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(T,{address:e.needReverse?(c=(C=e.positionInfo)==null?void 0:C.token_b)==null?void 0:c.address:(I=(g=e.positionInfo)==null?void 0:g.token_a)==null?void 0:I.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",st,[Se(n("img",at,null,512),[[l,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(T,{address:e.needReverse?(H=(re=e.positionInfo)==null?void 0:re.token_a)==null?void 0:H.address:(G=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",lt,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(bo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},W((R=($=e.positionInfo)==null?void 0:$.name)==null?void 0:R.split("|")[1]),9,rt),(_(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=_e=>e.indexStore.copy(e.positionInfo.nftHash))},dt))]),e.positionInfo.fee?(_(),S("div",ct,W(e.positionInfo.fee*100)+"%",1)):de("",!0)])]),ae(m,{"current-status":(B=e.positionInfo)==null?void 0:B.currentStatus},null,8,["current-status"])]),n("div",mt,[n("div",vt,[n("div",ft,[n("div",pt,[n("div",null,[ht,n("div",bt,[n("div",{onClick:t[2]||(t[2]=_e=>e.direct=!e.direct)},_t)])]),(e.needReverse?!e.direct:e.direct)?(_(),S("div",wt,[ve(W(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.positionInfo.currentPrice,6)))+"   ",1),n("span",null,W((F=e.toCoin)==null?void 0:F.symbol)+" per "+W((oe=e.fromCoin)==null?void 0:oe.symbol),1)])):(_(),S("div",yt,[ve(W(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.positionInfo.currentPriceReverse,6)))+"   ",1),n("span",null,W((Y=e.fromCoin)==null?void 0:Y.symbol)+" per "+W((ie=e.toCoin)==null?void 0:ie.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(_(),S("div",At,[It,n("div",null,[(e.needReverse?!e.direct:e.direct)?(_(),S("div",Ct,[ve(W(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",$t,[ve(W(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(_(),S("img",St)):(_(),S("img",Pt)),(e.needReverse?!e.direct:e.direct)?(_(),S("div",Tt,[ve(W(((pe=e.positionInfo)==null?void 0:pe.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",Nt,[ve(W(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(_(),S("div",Rt,[(e.needReverse?!e.direct:e.direct)?(_(),S("span",Ot," Position Range ")):(_(),S("span",qt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(_(),S("div",Lt,[ve(W(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",Bt,[ve(W(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Mt,[e.theme=="default"?(_(),S("img",Ut)):(_(),S("img",jt))]),(e.needReverse?!e.direct:e.direct)?(_(),S("div",Et,[ve(W(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.positionInfo.maxPrice,6)):"∞")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(_(),S("div",Dt,[ve(W(((he=e.positionInfo)==null?void 0:he.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),ve("   ")]))])),n("div",Ft,[Wt,n("div",Ht,W(e.lever),1)])]),n("div",Xt,[ae(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),zt])])])])}const Ho=Qe(Mn,[["render",Gt],["__scopeId","data-v-06ed9681"]]),Yt=Je({components:{TokenWarning:co},setup(e,t){const{t:s}=yo(),{$notify:a}=sn(),q=Ye(),h=A(()=>q),T=io(),m=A(()=>T),o=L({}),l=L({}),v=L({}),d=A(()=>h.value.chainName),w=A(()=>d.value?to(d.value):{}),z=fo(),se=L(!1),ne=async(u=null)=>{const k=u||o.value,p=m.value.addressLpTokens[k.poolAddress];if(p){const j=await w.value.getTickDataByIndex(p.ticks_handle,Number(k.tick_lower_index)),K=await w.value.getTickDataByIndex(p.ticks_handle,Number(k.tick_upper_index));let E={};d.value==="Aptos"?E=await w.value.getPosRewardersAmount({poolAddress:I.currentRoute.value.query.address,positionName:I.currentRoute.value.query.token,tickLowerData:j,tickUpperData:K}):E=await w.value.fetchPosRewardersAmount({poolAddress:k.poolAddress,positionId:k.pos_object_id||k.clmm_position_id,coinTypeA:k.coin_type_a||k.coinTypeA,coinTypeB:k.coin_type_b||k.coinTypeB,rewarderInfo:k.poolInfo.rewarder_infos});const D=[];let V=new b(0);E.forEach((x,ce)=>{var M,ue;const me=(M=m.value.tokensObj[x.coin_address])==null?void 0:M.decimals,Pe=x.amount_owed.toString();let P=new b(Pe).div(Math.pow(10,me)).toString();if(d.value=="Aptos"&&Number(P)>999999999&&(P="0"),k.poolInfo[`rewarder_display${ce+1}`]||Number(P)>0){const we=m.value.tokensObj[x.coin_address],y=((ue=m.value.RATES[x.coin_address])==null?void 0:ue.price)||0,X=new b(P).mul(y).toString();V=new b(V).plus(X),D.push({...x,...we,amount:Number(P)>0?$e(P,me):0,amountUSD:Number(X)>0?$e(X,2):0,amountUSDText:X})}}),C.value=D}};ye(()=>[m.value.currentPositionInfo,d.value],([u,k])=>{var p;k=="Aptos"&&u?(o.value=u,l.value=u==null?void 0:u.token_a,v.value=u==null?void 0:u.token_b):k=="Sui"&&u&&(u==null?void 0:u.nftHash)==((p=z==null?void 0:z.query)==null?void 0:p.pos)&&(o.value=u,l.value=u==null?void 0:u.token_a,v.value=u==null?void 0:u.token_b,se.value=!1)},{immediate:!0}),ye(()=>[o.value,m.value.addressLpTokens],([u,k])=>{!fe(u)&&!fe(k)&&ne(u)},{immediate:!0});const ee=A(()=>{var u,k,p,j,K,E,D,V;if(o.value&&!fe(o.value)&&m.value.RATES){const x=o.value.amountA*((k=m.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:k.price),ce=o.value.amountB*((j=m.value.RATES[(p=o.value)==null?void 0:p.token_b.address])==null?void 0:j.price);if((E=m.value.RATES[(K=o.value)==null?void 0:K.token_a.address])!=null&&E.price&&((V=m.value.RATES[(D=o.value)==null?void 0:D.token_b.address])!=null&&V.price)){const me=Number(x+ce);return me>0&&me<.01?"<0.01":Q(Me(x+ce,2),2)}else return" --"}else return" --"}),r=A(()=>{var u,k;return(k=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:k.needReverse}),f=A(()=>m.value.RATES),N=A(()=>{var u,k;if(f.value&&l.value&&v.value&&!fe(f.value)&&!fe(l.value)&&!fe(v.value)){const p=[],j=Number(o.value.feeOwedA)||0,K=Number(o.value.feeOwedB)||0,E=new b(j).mul(((u=f.value[l.value.address])==null?void 0:u.price)||0),D=new b(K).mul(((k=f.value[v.value.address])==null?void 0:k.price)||0);return p.push({amount:j,amountUSD:E.toString()},{amount:K,amountUSD:D.toString()}),p}return[]}),i=A(()=>{var k,p;let u=new b(0);return(k=N.value)==null||k.forEach(j=>{u=u.add(new b(j.amountUSD))}),d.value=="Sui"&&((p=C.value)==null||p.forEach(j=>{u=u.add(new b(j.amountUSDText))})),u.toNumber()}),g=A(()=>{var k;let u=new b(0);return(k=C.value)==null||k.forEach(p=>{u=u.add(new b(p.amountUSDText))}),u.toNumber()}),I=ro(),C=L([]),{setIsShowSuccess:c,setIsShowRejected:te,setIsShowWaiting:G,setTransactionDesc:re,setTransactionTxid:H}=q,$=lo(),R=A(()=>$),B=async()=>{se.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:C.value.length,collect_fee:!0};u.coinTypeC=C.value[0]?C.value[0].coin_address:"",u.coinTypeD=C.value[1]?C.value[1].coin_address:"",u.coinTypeE=C.value[2]?C.value[2].coin_address:"",G(!0),re();try{let k;if(d.value==="Aptos"){const p=await w.value.getCollectRewarderTransactionPayload(u);k=await R.value.currentWallet.signAndSubmitTransaction(p)}else{u.pos_index=o.value.pos_object_id;const p=await w.value.getCollectRewarderTransactionPayload(u,o.value),j=await w.value.signAndExecuteTransactionBlock(R.value.currentWallet,p.txb,p.payloadParams);k=w.value.handleTx(j)}if(k&&k.hash){H(k.hash),G(!1),c(!0);const p={title:"Claim",desc:"",hash:k.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};d.value!=="Aptos"&&(p.res=k.res),w.value.showTransitionPending(p),await w.value.watchTransaction(p)&&t.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),G(!1),te(!0),se.value=!1}catch(k){G(!1),te(!0),se.value=!1,console.log(k,"error===>")}},F=L(!1),oe=async()=>{F.value=!0;const u=C.value;let k={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};k.coinTypeC=u[0]?u[0].coin_address:"",k.coinTypeD=u[1]?u[1].coin_address:"",k.coinTypeE=u[2]?u[2].coin_address:"";try{let p;if(d.value==="Aptos"){const j=await w.value.getCollectRewarderTransactionPayload(k);p=await R.value.currentWallet.signAndSubmitTransaction(j)}else{k.pos_index=o.value.pos_object_id;const j=await w.value.getCollectRewarderTransactionPayload(k),K=await w.value.signAndExecuteTransactionBlock(R.value.currentWallet,j.txb,j.payloadParams);p=w.value.handleTx(K)}if(p&&p.hash){H(p.hash),G(!1),c(!0);const j=u[0].amount+u[0].symbol,K=k.coinTypeD?" and "+u[1].amount+u[1].symbol:"",E=k.coinTypeE?" and "+u[2].amount+u[2].symbol:"",D={title:"Claim",desc:"",hash:p.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:m.value.tokensObj&&u[0]&&u[0].address&&m.value.tokensObj[u[0].address]&&m.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:k.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:k.coinTypeD?m.value.tokensObj&&u[1]&&u[1].address&&m.value.tokensObj[u[1].address]&&m.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:k.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:k.coinTypeE?m.value.tokensObj&&u[2]&&u[2].address&&m.value.tokensObj[u[2].address]&&m.value.tokensObj[u[2].address].logoURI:""},text:j+K+E};d.value!=="Aptos"&&(D.res=p.res),w.value.showTransitionPending(D),await w.value.watchTransaction(D)&&setTimeout(()=>{t.emit("getDetails"),w.value.getAccount(R.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),G(!1),te(!0);F.value=!1}catch(p){console.log("0310###collectRewarderParams Error###",p),F.value=!1,G(!1),te(!0)}},Y=A(()=>m.value.positionDetailCurrentTab),ie=A(()=>{var p,j,K,E,D,V;const u=ge(r.value?(j=o.value)==null?void 0:j.amountB:(p=o.value)==null?void 0:p.amountA,r.value?(V=(D=o.value)==null?void 0:D.token_b)==null?void 0:V.decimals:(E=(K=o.value)==null?void 0:K.token_a)==null?void 0:E.decimals),k=r.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(Y.value=="increase")return k?new b(u).add(new b(k)).toString():"";if(k){const x=new b(u).minus(new b(k)).toString();return x<0?"0":String(x)}else return""}),Z=A(()=>{var p,j,K,E,D,V;const u=ge(r.value?(j=o.value)==null?void 0:j.amountA:(p=o.value)==null?void 0:p.amountB,r.value?(V=(D=o.value)==null?void 0:D.token_a)==null?void 0:V.decimals:(E=(K=o.value)==null?void 0:K.token_b)==null?void 0:E.decimals),k=r.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(Y.value=="increase")return k?new b(u).add(new b(k)).toString():"";if(k){const x=new b(u).minus(new b(k)).toString();return x<0?"0":String(x)}else return""}),pe=A(()=>r.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),U=A(()=>r.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),he=u=>{var k;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((k=m.value.tokensObj[u==null?void 0:u.address])==null?void 0:k.logo_url)||(h.value.theme==="default"?no("/image/coins/unknown.png"):no("/image/coins/sui-unknown.png"))},_e=A(()=>{var E,D,V,x,ce,me,Pe,P,M,ue,we,y;const{fromCoinAmount:u,toCoinAmount:k}=m.value.positionActionAmount,p=m.value.positionDetailCurrentTab,j=ge(r.value?(D=o.value)==null?void 0:D.amountB:(E=o.value)==null?void 0:E.amountA,r.value?(me=(ce=o.value)==null?void 0:ce.token_b)==null?void 0:me.decimals:(x=(V=o.value)==null?void 0:V.token_a)==null?void 0:x.decimals),K=ge(r.value?(P=o.value)==null?void 0:P.amountA:(Pe=o.value)==null?void 0:Pe.amountB,r.value?(y=(we=o.value)==null?void 0:we.token_a)==null?void 0:y.decimals:(ue=(M=o.value)==null?void 0:M.token_b)==null?void 0:ue.decimals);return d.value=="Sui"||p=="remove"&&d.value=="Aptos"&&u==j&&k==K}),je=async()=>{se.value=!0;const u=Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,k=Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;re(s("newAdd.claimWaitingText",{from:r.value?k:u,and:Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:r.value?u:k})),G(!0);let p;const j={pool:o.value.poolInfo,position:o.value};try{const K=await w.value.getCollectFeeTransactionPayload(j);if(d.value==="Aptos")p=await R.value.currentWallet.signAndSubmitTransaction(K);else{const E=await w.value.signAndExecuteTransactionBlock(R.value.currentWallet,K);p=w.value.handleTx(E)}if(p){H(p.hash),G(!1),c(!0);const E={title:"Claim",desc:"",hash:p.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${$e(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${$e(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};d.value!=="Aptos"&&(E.res=p.res),w.value.showTransitionPending(E);const D=await w.value.watchTransaction(E);console.log("0310##toClaim###transitionStatus####",D),D&&setTimeout(()=>{t.emit("getDetails")},1e3)}else G(!1),te(!0),a.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});se.value=!1,console.log("claim####test###",p)}catch(K){console.log("claim###error####",K),se.value=!1,G(!1),te(!0),a.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},Be=Xe(an,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:ee,needReverse:r,decimalUi:ge,pendingFees:N,positionInfo:o,pendingRewarderArr:C,pendingYieldAmount:i,toClaim:je,claimAll:B,fromCoin:l,toCoin:v,showNum:$e,claimLoading:se,addCommom:Q,afterBase:ie,afterQuote:Z,fromCoinAmount:pe,toCoinAmount:U,checkNullObj:fe,getCoinIcon:he,chainName:d,isShowAfterAmount:_e,pendingRewarderAmount:g,toClaimRewards:oe,rewarderLoading:F,indicator:Be}}});const Jt={class:"liquidity-card"},Qt={class:"liquidity-title"},Zt={class:"liquidity-usd"},Kt=n("span",null,"Liquidity",-1),Vt={class:"liquidity-ratio"},xt={class:"coin-ratio"},ei={class:"coin-a-ratio"},oi={class:"coin-b-ratio"},ni={class:"ratio-progress"},ti={class:"base-quote-num"},ii={class:"base-coin-num"},si=n("span",null,"Base",-1),ai={alt:""},li={key:0,class:"after"},ri={class:"quote-coin-num"},ui=n("span",null,"Quote",-1),di={alt:""},ci={key:0,class:"after"},mi={class:"pending-yield"},vi={class:"left"},fi={class:"pending-yield-title"},pi={key:0,class:"after"},hi={class:"right"},bi={class:"fees-rewards"},ki={class:"fees-rewards-item"},gi=n("span",null,"Fees",-1),_i={key:0,class:"after"},wi=n("span",null,"Fees",-1),yi={key:0,class:"after"},Ai=n("span",null,"Mining Rewards",-1),Ii={style:{"margin-top":"5px"}},Ci={alt:""},$i=n("span",null,"Mining Rewards",-1),Si={alt:""},Pi={key:0,class:"after"},Ti={key:0,class:"pending-yield"},Ni={class:"left"},Ri=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Oi={key:0,class:"after"},qi={class:"right"},Li={key:1,class:"fees-rewards"},Bi={class:"fees-rewards-item"},Mi=n("span",null,"Mining Rewards",-1),Ui={alt:""},ji={key:0,class:"after"};function Ei(e,t,s,a,q,h){var v,d,w,z,se,ne,ee,r,f,N,i,g,I,C,c,te,G,re,H,$,R,B,F,oe,Y,ie,Z,pe,U,he,_e,je,Be,u,k,p,j,K,E,D,V,x,ce,me,Pe,P,M,ue,we,y,X,O,le,be,Ce,Te,Ie,Ne,Ee,De,Ge,Re,Ue,Fe,We,Ze,Ae;const T=co,m=uo,o=ln,l=wo("image");return _(),S("div",Jt,[n("div",Qt,[n("div",Zt,[Kt,n("div",null,"$"+W(e.amountUSD),1)]),n("div",Vt,[n("div",xt,[n("div",ei,[n("span",null,W(e.needReverse?(d=e.toCoin)==null?void 0:d.symbol:(v=e.fromCoin)==null?void 0:v.symbol),1),ve(" "+W(e.needReverse?(z=e.positionInfo)==null?void 0:z.toPercent:(w=e.positionInfo)==null?void 0:w.fromPercent)+"% ",1)]),n("div",oi,[n("span",null,W(e.needReverse?(ne=e.fromCoin)==null?void 0:ne.symbol:(se=e.toCoin)==null?void 0:se.symbol),1),ve(" "+W(e.needReverse?(r=e.positionInfo)==null?void 0:r.fromPercent:(ee=e.positionInfo)==null?void 0:ee.toPercent)+"% ",1)])]),n("div",ni,[n("div",{class:"from-percent",style:So({width:e.needReverse?((N=e.positionInfo)==null?void 0:N.toPercent)+"%":((f=e.positionInfo)==null?void 0:f.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:So({width:e.needReverse?((g=e.positionInfo)==null?void 0:g.fromPercent)+"%":((i=e.positionInfo)==null?void 0:i.toPercent)+"%"})},null,4)])])]),n("div",ti,[n("div",ii,[si,n("div",null,[Se(n("img",ai,null,512),[[l,(e.needReverse?(C=e.toCoin)==null?void 0:C.logo_url:(I=e.fromCoin)==null?void 0:I.logo_url)||e.getCoinIcon(e.needReverse?(te=e.positionInfo)==null?void 0:te.token_b:(c=e.positionInfo)==null?void 0:c.token_a)]]),ae(T,{address:e.needReverse?($=(H=e.positionInfo)==null?void 0:H.token_b)==null?void 0:$.address:(re=(G=e.positionInfo)==null?void 0:G.token_a)==null?void 0:re.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.needReverse?(B=e.positionInfo)==null?void 0:B.amountB:(R=e.positionInfo)==null?void 0:R.amountA,e.needReverse?(ie=(Y=e.positionInfo)==null?void 0:Y.token_b)==null?void 0:ie.decimals:(oe=(F=e.positionInfo)==null?void 0:F.token_a)==null?void 0:oe.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)?(_(),S("div",li,W(("addCommom"in e?e.addCommom:J(Q))(e.afterBase))+" after ",1)):de("",!0)]),n("div",ri,[ui,n("div",null,[Se(n("img",di,null,512),[[l,(e.needReverse?(pe=e.fromCoin)==null?void 0:pe.logo_url:(Z=e.toCoin)==null?void 0:Z.logo_url)||e.getCoinIcon(e.needReverse?(he=e.positionInfo)==null?void 0:he.token_a:(U=e.positionInfo)==null?void 0:U.token_b)]]),ae(T,{address:e.needReverse?(u=(Be=e.positionInfo)==null?void 0:Be.token_a)==null?void 0:u.address:(je=(_e=e.positionInfo)==null?void 0:_e.token_b)==null?void 0:je.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(ge))(e.needReverse?(p=e.positionInfo)==null?void 0:p.amountA:(k=e.positionInfo)==null?void 0:k.amountB,e.needReverse?(D=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:D.decimals:(K=(j=e.positionInfo)==null?void 0:j.token_b)==null?void 0:K.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)?(_(),S("div",ci,W(("addCommom"in e?e.addCommom:J(Q))(e.afterQuote))+" after ",1)):de("",!0)])]),n("div",mi,[n("div",vi,[n("div",fi,W(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[ve(" $"+W(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(_(),S("span",pi,"$0 after")):de("",!0)])]),n("div",hi,[ae(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:t[0]||(t[0]=ke=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[ve("Claim")]),_:1},8,["loading","disabled"])])]),n("div",bi,[n("div",ki,[n("div",null,[gi,n("div",null,[Se(n("img",null,null,512),[[l,(e.needReverse?(x=e.toCoin)==null?void 0:x.logo_url:(V=e.fromCoin)==null?void 0:V.logo_url)||e.getCoinIcon(e.needReverse?(me=e.positionInfo)==null?void 0:me.token_b:(ce=e.positionInfo)==null?void 0:ce.token_a)]]),ae(T,{address:e.needReverse?(ue=(M=e.positionInfo)==null?void 0:M.token_b)==null?void 0:ue.address:(P=(Pe=e.positionInfo)==null?void 0:Pe.token_a)==null?void 0:P.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:J($e))(e.positionInfo.feeOwedB,(O=(X=e.positionInfo)==null?void 0:X.token_b)==null?void 0:O.decimals):("showNum"in e?e.showNum:J($e))(e.positionInfo.feeOwedA,(y=(we=e.positionInfo)==null?void 0:we.token_a)==null?void 0:y.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",_i," 0 after ")):de("",!0)]),n("div",null,[wi,n("div",null,[Se(n("img",null,null,512),[[l,(e.needReverse?(be=e.fromCoin)==null?void 0:be.logo_url:(le=e.toCoin)==null?void 0:le.logo_url)||e.getCoinIcon(e.needReverse?(Te=e.positionInfo)==null?void 0:Te.token_a:(Ce=e.positionInfo)==null?void 0:Ce.token_b)]]),ae(T,{address:e.needReverse?(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.address:(Ne=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:Ne.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:J($e))(e.positionInfo.feeOwedA,(Fe=(Ue=e.positionInfo)==null?void 0:Ue.token_a)==null?void 0:Fe.decimals):("showNum"in e?e.showNum:J($e))(e.positionInfo.feeOwedB,(Re=(Ge=e.positionInfo)==null?void 0:Ge.token_b)==null?void 0:Re.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",yi," 0 after ")):de("",!0)]),e.chainName=="Sui"?(_(),S(Ve,{key:0},[e.pendingRewarderArr.length==0&&((Ae=(Ze=(We=e.positionInfo)==null?void 0:We.poolInfo)==null?void 0:Ze.rewarderInfo)==null?void 0:Ae.length)>0?(_(!0),S(Ve,{key:0},oo(e.positionInfo.poolInfo.rewarderInfo,ke=>(_(),S("div",{key:ke.coinAddress},[Ai,n("div",Ii,[Se(n("img",Ci,null,512),[[l,e.getCoinIcon({address:ke.coinAddress})]]),ae(T,{address:ke.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),ae(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):de("",!0),(_(!0),S(Ve,null,oo(e.pendingRewarderArr,ke=>(_(),S("div",{key:ke},[$i,n("div",null,[Se(n("img",Si,null,512),[[l,ke.logo_url]]),ae(T,{address:ke.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(ke.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",Pi," 0 after ")):de("",!0)]))),128))],64)):de("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(_(),S("div",Ti,[n("div",Ni,[Ri,n("div",null,[ve(" $"+W(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(_(),S("span",Oi,"$0 after")):de("",!0)])]),n("div",qi,[ae(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[ve("Claim")]),_:1},8,["loading","disabled","onClick"])])])):de("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(_(),S("div",Li,[n("div",Bi,[(_(!0),S(Ve,null,oo(e.pendingRewarderArr,ke=>(_(),S("div",{key:ke},[Mi,n("div",null,[Se(n("img",Ui,null,512),[[l,ke.logo_url]]),ae(T,{address:ke.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(ke.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(fe))(e.positionInfo)&&e.isShowAfterAmount?(_(),S("div",ji," 0 after ")):de("",!0)]))),128))])])):de("",!0)])}const Xo=Qe(Yt,[["render",Ei]]),Di=Je({components:{AssetsCard:po},setup(e,t){const s=L(""),a=L(""),q=Ye(),h=A(()=>q),T=A(()=>h.value.theme),m=io(),o=A(()=>m),l=L(!1),v=L(!1),d=L(!0),w=A(()=>h.value.chainName),z=A(()=>w.value?to(w.value):{}),se=lo(),ne=A(()=>se),ee=A(()=>h.value.slippage),r=L(),f=L(),N=A(()=>ne.value.assets&&r.value&&ne.value.assets[r.value.address]?Io(ne.value.assets[r.value.address].balance,r.value.decimals):0),i=A(()=>ne.value.assets&&f.value&&ne.value.assets[f.value.address]?Io(ne.value.assets[f.value.address].balance,f.value.decimals):0),g=p=>{p==="fromCoin"?(d.value=!0,w.value==="Aptos"?s.value=N.value>0?r.value.symbol=="APT"?new b(Number(N.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(N.value)).sub(new b(.1)).toString():String(N.value):"":s.value=N.value>0?r.value.symbol=="SUI"?new b(Number(N.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(N.value)).sub(new b(.05)).toString():String(N.value):""):(d.value=!1,w.value==="Aptos"?a.value=i.value>0?f.value.symbol=="APT"?new b(Number(i.value)).sub(new b(.1)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.1)).toString():String(i.value):"":a.value=i.value>0?f.value.symbol=="SUI"?new b(Number(i.value)).sub(new b(.05)).lt(new b(0))?"0":new b(Number(i.value)).sub(new b(.05)).toString():String(i.value):"")},I=p=>{p==="fromCoin"?(d.value=!0,s.value=Me(new b(Number(N.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,a.value=Me(new b(Number(i.value)).div(2).toString(),f.value.decimals).toString())},C=L({}),c=L(!0),te=L({}),G=L(),re=L(),H=()=>{var M;if(!C.value||!s.value&&!a.value)return;const{TickMath:p,TickUtil:j}=z.value;let K=C.value.minPrice,E=C.value.maxPrice.indexOf("+")>0?"∞":C.value.maxPrice,D=Number(C.value.tick_lower_index),V=Number(C.value.tick_upper_index);const x=Number(C.value.current_tick_index);let ce,me,Pe=Number(K).toString(),P=C.value.maxPrice.indexOf("+")>0||C.value.maxPrice==="∞"?"∞":Number(E);if(Pe=="0"&&P=="∞"?(D=Number(C.value.tick_lower_index),V=Number(C.value.tick_upper_index)):(ce=p.priceToSqrtPriceX64(new b(K),r.value.decimals,f.value.decimals),me=p.priceToSqrtPriceX64(new b(E),r.value.decimals,f.value.decimals)),G.value=D,re.value=V,E!=="∞"&&D>=V){l.value=!0,s.value="",v.value=!0,a.value="";return}if(E=="∞"||x>=D&&x<=V){l.value=!1,v.value=!1;let ue;if(s.value||a.value){if(d.value){const be=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new Oe(be)}else{const be=new b(a.value).mul(Math.pow(10,f.value.decimals)).toString();ue=new Oe(be)}const{liquidityAmount:we,tokenMaxA:y,tokenMaxB:X,tokenMaxAOrigin:O,tokenMaxBOrigin:le}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:D,upperTick:V,coinAmount:ue,iscoinA:c.value?d.value:!d.value,roundUp:!0,slippage:Number(ee.value)/100,curSqrtPrice:new Oe(C.value.current_sqrt_price)});te.value={liquidityAmount:we,tokenMaxA:y,tokenMaxB:X,tokenMaxAOrigin:O,tokenMaxBOrigin:le},c.value?d.value?a.value=Number(X)>0?X:"":s.value=Number(y)>0?y:"":d.value?a.value=y:s.value=X}}else if(x>V){if(s.value="",l.value=!0,v.value=!1,s.value||a.value){let ue;const we=new b(a.value).mul(Math.pow(10,(M=f.value)==null?void 0:M.decimals)).toString();ue=new Oe(we),te.value={liquidityAmount:Oo(ce,me,ue),tokenMaxA:0,tokenMaxB:a.value}}}else if(x<D){if(l.value=!1,v.value=!0,a.value="",s.value||a.value){let ue;const we=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();ue=new Oe(we),te.value={liquidityAmount:qo(ce,me,ue),tokenMaxA:s.value,tokenMaxB:0}}}else l.value=!0,s.value="",v.value=!0,a.value="";m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,p=>{if(p&&!fe(p)){C.value=p,r.value=C.value.token_a,f.value=C.value.token_b;let j=Number(C.value.tick_lower_index),K=Number(C.value.tick_upper_index);const E=Number(C.value.current_tick_index);(p.maxPrice.indexOf("+")>0||p.maxPrice==="∞"?"∞":p.maxPrice)=="∞"||E>=j&&E<=K?(l.value=!1,v.value=!1):E>K?(s.value="",l.value=!0,v.value=!1):E<j?(l.value=!1,v.value=!0,a.value=""):(l.value=!0,s.value="",v.value=!0,a.value=""),H()}},{immediate:!0}),ye(s,(p,j)=>{p&&H(),p==""&&(a.value="")}),ye(a,(p,j)=>{p&&H(),p==""&&(s.value="")});const $=A(()=>{var p,j;return(j=(p=C.value)==null?void 0:p.poolInfo)==null?void 0:j.needReverse}),R=A(()=>o.value.RATES),B=A(()=>{var V,x,ce,me;const p=((x=R.value[(V=r.value)==null?void 0:V.address])==null?void 0:x.price)||0,j=((me=R.value[(ce=f.value)==null?void 0:ce.address])==null?void 0:me.price)||0,K=new b(p).mul(new b(s.value||0)),E=new b(j).mul(new b(a.value||0)),D=K.add(E);return D.toNumber()?D.toNumber()>0&&D.toNumber()>.01?Q(D.toString(),2):"<0.01":"--"}),F=L(!1),{t:oe,locale:Y}=yo(),ie=A(()=>{const p=Number(s.value)>Number(N.value),j=Number(a.value)>Number(i.value);return!s.value&&!a.value?oe("button.enterAmount"):p?oe("button.insufficientBalance",{name:r.value.symbol}):j?oe("button.insufficientBalance",{name:f.value.symbol}):oe("newAdd.addMore")}),Z=A(()=>{const p=Number(s.value)>Number(N.value),j=Number(a.value)>Number(i.value);return!!(!s.value&&!a.value||p||j)}),{setIsShowSuccess:pe,setIsShowRejected:U,setIsShowWaiting:he,setTransactionDesc:_e,setTransactionTxid:je,setPositiomNum:Be}=q,u=L(!1);return{theme:T,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:N,toCoinBlance:i,fromCoin:r,toCoin:f,maxBtnSelect:g,halfBtnSelect:I,fixedFromCoin:d,needReverse:$,totalAmount:B,wallet:ne,addLiquidityBtnText:ie,isShowLiquidityModal:F,indexStore:q,positionInfo:C,actionLoading:u,toAdd:async()=>{var V,x,ce,me,Pe,P,M,ue,we,y;F.value=!1,u.value=!0,je("");const p=l.value?"":`${s.value} ${(V=r.value)==null?void 0:V.symbol}`,j=v.value?"":`${a.value} ${(x=f.value)==null?void 0:x.symbol}`;_e(oe("tips.increaseLiquiditySuccess",{from:$.value?j:p,and:!l.value&&!v.value?"and":"",to:$.value?p:j})),he(!0);const K=d.value,E=C.value.poolInfo.rewarder_infos;let D={};D.coinTypeC=E[0]?E[0].coinAddress:"",D.coinTypeD=E[1]?E[1].coinAddress:"",D.coinTypeE=E[2]?E[2].coinAddress:"";try{const X=await z.value.getAddLiquidityTransactionPayload({pool:{poolAddress:C.value.poolAddress,token_a:C.value.token_a,token_b:C.value.token_b},amount:K?te.value.tokenMaxA:te.value.tokenMaxB,fix_amount_a:K,tick_lower:G.value,tick_upper:re.value,index:w.value==="Aptos"?C.value.index:C.value.pos_object_id,slippage:Number(ee.value)/100,roundUp:!0,collect_fee:!0,...D,curSqrtPrice:new Oe(C==null?void 0:C.value.poolInfo.current_sqrt_price),positionInfo:C});let O;if(w.value==="Aptos")O=await ne.value.currentWallet.signAndSubmitTransaction(X);else{const le=await z.value.signAndExecuteTransactionBlock(ne.value.currentWallet,X==null?void 0:X.txb,X==null?void 0:X.payloadParams);O=z.value.handleTx(le)}if(console.log("toAdd###tx###",O),O&&O.hash){je(O.hash),he(!1),pe(!0);const le={title:"Supplied",desc:oe("tips.addLiquiditySuccessText",{from:l.value?"":`${s.value} ${(ce=r.value)==null?void 0:ce.symbol}`,and:!l.value&&!v.value?"and":"",to:v.value?"":`${a.value} ${(me=f.value)==null?void 0:me.symbol}`}),hash:O.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:$.value?`${(P=f.value)==null?void 0:P.address}`:`${(Pe=r.value)==null?void 0:Pe.address}`,numa:$.value?`- ${a.value}`:`- ${s.value}`,logoa:$.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:$.value?`${(ue=r.value)==null?void 0:ue.address}`:`${(M=f.value)==null?void 0:M.address}`,numb:$.value?`- ${s.value}`:`- ${a.value}`,logob:$.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${l.value?"":`${s.value} ${(we=r.value)==null?void 0:we.symbol}`} ${!l.value&&!v.value?"and":""} ${v.value?"":`${a.value} ${(y=f.value)==null?void 0:y.symbol}`}`};w.value!=="Aptos"&&(le.res=O.res),z.value.showTransitionPending(le),await z.value.watchTransaction(le)&&setTimeout(()=>{t.emit("getDetails"),z.value.getAccount(ne.value.address)},1e3),Be()}else he(!1),U(!0);s.value="",a.value="",u.value=!1}catch(X){s.value="",a.value="",console.log("addError###",X),u.value=!1,he(!1),U(!0)}},addLiquidityBtnDisabled:Z,poolStore:m}}});const Fi={class:"new-position-asset"},Wi={class:"add-or-remove"},Hi={class:"liquidity-action-tab"},Xi=n("div",{class:"increase tab-active"}," Increase ",-1),zi={class:"card-item"},Gi={class:"card-item"},Yi={key:0,class:"add",src:hn},Ji={key:1,class:"add",src:bn},Qi={class:"total-amount"},Zi=n("span",null,"Total Amount",-1);function Ki(e,t,s,a,q,h){var v;const T=po,m=fn,o=uo,l=pn;return _(),S("div",Fi,[n("div",Wi,[n("div",Hi,[Xi,n("div",{class:"remove",onClick:t[0]||(t[0]=d=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:ko(e.needReverse?"card-container reverse":"card-container")},[n("div",zi,[ae(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=d=>{e.fromCoinAmount=d}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(_(),qe(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),n("div",Gi,[ae(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=d=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=d=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=d=>{e.toCoinAmount=d}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(_(),qe(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):de("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(_(),S("img",Yi)):de("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(_(),S("img",Ji)):de("",!0)],2),n("div",Qi,[Zi,n("span",null,"$"+W(e.totalAmount),1)])]),e.wallet.connected?(_(),qe(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=d=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(_(),qe(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(_(),qe(l,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(v=e.positionInfo)==null?void 0:v.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=d=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):de("",!0)])}const zo=Qe(Di,[["render",Ki]]),Vi=Je({components:{AssetsCard:po},setup(e,t){const s=L(""),a=L(""),q=Ye(),h=A(()=>q),T=A(()=>h.value.theme),m=io(),o=A(()=>m),l=L(!1),v=L(!1),d=L(!0),w=A(()=>h.value.chainName),z=A(()=>w.value?to(w.value):{}),se=lo(),ne=A(()=>se),ee=A(()=>h.value.slippage),r=L(),f=L(),N=A(()=>{var y,X;return(X=(y=c.value)==null?void 0:y.poolInfo)==null?void 0:X.needReverse}),i=A(()=>{var y;return ge(c==null?void 0:c.value.amountA,(y=c==null?void 0:c.value.token_a)==null?void 0:y.decimals)}),g=A(()=>{var y;return ge(c==null?void 0:c.value.amountB,(y=c==null?void 0:c.value.token_b)==null?void 0:y.decimals)}),I=y=>{y==="fromCoin"?d.value=!0:d.value=!1,B.value=100,oe({value:1})},C=y=>{y==="fromCoin"?(d.value=!0,s.value=Me(new b(Number(i.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,a.value=Me(new b(Number(g.value)).div(2).toString(),f.value.decimals).toString()),$.value=!1},c=L({}),te=L(!0),G=L({}),re=L(),H=L(),$=L(!0),R=()=>{var Ge;if($.value||!c.value||!s.value&&!a.value||Number(s.value)>Number(i.value)||Number(a.value)>Number(g.value))return;if(s.value==i.value&&a.value==g.value){B.value=100,oe({value:1}),$.value=!0;return}const{TickMath:y,TickUtil:X}=z.value;let O=c.value.minPrice,le=c.value.maxPrice.indexOf("+")>0?"∞":c.value.maxPrice,be=Number(c.value.tick_lower_index),Ce=Number(c.value.tick_upper_index);const Te=Number(c.value.current_tick_index);let Ie,Ne,Ee=Number(O).toString(),De=c.value.maxPrice.indexOf("+")>0||c.value.maxPrice==="∞"?"∞":Number(le);if(Ee=="0"&&De=="∞"?(be=Number(c.value.tick_lower_index),Ce=Number(c.value.tick_upper_index)):(Ie=y.priceToSqrtPriceX64(new b(O),r.value.decimals,f.value.decimals),Ne=y.priceToSqrtPriceX64(new b(le),r.value.decimals,f.value.decimals)),re.value=be,H.value=Ce,le!=="∞"&&be>=Ce){l.value=!0,s.value="",v.value=!0,a.value="";return}if(le=="∞"||Te>=be&&Te<=Ce){l.value=!1,v.value=!1;let Re;if(s.value||a.value){if(d.value){const ke=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(ke)}else{const ke=new b(a.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(ke)}const{liquidityAmount:Ue,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae}=z.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:be,upperTick:Ce,coinAmount:Re,iscoinA:te.value?d.value:!d.value,roundUp:w.value!="Sui",slippage:Number(ee.value)/100,curSqrtPrice:new Oe(c.value.current_sqrt_price)});G.value={liquidityAmount:Ue,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae},te.value?d.value?a.value=Number(We)>0?We:"":s.value=Number(Fe)>0?Fe:"":d.value?a.value=Fe:s.value=We}}else if(Te>Ce){if(s.value="",l.value=!0,v.value=!1,s.value||a.value){let Re;const Ue=new b(a.value).mul(Math.pow(10,(Ge=f.value)==null?void 0:Ge.decimals)).toString();Re=new Oe(Ue),G.value={liquidityAmount:Oo(Ie,Ne,Re),tokenMaxA:0,tokenMaxB:a.value}}}else if(Te<be){if(l.value=!1,v.value=!0,a.value="",s.value||a.value){let Re;const Ue=new b(s.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(Ue),G.value={liquidityAmount:qo(Ie,Ne,Re),tokenMaxA:s.value,tokenMaxB:0}}}else l.value=!0,v.value=!0;$.value=!1,B.value=new b(G.value.liquidityAmount.toString()).div(c.value.liquidity).mul(100).toNumber().toFixed(2),F.value=G.value.liquidityAmount,m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})},B=L(50),F=L("0"),oe=y=>{if(!$.value)return;$.value=!0;const X=c.value.token_a.decimals,O=c.value.token_b.decimals,le=c.value.tick_lower_index,be=c.value.tick_upper_index,Ce=Co.tickIndexToSqrtPriceX64(le),Te=Co.tickIndexToSqrtPriceX64(be);let Ie="";y.value!==1?Ie=new b(c.value.liquidity).mul(y.value).toString():Ie=c.value.liquidity,Ie=Me(Ie,0)||"0",F.value=Ie;const Ne=nn.getCoinAmountFromLiquidity(new Oe(Ie),new Oe(c.value.current_sqrt_price),Ce,Te,w.value!="Sui"),Ee=new b(Ne.coinA.toString()).div(Math.pow(10,X)).toString(),De=new b(Ne.coinB.toString()).div(Math.pow(10,O)).toString();s.value=Number(Ee)>0?Ee:"",a.value=Number(De)>0?De:"",m.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,y=>{if(y&&!fe(y)){c.value=y,r.value=c.value.token_a,f.value=c.value.token_b,oe({value:B.value/100});let X=Number(c.value.tick_lower_index),O=Number(c.value.tick_upper_index);const le=Number(c.value.current_tick_index);(y.maxPrice.indexOf("+")>0||y.maxPrice==="∞"?"∞":y.maxPrice)=="∞"||le>=X&&le<=O?(l.value=!1,v.value=!1):le>O?(s.value="",l.value=!0,v.value=!1):le<X?(l.value=!1,v.value=!0,a.value=""):(l.value=!0,s.value="",v.value=!0,a.value=""),R()}},{immediate:!0}),ye(s,(y,X)=>{y&&R(),y==""&&(a.value="",B.value=0)}),ye(a,(y,X)=>{y&&R(),y==""&&(s.value="",B.value=0)});const Y=A(()=>o.value.RATES),ie=A(()=>{var Ce,Te,Ie,Ne;const y=((Te=Y.value[(Ce=r.value)==null?void 0:Ce.address])==null?void 0:Te.price)||0,X=((Ne=Y.value[(Ie=f.value)==null?void 0:Ie.address])==null?void 0:Ne.price)||0,O=new b(y).mul(new b(s.value||0)),le=new b(X).mul(new b(a.value||0)),be=O.add(le);return Q(be.toString(),2)}),Z=L(!1),{t:pe,locale:U}=yo(),he=A(()=>{const y=Number(s.value)>Number(i.value),X=Number(a.value)>Number(g.value);return!s.value&&!a.value?pe("button.enterAmount"):y||X?"Invalid Amount":pe("button.remove")}),_e=A(()=>{const y=Number(s.value)>Number(i.value),X=Number(a.value)>Number(g.value);return!!(!s.value&&!a.value||y||X)}),{setIsShowSuccess:je,setIsShowRejected:Be,setIsShowWaiting:u,setTransactionDesc:k,setTransactionTxid:p,setPositiomNum:j,setTransactionDescText:K}=q,E=L(!1);ye(B,rn((y,X)=>{y!==X&&(Number(y)>100?B.value=100:y&&c.value?(B.value=y,oe({value:B.value/100})):(s.value="",a.value=""))},300)),ye(ee,y=>{y&&c.value&&oe({value:B.value/100})});const D=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],V=Uo(),x=A(()=>V),ce=A(()=>x.value.status),me=L(!1),Pe=y=>{y.sources.forEach(O=>{const{pool_address:le,position_index:be}=JSON.parse(O.blockchainAddress);le==c.value.poolAddress&&Number(be)==Number(c.value.index)&&(me.value=!0)})},P=async()=>{await V.getSources();let y;x.value.allSources.forEach(X=>{const{pool_address:O,position_index:le}=JSON.parse(X.blockchainAddress);O==c.value.poolAddress&&le==c.value.index&&(y=X.id)}),V.deleteSource(y)};ye(()=>[x.value.sourceGroups,c.value],([y,X])=>{y&&y.sources&&y.sources.length>0&&X&&!fe(X)&&Pe(y)},{immediate:!0,deep:!0});const M=ro(),ue=fo();return{theme:T,showFromCoinLock:l,showToCoinLock:v,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:i,toCoinBlance:g,fromCoin:r,toCoin:f,maxBtnSelect:I,halfBtnSelect:C,fixedFromCoin:d,needReverse:N,totalAmount:ie,wallet:ne,addLiquidityBtnText:he,isShowLiquidityModal:Z,indexStore:q,positionInfo:c,actionLoading:E,addLiquidityBtnDisabled:_e,sliderVal:B,ratioArr:D,setPercent:oe,poolStore:m,isSlider:$,toRemove:async()=>{var be,Ce,Te,Ie,Ne,Ee,De,Ge,Re,Ue,Fe,We,Ze;E.value=!0,p("");const y=Q(s.value,r.value.decimals)==0?"":`${ge(s.value,r.value.decimals)} ${r.value.symbol}`,X=Q(a.value,f.value.decimals)==0?"":`${ge(a.value,f.value.decimals)} ${f.value.symbol}`;k(pe("tips.removeLiquidiyText",{from:N.value?X:y,and:Q(s.value,r.value.decimals)==0||Q(a.value,f.value.decimals)==0?"":"and",to:N.value?y:X})),u(!0);const O=c.value.poolInfo.rewarder_infos,le=O&&O.length>0&&w.value=="Sui"||O&&O.length>0&&B.value==100?pe("modal.removeLiquidityText1"):pe("modal.removeLiquidityText2");K(le);try{let Ae={};Ae={pool:{...c.value.poolInfo,coinA:c.value.token_a,coinB:c.value.token_b},coinTypeA:c.value.poolInfo.coinTypeA,coinTypeB:c.value.poolInfo.coinTypeB,position:c.value,delta_liquidity:B.value==100?new Oe(c.value.liquidity):new Oe(Me(F.value,0)),slippage:Number(ee.value),rewards_num:O.length,positionInfo:c.value},Ae.coinTypeC=O[0]?O[0].coinAddress:"",Ae.coinTypeD=O[1]?O[1].coinAddress:"",Ae.coinTypeE=O[2]?O[2].coinAddress:"";const ke=await z.value.getRemoveLiquidityTransactionPayload(Ae);let He;if(w.value==="Aptos")He=await ne.value.currentWallet.signAndSubmitTransaction(ke);else{const so=await z.value.signAndExecuteTransactionBlock(ne.value.currentWallet,ke.txb,ke==null?void 0:ke.payloadParams);He=z.value.handleTx(so),console.log("0331###remove###tx####",He)}if(He&&He.hash){p(He.hash),u(!1),je(!0);const so={title:pe("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${s.value} ${(be=r.value)==null?void 0:be.symbol} and ${a.value} ${(Ce=f.value)==null?void 0:Ce.symbol} 
             from the pool`,sender:ne.value.address,chainName:w.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:N.value?`${(Ie=f.value)==null?void 0:Ie.address}`:`${(Te=r.value)==null?void 0:Te.address}`,numa:N.value?`+ ${a.value}`:`+ ${s.value}`,logoa:N.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:N.value?`${(Ne=r.value)==null?void 0:Ne.address}`:`${(Ee=f.value)==null?void 0:Ee.address}`,numb:N.value?`+ ${s.value}`:`+ ${a.value}`,logob:N.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${s.value} ${(De=r.value)==null?void 0:De.symbol} and ${a.value} ${(Ge=f.value)==null?void 0:Ge.symbol}`};w.value!=="Aptos"&&(so.res=He.res),z.value.showTransitionPending(so);const Ao=await z.value.watchTransaction(so);if(O.value&&O.value.length>0&&(Number((Re=O[0])==null?void 0:Re.amount)!==0||Ae.coinTypeD&&Number((Ue=O[1])==null?void 0:Ue.amount)!==0||Ae.coinTypeE&&Number((Fe=O[2])==null?void 0:Fe.amount)!==0)){const ho={title:pe("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:O[0].symbol,numa:`+ ${Number(O[0].amount)}`,logoa:o.value.tokensObj&&O[0]&&O[0].address&&o.value.tokensObj[O[0].address]&&o.value.tokensObj[O[0].address].logoURI,tokenb:Ae.coinTypeD?O[1].symbol:"",numb:Ae.coinTypeD?`+ ${Number(O[1].amount)}`:"",logob:Ae.coinTypeD?o.value.tokensObj&&O[1]&&O[1].address&&o.value.tokensObj[O[1].address]&&o.value.tokensObj[O[1].address].logoURI:"",tokenc:Ae.coinTypeE?O[2].symbol:"",numc:Ae.coinTypeE?`+ ${Number(O[2].amount)}`:"",logoc:Ae.coinTypeE?o.value.tokensObj&&O[2]&&O[2].address&&o.value.tokensObj[O[2].address]&&o.value.tokensObj[O[2].address].logoURI:""},text:`Withdraw ${s.value} ${(We=r.value)==null?void 0:We.symbol} and ${a.value} ${(Ze=f.value)==null?void 0:Ze.symbol}`},Qo=await z.value.setTransations(ho)}if($e(c.value.feeOwedA,c.value.token_a.decimals)!==0||$e(c.value.feeOwedB,c.value.token_b.decimals)!==0){const ho={title:"Claim",desc:"",hash:He.hash,chainName:w.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${c.value.token_a.symbol}`,numa:Q(c.value.feeOwedA,c.value.token_a.decimals)==0?"":`+ ${$e(c.value.feeOwedA,c.value.token_a.decimals)}`,logoa:Q(c.value.feeOwedA,c.value.token_a.decimals)==0?"":o.value.tokensObj&&c.value&&c.value.token_a.address&&o.value.tokensObj[c.value.token_a.address]&&o.value.tokensObj[c.value.token_a.address].logoURI,tokenb:`${c.value.token_b.symbol}`,numb:Q(c.value.feeOwedB,c.value.token_b.decimals)==0?"":`+ ${$e(c.value.feeOwedB,c.value.token_b.decimals)}`,logob:Q(c.value.feeOwedB,c.value.token_b.decimals)==0?"":o.value.tokensObj&&c.value&&c.value.token_b.address&&o.value.tokensObj[c.value.token_b.address]&&o.value.tokensObj[c.value.token_b.address].logoURI}},Qo=await z.value.setTransations(ho)}Ao&&Number(B.value)==100&&ce.value=="authenticated"&&me.value&&(await V.subscribePosition({pool_address:c.value.poolAddress,position_index:c.value.index},c.value.nftHash,!1),P()),Ao&&(s.value="",a.value="",setTimeout(()=>{t.emit("getDetails")},3e3),setTimeout(()=>{t.emit("getDetails")},6e3),Number(B.value)==100&&ue.name=="new-position-detail"&&(w.value==="Aptos"?M.push("/position"):M.push("/pool/position")),B.value=0)}else u(!1),Be(!0);E.value=!1}catch(Ae){console.log("Remove error",Ae),E.value=!1,u(!1),Be(!0)}},sFixD:Me}}});const xi={class:"new-position-asset"},es={class:"add-or-remove"},os={class:"liquidity-action-tab"},ns=n("div",{class:"remove tab-active"},"Remove",-1),ts={class:"card-item"},is={key:0,class:"assets-card-mask"},ss={class:"card-item"},as={key:0,class:"assets-card-mask"},ls={class:"remove-ratio"},rs=n("div",{class:"remove-ratio-title"},"Amount",-1),us={class:"remove-ratio-select"},ds={key:0,class:"ratio"},cs={key:1,class:"ratio"},ms={class:"ratio-list"},vs=["onClick"];function fs(e,t,s,a,q,h){const T=po,m=un,o=uo;return _(),S("div",xi,[n("div",es,[n("div",os,[n("div",{class:"increase",onClick:t[0]||(t[0]=l=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),ns]),n("div",{class:ko(e.needReverse?"card-container reverse":"card-container")},[n("div",ts,[ae(T,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(_(),S("div",is)):de("",!0)]),n("div",ss,[ae(T,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(_(),S("div",as)):de("",!0)])],2),n("div",ls,[rs,n("div",us,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(_(),S("div",ds,W(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Me))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Me))(e.sliderVal,2))+"% ",1)):(_(),S("div",cs," -- ")),n("div",ms,[(_(!0),S(Ve,null,oo(e.ratioArr,(l,v)=>(_(),S("div",{key:v,class:ko(["ratio-item",e.sliderVal==l.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=l.value}},W(l.name),11,vs))),128))])]),ae(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=l=>e.sliderVal=l)},null,8,["value"])])]),e.wallet.connected?(_(),qe(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(_(),qe(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1}))])}const Go=Qe(Vi,[["render",fs]]),ps=Je({setup(){const e=io(),t=A(()=>e),s=jo(),a=A(()=>s),q=ro(),h=A(()=>t.value.currentPositionInfo),T=L(),m=H=>{var $;return(($=t.value.tokensObj[H])==null?void 0:$.logo_url)||no("/image/coins/sui-unknown.png")},o=tn("Sui"),l=L(),v=async H=>{l.value=0;try{const $=await o.calculateFarmingRewards([{pool_id:H.pool_id,position_nft_id:H.id}]),R=[];let B=new b(0);$[H.id].forEach((F,oe)=>{var Z;const Y=(Z=t.value.tokensObj[F.rewarder_type])==null?void 0:Z.decimals;let ie=new b(F.rewarder_amount).div(Math.pow(10,Y)).toString();Number(ie)>0&&w.value.rewarders[oe]&&(B=B.add(ie),R.push({...F,rewarderAmount:ie,rewarderAmountPer:ie}))}),l.value=B,T.value=R}catch($){console.log($,"getRewarder")}},d=A(()=>a.value.farmsPoolObj),w=A(()=>d.value[h.value.poolAddress]);ye(()=>[h.value,d.value,w.value],([H,$,R])=>{var B;!fe(H)&&H.positionSource=="farming"&&!fe(R)?v(H):!fe($)&&!fe(H)&&(T.value=(B=$[H.poolAddress])==null?void 0:B.rewarders)},{immediate:!0});const z=lo(),se=A(()=>z),ne=Ye(),ee=to("Sui"),{setIsShowSuccess:r,setIsShowRejected:f,setIsShowWaiting:N,setTransactionDesc:i,setTransactionTxid:g}=ne,I=L(!1),C=async()=>{I.value=!0,g(""),i("Claim rewards"),N(!0);const H={pool_id:h.value.pool_id,position_nft_id:h.value.id};try{const $=await o.harvestFarms(H),R=await ee.signAndExecuteTransactionBlock(se.value.currentWallet,$.txb,$.payloadParams);console.log("0221###sui swap res###",R);let B=ee.handleTx(R);if(B&&B.hash){g(B.hash),N(!1),r(!0);let F={title:"Claim",res:B.res,hash:B.hash};ee.showTransitionPending(F),await ee.watchTransaction(F)&&setTimeout(()=>{v(h.value)},2e3)}else N(!1),f(!0);I.value=!1}catch($){console.log("farmsDeposit error",$),N(!1),f(!0),I.value=!1}},c=async()=>{I.value=!0,g(""),i(`Unstake ${h.value.name}`),N(!0);const H=h.value.pool_id,$=h.value.id;try{const R=await o.farmsWithdraw(H,$),B=await ee.signAndExecuteTransactionBlock(se.value.currentWallet,R.txb,R.payloadParams);console.log("0221###sui swap res###",B);let F=ee.handleTx(B);if(F&&F.hash){g(F.hash),N(!1),r(!0);let oe={res:F.res,title:"Unstake",hash:F.hash};ee.showTransitionPending(oe),await ee.watchTransaction(oe)&&setTimeout(()=>{q.replace(`/new-position-detail?token=${h.value.tokenName}&address=${h.value.clmm_pool_id}&pos=${h.value.clmm_position_id}`),t.value.setCurrentPositionInfo(h.value.clmm_pool_id,"",h.value.tokenName,"Sui",h.value.clmm_position_id),l.value=0,I.value=!1},2e3)}else N(!1),f(!0)}catch(R){console.log("farmsDeposit error",R),N(!1),f(!0),I.value=!1}},te=async()=>{I.value=!0,g(""),i(`Stake ${h.value.name}`),N(!0);const H={clmm_pool_id:h.value.poolAddress,clmm_position_id:h.value.pos_object_id,coinTypeA:h.value.coin_type_a,coinTypeB:h.value.coin_type_b},$=d.value[h.value.poolAddress].id;try{const R=await o.farmsDeposit(H,$),B=await ee.signAndExecuteTransactionBlock(se.value.currentWallet,R.txb,R.payloadParams);console.log("0221###sui swap res###",B);let F=ee.handleTx(B);if(F&&F.hash){g(F.hash),N(!1),r(!0);let oe={res:F.res,title:"Staked",hash:F.hash};ee.showTransitionPending(oe);const Y=await ee.watchTransaction(oe,!0);let ie;Y!=null&&Y.status&&setTimeout(async()=>{var Z,pe;(pe=(Z=Y==null?void 0:Y.res)==null?void 0:Z.events)==null||pe.forEach(U=>{U.type.indexOf("::pool::DepositEvent")>-1&&(ie=U.parsedJson.wrapped_position_id)}),q.replace(`/new-position-detail?position_nft_id=${ie}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",ie,"farming"),I.value=!1},2e3)}else N(!1),f(!0)}catch(R){console.log("farmsDeposit error",R),N(!1),f(!0),I.value=!1}},G=A(()=>ne),re=A(()=>G.value.addressLpTokens);return{getCoinIcon:m,rewardList:T,sFixD:Me,addCommom:Q,claim:C,unStake:c,loading:I,totalRewardAmount:l,currentPositionInfo:h,stake:te,farmsPoolObj:d,addressLpTokens:re,farmsPoolInfo:w}}});const xe=e=>(mo("data-v-c94d24ee"),e=e(),vo(),e),hs={key:0,class:"farms-position-detail"},bs={class:"farms-top"},ks=xe(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),gs={class:"right"},_s={class:"apr"},ws={class:"apr-tips-box"},ys=xe(()=>n("span",null,"View",-1)),As=xe(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Is=[ys,As],Cs={class:"farms-bottom"},$s=xe(()=>n("div",{class:"title"},"Farming Rewards",-1)),Ss={key:0,class:"reward-list"},Ps={key:0,class:"rewards-item-bg"},Ts={class:"rewards-item-box"},Ns={alt:""},Rs={key:1},Os={class:"rewards-item-bg"},qs={class:"rewards-item-box"},Ls={alt:""},Bs=xe(()=>n("span",null,"0",-1)),Ms={key:1,class:"reward-list"},Us={key:0,class:"rewards-item-bg"},js={class:"rewards-item-box"},Es={alt:""},Ds=xe(()=>n("span",null,"0",-1)),Fs={key:1},Ws={class:"rewards-item-bg"},Hs={class:"rewards-item-box"},Xs={alt:""},zs=xe(()=>n("span",null,"0",-1)),Gs={class:"actions-box"};function Ys(e,t,s,a,q,h){const T=kn,m=uo,o=dn,l=wo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(_(),S("div",hs,[n("div",bs,[ks,n("div",gs,[n("div",_s,[ve(" APR  "),n("span",null,[ve(W(("addCommom"in e?e.addCommom:J(Q))(e.farmsPoolInfo.total_apr*100,2))+"%  ",1),n("div",ws,[ae(T,{"l-item":e.farmsPoolInfo,"rewarder-info":e.farmsPoolInfo.rewarder.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=v=>e.$router.push("/farms"))},Is)])]),n("div",Cs,[$s,e.rewardList&&e.rewardList.length>0?(_(),S("div",Ss,[(_(!0),S(Ve,null,oo(e.rewardList,v=>(_(),S("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(_(),S("div",Ps,[n("div",Ts,[Se(n("img",Ns,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),n("span",null,W(("addCommom"in e?e.addCommom:J(Q))(v.rewarderAmount||0)),1)])])):(_(),S("div",Rs,[n("div",Os,[n("div",qs,[Se(n("img",Ls,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),Bs])])]))]))),128))])):(_(),S("div",Ms,[(_(!0),S(Ve,null,oo(e.currentPositionInfo.rewards,v=>(_(),S("div",{key:v,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(_(),S("div",Us,[n("div",js,[Se(n("img",Es,null,512),[[l,e.getCoinIcon(v.rewarder_type)]]),Ds])])):(_(),S("div",Fs,[n("div",Ws,[n("div",Hs,[Se(n("img",Xs,null,512),[[l,e.getCoinIcon(v.reward_coin)]]),zs])])]))]))),128))])),n("div",Gs,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(_(),qe(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[ve("Unstake")]),_:1},8,["loading","onClick"])):de("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(_(),qe(o,{key:1},{title:Le(()=>[ve("Farming rewards are only available for active positions.")]),default:Le(()=>[ae(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[ve("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(_(),qe(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[ve("Stake")]),_:1},8,["loading","onClick"])):de("",!0),ae(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Mo(e.claim,["stop"])},{default:Le(()=>[ve("↑ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):de("",!0)}const Yo=Qe(ps,[["render",Ys],["__scopeId","data-v-c94d24ee"]]),Js=Je({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=Uo(),s=A(()=>t),a=A(()=>s.value.status),q=Ye(),h=L(!1);ye(()=>a.value,l=>{l=="authenticated",h.value=!1},{immediate:!0});const T=L(!1),m=async()=>{T.value=!T.value;const l={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},v=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(l,v,T.value)}catch{T.value=!T.value}},o=l=>{const v=l.sources;console.log("🚀🚀🚀 ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",v),T.value=v.some(d=>JSON.parse(d.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(d.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return ro(),ye(()=>[s.value.sourceGroups,e.positionInfo],([l,v])=>{T.value=!1,l&&l.length>0&&l[0]&&v&&!fe(v)&&(console.log("🚀🚀🚀 ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),o(l[0]))},{immediate:!0,deep:!0}),{importIcon:no,isShowSetUp:h,changeSwitch:m,checked:T,notifiStatus:a,store:q}}});const Qs=e=>(mo("data-v-1a37a36d"),e=e(),vo(),e),Zs={class:"range-alerts"},Ks={class:"range-alerts-top"},Vs={class:"title"},xs=Qs(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ea={key:1,class:"h5-switch-box"},oa={class:"range-alerts-bottom"},na={key:0,class:"pc-switch-box"};function ta(e,t,s,a,q,h){const T=uo,m=cn;return _(),S("div",Zs,[n("div",Ks,[n("div",Vs,[xs,e.isShowSetUp||e.notifiStatus!=="authenticated"?(_(),qe(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Mo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[ve(" Set up ")]),_:1})):de("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(_(),S("div",ea,[ae(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])]),n("div",oa,[ve(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(_(),S("div",na,[ae(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):de("",!0)])])}const Jo=Qe(Js,[["render",ta],["__scopeId","data-v-1a37a36d"]]),ia=Je({components:{NewPositionTitle:No,NewPositionInfo:Ho,NewPositionLiquidity:Xo,NewPositionAssetAdd:zo,NewPositionAssetRemove:Go,NewPositionNotifi:Jo,FarmsPositionDetail:Yo},setup(){const e=L(),t=L(),s=L(),a=Ye(),q=A(()=>a),h=A(()=>q.value.chainName),T=io(),m=A(()=>T),o=jo(),l=ro();Lo(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const v=async()=>{m.value.setCurrentPositionLoading(!0);const r=l.currentRoute.value.query.token||"",f=l.currentRoute.value.query.collect||"",N=l.currentRoute.value.query.address||"",i=l.currentRoute.value.query.pos||"",g=l.currentRoute.value.query.id||"",I=l.currentRoute.value.query.positionSource||"",C=l.currentRoute.value.query.position_nft_id||"";h.value==="Aptos"?r&&f&&N&&m.value.setCurrentPositionInfo(N,f,r,h.value):r&&N&&i?m.value.setCurrentPositionInfo(N,f,r,h.value,i):g&&!I?m.value.setCurrentPositionInfo("","","",h.value,g):m.value.setCurrentPositionInfo("","","",h.value,C,I)};ye(()=>m.value.poolConfigObj,r=>{r&&!fe(r)&&v()},{immediate:!0});const d=A(()=>m.value.currentPositionLoading),w=A(()=>{var f,N,i;const r=((i=(N=(f=l==null?void 0:l.currentRoute)==null?void 0:f.value)==null?void 0:N.query)==null?void 0:i.address)||"";return r&&m.value.addressLpTokens&&!fe(m.value.addressLpTokens)&&m.value.addressLpTokens[r]?m.value.addressLpTokens[r]:null});ye(()=>w.value,(r,f)=>{r&&!fe(r)&&(e.value=r),r&&!fe(r)&&r.current_sqrt_price!==(f==null?void 0:f.current_sqrt_price)&&v()},{immediate:!0});const z=fo();ye(()=>[m.value.currentPositionInfo,h.value],([r,f])=>{var N;(f=="Aptos"&&r||f=="Sui"&&r&&(r==null?void 0:r.nftHash)==((N=z==null?void 0:z.query)==null?void 0:N.pos))&&(e.value=r,t.value=e.value.token_a,s.value=e.value.token_b)},{immediate:!0});const se=A(()=>m.value.positionDetailCurrentTab),ne=lo();A(()=>ne),A(()=>q.value.theme);const ee=()=>{v()};return mn(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:s,getDetails:v,currentPositionLoading:d,positionDetailCurrentTab:se,clickRefresh:ee,chainName:h}}});const sa={class:"new-position-detail"},aa={class:"new-position-content"},la={class:"left"},ra={class:"right"},ua={class:"loading-global"};function da(e,t,s,a,q,h){const T=No,m=Ho,o=Xo,l=zo,v=Go,d=Yo,w=Jo,z=vn;return _(),S("div",sa,[ae(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",aa,[n("div",la,[ae(m),ae(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",ra,[e.positionDetailCurrentTab=="increase"?(_(),qe(l,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(_(),qe(v,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ae(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(_(),qe(d,{key:2})):de("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?(_(),qe(w,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):de("",!0)])]),Se(n("div",ua,[ae(z)],512),[[Bo,e.currentPositionLoading]])])}const Da=Qe(ia,[["render",da],["__scopeId","data-v-2fdfeeff"]]);export{Da as default};
