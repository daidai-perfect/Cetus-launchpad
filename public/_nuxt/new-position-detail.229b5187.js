import{_ as Vo}from"./back.64b0f251.js";import{_ as xo}from"./swap-setting.2208d21f.js";import{a as Xe,u as xe,b as eo,j as go,p as Io,c as en}from"./pool.fa6455ae.js";import{a as ze,r as q,m as _,e as Ye,o as k,f as P,h as n,v as F,c as Te,x as ue,p as so,k as ao,C as No,D as ye,b as lo,i as ae,z as vo,y as Ro,t as Pe,G as Oo,E as fo,q as wo,u as J,j as me,w as Le,L as qo,l as yo,a2 as on,a3 as Ge,a4 as nn,a7 as Co,H as $o,F as Ve,s as to,B as co,S as tn,a8 as sn,a9 as an,K as Lo,W as ln,J as rn}from"./entry.dfb1419f.js";import{c as ve,a as un,n as dn,d as ke,b as Z,s as Ue,u as mo,j as Se,e as qe,x as Bo,y as Mo,T as So,C as cn}from"./index.c6fdb803.js";import{_ as po}from"./token-warning.d115c5c9.js";import{_ as Uo}from"./status-block.fa6c76ae.js";import{s as uo,m as mn,l as vn,b as fn,a as pn}from"./transform.c672907f.js";import{D as g}from"./decimal.0bdeb344.js";/* empty css              */import{i as io}from"./import-icon.de3e6c66.js";import"./index.54d3fe8f.js";import{_ as ho}from"./assets-card.df597879.js";import{_ as hn}from"./coin-lock.5b94efd8.js";import{a as bn}from"./new-add-or-create.420d337d.js";import{_ as gn,a as kn}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              */import{u as jo}from"./notifi.afd02a5d.js";import{_ as _n}from"./apr-tips.decdf256.js";import{u as Eo}from"./farms.066e7921.js";/* empty css              *//* empty css              *//* empty css              */import"./icon-error_2x.ffca2391.js";import"./useDebounceFunction.f0cfbae1.js";import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.ee89973b.js";import"./useWhale.362e400b.js";import"./icon_fee_2x.118f071f.js";import"./icon_rewards_2x.03c46b30.js";const ko=Math.PI,_o=2*ko,Ke=1e-6,wn=_o-Ke;function Do(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function yn(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Do;const i=10**t;return function(s){this._+=s[0];for(let T=1,p=s.length;T<p;++T)this._+=Math.round(arguments[T]*i)/i+s[T]}}class An{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Do:yn(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,s,T){this._append`Q${+t},${+i},${this._x1=+s},${this._y1=+T}`}bezierCurveTo(t,i,s,T,p,N){this._append`C${+t},${+i},${+s},${+T},${this._x1=+p},${this._y1=+N}`}arcTo(t,i,s,T,p){if(t=+t,i=+i,s=+s,T=+T,p=+p,p<0)throw new Error(`negative radius: ${p}`);let N=this._x1,m=this._y1,o=s-t,l=T-i,b=N-t,u=m-i,h=b*b+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(h>Ke)if(!(Math.abs(u*o-l*b)>Ke)||!p)this._append`L${this._x1=t},${this._y1=i}`;else{let H=s-N,se=T-m,oe=o*o+l*l,G=H*H+se*se,f=Math.sqrt(oe),y=Math.sqrt(h),w=p*Math.tan((ko-Math.acos((oe+h-G)/(2*f*y)))/2),r=w/y,$=w/f;Math.abs(r-1)>Ke&&this._append`L${t+r*b},${i+r*u}`,this._append`A${p},${p},0,0,${+(u*H>b*se)},${this._x1=t+$*o},${this._y1=i+$*l}`}}arc(t,i,s,T,p,N){if(t=+t,i=+i,s=+s,N=!!N,s<0)throw new Error(`negative radius: ${s}`);let m=s*Math.cos(T),o=s*Math.sin(T),l=t+m,b=i+o,u=1^N,h=N?T-p:p-T;this._x1===null?this._append`M${l},${b}`:(Math.abs(this._x1-l)>Ke||Math.abs(this._y1-b)>Ke)&&this._append`L${l},${b}`,s&&(h<0&&(h=h%_o+_o),h>wn?this._append`A${s},${s},0,1,${u},${t-m},${i-o}A${s},${s},0,1,${u},${this._x1=l},${this._y1=b}`:h>Ke&&this._append`A${s},${s},0,${+(h>=ko)},${u},${this._x1=t+s*Math.cos(p)},${this._y1=i+s*Math.sin(p)}`)}rect(t,i,s,T){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${s=+s}v${+T}h${-s}Z`}toString(){return this._}}function no(e){return function(){return e}}function In(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);t=s}return e},()=>new An(t)}function Cn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fo(e){this._context=e}Fo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $n(e){return new Fo(e)}function Sn(e){return e[0]}function Pn(e){return e[1]}function Tn(e,t){var i=no(!0),s=null,T=$n,p=null,N=In(m);e=typeof e=="function"?e:e===void 0?Sn:no(e),t=typeof t=="function"?t:t===void 0?Pn:no(t);function m(o){var l,b=(o=Cn(o)).length,u,h=!1,H;for(s==null&&(p=T(H=N())),l=0;l<=b;++l)!(l<b&&i(u=o[l],l,o))===h&&((h=!h)?p.lineStart():p.lineEnd()),h&&p.point(+e(u,l,o),+t(u,l,o));if(H)return p=null,H+""||null}return m.x=function(o){return arguments.length?(e=typeof o=="function"?o:no(+o),m):e},m.y=function(o){return arguments.length?(t=typeof o=="function"?o:no(+o),m):t},m.defined=function(o){return arguments.length?(i=typeof o=="function"?o:no(!!o),m):i},m.curve=function(o){return arguments.length?(T=o,s!=null&&(p=T(s)),m):T},m.context=function(o){return arguments.length?(o==null?s=p=null:p=T(s=o),m):s},m}function Po(){}function Wo(e){this._context=e}Wo.prototype={areaStart:Po,areaEnd:Po,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Nn(e){return new Wo(e)}const Rn=ze({setup(){const e=Xe(),t=q(!1),i=_(()=>e);return{slippage:_(()=>i.value.slippage),isShowSwapSetting:t}}});const On=e=>(so("data-v-82585f8b"),e=e(),ao(),e),qn=On(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Ln(e,t,i,s,T,p){const N=xo;return k(),P("div",{class:"slippage-icon",onClick:t[1]||(t[1]=m=>e.isShowSwapSetting=!0)},[qn,n("span",null,F(e.slippage)+"%",1),e.isShowSwapSetting?(k(),Te(N,{key:0,onOnClose:t[0]||(t[0]=m=>e.isShowSwapSetting=!1)})):ue("",!0)])}const Bn=Ye(Rn,[["render",Ln],["__scopeId","data-v-82585f8b"]]),Mn=ze({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const i=q(!1),s=q(null),T=q(0),p=q(20),N=xe(),m=Xe(),o=q(!1);No(()=>{clearInterval(s.value)});const l=()=>{s.value=setInterval(()=>{var G;o.value||T.value<p.value&&(T.value+=1,T.value===p.value&&((G=e==null?void 0:e.poolInfo)!=null&&G.poolAddress&&N.updateCurrentPools(e.poolInfo.poolAddress,m.chainName),T.value=0))},1e3)},b=_(()=>m.slippage),u=()=>{t.emit("clearAll")},h=q(!1),H=()=>{T.value=0,h.value=!0,t.emit("clickRefresh"),setTimeout(()=>{h.value=!1},1e3)};ye(()=>e.poolInfo,G=>{G&&!s.value&&l()},{immediate:!0});const se=lo(),oe=_(()=>m.chainName);return{clickRefresh:H,isShowSwapSetting:i,countdown:T,autoRefreshTime:p,slippage:b,clearAll:u,checkNullObj:ve,router:se,loading:o,chainName:oe,refresh:h}}});const Un=e=>(so("data-v-ca768f9b"),e=e(),ao(),e),jn={class:"new-position-title"},En={class:"left"},Dn={class:"right"},Fn=Un(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Wn=[Fn];function Hn(e,t,i,s,T,p){const N=Vo,m=Bn;return k(),P("div",jn,[n("div",En,[ae(N)]),n("div",Dn,[ae(m),(k(),P("svg",{"aria-hidden":"true",class:vo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:t[0]||(t[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Wn,2))])])}const Ho=Ye(Mn,[["render",Hn],["__scopeId","data-v-ca768f9b"]]);function To(e,t,i){const s=new g(10).pow(t-i);return new g(1.0001).pow(e).mul(s)}const Xn=ze({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const i=q(1),s=q(""),T=q(""),p=_(()=>{var r,$,v;return u.sqrtPriceX64ToPrice((r=e.poolInfo)==null?void 0:r.current_sqrt_price,($=e.poolInfo)==null?void 0:$.coinA.decimals,(v=e.poolInfo)==null?void 0:v.coinB.decimals).toString()}),N=_(()=>{let r=0;return e.direction?r=(Number(e.minPrice)/Number(p.value)-1)*100:r=(Number(e.minPrice)/Number(1/Number(p.value))-1)*100,r=r>0&&r<.1?.1:r,r=r<0&&r>-.1?-.1:r,r}),m=_(()=>{let r=0;return e.direction?r=(Number(e.maxPrice)/Number(p.value)-1)*100:r=(Number(e.maxPrice)/Number(1/Number(p.value))-1)*100,r=r>0&&r<.1?.1:r,r=r<0&&r>-.1?-.1:r,r}),o=Xe(),l=_(()=>o),b=_(()=>l.value.chainName?eo(l.value.chainName):{}),{TickMath:u,getNearestTickByTick:h}=b.value,H=()=>{const r=i.value/2;i.value=r,G(e.poolInfo,r)},se=()=>{const r=i.value*2;i.value=r,G(e.poolInfo,r)},oe=(r=[])=>{let $=6;const v=Math.abs(Number(r[0])-Number(r[r.length-1]));return v>=6?$=0:v>=1?$=1:v>=.1?$=2:v>=.01?$=3:v>=.001?$=4:v>=1e-4?$=5:v>=1e-5?$=6:v>=1e-6?$=7:v>=1e-7&&($=8),$},G=(r,$=1)=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:189 ~ dataProcessing ~ zooms:",$),r&&r.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const v=Number(e.poolInfo.current_tick_index);let A=v+100*$,a=v-100*$,ie,V;if(e.maxPrice==="âˆž")V=b.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?V=u.priceToTickIndex(new g(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):V=u.priceToTickIndex(new g(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{V=443636}if(e.minPrice==="0")ie=b.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ie=u.priceToTickIndex(new g(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ie=u.priceToTickIndex(new g(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ie=-443636}let ne=0;if(e.currentPriceTab!=="full range"){if(v>=ie&&v<=V){const M=v-ie,ge=V-v;ne=Math.max(Math.abs(M),Math.abs(ge))}else v<ie?ne=Math.abs(V-v):ne=Math.abs(v-ie);A=v+ne+20*$,a=v-ne-20*$}else{const M=(Math.abs(v)>5e3,2e4);A=v+M*$,a=v-M*$}a<-443636&&(a=-443636),A>443636&&(A=443636);const X=new g(r.liquidity).div(Math.pow(10,8)).toString(),S=e.tickList,B=[],R=[];let z={};for(let M=0;M<S.length;M++){if(z=S[M],z.index<=v&&z.index>=a){if(B.length<1&&M!==0){const ge=S[M-1];B.unshift({...ge,index:a})}B.unshift(z)}else if(z.index>v&&z.index<=A&&(R.push(z),B.length<1&&M!==0)){const ge=S[M-1];B.push({...ge,index:a})}if(z.index>A){const ge=S[M];if(R.push({...ge,index:A}),B.length<1&&M!==0){const we=S[M-1];B.push({...we,index:a})}break}}let x="0";for(let M=B.length-1;M>=0;M--)x=new g(x).plus(new g(B[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),B[M].liquityAmount=x;let Q=X;for(let M=0;M<R.length;M++)Q=new g(Q).plus(new g(R[M].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[M].liquityAmount=Q;let te=[];const K=S&&S.length>0?{index:v,liquityAmount:Number(X)}:{index:v,liquityAmount:0};(B.length>0||R.length>0)&&(te=[...B.reverse(),K,...R],e.direction||(te=te.reverse()));const be=[];S.forEach(M=>{be.push({...M,liquidityGross:M.liquidityGross.toString(),liquidityNet:M.liquidityNet.toString()})}),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:384 ~ dataProcessing ~ tickMin, tickMax, minPriceTick, maxPriceTick:",a,A,ie,V,v),y(te,a,A,ie,V,v)}};let f=q(!0);Ro(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,G(e.poolInfo,i.value)}});const y=(r,$,v,A,a,ie)=>{let V,ne;e.direction?(V=e.before7dContractPriceLowest?u.priceToTickIndex(new g(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ne=e.before7dContractPriceHighest?u.priceToTickIndex(new g(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(V=e.before7dContractPriceLowest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",ne=e.before7dContractPriceHighest?u.priceToTickIndex(new g(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const X={top:30,right:35,bottom:20,left:55};let S,B;f.value,S=340-X.left-X.right,B=205-X.top-X.bottom;const R=v-$,z=parseInt(String(R/4));let x=[$+z/4,$+z,$+2*z,v-z,v-z/4];const Q=$,te=v,K=S/(te-Q);e.currentPriceTab==="full range"&&(x=[$,$+2*z,v]);const be=x.map(L=>e.direction?To(L,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new g(1).div(To(L,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());oe(be),uo("#chart").selectAll("*").remove();const M=uo("#chart").attr("width",S+X.left+X.right).attr("height",B+X.top+X.bottom).append("g").attr("transform",`translate(${X.left},${X.right})`),ge=mn(r,function(L){return Number(Math.abs(L.liquityAmount))})||0,we=vn().range([0,B]).domain([ge,0]);fn().rangeRound([0,S]).padding(.1);const Me=M.append("g").attr("id","barsBox").selectAll("rect").data(r).enter().append("rect");l.value.theme=="default"?Me.attr("x",function(L,j){return j===0?0:e.direction?Math.abs(L.index-Q)*K:Math.abs(te-L.index)*K}).attr("y",function(L,j){return e.direction?j===r.length-1?0:we(L.liquityAmount):j===r.length-1?0:we(r[j+1].liquityAmount)}).attr("width",function(L,j){return j===0&&r.length===1&&L.liquityAmount>0?S:(e.direction,j!==r.length-1?Math.abs(r[j+1].index-L.index)*K:0)}).attr("height",function(L,j){return j===0&&r.length===1&&L.liquityAmount>0?B:e.direction?j===r.length-1?0:B-we(L.liquityAmount):j===r.length-1?0:B-we(r[j+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Me.attr("x",function(L,j){return j===0?0:e.direction?Math.abs(L.index-Q)*K:Math.abs(te-L.index)*K}).attr("y",function(L,j){return e.direction?j===r.length-1?0:we(Math.abs(L.liquityAmount)):j===r.length-1?0:we(Math.abs(r[j+1].liquityAmount))}).attr("width",function(L,j){return j===0&&r.length===1&&L.liquityAmount>0?S:(e.direction,j!==r.length-1?Math.abs(r[j+1].index-L.index)*K:0)}).attr("height",function(L,j){if(j===0&&r.length===1&&L.liquityAmount>0)return B;if(e.direction)return j===r.length-1?0:Number(L.liquityAmount)?B-we(Math.abs(L.liquityAmount)):0;{if(j===r.length-1)return 0;const ce=B-we(Math.abs(r[j+1].liquityAmount));return Number(r[j+1].liquityAmount)?ce:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const Ce=M.append("g");Ce.append("line").attr("x1",0).attr("y1",155).attr("x2",S).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),Ce.append("g");let d=0;e.direction?d=Math.abs(ie-Q)*K:d=Math.abs(ie-te)*K,(l.value.theme=="default"?M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+d+", 0)"),uo("#triangle").attr("width",8).attr("height",4);let I=[[0,0],[4,4],[8,0]],U=Tn().x(function(L){return L[0]}).y(function(L){return L[1]}).curve(Nn);const E=d-4;M.append("path").attr("d",U(I)).style("fill",l.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+E+", 0)");let D,Y,ee,le;e.direction?(D=A<Q?-100:parseInt(String(Math.abs(A-Q)*K)),Y=a<Q?-100:parseInt(String(Math.abs(a-Q)*K)),ee=V<Q?-100:Math.abs(V-Q)*K,le=ne<Q?-100:Math.abs(ne-Q)*K):(Y=A<Q?-100:Math.abs(te-A)*K,D=a<Q?-100:Math.abs(te-a)*K,le=V<Q?-100:Math.abs(te-V)*K,ee=ne<Q?-100:Math.abs(te-ne)*K),e.minPrice==="0"&&(D=0),e.maxPrice==="âˆž"&&(Y=S),f.value?s.value=S-D+60+"px":s.value=S-D+52+"px",T.value=Y+74+"px",V&&ee<S&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ee+", 0)"),ne&&le<S&&M.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+le+", 0)");const fe=pn().extent([[0,0],[S,B]]).handleSize(30).on("end",_e);M.append("g").attr("class","brush").call(fe).call(fe.move,[D,Y]);function _e(L){if(!L.sourceEvent||!L.selection)return;f.value?s.value=S-L.selection[0]+60+"px":s.value=S-L.selection[0]+52+"px",T.value=L.selection[1]+74+"px";let j,ce,pe=0,C=0;e.direction?(pe=h(parseInt(String(L.selection[0]/K+Q)),Number(e.poolInfo.tickSpacing)),j=u.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),C=h(parseInt(String(L.selection[1]/K+Q)),Number(e.poolInfo.tickSpacing)),ce=u.tickIndexToPrice(C,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(C=h(te-L.selection[0]/K,Number(e.poolInfo.tickSpacing)),j=1/u.tickIndexToPrice(C,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),pe=h(te-L.selection[1]/K,Number(e.poolInfo.tickSpacing)),ce=1/u.tickIndexToPrice(pe,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(ke(String(j),6))),t.emit("onChangeMaxPrice",String(ke(String(ce),6)))}l.value.theme=="default"?uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):uo(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};q(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([r,$,v,A,a])=>{r&&$&&v&&A&&a&&a.length>0&&G(r,i.value)},{immediate:!0});const w=q(!0);return ye(()=>e.chartLoading,(r,$)=>{r!==$&&(w.value=r)},{immediate:!0,deep:!0}),{store:l,loading:w,zoomOut:H,zoomIn:se,rangeSizeLower:N,rangeSizeUpper:m,rangeSizeLowerPosition:s,rangeSizeUpperPosition:T,decimalFormat:un,numberformat:dn}}});const zn=e=>(so("data-v-992b1bf2"),e=e(),ao(),e),Yn={class:"chart-box"},Gn={class:"chart"},Jn=zn(()=>n("svg",{id:"chart"},null,-1)),Qn=[Jn];function Zn(e,t,i,s,T,p){return k(),P("div",Yn,[Pe(n("div",Gn,Qn,512),[[Oo,!e.loading]])])}const Xo=Ye(Xn,[["render",Zn],["__scopeId","data-v-992b1bf2"]]),Kn=ze({components:{StatusBlock:Uo,NewPositionChart:Xo,TokenWarning:po},setup(e){const t=q(),i=q(),s=_(()=>{var v,A;return(A=(v=u.value)==null?void 0:v.poolInfo)==null?void 0:A.needReverse}),T=Xe(),p=_(()=>T),N=_(()=>p.value.currentExplorer),m=_(()=>p.value.theme),o=_(()=>p.value.chainName),l=xe(),b=_(()=>l),u=q({}),h=fo();ye(()=>[b.value.currentPositionInfo,o.value],([v,A])=>{var a;(A=="Aptos"&&v||A=="Sui"&&v&&(v==null?void 0:v.nftHash)==((a=h==null?void 0:h.query)==null?void 0:a.pos))&&(u.value=v,t.value=u.value.token_a,i.value=u.value.token_b)},{immediate:!0});const H=v=>{var A;return(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||((A=b.value.tokensObj[v==null?void 0:v.address])==null?void 0:A.logo_url)||(m.value==="default"?io("/image/coins/unknown.png"):io("/image/coins/sui-unknown.png"))},se=_(()=>o.value?eo(o.value):{}),oe=q([]),G=async v=>{const{list:A}=await se.value.getTicks(v),a=A?se.value.getTickDataFromUrlData(A):[];oe.value=a};ye(()=>[u.value,b.value.poolsObj],([v,A])=>{v&&!ve(v)&&v.poolInfo&&A&&!ve(A)&&G(A[v.poolAddress])},{immediate:!0});const f=q(!0),y=(v,A)=>v!=="0"&&A!=="âˆž"?Ue(1/(1-Number((v/A)**.25)),2)+"x":"1x",w=_(()=>u.value.minPrice&&u.value.maxPrice?y(u.value.minPrice,u.value.maxPrice):"--"),r=_(()=>u.value.maxPrice!=="âˆž"?new g(1).div(new g(u.value.maxPrice)).toString():"âˆž"),$=_(()=>u.value.minPrice>0?new g(1).div(new g(u.value.minPrice)).toString():"0");return{needReverse:s,getCoinIcon:H,theme:m,indexStore:T,direct:f,addCommom:Z,decimalUi:ke,tickList:oe,positionInfo:u,fromCoin:t,toCoin:i,getExplorerUrl:go,lever:w,currentExplorer:N,minPriceResever:r,maxPriceResever:$}}}),Vn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),xn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),et=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),ot=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Je=e=>(so("data-v-e3d7556c"),e=e(),ao(),e),nt={class:"new-position-info"},tt={class:"pool-info"},it={class:"left"},st={class:"coin-a"},at={alt:""},lt={class:"coin-b"},rt={alt:""},ut={class:"position-name"},dt=["href"],ct=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),mt=[ct],vt={key:0,class:"pool-fee"},ft=Je(()=>n("span",null,"Fee tier",-1)),pt={class:"right"},ht={class:"h5-pool-info"},bt={class:"coin-info"},gt={class:"coin-a"},kt={alt:""},_t={class:"coin-b"},wt={alt:""},yt={class:"position-name"},At=["href"],It=Je(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),Ct=[It],$t={key:0,class:"pool-fee"},St={class:"price-info"},Pt={class:"price-and-chart"},Tt={class:"left"},Nt={class:"current-price"},Rt=Je(()=>n("span",null,"Current Price",-1)),Ot={class:"coin-rate"},qt=Je(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Lt=Je(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Bt=[qt,Lt],Mt={key:0},Ut={key:1},jt={key:0,class:"position-range"},Et=Je(()=>n("div",{class:"position-range-title"},"Position Range",-1)),Dt={key:0},Ft={key:1},Wt={key:2,src:Vn,alt:""},Ht={key:3,src:xn,alt:""},Xt={key:4},zt={key:5},Yt={key:1,class:"position-range position-range-warp"},Gt={key:0,class:"position-range-title"},Jt={key:1,class:"position-range-title"},Qt={key:2},Zt={key:3},Kt={class:"price-img"},Vt={key:0,src:et,alt:""},xt={key:1,src:ot,alt:""},ei={key:4},oi={key:5},ni={class:"lever"},ti={class:"lever-title"},ii=Je(()=>n("div",null,[n("span",null," Leverage "),n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),si={class:"lever-text"},ai={class:"right"},li=Je(()=>n("div",{class:"chat-mask"},null,-1));function ri(e,t,i,s,T,p){var u,h,H,se,oe,G,f,y,w,r,$,v,A,a,ie,V,ne,X,S,B,R,z,x,Q,te,K,be,M,ge,we;const N=po,m=Uo,o=qo,l=Xo,b=wo("image");return k(),P("div",nt,[n("div",tt,[n("div",it,[n("div",st,[Pe(n("img",at,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(N,{address:e.needReverse?(se=(H=e.positionInfo)==null?void 0:H.token_b)==null?void 0:se.address:(h=(u=e.positionInfo)==null?void 0:u.token_a)==null?void 0:h.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",lt,[Pe(n("img",rt,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(N,{address:e.needReverse?(y=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:y.address:(G=(oe=e.positionInfo)==null?void 0:oe.token_b)==null?void 0:G.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",ut,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(go))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((r=(w=e.positionInfo)==null?void 0:w.name)==null?void 0:r.split("|")[1]),9,dt)]),(k(),P("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.clmm_position_id))},mt)),e.positionInfo.fee?(k(),P("div",vt,[ft,me(" "+F(e.positionInfo.fee*100)+"% ",1)])):ue("",!0)]),n("div",pt,[ae(m,{"current-status":($=e.positionInfo)==null?void 0:$.currentStatus},null,8,["current-status"])])]),n("div",ht,[n("div",null,[n("div",bt,[n("div",gt,[Pe(n("img",kt,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),ae(N,{address:e.needReverse?(ie=(a=e.positionInfo)==null?void 0:a.token_b)==null?void 0:ie.address:(A=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:A.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",_t,[Pe(n("img",wt,null,512),[[b,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),ae(N,{address:e.needReverse?(S=(X=e.positionInfo)==null?void 0:X.token_a)==null?void 0:S.address:(ne=(V=e.positionInfo)==null?void 0:V.token_b)==null?void 0:ne.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",yt,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(go))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},F((R=(B=e.positionInfo)==null?void 0:B.name)==null?void 0:R.split("|")[1]),9,At),(k(),P("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=Be=>e.indexStore.copy(e.positionInfo.nftHash))},Ct))]),e.positionInfo.fee?(k(),P("div",$t,F(e.positionInfo.fee*100)+"% ",1)):ue("",!0)])]),ae(m,{"current-status":(z=e.positionInfo)==null?void 0:z.currentStatus},null,8,["current-status"])]),n("div",St,[n("div",Pt,[n("div",Tt,[n("div",Nt,[n("div",null,[Rt,n("div",Ot,[n("div",{onClick:t[2]||(t[2]=Be=>e.direct=!e.direct)},Bt)])]),(e.needReverse?!e.direct:e.direct)?(k(),P("div",Mt,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,F((x=e.toCoin)==null?void 0:x.symbol)+" per "+F((Q=e.fromCoin)==null?void 0:Q.symbol),1)])):(k(),P("div",Ut,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,F((te=e.fromCoin)==null?void 0:te.symbol)+" per "+F((K=e.toCoin)==null?void 0:K.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(k(),P("div",jt,[Et,n("div",null,[(e.needReverse?!e.direct:e.direct)?(k(),P("div",Dt,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(k(),P("div",Ft,[me(F(((be=e.positionInfo)==null?void 0:be.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(k(),P("img",Wt)):(k(),P("img",Ht)),(e.needReverse?!e.direct:e.direct)?(k(),P("div",Xt,[me(F(((M=e.positionInfo)==null?void 0:M.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(k(),P("div",zt,[me(F(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(k(),P("div",Yt,[(e.needReverse?!e.direct:e.direct)?(k(),P("span",Gt," Position Range ")):(k(),P("span",Jt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(k(),P("div",Qt,[me(F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(k(),P("div",Zt,[me(F(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPriceResever,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Kt,[e.theme=="default"?(k(),P("img",Vt)):(k(),P("img",xt))]),(e.needReverse?!e.direct:e.direct)?(k(),P("div",ei,[me(F(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(k(),P("div",oi,[me(F(((we=e.positionInfo)==null?void 0:we.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.positionInfo.minPriceResever,6)):0)+" ",1),n("span",null,F(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),me(" Â  ")]))])),n("div",ni,[n("div",ti,[ae(o,{"overlay-class-name":"lever-tooltip"},{title:Le(()=>[me("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Le(()=>[ii]),_:1})]),n("div",si,F(e.lever),1)])]),n("div",ai,[ae(l,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse?e.minPriceResever:e.positionInfo.minPrice,"max-price":e.needReverse?e.maxPriceResever:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),li])])])])}const zo=Ye(Kn,[["render",ri],["__scopeId","data-v-e3d7556c"]]),ui=ze({components:{TokenWarning:po},setup(e,t){const{t:i}=yo(),{$notify:s}=on(),T=Xe(),p=_(()=>T),N=xe(),m=_(()=>N),o=q({}),l=q({}),b=q({}),u=_(()=>p.value.chainName),h=_(()=>u.value?eo(u.value):{}),H=fo(),se=q(!1),oe=async(d=null)=>{var U,E;const c=d||o.value,I=m.value.addressLpTokens[c.poolAddress];if(I){const D=await h.value.getTickDataByIndex(I.ticks_handle||((U=c==null?void 0:c.poolInfo)==null?void 0:U.ticks_handle),Number(c.tick_lower_index)),Y=await h.value.getTickDataByIndex(I.ticks_handle||((E=c==null?void 0:c.poolInfo)==null?void 0:E.ticks_handle),Number(c.tick_upper_index));let ee={};u.value==="Aptos"?ee=await h.value.getPosRewardersAmount({poolAddress:A.currentRoute.value.query.address,positionName:A.currentRoute.value.query.token,tickLowerData:D,tickUpperData:Y}):ee=await h.value.fetchPosRewardersAmount({poolAddress:c.poolAddress,positionId:c.pos_object_id||c.clmm_position_id,coinTypeA:c.coin_type_a||c.coinTypeA,coinTypeB:c.coin_type_b||c.coinTypeB,rewarderInfo:c.poolInfo.rewarder_infos});const le=[];let fe=new g(0);ee.forEach((_e,L)=>{var C,W;const j=(C=m.value.tokensObj[_e.coin_address])==null?void 0:C.decimals,ce=_e.amount_owed.toString();let pe=new g(ce).div(Math.pow(10,j)).toString();if(u.value=="Aptos"&&Number(pe)>999999999&&(pe="0"),c.poolInfo[`rewarder_display${L+1}`]||Number(pe)>0){const O=m.value.tokensObj[_e.coin_address],re=((W=m.value.RATES[_e.coin_address])==null?void 0:W.price)||0,de=new g(pe).mul(re).toString();fe=new g(fe).plus(de),le.push({..._e,...O,amount:Number(pe)>0?pe:0,amountUSD:Number(de)>0?Se(de,2):0,amountUSDText:de})}}),a.value=le}};ye(()=>[m.value.currentPositionInfo,u.value],([d,c])=>{var I;c=="Aptos"&&d?(o.value=d,l.value=d==null?void 0:d.token_a,b.value=d==null?void 0:d.token_b):c=="Sui"&&d&&(d==null?void 0:d.nftHash)==((I=H==null?void 0:H.query)==null?void 0:I.pos)&&(o.value=d,l.value=d==null?void 0:d.token_a,b.value=d==null?void 0:d.token_b,se.value=!1)},{immediate:!0}),ye(()=>[o.value,m.value.addressLpTokens],([d,c])=>{!ve(d)&&!ve(c)&&oe(d)},{immediate:!0});const G=_(()=>{var d,c,I,U,E,D,Y,ee;if(o.value&&!ve(o.value)&&m.value.RATES){const le=o.value.amountA*((c=m.value.RATES[(d=o.value)==null?void 0:d.token_a.address])==null?void 0:c.price),fe=o.value.amountB*((U=m.value.RATES[(I=o.value)==null?void 0:I.token_b.address])==null?void 0:U.price);if((D=m.value.RATES[(E=o.value)==null?void 0:E.token_a.address])!=null&&D.price&&((ee=m.value.RATES[(Y=o.value)==null?void 0:Y.token_b.address])!=null&&ee.price)){const _e=Number(le+fe);return _e>0&&_e<.01?"<0.01":Z(Ue(le+fe,2),2)}else return" --"}else return" --"}),f=_(()=>{var d,c;return(c=(d=o.value)==null?void 0:d.poolInfo)==null?void 0:c.needReverse}),y=_(()=>m.value.RATES),w=_(()=>{var d,c;if(y.value&&l.value&&b.value&&!ve(y.value)&&!ve(l.value)&&!ve(b.value)){const I=[],U=Number(o.value.feeOwedA)||0,E=Number(o.value.feeOwedB)||0,D=new g(U).mul(((d=y.value[l.value.address])==null?void 0:d.price)||0),Y=new g(E).mul(((c=y.value[b.value.address])==null?void 0:c.price)||0);return I.push({amount:U,amountUSD:D.toString()},{amount:E,amountUSD:Y.toString()}),I}return[]}),r=_(()=>{var c,I;let d=new g(0);return(c=w==null?void 0:w.value)==null||c.forEach(U=>{d=d.add(new g(U.amount))}),u.value=="Sui"&&((I=a==null?void 0:a.value)==null||I.forEach(U=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:622 ~ canClaimYield ~ ele:",U),d=d.add(new g(U.amount))})),d.toNumber()}),$=_(()=>{var c,I;let d=new g(0);return(c=w==null?void 0:w.value)==null||c.forEach(U=>{d=d.add(new g(U.amountUSD))}),u.value=="Sui"&&((I=a==null?void 0:a.value)==null||I.forEach(U=>{d=d.add(new g(U.amountUSDText))})),d.toNumber()}),v=_(()=>{var c;let d=new g(0);return(c=a.value)==null||c.forEach(I=>{d=d.add(new g(I.amountUSDText))}),d.toNumber()}),A=lo(),a=q([]),{setIsShowSuccess:ie,setIsShowRejected:V,setIsShowWaiting:ne,setTransactionDesc:X,setTransactionTxid:S}=T,B=mo(),R=_(()=>B),z=async()=>{se.value=!0;let d={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:a.value.length,collect_fee:!0};d.coinTypeC=a.value[0]?a.value[0].coin_address:"",d.coinTypeD=a.value[1]?a.value[1].coin_address:"",d.coinTypeE=a.value[2]?a.value[2].coin_address:"",ne(!0),X();try{let c;if(u.value==="Aptos"){const I=await h.value.getCollectRewarderTransactionPayload(d);c=await R.value.currentWallet.signAndSubmitTransaction(I)}else{d.pos_index=o.value.pos_object_id;const I=await h.value.getCollectRewarderTransactionPayload(d,o.value),U=await h.value.signAndExecuteTransactionBlock(R.value.currentWallet,I.txb,I.payloadParams);c=h.value.handleTx(U)}if(c&&c.hash){S(c.hash),ne(!1),ie(!0);const I={title:"Claim",desc:"",hash:c.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};u.value!=="Aptos"&&(I.res=c.res),h.value.showTransitionPending(I),await h.value.watchTransaction(I)&&(t.emit("getDetails"),setTimeout(()=>{h.value.getAccount(R.value.address)},3e3))}else console.log("0310###toClaimRewards###else###"),ne(!1),V(!0),se.value=!1}catch(c){ne(!1),V(!0),se.value=!1,console.log(c,"error===>")}},x=q(!1),Q=async()=>{x.value=!0;const d=a.value;let c={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:d.length};c.coinTypeC=d[0]?d[0].coin_address:"",c.coinTypeD=d[1]?d[1].coin_address:"",c.coinTypeE=d[2]?d[2].coin_address:"";try{let I;if(u.value==="Aptos"){const U=await h.value.getCollectRewarderTransactionPayload(c);I=await R.value.currentWallet.signAndSubmitTransaction(U)}else{c.pos_index=o.value.pos_object_id;const U=await h.value.getCollectRewarderTransactionPayload(c),E=await h.value.signAndExecuteTransactionBlock(R.value.currentWallet,U.txb,U.payloadParams);I=h.value.handleTx(E)}if(I&&I.hash){S(I.hash),ne(!1),ie(!0);const U=d[0].amount+d[0].symbol,E=c.coinTypeD?" and "+d[1].amount+d[1].symbol:"",D=c.coinTypeE?" and "+d[2].amount+d[2].symbol:"",Y={title:"Claim",desc:"",hash:I.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:d[0].address,numa:`+ ${Number(d[0].amount)}`,logoa:m.value.tokensObj&&d[0]&&d[0].address&&m.value.tokensObj[d[0].address]&&m.value.tokensObj[d[0].address].logoURI,tokenb:d[1]&&d[1].address,numb:c.coinTypeD?`+ ${Number(d[1].amount)}`:"",logob:c.coinTypeD?m.value.tokensObj&&d[1]&&d[1].address&&m.value.tokensObj[d[1].address]&&m.value.tokensObj[d[1].address].logoURI:"",tokenc:d[2]&&d[2].address,numc:c.coinTypeE?`+ ${Number(d[2].amount)}`:"",logoc:c.coinTypeE?m.value.tokensObj&&d[2]&&d[2].address&&m.value.tokensObj[d[2].address]&&m.value.tokensObj[d[2].address].logoURI:""},text:U+E+D};u.value!=="Aptos"&&(Y.res=I.res),h.value.showTransitionPending(Y),await h.value.watchTransaction(Y)&&setTimeout(()=>{t.emit("getDetails"),h.value.getAccount(R.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),ne(!1),V(!0);x.value=!1}catch(I){console.log("0310###collectRewarderParams Error###",I),x.value=!1,ne(!1),V(!0)}},te=_(()=>m.value.positionDetailCurrentTab),K=_(()=>{var I,U,E,D,Y,ee;const d=ke(f.value?(U=o.value)==null?void 0:U.amountB:(I=o.value)==null?void 0:I.amountA,f.value?(ee=(Y=o.value)==null?void 0:Y.token_b)==null?void 0:ee.decimals:(D=(E=o.value)==null?void 0:E.token_a)==null?void 0:D.decimals),c=f.value?m.value.positionActionAmount.toCoinAmount||0:m.value.positionActionAmount.fromCoinAmount||0;if(te.value=="increase")return c?new g(d).add(new g(c)).toString():"";if(c){const le=new g(d).minus(new g(c)).toString();return le<0?"0":String(le)}else return""}),be=_(()=>{var I,U,E,D,Y,ee;const d=ke(f.value?(U=o.value)==null?void 0:U.amountA:(I=o.value)==null?void 0:I.amountB,f.value?(ee=(Y=o.value)==null?void 0:Y.token_a)==null?void 0:ee.decimals:(D=(E=o.value)==null?void 0:E.token_b)==null?void 0:D.decimals),c=f.value?m.value.positionActionAmount.fromCoinAmount||0:m.value.positionActionAmount.toCoinAmount||0;if(te.value=="increase")return c?new g(d).add(new g(c)).toString():"";if(c){const le=new g(d).minus(new g(c)).toString();return le<0?"0":String(le)}else return""}),M=_(()=>f.value?m.value.positionActionAmount.toCoinAmount:m.value.positionActionAmount.fromCoinAmount),ge=_(()=>f.value?m.value.positionActionAmount.fromCoinAmount:m.value.positionActionAmount.toCoinAmount),we=d=>{var c;return(d==null?void 0:d.logoURI)||(d==null?void 0:d.logo_url)||((c=m.value.tokensObj[d==null?void 0:d.address])==null?void 0:c.logo_url)||(p.value.theme==="default"?io("/image/coins/unknown.png"):io("/image/coins/sui-unknown.png"))},Be=_(()=>{var D,Y,ee,le,fe,_e,L,j,ce,pe,C,W;const{fromCoinAmount:d,toCoinAmount:c}=m.value.positionActionAmount,I=m.value.positionDetailCurrentTab,U=ke(f.value?(Y=o.value)==null?void 0:Y.amountB:(D=o.value)==null?void 0:D.amountA,f.value?(_e=(fe=o.value)==null?void 0:fe.token_b)==null?void 0:_e.decimals:(le=(ee=o.value)==null?void 0:ee.token_a)==null?void 0:le.decimals),E=ke(f.value?(j=o.value)==null?void 0:j.amountA:(L=o.value)==null?void 0:L.amountB,f.value?(W=(C=o.value)==null?void 0:C.token_a)==null?void 0:W.decimals:(pe=(ce=o.value)==null?void 0:ce.token_b)==null?void 0:pe.decimals);return u.value=="Sui"||I=="remove"&&u.value=="Aptos"&&d==U&&c==E}),Me=async()=>{se.value=!0;const d=Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,c=Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;X(i("newAdd.claimWaitingText",{from:f.value?c:d,and:Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?d:c})),ne(!0);let I;const U={pool:o.value.poolInfo,position:o.value};try{const E=await h.value.getCollectFeeTransactionPayload(U);if(u.value==="Aptos")I=await R.value.currentWallet.signAndSubmitTransaction(E);else{const D=await h.value.signAndExecuteTransactionBlock(R.value.currentWallet,E);I=h.value.handleTx(D)}if(I){S(I.hash),ne(!1),ie(!0);const D={title:"Claim",desc:"",hash:I.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_a.address&&m.value.tokensObj[o.value.token_a.address]&&m.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":m.value.tokensObj&&o.value&&o.value.token_b.address&&m.value.tokensObj[o.value.token_b.address]&&m.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Se(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Z(o.value.feeOwedA,o.value.token_a.decimals)==0||Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Z(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Se(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};u.value!=="Aptos"&&(D.res=I.res),h.value.showTransitionPending(D);const Y=await h.value.watchTransaction(D);console.log("0310##toClaim###transitionStatus####",Y),Y&&setTimeout(()=>{t.emit("getDetails")},1e3)}else ne(!1),V(!0),s.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Co.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});se.value=!1,console.log("claim####test###",I)}catch(E){console.log("claim###error####",E),se.value=!1,ne(!1),V(!0),s.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Co.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},Ce=Ge(nn,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:G,needReverse:f,decimalUi:ke,pendingFees:w,positionInfo:o,pendingRewarderArr:a,pendingYieldAmount:$,toClaim:Me,claimAll:z,fromCoin:l,toCoin:b,showNum:Se,claimLoading:se,addCommom:Z,afterBase:K,afterQuote:be,fromCoinAmount:M,toCoinAmount:ge,checkNullObj:ve,getCoinIcon:we,chainName:u,isShowAfterAmount:Be,pendingRewarderAmount:v,toClaimRewards:Q,rewarderLoading:x,indicator:Ce,canClaimYield:r}}});const di={class:"liquidity-card"},ci={class:"liquidity-title"},mi={class:"liquidity-usd"},vi=n("span",null,"Liquidity",-1),fi={class:"liquidity-ratio"},pi={class:"coin-ratio"},hi={class:"coin-a-ratio"},bi={class:"coin-b-ratio"},gi={class:"ratio-progress"},ki={class:"base-quote-num"},_i={class:"base-coin-num"},wi=n("span",null,"Base",-1),yi={alt:""},Ai={key:0,class:"after"},Ii={class:"quote-coin-num"},Ci=n("span",null,"Quote",-1),$i={alt:""},Si={key:0,class:"after"},Pi={class:"pending-yield"},Ti={class:"left"},Ni={class:"pending-yield-title"},Ri={key:0,class:"after"},Oi={class:"right"},qi={class:"fees-rewards"},Li={class:"fees-rewards-item"},Bi=n("span",null,"Fees",-1),Mi={key:0,class:"after"},Ui=n("span",null,"Fees",-1),ji={key:0,class:"after"},Ei=n("span",null,"Mining Rewards",-1),Di={style:{"margin-top":"5px"}},Fi={alt:""},Wi=n("span",null,"Mining Rewards",-1),Hi={alt:""},Xi={key:0,class:"after"},zi={key:0,class:"pending-yield"},Yi={class:"left"},Gi=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Ji={key:0,class:"after"},Qi={class:"right"},Zi={key:1,class:"fees-rewards"},Ki={class:"fees-rewards-item"},Vi=n("span",null,"Mining Rewards",-1),xi={alt:""},es={key:0,class:"after"};function os(e,t,i,s,T,p){var b,u,h,H,se,oe,G,f,y,w,r,$,v,A,a,ie,V,ne,X,S,B,R,z,x,Q,te,K,be,M,ge,we,Be,Me,Ce,d,c,I,U,E,D,Y,ee,le,fe,_e,L,j,ce,pe,C,W,O,re,de,$e,Ne,Ie,Re,Ee,De,Qe,Oe,je,Fe,We,Ze,Ae;const N=po,m=co,o=tn,l=wo("image");return k(),P("div",di,[n("div",ci,[n("div",mi,[vi,n("div",null,"$"+F(e.amountUSD),1)]),n("div",fi,[n("div",pi,[n("div",hi,[n("span",null,F(e.needReverse?(u=e.toCoin)==null?void 0:u.symbol:(b=e.fromCoin)==null?void 0:b.symbol),1),me(" "+F(e.needReverse?(H=e.positionInfo)==null?void 0:H.toPercent:(h=e.positionInfo)==null?void 0:h.fromPercent)+"% ",1)]),n("div",bi,[n("span",null,F(e.needReverse?(oe=e.fromCoin)==null?void 0:oe.symbol:(se=e.toCoin)==null?void 0:se.symbol),1),me(" "+F(e.needReverse?(f=e.positionInfo)==null?void 0:f.fromPercent:(G=e.positionInfo)==null?void 0:G.toPercent)+"% ",1)])]),n("div",gi,[n("div",{class:"from-percent",style:$o({width:e.needReverse?((w=e.positionInfo)==null?void 0:w.toPercent)+"%":((y=e.positionInfo)==null?void 0:y.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:$o({width:e.needReverse?(($=e.positionInfo)==null?void 0:$.fromPercent)+"%":((r=e.positionInfo)==null?void 0:r.toPercent)+"%"})},null,4)])])]),n("div",ki,[n("div",_i,[wi,n("div",null,[Pe(n("img",yi,null,512),[[l,(e.needReverse?(A=e.toCoin)==null?void 0:A.logo_url:(v=e.fromCoin)==null?void 0:v.logo_url)||e.getCoinIcon(e.needReverse?(ie=e.positionInfo)==null?void 0:ie.token_b:(a=e.positionInfo)==null?void 0:a.token_a)]]),ae(N,{address:e.needReverse?(S=(X=e.positionInfo)==null?void 0:X.token_b)==null?void 0:S.address:(ne=(V=e.positionInfo)==null?void 0:V.token_a)==null?void 0:ne.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.needReverse?(R=e.positionInfo)==null?void 0:R.amountB:(B=e.positionInfo)==null?void 0:B.amountA,e.needReverse?(te=(Q=e.positionInfo)==null?void 0:Q.token_b)==null?void 0:te.decimals:(x=(z=e.positionInfo)==null?void 0:z.token_a)==null?void 0:x.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)?(k(),P("div",Ai,F(("addCommom"in e?e.addCommom:J(Z))(e.afterBase))+" after ",1)):ue("",!0)]),n("div",Ii,[Ci,n("div",null,[Pe(n("img",$i,null,512),[[l,(e.needReverse?(be=e.fromCoin)==null?void 0:be.logo_url:(K=e.toCoin)==null?void 0:K.logo_url)||e.getCoinIcon(e.needReverse?(ge=e.positionInfo)==null?void 0:ge.token_a:(M=e.positionInfo)==null?void 0:M.token_b)]]),ae(N,{address:e.needReverse?(Ce=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:Ce.address:(Be=(we=e.positionInfo)==null?void 0:we.token_b)==null?void 0:Be.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(("decimalUi"in e?e.decimalUi:J(ke))(e.needReverse?(c=e.positionInfo)==null?void 0:c.amountA:(d=e.positionInfo)==null?void 0:d.amountB,e.needReverse?(D=(E=e.positionInfo)==null?void 0:E.token_a)==null?void 0:D.decimals:(U=(I=e.positionInfo)==null?void 0:I.token_b)==null?void 0:U.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)?(k(),P("div",Si,F(("addCommom"in e?e.addCommom:J(Z))(e.afterQuote))+" after ",1)):ue("",!0)])]),n("div",Pi,[n("div",Ti,[n("div",Ni,F(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[me(" $"+F(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(k(),P("span",Ri,"$0 after")):ue("",!0)])]),n("div",Oi,[ae(m,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.canClaimYield==0,onClick:t[0]||(t[0]=he=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[me("Claim")]),_:1},8,["loading","disabled"])])]),n("div",qi,[n("div",Li,[n("div",null,[Bi,n("div",null,[Pe(n("img",null,null,512),[[l,(e.needReverse?(ee=e.toCoin)==null?void 0:ee.logo_url:(Y=e.fromCoin)==null?void 0:Y.logo_url)||e.getCoinIcon(e.needReverse?(fe=e.positionInfo)==null?void 0:fe.token_b:(le=e.positionInfo)==null?void 0:le.token_a)]]),ae(N,{address:e.needReverse?(ce=(j=e.positionInfo)==null?void 0:j.token_b)==null?void 0:ce.address:(L=(_e=e.positionInfo)==null?void 0:_e.token_a)==null?void 0:L.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(O=(W=e.positionInfo)==null?void 0:W.token_b)==null?void 0:O.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(C=(pe=e.positionInfo)==null?void 0:pe.token_a)==null?void 0:C.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(k(),P("div",Mi," 0 after ")):ue("",!0)]),n("div",null,[Ui,n("div",null,[Pe(n("img",null,null,512),[[l,(e.needReverse?(de=e.fromCoin)==null?void 0:de.logo_url:(re=e.toCoin)==null?void 0:re.logo_url)||e.getCoinIcon(e.needReverse?(Ne=e.positionInfo)==null?void 0:Ne.token_a:($e=e.positionInfo)==null?void 0:$e.token_b)]]),ae(N,{address:e.needReverse?(De=(Ee=e.positionInfo)==null?void 0:Ee.token_a)==null?void 0:De.address:(Re=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:Re.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(e.needReverse?("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedA,(Fe=(je=e.positionInfo)==null?void 0:je.token_a)==null?void 0:Fe.decimals):("showNum"in e?e.showNum:J(Se))(e.positionInfo.feeOwedB,(Oe=(Qe=e.positionInfo)==null?void 0:Qe.token_b)==null?void 0:Oe.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(k(),P("div",ji," 0 after ")):ue("",!0)]),e.chainName=="Sui"?(k(),P(Ve,{key:0},[e.pendingRewarderArr.length==0&&((Ae=(Ze=(We=e.positionInfo)==null?void 0:We.poolInfo)==null?void 0:Ze.rewarderInfo)==null?void 0:Ae.length)>0?(k(!0),P(Ve,{key:0},to(e.positionInfo.poolInfo.rewarderInfo,he=>(k(),P("div",{key:he.coinAddress},[Ei,n("div",Di,[Pe(n("img",Fi,null,512),[[l,e.getCoinIcon({address:he.coinAddress})]]),ae(N,{address:he.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),ae(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):ue("",!0),(k(!0),P(Ve,null,to(e.pendingRewarderArr,he=>(k(),P("div",{key:he},[Wi,n("div",null,[Pe(n("img",Hi,null,512),[[l,he.logo_url]]),ae(N,{address:he.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(he.amount>0?("showNum"in e?e.showNum:J(Se))(he.amount,he.decimals):0),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(k(),P("div",Xi," 0 after ")):ue("",!0)]))),128))],64)):ue("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(k(),P("div",zi,[n("div",Yi,[Gi,n("div",null,[me(" $"+F(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Z))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(k(),P("span",Ji,"$0 after")):ue("",!0)])]),n("div",Qi,[ae(m,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[me("Claim")]),_:1},8,["loading","disabled","onClick"])])])):ue("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(k(),P("div",Zi,[n("div",Ki,[(k(!0),P(Ve,null,to(e.pendingRewarderArr,he=>(k(),P("div",{key:he},[Vi,n("div",null,[Pe(n("img",xi,null,512),[[l,he.logo_url]]),ae(N,{address:he.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,F(he.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(ve))(e.positionInfo)&&e.isShowAfterAmount?(k(),P("div",es," 0 after ")):ue("",!0)]))),128))])])):ue("",!0)])}const Yo=Ye(ui,[["render",os]]),ns=ze({components:{AssetsCard:ho},setup(e,t){const i=q(""),s=q(""),T=Xe(),p=_(()=>T),N=_(()=>p.value.theme),m=xe(),o=_(()=>m),l=q(!1),b=q(!1),u=q(!0),h=_(()=>p.value.chainName),H=_(()=>h.value?eo(h.value):{}),se=mo(),oe=_(()=>se),G=_(()=>p.value.slippage),f=q(),y=q(),w=_(()=>oe.value.assets&&f.value&&oe.value.assets[f.value.address]?Io(oe.value.assets[f.value.address].balance,f.value.decimals):0),r=_(()=>oe.value.assets&&y.value&&oe.value.assets[y.value.address]?Io(oe.value.assets[y.value.address].balance,y.value.decimals):0),$=c=>{c==="fromCoin"?(u.value=!0,h.value==="Aptos"?i.value=w.value>0?f.value.symbol=="APT"?new g(Number(w.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(w.value)).sub(new g(.1)).toString():String(w.value):"":i.value=w.value>0?f.value.symbol=="SUI"?new g(Number(w.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(w.value)).sub(new g(.05)).toString():String(w.value):""):(u.value=!1,h.value==="Aptos"?s.value=r.value>0?y.value.symbol=="APT"?new g(Number(r.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(r.value)).sub(new g(.1)).toString():String(r.value):"":s.value=r.value>0?y.value.symbol=="SUI"?new g(Number(r.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(r.value)).sub(new g(.05)).toString():String(r.value):"")},v=c=>{c==="fromCoin"?(u.value=!0,i.value=Ue(new g(Number(w.value)).div(2).toString(),f.value.decimals).toString()):(u.value=!1,s.value=Ue(new g(Number(r.value)).div(2).toString(),y.value.decimals).toString())},A=q({}),a=q(!0),ie=q({}),V=q(),ne=q(),X=()=>{var j;if(!A.value||!i.value&&!s.value)return;const{TickMath:c,TickUtil:I}=H.value;let U=A.value.minPrice,E=A.value.maxPrice.indexOf("+")>0?"âˆž":A.value.maxPrice,D=Number(A.value.tick_lower_index),Y=Number(A.value.tick_upper_index);const ee=Number(A.value.current_tick_index);let le,fe,_e=Number(U).toString(),L=A.value.maxPrice.indexOf("+")>0||A.value.maxPrice==="âˆž"?"âˆž":Number(E);if(_e=="0"&&L=="âˆž"?(D=Number(A.value.tick_lower_index),Y=Number(A.value.tick_upper_index)):(le=c.priceToSqrtPriceX64(new g(U),f.value.decimals,y.value.decimals),fe=c.priceToSqrtPriceX64(new g(E),f.value.decimals,y.value.decimals)),V.value=D,ne.value=Y,E!=="âˆž"&&D>=Y){l.value=!0,i.value="",b.value=!0,s.value="";return}if(E=="âˆž"||ee>=D&&ee<Y){l.value=!1,b.value=!1;let ce;if(i.value||s.value){if(u.value){const de=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(de)}else{const de=new g(s.value).mul(Math.pow(10,y.value.decimals)).toString();ce=new qe(de)}const{liquidityAmount:pe,tokenMaxA:C,tokenMaxB:W,tokenMaxAOrigin:O,tokenMaxBOrigin:re}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:y.value,lowerTick:D,upperTick:Y,coinAmount:ce,iscoinA:a.value?u.value:!u.value,roundUp:!0,slippage:Number(G.value)/100,curSqrtPrice:new qe(A.value.current_sqrt_price)});ie.value={liquidityAmount:pe,tokenMaxA:C,tokenMaxB:W,tokenMaxAOrigin:O,tokenMaxBOrigin:re},a.value?u.value?s.value=Number(W)>0?W:"":i.value=Number(C)>0?C:"":u.value?s.value=C:i.value=W}}else if(ee>=Y){if(i.value="",l.value=!0,b.value=!1,i.value||s.value){let ce;const pe=new g(s.value).mul(Math.pow(10,(j=y.value)==null?void 0:j.decimals)).toString();ce=new qe(pe),ie.value={liquidityAmount:Bo(le,fe,ce),tokenMaxA:0,tokenMaxB:s.value}}}else if(ee<D){if(l.value=!1,b.value=!0,s.value="",i.value||s.value){let ce;const pe=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();ce=new qe(pe),ie.value={liquidityAmount:Mo(le,fe,ce),tokenMaxA:i.value,tokenMaxB:0}}}else l.value=!0,i.value="",b.value=!0,s.value="";m.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};ye(()=>o.value.currentPositionInfo,c=>{if(c&&!ve(c)){A.value=c,f.value=A.value.token_a,y.value=A.value.token_b;let I=Number(A.value.tick_lower_index),U=Number(A.value.tick_upper_index);const E=Number(A.value.current_tick_index);(c.maxPrice.indexOf("+")>0||c.maxPrice==="âˆž"?"âˆž":c.maxPrice)=="âˆž"||E>=I&&E<U?(l.value=!1,b.value=!1):E>=U?(i.value="",l.value=!0,b.value=!1):E<I?(l.value=!1,b.value=!0,s.value=""):(l.value=!0,i.value="",b.value=!0,s.value=""),X()}},{immediate:!0}),ye(i,(c,I)=>{c&&X(),c==""&&(s.value="")}),ye(s,(c,I)=>{c&&X(),c==""&&(i.value="")});const S=_(()=>{var c,I;return(I=(c=A.value)==null?void 0:c.poolInfo)==null?void 0:I.needReverse}),B=_(()=>o.value.RATES),R=_(()=>{var Y,ee,le,fe;const c=((ee=B.value[(Y=f.value)==null?void 0:Y.address])==null?void 0:ee.price)||0,I=((fe=B.value[(le=y.value)==null?void 0:le.address])==null?void 0:fe.price)||0,U=new g(c).mul(new g(i.value||0)),E=new g(I).mul(new g(s.value||0)),D=U.add(E);return D.toNumber()?D.toNumber()>0&&D.toNumber()>.01?Z(D.toString(),2):"<0.01":"--"}),z=q(!1),{t:x,locale:Q}=yo(),te=_(()=>{const c=Number(i.value)>Number(w.value),I=Number(s.value)>Number(r.value);return!i.value&&!s.value?x("button.enterAmount"):c?x("button.insufficientBalance",{name:f.value.symbol}):I?x("button.insufficientBalance",{name:y.value.symbol}):x("newAdd.addMore")}),K=_(()=>{const c=Number(i.value)>Number(w.value),I=Number(s.value)>Number(r.value);return!!(!i.value&&!s.value||c||I)}),{setIsShowSuccess:be,setIsShowRejected:M,setIsShowWaiting:ge,setTransactionDesc:we,setTransactionTxid:Be,setPositiomNum:Me}=T,Ce=q(!1);return{theme:N,showFromCoinLock:l,showToCoinLock:b,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:w,toCoinBlance:r,fromCoin:f,toCoin:y,maxBtnSelect:$,halfBtnSelect:v,fixedFromCoin:u,needReverse:S,totalAmount:R,wallet:oe,addLiquidityBtnText:te,isShowLiquidityModal:z,indexStore:T,positionInfo:A,actionLoading:Ce,toAdd:async()=>{var Y,ee,le,fe,_e,L,j,ce,pe,C;z.value=!1,Ce.value=!0,Be("");const c=l.value?"":`${i.value} ${(Y=f.value)==null?void 0:Y.symbol}`,I=b.value?"":`${s.value} ${(ee=y.value)==null?void 0:ee.symbol}`;we(x("tips.increaseLiquiditySuccess",{from:S.value?I:c,and:!l.value&&!b.value?"and":"",to:S.value?c:I})),ge(!0);const U=u.value,E=A.value.poolInfo.rewarder_infos;let D={};D.coinTypeC=E[0]?E[0].coinAddress:"",D.coinTypeD=E[1]?E[1].coinAddress:"",D.coinTypeE=E[2]?E[2].coinAddress:"";try{const W=await H.value.getAddLiquidityTransactionPayload({pool:{poolAddress:A.value.poolAddress,token_a:A.value.token_a,token_b:A.value.token_b},amount:U?ie.value.tokenMaxA:ie.value.tokenMaxB,fix_amount_a:U,tick_lower:V.value,tick_upper:ne.value,index:h.value==="Aptos"?A.value.index:A.value.pos_object_id,slippage:Number(G.value)/100,roundUp:!0,collect_fee:!0,...D,curSqrtPrice:new qe(A==null?void 0:A.value.poolInfo.current_sqrt_price),positionInfo:A});let O;if(h.value==="Aptos")O=await oe.value.currentWallet.signAndSubmitTransaction(W);else{const re=await H.value.signAndExecuteTransactionBlock(oe.value.currentWallet,W==null?void 0:W.txb,W==null?void 0:W.payloadParams);O=H.value.handleTx(re)}if(console.log("toAdd###tx###",O),O&&O.hash){Be(O.hash),ge(!1),be(!0);const re={title:"Supplied",desc:x("tips.addLiquiditySuccessText",{from:l.value?"":`${i.value} ${(le=f.value)==null?void 0:le.symbol}`,and:!l.value&&!b.value?"and":"",to:b.value?"":`${s.value} ${(fe=y.value)==null?void 0:fe.symbol}`}),hash:O.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:S.value?`${(L=y.value)==null?void 0:L.address}`:`${(_e=f.value)==null?void 0:_e.address}`,numa:S.value?`- ${s.value}`:`- ${i.value}`,logoa:S.value?o.value.tokensObj&&y.value&&y.value.address&&o.value.tokensObj[y.value.address]&&o.value.tokensObj[y.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:S.value?`${(ce=f.value)==null?void 0:ce.address}`:`${(j=y.value)==null?void 0:j.address}`,numb:S.value?`- ${i.value}`:`- ${s.value}`,logob:S.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&y.value&&y.value.address&&o.value.tokensObj[y.value.address]&&o.value.tokensObj[y.value.address].logoURI},text:`Deopsit ${l.value?"":`${i.value} ${(pe=f.value)==null?void 0:pe.symbol}`} ${!l.value&&!b.value?"and":""} ${b.value?"":`${s.value} ${(C=y.value)==null?void 0:C.symbol}`}`};h.value!=="Aptos"&&(re.res=O.res),H.value.showTransitionPending(re),await H.value.watchTransaction(re)&&setTimeout(()=>{t.emit("getDetails"),H.value.getAccount(oe.value.address)},1e3),Me()}else ge(!1),M(!0);i.value="",s.value="",Ce.value=!1}catch(W){i.value="",s.value="",console.log("addError###",W),Ce.value=!1,ge(!1),M(!0)}},addLiquidityBtnDisabled:K,poolStore:m}}});const ts={class:"new-position-asset"},is={class:"add-or-remove"},ss={class:"liquidity-action-tab"},as=n("div",{class:"increase tab-active"}," Increase ",-1),ls={class:"card-item"},rs={class:"card-item"},us={key:0,class:"add",src:gn},ds={key:1,class:"add",src:kn},cs={class:"total-amount"},ms=n("span",null,"Total Amount",-1);function vs(e,t,i,s,T,p){var b;const N=ho,m=hn,o=co,l=bn;return k(),P("div",ts,[n("div",is,[n("div",ss,[as,n("div",{class:"remove",onClick:t[0]||(t[0]=u=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ls,[ae(N,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.fromCoinAmount=u),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=u=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=u=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=u=>{e.fromCoinAmount=u}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?(k(),Te(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):ue("",!0)]),n("div",rs,[ae(N,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=u=>e.toCoinAmount=u),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=u=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=u=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=u=>{e.toCoinAmount=u}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?(k(),Te(m,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):ue("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(k(),P("img",us)):ue("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(k(),P("img",ds)):ue("",!0)],2),n("div",cs,[ms,n("span",null,"$"+F(e.totalAmount),1)])]),e.wallet.connected?(k(),Te(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=u=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(k(),Te(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=u=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(k(),Te(l,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(b=e.positionInfo)==null?void 0:b.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=u=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):ue("",!0)])}const Go=Ye(ns,[["render",vs]]),fs=ze({components:{AssetsCard:ho},setup(e,t){const i=q(""),s=q(""),T=Xe(),p=_(()=>T),N=_(()=>p.value.theme),m=xe(),o=_(()=>m),l=q(!1),b=q(!1),u=q(!0),h=_(()=>p.value.chainName),H=_(()=>h.value?eo(h.value):{}),se=mo(),oe=_(()=>se),G=_(()=>p.value.slippage),f=q(),y=q(),w=_(()=>{var C,W;return(W=(C=a.value)==null?void 0:C.poolInfo)==null?void 0:W.needReverse}),r=_(()=>{var C;return ke(a==null?void 0:a.value.amountA,(C=a==null?void 0:a.value.token_a)==null?void 0:C.decimals)}),$=_(()=>{var C;return ke(a==null?void 0:a.value.amountB,(C=a==null?void 0:a.value.token_b)==null?void 0:C.decimals)}),v=C=>{C==="fromCoin"?u.value=!0:u.value=!1,R.value=100,x({value:1})},A=C=>{C==="fromCoin"?(u.value=!0,i.value=Ue(new g(Number(r.value)).div(2).toString(),f.value.decimals).toString()):(u.value=!1,s.value=Ue(new g(Number($.value)).div(2).toString(),y.value.decimals).toString()),S.value=!1},a=q({}),ie=q(!0),V=q({}),ne=q(),X=q(),S=q(!0),B=()=>{var Qe;if(S.value||!a.value||!i.value&&!s.value||Number(i.value)>Number(r.value)||Number(s.value)>Number($.value))return;if(i.value==r.value&&s.value==$.value){R.value=100,x({value:1}),S.value=!0;return}const{TickMath:C,TickUtil:W}=H.value;let O=a.value.minPrice,re=a.value.maxPrice.indexOf("+")>0?"âˆž":a.value.maxPrice,de=Number(a.value.tick_lower_index),$e=Number(a.value.tick_upper_index);const Ne=Number(a.value.current_tick_index);let Ie,Re,Ee=Number(O).toString(),De=a.value.maxPrice.indexOf("+")>0||a.value.maxPrice==="âˆž"?"âˆž":Number(re);if(Ee=="0"&&De=="âˆž"?(de=Number(a.value.tick_lower_index),$e=Number(a.value.tick_upper_index)):(Ie=C.priceToSqrtPriceX64(new g(O),f.value.decimals,y.value.decimals),Re=C.priceToSqrtPriceX64(new g(re),f.value.decimals,y.value.decimals)),ne.value=de,X.value=$e,re!=="âˆž"&&de>=$e){l.value=!0,i.value="",b.value=!0,s.value="";return}if(re=="âˆž"||Ne>=de&&Ne<$e){l.value=!1,b.value=!1;let Oe;if(i.value||s.value){if(u.value){const he=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(he)}else{const he=new g(s.value).mul(Math.pow(10,y.value.decimals)).toString();Oe=new qe(he)}const{liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae}=H.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:y.value,lowerTick:de,upperTick:$e,coinAmount:Oe,iscoinA:ie.value?u.value:!u.value,roundUp:h.value!="Sui",slippage:Number(G.value)/100,curSqrtPrice:new qe(a.value.current_sqrt_price)});V.value={liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ze,tokenMaxBOrigin:Ae},ie.value?u.value?s.value=Number(We)>0?We:"":i.value=Number(Fe)>0?Fe:"":u.value?s.value=Fe:i.value=We}}else if(Ne>=$e){if(i.value="",l.value=!0,b.value=!1,i.value||s.value){let Oe;const je=new g(s.value).mul(Math.pow(10,(Qe=y.value)==null?void 0:Qe.decimals)).toString();Oe=new qe(je),V.value={liquidityAmount:Bo(Ie,Re,Oe),tokenMaxA:0,tokenMaxB:s.value}}}else if(Ne<de){if(l.value=!1,b.value=!0,s.value="",i.value||s.value){let Oe;const je=new g(i.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(je),V.value={liquidityAmount:Mo(Ie,Re,Oe),tokenMaxA:i.value,tokenMaxB:0}}}else l.value=!0,b.value=!0;S.value=!1,R.value=new g(V.value.liquidityAmount.toString()).div(a.value.liquidity).mul(100).toNumber().toFixed(2),z.value=V.value.liquidityAmount,m.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})},R=q(50),z=q("0"),x=C=>{if(!S.value)return;S.value=!0;const W=a.value.token_a.decimals,O=a.value.token_b.decimals,re=a.value.tick_lower_index,de=a.value.tick_upper_index,$e=So.tickIndexToSqrtPriceX64(re),Ne=So.tickIndexToSqrtPriceX64(de);let Ie="";C.value!==1?Ie=new g(a.value.liquidity).mul(C.value).toString():Ie=a.value.liquidity,Ie=Ue(Ie,0)||"0",z.value=Ie;const Re=cn.getCoinAmountFromLiquidity(new qe(Ie),new qe(a.value.current_sqrt_price),$e,Ne,h.value!="Sui"),Ee=new g(Re.coinA.toString()).div(Math.pow(10,W)).toString(),De=new g(Re.coinB.toString()).div(Math.pow(10,O)).toString();i.value=Number(Ee)>0?Ee:"",s.value=Number(De)>0?De:"",m.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};ye(()=>o.value.currentPositionInfo,C=>{if(C&&!ve(C)){a.value=C,f.value=a.value.token_a,y.value=a.value.token_b,x({value:R.value/100});let W=Number(a.value.tick_lower_index),O=Number(a.value.tick_upper_index);const re=Number(a.value.current_tick_index);(C.maxPrice.indexOf("+")>0||C.maxPrice==="âˆž"?"âˆž":C.maxPrice)=="âˆž"||re>=W&&re<O?(l.value=!1,b.value=!1):re>=O?(i.value="",l.value=!0,b.value=!1):re<W?(l.value=!1,b.value=!0,s.value=""):(l.value=!0,i.value="",b.value=!0,s.value=""),B()}},{immediate:!0}),ye(i,(C,W)=>{C&&B(),C==""&&(s.value="",R.value=0)}),ye(s,(C,W)=>{C&&B(),C==""&&(i.value="",R.value=0)});const Q=_(()=>o.value.RATES),te=_(()=>{var $e,Ne,Ie,Re;const C=((Ne=Q.value[($e=f.value)==null?void 0:$e.address])==null?void 0:Ne.price)||0,W=((Re=Q.value[(Ie=y.value)==null?void 0:Ie.address])==null?void 0:Re.price)||0,O=new g(C).mul(new g(i.value||0)),re=new g(W).mul(new g(s.value||0)),de=O.add(re);return Z(de.toString(),2)}),K=q(!1),{t:be,locale:M}=yo(),ge=_(()=>{const C=Number(i.value)>Number(r.value),W=Number(s.value)>Number($.value);return!i.value&&!s.value?be("button.enterAmount"):C||W?"Invalid Amount":be("button.remove")}),we=_(()=>{const C=Number(i.value)>Number(r.value),W=Number(s.value)>Number($.value);return!!(!i.value&&!s.value||C||W)}),{setIsShowSuccess:Be,setIsShowRejected:Me,setIsShowWaiting:Ce,setTransactionDesc:d,setTransactionTxid:c,setPositiomNum:I,setTransactionDescText:U}=T,E=q(!1);ye(R,sn((C,W)=>{C!==W&&(Number(C)>100?R.value=100:C&&a.value?(R.value=C,x({value:R.value/100})):(i.value="",s.value=""))},300)),ye(G,C=>{C&&a.value&&x({value:R.value/100})});const D=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],Y=jo(),ee=_(()=>Y),le=_(()=>ee.value.status),fe=q(!1),_e=C=>{C.sources.forEach(O=>{const{pool_address:re,position_index:de}=JSON.parse(O.blockchainAddress);re==a.value.poolAddress&&Number(de)==Number(a.value.index)&&(fe.value=!0)})},L=async()=>{await Y.getSources();let C;ee.value.allSources.forEach(W=>{const{pool_address:O,position_index:re}=JSON.parse(W.blockchainAddress);O==a.value.poolAddress&&re==a.value.index&&(C=W.id)}),Y.deleteSource(C)};ye(()=>[ee.value.sourceGroups,a.value],([C,W])=>{C&&C.sources&&C.sources.length>0&&W&&!ve(W)&&_e(C)},{immediate:!0,deep:!0});const j=lo(),ce=fo();return{theme:N,showFromCoinLock:l,showToCoinLock:b,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:r,toCoinBlance:$,fromCoin:f,toCoin:y,maxBtnSelect:v,halfBtnSelect:A,fixedFromCoin:u,needReverse:w,totalAmount:te,wallet:oe,addLiquidityBtnText:ge,isShowLiquidityModal:K,indexStore:T,positionInfo:a,actionLoading:E,addLiquidityBtnDisabled:we,sliderVal:R,ratioArr:D,setPercent:x,poolStore:m,isSlider:S,toRemove:async()=>{var de,$e,Ne,Ie,Re,Ee,De,Qe,Oe,je,Fe,We,Ze;E.value=!0,c("");const C=Z(i.value,f.value.decimals)==0?"":`${ke(i.value,f.value.decimals)} ${f.value.symbol}`,W=Z(s.value,y.value.decimals)==0?"":`${ke(s.value,y.value.decimals)} ${y.value.symbol}`;d(be("tips.removeLiquidiyText",{from:w.value?W:C,and:Z(i.value,f.value.decimals)==0||Z(s.value,y.value.decimals)==0?"":"and",to:w.value?C:W})),Ce(!0);const O=a.value.poolInfo.rewarder_infos,re=O&&O.length>0&&h.value=="Sui"||O&&O.length>0&&R.value==100?be("modal.removeLiquidityText1"):be("modal.removeLiquidityText2");U(re);try{let Ae={};Ae={pool:{...a.value.poolInfo,coinA:a.value.token_a,coinB:a.value.token_b},coinTypeA:a.value.poolInfo.coinTypeA,coinTypeB:a.value.poolInfo.coinTypeB,position:a.value,delta_liquidity:R.value==100?new qe(a.value.liquidity):new qe(Ue(z.value,0)),slippage:Number(G.value),rewards_num:O.length,positionInfo:a.value},Ae.coinTypeC=O[0]?O[0].coinAddress:"",Ae.coinTypeD=O[1]?O[1].coinAddress:"",Ae.coinTypeE=O[2]?O[2].coinAddress:"";const he=await H.value.getRemoveLiquidityTransactionPayload(Ae);let He;if(h.value==="Aptos")He=await oe.value.currentWallet.signAndSubmitTransaction(he);else{const ro=await H.value.signAndExecuteTransactionBlock(oe.value.currentWallet,he.txb,he==null?void 0:he.payloadParams);He=H.value.handleTx(ro),console.log("0331###remove###tx####",He)}if(He&&He.hash){c(He.hash),Ce(!1),Be(!0);const ro={title:be("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${i.value} ${(de=f.value)==null?void 0:de.symbol} and ${s.value} ${($e=y.value)==null?void 0:$e.symbol} 
             from the pool`,sender:oe.value.address,chainName:h.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:w.value?`${(Ie=y.value)==null?void 0:Ie.address}`:`${(Ne=f.value)==null?void 0:Ne.address}`,numa:w.value?`+ ${s.value}`:`+ ${i.value}`,logoa:w.value?o.value.tokensObj&&y.value&&y.value.address&&o.value.tokensObj[y.value.address]&&o.value.tokensObj[y.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:w.value?`${(Re=f.value)==null?void 0:Re.address}`:`${(Ee=y.value)==null?void 0:Ee.address}`,numb:w.value?`+ ${i.value}`:`+ ${s.value}`,logob:w.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&y.value&&y.value.address&&o.value.tokensObj[y.value.address]&&o.value.tokensObj[y.value.address].logoURI},text:`Withdraw ${i.value} ${(De=f.value)==null?void 0:De.symbol} and ${s.value} ${(Qe=y.value)==null?void 0:Qe.symbol}`};h.value!=="Aptos"&&(ro.res=He.res),H.value.showTransitionPending(ro);const Ao=await H.value.watchTransaction(ro);if(O.value&&O.value.length>0&&(Number((Oe=O[0])==null?void 0:Oe.amount)!==0||Ae.coinTypeD&&Number((je=O[1])==null?void 0:je.amount)!==0||Ae.coinTypeE&&Number((Fe=O[2])==null?void 0:Fe.amount)!==0)){const bo={title:be("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:O[0].symbol,numa:`+ ${Number(O[0].amount)}`,logoa:o.value.tokensObj&&O[0]&&O[0].address&&o.value.tokensObj[O[0].address]&&o.value.tokensObj[O[0].address].logoURI,tokenb:Ae.coinTypeD?O[1].symbol:"",numb:Ae.coinTypeD?`+ ${Number(O[1].amount)}`:"",logob:Ae.coinTypeD?o.value.tokensObj&&O[1]&&O[1].address&&o.value.tokensObj[O[1].address]&&o.value.tokensObj[O[1].address].logoURI:"",tokenc:Ae.coinTypeE?O[2].symbol:"",numc:Ae.coinTypeE?`+ ${Number(O[2].amount)}`:"",logoc:Ae.coinTypeE?o.value.tokensObj&&O[2]&&O[2].address&&o.value.tokensObj[O[2].address]&&o.value.tokensObj[O[2].address].logoURI:""},text:`Withdraw ${i.value} ${(We=f.value)==null?void 0:We.symbol} and ${s.value} ${(Ze=y.value)==null?void 0:Ze.symbol}`},Ko=await H.value.setTransations(bo)}if(Se(a.value.feeOwedA,a.value.token_a.decimals)!==0||Se(a.value.feeOwedB,a.value.token_b.decimals)!==0){const bo={title:"Claim",desc:"",hash:He.hash,chainName:h.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${a.value.token_a.symbol}`,numa:Z(a.value.feeOwedA,a.value.token_a.decimals)==0?"":`+ ${Se(a.value.feeOwedA,a.value.token_a.decimals)}`,logoa:Z(a.value.feeOwedA,a.value.token_a.decimals)==0?"":o.value.tokensObj&&a.value&&a.value.token_a.address&&o.value.tokensObj[a.value.token_a.address]&&o.value.tokensObj[a.value.token_a.address].logoURI,tokenb:`${a.value.token_b.symbol}`,numb:Z(a.value.feeOwedB,a.value.token_b.decimals)==0?"":`+ ${Se(a.value.feeOwedB,a.value.token_b.decimals)}`,logob:Z(a.value.feeOwedB,a.value.token_b.decimals)==0?"":o.value.tokensObj&&a.value&&a.value.token_b.address&&o.value.tokensObj[a.value.token_b.address]&&o.value.tokensObj[a.value.token_b.address].logoURI}},Ko=await H.value.setTransations(bo)}Ao&&Number(R.value)==100&&le.value=="authenticated"&&fe.value&&(await Y.subscribePosition({pool_address:a.value.poolAddress,position_index:a.value.index},a.value.nftHash,!1),L()),Ao&&(i.value="",s.value="",setTimeout(()=>{Number(R.value)!==100&&t.emit("getDetails")},3e3),setTimeout(()=>{Number(R.value)!==100&&t.emit("getDetails")},6e3),Number(R.value)==100&&ce.name=="new-position-detail"&&(h.value==="Aptos"?j.push("/position"):j.push("/pool/position")),R.value=0)}else Ce(!1),Me(!0);E.value=!1}catch(Ae){console.log("Remove error",Ae),E.value=!1,Ce(!1),Me(!0)}},sFixD:Ue}}});const ps={class:"new-position-asset"},hs={class:"add-or-remove"},bs={class:"liquidity-action-tab"},gs=n("div",{class:"remove tab-active"},"Remove",-1),ks={class:"card-item"},_s={key:0,class:"assets-card-mask"},ws={class:"card-item"},ys={key:0,class:"assets-card-mask"},As={class:"remove-ratio"},Is=n("div",{class:"remove-ratio-title"},"Amount",-1),Cs={class:"remove-ratio-select"},$s={key:0,class:"ratio"},Ss={key:1,class:"ratio"},Ps={class:"ratio-list"},Ts=["onClick"];function Ns(e,t,i,s,T,p){const N=ho,m=an,o=co;return k(),P("div",ps,[n("div",hs,[n("div",bs,[n("div",{class:"increase",onClick:t[0]||(t[0]=l=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),gs]),n("div",{class:vo(e.needReverse?"card-container reverse":"card-container")},[n("div",ks,[ae(N,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.fromCoinAmount=l),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=l=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=l=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=l=>{e.fromCoinAmount=l,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(k(),P("div",_s)):ue("",!0)]),n("div",ws,[ae(N,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=l=>e.toCoinAmount=l),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=l=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=l=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=l=>{e.toCoinAmount=l,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(k(),P("div",ys)):ue("",!0)])],2),n("div",As,[Is,n("div",Cs,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(k(),P("div",$s,F(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))+"% ",1)):(k(),P("div",Ss," -- ")),n("div",Ps,[(k(!0),P(Ve,null,to(e.ratioArr,(l,b)=>(k(),P("div",{key:b,class:vo(["ratio-item",e.sliderVal==l.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=l.value}},F(l.name),11,Ts))),128))])]),ae(m,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=l=>e.sliderVal=l)},null,8,["value"])])]),e.wallet.connected?(k(),Te(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,F(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(k(),Te(o,{key:1,class:"big-btn",onClick:t[10]||(t[10]=l=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,F(e.$t("button.connectWallet")),1)]),_:1}))])}const Jo=Ye(fs,[["render",Ns]]),Rs=ze({setup(){const e=xe(),t=_(()=>e),i=Eo(),s=_(()=>i),T=lo(),p=_(()=>t.value.currentPositionInfo),N=q(),m=X=>{var S;return((S=t.value.tokensObj[X])==null?void 0:S.logo_url)||io("/image/coins/sui-unknown.png")},o=en("Sui"),l=q(),b=async X=>{l.value=0;try{const S=await o.calculateFarmingRewards([{pool_id:X.pool_id,position_nft_id:X.id}]),B=[];let R=new g(0);S[X.id].forEach((z,x)=>{var K;const Q=(K=t.value.tokensObj[z.rewarder_type])==null?void 0:K.decimals;let te=new g(z.rewarder_amount).div(Math.pow(10,Q)).toString();Number(te)>0&&h.value.rewarders[x]&&(R=R.add(te),B.push({...z,rewarderAmount:te,rewarderAmountPer:te}))}),l.value=R,N.value=B}catch(S){console.log(S,"getRewarder")}},u=_(()=>s.value.farmsPoolObj),h=_(()=>u.value[p.value.poolAddress]);ye(()=>[p.value,u.value,h.value],([X,S,B])=>{var R;!ve(X)&&X.positionSource=="farming"&&!ve(B)?b(X):!ve(S)&&!ve(X)&&(N.value=(R=S[X.poolAddress])==null?void 0:R.rewarders)},{immediate:!0});const H=mo(),se=_(()=>H),oe=Xe(),G=eo("Sui"),{setIsShowSuccess:f,setIsShowRejected:y,setIsShowWaiting:w,setTransactionDesc:r,setTransactionTxid:$}=oe,v=q(!1),A=async()=>{v.value=!0,$(""),r("Claim rewards"),w(!0);const X={pool_id:p.value.pool_id,position_nft_id:p.value.id};try{const S=await o.harvestFarms(X),B=await G.signAndExecuteTransactionBlock(se.value.currentWallet,S.txb,S.payloadParams);console.log("0221###sui swap res###",B);let R=G.handleTx(B);if(R&&R.hash){$(R.hash),w(!1),f(!0);let z={title:"Claim",res:R.res,hash:R.hash};G.showTransitionPending(z),await G.watchTransaction(z)&&setTimeout(()=>{b(p.value)},2e3)}else w(!1),y(!0);v.value=!1}catch(S){console.log("farmsDeposit error",S),w(!1),y(!0),v.value=!1}},a=async()=>{v.value=!0,$(""),r(`Unstake ${p.value.name}`),w(!0);const X=p.value.pool_id,S=p.value.id;try{const B=await o.farmsWithdraw(X,S),R=await G.signAndExecuteTransactionBlock(se.value.currentWallet,B.txb,B.payloadParams);console.log("0221###sui swap res###",R);let z=G.handleTx(R);if(z&&z.hash){$(z.hash),w(!1),f(!0);let x={res:z.res,title:"Unstake",hash:z.hash};G.showTransitionPending(x),await G.watchTransaction(x)&&setTimeout(()=>{T.replace(`/new-position-detail?token=${p.value.tokenName}&address=${p.value.clmm_pool_id}&pos=${p.value.clmm_position_id}`),t.value.setCurrentPositionInfo(p.value.clmm_pool_id,"",p.value.tokenName,"Sui",p.value.clmm_position_id),l.value=0,v.value=!1},2e3)}else w(!1),y(!0)}catch(B){console.log("farmsDeposit error",B),w(!1),y(!0),v.value=!1}},ie=async()=>{v.value=!0,$(""),r(`Stake ${p.value.name}`),w(!0);const X={clmm_pool_id:p.value.poolAddress,clmm_position_id:p.value.pos_object_id,coinTypeA:p.value.coin_type_a,coinTypeB:p.value.coin_type_b},S=u.value[p.value.poolAddress].id;try{const B=await o.farmsDeposit(X,S),R=await G.signAndExecuteTransactionBlock(se.value.currentWallet,B.txb,B.payloadParams);console.log("0221###sui swap res###",R);let z=G.handleTx(R);if(z&&z.hash){$(z.hash),w(!1),f(!0);let x={res:z.res,title:"Staked",hash:z.hash};G.showTransitionPending(x);const Q=await G.watchTransaction(x,!0);let te;Q!=null&&Q.status&&setTimeout(async()=>{var K,be;(be=(K=Q==null?void 0:Q.res)==null?void 0:K.events)==null||be.forEach(M=>{M.type.indexOf("::pool::DepositEvent")>-1&&(te=M.parsedJson.wrapped_position_id)}),T.replace(`/new-position-detail?position_nft_id=${te}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",te,"farming"),v.value=!1},2e3)}else w(!1),y(!0)}catch(B){console.log("farmsDeposit error",B),w(!1),y(!0),v.value=!1}},V=_(()=>oe),ne=_(()=>V.value.addressLpTokens);return{getCoinIcon:m,rewardList:N,sFixD:Ue,addCommom:Z,claim:A,unStake:a,loading:v,totalRewardAmount:l,currentPositionInfo:p,stake:ie,farmsPoolObj:u,addressLpTokens:ne,farmsPoolInfo:h}}});const oo=e=>(so("data-v-deedd8aa"),e=e(),ao(),e),Os={key:0,class:"farms-position-detail"},qs={class:"farms-top"},Ls=oo(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),Bs={class:"right"},Ms={class:"apr"},Us={class:"apr-tips-box"},js=oo(()=>n("span",null,"View",-1)),Es=oo(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Ds=[js,Es],Fs={class:"farms-bottom"},Ws=oo(()=>n("div",{class:"title"},"Farming Rewards",-1)),Hs={key:0,class:"reward-list"},Xs={key:0,class:"rewards-item-bg"},zs={class:"rewards-item-box"},Ys={alt:""},Gs={key:1},Js={class:"rewards-item-bg"},Qs={class:"rewards-item-box"},Zs={alt:""},Ks=oo(()=>n("span",null,"0",-1)),Vs={key:1,class:"reward-list"},xs={key:0,class:"rewards-item-bg"},ea={class:"rewards-item-box"},oa={alt:""},na=oo(()=>n("span",null,"0",-1)),ta={key:1},ia={class:"rewards-item-bg"},sa={class:"rewards-item-box"},aa={alt:""},la=oo(()=>n("span",null,"0",-1)),ra={class:"actions-box"};function ua(e,t,i,s,T,p){var b,u;const N=_n,m=co,o=qo,l=wo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(k(),P("div",Os,[n("div",qs,[Ls,n("div",Bs,[n("div",Ms,[me(" APRÂ  "),n("span",null,[me(F(("addCommom"in e?e.addCommom:J(Z))(e.farmsPoolInfo.total_apr*100,2))+"%Â  ",1),n("div",Us,[ae(N,{"l-item":e.farmsPoolInfo,"rewarder-info":(u=(b=e.farmsPoolInfo)==null?void 0:b.rewarder)==null?void 0:u.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=h=>e.$router.push("/farms"))},Ds)])]),n("div",Fs,[Ws,e.rewardList&&e.rewardList.length>0?(k(),P("div",Hs,[(k(!0),P(Ve,null,to(e.rewardList,h=>(k(),P("div",{key:h,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(k(),P("div",Xs,[n("div",zs,[Pe(n("img",Ys,null,512),[[l,e.getCoinIcon(h.rewarder_type)]]),n("span",null,F(("addCommom"in e?e.addCommom:J(Z))(h.rewarderAmount||0)),1)])])):(k(),P("div",Gs,[n("div",Js,[n("div",Qs,[Pe(n("img",Zs,null,512),[[l,e.getCoinIcon(h.reward_coin)]]),Ks])])]))]))),128))])):(k(),P("div",Vs,[(k(!0),P(Ve,null,to(e.currentPositionInfo.rewards,h=>(k(),P("div",{key:h,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(k(),P("div",xs,[n("div",ea,[Pe(n("img",oa,null,512),[[l,e.getCoinIcon(h.rewarder_type)]]),na])])):(k(),P("div",ta,[n("div",ia,[n("div",sa,[Pe(n("img",aa,null,512),[[l,e.getCoinIcon(h.reward_coin)]]),la])])]))]))),128))])),n("div",ra,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(k(),Te(m,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[me("Unstake")]),_:1},8,["loading","onClick"])):ue("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(k(),Te(o,{key:1},{title:Le(()=>[me("Farming rewards are only available for active positions.")]),default:Le(()=>[ae(m,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[me("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(k(),Te(m,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[me("Stake")]),_:1},8,["loading","onClick"])):ue("",!0),ae(m,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Lo(e.claim,["stop"])},{default:Le(()=>[me("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):ue("",!0)}const Qo=Ye(Rs,[["render",ua],["__scopeId","data-v-deedd8aa"]]),da=ze({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=jo(),i=_(()=>t),s=_(()=>i.value.status),T=Xe(),p=q(!1);ye(()=>s.value,l=>{l=="authenticated",p.value=!1},{immediate:!0});const N=q(!1),m=async()=>{N.value=!N.value;const l={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},b=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(l,b,N.value)}catch{N.value=!N.value}},o=l=>{const b=l.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",b),N.value=b.some(u=>JSON.parse(u.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(u.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return lo(),ye(()=>[i.value.sourceGroups,e.positionInfo],([l,b])=>{N.value=!1,l&&l.length>0&&l[0]&&b&&!ve(b)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),o(l[0]))},{immediate:!0,deep:!0}),{importIcon:io,isShowSetUp:p,changeSwitch:m,checked:N,notifiStatus:s,store:T}}});const ca=e=>(so("data-v-1a37a36d"),e=e(),ao(),e),ma={class:"range-alerts"},va={class:"range-alerts-top"},fa={class:"title"},pa=ca(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ha={key:1,class:"h5-switch-box"},ba={class:"range-alerts-bottom"},ga={key:0,class:"pc-switch-box"};function ka(e,t,i,s,T,p){const N=co,m=ln;return k(),P("div",ma,[n("div",va,[n("div",fa,[pa,e.isShowSetUp||e.notifiStatus!=="authenticated"?(k(),Te(N,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Lo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[me(" Set up ")]),_:1})):ue("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(k(),P("div",ha,[ae(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ue("",!0)])]),n("div",ba,[me(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(k(),P("div",ga,[ae(m,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):ue("",!0)])])}const Zo=Ye(da,[["render",ka],["__scopeId","data-v-1a37a36d"]]),_a=ze({components:{NewPositionTitle:Ho,NewPositionInfo:zo,NewPositionLiquidity:Yo,NewPositionAssetAdd:Go,NewPositionAssetRemove:Jo,NewPositionNotifi:Zo,FarmsPositionDetail:Qo},setup(){const e=q(),t=q(),i=q(),s=Xe(),T=_(()=>s),p=_(()=>T.value.chainName),N=xe(),m=_(()=>N),o=Eo(),l=lo();Ro(()=>{e.value={},N.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),m.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const b=async()=>{m.value.setCurrentPositionLoading(!0);const w=l.currentRoute.value.query.token||"",r=l.currentRoute.value.query.collect||"",$=l.currentRoute.value.query.address||"",v=l.currentRoute.value.query.pos||"",A=l.currentRoute.value.query.id||"",a=l.currentRoute.value.query.positionSource||"",ie=l.currentRoute.value.query.position_nft_id||"";p.value==="Aptos"?w&&r&&$&&m.value.setCurrentPositionInfo($,r,w,p.value):w&&$&&v?m.value.setCurrentPositionInfo($,r,w,p.value,v):A&&!a?m.value.setCurrentPositionInfo("","","",p.value,A):m.value.setCurrentPositionInfo("","","",p.value,ie,a)};ye(()=>m.value.poolConfigObj,w=>{w&&!ve(w)&&b()},{immediate:!0});const u=_(()=>m.value.currentPositionLoading),h=_(()=>{var r,$,v;const w=((v=($=(r=l==null?void 0:l.currentRoute)==null?void 0:r.value)==null?void 0:$.query)==null?void 0:v.address)||"";return w&&m.value.addressLpTokens&&!ve(m.value.addressLpTokens)&&m.value.addressLpTokens[w]?m.value.addressLpTokens[w]:null});ye(()=>h.value,(w,r)=>{w&&!ve(w)&&(e.value=w),w&&!ve(w)&&w.current_sqrt_price!==(r==null?void 0:r.current_sqrt_price)&&b()},{immediate:!0});const H=fo();ye(()=>[m.value.currentPositionInfo,p.value],([w,r])=>{var $;(r=="Aptos"&&w||r=="Sui"&&w&&(w==null?void 0:w.nftHash)==(($=H==null?void 0:H.query)==null?void 0:$.pos))&&(e.value=w,t.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const se=_(()=>m.value.positionDetailCurrentTab),oe=mo(),G=_(()=>oe);_(()=>T.value.theme);const f=_(()=>p.value?eo(p.value):{}),y=()=>{b(),G.value.address&&f.value.getAccount(G.value.address)};return No(()=>{N.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:i,getDetails:b,currentPositionLoading:u,positionDetailCurrentTab:se,clickRefresh:y,chainName:p}}});const wa={class:"new-position-detail"},ya={class:"new-position-content"},Aa={class:"left"},Ia={class:"right"},Ca={class:"loading-global"};function $a(e,t,i,s,T,p){const N=Ho,m=zo,o=Yo,l=Go,b=Jo,u=Qo,h=Zo,H=rn;return k(),P("div",wa,[ae(N,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",ya,[n("div",Aa,[ae(m),ae(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",Ia,[e.positionDetailCurrentTab=="increase"?(k(),Te(l,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(k(),Te(b,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),ae(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(k(),Te(u,{key:2})):ue("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(k(),Te(h,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):ue("",!0)])]),Pe(n("div",Ca,[ae(H)],512),[[Oo,e.currentPositionLoading]])])}const tl=Ye(_a,[["render",$a],["__scopeId","data-v-6efe5ac3"]]);export{tl as default};
