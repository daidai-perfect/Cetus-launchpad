import{m as wo,e as yo,s as Y,a as C,o as Wo,u as vo,d as co,q as Ro,c as oo,k as To}from"./pool.a1878adc.js";import{a as Z,l as r,r as W,e as x,o as n,f as t,h as s,i as y,v,u as $,c as T,w as N,S as Ho,B as go,j as U,p as io,k as lo,s as ko,t as ao,x as B,b as Po,A as fo,F as J,E as no,P as cs,q as $o,z as ho,N as Jo,M as Ao,H as zo,Q as us}from"./entry.be9fee75.js";/* empty css              */import{a as ro,u as Io}from"./sha256.40b7531f.js";import{u as uo}from"./farms.9f2abf06.js";import{R as Fo}from"./farms-range.4b208619.js";import{_ as Qo}from"./apr-tips.f3b476eb.js";import{i as Lo}from"./import-icon.de3e6c66.js";/* empty css              *//* empty css              */import{_ as Go}from"./img-connect-wallet_2x.a725e493.js";import{_ as Ko}from"./img-no-Positions_2x.e119bd5b.js";import{_ as ms}from"./upgrade-loading.71ec2257.js";import{p as ps}from"./precision.a7a6c57b.js";import"./decimal.0bdeb344.js";import"./icon_rewards_2x.f94e1b20.js";/* empty css              */import"./icon-Amount-for-Sale_2x.b2e65df2.js";const _s=Z({setup(){const o=ro(),l=r(()=>o),_=uo(),u=r(()=>_),p=r(()=>(console.log(u.value.farmsRewardObj,"##farmsRewardObj"),Object.values(u.value.farmsRewardObj))),a=r(()=>{const z=p.value.reduce(function(K,A){const O=A&&A.amountUsd?A.amountUsd:0;return Number(O)>.01?Wo(Number(K)).plus(Y(Number(O),2)).toString():Wo(Number(K)).plus(Number(O)).toString()},0);return console.log(u.value.farmsRewardObj,p.value,z,"resultresult67"),z}),i=r(()=>u.value.farmsPositionList),c=r(()=>u.value.farmsAllPositionLoading),g=r(()=>u.value.farmsPoolListLoading),w=Io(),m=wo("Sui"),f=yo("Sui"),{setIsShowSuccess:k,setIsShowRejected:j,setIsShowWaiting:e,setTransactionDesc:E,setTransactionTxid:S}=w,L=W(!1);return{farmsPoolListLoading:g,wallet:l,farms:u,totalRwadrdUsd:a,sFixD:Y,claimAllPoolReward:async z=>{L.value=!0,console.log(i.value,"farmsRewardObj###");const K=[];i.value.forEach(A=>{console.log(z,A,"#position"),A.positionSource=="farming"&&K.push({pool_id:A.pool_id,position_nft_id:A.id})}),console.log(JSON.stringify(K),"##params"),S(""),E("Claim Rewards"),e(!0);try{const A=await m.batchHarvest(K),O=await l.value.currentWallet.signAndExecuteTransactionBlock(A);console.log("0221###sui swap res###",O);let R=f.handleTx(O);if(R&&R.hash){S(R.hash),e(!1),k(!0);let M={res:R.res,title:"Claim",hash:R.hash};f.showTransitionPending(M),await f.watchTransaction(M)&&setTimeout(()=>{_.getFarmsPoolList()},4e3)}else e(!1),j(!0);L.value=!1}catch(A){console.log("Claim all error",A),e(!1),j(!0),L.value=!1}},loading:L,addCommom:C,farmsAllPositionLoading:c}}});const Xo=o=>(io("data-v-d521a357"),o=o(),lo(),o),fs={class:"farms-banner-bg"},vs={class:"farms-banner"},hs={class:"farms-banner-center"},gs=Xo(()=>s("div",{class:"title"},"Farms",-1)),bs=Xo(()=>s("div",{class:"desc"},"Stake your positions to earn higher yield.",-1)),$s={class:"claim-rewards"},ws={class:"claim-title"},ys={key:0,class:"loading-spin"},ks={key:1},Is={key:2},Ss={class:"claim-content"};function Ps(o,l,_,u,p,a){const i=Ho,c=go;return n(),t("div",fs,[s("div",vs,[s("div",hs,[gs,bs,s("div",$s,[s("div",ws,[o.farmsAllPositionLoading||o.farmsPoolListLoading?(n(),t("span",ys,[y(i)])):o.wallet.address?(n(),t("span",ks,v(Number(o.totalRwadrdUsd)>0&&Number(o.totalRwadrdUsd)<.01?"<$0.01":`$${("addCommom"in o?o.addCommom:$(C))(("sFixD"in o?o.sFixD:$(Y))(o.totalRwadrdUsd||0,2))}`),1)):(n(),t("span",Is,"--"))]),s("div",Ss,[o.wallet.address?(n(),T(c,{key:0,class:"claim-btn",loading:o.loading,disabled:Number(o.totalRwadrdUsd)==0||o.farmsAllPositionLoading,onClick:o.claimAllPoolReward},{default:N(()=>[U(" Claim All Rewards ")]),_:1},8,["loading","disabled","onClick"])):(n(),T(c,{key:1,class:"claim-btn",onClick:l[0]||(l[0]=g=>o.wallet.setIsShowWalletModal(!0))},{default:N(()=>[U("Connect")]),_:1}))])])])])])}const Yo=x(_s,[["render",Ps],["__scopeId","data-v-d521a357"]]),Ls=Z({props:{poolInfo:{type:Object,default:()=>({})}},setup(){const o=W(!0);return{sFixD:Y,direct:o}}});const js=o=>(io("data-v-14f67ada"),o=o(),lo(),o),Cs={class:"valid-range"},Os=js(()=>s("div",{class:"title"},"Valid Range",-1));function Us(o,l,_,u,p,a){const i=Fo;return n(),t("div",Cs,[Os,y(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Ts=x(Ls,[["render",Us],["__scopeId","data-v-14f67ada"]]),Rs=Z({props:{poolInfo:{type:Object,default:()=>({})}},setup(){return{}}});const As={class:"pool"},Fs={class:"pool-info"},Ds={class:"token-logo"},Ns={alt:""},Bs={alt:""},Es={class:"token-symbol"},Ms={class:"symbol"},qs={class:"fee-rate"};function Vs(o,l,_,u,p,a){var g,w,m,f;const i=Ts,c=ko("image");return n(),t("div",As,[s("div",Fs,[s("div",Ds,[ao(s("img",Ns,null,512),[[c,(g=o.poolInfo.coinA)==null?void 0:g.logo_url]]),ao(s("img",Bs,null,512),[[c,(w=o.poolInfo.coinB)==null?void 0:w.logo_url]])]),s("div",Es,[s("div",Ms,v((m=o.poolInfo.coinA)==null?void 0:m.symbol)+" - "+v((f=o.poolInfo.coinB)==null?void 0:f.symbol),1),s("div",qs,v(o.poolInfo.fee),1)])]),y(i,{"pool-info":o.poolInfo},null,8,["pool-info"])])}const Zo=x(Rs,[["render",Vs],["__scopeId","data-v-c027f63c"]]),Ws=Z({props:{currentTab:{type:String,default:""},rewardInfo:{type:Object,default:()=>({})}},setup(){const o=vo(),l=r(()=>o);return{sFixD:Y,addCommom:C,getCoinIcon:u=>{var p;return((p=l.value.tokensObj[u])==null?void 0:p.logo_url)||Lo("/image/coins/sui-unknown.png")}}}});const Hs={key:0,class:"rewards-day"},Js={class:"rewards-day-box"},zs={alt:""};function Qs(o,l,_,u,p,a){const i=ko("image");return o.rewardInfo.allocate_point>0||o.currentTab!=="Live"?(n(),t("div",Hs,[s("div",null,[s("div",Js,[ao(s("img",zs,null,512),[[i,o.getCoinIcon(o.rewardInfo.reward_coin)]]),s("span",null,v(("addCommom"in o?o.addCommom:$(C))(("sFixD"in o?o.sFixD:$(Y))(o.rewardInfo.emission_per_day,4)))+" "+v(o.rewardInfo.symbol),1)])])])):B("",!0)}const xo=x(Ws,[["render",Qs],["__scopeId","data-v-48e4e83a"]]),Gs=Z({props:{positionInfo:{type:Object,default:()=>({})}},setup(o){console.log(o.positionInfo,"props.positionInfo");const l=vo(),_=r(()=>l);return{addCommom:C,decimalUi:co,fixD:Ro,getCoinIcon:p=>{var a;return((a=_.value.tokensObj[p])==null?void 0:a.logo_url)||Lo("/image/coins/sui-unknown.png")}}}});const Ks={class:"hover-rewarder"},Xs={class:"rewarder-info"},Ys={class:"left-rewarder"},Zs={alt:""},xs={class:"right-rewarder"},oe={class:"amount"},se={key:0,class:"amount-usd"},ee={key:1,class:"amount-usd"},ne={class:"rewarder-info"},te={class:"left-rewarder"},ae={alt:""},ie={class:"right-rewarder"},le={class:"amount"},re={key:0,class:"amount-usd"},de={key:1,class:"amount-usd"};function ce(o,l,_,u,p,a){const i=ko("image");return n(),t("div",Ks,[s("div",Xs,[s("div",Ys,[ao(s("img",Zs,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinB.address:o.positionInfo.coinA.address)]]),s("span",null,v(o.positionInfo.needReverse?o.positionInfo.coinB.symbol:o.positionInfo.coinA.symbol),1)]),s("div",xs,[s("div",oe,v(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:$(C))(("decimalUi"in o?o.decimalUi:$(co))(o.positionInfo.amountB,o.positionInfo.coinB.decimals)):("addCommom"in o?o.addCommom:$(C))(("decimalUi"in o?o.decimalUi:$(co))(o.positionInfo.amountA,o.positionInfo.coinA.decimals))),1),o.positionInfo.needReverse?(n(),t("div",ee,v(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("fixD"in o?o.fixD:$(Ro))(o.positionInfo.amountBUsd,2):"<$0.01"),1)):(n(),t("div",se,v(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("fixD"in o?o.fixD:$(Ro))(o.positionInfo.amountAUsd,2):"<$0.01"),1))])]),s("div",ne,[s("div",te,[ao(s("img",ae,null,512),[[i,o.getCoinIcon(o.positionInfo.needReverse?o.positionInfo.coinA.address:o.positionInfo.coinB.address)]]),s("span",null,v(o.positionInfo.needReverse?o.positionInfo.coinA.symbol:o.positionInfo.coinB.symbol),1)]),s("div",ie,[s("div",le,v(o.positionInfo.needReverse?("addCommom"in o?o.addCommom:$(C))(("decimalUi"in o?o.decimalUi:$(co))(o.positionInfo.amountA,o.positionInfo.coinA.decimals)):("addCommom"in o?o.addCommom:$(C))(("decimalUi"in o?o.decimalUi:$(co))(o.positionInfo.amountB,o.positionInfo.coinB.decimals))),1),o.positionInfo.needReverse?(n(),t("div",de,v(o.positionInfo.amountAUsd==0?"$0":o.positionInfo.amountAUsd>.01?"$"+("addCommom"in o?o.addCommom:$(C))(("decimalUi"in o?o.decimalUi:$(co))(o.positionInfo.amountAUsd,2)):"<$0.01"),1)):(n(),t("div",re,v(o.positionInfo.amountBUsd==0?"$0":o.positionInfo.amountBUsd>.01?"$"+("addCommom"in o?o.addCommom:$(C))(("decimalUi"in o?o.decimalUi:$(co))(o.positionInfo.amountBUsd,2)):"<$0.01"),1))])])])}const os=x(Gs,[["render",ce],["__scopeId","data-v-0ca1f131"]]),ue=Z({components:{FarmsPositionAmountTips:os},props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const l=ro(),_=r(()=>l);console.log(o.positionInfo,"positionInfo#");const u=uo(),p=r(()=>u),a=yo("Sui"),i=wo("Sui"),c=W(!1),g=Io();r(()=>g);const w=Po(),{setIsShowSuccess:m,setIsShowRejected:f,setIsShowWaiting:k,setTransactionDesc:j,setTransactionTxid:e}=g,E=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,e(""),j(`Stake ${o.positionInfo.name}`),k(!0);const b={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b};console.log(O.value,"##farmsPoolObj.value");const I=O.value[o.positionInfo.clmmPool||o.positionInfo.poolAddress].id;try{const F=await i.farmsDeposit(b,I),V=await _.value.currentWallet.signAndExecuteTransactionBlock(F);console.log("0221###sui swap res###",V),u.setFarmsLoadingObj(o.positionInfo.clmm_pool_id);let q=a.handleTx(V);if(q&&q.hash){e(q.hash),k(!1),m(!0);let eo={res:q.res,title:"Staked",hash:q.hash};a.showTransitionPending(eo),await a.watchTransaction(eo)&&setTimeout(()=>{u.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else k(!1),f(!0)}catch(F){console.log("farmsDeposit error",F),k(!1),f(!0),c.value=!1}},S=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,e(""),j(`Unstake ${o.positionInfo.name}`),k(!0);const b=O.value[o.positionInfo.clmmPool].id,I=o.positionInfo.id;try{const F=await i.farmsWithdraw(b,I),V=await _.value.currentWallet.signAndExecuteTransactionBlock(F);console.log("0221###sui swap res###",V),u.setFarmsLoadingObj(o.positionInfo.clmm_pool_id);let q=a.handleTx(V);if(console.log(q,"unStaketx##"),q&&q.hash){e(q.hash),k(!1),m(!0);let eo={res:q.res,title:"Unstaked",hash:q.hash};a.showTransitionPending(eo),await a.watchTransaction(eo)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),u.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else k(!1),f(!0)}catch(F){console.log("farmsDeposit error",F),k(!1),f(!0),c.value=!1}},L=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,e(""),j("Claim rewards"),k(!0);const b={pool_id:o.positionInfo.farmsPoolId,position_nft_id:o.positionInfo.id};try{const I=await i.harvestFarms(b),F=await _.value.currentWallet.signAndExecuteTransactionBlock(I);u.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",F);let V=a.handleTx(F);if(V&&V.hash){e(V.hash),k(!1),m(!0);let q={title:"Claim",res:V.res,hash:V.hash};a.showTransitionPending(q),await a.watchTransaction(q)&&setTimeout(()=>{u.getPositionByPool(_.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else k(!1),f(!0);c.value=!1}catch(I){console.log("farmsDeposit error",I),k(!1),f(!0),c.value=!1}},H=r(()=>p.value.farmsRewardObj),z=vo(),K=r(()=>z),A=r(()=>p.value.farmsLoadingObj),O=r(()=>p.value.farmsPoolObj);return{sFixD:Y,stake:E,loading:c,unStake:S,router:w,claim:L,farmsRewardObj:H,getCoinIcon:b=>{var I;return((I=K.value.tokensObj[b])==null?void 0:I.logo_url)||Lo("/image/coins/sui-unknown.png")},toPositionDetails:b=>{console.log("toPositionDetails:",b),b.positionSource=="clmm"?w.push(`/new-position-detail?collect=${b.collectionName}&token=${b.name}&address=${b.pool}&pos=${b.pos_object_id}`):w.push(`/new-position-detail?position_nft_id=${b.id}&positionSource=farming`)},farmsLoadingObj:A,addCommom:C}}}),ss=""+globalThis.__publicAssetsURL("sui-image/position-active.png");const jo=o=>(io("data-v-bedebc46"),o=o(),lo(),o),me={class:"farms-position-item"},pe=jo(()=>s("thead",null,[s("tr",null,[s("th",null,"Position"),s("th",null,"Liquidity"),s("th",null,"Earnings"),s("th")])],-1)),_e={class:"position-info"},fe={key:0,class:"status-bg"},ve=jo(()=>s("img",{src:ss,alt:""},null,-1)),he=[ve],ge={class:"status-text"},be={class:"name-range"},$e=jo(()=>s("span",null,"Details",-1)),we=jo(()=>s("svg",{class:"arrow-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_arrow"})],-1)),ye=[$e,we],ke={class:"liquidity"},Ie={class:"rewards-day-box"},Se={alt:""},Pe={key:1,class:"rewards-day"},Le={class:"action-btn"};function je(o,l,_,u,p,a){const i=Fo,c=os,g=go,w=cs,m=ko("image");return n(),t("div",me,[s("table",null,[pe,s("tbody",null,[s("tr",null,[s("td",null,[s("div",_e,[s("div",{class:fo(["position-status",o.positionInfo.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionInfo.positionStatus=="Active"?(n(),t("div",fe,he)):B("",!0),s("div",ge,v(o.positionInfo.positionStatus),1)],2),s("div",be,[s("span",null,v(o.positionInfo.name),1),y(i,{"pool-info":o.positionInfo},null,8,["pool-info"])]),s("div",{class:"details",onClick:l[0]||(l[0]=f=>o.toPositionDetails(o.positionInfo))},ye)])]),s("td",null,[s("div",ke,[s("span",null,[U(v(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:$(C))(("sFixD"in o?o.sFixD:$(Y))(o.positionInfo.positionUSD,2))}`)+" ",1),y(c,{"position-info":o.positionInfo},null,8,["position-info"])])])]),s("td",null,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(J,{key:0},no(o.positionInfo.rewards,f=>(n(),t("div",{key:f.rewarder_type,class:"rewards-day"},[s("div",null,[s("div",Ie,[ao(s("img",Se,null,512),[[m,o.getCoinIcon(f.rewarder_type)]]),s("span",null,v(f.rewarderAmount),1)])])]))),128)):(n(),t("div",Pe,"0"))]),s("td",null,[s("div",Le,[o.positionInfo.positionSource=="clmm"?(n(),t(J,{key:0},[o.positionInfo&&o.positionInfo.positionStatus!=="Active"?(n(),T(w,{key:0},{title:N(()=>[U("Farming rewards are only available for active positions.")]),default:N(()=>[y(g,{class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:N(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"])]),_:1})):(n(),T(g,{key:1,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:N(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"]))],64)):(n(),T(g,{key:1,class:"unstake-btn",onClick:o.unStake},{default:N(()=>[U("Unstake")]),_:1},8,["onClick"])),o.positionInfo.positionSource=="clmm"?(n(),T(g,{key:2,class:"claim-btn",disabled:!0},{default:N(()=>[U("↑ Claim")]),_:1})):(n(),T(g,{key:3,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0,onClick:o.claim},{default:N(()=>[U("↑ Claim")]),_:1},8,["disabled","onClick"]))])])])])])])}const es=x(ue,[["render",je],["__scopeId","data-v-bedebc46"]]),Ce=Z({props:{noDataImg:{type:String,default:""},desc:{type:String,default:""},type:{type:String,default:""},addLiquidityUrl:{type:String,default:""}},setup(){return{walletStore:ro()}}});const Oe={class:"no-data"},Ue=["src"],Te={key:0,class:"desc"};function Re(o,l,_,u,p,a){const i=go;return n(),t("div",Oe,[s("img",{src:o.noDataImg,alt:""},null,8,Ue),o.desc?(n(),t("div",Te,v(o.desc),1)):B("",!0),o.type=="addLiquidity"?(n(),T(i,{key:1,class:"add-liquidity-btn",onClick:l[0]||(l[0]=c=>o.addLiquidityUrl?o.$router.push(o.addLiquidityUrl):"")},{default:N(()=>[U("Add Liquidity")]),_:1})):B("",!0),o.type=="connectWallet"?(n(),T(i,{key:2,class:"add-liquidity-btn",onClick:l[1]||(l[1]=c=>o.walletStore.setIsShowWalletModal(!0))},{default:N(()=>[U("Connect Wallet")]),_:1})):B("",!0)])}const ns=x(Ce,[["render",Re],["__scopeId","data-v-130f9462"]]),Ae=Z({components:{FarmsPositionItem:es},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const l=W({}),_=ro(),u=r(()=>_),p=uo(),a=r(()=>p),i=r(()=>a.value.farmsPoolList),c=r(()=>a.value.farmsPoolList),g=Io(),w=r(()=>g),m=r(()=>w.value.addressLpTokens),f=W([]),k=r(()=>a.value.myFarmsPoolList),j=G=>{console.log(c.value,"###list.value");let Q,X;o.currentTab=="My Farms"&&(Q=u.value.address?k.value:[]),console.log("getPageList:",Q),o.currentTab=="Ended"&&(Q=a.value.farmsPoolList.filter(d=>(console.log(d.status,"##ele.status "),d.status=="Ended"))),o.currentTab=="Live"&&(Q=a.value.farmsPoolList.filter(d=>d.status=="Live")),G=="APR"?X=Q.sort((d,h)=>h.stable_farming.apr-d.stable_farming.apr):X=Q.sort((d,h)=>h.stable_farming.tvl-d.stable_farming.tvl),f.value=X.map(d=>{var h;return console.log(d,"pool###"),{...d,needReverse:d.is_forward===!1,coinA:d.coin_a,coinB:d.coin_b,liquidity:d.tvl_in_usd,vol:d.vol_in_usd_24h,stableFarmingApr:d.stable_farming&&d.stable_farming.apr*100,apr:d.apr_24h.replace("%",""),is_display_rewarder:(h=d==null?void 0:d.rewarder)==null?void 0:h.is_display_rewarder}})};$o(()=>[c.value,o.sortValue,o.currentTab,k.value],([G,Q])=>{console.log(Q,"sortValue326"),G&&G.length>0&&Q&&j(Q)},{immediate:!0});const e=G=>{if(l.value[G.clmm_pool_id])l.value[G.clmm_pool_id]=!1;else{if(l.value[G.clmm_pool_id]=!0,!u.value.address)return!1;console.log("执行了吗"),p.getPositionByPool(u.value.address,G.clmm_pool_id,G.id)}},E=r(()=>a.value.farmsPositionObj),S=r(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),L=r(()=>a.value.farmsUserUsd),H=r(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),z=r(()=>a.value.farmsPositionList),K=r(()=>a.value.farmsAllPositionLoading),A=Po(),O=wo("Sui"),R=yo("Sui"),{setIsShowSuccess:M,setIsShowRejected:b,setIsShowWaiting:I,setTransactionDesc:F,setTransactionTxid:V}=g,q=async G=>{console.log(z.value,"farmsRewardObj###");const Q=[];z.value.forEach(X=>{console.log(G,X,"#position"),G==X.clmm_pool_id&&Q.push({pool_id:X.pool_id,position_nft_id:X.id})}),console.log(JSON.stringify(Q),"##params"),V(""),F("Claim rewards"),I(!0);try{const X=await O.batchHarvest(Q),d=await u.value.currentWallet.signAndExecuteTransactionBlock(X);console.log("0221###sui swap res###",d);let h=R.handleTx(d);if(h&&h.hash){V(h.hash),I(!1),M(!0);let P={res:h.res,title:"Claim",hash:h.hash};R.showTransitionPending(P),await R.watchTransaction(P)&&setTimeout(()=>{p.getFarmsPoolList()},4e3)}else I(!1),b(!0)}catch(X){console.log("Claim all error",X),I(!1),b(!0)}},eo=vo(),to=r(()=>eo),Co=r(()=>(console.log(to.value.poolsObj,"##pools.value.poolsObj"),to.value.poolsObj));r(()=>to.value.tokensObj);const Oo=W({}),po=r(()=>a.value.farmsPoolObj);return console.log(m.value,"addressLpTokens:"),{wallet:u,walletStore:_,farmsPoolList:i,openMore:e,openMoreObj:l,checkNullObj:oo,router:A,farmsPositionObj:E,farmsLoadingObj:S,farmsUserUsd:L,sFixD:Y,farmsRewardObj:H,claimPoolReward:q,farmsAllPositionLoading:K,addCommom:C,addressLpTokens:m,poolsObj:Co,rewardInfoObj:Oo,pageList:f,farmsPoolObj:po}}});const mo=o=>(io("data-v-8bda247e"),o=o(),lo(),o),Fe={class:"farms-table"},De=mo(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px"}})],-1)),Ne={key:0},Be=["onClick"],Ee={class:"staked-tvl"},Me={class:"apr"},qe={key:0,class:"apr-hover-box"},Ve={class:"farms-reward-box"},We={key:0,class:"my-staked"},He={key:0,class:"my-staked-loading"},Je={key:0,class:"position-usd"},ze={key:1,class:"position-usd"},Qe={key:2,class:"position-usd"},Ge={key:3,class:"position-num"},Ke={key:1,class:"my-staked"},Xe=mo(()=>s("div",{class:"position-usd"},"--",-1)),Ye=[Xe],Ze={class:"earned"},xe={key:0,class:"my-staked-loading"},on={key:0,class:"ratio-bg"},sn=mo(()=>s("div",{class:"ratio"},null,-1)),en=[sn],nn={key:1},tn={key:2},an={key:3},ln={key:2},rn={class:"actions"},dn={class:"actions-btn"},cn=["onClick"],un=mo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),mn=[un],pn={colspan:"7",style:{padding:"0 16px 16px"}},_n={key:0,class:"farm-position-list"},fn={key:0,class:"farm-position-loading"},vn={key:1,class:"farm-position-list"},hn=mo(()=>s("tr",{style:{height:"8px"}},null,-1)),gn={key:1},bn={colspan:"7"},$n={key:0,class:"no-data"},wn=mo(()=>s("img",{src:Go,alt:""},null,-1)),yn={key:1,class:"no-data"},kn=mo(()=>s("img",{src:Ko,alt:""},null,-1)),In=mo(()=>s("span",null,"No farms found",-1)),Sn=[kn,In];function Pn(o,l,_,u,p,a){const i=Zo,c=Qo,g=xo,w=Ao,m=go,f=Ho,k=es,j=ns;return n(),t("div",Fe,[s("table",null,[De,o.pageList&&o.pageList.length>0?(n(),t("tbody",Ne,[(n(!0),t(J,null,no(o.pageList,e=>{var E;return n(),t(J,{key:e.id},[s("tr",{onClick:S=>o.openMore(e)},[s("td",null,[y(i,{"pool-info":e},null,8,["pool-info"])]),s("td",null,[s("div",Ee," $"+v(("addCommom"in o?o.addCommom:$(C))(e.stable_farming.tvl,2)),1)]),s("td",null,[s("div",Me,[e.isStableFarming||e.rewarderInfo&&e.rewarderInfo.length>0||(E=e==null?void 0:e.stable_farming)!=null&&E.stable_farming_pool?(n(),t("div",qe,[y(c,{"l-item":e,"rewarder-info":e.rewarder.rewardList,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])])):B("",!0),s("span",null,v((e==null?void 0:e.total_apr)>0&&e.total_apr<1e-4?"<0.01%":`${("addCommom"in o?o.addCommom:$(C))(e.total_apr*100,2)}%`),1)])]),s("td",null,[s("div",Ve,[(n(!0),t(J,null,no(e.rewarders,S=>(n(),T(g,{key:S.reward_coin,"reward-info":S,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("td",null,[o.wallet.address?(n(),t("div",We,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",He,[y(w,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):(n(),t(J,{key:1},[o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount>.01?(n(),t("div",Je,v(Number(o.farmsUserUsd[e.clmm_pool_id].amount)>0&&Number(o.farmsUserUsd[e.clmm_pool_id].amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:$(C))(o.farmsUserUsd[e.clmm_pool_id].amount,2)),1)):o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount>0&&o.farmsUserUsd[e.clmm_pool_id].amount<.01?(n(),t("div",ze," <$0.01 ")):(n(),t("div",Qe,"0")),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Ge,v(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+v(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):B("",!0)],64))])):(n(),t("div",Ke,Ye))]),s("td",null,[s("div",Ze,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",xe,[y(w,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(J,{key:1},[o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd>0?(n(),t("div",on,en)):B("",!0),Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>.01?(n(),t("span",nn,"$"+v(("addCommom"in o?o.addCommom:$(C))(("sFixD"in o?o.sFixD:$(Y))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)>0&&Number(o.farmsRewardObj[e.clmm_pool_id].amountUsd)<.01?(n(),t("span",tn,"<$0.01")):(n(),t("span",an,"0"))],64)):(n(),t("span",ln,"0"))])]),s("td",null,[s("div",rn,[s("div",dn,[y(m,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||!o.farmsRewardObj[e.clmm_pool_id].amountUsd||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0||o.farmsLoadingObj[e.clmm_pool_id],onClick:ho(S=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:N(()=>[U("Claim")]),_:2},1032,["disabled","onClick"]),y(m,{class:"add-liquidity-btn",onClick:ho(S=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:N(()=>[U("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more",onClick:ho(S=>o.openMore(e),["stop"])},[(n(),t("svg",{class:fo(["arrow-icon",o.openMoreObj[e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},mn,2))],8,cn)])])],8,Be),ao(s("tr",null,[s("td",pn,[o.wallet.address?(n(),t("div",_n,[!("checkNullObj"in o?o.checkNullObj:$(oo))(o.farmsLoadingObj)&&o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",fn,[y(f)])):o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length>0?(n(!0),t(J,{key:1},no(o.farmsPositionObj[e.clmm_pool_id],S=>(n(),T(k,{key:S.clmm_position_id,"current-tab":o.currentTab,"position-info":{...S,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"]))),128)):(n(),T(j,{key:2,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"]))])):(n(),t("div",vn,[y(j,{"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"})]))])],512),[[Jo,!("checkNullObj"in o?o.checkNullObj:$(oo))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]]),hn],64)}),128))])):(n(),t("tbody",gn,[s("tr",null,[s("td",bn,[!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",$n,[wn,y(m,{class:"connect-wallet",onClick:l[0]||(l[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:N(()=>[U(v(o.$t("button.connectWallet")),1)]),_:1})])):o.pageList.length==0?(n(),t("div",yn,Sn)):B("",!0)])])]))])])}const ts=x(Ae,[["render",Pn],["__scopeId","data-v-8bda247e"]]),Ln=Z({props:{currentTab:{type:String,default:""}},setup(){const o=W(!1),l=ro(),_=r(()=>l),u=uo(),p=r(()=>u),a=r(()=>p.value.farmsPoolList);return{isShowMore:o,wallet:_,walletStore:l,farmsPoolList:a}}});const as=o=>(io("data-v-f521ea67"),o=o(),lo(),o),jn={class:"farms-table"},Cn=as(()=>s("thead",null,[s("tr",null,[s("th",null,"Pools"),s("th",null,"Staked TVL"),s("th",null,"APR"),s("th",null,"Rewards / day"),s("th",null,"My Staked"),s("th",null,"Earned"),s("th",null,"Actions")]),s("tr",{style:{height:"4px",background:"unset"}})],-1)),On={class:"pool"},Un={class:"staked-tvl"},Tn={class:"apr"},Rn={class:"my-staked"},An={class:"actions"},Fn={class:"actions"},Dn={class:"actions"},Nn=as(()=>s("tr",{style:{height:"8px",background:"unset !important"}},null,-1));function Bn(o,l,_,u,p,a){const i=Ao;return n(),t("div",jn,[s("table",null,[Cn,s("tbody",null,[(n(),t(J,null,no(4,(c,g)=>(n(),t(J,{key:g},[s("tr",null,[s("td",null,[s("div",On,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1}),y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Un,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Tn,[s("span",null,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),s("td",null,[s("div",Rn,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",An,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Fn,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])]),s("td",null,[s("div",Dn,[y(i,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])])]),Nn],64))),64))])])])}const En=x(Ln,[["render",Bn],["__scopeId","data-v-f521ea67"]]),Mn=Z({props:{positionStatus:{type:String,default:"Active"},positionInfo:{type:Object,default:()=>({})}},setup(){return{}}});const qn=o=>(io("data-v-882c76c0"),o=o(),lo(),o),Vn={class:"position-info"},Wn={key:0,class:"status-bg"},Hn=qn(()=>s("img",{src:ss,alt:""},null,-1)),Jn=[Hn],zn={class:"status-text"},Qn={class:"name-range"};function Gn(o,l,_,u,p,a){const i=Fo;return n(),t("div",Vn,[s("div",{class:fo(["position-status",o.positionStatus!=="Active"?"position-status-inactive":""])},[o.positionStatus=="Active"?(n(),t("div",Wn,Jn)):B("",!0),s("div",zn,v(o.positionStatus),1)],2),s("div",Qn,[s("span",null,v(o.positionInfo.name),1),o.positionStatus=="Active"?(n(),T(i,{key:0,"pool-info":o.positionInfo},null,8,["pool-info"])):B("",!0)])])}const Kn=x(Mn,[["render",Gn],["__scopeId","data-v-882c76c0"]]),Xn=Z({props:{positionInfo:{type:Object,default:()=>({})},currentTab:{type:String,default:""}},setup(o){const l=vo(),_=r(()=>l),u=Po(),p=O=>{var R;return((R=_.value.tokensObj[O])==null?void 0:R.logo_url)||Lo("/image/coins/sui-unknown.png")},a=yo("Sui"),i=wo("Sui"),c=W(!1),g=Io(),w=ro(),m=uo(),f=r(()=>w),{setIsShowSuccess:k,setIsShowRejected:j,setIsShowWaiting:e,setTransactionDesc:E,setTransactionTxid:S}=g,L=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,S(""),E("Claim rewards"),e(!0);const O={pool_id:A.value[o.positionInfo.clmmPool].id,position_nft_id:o.positionInfo.id};try{const R=await i.harvestFarms(O),M=await f.value.currentWallet.signAndExecuteTransactionBlock(R);m.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",M);let b=a.handleTx(M);if(b&&b.hash){S(b.hash),e(!1),k(!0);let I={title:"Claim",res:b.res,hash:b.hash};a.showTransitionPending(I),await a.watchTransaction(I)&&setTimeout(()=>{m.getPositionByPool(f.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId)},2e3)}else e(!1),j(!0);c.value=!1}catch(R){console.log("farmsDeposit error",R),e(!1),j(!0),c.value=!1}},H=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,S(""),E(`Unstake ${o.positionInfo.name}`),e(!0);const O=A.value[o.positionInfo.clmmPool].id,R=o.positionInfo.id;try{const M=await i.farmsWithdraw(O,R),b=await f.value.currentWallet.signAndExecuteTransactionBlock(M);m.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",b);let I=a.handleTx(b);if(I&&I.hash){S(I.hash),e(!1),k(!0);let F={res:I.res,title:"Unstaked",hash:I.hash};a.showTransitionPending(F),await a.watchTransaction(F)&&setTimeout(()=>{console.log(o.positionInfo,"##props.positionInfo"),m.getPositionByPool(f.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else e(!1),j(!0)}catch(M){console.log("farmsDeposit error",M),e(!1),j(!0),c.value=!1}},z=async()=>{console.log(o.positionInfo,"props.positionInfo"),c.value=!0,S(""),E(`Stake ${o.positionInfo.name}`),e(!0);const O={clmm_pool_id:o.positionInfo.clmmPool,clmm_position_id:o.positionInfo.pos_object_id,coinTypeA:o.positionInfo.coin_type_a,coinTypeB:o.positionInfo.coin_type_b},R=A.value[o.positionInfo.clmmPool].id;try{const M=await i.farmsDeposit(O,R),b=await f.value.currentWallet.signAndExecuteTransactionBlock(M);m.setFarmsLoadingObj(o.positionInfo.clmm_pool_id),console.log("0221###sui swap res###",b);let I=a.handleTx(b);if(I&&I.hash){S(I.hash),e(!1),k(!0);let F={res:I.res,title:"Staked",hash:I.hash};a.showTransitionPending(F),await a.watchTransaction(F)&&setTimeout(()=>{m.getPositionByPool(f.value.address,o.positionInfo.clmm_pool_id,o.positionInfo.farmsPoolId),c.value=!1},2e3)}else e(!1),j(!0)}catch(M){console.log("farmsDeposit error",M),e(!1),j(!0),c.value=!1}},K=r(()=>m),A=r(()=>K.value.farmsPoolObj);return{getCoinIcon:p,router:u,claim:L,unStake:H,loading:c,stake:z,sFixD:Y,addCommom:C}}});const is=o=>(io("data-v-d5540146"),o=o(),lo(),o),Yn={class:"farms-position"},Zn={class:"farms-position-box"},xn={class:"position-info-block"},ot={class:"block-item"},st=is(()=>s("div",{class:"leabl"},"Liquidity",-1)),et={class:"text"},nt={class:"earnings"},tt={class:"block-item"},at=is(()=>s("div",{class:"leabl"},"Earnings",-1)),it={class:"text"},lt={key:0},rt={alt:""},dt={key:1,class:"rewards-day"},ct={class:"unstake-btn-box"};function ut(o,l,_,u,p,a){const i=Kn,c=go,g=ko("image");return n(),t("div",Yn,[s("div",Zn,[y(i,{"position-info":o.positionInfo},null,8,["position-info"])]),s("div",xn,[s("div",ot,[st,s("div",et,v(o.positionInfo.positionUSD>0&&o.positionInfo.positionUSD<.01?"<$0.01":`~$${("addCommom"in o?o.addCommom:$(C))(("sFixD"in o?o.sFixD:$(Y))(o.positionInfo.positionUSD,2))}`),1)])]),s("div",nt,[s("div",tt,[at,s("div",it,[o.positionInfo.rewards&&o.positionInfo.rewards.length>0?(n(!0),t(J,{key:0},no(o.positionInfo.rewards,w=>(n(),t("div",{key:w.rewarder_type,class:"rewards-day"},[w.rewarderAmount>0?(n(),t("div",lt,[ao(s("img",rt,null,512),[[g,o.getCoinIcon(w.rewarder_type)]]),s("span",null,v(w.rewarderAmount),1)])):B("",!0)]))),128)):(n(),t("div",dt,"--"))])]),o.positionInfo.positionSource=="clmm"?(n(),T(c,{key:0,class:"add-liquidity-btn claim-btn",onClick:l[0]||(l[0]=w=>o.router.push(`/new-position-detail?collect=${o.positionInfo.collectionName}&token=${o.positionInfo.name}&address=${o.positionInfo.pool}&pos=${o.positionInfo.pos_object_id}`))},{default:N(()=>[U("+ Add liquidity")]),_:1})):(n(),T(c,{key:1,class:"claim-btn",disabled:o.positionInfo.positionRewardAmount==0||o.currentTab=="Ended",onClick:o.claim},{default:N(()=>[U("↑ Claim")]),_:1},8,["disabled","onClick"]))]),s("div",ct,[s("div",null,[o.positionInfo.positionSource=="clmm"?(n(),T(c,{key:0,class:"unstake-btn",loading:o.loading,disabled:o.positionInfo.positionStatus!=="Active",onClick:o.stake},{default:N(()=>[U("Stake")]),_:1},8,["loading","disabled","onClick"])):(n(),T(c,{key:1,class:"unstake-btn",onClick:o.unStake},{default:N(()=>[U("Unstake")]),_:1},8,["onClick"]))])])])}const ls=x(Xn,[["render",ut],["__scopeId","data-v-d5540146"]]),mt=Z({components:{FarmsH5Position:ls},props:{currentTab:{type:String,default:""},sortValue:{type:String,default:"APR"}},setup(o){const l=W(!1),_=ro(),u=r(()=>_),p=uo(),a=r(()=>p),i=r(()=>(console.log(a.value.farmsPoolList,"##farms.value.farmsPoolList"),o.currentTab=="My Farms"?u.value.address?a.value.myFarmsPoolList:[]:o.currentTab=="Ended"?a.value.farmsPoolList.filter(d=>d.status=="Ended"):a.value.farmsPoolList.filter(d=>d.status=="Live"))),c=W([]),g=Io(),w=r(()=>g),m=r(()=>w.value.addressLpTokens),f=d=>{const h=i.value.map(P=>{const{stable_farming:D}=m.value[P.clmm_pool_id];return{...P,apr:D.apr,tvl:D.tvl}});d=="APR"?c.value=h.sort((P,D)=>D.apr-P.apr):c.value=h.sort((P,D)=>D.tvl-P.tvl),console.log(c.value,"##farmsPoolList.value")};$o(()=>[i.value,o.sortValue,m.value],([d,h,P])=>{console.log(h,"sortValue326"),d&&d.length>0&&h&&P&&!oo(P)&&f(h)},{immediate:!0});const k=r(()=>a.value.farmsUserUsd),j=r(()=>(console.log(a.value.farmsRewardObj,"##farmsRewardObj"),a.value.farmsRewardObj)),e=r(()=>a.value.farmsPositionObj),E=r(()=>a.value.farmsPoolListLoading),S=r(()=>a.value.farmsPositionList),L=r(()=>(console.log(a.value.farmsLoadingObj,"##farms.value.farmsLoadingObj"),a.value.farmsLoadingObj)),H=r(()=>a.value.farmsAllPositionLoading),z=W({}),K=d=>{if(z.value[d.clmm_pool_id])z.value[d.clmm_pool_id]=!1;else{if(z.value[d.clmm_pool_id]=!0,!u.value.address)return!1;console.log("执行了吗"),p.getPositionByPool(u.value.address,d.clmm_pool_id,d.id)}},A=wo("Sui"),O=yo("Sui"),{setIsShowSuccess:R,setIsShowRejected:M,setIsShowWaiting:b,setTransactionDesc:I,setTransactionTxid:F}=g,V=async d=>{console.log(S.value,"farmsRewardObj###");const h=[];S.value.forEach(P=>{console.log(d,P,"#position"),d==P.clmm_pool_id&&h.push({pool_id:P.pool_id,position_nft_id:P.id})}),console.log(JSON.stringify(h),"##params"),F(""),I("Claim rewards"),b(!0);try{const P=await A.batchHarvest(h),D=await u.value.currentWallet.signAndExecuteTransactionBlock(P);console.log("0221###sui swap res###",D);let _o=O.handleTx(D);if(_o&&_o.hash){F(_o.hash),b(!1),R(!0);let So={res:_o.res,title:"Claim",hash:_o.hash};O.showTransitionPending(So),await O.watchTransaction(So)&&setTimeout(()=>{p.getFarmsPoolList()},4e3)}else b(!1),M(!0)}catch(P){console.log("Claim all error",P),b(!1),M(!0)}},q=Po(),eo=vo(),to=r(()=>eo),Co=r(()=>(console.log(to.value.poolsObj,"##pools.value.poolsObj"),to.value.poolsObj)),Oo=r(()=>to.value.tokensObj),po=W({}),G=(d,h)=>d&&h?ps.plus(To(d),To(h)):d||0,Q=d=>{let h=0;return d&&d.forEach(P=>{h+=To(String(P))}),String(co(String(h),2))},X=(d,h,P)=>{console.log(d,"poolsObj##473"),Object.keys(d).forEach(D=>{var Uo,Do,No;const _o=(Uo=h[D])==null?void 0:Uo.apr_7day,So=G((Do=h[D])==null?void 0:Do.apr_7day,Q((No=h[D])==null?void 0:No.rewarder_apr));po.value[D]={...d[D],apr:String(_o).replace("%",""),aprTotal:So},po.value[D].rewards=[],d[D].rewarderInfo.forEach((ds,Bo)=>{var qo,Vo;const Eo=(qo=P[ds.coinAddress])==null?void 0:qo.symbol,Mo=(Vo=h[D])==null?void 0:Vo.rewarder_apr[Bo];console.log(Eo,Mo,"getRewardInfo:"),console.log(d[D],"## poolsObj[key]"),po.value[D].rewards.push({symbol:Eo,rewarderApr:Mo,rewarder_display:d[D][`rewarder_display${Bo+1}`]})})}),console.log(po.value,"##rewardInfoObj")};return $o(()=>[Co.value,m.value,Oo.value],([d,h,P])=>{d&&!oo(d)&&h&&!oo(h)&&P&&!oo(P)&&X(d,h,P)},{immediate:!0}),{isShowMore:l,wallet:u,farmsPoolList:c,farmsUserUsd:k,sFixD:Y,farmsRewardObj:j,farmsPositionObj:e,openMore:K,checkNullObj:oo,openMoreObj:z,farmsPoolListLoading:E,claimPoolReward:V,router:q,addCommom:C,farmsLoadingObj:L,farmsAllPositionLoading:H,addressLpTokens:m,rewardInfoObj:po}}});const so=o=>(io("data-v-e50cf02b"),o=o(),lo(),o),pt={key:0,class:"farms-pool-list"},_t={class:"farms-block"},ft={class:"item-block"},vt=so(()=>s("div",{class:"leabl"},"Staked TVL",-1)),ht={class:"text"},gt={class:"item-block apr"},bt=so(()=>s("div",{class:"leabl"},"APR",-1)),$t={class:"text"},wt={class:"apr-hover-box"},yt={class:"item-block"},kt=so(()=>s("div",{class:"leabl"},"Rewards / day",-1)),It={class:"text"},St={class:"item-block my-staked"},Pt=so(()=>s("div",{class:"leabl"},"My Staked",-1)),Lt={key:0,class:"text"},jt={class:"position-usd"},Ct={key:0,class:"position-num"},Ot={key:1,class:"text"},Ut=so(()=>s("div",{class:"position-usd"},"--",-1)),Tt=[Ut],Rt={class:"item-block"},At=so(()=>s("div",{class:"leabl"},"Earned",-1)),Ft={class:"text earned-box"},Dt={class:"earned"},Nt={key:0,class:"my-staked-loading"},Bt=so(()=>s("div",{class:"ratio-bg"},[s("div",{class:"ratio"})],-1)),Et={key:0},Mt={key:1},qt={key:2},Vt={key:2},Wt={class:"add-liquidity-box"},Ht=["onClick"],Jt=so(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),zt=[Jt],Qt={key:1,class:"upgrade-loading"},Gt={key:2,class:"no-data"},Kt=so(()=>s("img",{src:Go,alt:""},null,-1)),Xt={key:3,class:"no-data"},Yt=so(()=>s("img",{src:Ko,alt:""},null,-1)),Zt=so(()=>s("span",null,"No Data",-1)),xt=[Yt,Zt];function oa(o,l,_,u,p,a){const i=Zo,c=Qo,g=xo,w=Ao,m=go,f=ls,k=ns,j=ms;return n(),t(J,null,[o.farmsPoolListLoading?o.farmsPoolListLoading?(n(),t("div",Qt,[y(j,{type:"poolsCard",loading:!0})])):B("",!0):(n(),t("div",pt,[(n(!0),t(J,null,no(o.farmsPoolList,e=>{var E,S,L;return n(),t("div",{key:e.id,class:"farms-item"},[y(i,{"pool-info":e},null,8,["pool-info"]),s("div",_t,[s("div",ft,[vt,s("div",ht,"$"+v(("addCommom"in o?o.addCommom:$(C))(e.tvl,2)),1)]),s("div",gt,[bt,s("div",$t,[U(v(e.total_apr>0&&e.total_apr<1e-4?"<0.01%":("addCommom"in o?o.addCommom:$(C))(e.total_apr*100,2))+"% ",1),s("div",wt,[e.isStableFarming||e.rewarderInfo&&e.rewarderInfo.length>0||(E=e==null?void 0:e.stable_farming)!=null&&E.stable_farming_pool?(n(),T(c,{key:0,"l-item":e,"rewarder-info":e.rewarder.rewardList,class:"noHover apr-hover-con"},null,8,["l-item","rewarder-info"])):B("",!0)])])]),s("div",yt,[kt,s("div",It,[(n(!0),t(J,null,no(e.rewarders,H=>(n(),T(g,{key:H.reward_coin,"reward-info":H,"current-tab":o.currentTab},null,8,["reward-info","current-tab"]))),128))])]),s("div",St,[Pt,o.wallet.address?(n(),t("div",Lt,[s("div",jt,v(Number((S=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:S.amount)>0&&Number((L=o.farmsUserUsd[e.clmm_pool_id])==null?void 0:L.amount)<.01?"<$0.01":"$"+("addCommom"in o?o.addCommom:$(C))(o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].amount||0,2)),1),o.farmsUserUsd&&o.farmsUserUsd[e.clmm_pool_id]&&o.farmsUserUsd[e.clmm_pool_id].positionNum?(n(),t("div",Ct,v(o.farmsUserUsd[e.clmm_pool_id].positionNum)+" "+v(o.farmsUserUsd[e.clmm_pool_id].positionNum>1?"Positions":"Position"),1)):B("",!0)])):(n(),t("div",Ot,Tt))]),s("div",Rt,[At,s("div",Ft,[s("div",Dt,[o.farmsLoadingObj[e.clmm_pool_id]||o.farmsAllPositionLoading?(n(),t("div",Nt,[y(w,{class:"upgrade-title-skeleton",loading:!0,active:"",paragraph:!1})])):o.wallet.address&&o.farmsRewardObj&&o.farmsRewardObj[e.clmm_pool_id]&&o.farmsRewardObj[e.clmm_pool_id].amountUsd?(n(),t(J,{key:1},[Bt,o.farmsRewardObj[e.clmm_pool_id].amountUsd>.01?(n(),t("span",Et,"$"+v(("addCommom"in o?o.addCommom:$(C))(("sFixD"in o?o.sFixD:$(Y))(o.farmsRewardObj[e.clmm_pool_id].amountUsd||0,2))),1)):o.farmsRewardObj[e.clmm_pool_id].amountUsd>0&&o.farmsRewardObj[e.clmm_pool_id].amountUsd<.01?(n(),t("span",Mt,"<$0.01")):(n(),t("span",qt,"0"))],64)):(n(),t("span",Vt,"--"))]),y(m,{class:"claim-btn",disabled:!o.wallet.address||!o.farmsRewardObj[e.clmm_pool_id]||o.farmsRewardObj[e.clmm_pool_id].amountUsd<=0,onClick:ho(H=>o.claimPoolReward(e.clmm_pool_id),["stop"])},{default:N(()=>[U("Claim")]),_:2},1032,["disabled","onClick"])])])]),s("div",Wt,[y(m,{class:"add-liquidity-btn",onClick:ho(H=>o.router.push(`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`),["stop"])},{default:N(()=>[U("+ Add liquidity")]),_:2},1032,["onClick"])]),s("div",{class:"more-btn",onClick:H=>o.openMore(e)},[(n(),t("svg",{class:fo(["arrow-icon",!("checkNullObj"in o?o.checkNullObj:$(oo))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]?"open-more":""]),"aria-hidden":"true"},zt,2))],8,Ht),(n(!0),t(J,null,no(o.farmsPositionObj[e.clmm_pool_id],H=>ao((n(),T(f,{key:H.clmm_pool_id,"current-tab":o.currentTab,"position-info":{...H,clmm_pool_id:e.clmm_pool_id}},null,8,["current-tab","position-info"])),[[Jo,!("checkNullObj"in o?o.checkNullObj:$(oo))(o.openMoreObj)&&o.openMoreObj[e==null?void 0:e.clmm_pool_id]]])),128)),o.farmsPositionObj&&o.farmsPositionObj[e.clmm_pool_id]&&o.farmsPositionObj[e.clmm_pool_id].length==0?(n(),T(k,{key:0,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found",type:"addLiquidity","add-liquidity-url":`/liquidity/deposit?poolAddress=${e.clmm_pool_id}`},null,8,["add-liquidity-url"])):B("",!0),o.wallet.address?B("",!0):(n(),T(k,{key:1,"no-data-img":"/sui-image/img-connect-wallet@2x.png",type:"connectWallet"},null,8,["no-data-img"]))])}),128))])),!o.wallet.connected&&o.currentTab=="My Farms"?(n(),t("div",Gt,[Kt,y(m,{class:"connect-wallet",onClick:l[0]||(l[0]=e=>o.wallet.setIsShowWalletModal(!0))},{default:N(()=>[U(v(o.$t("button.connectWallet")),1)]),_:1})])):o.farmsPoolList.length==0?(n(),t("div",Xt,xt)):B("",!0)],64)}const rs=x(mt,[["render",oa],["__scopeId","data-v-e50cf02b"]]),sa=Z({setup(o,l){const _=W("Live"),u=W("TVL"),p=W(!1),a=W(!1),i=uo(),c=r(()=>i),g=ro(),w=r(()=>g),m=r(()=>_.value=="My Farms"?w.value.address?c.value.myFarmsPoolList:[]:_.value=="Ended"?c.value.farmsPoolList.filter(L=>L.status=="Ended"):c.value.farmsPoolList.filter(L=>L.status=="Live")),f=r(()=>c.value.farmsPoolList.filter(L=>L.status=="Ended")),k=r(()=>f.value.length>0?["Live","Ended","My Farms"]:["Live","My Farms"]),j=L=>m.value.length,e=()=>{p.value=!0,i.getFarmsPoolList(),setTimeout(()=>{p.value=!1},1e3)},E=L=>{_.value=L,l.emit("changeTab",L)},S=L=>{u.value=L,l.emit("changeSortValue",L)};return zo(()=>{document.addEventListener("click",()=>{a.value=!1})}),{isOpenList:a,tabList:k,currentTab:_,sortValue:u,clickRefresh:e,isRefresh:p,farmsPoolList:m,getListNum:j,changeTab:E,changeSortValue:S}}});const bo=o=>(io("data-v-29027bb0"),o=o(),lo(),o),ea={class:"farms-tab"},na={class:"tab-left"},ta=["onClick"],aa={key:0},ia={class:"tab-right"},la={class:"sort-select"},ra=bo(()=>s("div",null,"Sort by",-1)),da={class:"showSort"},ca=bo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),ua=bo(()=>s("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),ma=[ua],pa={key:0,class:"sort-list"},_a=bo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),fa=bo(()=>s("svg",{class:"sort-icon","aria-hidden":"true"},[s("use",{"xlink:href":"#icon-icon_on-pool"})],-1)),va={class:"refresh"},ha=bo(()=>s("use",{"xlink:href":"#icon-icon-refresh2"},null,-1)),ga=[ha];function ba(o,l,_,u,p,a){return n(),t("div",ea,[s("div",na,[(n(!0),t(J,null,no(o.tabList,i=>(n(),t("div",{key:i,class:fo(["tab-item",o.currentTab==i?"tab-item-active":""]),onClick:c=>o.changeTab(i)},[s("span",null,v(i=="Ended"?"Finished":i),1),o.currentTab==i&&o.getListNum(i)?(n(),t("p",aa,v(o.getListNum(i)),1)):B("",!0)],10,ta))),128))]),s("div",ia,[s("div",la,[s("div",{class:"sort-select-box",onClick:l[0]||(l[0]=ho(i=>o.isOpenList=!o.isOpenList,["stop"]))},[ra,s("div",da,[s("span",null,v(o.sortValue),1),ca,(n(),t("svg",{class:fo(["arrow-icon",o.isOpenList?"arrow-icon-active":""]),"aria-hidden":"true"},ma,2))])]),o.isOpenList?(n(),t("div",pa,[s("div",{class:"sort-item",onClick:l[1]||(l[1]=i=>o.changeSortValue("APR"))},[U("APR "),_a]),s("div",{class:"sort-item",onClick:l[2]||(l[2]=i=>o.changeSortValue("TVL"))},[U("TVL "),fa])])):B("",!0)]),s("div",va,[(n(),t("svg",{"aria-hidden":"true",class:fo(["refresh-icon",o.isRefresh?"refreshing":""]),onClick:l[3]||(l[3]=(...i)=>o.clickRefresh&&o.clickRefresh(...i))},ga,2))])])])}const $a=x(sa,[["render",ba],["__scopeId","data-v-29027bb0"]]),wa=Z({components:{FarmsBanner:Yo,FarmsTabs:$a,FarmsTable:ts,FarmsH5List:rs},setup(){const o=uo(),l=r(()=>o),_=r(()=>l.value.farmsPoolListLoading),u=W("TVL"),p=r(()=>l.value.farmsPoolList),a=ro(),i=r(()=>a),c=vo(),g=r(()=>c);$o(()=>[i.value.address,p.value,g.value.tokensObj,g.value.RATES],([m,f,k,j])=>{m&&f.length>0&&!oo(k)&&!oo(j)&&o.getPositionByAllPool(m)},{immediate:!0}),zo(()=>{o.getFarmsPoolList()}),$o(()=>i.value.address,m=>{m||o.logOut()},{immediate:!0});const w=W("Live");return{farmsPoolListLoading:_,currentTab:w,sortValue:u}}});const ya={class:"farm-container"},ka={class:"farm-container-center"};function Ia(o,l,_,u,p,a){const i=Yo,c=us("FarmsTabs"),g=ts,w=En,m=rs;return n(),t("div",ya,[y(i),s("div",ka,[y(c,{onChangeTab:l[0]||(l[0]=f=>{o.currentTab=f}),onChangeSortValue:l[1]||(l[1]=f=>{o.sortValue=f})}),o.farmsPoolListLoading?(n(),T(w,{key:1,"current-tab":o.currentTab},null,8,["current-tab"])):(n(),T(g,{key:0,"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])),y(m,{"current-tab":o.currentTab,"sort-value":o.sortValue},null,8,["current-tab","sort-value"])])])}const Wa=x(wa,[["render",Ia],["__scopeId","data-v-656fe488"]]);export{Wa as default};
