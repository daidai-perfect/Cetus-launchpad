import{_ as Lo}from"./back.9a124b5a.js";import{_ as Do}from"./coin-pair-name.77f65ab0.js";import{_ as Eo}from"./status-block.b570d1b0.js";import{a as Fo,_ as Vo}from"./network-tips.05443710.js";import{a as Wo,u as Mo,j as Xo,l as _,h as k,i as F,b as zo,c as Y,T as wo,C as Go,d as bo,g as yo,f as No}from"./import-icon.f4003ec3.js";import{p as x}from"./precision.a7a6c57b.js";import{a as Jo,J as Ko,r,f as U,K as Ho,w as Z,a3 as Qo,G as Yo,h as Zo,o as T,i as L,v as D,j as e,t as i,l as ko,c as Ao,k as io,F as $o,D as Ro,u as h,s as E,x as xo,z as oe,A as ee,I as ne,a4 as se,B as ae,E as ie,p as te,m as le}from"./entry.d72199ba.js";/* empty css              *//* empty css              *//* empty css              */const ue=Jo({setup(){const{t:o,locale:p}=Ko();let ho=r(!1),K=r(!1);const oo=r(!1),Io=()=>{so(),oo.value=!0,setTimeout(()=>{oo.value=!1},1e3)},lo=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],H=Wo(),w=U(()=>H),uo=Mo(),V=r(""),W=r(""),M=r(""),eo=r(""),no=r(""),l=r(""),X=r(""),ro=r(""),So=t=>{let d=t.replace(/[^\d.]/g,"");const g=/^\d+(\.\d+)?$/;d.split(".").length>2&&!g.exec(d)&&(d=d.substr(0,d.length-1)),N.value=d},s=U(()=>uo),m=r({}),v=r({}),n=r(s.value.currentPositionInfo||{}),To=Xo(),Q=U(()=>To),B=Yo();Ho(()=>{Q.value.connected||B.push("/position")});const y=U(()=>w.value.chainName?zo(w.value.chainName):{}),so=async()=>{s.value.setCurrentPositionLoading(!0);const t=B.currentRoute.value.query.token||"",d=B.currentRoute.value.query.collect||"",g=B.currentRoute.value.query.pos||"";w.value.chainName==="Aptos"?t&&d&&(V.value=d,W.value=B.currentRoute.value.query.address,M.value=t,s.value.setCurrentPositionInfo(W.value,V.value,M.value,w.value.chainName),n.value=s.value.currentPositionInfo):g&&(V.value=d,W.value=B.currentRoute.value.query.address,M.value=t,s.value.setCurrentPositionInfo(W.value,V.value,M.value,w.value.chainName,g),n.value=s.value.currentPositionInfo)};Z(()=>s.value.addressLpTokens,t=>{Y(t)||so()},{immediate:!0}),Z(()=>s.value.currentPositionInfo,t=>{t&&(n.value=s.value.currentPositionInfo,m.value=n.value.token_a,v.value=n.value.token_b,co({value:N.value/100}),console.log(n.value,"  positionInfo.valuepositionInfo.value"))});const N=r(50),f=r(0),I=r(0),mo=r(0),vo=U(()=>H.slippage);Z(N,Qo((t,d)=>{Number(t)>100?N.value=100:t&&n.value&&(N.value=t,co({value:N.value/100}))},300)),Z(vo,t=>{t&&n.value&&co({value:N.value/100})});const co=t=>{var b,S;const d=n.value.token_a.decimals,g=n.value.token_b.decimals,P=n.value.tick_lower_index,C=n.value.tick_upper_index,z=wo.tickIndexToSqrtPriceX64(P),G=wo.tickIndexToSqrtPriceX64(C);mo.value=n.value.liquidity*Number(t.value);const $=Go.getCoinAmountFromLiquidity(new bo(mo.value),new bo(n.value.current_sqrt_price),z,G,!0),O=Number($.coinA.toString())/Math.pow(10,d),j=Number($.coinB.toString())/Math.pow(10,g);console.log(O,j,"amountA121212"),f.value=O,I.value=j;const c=(b=s.value.RATES[n.value.token_a.address])==null?void 0:b.price,R=(S=s.value.RATES[n.value.token_b.address])==null?void 0:S.price;console.log(f.value,c,"fromCoinAmount.value"),eo.value=Number(f.value*c)<.01?Number(f.value*c)===0?"0":"<0.01":k(f.value*c,2),no.value=Number(I.value*R)<.01?Number(I.value*R)===0?"0":"<0.01":k(I.value*R,2);const u=x.minus(Number(n.value.amountA),Number(f.value))*c;l.value=Number(u)<.01?Number(u)===0?"0":"<0.01":k(u,2);const a=x.minus(Number(n.value.amountB),Number(I.value))*R;X.value=Number(a)<.01?Number(a)===0?"0":"<0.01":k(a,2);const q=Number(yo(u,2))+Number(yo(a,2));ro.value=Number(q)<.01?Number(q)===0?"0":"<0.01":k(q,2)},{setIsShowSuccess:Co,setIsShowRejected:go,setIsShowWaiting:ao,setTransactionDesc:Oo,setTransactionTxid:_o,setPositiomNum:mn,setTransactionDescText:jo}=H,qo=async()=>{var d,g,P,C,z,G,$,O,j,c,R;K.value=!0,_o(""),Oo(o("tips.removeLiquidiyText",{from:k(f.value,m.value.decimals)==0?"":`${_(f.value,m.value.decimals)} ${m.value.symbol}`,and:k(f.value,m.value.decimals)==0||k(I.value,v.value.decimals)==0?"":"and",to:k(I.value,v.value.decimals)==0?"":`${_(I.value,v.value.decimals)} ${v.value.symbol}`})),ao(!0);const t=A.value&&A.value.length>0?o("modal.removeLiquidityText1"):o("modal.removeLiquidityText2");jo(t);try{let u={};u={pool:{...n.value.poolInfo,coinA:n.value.token_a,coinB:n.value.token_b},coinTypeA:n.value.poolInfo.coinTypeA,coinTypeB:n.value.poolInfo.coinTypeB,position:n.value,delta_liquidity:new bo(No(mo.value,0)),slippage:Number(vo.value),rewards_num:A.value.length};const a=A.value;console.log(A,"===>pendingRewarderArr"),u.coinTypeC=a[0]?a[0].coin_address:"",u.coinTypeD=a[1]?a[1].coin_address:"",u.coinTypeE=a[2]?a[2].coin_address:"",console.log(u,"===>params");const q=await y.value.getRemoveLiquidityTransactionPayload(u);let b;if(w.value.chainName==="Aptos")b=await Q.value.currentWallet.signAndSubmitTransaction(q);else{const S=await Q.value.currentWallet.signAndExecuteTransaction(q);b=y.value.handleTx(S)}if(b&&b.hash){_o(b.hash),ao(!1),Co(!0);const S={title:o("common.removeLiquidity"),desc:"",hash:b.hash,descTransactions:`Remove ${f.value} ${(d=m.value)==null?void 0:d.symbol} and ${I.value} ${(g=v.value)==null?void 0:g.symbol} 
             from the pool`,sender:Q.value.address,chainName:w.value.chainName,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${(P=m.value)==null?void 0:P.symbol}`,numa:`+ ${f.value}`,logoa:s.value.tokensObj&&m.value&&m.value.address&&s.value.tokensObj[m.value.address]&&s.value.tokensObj[m.value.address].logoURI,tokenb:`${(C=v.value)==null?void 0:C.symbol}`,numb:`+ ${I.value}`,logob:s.value.tokensObj&&v.value&&v.value.address&&s.value.tokensObj[v.value.address]&&s.value.tokensObj[v.value.address].logoURI},text:`Withdraw ${f.value} ${(z=m.value)==null?void 0:z.symbol} and ${I.value} ${(G=v.value)==null?void 0:G.symbol}`};y.value.showTransitionPending(S);const J=await y.value.watchTransaction(S);if(A.value&&A.value.length>0&&(Number(($=a[0])==null?void 0:$.amount)!==0||u.coinTypeD&&Number((O=a[1])==null?void 0:O.amount)!==0||u.coinTypeE&&Number((j=a[2])==null?void 0:j.amount)!==0)){const po={title:o("common.removeLiquidity"),desc:"",hash:b.hash,tit:"Bonus Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:a[0].symbol,numa:`+ ${Number(a[0].amount)}`,logoa:s.value.tokensObj&&a[0]&&a[0].address&&s.value.tokensObj[a[0].address]&&s.value.tokensObj[a[0].address].logoURI,tokenb:u.coinTypeD?a[1].symbol:"",numb:u.coinTypeD?`+ ${Number(a[1].amount)}`:"",logob:u.coinTypeD?s.value.tokensObj&&a[1]&&a[1].address&&s.value.tokensObj[a[1].address]&&s.value.tokensObj[a[1].address].logoURI:"",tokenc:u.coinTypeE?a[2].symbol:"",numc:u.coinTypeE?`+ ${Number(a[2].amount)}`:"",logoc:u.coinTypeE?s.value.tokensObj&&a[2]&&a[2].address&&s.value.tokensObj[a[2].address]&&s.value.tokensObj[a[2].address].logoURI:""},text:`Withdraw ${f.value} ${(c=m.value)==null?void 0:c.symbol} and ${I.value} ${(R=v.value)==null?void 0:R.symbol}`},fo=await y.value.setTransations(po);console.log("9999transitionStatusFees",J,fo)}if(_(n.value.feeOwedA,n.value.token_a.decimals)!==0||_(n.value.feeOwedB,n.value.token_b.decimals)!==0){const po={title:"Claim",desc:"",hash:b.hash,chainName:w.value.chainName,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${n.value.token_a.symbol}`,numa:k(n.value.feeOwedA,n.value.token_a.decimals)==0?"":`+ ${_(n.value.feeOwedA,n.value.token_a.decimals)}`,logoa:k(n.value.feeOwedA,n.value.token_a.decimals)==0?"":s.value.tokensObj&&n.value&&n.value.token_a.address&&s.value.tokensObj[n.value.token_a.address]&&s.value.tokensObj[n.value.token_a.address].logoURI,tokenb:`${n.value.token_b.symbol}`,numb:k(n.value.feeOwedB,n.value.token_b.decimals)==0?"":`+ ${_(n.value.feeOwedB,n.value.token_b.decimals)}`,logob:k(n.value.feeOwedB,n.value.token_b.decimals)==0?"":s.value.tokensObj&&n.value&&n.value.token_b.address&&s.value.tokensObj[n.value.token_b.address]&&s.value.tokensObj[n.value.token_b.address].logoURI}},fo=await y.value.setTransations(po);console.log("9999transitionStatusFees",J,fo)}J&&(setTimeout(()=>{so()},3e3),setTimeout(()=>{so()},6e3),Number(N.value)==100&&B.push("/position"))}else ao(!1),go(!0);K.value=!1}catch(u){console.log("Remove error",u),K.value=!1,ao(!1),go(!0)}},Bo=U(()=>s.value.tokensObj&&m.value.address&&s.value.tokensObj[m.value.address]&&s.value.tokensObj[m.value.address].logoURI),Po=U(()=>s.value.tokensObj&&v.value.address&&s.value.tokensObj[v.value.address]&&s.value.tokensObj[v.value.address].logoURI),Uo=r(0),A=r([]);return Z(()=>[n.value,s.value.addressLpTokens,s.value.newTokenObj,s.value.RATES],async([t,d,g,P])=>{if(!Y(t)&&!Y(d)&&!Y(g)&&!Y(P)){const C=d[t.poolAddress];console.log(C,"===>pool");const z=await y.value.getTickDataByIndex(C.ticks_handle,Number(t.tick_lower_index)),G=await y.value.getTickDataByIndex(C.ticks_handle,Number(t.tick_upper_index));let $={};w.value.chainName==="Aptos"?$=await y.value.getPosRewardersAmount({poolAddress:t.poolAddress,positionName:t.tokenName,tickLowerData:z,tickUpperData:G}):$=await y.value.getPosRewardersAmount({poolAddress:t.poolAddress,pos:t.pos_object_id});const O=[];let j=0;$.forEach((c,R)=>{if(n.value.poolInfo[`rewarder_display${R+1}`]){const u=g[c.coin_address].decimals,a=g[c.coin_address],q=Number(c.amount_owed.toString())>99999999999999?0:Number(c.amount_owed.toString());console.log(c.amount_owed.toString(),"===>element.amount_owed.toString()");const b=q/Math.pow(10,u),S=P[c.coin_address].price,J=b*S;j+=J,O.push({...c,...a,amount:b,amountUSD:J})}}),A.value=O,Uo.value=Number(No(j,2))}},{immediate:!0}),{removeAmountARates:l,removeAmountBRates:X,removeAmountRates:ro,receiveAmountARates:eo,receiveAmountBRates:no,showNum:_,fromCoinUrl:Bo,toCoinUrl:Po,precision:x,addCommom:k,loading:K,wallet:Q,toRemove:qo,fromCoinAmount:f,toCoinAmount:I,pools:s,refresh:oo,amountArr:lo,sliderVal:N,positionInfo:n,slippage:vo,importIcon:F,clickRefresh:Io,isShowSwapSetting:ho,pendingRewarderArr:A,changeValue:So}}});const to=o=>(te("data-v-78ecb289"),o=o(),le(),o),re={class:"remove-liquidity"},de={class:"remove-liquidity-top"},me={class:"remove-title"},ve={class:"right title-right"},ce=to(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),pe=to(()=>e("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),fe=[pe],be={class:"remove-liquidity-center"},ke={class:"top"},he={class:"left"},Ie={class:"right"},ge={class:"fee"},_e={class:"bottom"},we={class:"add-amount"},ye={class:"add-amount-header"},Ne={class:"amount-list"},Ae=["onClick"],$e={class:"slider-box"},Re={class:"receive"},Se={class:"receiveTit"},Te={class:"item"},Ce={class:"left"},Oe=["src"],je={class:"right"},qe={class:"item"},Be={class:"left"},Pe=["src"],Ue={class:"right"},Le={class:"remove-liquidity-bottom-box"},De={class:"induction remove-liquidity-bottom"},Ee={class:"item"},Fe={class:"induction-text"},Ve={class:"induction-value"},We=["src"],Me=to(()=>e("div",{class:"induction-text"},null,-1)),Xe={class:"induction-value"},ze=["src"],Ge={class:"induction-text"},Je={class:"induction-value"},Ke=["src"],He=to(()=>e("svg",{"aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon-Remove"})],-1)),Qe={key:0,class:"receive"},Ye={class:"receiveTit"},Ze={class:"left"},xe={class:"right"},on={class:"item"},en={class:"left"},nn=["src"],sn={class:"right"},an={class:"item"},tn={class:"left"},ln=["src"],un={class:"right"},rn={class:"loading-global"};function dn(o,p,ho,K,oo,Io){const lo=Lo,H=Do,w=Eo,uo=ne,V=se,W=ae,M=Fo,eo=Vo,no=ie;return T(),L("div",re,[D(lo),e("div",de,[e("div",me,i(o.$t("common.removeLiquidity")),1),e("div",ve,[e("div",{class:"slippage-icon",onClick:p[0]||(p[0]=l=>o.isShowSwapSetting=!0)},[ce,e("span",null,i(o.slippage)+"%",1)]),(T(),L("svg",{"aria-hidden":"true",class:ko(o.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:p[1]||(p[1]=(...l)=>o.clickRefresh&&o.clickRefresh(...l))},fe,2))])]),e("div",be,[e("div",ke,[e("div",he,[o.positionInfo?(T(),Ao(H,{key:0,"from-coin":o.positionInfo.token_a,"to-coin":o.positionInfo.token_b},null,8,["from-coin","to-coin"])):io("",!0),e("div",Ie,[e("div",ge,i(o.positionInfo.fee*100)+"%",1)])]),D(w,{"current-status":o.positionInfo.currentStatus||""},null,8,["current-status"])]),e("div",_e,[e("div",we,[e("div",ye,[e("span",null,i(o.$t("common.amount")),1),e("div",Ne,[(T(!0),L($o,null,Ro(o.amountArr,(l,X)=>(T(),L("div",{key:X,class:ko(["amount-item",o.sliderVal==l.value?"amount-item-active":""]),onClick:ro=>o.sliderVal=l.value},i(l.name),11,Ae))),128))])]),e("div",$e,[D(uo,{value:o.sliderVal,"onUpdate:value":p[2]||(p[2]=l=>o.sliderVal=l),suffix:"%",onChange:p[3]||(p[3]=l=>o.changeValue(l.target.value))},null,8,["value"]),D(V,{value:o.sliderVal,"onUpdate:value":p[4]||(p[4]=l=>o.sliderVal=l)},null,8,["value"])])])])]),e("div",Re,[e("div",Se,i(o.$t("newAdd.receive")),1),e("div",Te,[e("div",Ce,[e("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:h(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,Oe),e("span",null,i(("showNum"in o?o.showNum:h(_))(o.fromCoinAmount,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),E(" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",je,"≈ $"+i(o.receiveAmountARates),1)]),e("div",qe,[e("div",Be,[e("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:h(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,Pe),e("span",null,i(("showNum"in o?o.showNum:h(_))(o.toCoinAmount,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),E(" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",Ue,"≈ $"+i(o.receiveAmountBRates),1)])]),e("div",Le,[e("div",De,[e("div",Ee,[e("div",Fe,i(o.$t("common.fees")),1),e("div",Ve,[e("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:h(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,We),E(" "+i(("showNum"in o?o.showNum:h(_))(o.positionInfo&&o.positionInfo.feeOwedA,o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals))+" ",1),e("span",null,i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol),1)])]),e("div",{class:ko(o.pendingRewarderArr.length>0?"item item-boder":"item")},[Me,e("div",Xe,[e("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:h(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,ze),E(" "+i(("showNum"in o?o.showNum:h(_))(o.positionInfo&&o.positionInfo.feeOwedB,o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals))+" ",1),e("span",null,i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol),1)])],2),o.positionInfo.is_display_rewarder?(T(!0),L($o,{key:0},Ro(o.pendingRewarderArr,(l,X)=>(T(),L("div",{key:l,class:"item"},[e("div",Ge,i(X==0?o.$t("common.rewards"):""),1),e("div",Je,[e("img",{src:l.logoURI},null,8,Ke),E(" "+i(l.amount>1e-6?l.amount:l.amount===0?"0":"<0.000001")+" ",1),e("span",null,i(l.symbol),1)])]))),128)):io("",!0)])]),D(W,{disabled:o.wallet.connected?Number(o.sliderVal)==0||o.loading:!1,class:"remove-btn big-btn",onClick:p[5]||(p[5]=l=>o.wallet.connected?o.toRemove():o.wallet.setIsShowWalletModal(!0))},{default:xo(()=>[He,e("span",null,i(o.wallet.connected?o.$t("button.remove"):o.$t("button.connectWallet")),1)]),_:1},8,["disabled"]),D(M),o.sliderVal<100?(T(),L("div",Qe,[e("div",Ye,[e("div",Ze,i(o.$t("newAdd.remainingPosition")),1),e("div",xe,"$"+i(o.removeAmountRates),1)]),e("div",on,[e("div",en,[e("img",{src:o.fromCoinUrl||("importIcon"in o?o.importIcon:h(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol.toLowerCase()}.png`)},null,8,nn),e("span",null,i(("showNum"in o?o.showNum:h(_))(("precision"in o?o.precision:h(x)).minus(Number(o.positionInfo.amountA),Number(o.fromCoinAmount)),o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.decimals)),1),E(" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.symbol)+" "+i(o.positionInfo&&o.positionInfo.token_a&&o.positionInfo.token_a.labels&&o.positionInfo.token_a.labels[0]?`(${o.positionInfo.token_a.labels[0]})`:""),1)]),e("div",sn,"≈ $"+i(o.removeAmountARates),1)]),e("div",an,[e("div",tn,[e("img",{src:o.toCoinUrl||("importIcon"in o?o.importIcon:h(F))(`/image/coins/${o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol.toLowerCase()}.png`)},null,8,ln),e("span",null,i(("showNum"in o?o.showNum:h(_))(("precision"in o?o.precision:h(x)).minus(Number(o.positionInfo.amountB),Number(o.toCoinAmount)),o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.decimals)),1),E(" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.symbol)+" "+i(o.positionInfo&&o.positionInfo.token_b&&o.positionInfo.token_b.labels&&o.positionInfo.token_b.labels[0]?`(${o.positionInfo.token_b.labels[0]})`:""),1)]),e("div",un,"≈ $"+i(o.removeAmountBRates),1)])])):io("",!0),o.isShowSwapSetting?(T(),Ao(eo,{key:1,onOnClose:p[6]||(p[6]=l=>o.isShowSwapSetting=!1)})):io("",!0),oe(e("div",rn,[D(no)],512),[[ee,o.pools.currentPositionLoading]])])}const wn=Zo(ue,[["render",dn],["__scopeId","data-v-78ecb289"]]);export{wn as default};
