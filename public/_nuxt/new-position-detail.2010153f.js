import{_ as en}from"./back.7088658d.js";import{_ as on}from"./swap-setting.b3f8da36.js";import{b as Xe,u as eo,c as oo,g as ko,p as Co,d as nn}from"./pool.9a5cddd3.js";import{a as Ye,r as N,m as y,e as ze,o as w,f as S,h as n,v as W,c as $e,x as me,p as ao,k as lo,E as Ro,G as ye,b as ro,i as re,z as fo,y as Oo,t as Te,H as qo,W as po,q as yo,u as G,j as fe,w as Le,Q as Lo,l as Io,$ as tn,U as Je,V as sn,a4 as $o,J as So,F as xe,s as io,B as mo,Y as an,a5 as ln,a6 as rn,O as Bo,a2 as un,S as dn}from"./entry.17136172.js";import{i as pe,w as cn,x as mn,b as _e,g as Q,k as Ue,u as vo,B as Pe,m as qe,D as Mo,E as Uo,T as Po,G as vn}from"./index.0a5fc01d.js";import{_ as ho}from"./token-warning.7d4c078a.js";import{_ as jo}from"./status-block.534c08bd.js";import{s as co,m as fn,l as pn,b as hn,a as bn}from"./transform.c672907f.js";import{D as g}from"./decimal.0bdeb344.js";/* empty css              */import{i as so}from"./import-icon.de3e6c66.js";import"./index.e0495629.js";import{_ as Eo}from"./coin-lock.7600613c.js";import{_ as bo}from"./assets-card.e1746b76.js";import{_ as gn,a as kn,b as _n}from"./icon-Add-Liquidity_2x.5386e034.js";/* empty css              */import{u as Do}from"./notifi.4ec80099.js";import{_ as wn}from"./apr-tips.d9e2e1a6.js";import{u as Fo}from"./farms.f6dc0129.js";/* empty css              *//* empty css              *//* empty css              */import"./icon-warning_2x.b7e0b348.js";import"./icon-error_2x.d68fff20.js";import"./img-lock_2x.a28135f4.js";import"./useDebounceFunction.2cbd4481.js";import"./useWhale.3afc9c51.js";import"./icon_fee_2x.39cfdf5e.js";import"./icon_rewards_2x.c31123d8.js";const _o=Math.PI,wo=2*_o,Ve=1e-6,yn=wo-Ve;function Wo(e){this._+=e[0];for(let t=1,s=e.length;t<s;++t)this._+=arguments[t]+e[t]}function In(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Wo;const s=10**t;return function(a){this._+=a[0];for(let P=1,p=a.length;P<p;++P)this._+=Math.round(arguments[P]*s)/s+a[P]}}class An{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Wo:In(t)}moveTo(t,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,s){this._append`L${this._x1=+t},${this._y1=+s}`}quadraticCurveTo(t,s,a,P){this._append`Q${+t},${+s},${this._x1=+a},${this._y1=+P}`}bezierCurveTo(t,s,a,P,p,T){this._append`C${+t},${+s},${+a},${+P},${this._x1=+p},${this._y1=+T}`}arcTo(t,s,a,P,p){if(t=+t,s=+s,a=+a,P=+P,p=+p,p<0)throw new Error(`negative radius: ${p}`);let T=this._x1,d=this._y1,o=a-t,m=P-s,c=T-t,r=d-s,k=c*c+r*r;if(this._x1===null)this._append`M${this._x1=t},${this._y1=s}`;else if(k>Ve)if(!(Math.abs(r*o-m*c)>Ve)||!p)this._append`L${this._x1=t},${this._y1=s}`;else{let B=a-T,ne=P-d,te=o*o+m*m,z=B*B+ne*ne,f=Math.sqrt(te),I=Math.sqrt(k),L=p*Math.tan((_o-Math.acos((te+k-z)/(2*f*I)))/2),i=L/I,A=L/f;Math.abs(i-1)>Ve&&this._append`L${t+i*c},${s+i*r}`,this._append`A${p},${p},0,0,${+(r*B>c*ne)},${this._x1=t+A*o},${this._y1=s+A*m}`}}arc(t,s,a,P,p,T){if(t=+t,s=+s,a=+a,T=!!T,a<0)throw new Error(`negative radius: ${a}`);let d=a*Math.cos(P),o=a*Math.sin(P),m=t+d,c=s+o,r=1^T,k=T?P-p:p-P;this._x1===null?this._append`M${m},${c}`:(Math.abs(this._x1-m)>Ve||Math.abs(this._y1-c)>Ve)&&this._append`L${m},${c}`,a&&(k<0&&(k=k%wo+wo),k>yn?this._append`A${a},${a},0,1,${r},${t-d},${s-o}A${a},${a},0,1,${r},${this._x1=m},${this._y1=c}`:k>Ve&&this._append`A${a},${a},0,${+(k>=_o)},${r},${this._x1=t+a*Math.cos(p)},${this._y1=s+a*Math.sin(p)}`)}rect(t,s,a,P){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+s}h${a=+a}v${+P}h${-a}Z`}toString(){return this._}}function to(e){return function(){return e}}function Cn(e){let t=3;return e.digits=function(s){if(!arguments.length)return t;if(s==null)t=null;else{const a=Math.floor(s);if(!(a>=0))throw new RangeError(`invalid digits: ${s}`);t=a}return e},()=>new An(t)}function $n(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ho(e){this._context=e}Ho.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Sn(e){return new Ho(e)}function Pn(e){return e[0]}function Tn(e){return e[1]}function Nn(e,t){var s=to(!0),a=null,P=Sn,p=null,T=Cn(d);e=typeof e=="function"?e:e===void 0?Pn:to(e),t=typeof t=="function"?t:t===void 0?Tn:to(t);function d(o){var m,c=(o=$n(o)).length,r,k=!1,B;for(a==null&&(p=P(B=T())),m=0;m<=c;++m)!(m<c&&s(r=o[m],m,o))===k&&((k=!k)?p.lineStart():p.lineEnd()),k&&p.point(+e(r,m,o),+t(r,m,o));if(B)return p=null,B+""||null}return d.x=function(o){return arguments.length?(e=typeof o=="function"?o:to(+o),d):e},d.y=function(o){return arguments.length?(t=typeof o=="function"?o:to(+o),d):t},d.defined=function(o){return arguments.length?(s=typeof o=="function"?o:to(!!o),d):s},d.curve=function(o){return arguments.length?(P=o,a!=null&&(p=P(a)),d):P},d.context=function(o){return arguments.length?(o==null?a=p=null:p=P(a=o),d):a},d}function To(){}function Xo(e){this._context=e}Xo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Rn(e){return new Xo(e)}const On=Ye({setup(){const e=Xe(),t=N(!1),s=y(()=>e);return{slippage:y(()=>s.value.slippage),isShowSwapSetting:t}}});const qn=e=>(ao("data-v-82585f8b"),e=e(),lo(),e),Ln=qn(()=>n("svg",{class:"icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1));function Bn(e,t,s,a,P,p){const T=on;return w(),S("div",{class:"slippage-icon",onClick:t[1]||(t[1]=d=>e.isShowSwapSetting=!0)},[Ln,n("span",null,W(e.slippage)+"%",1),e.isShowSwapSetting?(w(),$e(T,{key:0,onOnClose:t[0]||(t[0]=d=>e.isShowSwapSetting=!1)})):me("",!0)])}const Mn=ze(On,[["render",Bn],["__scopeId","data-v-82585f8b"]]),Un=Ye({props:{poolInfo:{type:Object,default:()=>({})}},setup(e,t){const s=N(!1),a=N(null),P=N(0),p=N(20),T=eo(),d=Xe(),o=N(!1);Ro(()=>{clearInterval(a.value)});const m=()=>{a.value=setInterval(()=>{var z;o.value||P.value<p.value&&(P.value+=1,P.value===p.value&&((z=e==null?void 0:e.poolInfo)!=null&&z.poolAddress&&T.updateCurrentPools(e.poolInfo.poolAddress,d.chainName),P.value=0))},1e3)},c=y(()=>d.slippage),r=()=>{t.emit("clearAll")},k=N(!1),B=()=>{P.value=0,k.value=!0,t.emit("clickRefresh"),setTimeout(()=>{k.value=!1},1e3)};ye(()=>e.poolInfo,z=>{z&&!a.value&&m()},{immediate:!0});const ne=ro(),te=y(()=>d.chainName);return{clickRefresh:B,isShowSwapSetting:s,countdown:P,autoRefreshTime:p,slippage:c,clearAll:r,checkNullObj:pe,router:ne,loading:o,chainName:te,refresh:k}}});const jn=e=>(ao("data-v-ca768f9b"),e=e(),lo(),e),En={class:"new-position-title"},Dn={class:"left"},Fn={class:"right"},Wn=jn(()=>n("use",{"xlink:href":"#icon-icon-refresh"},null,-1)),Hn=[Wn];function Xn(e,t,s,a,P,p){const T=en,d=Mn;return w(),S("div",En,[n("div",Dn,[re(T)]),n("div",Fn,[re(d),(w(),S("svg",{"aria-hidden":"true",class:fo(e.refresh?"refresh refresh-icon ":"refresh-icon"),onClick:t[0]||(t[0]=(...o)=>e.clickRefresh&&e.clickRefresh(...o))},Hn,2))])])}const Yo=ze(Un,[["render",Xn],["__scopeId","data-v-ca768f9b"]]);function No(e,t,s){const a=new g(10).pow(t-s);return new g(1.0001).pow(e).mul(a)}const Yn=Ye({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,t){const s=N(1),a=N(""),P=N(""),p=y(()=>{var i,A,v;return r.sqrtPriceX64ToPrice((i=e.poolInfo)==null?void 0:i.current_sqrt_price,(A=e.poolInfo)==null?void 0:A.coinA.decimals,(v=e.poolInfo)==null?void 0:v.coinB.decimals).toString()}),T=y(()=>{let i=0;return e.direction?i=(Number(e.minPrice)/Number(p.value)-1)*100:i=(Number(e.minPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),d=y(()=>{let i=0;return e.direction?i=(Number(e.maxPrice)/Number(p.value)-1)*100:i=(Number(e.maxPrice)/Number(1/Number(p.value))-1)*100,i=i>0&&i<.1?.1:i,i=i<0&&i>-.1?-.1:i,i}),o=Xe(),m=y(()=>o),c=y(()=>m.value.chainName?oo(m.value.chainName):{}),{TickMath:r,getNearestTickByTick:k}=c.value,B=()=>{const i=s.value/2;s.value=i,z(e.poolInfo,i)},ne=()=>{const i=s.value*2;s.value=i,z(e.poolInfo,i)},te=(i=[])=>{let A=6;const v=Math.abs(Number(i[0])-Number(i[i.length-1]));return v>=6?A=0:v>=1?A=1:v>=.1?A=2:v>=.01?A=3:v>=.001?A=4:v>=1e-4?A=5:v>=1e-5?A=6:v>=1e-6?A=7:v>=1e-7&&(A=8),A},z=(i,A=1)=>{if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:189 ~ dataProcessing ~ zooms:",A),i&&i.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){const v=Number(e.poolInfo.current_tick_index);let _=v+100*A,l=v-100*A,ie,Z;if(e.maxPrice==="âˆž")Z=c.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?Z=r.priceToTickIndex(new g(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):Z=r.priceToTickIndex(new g(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{Z=443636}if(e.minPrice==="0")ie=c.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?ie=r.priceToTickIndex(new g(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):ie=r.priceToTickIndex(new g(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{ie=-443636}let se=0;if(e.currentPriceTab!=="full range"){if(v>=ie&&v<=Z){const j=v-ie,ke=Z-v;se=Math.max(Math.abs(j),Math.abs(ke))}else v<ie?se=Math.abs(Z-v):se=Math.abs(v-ie);_=v+se+20*A,l=v-se-20*A}else{const j=(Math.abs(v)>5e3,2e4);_=v+j*A,l=v-j*A}l<-443636&&(l=-443636),_>443636&&(_=443636);const H=new g(i.liquidity).div(Math.pow(10,8)).toString(),C=e.tickList,U=[],R=[];let X={};for(let j=0;j<C.length;j++){if(X=C[j],X.index<=v&&X.index>=l){if(U.length<1&&j!==0){const ke=C[j-1];U.unshift({...ke,index:l})}U.unshift(X)}else if(X.index>v&&X.index<=_&&(R.push(X),U.length<1&&j!==0)){const ke=C[j-1];U.push({...ke,index:l})}if(X.index>_){const ke=C[j];if(R.push({...ke,index:_}),U.length<1&&j!==0){const Ie=C[j-1];U.push({...Ie,index:l})}break}}let ee="0";for(let j=U.length-1;j>=0;j--)ee=new g(ee).plus(new g(U[j].liquidityNet.toString()).div(Math.pow(10,8))).toString(),U[j].liquityAmount=ee;let J=H;for(let j=0;j<R.length;j++)J=new g(J).plus(new g(R[j].liquidityNet.toString()).div(Math.pow(10,8))).toString(),R[j].liquityAmount=J;let ae=[];const K=C&&C.length>0?{index:v,liquityAmount:Number(H)}:{index:v,liquityAmount:0};(U.length>0||R.length>0)&&(ae=[...U.reverse(),K,...R],e.direction||(ae=ae.reverse()));const ge=[];C.forEach(j=>{ge.push({...j,liquidityGross:j.liquidityGross.toString(),liquidityNet:j.liquidityNet.toString()})}),console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-chart.vue:384 ~ dataProcessing ~ tickMin, tickMax, minPriceTick, maxPriceTick:",l,_,ie,Z,v),I(ae,l,_,ie,Z,v)}};let f=N(!0);Oo(()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,window.onresize=()=>{document.body.clientWidth<750?f.value=!1:f.value=!0,z(e.poolInfo,s.value)}});const I=(i,A,v,_,l,ie)=>{let Z,se;e.direction?(Z=e.before7dContractPriceLowest?r.priceToTickIndex(new g(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",se=e.before7dContractPriceHighest?r.priceToTickIndex(new g(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(Z=e.before7dContractPriceLowest?r.priceToTickIndex(new g(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",se=e.before7dContractPriceHighest?r.priceToTickIndex(new g(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const H={top:30,right:35,bottom:20,left:55};let C,U;f.value,C=340-H.left-H.right,U=205-H.top-H.bottom;const R=v-A,X=parseInt(String(R/4));let ee=[A+X/4,A+X,A+2*X,v-X,v-X/4];const J=A,ae=v,K=C/(ae-J);e.currentPriceTab==="full range"&&(ee=[A,A+2*X,v]);const ge=ee.map(q=>e.direction?No(q,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new g(1).div(No(q,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());te(ge),co("#chart").selectAll("*").remove();const j=co("#chart").attr("width",C+H.left+H.right).attr("height",U+H.top+H.bottom).append("g").attr("transform",`translate(${H.left},${H.right})`),ke=fn(i,function(q){return Number(Math.abs(q.liquityAmount))})||0,Ie=pn().range([0,U]).domain([ke,0]);hn().rangeRound([0,C]).padding(.1);const Me=j.append("g").attr("id","barsBox").selectAll("rect").data(i).enter().append("rect");m.value.theme=="default"?Me.attr("x",function(q,F){return F===0?0:e.direction?Math.abs(q.index-J)*K:Math.abs(ae-q.index)*K}).attr("y",function(q,F){return e.direction?F===i.length-1?0:Ie(q.liquityAmount):F===i.length-1?0:Ie(i[F+1].liquityAmount)}).attr("width",function(q,F){return F===0&&i.length===1&&q.liquityAmount>0?C:(e.direction,F!==i.length-1?Math.abs(i[F+1].index-q.index)*K:0)}).attr("height",function(q,F){return F===0&&i.length===1&&q.liquityAmount>0?U:e.direction?F===i.length-1?0:U-Ie(q.liquityAmount):F===i.length-1?0:U-Ie(i[F+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):Me.attr("x",function(q,F){return F===0?0:e.direction?Math.abs(q.index-J)*K:Math.abs(ae-q.index)*K}).attr("y",function(q,F){return e.direction?F===i.length-1?0:Ie(Math.abs(q.liquityAmount)):F===i.length-1?0:Ie(Math.abs(i[F+1].liquityAmount))}).attr("width",function(q,F){return F===0&&i.length===1&&q.liquityAmount>0?C:(e.direction,F!==i.length-1?Math.abs(i[F+1].index-q.index)*K:0)}).attr("height",function(q,F){if(F===0&&i.length===1&&q.liquityAmount>0)return U;if(e.direction)return F===i.length-1?0:Number(q.liquityAmount)?U-Ie(Math.abs(q.liquityAmount)):0;{if(F===i.length-1)return 0;const Ae=U-Ie(Math.abs(i[F+1].liquityAmount));return Number(i[F+1].liquityAmount)?Ae:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const Se=j.append("g");Se.append("line").attr("x1",0).attr("y1",155).attr("x2",C).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),Se.append("g");let u=0;e.direction?u=Math.abs(ie-J)*K:u=Math.abs(ie-ae)*K,(m.value.theme=="default"?j.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):j.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+u+", 0)"),co("#triangle").attr("width",8).attr("height",4);let b=[[0,0],[4,4],[8,0]],O=Nn().x(function(q){return q[0]}).y(function(q){return q[1]}).curve(Rn);const Y=u-4;j.append("path").attr("d",O(b)).style("fill",m.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+Y+", 0)");let E,D,V,le;e.direction?(E=_<J?-100:parseInt(String(Math.abs(_-J)*K)),D=l<J?-100:parseInt(String(Math.abs(l-J)*K)),V=Z<J?-100:Math.abs(Z-J)*K,le=se<J?-100:Math.abs(se-J)*K):(D=_<J?-100:Math.abs(ae-_)*K,E=l<J?-100:Math.abs(ae-l)*K,le=Z<J?-100:Math.abs(ae-Z)*K,V=se<J?-100:Math.abs(ae-se)*K),e.minPrice==="0"&&(E=0),e.maxPrice==="âˆž"&&(D=C),f.value?a.value=C-E+60+"px":a.value=C-E+52+"px",P.value=D+74+"px",Z&&V<C&&j.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+V+", 0)"),se&&le<C&&j.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+le+", 0)");const he=bn().extent([[0,0],[C,U]]).handleSize(30).on("end",ve);j.append("g").attr("class","brush").call(he).call(he.move,[E,D]);function ve(q){if(!q.sourceEvent||!q.selection)return;f.value?a.value=C-q.selection[0]+60+"px":a.value=C-q.selection[0]+52+"px",P.value=q.selection[1]+74+"px";let F,Ae,de=0,be=0;e.direction?(de=k(parseInt(String(q.selection[0]/K+J)),Number(e.poolInfo.tickSpacing)),F=r.tickIndexToPrice(de,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),be=k(parseInt(String(q.selection[1]/K+J)),Number(e.poolInfo.tickSpacing)),Ae=r.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()):(be=k(ae-q.selection[0]/K,Number(e.poolInfo.tickSpacing)),F=1/r.tickIndexToPrice(be,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),de=k(ae-q.selection[1]/K,Number(e.poolInfo.tickSpacing)),Ae=1/r.tickIndexToPrice(de,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),t.emit("onChangeMinPrice",String(_e(String(F),6))),t.emit("onChangeMaxPrice",String(_e(String(Ae),6)))}m.value.theme=="default"?co(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):co(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};N(""),ye(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([i,A,v,_,l])=>{i&&A&&v&&_&&l&&l.length>0&&z(i,s.value)},{immediate:!0});const L=N(!0);return ye(()=>e.chartLoading,(i,A)=>{i!==A&&(L.value=i)},{immediate:!0,deep:!0}),{store:m,loading:L,zoomOut:B,zoomIn:ne,rangeSizeLower:T,rangeSizeUpper:d,rangeSizeLowerPosition:a,rangeSizeUpperPosition:P,decimalFormat:cn,numberformat:mn}}});const zn=e=>(ao("data-v-992b1bf2"),e=e(),lo(),e),Gn={class:"chart-box"},Jn={class:"chart"},Qn=zn(()=>n("svg",{id:"chart"},null,-1)),Zn=[Qn];function Kn(e,t,s,a,P,p){return w(),S("div",Gn,[Te(n("div",Jn,Zn,512),[[qo,!e.loading]])])}const zo=ze(Yn,[["render",Kn],["__scopeId","data-v-992b1bf2"]]),Vn=Ye({components:{StatusBlock:jo,NewPositionChart:zo,TokenWarning:ho},setup(e){const t=N(),s=N(),a=y(()=>{var v,_;return(_=(v=r.value)==null?void 0:v.poolInfo)==null?void 0:_.needReverse}),P=Xe(),p=y(()=>P),T=y(()=>p.value.currentExplorer),d=y(()=>p.value.theme),o=y(()=>p.value.chainName),m=eo(),c=y(()=>m),r=N({}),k=po();ye(()=>[c.value.currentPositionInfo,o.value],([v,_])=>{var l;(_=="Aptos"&&v||_=="Sui"&&v&&(v==null?void 0:v.nftHash)==((l=k==null?void 0:k.query)==null?void 0:l.pos))&&(r.value=v,t.value=r.value.token_a,s.value=r.value.token_b)},{immediate:!0});const B=v=>{var _;return(v==null?void 0:v.logoURI)||(v==null?void 0:v.logo_url)||((_=c.value.tokensObj[v==null?void 0:v.address])==null?void 0:_.logo_url)||(d.value==="default"?so("/image/coins/unknown.png"):so("/image/coins/sui-unknown.png"))},ne=y(()=>o.value?oo(o.value):{}),te=N([]),z=async v=>{const{list:_}=await ne.value.getTicks(v),l=_?ne.value.getTickDataFromUrlData(_):[];te.value=l};ye(()=>[r.value,c.value.poolsObj],([v,_])=>{v&&!pe(v)&&v.poolInfo&&_&&!pe(_)&&z(_[v.poolAddress])},{immediate:!0});const f=N(!0),I=(v,_)=>v!=="0"&&_!=="âˆž"?Ue(1/(1-Number((v/_)**.25)),2)+"x":"1x",L=y(()=>r.value.minPrice&&r.value.maxPrice?I(r.value.minPrice,r.value.maxPrice):"--"),i=y(()=>r.value.maxPrice!=="âˆž"?new g(1).div(new g(r.value.maxPrice)).toString():"âˆž"),A=y(()=>r.value.minPrice>0?new g(1).div(new g(r.value.minPrice)).toString():"0");return{needReverse:a,getCoinIcon:B,theme:d,indexStore:P,direct:f,addCommom:Q,decimalUi:_e,tickList:te,positionInfo:r,fromCoin:t,toCoin:s,getExplorerUrl:ko,lever:L,currentExplorer:T,minPriceResever:i,maxPriceResever:A}}}),xn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),et=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),ot=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),nt=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Qe=e=>(ao("data-v-500e09ec"),e=e(),lo(),e),tt={class:"new-position-info"},it={class:"pool-info"},st={class:"left"},at={class:"coin-a"},lt={alt:""},rt={class:"coin-b"},ut={alt:""},dt={class:"position-name"},ct=["href"],mt=Qe(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),vt=[mt],ft={key:0,class:"pool-fee"},pt=Qe(()=>n("span",null,"Fee tier",-1)),ht={class:"right"},bt={class:"h5-pool-info"},gt={class:"coin-info"},kt={class:"coin-a"},_t={alt:""},wt={class:"coin-b"},yt={alt:""},It={class:"position-name"},At=["href"],Ct=Qe(()=>n("use",{"xlink:href":"#icon-icon_copy1"},null,-1)),$t=[Ct],St={key:0,class:"pool-fee"},Pt={class:"price-info"},Tt={class:"price-and-chart"},Nt={class:"left"},Rt={class:"current-price"},Ot=Qe(()=>n("span",null,"Current Price",-1)),qt={class:"coin-rate"},Lt=Qe(()=>n("div",null,[n("svg",{class:"icon icon-up","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),Bt=Qe(()=>n("div",null,[n("svg",{class:"icon icon-down","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),Mt=[Lt,Bt],Ut={key:0},jt={key:1},Et={key:0,class:"position-range"},Dt=Qe(()=>n("div",{class:"position-range-title"},"Position Range",-1)),Ft={key:0},Wt={key:1},Ht={key:2,src:xn,alt:""},Xt={key:3,src:et,alt:""},Yt={key:4},zt={key:5},Gt={key:1,class:"position-range position-range-warp"},Jt={key:0,class:"position-range-title"},Qt={key:1,class:"position-range-title"},Zt={key:2},Kt={key:3},Vt={class:"price-img"},xt={key:0,src:ot,alt:""},ei={key:1,src:nt,alt:""},oi={key:4},ni={key:5},ti={class:"lever"},ii={class:"lever-title"},si=Qe(()=>n("div",null,[n("span",null," Leverage "),n("svg",{"aria-hidden":"true",class:"icon"},[n("use",{"xlink:href":"#icon-icon-tips1"})])],-1)),ai={class:"lever-text"},li={class:"right"},ri=Qe(()=>n("div",{class:"chat-mask"},null,-1));function ui(e,t,s,a,P,p){var r,k,B,ne,te,z,f,I,L,i,A,v,_,l,ie,Z,se,H,C,U,R,X,ee,J,ae,K,ge,j,ke,Ie;const T=ho,d=jo,o=Lo,m=zo,c=yo("image");return w(),S("div",tt,[n("div",it,[n("div",st,[n("div",at,[Te(n("img",lt,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(ne=(B=e.positionInfo)==null?void 0:B.token_b)==null?void 0:ne.address:(k=(r=e.positionInfo)==null?void 0:r.token_a)==null?void 0:k.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",rt,[Te(n("img",ut,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(I=(f=e.positionInfo)==null?void 0:f.token_a)==null?void 0:I.address:(z=(te=e.positionInfo)==null?void 0:te.token_b)==null?void 0:z.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",dt,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:G(ko))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash||e.positionInfo.id),target:"_blank"},W((i=(L=e.positionInfo)==null?void 0:L.name)==null?void 0:i.split("|")[1]),9,ct)]),(w(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[0]||(t[0]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.id))},vt)),e.positionInfo.fee?(w(),S("div",ft,[pt,fe(" "+W(e.positionInfo.fee*100)+"% ",1)])):me("",!0)]),n("div",ht,[re(d,{"current-status":(A=e.positionInfo)==null?void 0:A.currentStatus},null,8,["current-status"])])]),n("div",bt,[n("div",null,[n("div",gt,[n("div",kt,[Te(n("img",_t,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),re(T,{address:e.needReverse?(ie=(l=e.positionInfo)==null?void 0:l.token_b)==null?void 0:ie.address:(_=(v=e.positionInfo)==null?void 0:v.token_a)==null?void 0:_.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),n("div",wt,[Te(n("img",yt,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),re(T,{address:e.needReverse?(C=(H=e.positionInfo)==null?void 0:H.token_a)==null?void 0:C.address:(se=(Z=e.positionInfo)==null?void 0:Z.token_b)==null?void 0:se.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),n("div",It,[n("div",null,[n("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:G(ko))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash||e.positionInfo.id),target:"_blank"},W((R=(U=e.positionInfo)==null?void 0:U.name)==null?void 0:R.split("|")[1]),9,At),(w(),S("svg",{class:"copy-icon","aria-hidden":"true",onClick:t[1]||(t[1]=Be=>e.indexStore.copy(e.positionInfo.nftHash||e.positionInfo.id))},$t))]),e.positionInfo.fee?(w(),S("div",St,W(e.positionInfo.fee*100)+"% ",1)):me("",!0)])]),re(d,{"current-status":(X=e.positionInfo)==null?void 0:X.currentStatus},null,8,["current-status"])]),n("div",Pt,[n("div",Tt,[n("div",Nt,[n("div",Rt,[n("div",null,[Ot,n("div",qt,[n("div",{onClick:t[2]||(t[2]=Be=>e.direct=!e.direct)},Mt)])]),(e.needReverse?!e.direct:e.direct)?(w(),S("div",Ut,[fe(W(("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.currentPrice,6)))+" Â  ",1),n("span",null,W((ee=e.toCoin)==null?void 0:ee.symbol)+" per "+W((J=e.fromCoin)==null?void 0:J.symbol),1)])):(w(),S("div",jt,[fe(W(("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.currentPriceReverse,6)))+" Â  ",1),n("span",null,W((ae=e.fromCoin)==null?void 0:ae.symbol)+" per "+W((K=e.toCoin)==null?void 0:K.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?(w(),S("div",Et,[Dt,n("div",null,[(e.needReverse?!e.direct:e.direct)?(w(),S("div",Ft,[fe(W(("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",Wt,[fe(W(((ge=e.positionInfo)==null?void 0:ge.minPrice)!=="0"?("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(1/e.positionInfo.minPrice,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?(w(),S("img",Ht)):(w(),S("img",Xt)),(e.needReverse?!e.direct:e.direct)?(w(),S("div",Yt,[fe(W(((j=e.positionInfo)==null?void 0:j.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",zt,[fe(W(((ke=e.positionInfo)==null?void 0:ke.maxPrice)!=="âˆž"?("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(1/e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):(w(),S("div",Gt,[(e.needReverse?!e.direct:e.direct)?(w(),S("span",Jt," Position Range ")):(w(),S("span",Qt," Position Range ")),(e.needReverse?!e.direct:e.direct)?(w(),S("div",Zt,[fe(W(("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.minPrice,6)))+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",Kt,[fe(W(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.maxPriceResever,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),n("div",Vt,[e.theme=="default"?(w(),S("img",xt)):(w(),S("img",ei))]),(e.needReverse?!e.direct:e.direct)?(w(),S("div",oi,[fe(W(e.positionInfo.maxPrice!=="âˆž"?("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.maxPrice,6)):"âˆž")+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):(w(),S("div",ni,[fe(W(((Ie=e.positionInfo)==null?void 0:Ie.minPrice)!=="0"?("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.positionInfo.minPriceResever,6)):0)+" ",1),n("span",null,W(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),fe(" Â  ")]))])),n("div",ti,[n("div",ii,[re(o,{"overlay-class-name":"lever-tooltip"},{title:Le(()=>[fe("This parameter indicates the concentration rate of your liquidity relative to a full range position.")]),default:Le(()=>[si]),_:1})]),n("div",ai,W(e.lever),1)])]),n("div",li,[re(m,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse?e.minPriceResever:e.positionInfo.minPrice,"max-price":e.needReverse?e.maxPriceResever:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),ri])])])])}const Go=ze(Vn,[["render",ui],["__scopeId","data-v-500e09ec"]]),di=Ye({components:{TokenWarning:ho},setup(e,t){const{t:s}=Io(),{$notify:a}=tn(),P=Xe(),p=y(()=>P),T=eo(),d=y(()=>T),o=N({}),m=N({}),c=N({}),r=y(()=>p.value.chainName),k=y(()=>r.value?oo(r.value):{}),B=po(),ne=N(!1),te=async(u=null)=>{var O,Y;const h=u||o.value,b=d.value.addressLpTokens[h.poolAddress];if(b){const E=await k.value.getTickDataByIndex(b.ticks_handle||((O=h==null?void 0:h.poolInfo)==null?void 0:O.ticks_handle),Number(h.tick_lower_index)),D=await k.value.getTickDataByIndex(b.ticks_handle||((Y=h==null?void 0:h.poolInfo)==null?void 0:Y.ticks_handle),Number(h.tick_upper_index));let V={};r.value==="Aptos"?V=await k.value.getPosRewardersAmount({poolAddress:_.currentRoute.value.query.address,positionName:_.currentRoute.value.query.token,tickLowerData:E,tickUpperData:D}):V=await k.value.fetchPosRewardersAmount({poolAddress:h.poolAddress,positionId:h.pos_object_id||h.clmm_position_id,coinTypeA:h.coin_type_a||h.coinTypeA,coinTypeB:h.coin_type_b||h.coinTypeB,rewarderInfo:h.poolInfo.rewarder_infos});const le=[];let he=new g(0);V.forEach((ve,q)=>{var be,$;const F=(be=d.value.tokensObj[ve.coin_address])==null?void 0:be.decimals,Ae=ve.amount_owed.toString();let de=new g(Ae).div(Math.pow(10,F)).toString();if(r.value=="Aptos"&&Number(de)>999999999&&(de="0"),h.poolInfo[`rewarder_display${q+1}`]||Number(de)>0){const x=d.value.tokensObj[ve.coin_address],M=(($=d.value.RATES[ve.coin_address])==null?void 0:$.price)||0,oe=new g(de).mul(M).toString();he=new g(he).plus(oe),le.push({...ve,...x,amount:Number(de)>0?de:0,amountUSD:Number(oe)>0?Pe(oe,2):0,amountUSDText:oe})}}),l.value=le}};ye(()=>[d.value.currentPositionInfo,r.value],([u,h])=>{var b;h=="Aptos"&&u?(o.value=u,m.value=u==null?void 0:u.token_a,c.value=u==null?void 0:u.token_b):h=="Sui"&&u&&(u==null?void 0:u.nftHash)==((b=B==null?void 0:B.query)==null?void 0:b.pos)&&(o.value=u,m.value=u==null?void 0:u.token_a,c.value=u==null?void 0:u.token_b,ne.value=!1)},{immediate:!0}),ye(()=>[o.value,d.value.addressLpTokens],([u,h])=>{!pe(u)&&!pe(h)&&te(u)},{immediate:!0});const z=y(()=>{var u,h,b,O,Y,E,D,V;if(o.value&&!pe(o.value)&&d.value.RATES){const le=o.value.amountA*((h=d.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:h.price),he=o.value.amountB*((O=d.value.RATES[(b=o.value)==null?void 0:b.token_b.address])==null?void 0:O.price);if((E=d.value.RATES[(Y=o.value)==null?void 0:Y.token_a.address])!=null&&E.price&&((V=d.value.RATES[(D=o.value)==null?void 0:D.token_b.address])!=null&&V.price)){const ve=Number(le+he);return ve>0&&ve<.01?"<0.01":Q(Ue(le+he,2),2)}else return" --"}else return" --"}),f=y(()=>{var u,h;return(h=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:h.needReverse}),I=y(()=>d.value.RATES),L=y(()=>{var u,h;if(I.value&&m.value&&c.value&&!pe(I.value)&&!pe(m.value)&&!pe(c.value)){const b=[],O=Number(o.value.feeOwedA)||0,Y=Number(o.value.feeOwedB)||0,E=new g(O).mul(((u=I.value[m.value.address])==null?void 0:u.price)||0),D=new g(Y).mul(((h=I.value[c.value.address])==null?void 0:h.price)||0);return b.push({amount:O,amountUSD:E.toString()},{amount:Y,amountUSD:D.toString()}),b}return[]}),i=y(()=>{var h,b;let u=new g(0);return(h=L==null?void 0:L.value)==null||h.forEach(O=>{u=u.add(new g(O.amount))}),r.value=="Sui"&&((b=l==null?void 0:l.value)==null||b.forEach(O=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-liquidity.vue:622 ~ canClaimYield ~ ele:",O),u=u.add(new g(O.amount))})),u.toNumber()}),A=y(()=>{var h,b;let u=new g(0);return(h=L==null?void 0:L.value)==null||h.forEach(O=>{u=u.add(new g(O.amountUSD))}),r.value=="Sui"&&((b=l==null?void 0:l.value)==null||b.forEach(O=>{u=u.add(new g(O.amountUSDText))})),u.toNumber()}),v=y(()=>{var h;let u=new g(0);return(h=l.value)==null||h.forEach(b=>{u=u.add(new g(b.amountUSDText))}),u.toNumber()}),_=ro(),l=N([]),{setIsShowSuccess:ie,setIsShowRejected:Z,setIsShowWaiting:se,setTransactionDesc:H,setTransactionTxid:C}=P,U=vo(),R=y(()=>U),X=async()=>{ne.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:l.value.length,collect_fee:!0};u.coinTypeC=l.value[0]?l.value[0].coin_address:"",u.coinTypeD=l.value[1]?l.value[1].coin_address:"",u.coinTypeE=l.value[2]?l.value[2].coin_address:"",se(!0),H();try{let h;if(r.value==="Aptos"){const b=await k.value.getCollectRewarderTransactionPayload(u);h=await R.value.currentWallet.signAndSubmitTransaction(b)}else{u.pos_index=o.value.pos_object_id;const b=await k.value.getCollectRewarderTransactionPayload(u,o.value),O=await k.value.signAndExecuteTransactionBlock(R.value.currentWallet,b.txb,b.payloadParams);h=k.value.handleTx(O)}if(h&&h.hash){C(h.hash),se(!1),ie(!0);const b={title:"Claim",desc:"",hash:h.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};r.value!=="Aptos"&&(b.res=h.res),k.value.showTransitionPending(b),await k.value.watchTransaction(b)&&(t.emit("getDetails"),setTimeout(()=>{k.value.getAccount(R.value.address)},3e3))}else console.log("0310###toClaimRewards###else###"),se(!1),Z(!0),ne.value=!1}catch(h){se(!1),Z(!0),ne.value=!1,console.log(h,"error===>")}},ee=N(!1),J=async()=>{ee.value=!0;const u=l.value;let h={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};h.coinTypeC=u[0]?u[0].coin_address:"",h.coinTypeD=u[1]?u[1].coin_address:"",h.coinTypeE=u[2]?u[2].coin_address:"";try{let b;if(r.value==="Aptos"){const O=await k.value.getCollectRewarderTransactionPayload(h);b=await R.value.currentWallet.signAndSubmitTransaction(O)}else{h.pos_index=o.value.pos_object_id;const O=await k.value.getCollectRewarderTransactionPayload(h),Y=await k.value.signAndExecuteTransactionBlock(R.value.currentWallet,O.txb,O.payloadParams);b=k.value.handleTx(Y)}if(b&&b.hash){C(b.hash),se(!1),ie(!0);const O=u[0].amount+u[0].symbol,Y=h.coinTypeD?" and "+u[1].amount+u[1].symbol:"",E=h.coinTypeE?" and "+u[2].amount+u[2].symbol:"",D={title:"Claim",desc:"",hash:b.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:d.value.tokensObj&&u[0]&&u[0].address&&d.value.tokensObj[u[0].address]&&d.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:h.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:h.coinTypeD?d.value.tokensObj&&u[1]&&u[1].address&&d.value.tokensObj[u[1].address]&&d.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:h.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:h.coinTypeE?d.value.tokensObj&&u[2]&&u[2].address&&d.value.tokensObj[u[2].address]&&d.value.tokensObj[u[2].address].logoURI:""},text:O+Y+E};r.value!=="Aptos"&&(D.res=b.res),k.value.showTransitionPending(D),await k.value.watchTransaction(D)&&setTimeout(()=>{t.emit("getDetails"),k.value.getAccount(R.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),se(!1),Z(!0);ee.value=!1}catch(b){console.log("0310###collectRewarderParams Error###",b),ee.value=!1,se(!1),Z(!0)}},ae=y(()=>d.value.positionDetailCurrentTab),K=y(()=>{var b,O,Y,E,D,V;const u=_e(f.value?(O=o.value)==null?void 0:O.amountB:(b=o.value)==null?void 0:b.amountA,f.value?(V=(D=o.value)==null?void 0:D.token_b)==null?void 0:V.decimals:(E=(Y=o.value)==null?void 0:Y.token_a)==null?void 0:E.decimals),h=f.value?d.value.positionActionAmount.toCoinAmount||0:d.value.positionActionAmount.fromCoinAmount||0;if(ae.value=="increase")return h?new g(u).add(new g(h)).toString():"";if(h){const le=new g(u).minus(new g(h)).toString();return le<0?"0":String(le)}else return""}),ge=y(()=>{var b,O,Y,E,D,V;const u=_e(f.value?(O=o.value)==null?void 0:O.amountA:(b=o.value)==null?void 0:b.amountB,f.value?(V=(D=o.value)==null?void 0:D.token_a)==null?void 0:V.decimals:(E=(Y=o.value)==null?void 0:Y.token_b)==null?void 0:E.decimals),h=f.value?d.value.positionActionAmount.fromCoinAmount||0:d.value.positionActionAmount.toCoinAmount||0;if(ae.value=="increase")return h?new g(u).add(new g(h)).toString():"";if(h){const le=new g(u).minus(new g(h)).toString();return le<0?"0":String(le)}else return""}),j=y(()=>f.value?d.value.positionActionAmount.toCoinAmount:d.value.positionActionAmount.fromCoinAmount),ke=y(()=>f.value?d.value.positionActionAmount.fromCoinAmount:d.value.positionActionAmount.toCoinAmount),Ie=u=>{var h;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((h=d.value.tokensObj[u==null?void 0:u.address])==null?void 0:h.logo_url)||(p.value.theme==="default"?so("/image/coins/unknown.png"):so("/image/coins/sui-unknown.png"))},Be=y(()=>{var E,D,V,le,he,ve,q,F,Ae,de,be,$;const{fromCoinAmount:u,toCoinAmount:h}=d.value.positionActionAmount,b=d.value.positionDetailCurrentTab,O=_e(f.value?(D=o.value)==null?void 0:D.amountB:(E=o.value)==null?void 0:E.amountA,f.value?(ve=(he=o.value)==null?void 0:he.token_b)==null?void 0:ve.decimals:(le=(V=o.value)==null?void 0:V.token_a)==null?void 0:le.decimals),Y=_e(f.value?(F=o.value)==null?void 0:F.amountA:(q=o.value)==null?void 0:q.amountB,f.value?($=(be=o.value)==null?void 0:be.token_a)==null?void 0:$.decimals:(de=(Ae=o.value)==null?void 0:Ae.token_b)==null?void 0:de.decimals);return r.value=="Sui"||b=="remove"&&r.value=="Aptos"&&u==O&&h==Y}),Me=async()=>{ne.value=!0;const u=Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,h=Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;H(s("newAdd.claimWaitingText",{from:f.value?h:u,and:Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:f.value?u:h})),se(!0);let b;const O={pool:o.value.poolInfo,position:o.value};try{const Y=await k.value.getCollectFeeTransactionPayload(O);if(r.value==="Aptos")b=await R.value.currentWallet.signAndSubmitTransaction(Y);else{const E=await k.value.signAndExecuteTransactionBlock(R.value.currentWallet,Y);b=k.value.handleTx(E)}if(b){C(b.hash),se(!1),ie(!0);const E={title:"Claim",desc:"",hash:b.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":d.value.tokensObj&&o.value&&o.value.token_a.address&&d.value.tokensObj[o.value.token_a.address]&&d.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":d.value.tokensObj&&o.value&&o.value.token_b.address&&d.value.tokensObj[o.value.token_b.address]&&d.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};r.value!=="Aptos"&&(E.res=b.res),k.value.showTransitionPending(E);const D=await k.value.watchTransaction(E);console.log("0310##toClaim###transitionStatus####",D),D&&setTimeout(()=>{t.emit("getDetails")},1e3)}else se(!1),Z(!0),a.error({icon:Je("svg",{class:{icon:!0},"aria-hidden":!0},[Je("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Je("div",{class:"notification-title"},[Je("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});ne.value=!1,console.log("claim####test###",b)}catch(Y){console.log("claim###error####",Y),ne.value=!1,se(!1),Z(!0),a.error({icon:Je("svg",{class:{icon:!0},"aria-hidden":!0},[Je("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Je("div",{class:"notification-title"},[Je("span",{innerHTML:$o.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:s("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},Se=Je(sn,{style:{fontSize:"12px",color:"#fff",paddingBottom:"3px"},spin:!0});return{amountUSD:z,needReverse:f,decimalUi:_e,pendingFees:L,positionInfo:o,pendingRewarderArr:l,pendingYieldAmount:A,toClaim:Me,claimAll:X,fromCoin:m,toCoin:c,showNum:Pe,claimLoading:ne,addCommom:Q,afterBase:K,afterQuote:ge,fromCoinAmount:j,toCoinAmount:ke,checkNullObj:pe,getCoinIcon:Ie,chainName:r,isShowAfterAmount:Be,pendingRewarderAmount:v,toClaimRewards:J,rewarderLoading:ee,indicator:Se,canClaimYield:i}}});const ci={class:"liquidity-card"},mi={class:"liquidity-title"},vi={class:"liquidity-usd"},fi=n("span",null,"Liquidity",-1),pi={class:"liquidity-ratio"},hi={class:"coin-ratio"},bi={class:"coin-a-ratio"},gi={class:"coin-b-ratio"},ki={class:"ratio-progress"},_i={class:"base-quote-num"},wi={class:"base-coin-num"},yi=n("span",null,"Base",-1),Ii={alt:""},Ai={key:0,class:"after"},Ci={class:"quote-coin-num"},$i=n("span",null,"Quote",-1),Si={alt:""},Pi={key:0,class:"after"},Ti={class:"pending-yield"},Ni={class:"left"},Ri={class:"pending-yield-title"},Oi={key:0,class:"after"},qi={class:"right"},Li={class:"fees-rewards"},Bi={class:"fees-rewards-item"},Mi=n("span",null,"Fees",-1),Ui={key:0,class:"after"},ji=n("span",null,"Fees",-1),Ei={key:0,class:"after"},Di=n("span",null,"Mining Rewards",-1),Fi={style:{"margin-top":"5px"}},Wi={alt:""},Hi=n("span",null,"Mining Rewards",-1),Xi={alt:""},Yi={key:0,class:"after"},zi={key:0,class:"pending-yield"},Gi={class:"left"},Ji=n("div",{class:"pending-yield-title"},"Pending rewards",-1),Qi={key:0,class:"after"},Zi={class:"right"},Ki={key:1,class:"fees-rewards"},Vi={class:"fees-rewards-item"},xi=n("span",null,"Mining Rewards",-1),es={alt:""},os={key:0,class:"after"};function ns(e,t,s,a,P,p){var c,r,k,B,ne,te,z,f,I,L,i,A,v,_,l,ie,Z,se,H,C,U,R,X,ee,J,ae,K,ge,j,ke,Ie,Be,Me,Se,u,h,b,O,Y,E,D,V,le,he,ve,q,F,Ae,de,be,$,x,M,oe,ce,we,Ne,Ce,Re,Ee,De,Ze,Oe,je,Fe,We,Ke;const T=ho,d=mo,o=an,m=yo("image");return w(),S("div",ci,[n("div",mi,[n("div",vi,[fi,n("div",null,"$"+W(e.amountUSD),1)]),n("div",pi,[n("div",hi,[n("div",bi,[n("span",null,W(e.needReverse?(r=e.toCoin)==null?void 0:r.symbol:(c=e.fromCoin)==null?void 0:c.symbol),1),fe(" "+W(e.needReverse?(B=e.positionInfo)==null?void 0:B.toPercent:(k=e.positionInfo)==null?void 0:k.fromPercent)+"% ",1)]),n("div",gi,[n("span",null,W(e.needReverse?(te=e.fromCoin)==null?void 0:te.symbol:(ne=e.toCoin)==null?void 0:ne.symbol),1),fe(" "+W(e.needReverse?(f=e.positionInfo)==null?void 0:f.fromPercent:(z=e.positionInfo)==null?void 0:z.toPercent)+"% ",1)])]),n("div",ki,[n("div",{class:"from-percent",style:So({width:e.needReverse?((L=e.positionInfo)==null?void 0:L.toPercent)+"%":((I=e.positionInfo)==null?void 0:I.fromPercent)+"%"})},null,4),n("div",{class:"to-percent",style:So({width:e.needReverse?((A=e.positionInfo)==null?void 0:A.fromPercent)+"%":((i=e.positionInfo)==null?void 0:i.toPercent)+"%"})},null,4)])])]),n("div",_i,[n("div",wi,[yi,n("div",null,[Te(n("img",Ii,null,512),[[m,(e.needReverse?(_=e.toCoin)==null?void 0:_.logo_url:(v=e.fromCoin)==null?void 0:v.logo_url)||e.getCoinIcon(e.needReverse?(ie=e.positionInfo)==null?void 0:ie.token_b:(l=e.positionInfo)==null?void 0:l.token_a)]]),re(T,{address:e.needReverse?(C=(H=e.positionInfo)==null?void 0:H.token_b)==null?void 0:C.address:(se=(Z=e.positionInfo)==null?void 0:Z.token_a)==null?void 0:se.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.needReverse?(R=e.positionInfo)==null?void 0:R.amountB:(U=e.positionInfo)==null?void 0:U.amountA,e.needReverse?(ae=(J=e.positionInfo)==null?void 0:J.token_b)==null?void 0:ae.decimals:(ee=(X=e.positionInfo)==null?void 0:X.token_a)==null?void 0:ee.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:G(pe))(e.positionInfo)?(w(),S("div",Ai,W(("addCommom"in e?e.addCommom:G(Q))(e.afterBase))+" after ",1)):me("",!0)]),n("div",Ci,[$i,n("div",null,[Te(n("img",Si,null,512),[[m,(e.needReverse?(ge=e.fromCoin)==null?void 0:ge.logo_url:(K=e.toCoin)==null?void 0:K.logo_url)||e.getCoinIcon(e.needReverse?(ke=e.positionInfo)==null?void 0:ke.token_a:(j=e.positionInfo)==null?void 0:j.token_b)]]),re(T,{address:e.needReverse?(Se=(Me=e.positionInfo)==null?void 0:Me.token_a)==null?void 0:Se.address:(Be=(Ie=e.positionInfo)==null?void 0:Ie.token_b)==null?void 0:Be.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(("addCommom"in e?e.addCommom:G(Q))(("decimalUi"in e?e.decimalUi:G(_e))(e.needReverse?(h=e.positionInfo)==null?void 0:h.amountA:(u=e.positionInfo)==null?void 0:u.amountB,e.needReverse?(E=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:E.decimals:(O=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:O.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:G(pe))(e.positionInfo)?(w(),S("div",Pi,W(("addCommom"in e?e.addCommom:G(Q))(e.afterQuote))+" after ",1)):me("",!0)])]),n("div",Ti,[n("div",Ni,[n("div",Ri,W(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),n("div",null,[fe(" $"+W(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:G(Q))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?(w(),S("span",Oi,"$0 after")):me("",!0)])]),n("div",qi,[re(d,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.canClaimYield==0,onClick:t[0]||(t[0]=ue=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Le(()=>[fe("Claim")]),_:1},8,["loading","disabled"])])]),n("div",Li,[n("div",Bi,[n("div",null,[Mi,n("div",null,[Te(n("img",null,null,512),[[m,(e.needReverse?(V=e.toCoin)==null?void 0:V.logo_url:(D=e.fromCoin)==null?void 0:D.logo_url)||e.getCoinIcon(e.needReverse?(he=e.positionInfo)==null?void 0:he.token_b:(le=e.positionInfo)==null?void 0:le.token_a)]]),re(T,{address:e.needReverse?(Ae=(F=e.positionInfo)==null?void 0:F.token_b)==null?void 0:Ae.address:(q=(ve=e.positionInfo)==null?void 0:ve.token_a)==null?void 0:q.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:G(Pe))(e.positionInfo.feeOwedB,(x=($=e.positionInfo)==null?void 0:$.token_b)==null?void 0:x.decimals):("showNum"in e?e.showNum:G(Pe))(e.positionInfo.feeOwedA,(be=(de=e.positionInfo)==null?void 0:de.token_a)==null?void 0:be.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:G(pe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",Ui," 0 after ")):me("",!0)]),n("div",null,[ji,n("div",null,[Te(n("img",null,null,512),[[m,(e.needReverse?(oe=e.fromCoin)==null?void 0:oe.logo_url:(M=e.toCoin)==null?void 0:M.logo_url)||e.getCoinIcon(e.needReverse?(we=e.positionInfo)==null?void 0:we.token_a:(ce=e.positionInfo)==null?void 0:ce.token_b)]]),re(T,{address:e.needReverse?(Ee=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Ee.address:(Ce=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(e.needReverse?("showNum"in e?e.showNum:G(Pe))(e.positionInfo.feeOwedA,(je=(Oe=e.positionInfo)==null?void 0:Oe.token_a)==null?void 0:je.decimals):("showNum"in e?e.showNum:G(Pe))(e.positionInfo.feeOwedB,(Ze=(De=e.positionInfo)==null?void 0:De.token_b)==null?void 0:Ze.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:G(pe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",Ei," 0 after ")):me("",!0)]),e.chainName=="Sui"?(w(),S(xe,{key:0},[e.pendingRewarderArr.length==0&&((Ke=(We=(Fe=e.positionInfo)==null?void 0:Fe.poolInfo)==null?void 0:We.rewarderInfo)==null?void 0:Ke.length)>0?(w(!0),S(xe,{key:0},io(e.positionInfo.poolInfo.rewarderInfo,ue=>(w(),S("div",{key:ue.coinAddress},[Di,n("div",Fi,[Te(n("img",Wi,null,512),[[m,e.getCoinIcon({address:ue.coinAddress})]]),re(T,{address:ue.coinAddress,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),re(o,{class:"upgrade-text-skeleton",loading:!0,active:"",paragraph:!1})])]))),128)):me("",!0),(w(!0),S(xe,null,io(e.pendingRewarderArr,ue=>(w(),S("div",{key:ue},[Hi,n("div",null,[Te(n("img",Xi,null,512),[[m,ue.logo_url]]),re(T,{address:ue.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(ue.amount>0?("showNum"in e?e.showNum:G(Pe))(ue.amount,ue.decimals):0),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:G(pe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",Yi," 0 after ")):me("",!0)]))),128))],64)):me("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(w(),S("div",zi,[n("div",Gi,[Ji,n("div",null,[fe(" $"+W(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:G(Q))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?(w(),S("span",Qi,"$0 after")):me("",!0)])]),n("div",Zi,[re(d,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Le(()=>[fe("Claim")]),_:1},8,["loading","disabled","onClick"])])])):me("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?(w(),S("div",Ki,[n("div",Vi,[(w(!0),S(xe,null,io(e.pendingRewarderArr,ue=>(w(),S("div",{key:ue},[xi,n("div",null,[Te(n("img",es,null,512),[[m,ue.logo_url]]),re(T,{address:ue.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),n("span",null,W(ue.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:G(pe))(e.positionInfo)&&e.isShowAfterAmount?(w(),S("div",os," 0 after ")):me("",!0)]))),128))])])):me("",!0)])}const Jo=ze(di,[["render",ns]]),ts=Ye({components:{AssetsCard:bo},setup(e,t){const s=N(""),a=N(""),P=Xe(),p=y(()=>P),T=y(()=>p.value.theme),d=eo(),o=y(()=>d),m=N(!1),c=N(!1),r=N(!0),k=y(()=>p.value.chainName),B=y(()=>k.value?oo(k.value):{}),ne=vo(),te=y(()=>ne),z=y(()=>p.value.slippage),f=N(),I=N(),L=y(()=>te.value.assets&&f.value&&te.value.assets[f.value.address]?Co(te.value.assets[f.value.address].balance,f.value.decimals):0),i=y(()=>te.value.assets&&I.value&&te.value.assets[I.value.address]?Co(te.value.assets[I.value.address].balance,I.value.decimals):0),A=b=>{b==="fromCoin"?(r.value=!0,k.value==="Aptos"?s.value=L.value>0?f.value.symbol=="APT"?new g(Number(L.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(L.value)).sub(new g(.1)).toString():String(L.value):"":s.value=L.value>0?f.value.symbol=="SUI"?new g(Number(L.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(L.value)).sub(new g(.05)).toString():String(L.value):""):(r.value=!1,k.value==="Aptos"?a.value=i.value>0?I.value.symbol=="APT"?new g(Number(i.value)).sub(new g(.1)).lt(new g(0))?"0":new g(Number(i.value)).sub(new g(.1)).toString():String(i.value):"":a.value=i.value>0?I.value.symbol=="SUI"?new g(Number(i.value)).sub(new g(.05)).lt(new g(0))?"0":new g(Number(i.value)).sub(new g(.05)).toString():String(i.value):"")},v=b=>{b==="fromCoin"?(r.value=!0,s.value=Ue(new g(Number(L.value)).div(2).toString(),f.value.decimals).toString()):(r.value=!1,a.value=Ue(new g(Number(i.value)).div(2).toString(),I.value.decimals).toString())},_=N({}),l=N(!0),ie=N({}),Z=N(),se=N(),H=()=>{var Ae;if(!_.value||!s.value&&!a.value)return;const{TickMath:b,TickUtil:O}=B.value;let Y=_.value.minPrice,E=_.value.maxPrice.indexOf("+")>0?"âˆž":_.value.maxPrice,D=Number(_.value.tick_lower_index),V=Number(_.value.tick_upper_index);const le=Number(_.value.current_tick_index);let he,ve,q=Number(Y).toString(),F=_.value.maxPrice.indexOf("+")>0||_.value.maxPrice==="âˆž"?"âˆž":Number(E);if(q=="0"&&F=="âˆž"?(D=Number(_.value.tick_lower_index),V=Number(_.value.tick_upper_index)):(he=b.priceToSqrtPriceX64(new g(Y),f.value.decimals,I.value.decimals),ve=b.priceToSqrtPriceX64(new g(E),f.value.decimals,I.value.decimals)),Z.value=D,se.value=V,E!=="âˆž"&&D>=V){m.value=!0,s.value="",c.value=!0,a.value="";return}if(E=="âˆž"||le>=D&&le<V){m.value=!1,c.value=!1;let de;if(s.value||a.value){if(r.value){const ce=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();de=new qe(ce)}else{const ce=new g(a.value).mul(Math.pow(10,I.value.decimals)).toString();de=new qe(ce)}const{liquidityAmount:be,tokenMaxA:$,tokenMaxB:x,tokenMaxAOrigin:M,tokenMaxBOrigin:oe}=B.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:I.value,lowerTick:D,upperTick:V,coinAmount:de,iscoinA:l.value?r.value:!r.value,roundUp:!0,slippage:Number(z.value)/100,curSqrtPrice:new qe(_.value.current_sqrt_price)});ie.value={liquidityAmount:be,tokenMaxA:$,tokenMaxB:x,tokenMaxAOrigin:M,tokenMaxBOrigin:oe},l.value?r.value?a.value=Number(x)>0?x:"":s.value=Number($)>0?$:"":r.value?a.value=$:s.value=x}}else if(le>=V){if(s.value="",m.value=!0,c.value=!1,s.value||a.value){let de;const be=new g(a.value).mul(Math.pow(10,(Ae=I.value)==null?void 0:Ae.decimals)).toString();de=new qe(be),ie.value={liquidityAmount:Mo(he,ve,de),tokenMaxA:0,tokenMaxB:a.value}}}else if(le<D){if(m.value=!1,c.value=!0,a.value="",s.value||a.value){let de;const be=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();de=new qe(be),ie.value={liquidityAmount:Uo(he,ve,de),tokenMaxA:s.value,tokenMaxB:0}}}else m.value=!0,s.value="",c.value=!0,a.value="";d.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,b=>{if(b&&!pe(b)){_.value=b,f.value=_.value.token_a,I.value=_.value.token_b;let O=Number(_.value.tick_lower_index),Y=Number(_.value.tick_upper_index);const E=Number(_.value.current_tick_index);(b.maxPrice.indexOf("+")>0||b.maxPrice==="âˆž"?"âˆž":b.maxPrice)=="âˆž"||E>=O&&E<Y?(m.value=!1,c.value=!1):E>=Y?(s.value="",m.value=!0,c.value=!1):E<O?(m.value=!1,c.value=!0,a.value=""):(m.value=!0,s.value="",c.value=!0,a.value=""),H()}},{immediate:!0}),ye(s,(b,O)=>{b&&H(),b==""&&(a.value="")}),ye(a,(b,O)=>{b&&H(),b==""&&(s.value="")});const C=y(()=>{var b,O;return(O=(b=_.value)==null?void 0:b.poolInfo)==null?void 0:O.needReverse}),U=y(()=>o.value.RATES),R=y(()=>{var V,le,he,ve;const b=((le=U.value[(V=f.value)==null?void 0:V.address])==null?void 0:le.price)||0,O=((ve=U.value[(he=I.value)==null?void 0:he.address])==null?void 0:ve.price)||0,Y=new g(b).mul(new g(s.value||0)),E=new g(O).mul(new g(a.value||0)),D=Y.add(E);return D.toNumber()?D.toNumber()>0&&D.toNumber()>.01?Q(D.toString(),2):"<0.01":"--"}),X=N(!1),{t:ee,locale:J}=Io(),ae=y(()=>{const b=Number(s.value)>Number(L.value),O=Number(a.value)>Number(i.value);return h.value?"Liquidity Burnt":!s.value&&!a.value?ee("button.enterAmount"):b?ee("button.insufficientBalance",{name:f.value.symbol}):O?ee("button.insufficientBalance",{name:I.value.symbol}):ee("newAdd.addMore")}),K=y(()=>{const b=Number(s.value)>Number(L.value),O=Number(a.value)>Number(i.value);return!!(h.value||!s.value&&!a.value||b||O)}),{setIsShowSuccess:ge,setIsShowRejected:j,setIsShowWaiting:ke,setTransactionDesc:Ie,setTransactionTxid:Be,setPositiomNum:Me}=P,Se=N(!1),u=async()=>{var V,le,he,ve,q,F,Ae,de,be,$,x,M;X.value=!1,Se.value=!0,Be("");const b=m.value?"":`${s.value} ${(V=f.value)==null?void 0:V.symbol}`,O=c.value?"":`${a.value} ${(le=I.value)==null?void 0:le.symbol}`;Ie(ee("tips.increaseLiquiditySuccess",{from:C.value?O:b,and:!m.value&&!c.value?"and":"",to:C.value?b:O})),ke(!0);const Y=r.value,E=_.value.poolInfo.rewarder_infos;let D={};D.coinTypeC=E[0]?E[0].coinAddress:"",D.coinTypeD=E[1]?E[1].coinAddress:"",D.coinTypeE=E[2]?E[2].coinAddress:"";try{const oe=await B.value.getAddLiquidityTransactionPayload({pool:{poolAddress:_.value.poolAddress,token_a:_.value.token_a,token_b:_.value.token_b},amount:Y?ie.value.tokenMaxA:ie.value.tokenMaxB,fix_amount_a:Y,tick_lower:Z.value,tick_upper:se.value,index:k.value==="Aptos"?_.value.index:_.value.pos_object_id,slippage:Number(z.value)/100,roundUp:!0,collect_fee:!0,...D,curSqrtPrice:new qe(_==null?void 0:_.value.poolInfo.current_sqrt_price),positionInfo:_});let ce;if(k.value==="Aptos")ce=await te.value.currentWallet.signAndSubmitTransaction(oe);else{const we=await B.value.signAndExecuteTransactionBlock(te.value.currentWallet,oe==null?void 0:oe.txb,oe==null?void 0:oe.payloadParams);ce=B.value.handleTx(we)}if(console.log("toAdd###tx###",ce),ce&&ce.hash){Be(ce.hash),ke(!1),ge(!0);const we={title:"Supplied",desc:ee("tips.addLiquiditySuccessText",{from:m.value?"":`${C.value?a.value:s.value} ${C.value?(ve=I==null?void 0:I.value)==null?void 0:ve.symbol:(he=f.value)==null?void 0:he.symbol}`,and:!m.value&&!c.value?"and":"",to:c.value?"":`${C.value?s.value:a.value} ${C.value?(F=f==null?void 0:f.value)==null?void 0:F.symbol:(q=I.value)==null?void 0:q.symbol}`}),hash:ce.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:C.value?`${(de=I.value)==null?void 0:de.address}`:`${(Ae=f.value)==null?void 0:Ae.address}`,numa:C.value?`- ${a.value}`:`- ${s.value}`,logoa:C.value?o.value.tokensObj&&I.value&&I.value.address&&o.value.tokensObj[I.value.address]&&o.value.tokensObj[I.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:C.value?`${($=f.value)==null?void 0:$.address}`:`${(be=I.value)==null?void 0:be.address}`,numb:C.value?`- ${s.value}`:`- ${a.value}`,logob:C.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&I.value&&I.value.address&&o.value.tokensObj[I.value.address]&&o.value.tokensObj[I.value.address].logoURI},text:`Deopsit ${m.value?"":`${s.value} ${(x=f.value)==null?void 0:x.symbol}`} ${!m.value&&!c.value?"and":""} ${c.value?"":`${a.value} ${(M=I.value)==null?void 0:M.symbol}`}`};k.value!=="Aptos"&&(we.res=ce.res),B.value.showTransitionPending(we),await B.value.watchTransaction(we)&&setTimeout(()=>{t.emit("getDetails"),B.value.getAccount(te.value.address)},1e3),Me()}else ke(!1),j(!0);s.value="",a.value="",Se.value=!1}catch(oe){s.value="",a.value="",console.log("addError###",oe),Se.value=!1,ke(!1),j(!0)}},h=N(!0);return{isLpBurn:h,theme:T,showFromCoinLock:m,showToCoinLock:c,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:L,toCoinBlance:i,fromCoin:f,toCoin:I,maxBtnSelect:A,halfBtnSelect:v,fixedFromCoin:r,needReverse:C,totalAmount:R,wallet:te,addLiquidityBtnText:ae,isShowLiquidityModal:X,indexStore:P,positionInfo:_,actionLoading:Se,toAdd:u,addLiquidityBtnDisabled:K,poolStore:d}}});const is={class:"new-position-asset"},ss={class:"add-or-remove"},as={class:"liquidity-action-tab"},ls=n("div",{class:"increase tab-active"}," Increase ",-1),rs={class:"card-item"},us={class:"card-item"},ds={key:1,class:"add",src:gn},cs={key:2,class:"add",src:kn},ms={class:"total-amount"},vs=n("span",null,"Total Amount",-1);function fs(e,t,s,a,P,p){var c;const T=Eo,d=bo,o=mo,m=_n;return w(),S("div",is,[n("div",ss,[n("div",as,[ls,n("div",{class:"remove",onClick:t[0]||(t[0]=r=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),n("div",{class:fo(e.needReverse?"card-container reverse":"card-container")},[e.isLpBurn?(w(),$e(T,{key:0,"is-lp-burn-pos":!0})):me("",!0),n("div",rs,[re(d,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=r=>e.fromCoinAmount=r),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:t[2]||(t[2]=r=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=r=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=r=>{e.fromCoinAmount=r}),onOnFocus:t[5]||(t[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),!e.isLpBurn&&e.showFromCoinLock?(w(),$e(T,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),n("div",us,[re(d,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[6]||(t[6]=r=>e.toCoinAmount=r),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:t[7]||(t[7]=r=>e.maxBtnSelect("toCoin")),onOnHalf:t[8]||(t[8]=r=>e.halfBtnSelect("toCoin")),onOnInput:t[9]||(t[9]=r=>{e.toCoinAmount=r}),onOnFocus:t[10]||(t[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),!e.isLpBurn&&e.showToCoinLock?(w(),$e(T,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):me("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?(w(),S("img",ds)):me("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?(w(),S("img",cs)):me("",!0)],2),n("div",ms,[vs,n("span",null,"$"+W(e.totalAmount),1)])]),e.wallet.connected?(w(),$e(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:t[11]||(t[11]=r=>e.isShowLiquidityModal=!0)},{default:Le(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):(w(),$e(o,{key:1,class:"big-btn",onClick:t[12]||(t[12]=r=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?(w(),$e(m,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(c=e.positionInfo)==null?void 0:c.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:t[13]||(t[13]=r=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):me("",!0)])}const Qo=ze(ts,[["render",fs]]),ps=Ye({components:{AssetsCard:bo},setup(e,t){const s=N(""),a=N(""),P=Xe(),p=y(()=>P),T=y(()=>p.value.theme),d=eo(),o=y(()=>d),m=N(!1),c=N(!1),r=N(!0),k=y(()=>p.value.chainName),B=y(()=>k.value?oo(k.value):{}),ne=vo(),te=y(()=>ne),z=y(()=>p.value.slippage),f=N(),I=N(),L=y(()=>{var $,x;return(x=($=l.value)==null?void 0:$.poolInfo)==null?void 0:x.needReverse}),i=y(()=>{var $;return _e(l==null?void 0:l.value.amountA,($=l==null?void 0:l.value.token_a)==null?void 0:$.decimals)}),A=y(()=>{var $;return _e(l==null?void 0:l.value.amountB,($=l==null?void 0:l.value.token_b)==null?void 0:$.decimals)}),v=$=>{$==="fromCoin"?(r.value=!0,C.value||(k.value==="Aptos"||console.log(i.value,"213===>"),s.value=String(i.value))):(r.value=!1,C.value||(k.value,a.value=String(A.value))),R.value=100,ee({value:1})},_=$=>{$==="fromCoin"?(r.value=!0,s.value=Ue(new g(Number(i.value)).div(2).toString(),f.value.decimals).toString()):(r.value=!1,a.value=Ue(new g(Number(A.value)).div(2).toString(),I.value.decimals).toString()),C.value=!1},l=N({}),ie=N(!0),Z=N({}),se=N(),H=N(),C=N(!0),U=()=>{var Ze;if(C.value||!l.value||!s.value&&!a.value||Number(s.value)>Number(i.value)||Number(a.value)>Number(A.value))return;if(s.value==i.value&&a.value==A.value){R.value=100,ee({value:1}),C.value=!0;return}const{TickMath:$,TickUtil:x}=B.value;let M=l.value.minPrice,oe=l.value.maxPrice.indexOf("+")>0?"âˆž":l.value.maxPrice,ce=Number(l.value.tick_lower_index),we=Number(l.value.tick_upper_index);const Ne=Number(l.value.current_tick_index);let Ce,Re,Ee=Number(M).toString(),De=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="âˆž"?"âˆž":Number(oe);if(Ee=="0"&&De=="âˆž"?(ce=Number(l.value.tick_lower_index),we=Number(l.value.tick_upper_index)):(Ce=$.priceToSqrtPriceX64(new g(M),f.value.decimals,I.value.decimals),Re=$.priceToSqrtPriceX64(new g(oe),f.value.decimals,I.value.decimals)),se.value=ce,H.value=we,oe!=="âˆž"&&ce>=we){m.value=!0,s.value="",c.value=!0,a.value="";return}if(oe=="âˆž"||Ne>=ce&&Ne<we){m.value=!1,c.value=!1;let Oe;if(s.value||a.value){if(r.value){const Ge=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(Ge)}else{const Ge=new g(a.value).mul(Math.pow(10,I.value.decimals)).toString();Oe=new qe(Ge)}const{liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ke,tokenMaxBOrigin:ue}=B.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:f.value,tokenB:I.value,lowerTick:ce,upperTick:we,coinAmount:Oe,iscoinA:ie.value?r.value:!r.value,roundUp:k.value!="Sui",slippage:Number(z.value)/100,curSqrtPrice:new qe(l.value.current_sqrt_price)});Z.value={liquidityAmount:je,tokenMaxA:Fe,tokenMaxB:We,tokenMaxAOrigin:Ke,tokenMaxBOrigin:ue},ie.value?r.value?a.value=Number(We)>0?We:"":s.value=Number(Fe)>0?Fe:"":r.value?a.value=Fe:s.value=We}}else if(Ne>=we){if(s.value="",m.value=!0,c.value=!1,s.value||a.value){let Oe;const je=new g(a.value).mul(Math.pow(10,(Ze=I.value)==null?void 0:Ze.decimals)).toString();Oe=new qe(je),Z.value={liquidityAmount:Mo(Ce,Re,Oe),tokenMaxA:0,tokenMaxB:a.value}}}else if(Ne<ce){if(m.value=!1,c.value=!0,a.value="",s.value||a.value){let Oe;const je=new g(s.value).mul(Math.pow(10,f.value.decimals)).toString();Oe=new qe(je),Z.value={liquidityAmount:Uo(Ce,Re,Oe),tokenMaxA:s.value,tokenMaxB:0}}}else m.value=!0,c.value=!0;C.value=!1,R.value=new g(Z.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),X.value=Z.value.liquidityAmount,d.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})},R=N(0),X=N("0"),ee=$=>{if(console.log("setPercent isSlider.value: ",C.value),!C.value)return;C.value=!0;const x=l.value.token_a.decimals,M=l.value.token_b.decimals,oe=l.value.tick_lower_index,ce=l.value.tick_upper_index,we=Po.tickIndexToSqrtPriceX64(oe),Ne=Po.tickIndexToSqrtPriceX64(ce);let Ce="";$.value!==1?Ce=new g(l.value.liquidity).mul($.value).toString():Ce=l.value.liquidity,Ce=Ue(Ce,0)||"0",X.value=Ce;const Re=vn.getCoinAmountFromLiquidity(new qe(Ce),new qe(l.value.current_sqrt_price),we,Ne,k.value!="Sui"),Ee=new g(Re.coinA.toString()).div(Math.pow(10,x)).toString(),De=new g(Re.coinB.toString()).div(Math.pow(10,M)).toString();s.value=Number(Ee)>0?Ee:"",a.value=Number(De)>0?De:"",d.setPositionActionAmount({fromCoinAmount:s,toCoinAmount:a})};ye(()=>o.value.currentPositionInfo,$=>{if($&&!pe($)){l.value=$,f.value=l.value.token_a,I.value=l.value.token_b,ee({value:R.value/100});let x=Number(l.value.tick_lower_index),M=Number(l.value.tick_upper_index);const oe=Number(l.value.current_tick_index);($.maxPrice.indexOf("+")>0||$.maxPrice==="âˆž"?"âˆž":$.maxPrice)=="âˆž"||oe>=x&&oe<M?(m.value=!1,c.value=!1):oe>=M?(s.value="",m.value=!0,c.value=!1):oe<x?(m.value=!1,c.value=!0,a.value=""):(m.value=!0,s.value="",c.value=!0,a.value=""),U()}},{immediate:!0}),ye(s,($,x)=>{$&&U(),$==""&&(a.value="",R.value=0)}),ye(a,($,x)=>{$&&U(),$==""&&(s.value="",R.value=0)});const J=y(()=>o.value.RATES),ae=y(()=>{var we,Ne,Ce,Re;const $=((Ne=J.value[(we=f.value)==null?void 0:we.address])==null?void 0:Ne.price)||0,x=((Re=J.value[(Ce=I.value)==null?void 0:Ce.address])==null?void 0:Re.price)||0,M=new g($).mul(new g(s.value||0)),oe=new g(x).mul(new g(a.value||0)),ce=M.add(oe);return Q(ce.toString(),2)}),K=N(!1),{t:ge,locale:j}=Io(),ke=y(()=>{const $=Number(s.value)>Number(i.value),x=Number(a.value)>Number(A.value);return be.value?"Liquidity Burnt":!s.value&&!a.value?ge("button.enterAmount"):$||x?"Invalid Amount":ge("button.remove")}),Ie=y(()=>{const $=Number(s.value)>Number(i.value),x=Number(a.value)>Number(A.value);return!!(be.value||!s.value&&!a.value||$||x)}),{setIsShowSuccess:Be,setIsShowRejected:Me,setIsShowWaiting:Se,setTransactionDesc:u,setTransactionTxid:h,setPositiomNum:b,setTransactionDescText:O}=P,Y=N(!1);ye(R,ln(($,x)=>{$!==x&&(Number($)>100?R.value=100:$&&l.value?(R.value=$,ee({value:R.value/100})):(s.value="",a.value=""))},300)),ye(z,$=>{$&&l.value&&ee({value:R.value/100})});const E=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],D=Do(),V=y(()=>D),le=y(()=>V.value.status),he=N(!1),ve=$=>{$.sources.forEach(M=>{const{pool_address:oe,position_index:ce}=JSON.parse(M.blockchainAddress);oe==l.value.poolAddress&&Number(ce)==Number(l.value.index)&&(he.value=!0)})},q=async()=>{await D.getSources();let $;V.value.allSources.forEach(x=>{const{pool_address:M,position_index:oe}=JSON.parse(x.blockchainAddress);M==l.value.poolAddress&&oe==l.value.index&&($=x.id)}),D.deleteSource($)};ye(()=>[V.value.sourceGroups,l.value],([$,x])=>{$&&$.sources&&$.sources.length>0&&x&&!pe(x)&&ve($)},{immediate:!0,deep:!0});const F=ro(),Ae=po(),de=async()=>{var ce,we,Ne,Ce,Re,Ee,De,Ze,Oe,je,Fe,We,Ke;Y.value=!0,h("");const $=Q(s.value,f.value.decimals)==0?"":`${_e(s.value,f.value.decimals)} ${f.value.symbol}`,x=Q(a.value,I.value.decimals)==0?"":`${_e(a.value,I.value.decimals)} ${I.value.symbol}`;u(ge("tips.removeLiquidiyText",{from:L.value?x:$,and:Q(s.value,f.value.decimals)==0||Q(a.value,I.value.decimals)==0?"":"and",to:L.value?$:x})),Se(!0);const M=l.value.poolInfo.rewarder_infos,oe=M&&M.length>0&&k.value=="Sui"||M&&M.length>0&&R.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");O(oe);try{let ue={};ue={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:R.value==100?new qe(l.value.liquidity):new qe(Ue(X.value,0)),slippage:Number(z.value),rewards_num:M.length,positionInfo:l.value},ue.coinTypeC=M[0]?M[0].coinAddress:"",ue.coinTypeD=M[1]?M[1].coinAddress:"",ue.coinTypeE=M[2]?M[2].coinAddress:"";const Ge=await B.value.getRemoveLiquidityTransactionPayload(ue);let He;if(k.value==="Aptos")He=await te.value.currentWallet.signAndSubmitTransaction(Ge);else{const uo=await B.value.signAndExecuteTransactionBlock(te.value.currentWallet,Ge.txb,Ge==null?void 0:Ge.payloadParams);He=B.value.handleTx(uo),console.log("0331###remove###tx####",He)}if(He&&He.hash){h(He.hash),Se(!1),Be(!0);const uo={title:ge("common.removeLiquidity"),desc:"",hash:He.hash,descTransactions:`Remove ${s.value} ${(ce=f.value)==null?void 0:ce.symbol} and ${a.value} ${(we=I.value)==null?void 0:we.symbol} 
             from the pool`,sender:te.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:L.value?`${(Ce=I.value)==null?void 0:Ce.address}`:`${(Ne=f.value)==null?void 0:Ne.address}`,numa:L.value?`+ ${a.value}`:`+ ${s.value}`,logoa:L.value?o.value.tokensObj&&I.value&&I.value.address&&o.value.tokensObj[I.value.address]&&o.value.tokensObj[I.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI,tokenb:L.value?`${(Re=f.value)==null?void 0:Re.address}`:`${(Ee=I.value)==null?void 0:Ee.address}`,numb:L.value?`+ ${s.value}`:`+ ${a.value}`,logob:L.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&I.value&&I.value.address&&o.value.tokensObj[I.value.address]&&o.value.tokensObj[I.value.address].logoURI},text:`Withdraw ${s.value} ${(De=f.value)==null?void 0:De.symbol} and ${a.value} ${(Ze=I.value)==null?void 0:Ze.symbol}`};k.value!=="Aptos"&&(uo.res=He.res),B.value.showTransitionPending(uo);const Ao=await B.value.watchTransaction(uo);if(M.value&&M.value.length>0&&(Number((Oe=M[0])==null?void 0:Oe.amount)!==0||ue.coinTypeD&&Number((je=M[1])==null?void 0:je.amount)!==0||ue.coinTypeE&&Number((Fe=M[2])==null?void 0:Fe.amount)!==0)){const go={title:ge("common.removeLiquidity"),desc:"",hash:He.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:M[0].symbol,numa:`+ ${Number(M[0].amount)}`,logoa:o.value.tokensObj&&M[0]&&M[0].address&&o.value.tokensObj[M[0].address]&&o.value.tokensObj[M[0].address].logoURI,tokenb:ue.coinTypeD?M[1].symbol:"",numb:ue.coinTypeD?`+ ${Number(M[1].amount)}`:"",logob:ue.coinTypeD?o.value.tokensObj&&M[1]&&M[1].address&&o.value.tokensObj[M[1].address]&&o.value.tokensObj[M[1].address].logoURI:"",tokenc:ue.coinTypeE?M[2].symbol:"",numc:ue.coinTypeE?`+ ${Number(M[2].amount)}`:"",logoc:ue.coinTypeE?o.value.tokensObj&&M[2]&&M[2].address&&o.value.tokensObj[M[2].address]&&o.value.tokensObj[M[2].address].logoURI:""},text:`Withdraw ${s.value} ${(We=f.value)==null?void 0:We.symbol} and ${a.value} ${(Ke=I.value)==null?void 0:Ke.symbol}`},xo=await B.value.setTransations(go)}if(Pe(l.value.feeOwedA,l.value.token_a.decimals)!==0||Pe(l.value.feeOwedB,l.value.token_b.decimals)!==0){const go={title:"Claim",desc:"",hash:He.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Pe(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Pe(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},xo=await B.value.setTransations(go)}Ao&&Number(R.value)==100&&le.value=="authenticated"&&he.value&&(await D.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),q()),Ao&&(s.value="",a.value="",setTimeout(()=>{Number(R.value)!==100&&t.emit("getDetails")},3e3),setTimeout(()=>{Number(R.value)!==100&&t.emit("getDetails")},6e3),Number(R.value)==100&&Ae.name=="new-position-detail"&&(k.value==="Aptos"?F.push("/position"):F.push("/pool/position")),R.value=0)}else Se(!1),Me(!0);Y.value=!1}catch(ue){console.log("Remove error",ue),Y.value=!1,Se(!1),Me(!0)}},be=N(!0);return{isLpBurn:be,theme:T,showFromCoinLock:m,showToCoinLock:c,toCoinAmount:a,fromCoinAmount:s,fromCoinBlance:i,toCoinBlance:A,fromCoin:f,toCoin:I,maxBtnSelect:v,halfBtnSelect:_,fixedFromCoin:r,needReverse:L,totalAmount:ae,wallet:te,addLiquidityBtnText:ke,isShowLiquidityModal:K,indexStore:P,positionInfo:l,actionLoading:Y,addLiquidityBtnDisabled:Ie,sliderVal:R,ratioArr:E,setPercent:ee,poolStore:d,isSlider:C,toRemove:de,sFixD:Ue}}});const hs={class:"new-position-asset"},bs={class:"add-or-remove"},gs={class:"liquidity-action-tab"},ks=n("div",{class:"remove tab-active"},"Remove",-1),_s={class:"card-item"},ws={key:0,class:"assets-card-mask"},ys={class:"card-item"},Is={key:0,class:"assets-card-mask"},As={class:"remove-ratio"},Cs=n("div",{class:"remove-ratio-title"},"Amount",-1),$s={class:"remove-ratio-select"},Ss={key:0,class:"ratio"},Ps={key:1,class:"ratio"},Ts={class:"ratio-list"},Ns=["onClick"];function Rs(e,t,s,a,P,p){const T=Eo,d=bo,o=rn,m=mo;return w(),S("div",hs,[n("div",bs,[n("div",gs,[n("div",{class:"increase",onClick:t[0]||(t[0]=c=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),ks]),n("div",{class:fo(e.needReverse?"card-container reverse":"card-container")},[e.isLpBurn?(w(),$e(T,{key:0,"is-lp-burn-pos":!0})):me("",!0),n("div",_s,[re(d,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":t[1]||(t[1]=c=>e.fromCoinAmount=c),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[2]||(t[2]=c=>e.maxBtnSelect("fromCoin")),onOnHalf:t[3]||(t[3]=c=>e.halfBtnSelect("fromCoin")),onOnInput:t[4]||(t[4]=c=>{e.fromCoinAmount=c,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?(w(),S("div",ws)):me("",!0)]),n("div",ys,[re(d,{modelValue:e.toCoinAmount,"onUpdate:modelValue":t[5]||(t[5]=c=>e.toCoinAmount=c),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:t[6]||(t[6]=c=>e.maxBtnSelect("toCoin")),onOnHalf:t[7]||(t[7]=c=>e.halfBtnSelect("toCoin")),onOnInput:t[8]||(t[8]=c=>{e.toCoinAmount=c,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?(w(),S("div",Is)):me("",!0)])],2),n("div",As,[Cs,n("div",$s,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?(w(),S("div",Ss,W(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:G(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:G(Ue))(e.sliderVal,2))+"% ",1)):(w(),S("div",Ps," -- ")),n("div",Ts,[(w(!0),S(xe,null,io(e.ratioArr,(c,r)=>(w(),S("div",{key:r,class:fo(["ratio-item",e.sliderVal==c.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=c.value}},W(c.name),11,Ns))),128))])]),re(o,{value:e.sliderVal,"onUpdate:value":t[9]||(t[9]=c=>e.sliderVal=c)},null,8,["value"])])]),e.wallet.connected?(w(),$e(m,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Le(()=>[n("span",null,W(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):(w(),$e(m,{key:1,class:"big-btn",onClick:t[10]||(t[10]=c=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Le(()=>[n("span",null,W(e.$t("button.connectWallet")),1)]),_:1}))])}const Zo=ze(ps,[["render",Rs]]),Os=Ye({setup(){const e=eo(),t=y(()=>e),s=Fo(),a=y(()=>s),P=ro(),p=y(()=>t.value.currentPositionInfo),T=N(),d=H=>{var C;return((C=t.value.tokensObj[H])==null?void 0:C.logo_url)||so("/image/coins/sui-unknown.png")},o=nn("Sui"),m=N(),c=async H=>{m.value=0;try{const C=await o.calculateFarmingRewards([{pool_id:H.pool_id,position_nft_id:H.id}]),U=[];let R=new g(0);C[H.id].forEach((X,ee)=>{var K;const J=(K=t.value.tokensObj[X.rewarder_type])==null?void 0:K.decimals;let ae=new g(X.rewarder_amount).div(Math.pow(10,J)).toString();Number(ae)>0&&k.value.rewarders[ee]&&(R=R.add(ae),U.push({...X,rewarderAmount:ae,rewarderAmountPer:ae}))}),m.value=R,T.value=U}catch(C){console.log(C,"getRewarder")}},r=y(()=>a.value.farmsPoolObj),k=y(()=>r.value[p.value.poolAddress]);ye(()=>[p.value,r.value,k.value],([H,C,U])=>{var R;!pe(H)&&H.positionSource=="farming"&&!pe(U)?c(H):!pe(C)&&!pe(H)&&(T.value=(R=C[H.poolAddress])==null?void 0:R.rewarders)},{immediate:!0});const B=vo(),ne=y(()=>B),te=Xe(),z=oo("Sui"),{setIsShowSuccess:f,setIsShowRejected:I,setIsShowWaiting:L,setTransactionDesc:i,setTransactionTxid:A}=te,v=N(!1),_=async()=>{v.value=!0,A(""),i("Claim rewards"),L(!0);const H={pool_id:p.value.pool_id,position_nft_id:p.value.id};try{const C=await o.harvestFarms(H),U=await z.signAndExecuteTransactionBlock(ne.value.currentWallet,C.txb,C.payloadParams);console.log("0221###sui swap res###",U);let R=z.handleTx(U);if(R&&R.hash){A(R.hash),L(!1),f(!0);let X={title:"Claim",res:R.res,hash:R.hash};z.showTransitionPending(X),await z.watchTransaction(X)&&setTimeout(()=>{c(p.value),z.getAccount(ne.value.address)},2e3)}else L(!1),I(!0);v.value=!1}catch(C){console.log("farmsDeposit error",C),L(!1),I(!0),v.value=!1}},l=async()=>{v.value=!0,A(""),i(`Unstake ${p.value.name}`),L(!0);const H=p.value.pool_id,C=p.value.id;try{const U=await o.farmsWithdraw(H,C),R=await z.signAndExecuteTransactionBlock(ne.value.currentWallet,U.txb,U.payloadParams);console.log("0221###sui swap res###",R);let X=z.handleTx(R);if(X&&X.hash){A(X.hash),L(!1),f(!0);let ee={res:X.res,title:"Unstake",hash:X.hash};z.showTransitionPending(ee),await z.watchTransaction(ee)&&setTimeout(()=>{P.replace(`/new-position-detail?token=${p.value.tokenName}&address=${p.value.clmm_pool_id}&pos=${p.value.clmm_position_id}`),t.value.setCurrentPositionInfo(p.value.clmm_pool_id,"",p.value.tokenName,"Sui",p.value.clmm_position_id),m.value=0,v.value=!1},2e3)}else L(!1),I(!0)}catch(U){console.log("farmsDeposit error",U),L(!1),I(!0),v.value=!1}},ie=async()=>{v.value=!0,A(""),i(`Stake ${p.value.name}`),L(!0);const H={clmm_pool_id:p.value.poolAddress,clmm_position_id:p.value.pos_object_id,coinTypeA:p.value.coin_type_a,coinTypeB:p.value.coin_type_b},C=r.value[p.value.poolAddress].id;try{const U=await o.farmsDeposit(H,C),R=await z.signAndExecuteTransactionBlock(ne.value.currentWallet,U.txb,U.payloadParams);console.log("0221###sui swap res###",R);let X=z.handleTx(R);if(X&&X.hash){A(X.hash),L(!1),f(!0);let ee={res:X.res,title:"Staked",hash:X.hash};z.showTransitionPending(ee);const J=await z.watchTransaction(ee,!0);let ae;J!=null&&J.status&&setTimeout(async()=>{var K,ge;(ge=(K=J==null?void 0:J.res)==null?void 0:K.events)==null||ge.forEach(j=>{j.type.indexOf("::pool::DepositEvent")>-1&&(ae=j.parsedJson.wrapped_position_id)}),P.replace(`/new-position-detail?position_nft_id=${ae}&positionSource=farming`),await t.value.setCurrentPositionInfo("","","","Sui",ae,"farming"),v.value=!1},2e3)}else L(!1),I(!0)}catch(U){console.log("farmsDeposit error",U),L(!1),I(!0),v.value=!1}},Z=y(()=>te),se=y(()=>Z.value.addressLpTokens);return{getCoinIcon:d,rewardList:T,sFixD:Ue,addCommom:Q,claim:_,unStake:l,loading:v,totalRewardAmount:m,currentPositionInfo:p,stake:ie,farmsPoolObj:r,addressLpTokens:se,farmsPoolInfo:k}}});const no=e=>(ao("data-v-b105cc87"),e=e(),lo(),e),qs={key:0,class:"farms-position-detail"},Ls={class:"farms-top"},Bs=no(()=>n("div",{class:"left"},[n("div",{class:"title"},"Farming"),n("div",{class:"desc"},"Stake Position to Earn")],-1)),Ms={class:"right"},Us={class:"apr"},js={class:"apr-tips-box"},Es=no(()=>n("span",null,"View",-1)),Ds=no(()=>n("svg",{class:"arrow-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-icon_arrow"})],-1)),Fs=[Es,Ds],Ws={class:"farms-bottom"},Hs=no(()=>n("div",{class:"title"},"Farming Rewards",-1)),Xs={key:0,class:"reward-list"},Ys={key:0,class:"rewards-item-bg"},zs={class:"rewards-item-box"},Gs={alt:""},Js={key:1},Qs={class:"rewards-item-bg"},Zs={class:"rewards-item-box"},Ks={alt:""},Vs=no(()=>n("span",null,"0",-1)),xs={key:1,class:"reward-list"},ea={key:0,class:"rewards-item-bg"},oa={class:"rewards-item-box"},na={alt:""},ta=no(()=>n("span",null,"0",-1)),ia={key:1},sa={class:"rewards-item-bg"},aa={class:"rewards-item-box"},la={alt:""},ra=no(()=>n("span",null,"0",-1)),ua={class:"actions-box"};function da(e,t,s,a,P,p){var c,r,k;const T=wn,d=mo,o=Lo,m=yo("image");return e.farmsPoolObj&&e.farmsPoolObj[e.currentPositionInfo.poolAddress]&&e.farmsPoolObj[e.currentPositionInfo.poolAddress].status=="Live"||e.currentPositionInfo.positionSource=="farming"?(w(),S("div",qs,[n("div",Ls,[Bs,n("div",Ms,[n("div",Us,[fe(" APRÂ  "),n("span",null,[fe(W(("addCommom"in e?e.addCommom:G(Q))(((c=e.farmsPoolInfo)==null?void 0:c.total_apr)*100,2))+"%Â  ",1),n("div",js,[re(T,{"l-item":e.farmsPoolInfo,"rewarder-info":(k=(r=e.farmsPoolInfo)==null?void 0:r.rewarder)==null?void 0:k.rewardList},null,8,["l-item","rewarder-info"])])])]),n("div",{class:"view",onClick:t[0]||(t[0]=B=>e.$router.push("/farms"))},Fs)])]),n("div",Ws,[Hs,e.rewardList&&e.rewardList.length>0?(w(),S("div",Xs,[(w(!0),S(xe,null,io(e.rewardList,B=>(w(),S("div",{key:B,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(w(),S("div",Ys,[n("div",zs,[Te(n("img",Gs,null,512),[[m,e.getCoinIcon(B.rewarder_type)]]),n("span",null,W(("addCommom"in e?e.addCommom:G(Q))(B.rewarderAmount||0)),1)])])):(w(),S("div",Js,[n("div",Qs,[n("div",Zs,[Te(n("img",Ks,null,512),[[m,e.getCoinIcon(B.reward_coin)]]),Vs])])]))]))),128))])):(w(),S("div",xs,[(w(!0),S(xe,null,io(e.currentPositionInfo.rewards,B=>(w(),S("div",{key:B,class:"rewards-item"},[e.currentPositionInfo.positionSource=="farming"?(w(),S("div",ea,[n("div",oa,[Te(n("img",na,null,512),[[m,e.getCoinIcon(B.rewarder_type)]]),ta])])):(w(),S("div",ia,[n("div",sa,[n("div",aa,[Te(n("img",la,null,512),[[m,e.getCoinIcon(B.reward_coin)]]),ra])])]))]))),128))])),n("div",ua,[e.currentPositionInfo&&e.currentPositionInfo.positionSource=="farming"?(w(),$e(d,{key:0,class:"unstake-btn",loading:e.loading,onClick:e.unStake},{default:Le(()=>[fe("Unstake")]),_:1},8,["loading","onClick"])):me("",!0),e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"&&e.currentPositionInfo.currentStatus!=="Active"?(w(),$e(o,{key:1},{title:Le(()=>[fe("Farming rewards are only available for active positions.")]),default:Le(()=>[re(d,{class:"unstake-btn",loading:e.loading,disabled:!0,onClick:e.stake},{default:Le(()=>[fe("Stake")]),_:1},8,["loading","onClick"])]),_:1})):e.currentPositionInfo&&e.currentPositionInfo.positionSource=="clmm"?(w(),$e(d,{key:2,class:"unstake-btn",loading:e.loading,onClick:e.stake},{default:Le(()=>[fe("Stake")]),_:1},8,["loading","onClick"])):me("",!0),re(d,{class:"unstake-btn btn-margin",loading:e.loading,disabled:e.totalRewardAmount==0||e.currentPositionInfo&&e.currentPositionInfo.positionSource!=="farming",onClick:Bo(e.claim,["stop"])},{default:Le(()=>[fe("â†‘ Claim")]),_:1},8,["loading","disabled","onClick"])])])])):me("",!0)}const Ko=ze(Os,[["render",da],["__scopeId","data-v-b105cc87"]]),ca=Ye({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const t=Do(),s=y(()=>t),a=y(()=>s.value.status),P=Xe(),p=N(!1);ye(()=>a.value,m=>{m=="authenticated",p.value=!1},{immediate:!0});const T=N(!1),d=async()=>{T.value=!T.value;const m={pool_address:e.positionInfo.poolAddress||e.positionInfo.clmm_pool_id,position_index:e.positionInfo.index||e.positionInfo.name.split("-")[1]},c=e.positionInfo.clmm_position_id||e.positionInfo.nftHash;try{await t.subscribePosition(m,c,T.value)}catch{T.value=!T.value}},o=m=>{const c=m.sources;console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:172 ~ getPositionNotifiStatus ~ sources:",c),T.value=c.some(r=>JSON.parse(r.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(r.blockchainAddress).position_index)==(Number(e.positionInfo.index)||Number(e.positionInfo.name.split("-")[1])))};return ro(),ye(()=>[s.value.sourceGroups,e.positionInfo],([m,c])=>{T.value=!1,m&&m.length>0&&m[0]&&c&&!pe(c)&&(console.log("ðŸš€ðŸš€ðŸš€ ~ file: new-position-notifi.vue:206 ~ setup ~ getPositionNotifiStatus:"),o(m[0]))},{immediate:!0,deep:!0}),{importIcon:so,isShowSetUp:p,changeSwitch:d,checked:T,notifiStatus:a,store:P}}});const ma=e=>(ao("data-v-1a37a36d"),e=e(),lo(),e),va={class:"range-alerts"},fa={class:"range-alerts-top"},pa={class:"title"},ha=ma(()=>n("div",{class:"title-all"},[n("span",{class:"Range"},"Range Alerts")],-1)),ba={key:1,class:"h5-switch-box"},ga={class:"range-alerts-bottom"},ka={key:0,class:"pc-switch-box"};function _a(e,t,s,a,P,p){const T=mo,d=un;return w(),S("div",va,[n("div",fa,[n("div",pa,[ha,e.isShowSetUp||e.notifiStatus!=="authenticated"?(w(),$e(T,{key:0,class:"range-alerts-button",onClick:t[0]||(t[0]=Bo(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Le(()=>[fe(" Set up ")]),_:1})):me("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(w(),S("div",ba,[re(d,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])]),n("div",ga,[fe(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?(w(),S("div",ka,[re(d,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):me("",!0)])])}const Vo=ze(ca,[["render",_a],["__scopeId","data-v-1a37a36d"]]),wa=Ye({components:{NewPositionTitle:Yo,NewPositionInfo:Go,NewPositionLiquidity:Jo,NewPositionAssetAdd:Qo,NewPositionAssetRemove:Zo,NewPositionNotifi:Vo,FarmsPositionDetail:Ko},setup(){const e=N(),t=N(),s=N(),a=Xe(),P=y(()=>a),p=y(()=>P.value.chainName),T=eo(),d=y(()=>T),o=Fo(),m=y(()=>o),c=ro();Oo(()=>{e.value={},T.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),d.value.setCurrentPositionLoading(!0)});const r=async()=>{d.value.setCurrentPositionLoading(!0);const i=c.currentRoute.value.query.token||"",A=c.currentRoute.value.query.collect||"",v=c.currentRoute.value.query.address||"",_=c.currentRoute.value.query.pos||"",l=c.currentRoute.value.query.id||"",ie=c.currentRoute.value.query.positionSource||"",Z=c.currentRoute.value.query.position_nft_id||"";p.value==="Aptos"?i&&A&&v&&d.value.setCurrentPositionInfo(v,A,i,p.value):i&&v&&_?d.value.setCurrentPositionInfo(v,A,i,p.value,_):l&&!ie?d.value.setCurrentPositionInfo("","","",p.value,l):d.value.setCurrentPositionInfo("","","",p.value,Z,ie)};ye(()=>d.value.poolConfigObj,i=>{i&&!pe(i)&&r()},{immediate:!0});const k=y(()=>d.value.currentPositionLoading),B=y(()=>{var A,v,_;const i=((_=(v=(A=c==null?void 0:c.currentRoute)==null?void 0:A.value)==null?void 0:v.query)==null?void 0:_.address)||"";return i&&d.value.addressLpTokens&&!pe(d.value.addressLpTokens)&&d.value.addressLpTokens[i]?d.value.addressLpTokens[i]:null});ye(()=>B.value,(i,A)=>{i&&!pe(i)&&(e.value=i),i&&!pe(i)&&i.current_sqrt_price!==(A==null?void 0:A.current_sqrt_price)&&r()},{immediate:!0});const ne=po();ye(()=>[d.value.currentPositionInfo,p.value],([i,A])=>{var v;(A=="Aptos"&&i||A=="Sui"&&i&&(i==null?void 0:i.nftHash)==((v=ne==null?void 0:ne.query)==null?void 0:v.pos))&&(e.value=i,t.value=e.value.token_a,s.value=e.value.token_b)},{immediate:!0});const te=y(()=>d.value.positionDetailCurrentTab),z=vo(),f=y(()=>z);y(()=>P.value.theme);const I=y(()=>p.value?oo(p.value):{}),L=()=>{r(),f.value.address&&I.value.getAccount(f.value.address)};return ye(()=>e.value,i=>{var A,v,_,l;((i==null?void 0:i.positionSource)==="farming"||(A=i==null?void 0:i.poolInfo)!=null&&A.stable_farming)&&!((_=(v=m==null?void 0:m.value)==null?void 0:v.farmsPoolObj)!=null&&_[i==null?void 0:i.poolAddress])&&!((l=m==null?void 0:m.value)!=null&&l.farmsPoolListLoading)&&m.value.getFarmsPoolList(!1)},{deep:!0}),Ro(()=>{T.clearCurrentPositionInfo()}),{positionInfo:e,fromCoin:t,toCoin:s,getDetails:r,currentPositionLoading:k,positionDetailCurrentTab:te,clickRefresh:L,chainName:p}}});const ya={class:"new-position-detail"},Ia={class:"new-position-content"},Aa={class:"left"},Ca={class:"right"},$a={class:"loading-global"};function Sa(e,t,s,a,P,p){const T=Yo,d=Go,o=Jo,m=Qo,c=Zo,r=Ko,k=Vo,B=dn;return w(),S("div",ya,[re(T,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),n("div",Ia,[n("div",Aa,[re(d),re(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),n("div",Ca,[e.positionDetailCurrentTab=="increase"?(w(),$e(m,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):(w(),$e(c,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),re(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),e.chainName=="Sui"?(w(),$e(r,{key:2})):me("",!0),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="âˆž"&&e.chainName=="Sui"?(w(),$e(k,{key:3,"position-info":e.positionInfo},null,8,["position-info"])):me("",!0)])]),Te(n("div",$a,[re(B)],512),[[qo,e.currentPositionLoading]])])}const tl=ze(wa,[["render",Sa],["__scopeId","data-v-4f69962b"]]);export{tl as default};
