import{a as W,C as ye,o as u,f as _,F as I,E as ee,G as T,h as e,I as ne,x as y,u as h,e as G,r as p,m as $,c as V,w as E,i as D,j as z,$ as Se,B as ue,p as se,k as te,A as ie,y as Ue,D as Ce,Y as De,K as Le,P as xe,N as Re,S as Oe}from"./entry.a85dcc8c.js";import"./index.de9b153c.js";import{B as L,a as de}from"./common.58ad47a8.js";import{u as Ye,c as Pe,b as Ae,a as ce}from"./index.a6e74e8d.js";import{u as Te}from"./index.d5fbf89e.js";/* empty css              *//* empty css              *//* empty css              */import{_ as je}from"./coin-pair-name.a8fe150f.js";import"./decimal.a2826370.js";import{N as Ee}from"./no-data.3e3337ec.js";import{D as r}from"./decimal.765d8738.js";const Be={key:0,class:"claim-list"},Fe={class:"left"},qe={alt:""},He={class:"right"},Me=W({__name:"claim-list",props:{myClaimList:{type:Object,default:()=>[]}},setup(o){return(b,v)=>{const w=ye("image");return o.myClaimList&&o.myClaimList.length>0?(u(),_("div",Be,[(u(!0),_(I,null,ee(o.myClaimList,i=>(u(),_("div",{key:i,class:"claim-item"},[e("div",Fe,[ne(e("img",qe,null,512),[[w,i.logo_url]]),e("span",null,y(i.symbol),1)]),e("div",He,[e("span",null,y(h(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",null,y(h(L)(i.amountUSD,2,!1,!1)),1)])]))),128))])):T("",!0)}}});const be=G(Me,[["__scopeId","data-v-599f12bc"]]),B=p(!1),M=p(!1),ke=Ye(),{setIsShowSuccess:Ve,setIsShowRejected:pe,setIsShowWaiting:Q,setTransactionDesc:ze,setTransactionTxid:we}=ke,We=Pe("Sui"),X=Ae("Sui"),Ge=Te(),ge=$(()=>Ge),$e=ce(),Ke=$(()=>$e),Ze=$(()=>ke),Je=async o=>{M.value=!0;try{const b=[],v=[];o.forEach(c=>{const Y=c.rewarderInfo.filter(U=>U.emissionsEveryDay>0).map(U=>U.coinAddress);c.positionSource=="clmm"?b.push({pool_id:c.pool,pos_id:c.pos_object_id,collect_fee:!0,rewarder_coin_types:Y,coinTypeA:c.coin_type_a,coinTypeB:c.coin_type_b}):v.push({pool_id:c.pool_id,position_nft_id:c.id,clmm_pool_id:c.clmm_pool_id,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:Y,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB})}),we(""),ze("Claim Yield"),Q(!0);const w=await We.batchHarvestAndClmmFee(v,b),i=await X.signAndExecuteTransactionBlock(ge.value.currentWallet,w.txb,w.payloadParams),C=X.handleTx(i);if(C&&C.hash){we(C.hash),Q(!1),Ve(!0);const c={title:"Claim",desc:"Claim Yield",hash:C.hash};c.res=C.res,X.showTransitionPending(c),await X.watchTransaction(c)&&setTimeout(()=>{$e.getMyPositons(ge.value.address,Ke.value.poolsObj,Ze.value.chainName)},1e3)}else Q(!1),pe(!0);M.value=!1,B.value=!1}catch(b){M.value=!1,Q(!1),pe(!0),B.value=!1,console.log("batchHarvestAndClmmFee error:",b)}},re=o=>(se("data-v-c84b105c"),o=o(),te(),o),Qe={class:"claim-yield-content"},Xe={class:"total-claim"},Ie=re(()=>e("div",null,"Total Claim",-1)),es={class:"total-claim-usd"},ss=re(()=>e("svg",{"aria-hidden":"true",class:"back-icon"},[e("use",{"xlink:href":"#icon-icon-back"})],-1)),ts=re(()=>e("span",null,"Back",-1)),as=[ss,ts],ls=W({__name:"claim-yield",props:{pendingYield:{type:Number,default:0},myClaimList:{type:Object,default:()=>[]},myClaimPositionList:{type:Object,default:()=>[]}},setup(o){return(b,v)=>{const w=ue;return u(),V(h(Se),{class:"new-modal-have-btn",title:"Claim Yield",visible:!0,footer:null,width:"440px",onCancel:v[2]||(v[2]=i=>b.$emit("close"))},{default:E(()=>[e("div",Qe,[e("div",Xe,[Ie,e("div",es,y(o.pendingYield>0&&o.pendingYield<.01?"<$0.01":`$${h(de)(o.pendingYield,2)}`),1)]),D(be,{"my-claim-list":o.myClaimList},null,8,["my-claim-list"]),e("div",{class:"choose-amount",onClick:v[0]||(v[0]=i=>b.$emit("chooseAmount"))},as),D(w,{class:"confirm-btn modal-bottom-btn",loading:h(M),onClick:v[1]||(v[1]=i=>h(Je)(o.myClaimPositionList))},{default:E(()=>[z("Confirm")]),_:1},8,["loading"])])]),_:1})}}});const os=G(ls,[["__scopeId","data-v-c84b105c"]]),Ne=o=>(se("data-v-b3ccd801"),o=o(),te(),o),ns={class:"fees-and-reward"},is={key:0,class:"fees"},ds={class:"fees-title"},us=Ne(()=>e("div",null,"Fees",-1)),cs={alt:""},rs={class:"symbol"},_s={class:"amount"},vs={class:"amount-usd"},ms={key:1,class:"fees"},fs={class:"fees-title"},hs=Ne(()=>e("div",null,"Mining rewards",-1)),ps={alt:""},ws={class:"symbol"},gs={class:"amount"},ys={class:"amount-usd"},Ss=W({__name:"fees-and-reward",props:{pendingRewarderList:{type:Object,default:()=>[]},pendingFeesList:{type:Object,default:()=>[]},rewarderUsd:{type:String,default:""},feeOwedUsd:{type:String,default:""}},setup(o){return(b,v)=>{const w=ye("image");return u(),_("div",ns,[o.feeOwedUsd&&o.feeOwedUsd>0?(u(),_("div",is,[e("div",ds,[us,e("div",null,y(h(L)(o.feeOwedUsd,2,!1,!1)),1)]),(u(!0),_(I,null,ee(o.pendingFeesList,i=>(u(),_("div",{key:i,class:"fees-details"},[e("div",null,[ne(e("img",cs,null,512),[[w,i.logo_url]]),e("span",rs,y(i.symbol),1)]),e("div",null,[e("span",_s,y(h(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",vs,"("+y(h(L)(i.amountUSD,2,!1,!1))+")",1)])]))),128))])):T("",!0),o.rewarderUsd&&o.rewarderUsd>0?(u(),_("div",ms,[e("div",fs,[hs,e("div",null,y(h(L)(o.rewarderUsd,2,!1,!1)),1)]),(u(!0),_(I,null,ee(o.pendingRewarderList,i=>(u(),_("div",{key:i,class:"fees-details"},[e("div",null,[ne(e("img",ps,null,512),[[w,i.logo_url]]),e("span",ws,y(i.symbol),1)]),e("div",null,[e("span",gs,y(h(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",ys,"("+y(h(L)(i.amountUSD,2,!1,!1))+")",1)])]))),128))])):T("",!0)])}}});const bs=G(Ss,[["__scopeId","data-v-b3ccd801"]]),j=o=>(se("data-v-d3e797d2"),o=o(),te(),o),ks={class:"yield-details-box"},$s={class:"yield-details"},Ns={class:"total-claim"},Us=j(()=>e("div",null,"Pending Yield",-1)),Cs={class:"total-claim-usd"},Ds={class:"position-detail"},Ls={class:"position-detail-top"},xs=j(()=>e("div",{class:"left"},"Position",-1)),Rs={class:"right plus-switch plus-liquidity-switch"},Os=j(()=>e("span",null,"Hide yield < ",-1)),Ys={class:"position-detail-bottom"},Ps={class:"item-top"},As={class:"left"},Ts={class:"bottom"},js={class:"right"},Es=["onClick"],Bs={key:0,"aria-hidden":"true"},Fs=j(()=>e("use",{"xlink:href":"#icon-icon_sel"},null,-1)),qs=[Fs],Hs={class:"item-bottom"},Ms=j(()=>e("div",{class:"left"}," Pending Yield ",-1)),Vs={class:"right"},zs={key:0,class:"yield-amount"},Ws={key:1,class:"yield-amount-zero"},Gs={class:"select"},Ks={class:"all"},Zs=j(()=>e("use",{"xlink:href":"#icon-icon_sel"},null,-1)),Js=[Zs],Qs=j(()=>e("span",null,"Select all",-1)),Xs={class:"amount-selected"},Is=j(()=>e("div",null,"Amount selected",-1)),et=W({__name:"yield-details",props:{positionShowList:{type:Object,default:()=>[]},isShowYiedlDetails:{type:Boolean,default:!1}},emits:["showClaimYiedl"],setup(o,{emit:b}){const v=p(!0),w=p(!0),i=b,C=o,c=p(.01),Y=p(),U=p([]),ae=ce(),R=$(()=>ae),N=$(()=>R.value.rewarderObj),O=$(()=>R.value.feeOwedObj),g=p([]),k=p("all"),F=p([]),K=l=>{const a=[];g.value=[];let s=new r(0);const t=[];l.forEach(d=>{var P,A,ve,me,fe,he;const f=((P=N.value[d.tokenName])==null?void 0:P.pendingRewarder)||0,n=((A=O.value[d.tokenName])==null?void 0:A.feeOwed)||0,x=new r(isNaN(f)?0:f).add(new r(isNaN(n)?0:n)).toString();s=s.add(new r(isNaN(f)?0:f)).add(new r(isNaN(n)?0:n)),Number(x)>0&&t.push(d),v.value&&Number(x)>Number(c.value)&&a.push({...d,totalRewardUsd:x,pendingRewarderList:(ve=N.value[d.tokenName])==null?void 0:ve.pendingRewarderArr,pendingFeesList:(me=O.value[d.tokenName])==null?void 0:me.feesResult,rewarderUsd:f,feeOwedUsd:n}),v.value||a.push({...d,totalRewardUsd:x,pendingRewarderList:(fe=N.value[d.tokenName])==null?void 0:fe.pendingRewarderArr,pendingFeesList:(he=O.value[d.tokenName])==null?void 0:he.feesResult,rewarderUsd:f,feeOwedUsd:n})}),F.value=t,a.forEach(d=>{d.totalRewardUsd>0&&g.value.push(d.tokenName)}),v.value?g.value.length!==a.length?k.value="":k.value="all":g.value.length!==t.length?k.value="":k.value="all",w.value=!1,Y.value=s,U.value=a.sort((d,f)=>f.totalRewardUsd-d.totalRewardUsd)},le=$(()=>R.value.getPendingFeeSuccess),Z=$(()=>R.value.getRewardSuccess);ie(()=>[C.positionShowList,c.value,le.value,Z.value,v.value],([l,a,s,t])=>{l&&l.length>0&&s&&t&&K(l)},{immediate:!0});const J=l=>{const a=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,4})?).*$");l.target.value=l.target.value.replace(a,"$1"),c.value=l.target.value},oe=()=>{(!c.value||c.value<.01)&&(c.value=.01)},q=l=>{const a=l.tokenName,s=g.value.indexOf(a);s>-1?g.value.splice(s,1):g.value.push(a),v.value?g.value.length!==U.value.length?k.value="":k.value="all":g.value.length!==F.value.length?k.value="":k.value="all"},H=()=>{k.value="all",U.value.forEach(l=>{!g.value.includes(l.tokenName)&&l.totalRewardUsd>0&&g.value.push(l.tokenName)})},S=$(()=>{let l=new r(0);return k.value=="all"?U.value.forEach(a=>{var d,f;const s=((d=N.value[a.tokenName])==null?void 0:d.pendingRewarder)||0,t=((f=O.value[a.tokenName])==null?void 0:f.feeOwed)||0;l=l.add(new r(isNaN(s)?0:s)).add(new r(isNaN(t)?0:t))}):g.value.forEach(a=>{var d,f;const s=((d=N.value[a])==null?void 0:d.pendingRewarder)||0,t=((f=O.value[a])==null?void 0:f.feeOwed)||0;l=l.add(new r(isNaN(s)?0:s)).add(new r(isNaN(t)?0:t))}),l.toString()}),m=()=>{const l=[];U.value.forEach(a=>{g.value.includes(a.tokenName)&&l.push(a)}),i("showClaimYiedl",l)};return(l,a)=>{const s=De,t=Le,d=xe,f=ue;return u(),V(h(Se),{title:"Details",footer:null,visible:o.isShowYiedlDetails,width:"440px","wrap-class-name":"details-modal",class:"new-modal-have-btn",onCancel:a[2]||(a[2]=n=>l.$emit("close"))},{default:E(()=>[e("div",ks,[e("div",$s,[e("div",Ns,[Us,e("div",Cs,[e("span",null,y(h(L)(Y.value,2,!1,!1)),1)])]),e("div",Ds,[e("div",Ls,[xs,e("div",Rs,[D(s,{class:"range-alerts-switch",checked:v.value,onClick:a[0]||(a[0]=()=>{v.value=!v.value,w.value=!1})},null,8,["checked"]),Os,D(t,{value:`$${c.value}`,onChange:J,onBlur:oe},null,8,["value"])])]),e("div",Ys,[U.value&&U.value.length>0?(u(!0),_(I,{key:0},ee(U.value,n=>(u(),_("div",{key:n,class:"position-item"},[e("div",Ps,[e("div",As,[D(je,{"from-coin":n.needReverse?n.token_b:n.token_a,"to-coin":n.needReverse?n.token_a:n.token_b,"fee-tier":n.fee*100},null,8,["from-coin","to-coin","fee-tier"]),e("div",Ts,y(n.tokenName),1)]),e("div",js,[e("div",{class:Ue(["radio",n.totalRewardUsd<=0?"radio-disable":""]),onClick:x=>n.totalRewardUsd>0?q(n):""},[(k.value=="all"||g.value.includes(n.tokenName))&&n.totalRewardUsd>0?(u(),_("svg",Bs,qs)):T("",!0)],10,Es)])]),e("div",Hs,[Ms,e("div",Vs,[n.totalRewardUsd>0?(u(),_("div",zs,[D(d,{placement:"bottomRight","overlay-class-name":"yield-amount-tooltip"},{title:E(()=>[D(bs,{"pending-fees-list":n.pendingFeesList,"pending-rewarder-list":n.pendingRewarderList,"rewarder-usd":n.rewarderUsd,"fee-owed-usd":n.feeOwedUsd},null,8,["pending-fees-list","pending-rewarder-list","rewarder-usd","fee-owed-usd"])]),default:E(()=>[z(y(h(L)(n.totalRewardUsd,2,!1,!1))+" ",1)]),_:2},1024)])):(u(),_("div",Ws,y(h(L)(n.totalRewardUsd,2,!1,!1)),1))])])]))),128)):(u(),V(Ee,{key:1,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found"}))])])]),e("div",Gs,[e("div",Ks,[e("div",{class:"radio",onClick:H},[k.value=="all"?(u(),_("svg",{key:0,"aria-hidden":"true",onClick:a[1]||(a[1]=Ce(()=>{g.value=[],k.value=""},["stop"]))},Js)):T("",!0)]),Qs]),e("div",Xs,[Is,e("div",null,y(h(L)(S.value,2,!1,!1)),1)])]),D(f,{class:"claim-yield-btn modal-bottom-btn",disabled:S.value=="0",onClick:m},{default:E(()=>[z("Claim Yield")]),_:1},8,["disabled"])])]),_:1},8,["visible"])}}});const st=G(et,[["__scopeId","data-v-d3e797d2"]]),_e=o=>(se("data-v-29c8e6f1"),o=o(),te(),o),tt={class:"total-info"},at={class:"total-liquidity"},lt=_e(()=>e("span",{class:"total-liquidity-text"},"Total Liquidity",-1)),ot={key:0,class:"skeleton-box"},nt={key:1,class:"total-liquidity-usd"},it={class:"pending-yield"},dt=_e(()=>e("div",{class:"pending-yield-text"},"Pending Yield",-1)),ut={key:0,class:"skeleton-box"},ct={key:1,class:"pending-yield-show-value"},rt={class:"pending-yield-value-box"},_t={key:0,class:"claim-list-box"},vt={class:"claim-list-content"},mt=_e(()=>e("use",{"xlink:href":"#icon-icon_expand"},null,-1)),ft=[mt],ht=W({__name:"total-position",setup(o){const b=p(!1),v=ce(),w=$(()=>v),i=$(()=>w.value.rewarderObj),C=$(()=>w.value.feeOwedObj),c=$(()=>w.value.positionShowList),Y=$(()=>w.value.myPositionsLoading),U=$(()=>w.value.getPendingFeeSuccess),ae=$(()=>w.value.getRewardSuccess),R=p(0),N=p(0),O=p(!0),g=p([]),k=p([]),F=p([]),K=S=>{let m=new r(0);const l=[];S.forEach(a=>{m=m.add(new r(isNaN(a.amountUSD)?0:a.amountUSD)),l.push(a.tokenName)}),g.value=l,R.value=m.toNumber()},le=(S,m)=>{let l=new r(0);const a=[];g.value.forEach(t=>{var n,x,P,A;const d=((n=S[t])==null?void 0:n.pendingRewarder)||0,f=((x=m[t])==null?void 0:x.feeOwed)||0;l=l.add(new r(isNaN(d)?0:d)).add(new r(isNaN(f)?0:f)),(P=S[t])!=null&&P.pendingRewarderArr&&a.push(...S[t].pendingRewarderArr),(A=m[t])!=null&&A.feesResult&&a.push(...m[t].feesResult)});const s={};a.forEach(t=>{s[t.address]?s[t.address]={...t,amountUSD:new r(s[t.address].amountUSD).add(isNaN(t.amountUSD)?0:t.amountUSD).toString(),amount:new r(s[t.address].amount).add(isNaN(t.amountUSD)?0:t.amountUSD).toString()}:(s[t.address]={},s[t.address]={...t,amountUSD:new r(0).add(isNaN(t.amountUSD)?0:t.amountUSD).toString(),amount:new r(0).add(t.amount).toString()})}),F.value=Object.values(s).filter(t=>t.amount>0).sort((t,d)=>d.amountUSD-t.amountUSD),N.value=l.toNumber(),O.value=!1};ie(()=>c.value,S=>{S&&S.length>0?K(S):K([])},{immediate:!0}),ie(()=>[U.value,ae.value,g.value,i.value,C.value],([S,m,l,a,s])=>{S&&m?le(a,s):O.value=!0},{immediate:!0,deep:!0});const Z=p(),J=p(),oe=S=>{b.value=!1,B.value=!0;let m=new r(0);const l=[],a={};S.forEach(s=>{var n,x,P,A;const t=s.tokenName,d=((n=i.value[t])==null?void 0:n.pendingRewarder)||0,f=((x=C.value[t])==null?void 0:x.feeOwed)||0;m=m.add(new r(d)).add(new r(f)),(P=i.value[t])!=null&&P.pendingRewarderArr&&l.push(...i.value[t].pendingRewarderArr),(A=C.value[t])!=null&&A.feesResult&&l.push(...C.value[t].feesResult)}),l.forEach(s=>{a[s.address]?a[s.address]={...s,amountUSD:new r(a[s.address].amountUSD).add(isNaN(s.amountUSD)?0:s.amountUSD).toString(),amount:new r(a[s.address].amount).add(isNaN(s.amountUSD)?0:s.amountUSD).toString()}:(a[s.address]={},a[s.address]={...s,amountUSD:new r(0).add(isNaN(s.amountUSD)?0:s.amountUSD).toString(),amount:new r(0).add(s.amount).toString()})}),Z.value=m.toNumber(),k.value=Object.values(a).filter(s=>s.amount>0).sort((s,t)=>t.amountUSD-s.amountUSD),J.value=S},q=p(1),H=()=>{N.value>0&&(b.value=!0,q.value=q.value==1?2:1)};return(S,m)=>{const l=Oe,a=ue;return u(),_("div",tt,[e("div",at,[lt,!R.value&&Y.value?(u(),_("div",ot,[D(l,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(u(),_("span",nt,y(R.value>0&&R.value<.01?"<$0.01":`$${h(de)(R.value,2)}`),1))]),e("div",it,[dt,O.value?(u(),_("div",ut,[D(l,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(u(),_("div",ct,[e("div",rt,[e("span",{class:"pending-yield-usd",style:Re(N.value<=0?{border:"none"}:{}),onClick:H},[z(y(N.value>0&&N.value<.01?"<$0.01":`$${h(de)(N.value,2)}`)+" ",1),N.value>0?(u(),_("div",_t,[e("div",vt,[D(be,{"my-claim-list":F.value},null,8,["my-claim-list"])])])):T("",!0)],4),N.value>0?(u(),_("svg",{key:0,class:"icon route-icon","aria-hidden":"true",onClick:H},ft)):T("",!0),D(a,{class:"claim-all-btn",disabled:N.value<=0,loading:h(M),onClick:H},{default:E(()=>[z("Claim All")]),_:1},8,["disabled","loading"])])]))]),h(B)?(u(),V(os,{key:0,"pending-yield":Z.value,"my-claim-list":k.value,"my-claim-position-list":J.value,onClose:m[0]||(m[0]=s=>B.value=!1),onChooseAmount:m[1]||(m[1]=()=>{B.value=!1,b.value=!0})},null,8,["pending-yield","my-claim-list","my-claim-position-list"])):T("",!0),(u(),V(st,{key:q.value,"position-show-list":c.value,"is-show-yiedl-details":b.value,onClose:m[2]||(m[2]=()=>{b.value=!1}),onShowClaimYiedl:oe},null,8,["position-show-list","is-show-yiedl-details"]))])}}});const Lt=G(ht,[["__scopeId","data-v-29c8e6f1"]]);export{Lt as T};
