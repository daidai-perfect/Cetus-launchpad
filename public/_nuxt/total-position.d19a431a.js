import{a as W,q as ye,o as u,f as v,F as I,s as ee,x as T,h as e,t as ne,v as y,u as h,e as K,r as p,m as $,c as M,w as j,i as D,j as V,Y as Se,B as ue,p as se,k as te,D as ie,z as Ce,K as De,W as Le,I as Re,L as xe,H as Oe,S as Ye}from"./entry.60f21e23.js";import"./index.3fe8d329.js";import{B as L,b as de}from"./index.faaa0495.js";import{a as Pe,c as Ae,b as Te,u as ce}from"./pool.4cb0c8ff.js";import{u as je}from"./index.d6b37ace.js";/* empty css              *//* empty css              *//* empty css              */import{_ as be}from"./icon-selected_3x.873560ed.js";import{_ as Ee}from"./coin-pair-name.8d44fdf4.js";import"./decimal.a2826370.js";import{N as Be}from"./no-data.a9ad8508.js";import{D as r}from"./decimal.765d8738.js";const Fe={key:0,class:"claim-list"},qe={class:"left"},He={alt:""},ze={class:"right"},Me=W({__name:"claim-list",props:{myClaimList:{type:Object,default:()=>[]}},setup(o){return(b,_)=>{const w=ye("image");return o.myClaimList&&o.myClaimList.length>0?(u(),v("div",Fe,[(u(!0),v(I,null,ee(o.myClaimList,i=>(u(),v("div",{key:i,class:"claim-item"},[e("div",qe,[ne(e("img",He,null,512),[[w,i.logo_url]]),e("span",null,y(i.symbol),1)]),e("div",ze,[e("span",null,y(h(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",null,y(h(L)(i.amountUSD,2,!1,!1)),1)])]))),128))])):T("",!0)}}});const ke=K(Me,[["__scopeId","data-v-599f12bc"]]),E=p(!1),z=p(!1),$e=Pe(),{setIsShowSuccess:Ve,setIsShowRejected:pe,setIsShowWaiting:Q,setTransactionDesc:We,setTransactionTxid:we}=$e,Ke=Ae("Sui"),X=Te("Sui"),Ze=je(),ge=$(()=>Ze),Ne=ce(),Ge=$(()=>Ne),Je=$(()=>$e),Qe=async o=>{z.value=!0;try{const b=[],_=[];o.forEach(c=>{const Y=c.rewarderInfo.filter(U=>U.emissionsEveryDay>0).map(U=>U.coinAddress);c.positionSource=="clmm"?b.push({pool_id:c.pool,pos_id:c.pos_object_id,collect_fee:!0,rewarder_coin_types:Y,coinTypeA:c.coin_type_a,coinTypeB:c.coin_type_b}):_.push({pool_id:c.pool_id,position_nft_id:c.id,clmm_pool_id:c.clmm_pool_id,collect_fee:!0,collect_frams_rewarder:!1,clmm_rewarder_types:Y,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB})}),we(""),We("Claim Yield"),Q(!0);const w=await Ke.batchHarvestAndClmmFee(_,b),i=await X.signAndExecuteTransactionBlock(ge.value.currentWallet,w.txb,w.payloadParams),C=X.handleTx(i);if(C&&C.hash){we(C.hash),Q(!1),Ve(!0);const c={title:"Claim",desc:"Claim Yield",hash:C.hash};c.res=C.res,X.showTransitionPending(c),await X.watchTransaction(c)&&setTimeout(()=>{Ne.getMyPositons(ge.value.address,Ge.value.poolsObj,Je.value.chainName)},1e3)}else Q(!1),pe(!0);z.value=!1,E.value=!1}catch(b){z.value=!1,Q(!1),pe(!0),E.value=!1,console.log("batchHarvestAndClmmFee error:",b)}},re=o=>(se("data-v-9942617d"),o=o(),te(),o),Xe={class:"claim-yield-content"},Ie={class:"total-claim"},es=re(()=>e("div",null,"Total Claim",-1)),ss={class:"total-claim-usd"},ts=re(()=>e("svg",{"aria-hidden":"true",class:"back-icon"},[e("use",{"xlink:href":"#icon-icon-back"})],-1)),as=re(()=>e("span",null,"Back",-1)),ls=[ts,as],os=W({__name:"claim-yield",props:{pendingYield:{type:Number,default:0},myClaimList:{type:Object,default:()=>[]},myClaimPositionList:{type:Object,default:()=>[]}},setup(o){return(b,_)=>{const w=ue;return u(),M(h(Se),{class:"new-modal-have-btn",title:"Claim Yield",visible:!0,footer:null,width:"440px",onCancel:_[2]||(_[2]=i=>b.$emit("close"))},{default:j(()=>[e("div",Xe,[e("div",Ie,[es,e("div",ss,y(o.pendingYield>0&&o.pendingYield<.01?"<$0.01":`$${h(de)(o.pendingYield,2)}`),1)]),D(ke,{"my-claim-list":o.myClaimList},null,8,["my-claim-list"]),e("div",{class:"choose-amount",onClick:_[0]||(_[0]=i=>b.$emit("chooseAmount"))},ls),D(w,{class:"confirm-btn modal-bottom-btn",loading:h(z),onClick:_[1]||(_[1]=i=>h(Qe)(o.myClaimPositionList))},{default:j(()=>[V("Confirm")]),_:1},8,["loading"])])]),_:1})}}});const ns=K(os,[["__scopeId","data-v-9942617d"]]),Ue=o=>(se("data-v-b3ccd801"),o=o(),te(),o),is={class:"fees-and-reward"},ds={key:0,class:"fees"},us={class:"fees-title"},cs=Ue(()=>e("div",null,"Fees",-1)),rs={alt:""},vs={class:"symbol"},_s={class:"amount"},ms={class:"amount-usd"},fs={key:1,class:"fees"},hs={class:"fees-title"},ps=Ue(()=>e("div",null,"Mining rewards",-1)),ws={alt:""},gs={class:"symbol"},ys={class:"amount"},Ss={class:"amount-usd"},bs=W({__name:"fees-and-reward",props:{pendingRewarderList:{type:Object,default:()=>[]},pendingFeesList:{type:Object,default:()=>[]},rewarderUsd:{type:String,default:""},feeOwedUsd:{type:String,default:""}},setup(o){return(b,_)=>{const w=ye("image");return u(),v("div",is,[o.feeOwedUsd&&o.feeOwedUsd>0?(u(),v("div",ds,[e("div",us,[cs,e("div",null,y(h(L)(o.feeOwedUsd,2,!1,!1)),1)]),(u(!0),v(I,null,ee(o.pendingFeesList,i=>(u(),v("div",{key:i,class:"fees-details"},[e("div",null,[ne(e("img",rs,null,512),[[w,i.logo_url]]),e("span",vs,y(i.symbol),1)]),e("div",null,[e("span",_s,y(h(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",ms,"("+y(h(L)(i.amountUSD,2,!1,!1))+")",1)])]))),128))])):T("",!0),o.rewarderUsd&&o.rewarderUsd>0?(u(),v("div",fs,[e("div",hs,[ps,e("div",null,y(h(L)(o.rewarderUsd,2,!1,!1)),1)]),(u(!0),v(I,null,ee(o.pendingRewarderList,i=>(u(),v("div",{key:i,class:"fees-details"},[e("div",null,[ne(e("img",ws,null,512),[[w,i.logo_url]]),e("span",gs,y(i.symbol),1)]),e("div",null,[e("span",ys,y(h(L)(i.amount,i.decimals,!0,!1,!1)),1),e("span",Ss,"("+y(h(L)(i.amountUSD,2,!1,!1))+")",1)])]))),128))])):T("",!0)])}}});const ks=K(bs,[["__scopeId","data-v-b3ccd801"]]),B=o=>(se("data-v-5cce90ff"),o=o(),te(),o),$s={class:"yield-details-box"},Ns={class:"yield-details"},Us={class:"total-claim"},Cs=B(()=>e("div",null,"Pending Yield",-1)),Ds={class:"total-claim-usd"},Ls={class:"position-detail"},Rs={class:"position-detail-top"},xs=B(()=>e("div",{class:"left"},"Position",-1)),Os={class:"right plus-switch plus-liquidity-switch"},Ys=B(()=>e("span",null,"Hide yield < ",-1)),Ps={class:"position-detail-bottom"},As={class:"item-top"},Ts={class:"left"},js={class:"bottom"},Es={class:"right"},Bs=["onClick"],Fs={key:0,src:be},qs={class:"item-bottom"},Hs=B(()=>e("div",{class:"left"}," Liquidity ",-1)),zs={class:"right"},Ms={key:0,class:"yield-amount"},Vs={key:1,class:"yield-amount-zero"},Ws={class:"select"},Ks={class:"all"},Zs=B(()=>e("span",null,"Select all",-1)),Gs={class:"amount-selected"},Js=B(()=>e("div",null,"Amount selected",-1)),Qs=W({__name:"yield-details",props:{positionShowList:{type:Object,default:()=>[]},isShowYiedlDetails:{type:Boolean,default:!1}},emits:["showClaimYiedl"],setup(o,{emit:b}){const _=p(!0),w=p(!0),i=b,C=o,c=p(.01),Y=p(),U=p([]),ae=ce(),x=$(()=>ae),N=$(()=>x.value.rewarderObj),O=$(()=>x.value.feeOwedObj),g=p([]),k=p("all"),F=p([]),Z=l=>{const a=[];g.value=[];let s=new r(0);const t=[];l.forEach(d=>{var P,A,_e,me,fe,he;const f=((P=N.value[d.tokenName])==null?void 0:P.pendingRewarder)||0,n=((A=O.value[d.tokenName])==null?void 0:A.feeOwed)||0,R=new r(isNaN(f)?0:f).add(new r(isNaN(n)?0:n)).toString();s=s.add(new r(isNaN(f)?0:f)).add(new r(isNaN(n)?0:n)),Number(R)>0&&t.push(d),_.value&&Number(R)>Number(c.value)&&a.push({...d,totalRewardUsd:R,pendingRewarderList:(_e=N.value[d.tokenName])==null?void 0:_e.pendingRewarderArr,pendingFeesList:(me=O.value[d.tokenName])==null?void 0:me.feesResult,rewarderUsd:f,feeOwedUsd:n}),_.value||a.push({...d,totalRewardUsd:R,pendingRewarderList:(fe=N.value[d.tokenName])==null?void 0:fe.pendingRewarderArr,pendingFeesList:(he=O.value[d.tokenName])==null?void 0:he.feesResult,rewarderUsd:f,feeOwedUsd:n})}),F.value=t,a.forEach(d=>{d.totalRewardUsd>0&&g.value.push(d.tokenName)}),_.value?g.value.length!==a.length?k.value="":k.value="all":g.value.length!==t.length?k.value="":k.value="all",w.value=!1,Y.value=s,U.value=a.sort((d,f)=>f.totalRewardUsd-d.totalRewardUsd)},le=$(()=>x.value.getPendingFeeSuccess),G=$(()=>x.value.getRewardSuccess);ie(()=>[C.positionShowList,c.value,le.value,G.value,_.value],([l,a,s,t])=>{l&&l.length>0&&s&&t&&Z(l)},{immediate:!0});const J=l=>{const a=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,4})?).*$");l.target.value=l.target.value.replace(a,"$1"),c.value=l.target.value},oe=()=>{(!c.value||c.value<.01)&&(c.value=.01)},q=l=>{const a=l.tokenName,s=g.value.indexOf(a);s>-1?g.value.splice(s,1):g.value.push(a),_.value?g.value.length!==U.value.length?k.value="":k.value="all":g.value.length!==F.value.length?k.value="":k.value="all"},H=()=>{k.value="all",U.value.forEach(l=>{!g.value.includes(l.tokenName)&&l.totalRewardUsd>0&&g.value.push(l.tokenName)})},S=$(()=>{let l=new r(0);return k.value=="all"?U.value.forEach(a=>{var d,f;const s=((d=N.value[a.tokenName])==null?void 0:d.pendingRewarder)||0,t=((f=O.value[a.tokenName])==null?void 0:f.feeOwed)||0;l=l.add(new r(isNaN(s)?0:s)).add(new r(isNaN(t)?0:t))}):g.value.forEach(a=>{var d,f;const s=((d=N.value[a])==null?void 0:d.pendingRewarder)||0,t=((f=O.value[a])==null?void 0:f.feeOwed)||0;l=l.add(new r(isNaN(s)?0:s)).add(new r(isNaN(t)?0:t))}),l.toString()}),m=()=>{const l=[];U.value.forEach(a=>{g.value.includes(a.tokenName)&&l.push(a)}),i("showClaimYiedl",l)};return(l,a)=>{const s=Le,t=Re,d=xe,f=ue;return u(),M(h(Se),{title:"Details",footer:null,visible:o.isShowYiedlDetails,width:"440px","wrap-class-name":"details-modal",class:"new-modal-have-btn",onCancel:a[2]||(a[2]=n=>l.$emit("close"))},{default:j(()=>[e("div",$s,[e("div",Ns,[e("div",Us,[Cs,e("div",Ds,[e("span",null,y(h(L)(Y.value,2,!1,!1)),1)])]),e("div",Ls,[e("div",Rs,[xs,e("div",Os,[D(s,{class:"range-alerts-switch",checked:_.value,onClick:a[0]||(a[0]=()=>{_.value=!_.value,w.value=!1})},null,8,["checked"]),Ys,D(t,{value:`$${c.value}`,onChange:J,onBlur:oe},null,8,["value"])])]),e("div",Ps,[U.value&&U.value.length>0?(u(!0),v(I,{key:0},ee(U.value,n=>(u(),v("div",{key:n,class:"position-item"},[e("div",As,[e("div",Ts,[D(Ee,{"from-coin":n.needReverse?n.token_b:n.token_a,"to-coin":n.needReverse?n.token_a:n.token_b,"fee-tier":n.fee*100},null,8,["from-coin","to-coin","fee-tier"]),e("div",js,y(n.tokenName),1)]),e("div",Es,[e("div",{class:Ce(["radio",n.totalRewardUsd<=0?"radio-disable":""]),onClick:R=>n.totalRewardUsd>0?q(n):""},[(k.value=="all"||g.value.includes(n.tokenName))&&n.totalRewardUsd>0?(u(),v("img",Fs)):T("",!0)],10,Bs)])]),e("div",qs,[Hs,e("div",zs,[n.totalRewardUsd>0?(u(),v("div",Ms,[D(d,{placement:"bottomRight","overlay-class-name":"yield-amount-tooltip"},{title:j(()=>[D(ks,{"pending-fees-list":n.pendingFeesList,"pending-rewarder-list":n.pendingRewarderList,"rewarder-usd":n.rewarderUsd,"fee-owed-usd":n.feeOwedUsd},null,8,["pending-fees-list","pending-rewarder-list","rewarder-usd","fee-owed-usd"])]),default:j(()=>[V(y(h(L)(n.totalRewardUsd,2,!1,!1))+" ",1)]),_:2},1024)])):(u(),v("div",Vs,y(h(L)(n.totalRewardUsd,2,!1,!1)),1))])])]))),128)):(u(),M(Be,{key:1,"no-data-img":"/sui-image/img-no-Positions@2x.png",desc:"No Position Found"}))])])]),e("div",Ws,[e("div",Ks,[e("div",{class:"radio",onClick:H},[k.value=="all"?(u(),v("img",{key:0,src:be,onClick:a[1]||(a[1]=De(()=>{g.value=[],k.value=""},["stop"]))})):T("",!0)]),Zs]),e("div",Gs,[Js,e("div",null,y(h(L)(S.value,2,!1,!1)),1)])]),D(f,{class:"claim-yield-btn modal-bottom-btn",disabled:S.value=="0",onClick:m},{default:j(()=>[V("Claim Yield")]),_:1},8,["disabled"])])]),_:1},8,["visible"])}}});const Xs=K(Qs,[["__scopeId","data-v-5cce90ff"]]),ve=o=>(se("data-v-9f16084b"),o=o(),te(),o),Is={class:"total-info"},et={class:"total-liquidity"},st=ve(()=>e("span",{class:"total-liquidity-text"},"Total Liquidity",-1)),tt={key:0,class:"skeleton-box"},at={key:1,class:"total-liquidity-usd"},lt={class:"pending-yield"},ot=ve(()=>e("div",{class:"pending-yield-text"},"Pending Yield",-1)),nt={key:0,class:"skeleton-box"},it={key:1,class:"pending-yield-show-value"},dt={class:"pending-yield-value-box"},ut={key:0,class:"claim-list-box"},ct={class:"claim-list-content"},rt=ve(()=>e("use",{"xlink:href":"#icon-icon_expand"},null,-1)),vt=[rt],_t=W({__name:"total-position",setup(o){const b=p(!1),_=ce(),w=$(()=>_),i=$(()=>w.value.rewarderObj),C=$(()=>w.value.feeOwedObj),c=$(()=>w.value.positionShowList),Y=$(()=>w.value.myPositionsLoading),U=$(()=>w.value.getPendingFeeSuccess),ae=$(()=>w.value.getRewardSuccess),x=p(0),N=p(0),O=p(!0),g=p([]),k=p([]),F=p([]),Z=S=>{let m=new r(0);const l=[];S.forEach(a=>{m=m.add(new r(isNaN(a.amountUSD)?0:a.amountUSD)),l.push(a.tokenName)}),g.value=l,x.value=m.toNumber()},le=(S,m)=>{let l=new r(0);const a=[];g.value.forEach(t=>{var n,R,P,A;const d=((n=S[t])==null?void 0:n.pendingRewarder)||0,f=((R=m[t])==null?void 0:R.feeOwed)||0;l=l.add(new r(isNaN(d)?0:d)).add(new r(isNaN(f)?0:f)),(P=S[t])!=null&&P.pendingRewarderArr&&a.push(...S[t].pendingRewarderArr),(A=m[t])!=null&&A.feesResult&&a.push(...m[t].feesResult)});const s={};a.forEach(t=>{s[t.address]?s[t.address]={...t,amountUSD:new r(s[t.address].amountUSD).add(isNaN(t.amountUSD)?0:t.amountUSD).toString(),amount:new r(s[t.address].amount).add(isNaN(t.amountUSD)?0:t.amountUSD).toString()}:(s[t.address]={},s[t.address]={...t,amountUSD:new r(0).add(isNaN(t.amountUSD)?0:t.amountUSD).toString(),amount:new r(0).add(t.amount).toString()})}),F.value=Object.values(s).filter(t=>t.amount>0).sort((t,d)=>d.amountUSD-t.amountUSD),N.value=l.toNumber(),O.value=!1};ie(()=>c.value,S=>{S&&S.length>0?Z(S):Z([])},{immediate:!0}),ie(()=>[U.value,ae.value,g.value,i.value,C.value],([S,m,l,a,s])=>{S&&m?le(a,s):O.value=!0},{immediate:!0,deep:!0});const G=p(),J=p(),oe=S=>{b.value=!1,E.value=!0;let m=new r(0);const l=[],a={};S.forEach(s=>{var n,R,P,A;const t=s.tokenName,d=((n=i.value[t])==null?void 0:n.pendingRewarder)||0,f=((R=C.value[t])==null?void 0:R.feeOwed)||0;m=m.add(new r(d)).add(new r(f)),(P=i.value[t])!=null&&P.pendingRewarderArr&&l.push(...i.value[t].pendingRewarderArr),(A=C.value[t])!=null&&A.feesResult&&l.push(...C.value[t].feesResult)}),l.forEach(s=>{a[s.address]?a[s.address]={...s,amountUSD:new r(a[s.address].amountUSD).add(isNaN(s.amountUSD)?0:s.amountUSD).toString(),amount:new r(a[s.address].amount).add(isNaN(s.amountUSD)?0:s.amountUSD).toString()}:(a[s.address]={},a[s.address]={...s,amountUSD:new r(0).add(isNaN(s.amountUSD)?0:s.amountUSD).toString(),amount:new r(0).add(s.amount).toString()})}),G.value=m.toNumber(),k.value=Object.values(a).filter(s=>s.amount>0).sort((s,t)=>t.amountUSD-s.amountUSD),J.value=S},q=p(1),H=()=>{N.value>0&&(b.value=!0,q.value=q.value==1?2:1)};return(S,m)=>{const l=Ye,a=ue;return u(),v("div",Is,[e("div",et,[st,!x.value&&Y.value?(u(),v("div",tt,[D(l,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(u(),v("span",at,y(x.value>0&&x.value<.01?"<$0.01":`$${h(de)(x.value,2)}`),1))]),e("div",lt,[ot,O.value?(u(),v("div",nt,[D(l,{class:"upgrade-text-skeleton",active:"",paragraph:!1})])):(u(),v("div",it,[e("div",dt,[e("span",{class:"pending-yield-usd",style:Oe(N.value<=0?{border:"none"}:{}),onClick:H},[V(y(N.value>0&&N.value<.01?"<$0.01":`$${h(de)(N.value,2)}`)+" ",1),N.value>0?(u(),v("div",ut,[e("div",ct,[D(ke,{"my-claim-list":F.value},null,8,["my-claim-list"])])])):T("",!0)],4),N.value>0?(u(),v("svg",{key:0,class:"icon route-icon","aria-hidden":"true",onClick:H},vt)):T("",!0),D(a,{class:"claim-all-btn",disabled:N.value<=0,loading:h(z),onClick:H},{default:j(()=>[V("Claim All")]),_:1},8,["disabled","loading"])])]))]),h(E)?(u(),M(ns,{key:0,"pending-yield":G.value,"my-claim-list":k.value,"my-claim-position-list":J.value,onClose:m[0]||(m[0]=s=>E.value=!1),onChooseAmount:m[1]||(m[1]=()=>{E.value=!1,b.value=!0})},null,8,["pending-yield","my-claim-list","my-claim-position-list"])):T("",!0),(u(),M(Xs,{key:q.value,"position-show-list":c.value,"is-show-yiedl-details":b.value,onClose:m[2]||(m[2]=()=>{b.value=!1}),onShowClaimYiedl:oe},null,8,["position-show-list","is-show-yiedl-details"]))])}}});const Ct=K(_t,[["__scopeId","data-v-9f16084b"]]);export{Ct as T};
