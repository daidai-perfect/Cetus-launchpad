import{m as z,C as j,af as q}from"./entry.1afe32c4.js";import{c as i,C as G,F as H,u as $,aG as c,X as J,k as f,aH as C}from"./index.c41a185a.js";import{D as g}from"./decimal.0bdeb344.js";const Q=q(),Y=Q.public.appEnv;function se(a){const y={launchpad:i[a||"Sui"].launchpad,ido:i[a||"Sui"].ido,xcetus:i[a||"Sui"].xcetus,xcetus_dividends:i[a||"Sui"].xcetus_dividends,cetus_faucet:i[a||"Sui"].cetus_faucet,xtoken:i[a||"Sui"].xtoken,xtoken_dividends:i[a||"Sui"].xtoken_dividends,token_faucet:i[a||"Sui"].token_faucet,booster:i[a||"Sui"].booster,maker_bonus:i[a||"Sui"].maker_bonus},x={fullRpcUrl:localStorage.getItem(`${a}-currentRpclocal6`)||i[a||"Sui"].fullRpcUrl,simulationAccount:i[a||"Sui"].simulationAccount,cetus_config:i[a||"Sui"].cetus_config,clmm_pool:i[a||"Sui"].clmm_pool,integrate:i[a||"Sui"].integrate,deepbook:i[a||"Sui"].deepbook,deepbook_endpoint_v2:i[a||"Sui"].deepbook_endpoint_v2,aggregatorUrl:i[a||"Sui"].aggregatorUrl},M=new G(x),n=new H(y,M),S=$(),m=z(()=>S);j(()=>{m.value.address&&(n.ClmmSDK.senderAddress=m.value.address)});const _=async e=>{const t=await n.XCetusModule.getOwnerLockCetuss(e);return console.log(t,"===>lockWhales"),t},D=async(e,t)=>{const o=c.getAvailableXCetus(e,t);return console.log(o,"==>availableXwhale"),o},b=async e=>{const t=await n.XCetusModule.getOwnerCetusCoins(e);return console.log(t,"===>coins"),t},h=async e=>await n.XCetusModule.getOwnerVeNFT(e),k=async(e,t)=>{const o={amount:e.toString()};t&&(o.venft_id=t);const s=new J;console.log("ğŸš€ ~ file: useWhale.ts:88 ~ depositCetus ~ txb:",s);const d=await n.XCetusModule.convertPayload(o,s);console.log("ğŸš€ ~ file: useWhale.ts:88 ~ depositCetus ~ tx:",d);const r={action:"xCETUSConvert",txbParams:o};return console.log("ğŸš€ ~ file: useWhale.ts:88 ~ depositCetus ~ payloadParams:",r),{txb:u(d),payloadParams:r}},P=async()=>{const e=await n.XCetusModule.mintVeNFTPayload();return u(e)},T=async(e,t)=>{const o=await n.XCetusModule.redeemNum(e,t);return console.log(o,"result===>"),{amountOut:o.amountOut,percent:f(new g(o.percent).mul(new g(100)).toString(),2)}},X=async(e,t)=>{const o=await n.XCetusModule.reverseRedeemNum(e,t);return{amountOut:o.amountOut,percent:f(new g(o.percent).mul(new g(100)).toString(),2)}},I=async(e,t,o)=>{const s={venft_id:t,amount:e,lock_day:o},d=await n.XCetusModule.redeemLockPayload(s),r={action:"xCETUSRedeemLock",txbParams:s};return{txb:u(d),payloadParams:r}},R=e=>c.getLockingCetuss(e),F=async(e,t)=>{const o=await n.XCetusModule.getLockCetus(e);if(o&&c.isLocked(o)){const s={venft_id:t,lock_id:e},d=n.XCetusModule.cancelRedeemPayload(s),r={action:"xCETUSCancelRedeem",txbParams:s};return{txb:u(d),payloadParams:r}}},W=async(e,t)=>{const o=await n.XCetusModule.getLockCetus(e);if(o&&!c.isLocked(o)){const s={venft_id:t,lock_id:e},d=await n.XCetusModule.redeemPayload(s),r={action:"xCETUSRedeem",txbParams:s};return{txb:u(d),payloadParams:r}}},O=async()=>{const e=await n.XCetusModule.getDividendManager();console.log("dividendManager:",e);const t=Number(c.getNextStartTime(e).toString());return console.log(t,"===>nextStartTime"),{nextStartTime:t,...e}},V=async(e,t)=>{console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:211 ~ getVeNFTDividendInfo ~ dividendManager:",t);try{const{venft_dividends_id_v2:o}=C(n.sdkOptions.xcetus_dividends),s=await n.XCetusModule.getVeNFTDividendInfo(t.venft_dividends.id,o,e);return console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:213 ~ getVeNFTDividendInfo ~ veNFTDividendInfo:",s),{rewards:s&&s.rewards||[]}}catch(o){console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:220 ~ getVeNFTDividendInfo ~ error:",o)}},L=async e=>{const t=await n.XCetusModule.getDividendManager();if(console.log("dividendManager: ",t),t.bonus_types.length>0){const o=await n.XCetusModule.redeemDividendPayload(e,t.bonus_types);return u(o)}},E=e=>{const t=new Set;return e.forEach(o=>{o.rewards.forEach(s=>{s.amount>0&&t.add(s.coin_type)})}),Array.from(t)},U=async e=>{const t=await n.XCetusModule.getDividendManager(),{venft_dividends_id_v2:o}=C(n.sdkOptions.xcetus_dividends),s=await n.XCetusModule.getVeNFTDividendInfo(t.venft_dividends.id,o,e);console.log("veNFTDividendInfo: ",s);const d=E(s.rewards),r=c.buildDividendRewardTypeListV2(s.rewards);console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:245 ~ getRedeemDividendV2Payload ~ bonus_types:",d);const v=[];s.rewards.forEach(w=>{w.vesrion=="v2"&&v.push(w.period)});const l={venft_id:e,bonus_types:d,bonus_types_v2:r,xTokenType:[n.XCetusModule.buileXTokenCoinType()],phases:v.sort()};console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:253 ~ phases ~ phases:",v.sort());const B=await n.XCetusModule.redeemDividendV3Payload(l.phases,l.venft_id,l.bonus_types,l.bonus_types_v2,l.xTokenType),K={action:"xCETUSClaimStakingRwewards",txbParams:l};return{txb:u(B),payloadParams:K}},A=async e=>{console.log(e,"==>accountAddress");try{const t=await n.XCetusModule.getOwnerVeNFT(e);if(console.log("nfts: ",t),t){const o=await n.XCetusModule.getXcetusManager();console.log("xcetusManager: ",o);const s=new g(t.xcetus_balance).div(o.treasury).mul(100).toString();return console.log("rate: ",s),Number(s)>0&&Number(s)<.001?"<0.001":f(s,3)}else return 0}catch{return"--"}},N=async()=>{const e=await n.XCetusModule.getXcetusManager();return console.log("xcetusManager: ",e),e},u=e=>({transactionBlock:e,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),p=e=>{const t=Date.now()/1e3,{start_time:o,interval_day:s}=e;console.log(e,"#dividendManager");const d=Y=="test"?Math.ceil((t-o)/(s*60)):Math.ceil((t-o)/(s*24*3600));return console.log(t,"===>currentTime"),console.log(o,"===>start_time"),console.log(t-o,"===>currentTime-start_time"),console.log((t-o)/(s*60),"(currentTime - start_time) / (interval_day * 60)"),d};return{getOwnerLockCetuss:_,getOwnerCetusCoins:b,getOwnerVeNFT:h,depositCetus:k,getMintVeNFTPayload:P,redeemNum:T,getRedeemLockPayload:I,getAvailableXCetus:D,getLockingCetuss:R,getCancelRedeemPayload:F,getVeNFTDividendInfo:V,reverseRedeemNum:X,getRedeemPayload:W,getRedeemDividendPayload:L,getMyShare:A,getDividendManager:O,getPeriod:p,getRedeemDividendV2Payload:U,getPhaseDividendInfo:async e=>{const t=p(e);console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:320 ~ getPhaseDividendInfo ~ dividendManager:",e),console.log(t,"getPhaseDividendInfo period");let o=await n.XCetusModule.getPhaseDividendInfo(String(t));console.log(!o,"==>phaseDividendInfo");let s;if(!o){if(s=await n.XCetusModule.getPhaseDividendInfo(e.dividends.size),s)o=s;else for(let d=e.dividends.size;d>1;d--)if(s=await n.XCetusModule.getPhaseDividendInfo(String(d)),console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:327 ~ getPhaseDividendInfo ~ lastPhaseDividendInfo:",s),s){o=s;break}}return console.log("ğŸš€ğŸš€ğŸš€ ~ file: useWhale.ts:336 ~ getPhaseDividendInfo ~ phaseDividendInfo:",o),o},getXcetusManager:N}}export{se as u};
