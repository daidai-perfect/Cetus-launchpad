import{_ as ya}from"./token-warning.ee79e06e.js";import{m as w,t as Ha,ab as Ua,r as p,L as Ba,A as te,a as ce,C as Ut,o as c,f as g,h as e,I as oe,i as M,x as o,G as F,u as a,M as ut,y as G,O as bt,p as Ce,k as Le,e as de,c as j,w as z,j as U,$ as Kt,K as Gt,B as tt,a2 as mt,a3 as Da,z as Fa,q as ja,s as za,fg as Vt,b as Wa,fh as ia,a0 as Va,D as Qt,N as Yt,F as Q,E as Ae,P as Xt,J as Ya,H as qa}from"./entry.f6e83616.js";/* empty css              */import"./decimal.a2826370.js";import{c as Pe,Q as oa,R as pe,b as it,a as P,U as ra,p as ua,r as Ye,o as Zt}from"./common.2e62af64.js";import{a as wt,u as vt,b as Bt}from"./index.230ef5b5.js";import{_ as Ja}from"./token-warning-modal.8aafc7e9.js";/* empty css              *//* empty css              */import{_ as Ka}from"./refresh-icon.31f2ce92.js";import{c as H,s as Ga,i as Qa,u as He,ak as Xa,aj as Tt}from"./index.632d620c.js";import{_ as Za}from"./coin-select.c93e7270.js";import{D as x}from"./decimal.765d8738.js";import{U as ba}from"./underline-tab.6dd43a4f.js";import{T as ca}from"./token-input-block.b7cee544.js";import{I as es}from"./icon-tooltip.a306ec93.js";import{B as da}from"./bignumber.266e6c56.js";import{_ as ts}from"./img-no-Positions_2x.f4990a10.js";import{_ as as}from"./img-connect-wallet_2x.c20af387.js";import{S as ss}from"./data.712deea2.js";/* empty css              */const ls=""+globalThis.__publicAssetsURL("sui-image/img-no-data@2x.png");function Ne(t){const u={fullRpcUrl:localStorage.getItem(`${t}-currentRpclocal2`)||H[t||"Sui"].fullRpcUrl,simulationAccount:H[t||"Sui"].simulationAccount,cetus_config:H[t||"Sui"].cetus_config,clmm_pool:H[t||"Sui"].clmm_pool,integrate:H[t||"Sui"].integrate,deepbook:H[t||"Sui"].deepbook,deepbook_endpoint_v2:H[t||"Sui"].deepbook_endpoint_v2,aggregatorUrl:H[t||"Sui"].aggregatorUrl,swapCountUrl:H[t||"Sui"].swapCountUrl},l={launchpad:H[t||"Sui"].launchpad,ido:H[t||"Sui"].ido,xcetus:H[t||"Sui"].xcetus,xcetus_dividends:H[t||"Sui"].xcetus_dividends,cetus_faucet:H[t||"Sui"].cetus_faucet,xtoken:H[t||"Sui"].xtoken,xtoken_dividends:H[t||"Sui"].xtoken_dividends,token_faucet:H[t||"Sui"].token_faucet,booster:H[t||"Sui"].booster,maker_bonus:H[t||"Sui"].maker_bonus,liquidity_stratefy:H[t||"Sui"].liquidity_stratefy,vaults:H[t||"Sui"].vaults,frams:H[t||"Sui"].frams,limit_order:H[t||"Sui"].limit_order};console.log("defaultNetworkOptions####",u);const m=new Ga(u),_=new Qa(l,m),C=He(),h=w(()=>C);Ha(()=>{h.value.address&&(m.senderAddress=h.value.address)});const d=async()=>await _.LimitOrder.getLimitOrderTokenList(),n=async()=>await _.LimitOrder.getLimitOrderPoolList(),y=async()=>{try{return await _.LimitOrder.getOwnerLimitOrderList(_.ClmmSDK.senderAddress,"all")}catch(b){console.log("ðŸš€ðŸš€ðŸš€ ~ file: useLimitOrder.ts:71 ~ getOwnerLimitOrderList ~ error:",b)}},r=b=>({transactionBlock:b,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),i=async b=>{const{pay_coin_amount:$,price:E,expired_ts:L,pay_coin_type:Y,target_coin_type:ae,pay_decimal:se,target_decimal:fe}=b,ue=new x($).mul(Math.pow(10,se)).toNumber();console.log("useLimitOrder placeLimitOrder params##",b);const X=await _.LimitOrder.placeLimitOrder({pay_coin_amount:ue,price:E,expired_ts:L,pay_coin_type:Y=="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":Y,target_coin_type:ae=="0x2::sui::SUI"?"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":ae,pay_decimal:se,target_decimal:fe});return console.log("useLimitOrder placeLimitOrder payload##",X),r(X)},T=async b=>{console.log("cancelOrdersByOwner params",b);const $=await _.LimitOrder.cancelOrdersByOwner(b);return r($)},I=async b=>await _.LimitOrder.getLimitOrderLogs(b),v=async b=>{const $=await _.LimitOrder.claimTargetCoin({order_id:b.order_id,pay_coin_type:b.pay_coin_type,target_coin_type:b.target_coin_type});return r($)},O=async b=>await _.LimitOrder.getLimitOrderClaimLogs(b);return{getLimitOrderTokenList:d,getLimitOrderPoolList:n,getOwnerLimitOrderList:y,placeLimitOrder:i,rateToPrice:Xa.rateToPrice,cancelOrdersByOwner:T,getLimitOrderLogs:I,claimTargetCoin:v,getLimitOrderClaimLogs:O}}const It="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",Te=Ua("LimitOrder",{state:()=>({limitTokenList:[],limitTokenObj:{},limitOrderPoolList:[],limitOrderList:[],orderNum:0,orderListLoading:!1,limitTokenMinAmountObj:{},limitOrderHistoryList:[],historyNum:0,orderHistoryObj:{},cancelOrderId:"",orderHistoryLoading:!1,currentOrderClaimHistory:[],claimHistoryLoading:!0,RATES:{},marketPriceLoading:!0,haveMarket:!0,isShowChart:JSON.parse(localStorage.getItem("isShowChart"))||!1}),actions:{async getTokenMinAmount(){const u=await Ne("Sui").getLimitOrderTokenList();this.limitTokenMinAmountObj=Object.fromEntries(u.map((l,m)=>[l.coin_type==It?"0x2::sui::SUI":l.coin_type,l])),console.log(u,"store limitorder getLimitgetTokenMinAmount###")},async getPoolList(){const u=await Ne("Sui").getLimitOrderPoolList();this.limitOrderPoolList=u.map(l=>({indexer_id:l.indexer_id,pay_coin_type:l.pay_coin_type==It?"0x2::sui::SUI":l.pay_coin_type,target_coin_type:l.target_coin_type==It?"0x2::sui::SUI":l.target_coin_type})),console.log(u,"store limitorder getLimitOrderPoolList###")},async getOrderList(){console.log("ðŸš€ðŸš€ðŸš€ ~ file: limitorder.ts:42 ~ getOrderList ~ getOrderList:");const t=Ne("Sui");this.orderListLoading=!0;try{const u=await t.getOwnerLimitOrderList();console.log("ðŸš€ðŸš€ðŸš€ ~ file: limitorder.ts:46 ~ getOrderList ~ result:",u);const l=u.data.filter(m=>m.status=="PartialCompleted"||m.status=="Running")||[];this.limitOrderList=l.sort((m,_)=>_.created_ts-m.created_ts),console.log("ðŸš€ðŸš€ðŸš€ ~ file: limitorder.ts:52 ~ getOrderList ~ this.limitOrderList:",this.limitOrderList),this.orderListLoading=!1,this.cancelOrderId=""}catch(u){console.log("ðŸš€ðŸš€ðŸš€ ~ file: limitorder.ts:53 ~ getOrderList ~ e:",u),this.orderListLoading=!1,this.cancelOrderId=""}},async getTokenList(){const u=(await fetch(`${H.Sui.api}/v2/sui/coin_metadata`,{method:"POST",body:JSON.stringify({})}).then(l=>l.json())).data.list||[];this.limitTokenList=u,this.limitTokenObj=Object.fromEntries(u.map((l,m)=>[l.coin_type==It?"0x2::sui::SUI":l.coin_type,l])),console.log(u,"store limitorder getLimitOrderTokenList###")},async getLimitOrderLogs(){},async getLimitOrderHistory(t){this.orderHistoryLoading=!0;const{data:u}=await fetch(`${H.Sui.api}/v2/sui/limit_order?wallet_address=${t}`).then(m=>m.json()),l=u.list||[];this.limitOrderHistoryList=l||[],this.orderHistoryLoading=!1},async getLimitOrderClaimHistory(t){this.currentOrderClaimHistory=[],this.claimHistoryLoading=!0;const l=await Ne("Sui").getLimitOrderClaimLogs(t.id);this.currentOrderClaimHistory=l.map(m=>{const _=new x(m.parsedJson.claimed_amount).div(Math.pow(10,t.target_coin_info.decimals));return{...m,...m.parsedJson,claimed_amount:_}}),console.log("ðŸš€ðŸš€ðŸš€ ~ file: limitorder.ts:105 ~ getLimitOrderClaimHistory ~ currentOrderClaimHistory:",this.currentOrderClaimHistory),this.claimHistoryLoading=!1},setOrderNum(t){this.orderNum=t},setHistoryNum(t){this.historyNum=t},setLimitOrderLoading(t){this.cancelOrderId=t},async setRates(t){this.marketPriceLoading=!0;let u={};if(t&&t.includes("Sui"))try{u=await $fetch(`${H.Sui.api}/v2/sui/price`)}catch(_){console.log("sui pric api error ###",_),u={data:{prices:ss}}}else u=await $fetch(`${H.Aptos.api}/v2/price`);const l=u.data.prices||[],m=[];l.forEach(_=>{_.base_symbol=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?m.push({..._},{..._,base_symbol:"0x2::sui::SUI"}):m.push(_)}),this.RATES=Object.fromEntries(m.map(_=>[_.base_symbol,_])),this.marketPriceLoading=!1},setHaveMarket(t){this.haveMarket=t},setIsShowChart(t){localStorage.setItem("isShowChart",JSON.stringify(t)),this.isShowChart=t},limitOrderLogOut(){this.limitOrderHistoryList=[],this.limitOrderList=[]}}}),k=p(),S=p(),ns=wt(),wa=w(()=>ns),$a=vt(),is=w(()=>$a),va=w(()=>is.value.chainName),Oe=Bt("Sui"),os=Ba(),xa=p(!0);console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-data.ts:53 ~ route:",os);te(()=>[wa.value.tokensObj,xa.value],async([t,u])=>{if(!Pe(t)){const l=oa("from"),m=oa("to");console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-data.ts:61 ~ routerCoinTo:",l,m),l&&m?k.value=t[l]||await Oe.getTokenBySymbol(t,l):!l&&!k.value&&(k.value=t[H[va.value].swapDefaultPair.fromCoin]),l&&m?S.value=t[m]||await Oe.getTokenBySymbol(t,m):!m&&!S.value&&(S.value=t[H[va.value].swapDefaultPair.toCoin])}},{});const{setTransactionTxid:rs,setIsShowWaiting:Mt,setIsShowSuccess:us,setIsShowRejected:_a,setTransactionDesc:cs}=$a,ma=p(!1),et=Te(),ea=w(()=>et),ds=w(()=>ea.value.limitOrderList),vs=He(),Jt=w(()=>vs),ta=async(t,u=!1)=>{const l=Ne("Sui");try{cs("Canceling order"),Mt(!0);const _=u?ds.value.map(n=>({order_id:n.id,pay_coin_type:n.pay_coin_type,target_coin_type:n.target_coin_type})):[{order_id:t.id,pay_coin_type:t.pay_coin_type,target_coin_type:t.target_coin_type}];et.setLimitOrderLoading(u?"all":t.id),console.log("cacelLimitOrder parmas",_);const C=await l.cancelOrdersByOwner(_),h=await Oe.signAndExecuteTransactionBlock(Jt.value.currentWallet,C),d=Oe.handleTx(h);if(d&&d.hash){rs(d.hash),Mt(!1),us(!0),ma.value=!1;const n={title:"Transaction",desc:"Order cancelled successfully",hash:d.hash,icon:"icon-icon-Increased"};n.res=d.res,Oe.showTransitionPending(n),await Oe.watchTransaction(n)&&setTimeout(()=>{Oe.getAccount(Jt.value.address),et.getOrderList()},2e3)}else Mt(!1),_a(!0),et.setLimitOrderLoading("")}catch(m){Mt(!1),_a(!0),ma.value=!1,et.setLimitOrderLoading(""),console.log("trade-data.ts cancel error##",m)}},pa=p(!1),V=p(!0),R=p(),A=p();function fa(){pa.value=!0;const t=k.value;k.value=S.value,S.value=t,V.value=!V.value;const u=R.value,l=A.value;V.value?(R.value=A.value,A.value=u):(A.value=R.value,R.value=l),setTimeout(()=>{pa.value=!1},300)}te(()=>xa.value,()=>{R.value="",A.value=""},{immediate:!0});const nt=p("orders"),ft=p(1),Rt=p(10),K=p([]),gt=p([]),_s=p(1),ot=p(),pt=w(()=>ea.value.limitOrderList),Pt=w(()=>wa.value.tokensObj),ms=Ne("Sui"),rt=p(),ps=t=>{rt.value={...rt.value,[t.id]:t}},qt=p(!1),ga=w(()=>ea.value.cancelOrderId),fs=async()=>{const t=Rt.value*ft.value-Rt.value;let u=ft.value*Rt.value;u=u>pt.value.length?pt.value.length:u;const l=pt.value;if(console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-orders.vue:147 ~ updateOrderList ~ ordersList.value:",pt.value),console.log("trade-card updateOrderList tokenObj",Pt.value),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-orders.vue:257 ~ updateOrderList ~ orderDirectObj.value:",rt.value),l.length>0){const m=[],_=l.filter((h,d)=>d>=t&&d<u);for(let h=0;h<_.length;h++){const d=_[h];console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-orders.vue:176 ~ updateOrderList ~ order.pay_coin_type:",await Oe.getTokenListByCoinType[d.pay_coin_type]);const n=Pt.value[d.pay_coin_type]||(await Oe.getTokenListByCoinType([d.pay_coin_type]))[0],y=Pt.value[d.target_coin_type]||(await Oe.getTokenListByCoinType([d.target_coin_type]))[0];console.log(d,"order###"),console.log(n.decimals,"##pay_coin_info.decimals");const r=pe(ms.rateToPrice(d.rate,n.decimals,y.decimals).toString(),n.decimals),i=new x(d.total_pay_amount).div(Math.pow(10,n.decimals)).toString(),T=new x(d.total_pay_amount).mul(new x(Math.pow(10,18))).div(new x(d.rate)).ceil().div(new x(Math.pow(10,y.decimals))).toString(),I=new x(d.total_pay_amount).mul(new x(r)).toString();console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-orders.vue:166 ~ updateOrderList ~ totalBuyNum:",T,I);const v=new x(d.obtained_amount).div(Math.pow(10,y.decimals)).toString(),O=it(new x(v).div(new x(T)).mul(100).toString(),2),b=new x(d.target_balance).div(Math.pow(10,y.decimals)).toString(),$=pe(new x(1).div(new x(r)).toString());console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-orders.vue:217 ~ updateOrderList ~ new Decimal(1).div(new Decimal(rate)).toString():",new x(1).div(new x(r)).toString()),m.push({...d,pay_coin_info:n,target_coin_info:y,total_pay_amount:i,rate:r,totalBuyNum:T,obtained_amount:v,obtainedRatio:O,target_balance:b,reseverRate:$,direction:rt.value&&rt.value[d.id]&&rt.value[d.id].direction||!1})}K.value=m,console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-data.ts:255 ~ updateOrderList ~ pageList.value:",K.value),_s.value==1;const C=m.filter(h=>{var d;return h.id==((d=ot==null?void 0:ot.value)==null?void 0:d.id)});ot.value=C&&C.length>0?C[0]:""}gt.value=l,et.setOrderNum(l.length),console.log("allList",gt.value),console.log("pageList",K.value)};te(()=>[pt.value,ft.value,Pt.value,Jt.value.address],([t,u,l,m])=>{t&&t.length>0&&l&&!Pe(l)&&m?fs():(K.value=[],gt.value=[],et.setOrderNum(0))},{immediate:!0});const gs=t=>(Ce("data-v-fa5a04b3"),t=t(),Le(),t),hs={class:"switch-direction"},ys={class:"left"},bs={key:0,class:"token-info"},ws={key:0},$s={key:1,class:"token-info"},xs={alt:""},ks={alt:""},Ss={class:"iframe-chart-box"},Os={key:0,class:"chart-no-data"},Cs=gs(()=>e("img",{src:ls,alt:""},null,-1)),Ls=["src","onload"],Ts=ce({__name:"trade-chart",setup(t){const u=p(!0);p(!0),p(),p(),p();const l=Te(),m=w(()=>l);w(()=>m.value.RATES),w(()=>m.value.marketPriceLoading);const _=w(()=>m.value.haveMarket);p(),p();const C=vt(),h=w(()=>C),d=w(()=>h.value.addressLpTokens),n=wt(),y=w(()=>n),r=w(()=>y.value.openPool),i=p(),T=()=>{var v;const I=[];if((v=r==null?void 0:r.value)==null||v.forEach(O=>{var b,$,E,L,Y,ae,se,fe;if(O.coinA.address.toUpperCase()===(($=(b=k==null?void 0:k.value)==null?void 0:b.address)==null?void 0:$.toUpperCase())&&O.coinB.address.toUpperCase()===((L=(E=S==null?void 0:S.value)==null?void 0:E.address)==null?void 0:L.toUpperCase())||O.coinB.address.toUpperCase()===((ae=(Y=k==null?void 0:k.value)==null?void 0:Y.address)==null?void 0:ae.toUpperCase())&&O.coinA.address.toUpperCase()===((fe=(se=S==null?void 0:S.value)==null?void 0:se.address)==null?void 0:fe.toUpperCase())){const ue=(d==null?void 0:d.value[O.address])||{};ue&&!Pe(ue)&&I.push({...O,pure_tvl_in_usd:ue.pure_tvl_in_usd})}}),I&&I.length>0){const O=I.sort((b,$)=>b.pure_tvl_in_usd-$.pure_tvl_in_usd)[0];return i.value=O,console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-chart.vue:327 ~ poolInfo ~ result:",O),!1}i.value=null};return te(()=>[r.value,d.value,k.value,S.value],([I,v])=>{I&&I.length>0&&v&&!Pe(v)&&T()},{immediate:!0}),(I,v)=>{var E,L,Y,ae,se,fe,ue,X,Ue,ge,Z,le,ve,Ie,Be,$e,ne,ye,re,Ke,De,Ge,xe,Qe,Fe,Xe,Me,_e,Ze,B,ie,me,be,W,he,je,Ee,kt,St;const O=ya,b=bt,$=Ut("image");return c(),g("div",{class:G(["trade-chart",!u.value&&!i.value?"trade-chart-no-pool":""])},[e("div",hs,[e("div",ys,[i.value?(c(),g("div",bs,[e("div",null,[oe(e("img",null,null,512),[[$,(E=i.value)!=null&&E.needReverse?(Y=(L=i.value)==null?void 0:L.token_b)==null?void 0:Y.logo_url:(se=(ae=i.value)==null?void 0:ae.token_a)==null?void 0:se.logo_url]]),M(O,{address:(fe=i.value)!=null&&fe.needReverse?(X=(ue=i.value)==null?void 0:ue.token_b)==null?void 0:X.address:(ge=(Ue=i.value)==null?void 0:Ue.token_a)==null?void 0:ge.address,"style-params":{width:"12px",height:"12px",right:"0px",bottom:"0px",zIndex:"5"}},null,8,["address"])]),e("div",null,[oe(e("img",null,null,512),[[$,(Z=i.value)!=null&&Z.needReverse?(ve=(le=i.value)==null?void 0:le.token_a)==null?void 0:ve.logo_url:(Be=(Ie=i.value)==null?void 0:Ie.token_b)==null?void 0:Be.logo_url]]),M(O,{address:($e=i.value)!=null&&$e.needReverse?(ye=(ne=i.value)==null?void 0:ne.token_a)==null?void 0:ye.address:(Ke=(re=i.value)==null?void 0:re.token_b)==null?void 0:Ke.address,"style-params":{width:"12px",height:"12px",right:"0px",bottom:"0px",zIndex:"5"}},null,8,["address"])]),i.value?(c(),g("span",ws,o((De=i.value)!=null&&De.needReverse?(xe=(Ge=i.value)==null?void 0:Ge.token_b)==null?void 0:xe.symbol:(Fe=(Qe=i.value)==null?void 0:Qe.token_a)==null?void 0:Fe.symbol)+" / "+o((Xe=i.value)!=null&&Xe.needReverse?(_e=(Me=i.value)==null?void 0:Me.token_a)==null?void 0:_e.symbol:(B=(Ze=i.value)==null?void 0:Ze.token_b)==null?void 0:B.symbol),1)):F("",!0)])):a(k)&&a(S)?(c(),g("div",$s,[e("div",null,[oe(e("img",xs,null,512),[[$,(ie=a(k))==null?void 0:ie.logo_url]]),M(O,{address:(me=a(k))==null?void 0:me.address,"style-params":{width:"12px",height:"12px",right:"0px",bottom:"0px",zIndex:"5"}},null,8,["address"])]),e("div",null,[oe(e("img",ks,null,512),[[$,(be=a(S))==null?void 0:be.logo_url]]),M(O,{address:(W=a(S))==null?void 0:W.address,"style-params":{width:"12px",height:"12px",right:"0px",bottom:"0px",zIndex:"5"}},null,8,["address"])]),e("span",null,o((he=a(k))==null?void 0:he.symbol)+" / "+o((je=a(S))==null?void 0:je.symbol),1)])):F("",!0)])]),e("div",Ss,[!u.value&&!i.value?(c(),g("div",Os,[Cs,e("span",null,o(_.value?"Price chart is currently not available for this pair, but you can still place your limit orders.":"No data avaliable"),1)])):F("",!0),oe(e("iframe",{id:"geckoterminal-embed",ref:"myFrame",class:"frame",height:"100%",width:"100%",title:"GeckoTerminal Embed",frameborder:"0",allow:"clipboard-write",allowfullscreen:"",src:`https://birdeye.so/tv-widget/${(kt=(Ee=i.value)==null?void 0:Ee.token_a)==null?void 0:kt.address}/${(St=i.value)==null?void 0:St.address}?chain=sui`,onload:()=>{u.value=!1}},null,8,Ls),[[ut,!u.value&&i.value]]),oe(M(b,null,null,512),[[ut,u.value]])])],2)}}});const jo=de(Ts,[["__scopeId","data-v-fa5a04b3"]]),ka=t=>(Ce("data-v-424fa68d"),t=t(),Le(),t),Is={class:"custom-expiry"},Ms={class:"input-box"},Es=ka(()=>e("div",{class:"minutes"},"Hours",-1)),Rs={class:"input-box"},Ps=ka(()=>e("div",{class:"minutes"},"Minutes",-1)),Ns=ce({__name:"custom-expires-modal",setup(t){const u=p(),l=p(),m=p({}),_=(n,y)=>{const r=(n||0)*60+Number(y||0),i=Math.floor(r/(60*24)),T=Math.floor(r%(60*24)/60),I=r%60;let v="";i>0&&(v+=i+"d "),T>0&&(v+=T+"h "),I>0&&(v+=I+"m "),m.value={timeText:v.trim()||"0 m",time:r*60*1e3}};te(()=>[u.value,l.value],([n,y])=>{_(n,y)},{immediate:!0});const C=n=>{const y=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,0}})?).*$");n.target.value=n.target.value.replace(y,"$1"),u.value=n.target.value,console.log(u.value,"##inputChange")},h=n=>{const y=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,0}})?).*$");n.target.value=n.target.value.replace(y,"$1"),l.value=n.target.value},d=w(()=>!u.value&&!l.value||Number(u.value)==0&&!l.value||Number(l.value)==0&&!u.value||Number(u.value)==0&&Number(l.value)==0);return(n,y)=>{const r=Gt,i=tt;return c(),j(a(Kt),{class:"new-modal-have-btn",title:"Custom Expiry Period",visible:!0,width:"400px",footer:null,onCancel:y[3]||(y[3]=T=>n.$emit("closeModal"))},{default:z(()=>[e("div",Is,[e("div",Ms,[M(r,{value:u.value,"onUpdate:value":y[0]||(y[0]=T=>u.value=T),placeholder:"0",onChange:C},null,8,["value"]),Es]),e("div",Rs,[M(r,{value:l.value,"onUpdate:value":y[1]||(y[1]=T=>l.value=T),placeholder:"0",onChange:h},null,8,["value"]),Ps]),M(i,{class:"set-period modal-bottom-btn",disabled:d.value,onClick:y[2]||(y[2]=T=>n.$emit("sendTime",m.value))},{default:z(()=>[U("Set Period")]),_:1},8,["disabled"])])]),_:1})}}});const As=de(Ns,[["__scopeId","data-v-424fa68d"]]),at=t=>(Ce("data-v-cd0718ea"),t=t(),Le(),t),Hs=at(()=>e("use",{"xlink:href":"#icon-a-icon-Shutdown"},null,-1)),Us=[Hs],Bs={class:"trade-cofirm-content"},Ds={class:"coin-info"},Fs={class:"from-coin-info"},js={class:"left"},zs={class:"coin-amount"},Ws={class:"coin-symbol"},Vs={class:"right"},Ys={class:"to-coin-info"},qs={class:"left"},Js={class:"coin-amount"},Ks={class:"coin-symbol"},Gs={class:"right"},Qs=at(()=>e("div",{class:"new-sui-exchange to-swap-logo"},[e("div",{class:"exchange-new"},[e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap1"})])])],-1)),Xs={class:"trade-info"},Zs={class:"price"},el=at(()=>e("div",{class:"label"},"Pirce",-1)),tl={class:"text"},al={key:0},sl={key:1},ll=at(()=>e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap2"})],-1)),nl=[ll],il={class:"expires-in"},ol=at(()=>e("div",{class:"label"},"Expires in",-1)),rl={class:"text"},ul=at(()=>e("div",{class:"trade-tips1"}," You will receive exactly what you have specified if your order is fully filled in the end. ",-1)),cl=at(()=>e("div",{class:"trade-tips2"}," Please note that your order may not be filled immediately after the price is triggered, depending on pending sequence and liquidity depth. ",-1)),dl=ce({__name:"trade-confirm",props:{fromCoin:{type:Object,default:()=>({})},toCoin:{type:Object,default:()=>({})},fromCoinAmount:{type:String,default:""},toCoinAmount:{type:String,default:""},direction:{type:Boolean,default:!1},price:{type:String,default:""},currentExpires:{type:String,default:""}},emits:["to-trade","close"],setup(t,{emit:u}){const l=t,m=u,_=p(!1),C=w(()=>new x(1).div(new x(l.price)).toString()),h=async()=>{m("to-trade")};return(d,n)=>{const y=tt,r=Ut("image");return c(),j(a(Kt),{title:"Review your order",width:"440px",footer:null,visible:!0,class:"trade-confirm-modal new-modal-have-btn"},{closeIcon:z(()=>[(c(),g("svg",{class:"icon modal-icon-close","aria-hidden":"true",onClick:n[0]||(n[0]=i=>m("close"))},Us))]),default:z(()=>{var i,T,I,v,O,b,$,E;return[e("div",Bs,[e("div",Ds,[e("div",Fs,[e("div",js,[e("div",zs,o(t.fromCoinAmount&&a(P)(t.fromCoinAmount)),1),e("div",Ws,o(t.fromCoin&&t.fromCoin.symbol),1)]),e("div",Vs,[oe(e("img",null,null,512),[[r,t.fromCoin&&t.fromCoin.logo_url]])])]),e("div",Ys,[e("div",qs,[e("div",Js,o(t.toCoinAmount&&a(P)(t.toCoinAmount)),1),e("div",Ks,o(t.toCoin&&t.toCoin.symbol),1)]),e("div",Gs,[oe(e("img",null,null,512),[[r,t.toCoin&&t.toCoin.logo_url]])]),Qs])]),e("div",Xs,[e("div",Zs,[el,e("div",tl,[t.direction?(c(),g("span",sl,o(a(P)(a(pe)(_.value?C.value:t.price,9)))+" "+o(_.value?(b=t.fromCoin)==null?void 0:b.symbol:(O=t.toCoin)==null?void 0:O.symbol)+" per "+o(_.value?(E=t.toCoin)==null?void 0:E.symbol:($=t.fromCoin)==null?void 0:$.symbol),1)):(c(),g("span",al,o(a(P)(a(pe)(_.value?C.value:t.price,9)))+" "+o(_.value?(T=t.toCoin)==null?void 0:T.symbol:(i=t.fromCoin)==null?void 0:i.symbol)+" per "+o(_.value?(v=t.fromCoin)==null?void 0:v.symbol:(I=t.toCoin)==null?void 0:I.symbol),1)),e("div",{class:"right",onClick:n[1]||(n[1]=L=>_.value=!_.value)},nl)])]),e("div",il,[ol,e("div",rl,o(t.currentExpires),1)])]),ul,cl]),M(y,{class:"big-btn trade-confirm-btn modal-bottom-btn",onClick:n[2]||(n[2]=L=>h())},{default:z(()=>[U(" Place Order ")]),_:1})]}),_:1})}}});const vl=de(dl,[["__scopeId","data-v-cd0718ea"]]),Dt=t=>(Ce("data-v-b38206c2"),t=t(),Le(),t),_l={class:"trade-card"},ml={class:"trade-content"},pl={class:"trade-card-title"},fl={class:"tit-icon-box"},gl={class:"icon-bg"},hl=Dt(()=>e("use",{"xlink:href":"#icon-icon_kline"},null,-1)),yl=[hl],bl={class:"icon-bg"},wl={class:"trade-card-content"},$l=Ya('<div class="exchange-new" data-v-b38206c2><svg class="icon icon-down" aria-hidden="true" data-v-b38206c2><use xlink:href="#icon-icon_swap1" data-v-b38206c2></use></svg><svg class="icon icon-swap" aria-hidden="true" data-v-b38206c2><use xlink:href="#icon-tx_swap1" data-v-b38206c2></use></svg></div>',1),xl=[$l],kl={class:"sell-setting"},Sl={class:"top"},Ol={key:0,class:"direction-text"},Cl={key:1,class:"direction-text"},Ll={class:"bottom"},Tl={class:"coin-symbol"},Il=Dt(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap_change"})],-1)),Ml=[Il],El={class:"top"},Rl=Dt(()=>e("span",null,"Expiry in",-1)),Pl={class:"bottom"},Nl=Dt(()=>e("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),Al=[Nl],Hl=["onClick"],Ul={class:"market-price-tips"},Bl=ce({__name:"trade-card",setup(t){const u=p(!1),l=p(!1),m=mt(Da,{style:{fontSize:"14px",marginLeft:"4px",color:"#75c8ff"},spin:!0}),{t:_}=Fa(),C=[{label:"Swap",value:"swap",link:"/swap"},{label:"Limit",value:"limit",link:"/limit"},{label:"DCA",value:"dca",link:"/dca",isHaveBeta:!0}];p("Limit");const h=He(),d=w(()=>h),n=w(()=>d.value.assets&&k.value&&d.value.assets[k.value.address]?ua(d.value.assets[k.value.address].balance,k.value.decimals):0);w(()=>d.value.assets&&S.value&&d.value.assets[S.value.address]?ua(d.value.assets[S.value.address].balance,S.value.decimals):0);const y=p(""),r=p(""),i=p(""),T=p(!1),I=f=>{var s,D,q,ee;y.value=f,f==="fromCoin"?(r.value=((s=S.value)==null?void 0:s.address)||"",i.value=((D=k.value)==null?void 0:D.address)||""):(r.value=((q=k.value)==null?void 0:q.address)||"",i.value=((ee=S.value)==null?void 0:ee.address)||""),T.value=!0},v=["5 Minutes","10 Minutes","30 Minutes","1 Hour","1 Day","3 Days","7 Days","1 Month","Custom"],O=f=>{switch(f){case"5 Minutes":return 3e5;case"10 Minutes":return 6e5;case"30 Minutes":return 18e5;case"1 Hour":return 36e5;case"1 Day":return 864e5;case"7 Days":return 6048e5;case"1 Month":return 2592e6;default:return 0}},b=p(!1),$=p("7 Days"),E=p(!1),L=p(),Y=p(0),ae=f=>{$.value=f.timeText,Y.value=f.time,E.value=!1},se=p(),fe=f=>{se.value=y.value==="fromCoin"?k.value:S.value;let s=!1;y.value==="fromCoin"?(R.value="",S.value&&f.address.toLowerCase()===(S==null?void 0:S.value.address.toLowerCase())&&(S.value=k.value,s=!0),k.value=f):(k.value&&(A.value="",f.address.toLowerCase()===(k==null?void 0:k.value.address.toLowerCase())&&(k.value=S.value,s=!0)),S.value=f),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:416 ~ onCoinSelect ~ toCoin.value:",S.value),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:453 ~ onCoinSelect ~ fromCoin.value:",k.value),s||(B.value=!1),T.value=!1},ue=p(20),X=p(0),Ue=p(null),ge=p(!1),Z=()=>{ge.value||(clearInterval(Ue.value),d.value.address&&(re.getOrderList(),re.getLimitOrderHistory(d.value.address),_e.getAccount(d.value.address)),me.value||W.value?zt():Ot(!1),X.value=0,ge.value=!0,setTimeout(()=>{ge.value=!1,le()},1e3))},le=()=>{Ue.value=setInterval(()=>{ge.value=!1,X.value<ue.value&&(X.value+=1,X.value===ue.value&&Z())},1e3)};ja(()=>{le(),window.addEventListener("click",()=>{b.value=!1})}),za(()=>{clearInterval(Ue.value)});const ve=()=>{if(V.value&&(!R.value||R.value==0)||!V.value&&(!A.value||A.value==0))return!1;if(L.value<=0&&lt.value)return V.value?A.value="":R.value="",!1;if(Number(R.value)<=0&&Number(A.value)<=0)return!1;if(L.value<=0&&!lt.value&&R.value>0&&A.value>0)return console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:480 ~ updateAmounts ~ fromCoinAmount.value&&toCoinAmount.value:",R.value>0&&A.value>0),L.value=B.value?pe(new x(A.value||0).div(new x(R.value||0)).toString()):pe(new x(R.value||0).div(new x(A.value||0)).toString()),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:497 ~ updateAmounts ~ fixedFromCoin.value :",V.value),!1;if(L.value<=0&&!lt.value)return!1;V.value?B.value?A.value=it(new x(R.value).mul(new x(L.value||0)).toString(),S.value.decimals):A.value=it(new x(R.value).div(new x(L.value||0)).toString(),S.value.decimals):B.value?R.value=it(new x(A.value).div(new x(L.value||0)).toString(),k.value.decimals):R.value=it(new x(A.value).mul(new x(L.value||0)).toString(),k.value.decimals)};te(R,Vt((f,s)=>{f&&f!==0&&V.value&&ve(),f==""&&V.value&&(A.value="")},100)),te(L,Vt((f,s)=>{f&&f!==0&&ve(),f==""&&V.value&&(A.value="")},100)),te(A,Vt((f,s)=>{f&&f!==0&&!V.value&&ve(),f==""&&!V.value&&(R.value="")},100));const Ie=wt(),Be=w(()=>Ie),$e=w(()=>{var q;const s=(q=Be.value.RATES[k.value.address])==null?void 0:q.price,D=new x(s||0).mul(R.value||0).toNumber();if(s){if(D<5&&s)return!0}else return!1;return!1}),ne=w(()=>!k.value||!S.value?_("modal.selectTokenModalTitle"):Ee.value?!Number(R.value)||!Number(A.value)?_("button.enterAmount"):$e.value?"Order size should be higher than $5":Number(R.value)>Number(n.value)?_("button.insufficientBalance",{name:k.value.symbol}):"Place Limit Order":"No Available Route"),ye=w(()=>!!(!k.value||!S.value||!L.value||$e.value||!Number(R.value)&&!Number(A.value)||Number(R.value)>Number(n.value)||Number(R.value)==0||Number(A.value)==0||!Ee.value)),re=Te(),Ke=w(()=>re),De=vt(),{setTransactionTxid:Ge,setIsShowWaiting:xe,setIsShowSuccess:Qe,setIsShowRejected:Fe,setTransactionDesc:Xe}=De,Me=p(!1),_e=Bt("Sui"),Ze=async()=>{Lt.value=!1;const f=Ne("Sui"),s=Date.parse(new Date().toString())+(O($.value)||Y.value);try{Xe("Creating order"),xe(!0);const q={pay_coin_amount:R.value,price:B.value?L.value:new x(1).div(new x(L.value)).toString(),expired_ts:s,pay_coin_type:k.value.address,target_coin_type:S.value.address,pay_decimal:k.value.decimals,target_decimal:S.value.decimals};console.log("placeLimitOrder parmas",q);const ee=await f.placeLimitOrder(q),_t=await _e.signAndExecuteTransactionBlock(d.value.currentWallet,ee),ke=_e.handleTx(_t);if(ke&&ke.hash){Ge(ke.hash),xe(!1),Qe(!0),Me.value=!1;const Re={title:"Transaction",desc:"Order placed successfully",hash:ke.hash,icon:"icon-icon-Increased"};Re.res=ke.res,_e.showTransitionPending(Re),await _e.watchTransaction(Re)&&setTimeout(()=>{_e.getAccount(d.value.address),re.getOrderList()},1e3)}else xe(!1),Fe(!0)}catch(D){xe(!1),Fe(!0),Me.value=!1,console.log("trade-card openOrder error##",D)}},B=p(!1),ie=p(),me=p(""),be=p(),W=p("0"),he=p(""),je=p(),Ee=p(!0),kt=async()=>{var D,q;let f;if(V.value){const ee=new x(1).mul(Math.pow(10,(D=k==null?void 0:k.value)==null?void 0:D.decimals)).toString();f=new da(ee)}else{const ee=new x(1).mul(Math.pow(10,(q=S==null?void 0:S.value)==null?void 0:q.decimals)).toString();f=new da(ee)}const s=await _e.getBestRouterByServer(k,S,f,V.value,d.value.address,!1,!1);console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:805 ~ getTokenRouter ~ res:",s),s&&s.splitPaths&&s.splitPaths.length>0?(Ee.value=!0,re.setHaveMarket(!0)):(Ee.value=!1,re.setHaveMarket(!1))},St=async()=>{var ke,Re;const s=(await $fetch(`${H.Sui.api}/v2/sui/price?base_symbol_address_pair=${ra(k.value.address)},${ra(S.value.address)}`)).data.prices||[],D=[];s.forEach(Se=>{Se.base_symbol=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?D.push({...Se,base_symbol:"0x2::sui::SUI"}):D.push(Se)});const q=Object.fromEntries(D.map(Se=>[Se.base_symbol,Se]));console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:872 ~ setMarketPriceFromRate ~ RATES:",q);const ee=new x((ke=q[S.value.address])==null?void 0:ke.price),_t=new x((Re=q[k.value.address])==null?void 0:Re.price);return{inputAmount:ee,outputAmount:_t}},Ft=p(!1),Ot=async f=>{f||(Ft.value=!0);let s;try{s=await St()}catch(D){console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:787 ~ setMarketPrice ~ error:",D)}if(W.value="",console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:794 ~ setMarketPrice ~ res:",s),!s||s.outputAmount.toNumber()<=0&&s.inputAmount.toNumber()<=0)return je.value=!1,he.value="",me.value="",W.value="",!1;je.value=!0,f?ie.value=B.value?pe(s.outputAmount.div(s.inputAmount).toString()):pe(s.inputAmount.div(s.outputAmount).toString()):L.value=B.value?pe(s.outputAmount.div(s.inputAmount).toString()):pe(s.inputAmount.div(s.outputAmount).toString()),setTimeout(()=>{Ft.value=!1},1e3)},jt=p(!1),zt=async()=>{jt.value=!0,await Ot(!0),he.value="",me.value="",W.value="";const f=new x(L.value).sub(new x(ie.value)).div(new x(ie.value)).mul(100);W.value=f.toNumber().toFixed(2);const s=Math.abs(f.toNumber()).toFixed(2);me.value=`Limit order price is ${s}% ${W.value>0?"higher":"lower"} than the market.`,B.value?L.value>ie.value?(he.value="",be.value="#68FFD8"):ie.value>L.value&&(he.value=`Your limit order price is ${s}% ${W.value>0?"higher":"lower"} than market. You are selling at a much higher rate. We recommend you to use`,be.value="#ffb62d"):L.value>ie.value?(he.value=`Your limit order price is ${s}% ${W.value>0?"higher":"lower"} than market. You are buying at a much lower rate. We recommend you to use`,be.value="#ffb62d"):ie.value>L.value&&(he.value="",be.value="#68FFD8"),jt.value=!1};te(()=>[k.value,S.value],([f,s])=>{f&&s&&(L.value="",Ot(!1))},{immediate:!0});const lt=p(!1),Ea=f=>{const s=new RegExp("[^\\d-]*(\\d*(?:\\.\\d{0,18})?).*$");f.target.value=f.target.value.replace(s,"$1"),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:1002 ~ priceChange ~ e.target.value:",f.target.value),L.value=f.target.value,he.value="",me.value="",W.value="",lt.value=!0,L.value&&L.value>0&&Ee.value&&zt()},Ra=()=>{B.value=!B.value,L.value=pe(new x(1).div(new x(L.value)).toString()),L.value>0&&Ee.value&&zt()},ze=p(),We=p(),Ct=p(!1),sa=(f,s)=>{var q,ee;const D=De.importTokenListObj;f&&!Pe(f)&&f!=null&&f.isSelfBuilt&&!(D!=null&&D.hasOwnProperty(f==null?void 0:f.address))&&(y.value="fromCoin",ze.value=f),s&&!Pe(s)&&s!=null&&s.isSelfBuilt&&!(D!=null&&D.hasOwnProperty(s==null?void 0:s.address))&&(y.value="toCoin",We.value=s),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:1034 ~ getTokenSource ~ warningFromCoin.value:",ze.value),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-card.vue:1046 ~ getTokenSource ~ warningToCoin.value:",We.value),((q=ze==null?void 0:ze.value)!=null&&q.address||(ee=We==null?void 0:We.value)!=null&&ee.address)&&(Ct.value=!0)};te(()=>[k.value,S.value],([f,s])=>{f&&!Pe(f)&&sa(f,{}),s&&!Pe(s)&&sa({},s)},{immediate:!0});const Pa=()=>{y.value==="fromCoin"?k.value=se.value:S.value=se.value,Ct.value=!1,ze.value="",We.value=""},Na=w(()=>{var f,s;return`/swap?from=${(f=k==null?void 0:k.value)==null?void 0:f.address}&to=${(s=S==null?void 0:S.value)==null?void 0:s.address}`}),Aa=Wa();te(()=>[k.value,S.value],([f,s])=>{if(f&&s){if(kt(),ve(),f||s){const D=`/limit/${f==null?void 0:f.address}-${s==null?void 0:s.address}`;Aa.push(D)}}else re.setHaveMarket(!1)},{immediate:!0});const Lt=p(!1),Wt=w(()=>Ke.value.isShowChart);return(f,s)=>{var Re,Se,la,na;const D=Xt,q=bt,ee=tt,_t=Gt,ke=Ja;return c(),g("div",_l,[e("div",ml,[e("div",pl,[M(ba,{"tab-list":C,"current-tab":"limit",onClickTab:s[0]||(s[0]=N=>f.$router.push(N.link))}),e("div",fl,[M(D,{"overlay-class-name":"ant-tooltip-text-color"},{title:z(()=>[U(o(Wt.value?"Hide reference price":"View reference price"),1)]),default:z(()=>[e("div",gl,[(c(),g("svg",{class:G(["chart-icon",Wt.value?"active-chart-icon":""]),"aria-hidden":"true",onClick:s[1]||(s[1]=N=>a(re).setIsShowChart(!Wt.value))},yl,2))])]),_:1}),e("div",bl,[M(Ka,{loading:ge.value,"auto-refresh-time":ue.value,countdown:X.value,"tooltip-placement":"left",onClickRefresh:Z},null,8,["loading","auto-refresh-time","countdown"])])])]),e("div",wl,[e("div",{class:G(["card-container",u.value?a(V)?"input-block-add-top":"input-block-add-bottom":"input-block-add-top input-block-inactive"])},[M(ca,{modelValue:a(R),"onUpdate:modelValue":s[2]||(s[2]=N=>ia(R)?R.value=N:null),"input-value":a(R),"token-info":a(k)||null,"title-text":"Sell",onOnInput:s[3]||(s[3]=N=>{u.value=!0,R.value=N,V.value=!0,lt.value=!1}),onOnFocus:s[4]||(s[4]=()=>{u.value=!0,V.value=!0}),onOnBlur:s[5]||(s[5]=()=>{u.value=!1}),onOnSelect:s[6]||(s[6]=N=>I("fromCoin"))},null,8,["modelValue","input-value","token-info"]),M(ca,{modelValue:a(A),"onUpdate:modelValue":s[7]||(s[7]=N=>ia(A)?A.value=N:null),"input-value":a(A),"token-info":a(S)||null,"have-max":!1,"have-half":!1,"title-text":"Buy",onOnInput:s[8]||(s[8]=N=>{u.value=!0,A.value=N,V.value=!1,lt.value=!1}),onOnFocus:s[9]||(s[9]=()=>{u.value=!0,V.value=!1}),onOnBlur:s[10]||(s[10]=()=>{u.value=!1}),onOnSelect:s[11]||(s[11]=N=>I("toCoin"))},null,8,["modelValue","input-value","token-info"])],2),e("div",{class:"exchange new-sui-exchange",onClick:s[12]||(s[12]=(...N)=>a(fa)&&a(fa)(...N))},xl)]),e("div",kl,[e("div",{class:G(["sell-rate",l.value?"sell-rate-active":""])},[e("div",Sl,[e("div",null,[B.value?(c(),g("div",Ol," Sell "+o((Re=a(k))==null?void 0:Re.symbol)+" at rate",1)):(c(),g("div",Cl,"Buy "+o((Se=a(S))==null?void 0:Se.symbol)+" at rate ",1)),jt.value?(c(),j(q,{key:2,indicator:a(m)},null,8,["indicator"])):(c(),j(D,{key:3,"overlay-class-name":"ant-tooltip-text-color"},Va({default:z(()=>[L.value&&ie.value&&je.value&&Number(W.value)!==0?(c(),g("div",{key:0,class:"rate",style:Yt({color:be.value})},o(Number(W.value)>0&&Number(W.value)<1e4?`+${W.value}`:Number(W.value)>1e4?">10000":W.value)+"% ",5)):F("",!0)]),_:2},[me.value?{name:"title",fn:z(()=>[U(o(me.value),1)]),key:"0"}:void 0]),1024))]),je.value?(c(),j(ee,{key:0,loading:Ft.value,class:"set-market max-btn",onClick:s[13]||(s[13]=N=>Ot(!1))},{default:z(()=>[U("Market")]),_:1},8,["loading"])):F("",!0)]),e("div",Ll,[M(_t,{value:L.value,"onUpdate:value":s[14]||(s[14]=N=>L.value=N),placeholder:"0.0",onInput:s[15]||(s[15]=()=>{l.value=!0,V.value=!0}),onFocus:s[16]||(s[16]=()=>{l.value=!0,V.value=!0}),onBlur:s[17]||(s[17]=()=>{l.value=!1}),onChange:Ea},null,8,["value"]),e("div",Tl,[e("span",null,o(B.value?(la=a(S))==null?void 0:la.symbol:(na=a(k))==null?void 0:na.symbol),1),e("div",{class:"right",onClick:Ra},Ml)])])],2),e("div",{class:"sell-expires",onClick:s[18]||(s[18]=Qt(N=>b.value=!b.value,["stop"]))},[e("div",El,[Rl,M(es,{type:"expiryIn","xlink-href":"#icon-icon_tips"})]),e("div",Pl,[e("span",null,o($.value),1),(c(),g("svg",{class:"icon","aria-hidden":"true",style:Yt(b.value?{transform:"rotate(180deg)"}:{})},Al,4))]),e("div",{class:"expires-list",style:Yt(b.value?{display:"block"}:{})},[(c(),g(Q,null,Ae(v,N=>e("div",{key:N,class:G(["expirer-item",N==$.value?"expirer-item-active":""]),onClick:bo=>N=="Custom"?E.value=!0:$.value=N},o(N),11,Hl)),64))],4)])]),oe(e("div",Ul,[U(o(he.value)+" ",1),e("span",{onClick:s[19]||(s[19]=N=>f.$router.push(Na.value))},"Cetus Swap"),U(" instead. ")],512),[[ut,L.value&&ie.value&&Number(W.value)!==0&&he.value&&je.value]])]),d.value&&d.value.address?(c(),j(ee,{key:0,disabled:ye.value,class:G(["place-order-btn",ne.value&&ne.value.length>40?"place-order-btn-size":""]),loading:Me.value,onClick:s[20]||(s[20]=N=>Lt.value=!0)},{default:z(()=>[U(o(ne.value),1)]),_:1},8,["disabled","class","loading"])):(c(),j(ee,{key:1,class:"place-order-btn",onClick:s[21]||(s[21]=N=>d.value.setIsShowWalletModal(!0))},{default:z(()=>[U("Connect wallet")]),_:1})),E.value?(c(),j(As,{key:2,onCloseModal:s[22]||(s[22]=N=>E.value=!1),onSendTime:ae})):F("",!0),T.value?(c(),j(Za,{key:3,"existing-coins":r.value,"last-select-coin":i.value,"have-import-btn":!0,onOnSelect:fe,onOnClose:s[23]||(s[23]=N=>T.value=!1)},null,8,["existing-coins","last-select-coin"])):F("",!0),Ct.value?(c(),j(ke,{key:4,"from-coin":ze.value,"to-coin":We.value,"is-import-modal":!0,onClose:Pa,onClickContinue:s[24]||(s[24]=()=>{Ct.value=!1,ze.value="",We.value=""})},null,8,["from-coin","to-coin"])):F("",!0),Lt.value?(c(),j(vl,{key:5,"from-coin":a(k),"to-coin":a(S),"from-coin-amount":a(R),"to-coin-amount":a(A),direction:B.value,price:L.value,"current-expires":$.value,onClose:s[25]||(s[25]=N=>Lt.value=!1),onToTrade:Ze},null,8,["from-coin","to-coin","from-coin-amount","to-coin-amount","direction","price","current-expires"])):F("",!0)])}}});const zo=de(Bl,[["__scopeId","data-v-b38206c2"]]),Sa=t=>(Ce("data-v-a8dd45fb"),t=t(),Le(),t),Dl={key:0,class:"no-data"},Fl=Sa(()=>e("img",{src:ts,alt:""},null,-1)),jl={key:1,class:"no-data"},zl=Sa(()=>e("img",{src:as,alt:""},null,-1)),Wl=ce({__name:"trade-no-data",props:{platform:{type:String,default:"platform"}},setup(t){const u=He(),l=_=>{switch(_){case"orders":return"You don't have any open orders yet.";case"history":return"You don't have any order history.";case"claim":return"No History."}},m=w(()=>u);return(_,C)=>{const h=tt;return m.value&&m.value.address?(c(),g("div",Dl,[Fl,e("span",null,o(l(t.platform)),1)])):(c(),g("div",jl,[zl,M(h,{class:"connect-wallet",onClick:C[0]||(C[0]=d=>m.value.setIsShowWalletModal(!0))},{default:z(()=>[U("Connect Wallet")]),_:1})]))}}});const aa=de(Wl,[["__scopeId","data-v-a8dd45fb"]]),Vl={class:"trade-info"},Yl={alt:""},ql={alt:""},Jl=ce({__name:"trade-info",props:{order:{type:Object,default:()=>({})}},setup(t){return(u,l)=>{var C,h,d,n,y,r,i,T,I,v,O,b,$,E;const m=ya,_=Ut("image");return c(),g("div",Vl,[e("div",null,[oe(e("img",Yl,null,512),[[_,(h=(C=t.order)==null?void 0:C.pay_coin_info)==null?void 0:h.logo_url]]),M(m,{address:(n=(d=t.order)==null?void 0:d.pay_coin_info)==null?void 0:n.address,"style-params":{width:"12px",height:"12px",right:"0px",bottom:"0px",zIndex:"5"}},null,8,["address"])]),e("div",null,[oe(e("img",ql,null,512),[[_,(r=(y=t.order)==null?void 0:y.target_coin_info)==null?void 0:r.logo_url]]),M(m,{address:(T=(i=t.order)==null?void 0:i.target_coin_info)==null?void 0:T.address,"style-params":{width:"12px",height:"12px",right:"0px",bottom:"0px",zIndex:"5"}},null,8,["address"])]),e("span",null,o(a(P)((I=t.order)==null?void 0:I.total_pay_amount))+" "+o((O=(v=t.order)==null?void 0:v.pay_coin_info)==null?void 0:O.symbol)+" â†’ "+o(a(P)((b=t.order)==null?void 0:b.totalBuyNum))+" "+o((E=($=t.order)==null?void 0:$.target_coin_info)==null?void 0:E.symbol),1)])}}});const $t=de(Jl,[["__scopeId","data-v-d1826e2f"]]),qe=t=>(Ce("data-v-55e5ca76"),t=t(),Le(),t),Kl={class:"claim-modal-content"},Gl=qe(()=>e("div",{class:"desc"}," For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled. ",-1)),Ql={class:"order-info-detail"},Xl={class:"order-info"},Zl=qe(()=>e("div",{class:"label"},"Price",-1)),en={class:"text"},tn=qe(()=>e("div",{class:"label"},"Filled size",-1)),an={class:"text"},sn=qe(()=>e("div",{class:"label"},"Expiry",-1)),ln={class:"text"},nn={class:"tab"},on=["onClick"],rn={key:0,class:"claim-content"},un={class:"inp-box"},cn=qe(()=>e("div",{class:"top"},[e("div",{class:"avalibale-claim"},"Avalibale to claim")],-1)),dn={class:"bottom"},vn={class:"token-info"},_n={alt:""},mn={key:1,class:"history-list"},pn={class:"amount"},fn=qe(()=>e("div",{class:"label"},"Amount",-1)),gn={class:"text"},hn={alt:""},yn={class:"time"},bn=qe(()=>e("div",{class:"label"},"Time",-1)),wn={class:"text"},$n=["href"],xn=qe(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_link"})],-1)),kn=[xn],Sn={key:2,class:"loading-box"},On=ce({__name:"trade-claim-modal",props:{order:{type:Object,default:()=>({})}},emits:["closeModal"],setup(t,{emit:u}){const l=t,m=["Claim","History"],_=p("Claim"),C=p(),h=Z=>{const le=new RegExp(`[^\\d-]*(\\d*(?:\\.\\d{0,${l.order.target_coin_info.decimals}})?).*$`);console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-claim-modal.vue:128 ~ props.order.target_coin_info.decimals:",l.order.target_coin_info.decimals),console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-claim-modal.vue:128 ~ reg:",le),C.value=Z.target.value.replace(le,"$1")},d=p(!0);te(()=>l.order.target_balance,Z=>{Z&&Z>0&&d.value?(C.value=Z,d.value=!1):C.value=0},{immediate:!0});const n=w(()=>!!(C.value>l.order.target_balance||ae.value||!C.value||l.order.target_balance==0)),y=w(()=>C.value>l.order.target_balance?"Maximum amount that can be withdrawn":C.value?"Confirm Claim":"Claim"),r=vt(),i=w(()=>r),T=He(),I=w(()=>T),v=Ne("Sui"),{setTransactionTxid:O,setIsShowWaiting:b,setIsShowSuccess:$,setIsShowRejected:E,setTransactionDesc:L}=r,Y=Bt("Sui"),ae=p(!1),se=Te(),fe=w(()=>se),ue=async()=>{var Z,le;ae.value=!0;try{const ve=`Claim ${P(C.value)} ${(le=(Z=l.order)==null?void 0:Z.target_coin_info)==null?void 0:le.symbol}`;L(ve),b(!0);const Ie={order_id:l.order.id,pay_coin_type:l.order.pay_coin_type,target_coin_type:l.order.target_coin_type};console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-claim-modal.vue:194 ~ confirmClaim ~ params:",Ie);const Be=await v.claimTargetCoin(Ie),$e=await Y.signAndExecuteTransactionBlock(I.value.currentWallet,Be),ne=Y.handleTx($e);if(ne&&ne.hash){O(ne.hash),b(!1),$(!0);const ye={title:"Transaction",desc:"Claim successfully",hash:ne.hash,icon:"icon-icon-Increased"};ye.res=ne.res,Y.showTransitionPending(ye),await Y.watchTransaction(ye)&&(setTimeout(()=>{Y.getAccount(I.value.address),se.getOrderList()},2e3),setTimeout(()=>{C.value=0,ae.value=!1},4e3))}else b(!1),E(!0)}catch(ve){console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-claim-modal.vue:222 ~ confirmClaim ~ error:",ve),b(!1),E(!0),ae.value=!1}};te(()=>_.value,Z=>{Z=="History"&&se.getLimitOrderClaimHistory(l.order)},{immediate:!0});const X=w(()=>fe.value.currentOrderClaimHistory),Ue=w(()=>i.value.currentExplorer),ge=w(()=>fe.value.claimHistoryLoading);return(Z,le)=>{const ve=Gt,Ie=tt,Be=bt,$e=Ut("image");return c(),j(a(Kt),{title:"Claim",visible:!0,width:"440px",footer:null,onCancel:le[1]||(le[1]=ne=>Z.$emit("closeModal"))},{default:z(()=>{var ne,ye,re,Ke,De,Ge,xe,Qe,Fe,Xe,Me,_e,Ze;return[e("div",Kl,[Gl,e("div",Ql,[M($t,{order:t.order},null,8,["order"]),e("div",Xl,[e("div",null,[Zl,e("div",en,o(a(P)(t.order.reseverRate))+" "+o((ye=(ne=t.order)==null?void 0:ne.pay_coin_info)==null?void 0:ye.symbol)+" per "+o((Ke=(re=t.order)==null?void 0:re.target_coin_info)==null?void 0:Ke.symbol),1)]),e("div",null,[tn,e("div",an,[U(o(a(P)((De=t.order)==null?void 0:De.obtained_amount))+"/"+o(a(P)((Ge=t.order)==null?void 0:Ge.totalBuyNum))+" "+o((Qe=(xe=t.order)==null?void 0:xe.target_coin_info)==null?void 0:Qe.symbol)+" ",1),e("span",null,"("+o((Fe=t.order)==null?void 0:Fe.obtainedRatio)+"%)",1)])]),e("div",null,[sn,e("div",ln,o(a(Ye)(t.order.expire_ts,""))+" (UTC) ",1)])])]),e("div",nn,[(c(),g(Q,null,Ae(m,B=>e("div",{key:B,class:G(["tab-item",_.value==B?"tab-item-active":""]),onClick:ie=>_.value=B},o(B),11,on)),64))]),_.value=="Claim"?(c(),g("div",rn,[e("div",un,[cn,e("div",dn,[M(ve,{value:C.value,"onUpdate:value":le[0]||(le[0]=B=>C.value=B),disabled:"",onChange:h},null,8,["value"]),e("div",vn,[oe(e("img",_n,null,512),[[$e,(Me=(Xe=t.order)==null?void 0:Xe.target_coin_info)==null?void 0:Me.logo_url]]),e("span",null,o((Ze=(_e=t.order)==null?void 0:_e.target_coin_info)==null?void 0:Ze.symbol),1)])])]),M(Ie,{disabled:n.value,class:"claim-btn",loading:ae.value,onClick:ue},{default:z(()=>[U(o(y.value),1)]),_:1},8,["disabled","loading"])])):(c(),g("div",mn,[!ge.value&&X.value&&X.value.length>0?(c(!0),g(Q,{key:0},Ae(X.value,B=>{var ie,me,be,W;return c(),g("div",{key:B.digest,class:"history-item"},[e("div",pn,[fn,e("div",gn,[oe(e("img",hn,null,512),[[$e,(me=(ie=t.order)==null?void 0:ie.target_coin_info)==null?void 0:me.logo_url]]),e("span",null,o(a(P)(B.claimed_amount))+" "+o((W=(be=t.order)==null?void 0:be.target_coin_info)==null?void 0:W.symbol),1)])]),e("div",yn,[bn,e("div",wn,[e("span",null,o(a(Ye)(Number(B.timestampMs),""))+" (UTC)",1),e("a",{target:"_blank",href:a(Zt)(Ue.value,"tx",B.digest)},kn,8,$n)])])])}),128)):!ge.value&&X.value&&X.value.length==0?(c(),j(aa,{key:1,platform:"claim"})):ge.value&&X.value&&X.value.length==0?(c(),g("div",Sn,[M(Be)])):F("",!0)]))])]}),_:1})}}});const Oa=de(On,[["__scopeId","data-v-55e5ca76"]]),xt=t=>(Ce("data-v-0f062fdc"),t=t(),Le(),t),Cn={class:"trade-order-card-list"},Ln={class:"order-info"},Tn=xt(()=>e("div",{class:"label"},"Price",-1)),In={class:"text"},Mn=["onClick"],En=xt(()=>e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap2"})],-1)),Rn=[En],Pn=xt(()=>e("div",{class:"label"},"Filled size",-1)),Nn={class:"text"},An=xt(()=>e("div",{class:"label"},"Expiry",-1)),Hn={class:"text"},Un=xt(()=>e("div",{class:"trade-claim-btn trade-claim-btn-disabled"},"Claim",-1)),Bn=ce({__name:"trade-order-card",props:{pageList:{type:Object,default:()=>({})}},setup(t){const u=p(),l=p(!1),m=Te(),_=w(()=>m),C=w(()=>_.value.cancelOrderId);return(h,d)=>{const n=Xt,y=tt,r=Oa;return c(),g("div",Cn,[(c(!0),g(Q,null,Ae(t.pageList,i=>{var T,I,v,O,b;return c(),g("div",{key:i.id,class:"trade-order-card"},[M($t,{order:i},null,8,["order"]),e("div",Ln,[e("div",null,[Tn,e("div",In,[i.direction?(c(),g(Q,{key:0},[U(o(a(P)(i==null?void 0:i.rate))+" "+o((T=i==null?void 0:i.target_coin_info)==null?void 0:T.symbol)+" per "+o((I=i==null?void 0:i.pay_coin_info)==null?void 0:I.symbol),1)],64)):(c(),g(Q,{key:1},[U(o(a(P)(i==null?void 0:i.reseverRate))+" "+o((v=i==null?void 0:i.pay_coin_info)==null?void 0:v.symbol)+" per "+o((O=i==null?void 0:i.target_coin_info)==null?void 0:O.symbol),1)],64)),e("div",{class:"right",onClick:$=>i.direction=!i.direction},Rn,8,Mn)])]),e("div",null,[Pn,e("div",Nn,[U(o(a(P)(i==null?void 0:i.obtained_amount))+"/"+o(a(P)(i==null?void 0:i.totalBuyNum))+" "+o((b=i==null?void 0:i.target_coin_info)==null?void 0:b.symbol)+" ",1),e("span",null,"("+o(i==null?void 0:i.obtainedRatio)+"%)",1)])]),e("div",null,[An,e("div",Hn,o(a(Ye)(i.created_ts,""))+" (UTC)",1)])]),i.target_balance==0&&i.obtained_amount==0?(c(),j(n,{key:0,"overlay-class-name":"ant-tooltip-text-color"},{title:z(()=>[U(" For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled. ")]),default:z(()=>[Un]),_:1})):(c(),j(y,{key:1,class:"trade-claim-btn",onClick:()=>{u.value=i,l.value=!0}},{default:z(()=>[U("Claim")]),_:2},1032,["onClick"])),M(y,{class:"trade-cancel-btn cancel-btn",loading:C.value=="all"||C.value==i.id,onClick:$=>a(ta)(i)},{default:z(()=>[U("Cancel")]),_:2},1032,["loading","onClick"])])}),128)),l.value?(c(),j(r,{key:0,order:u.value,onCloseModal:d[0]||(d[0]=i=>l.value=!1)},null,8,["order"])):F("",!0)])}}});const Dn=de(Bn,[["__scopeId","data-v-0f062fdc"]]),Fn=ce({props:{currentPageNum:{type:Number,default:null},pageSize:{type:[Number,String],default:""},total:{type:Number,default:null}},setup(t){return{itemRender:(l,m,_)=>(l==null?void 0:l.type)==="prev"?mt("svg",{class:"icon icon-prev","aria-hidden":"true"},[mt("use",{"xlink:href":"#icon-icon_left"})]):(l==null?void 0:l.type)==="next"?mt("svg",{class:"icon icon-next","aria-hidden":"true"},[mt("use",{"xlink:href":"#icon-icon_right"})]):_}}});function jn(t,u,l,m,_,C){const h=qa;return c(),j(h,{current:t.currentPageNum,"page-size":t.pageSize,"item-render":t.itemRender,total:t.total,simple:"",onChange:u[0]||(u[0]=d=>{t.$emit("change",d)})},null,8,["current","page-size","item-render","total"])}const Ca=de(Fn,[["render",jn]]),La=t=>(Ce("data-v-e96066e0"),t=t(),Le(),t),zn={class:"trade-orders"},Wn={key:0},Vn=La(()=>e("thead",null,[e("tr",null,[e("th",null,"Order info"),e("th",null,"Price"),e("th",null,"Filled size"),e("th",null,"Expiry"),e("th",null,"Action")])],-1)),Yn={class:"order-price"},qn=["onClick"],Jn=La(()=>e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap2"})],-1)),Kn=[Jn],Gn={class:"filled-size"},Qn={class:"action"},Xn={key:4,class:"loading-box"},Zn=ce({__name:"trade-orders",setup(t){const u=He(),l=w(()=>u),m=Te(),_=w(()=>m);w(()=>_.value.limitOrderList);const C=wt(),h=w(()=>C);w(()=>h.value.tokensObj),te(()=>l.value.address,y=>{y&&m.getOrderList()},{immediate:!0});const d=w(()=>_.value.orderListLoading),n=(y,r)=>{console.log(y,"page"),ft.value=y};return(y,r)=>{const i=tt,T=Xt,I=bt;return c(),g("div",zn,[l.value&&l.value.address&&a(K)&&a(K).length>0?(c(),g("table",Wn,[Vn,e("tbody",null,[(c(!0),g(Q,null,Ae(a(K),v=>{var O,b,$,E,L;return c(),g("tr",{key:v.id},[e("td",null,[M($t,{order:v},null,8,["order"])]),e("td",null,[e("div",Yn,[v.direction?(c(),g(Q,{key:0},[U(o(a(P)(v==null?void 0:v.rate))+" "+o((O=v==null?void 0:v.target_coin_info)==null?void 0:O.symbol)+" per "+o((b=v==null?void 0:v.pay_coin_info)==null?void 0:b.symbol),1)],64)):(c(),g(Q,{key:1},[U(o(a(P)(v==null?void 0:v.reseverRate))+" "+o(($=v==null?void 0:v.pay_coin_info)==null?void 0:$.symbol)+" per "+o((E=v==null?void 0:v.target_coin_info)==null?void 0:E.symbol),1)],64)),e("div",{class:"right",onClick:()=>{v.direction=!v.direction,a(ps)(v)}},Kn,8,qn)])]),e("td",null,[e("div",Gn,[U(o(a(P)(v==null?void 0:v.obtained_amount))+"/"+o(a(P)(v==null?void 0:v.totalBuyNum))+" "+o((L=v==null?void 0:v.target_coin_info)==null?void 0:L.symbol)+" ",1),e("span",null,"("+o(v==null?void 0:v.obtainedRatio)+"%)",1)])]),e("td",null,o(a(Ye)(v==null?void 0:v.expire_ts,""))+" (UTC)",1),e("td",null,[e("div",Qn,[M(T,{"overlay-class-name":"expiry-tooltip ant-tooltip-text-color"},{title:z(()=>[U(" For a partially filled order, you can manually claim the filled amount if you want. Or you can wait for the auto distribution until your order is fully filled, expired or cancelled. ")]),default:z(()=>[M(i,{class:"trade-claim-btn",disabled:v.target_balance==0&&v.obtained_amount==0,onClick:()=>{ot.value=v,qt.value=!0}},{default:z(()=>[U("Claim")]),_:2},1032,["disabled","onClick"])]),_:2},1024),M(i,{class:"trade-cancel-btn cancel-btn",loading:a(ga)=="all"||a(ga)==v.id,onClick:Y=>a(ta)(v)},{default:z(()=>[U("Cancel")]),_:2},1032,["loading","onClick"])])])])}),128))])])):F("",!0),l.value&&l.value.address&&a(K)&&a(K).length>0?(c(),j(Dn,{key:1,"page-list":a(K)},null,8,["page-list"])):F("",!0),(a(K)&&a(K).length==0||!l.value.address)&&!d.value?(c(),j(aa,{key:2,platform:"orders"})):F("",!0),a(K)&&a(K).length>0?(c(),g("div",{key:3,class:G(["pagination",a(K)&&a(K).length>0&&d.value?"loading-pagination":""])},[M(Ca,{"page-size":a(Rt),total:a(gt)&&a(gt).length,"current-page-num":a(ft),onChange:n},null,8,["page-size","total","current-page-num"])],2)):F("",!0),a(K)&&a(K).length==0&&d.value?(c(),g("div",Xn,[M(I)])):F("",!0),a(K)&&a(K).length>0&&d.value?(c(),j(I,{key:5,class:"order-spin"})):F("",!0),a(qt)?(c(),j(Oa,{key:6,order:a(ot),onCloseModal:r[0]||(r[0]=v=>qt.value=!1)},null,8,["order"])):F("",!0)])}}});const ei=de(Zn,[["__scopeId","data-v-e96066e0"]]),ct=t=>{switch(t){case"Running":return{class:"order-running",path:"#icon-icon_completed"};case"Completed":return{class:"order-running",path:"#icon-icon_completed"};case"Cancelled":return{class:"order-cancelled",path:"#icon-icon_cancelled"};default:return{class:"",path:""}}},Ve=t=>{switch(t){case"OrderPlacedEvent":return{path:"#icon-tx_add1",class:"order-status-create",text:"Create"};case"OrderCanceledEvent":return{path:"#icon-icon_cancelled",class:"order-status-cancel",text:"Cancel"};case"FlashLoanEvent":return{path:"#icon-tx_swap1",class:"order-status-trade",text:"Trade"};default:return{path:"",class:"",text:""}}},dt=Te(),we=p({}),Ta=(t,u)=>{we.value[u]?we.value[u]=!1:(we.value[u]=!0,dt.getLimitOrderLogs()),console.log(we.value,"##isShowPosition.value")},ti=He(),Ia=w(()=>ti),ai=wt(),si=w(()=>ai),Nt=w(()=>si.value.tokensObj),Ma=w(()=>dt),At=w(()=>Ma.value.limitOrderHistoryList),ha=Bt("Sui"),li=Ne("Sui"),ht=p(1),Ht=p(10),J=p([]),yt=p([]),ni=async()=>{const t=Ht.value*ht.value-Ht.value;let u=ht.value*Ht.value;u=u>At.value.length?At.value.length:u;const l=At.value;console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-history.vue:174 ~ updateOrderList ~ result:",l),console.log("trade-card updateOrderList tokenObj",Nt.value);const m=[];if(l.length>0){const _=l.filter((C,h)=>h>=t&&h<u);for(let C=0;C<_.length;C++){const h=_[C];console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-history.vue:188 ~ updateOrderList ~ order:",h,h.order_id);const d=Nt.value[Tt(h.pay_coin,!1)]||await ha.getTokenBySymbol({},Tt(h.pay_coin,!1)),n=Nt.value[Tt(h.target_coin,!1)]||await ha.getTokenBySymbol({},Tt(h.target_coin,!1)),y=pe(li.rateToPrice(h.rate,d.decimals,n.decimals).toString(),d.decimals);console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-history.vue:211 ~ updateOrderList ~ rate:",y);const r=new x(h.total_pay_amount).div(Math.pow(10,d.decimals)).toString(),i=new x(h.remaining_amount).div(Math.pow(10,d.decimals)).toString(),T=new x(r).sub(new x(i)).toString(),I=new x(h.total_pay_amount).mul(new x(Math.pow(10,18))).div(new x(h.rate)).ceil().div(new x(Math.pow(10,n.decimals))).toString();console.log("ðŸš€ðŸš€ðŸš€ ~ file: trade-history.vue:226 ~ updateOrderList ~ order.rate:",h.rate);const v=pe(new x(1).div(new x(y)).toString()),O=h.events.map(b=>{const $=b.event_type.split("::")[2];let E="";return $=="OrderPlacedEvent"?E=new x(b.amount).div(Math.pow(10,d.decimals)).toString():$=="FlashLoanEvent"?E=new x(b.amount).div(Math.pow(10,n.decimals)).toString():$=="OrderCanceledEvent"&&(E=new x(b.amount).div(Math.pow(10,d.decimals)).toString()),{...b,amount:E,type:$}}).sort((b,$)=>$.block_time-b.block_time);m.push({...h,pay_coin_info:d,target_coin_info:n,total_pay_amount:r,rate:y,remaining_amount:i,transaction_ratio:it(new x(h.total_pay_amount).sub(new x(h.remaining_amount)).div(new x(h.total_pay_amount)).mul(100).toString(),2),transaction_volume:T,status:h.cancel_reason==0?"Completed":"Cancelled",events:O,totalBuyNum:I,reseverRate:v,direction:!0})}J.value=m}yt.value=l,dt.setHistoryNum(l.length),console.log("allList",yt.value),console.log("pageList",J.value)},ii=(t,u)=>{console.log(t,"page"),ht.value=t};te(()=>[At.value,ht.value,Nt.value,Ia.value.address],([t,u,l,m])=>{t&&t.length>0&&l&&!Pe(l)&&m?ni():(J.value=[],yt.value=[],dt.setHistoryNum(0))},{immediate:!0});te(()=>Ia.value.address,t=>{t&&(dt.getLimitOrderLogs(),dt.getLimitOrderHistory(t))},{immediate:!0});const Et=w(()=>Ma.value.orderHistoryLoading),Je=t=>(Ce("data-v-c0f555a8"),t=t(),Le(),t),oi={class:"history-card-list"},ri={class:"history-info"},ui=Je(()=>e("div",{class:"label"},"Limit price",-1)),ci={class:"text"},di=["onClick"],vi=Je(()=>e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap2"})],-1)),_i=[vi],mi=Je(()=>e("div",{class:"label"},"Expiry",-1)),pi={class:"text"},fi=Je(()=>e("div",{class:"label"},"Filled size",-1)),gi={class:"text"},hi=Je(()=>e("div",{class:"label"},"Status",-1)),yi={class:"text"},bi=["onClick"],wi=["xlink:href"],$i=Je(()=>e("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),xi=[$i],ki={class:"order-log-num"},Si={class:"order-status"},Oi=["xlink:href"],Ci={class:"create-ts"},Li={key:0},Ti={key:1},Ii={class:"view-trans"},Mi=["href"],Ei=Je(()=>e("span",null,"View Txn.",-1)),Ri=Je(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_link"})],-1)),Pi=[Ei,Ri],Ni=ce({__name:"trade-history-card",props:{pageList:{type:Object,default:()=>[]}},setup(t){const u=vt(),l=w(()=>u),m=w(()=>l.value.currentExplorer),_=Te(),C=w(()=>_);return w(()=>C.value.orderHistoryObj),(h,d)=>(c(),g("div",oi,[(c(!0),g(Q,null,Ae(t.pageList,(n,y)=>{var r,i,T,I,v;return c(),g("div",{key:n.expire_ts,class:"history-card-item"},[M($t,{order:n},null,8,["order"]),e("div",ri,[e("div",null,[ui,e("div",ci,[n.direction?(c(),g(Q,{key:1},[U(o(a(P)(n==null?void 0:n.reseverRate))+" "+o((T=n==null?void 0:n.pay_coin_info)==null?void 0:T.symbol)+" per "+o((I=n==null?void 0:n.target_coin_info)==null?void 0:I.symbol),1)],64)):(c(),g(Q,{key:0},[U(o(a(P)(n==null?void 0:n.rate))+" "+o((r=n==null?void 0:n.target_coin_info)==null?void 0:r.symbol)+" per "+o((i=n==null?void 0:n.pay_coin_info)==null?void 0:i.symbol),1)],64)),e("div",{class:"right",onClick:Qt(O=>n.direction=!n.direction,["stop"])},_i,8,di)])]),e("div",null,[mi,e("div",pi,o(a(Ye)(n==null?void 0:n.expire_ts,""))+" (UTC)",1)]),e("div",null,[fi,e("div",gi,[U(o(a(P)(n==null?void 0:n.transaction_volume))+"/"+o(a(P)(n==null?void 0:n.total_pay_amount))+" "+o((v=n==null?void 0:n.pay_coin_info)==null?void 0:v.symbol)+" ",1),e("span",null,"("+o(n==null?void 0:n.transaction_ratio)+"%)",1)])]),e("div",null,[hi,e("div",yi,[e("div",{class:"order-status",onClick:O=>a(Ta)(n,y)},[(c(),g("svg",{class:G(["order-status-icon",a(ct)(n.status).class]),"aria-hidden":"true"},[e("use",{"xlink:href":a(ct)(n.status).path},null,8,wi)],2)),e("span",{class:G(a(ct)(n.status).class)},o(n.status),3),(c(),g("svg",{class:G(["arrow-icon",a(we)[y]?"open-arrow":""]),"aria-hidden":"true"},xi,2))],8,bi)])])]),a(we)[y]?(c(!0),g(Q,{key:0},Ae(n.events,O=>{var b,$,E;return c(),g("div",{key:O,class:"order-log"},[e("div",ki,[e("div",Si,[e("div",null,[(c(),g("svg",{class:G(["status-icon",a(Ve)(O.type).class]),"aria-hidden":"true"},[e("use",{"xlink:href":a(Ve)(O.type).path},null,8,Oi)],2)),e("span",{class:G(["text-status",a(Ve)(O.type).class])},o(a(Ve)(O.type).text),3)]),e("div",Ci,o(a(Ye)(Number(O.block_time),""))+" (UTC) ",1)]),e("div",null,[O.type=="FlashLoanEvent"?(c(),g("span",Li,"+"+o(a(P)(O.amount))+" "+o((b=n==null?void 0:n.buy_coin_info)==null?void 0:b.symbol)+" "+o(($=n==null?void 0:n.target_coin_info)==null?void 0:$.symbol),1)):(c(),g("span",Ti,o(O.type=="OrderPlacedEvent"?"-":"+")+o(a(P)(O.amount))+" "+o((E=n==null?void 0:n.pay_coin_info)==null?void 0:E.symbol),1)),e("div",Ii,[e("a",{href:a(Zt)(m.value,"tx",O.tx),target:"_blank"},Pi,8,Mi)])])])])}),128)):F("",!0)])}),128))]))}});const Ai=de(Ni,[["__scopeId","data-v-c0f555a8"]]),st=t=>(Ce("data-v-7924f4ec"),t=t(),Le(),t),Hi={class:"trade-history"},Ui={key:0},Bi=st(()=>e("thead",null,[e("tr",null,[e("th",null,"Order info"),e("th",null,"Limit price"),e("th",null,"Expiry"),e("th",null,"Filled size"),e("th",null,"Status")])],-1)),Di=["onClick"],Fi={class:"order-price"},ji=["onClick"],zi=st(()=>e("svg",{class:"icon icon-down","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_swap2"})],-1)),Wi=[zi],Vi={class:"order-status"},Yi=["xlink:href"],qi=st(()=>e("use",{"xlink:href":"#icon-icon_arrow"},null,-1)),Ji=[qi],Ki={class:"order-log"},Gi={class:"order-log-num"},Qi=["xlink:href"],Xi={key:0},Zi={key:1},eo=st(()=>e("td",null,null,-1)),to=st(()=>e("td",null,null,-1)),ao={class:"create-ts"},so={class:"view-trans"},lo=["href"],no=st(()=>e("span",null,"View Transaction",-1)),io=st(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-icon_link"})],-1)),oo=[no,io],ro={style:{height:"4px",background:"unset"}},uo={class:"tr-line",style:{height:"24px",background:"unset"}},co={key:4,class:"loading-box"},vo=ce({__name:"trade-history",setup(t){const u=vt(),l=w(()=>u),m=w(()=>l.value.currentExplorer),_=Te();w(()=>_);const C=He(),h=w(()=>C);return te(()=>h.value.address,d=>{d&&(_.getLimitOrderLogs(),_.getLimitOrderHistory(d))},{immediate:!0}),(d,n)=>{const y=bt;return c(),g("div",Hi,[h.value&&h.value.address&&a(J)&&a(J).length>0?(c(),g("table",Ui,[Bi,e("tbody",null,[(c(!0),g(Q,null,Ae(a(J),(r,i)=>{var T,I,v,O,b;return c(),g(Q,{key:r.id},[e("tr",{class:G(["order",i!==a(J).length-1?"order-border":""]),onClick:$=>a(Ta)(r,i)},[e("td",null,[M($t,{order:r},null,8,["order"])]),e("td",null,[e("div",Fi,[r.direction?(c(),g(Q,{key:1},[U(o(a(P)(r==null?void 0:r.reseverRate))+" "+o((v=r==null?void 0:r.pay_coin_info)==null?void 0:v.symbol)+" per "+o((O=r==null?void 0:r.target_coin_info)==null?void 0:O.symbol),1)],64)):(c(),g(Q,{key:0},[U(o(a(P)(r==null?void 0:r.rate))+" "+o((T=r==null?void 0:r.target_coin_info)==null?void 0:T.symbol)+" per "+o((I=r==null?void 0:r.pay_coin_info)==null?void 0:I.symbol),1)],64)),e("div",{class:"right",onClick:Qt($=>r.direction=!r.direction,["stop"])},Wi,8,ji)])]),e("td",null,o(a(Ye)(r==null?void 0:r.expire_ts,""))+" (UTC)",1),e("td",null,[U(o(a(P)(r==null?void 0:r.transaction_volume))+"/"+o(a(P)(r==null?void 0:r.total_pay_amount))+" "+o((b=r==null?void 0:r.pay_coin_info)==null?void 0:b.symbol)+" ",1),e("span",null,"("+o(r==null?void 0:r.transaction_ratio)+"%)",1)]),e("td",null,[e("div",Vi,[(c(),g("svg",{class:G(["order-status-icon",a(ct)(r.status).class]),"aria-hidden":"true"},[e("use",{"xlink:href":a(ct)(r.status).path},null,8,Yi)],2)),e("span",{class:G(a(ct)(r.status).class)},o(r.status),3),(c(),g("svg",{class:G(["arrow-icon",a(we)[i]?"open-arrow":""]),"aria-hidden":"true"},Ji,2))])])],10,Di),a(we)[i]?(c(),g(Q,{key:0},[(c(!0),g(Q,null,Ae(r.events,$=>{var E,L,Y;return c(),g(Q,{key:$},[oe(e("tr",Ki,[e("td",null,[e("div",Gi,[(c(),g("svg",{class:G(["status-icon",a(Ve)($.type).class]),"aria-hidden":"true"},[e("use",{"xlink:href":a(Ve)($.type).path},null,8,Qi)],2)),e("span",{class:G(["text-status",a(Ve)($.type).class])},o(a(Ve)($.type).text),3),$.type=="FlashLoanEvent"?(c(),g("span",Xi,"+"+o(a(P)($.amount))+" "+o((E=r==null?void 0:r.buy_coin_info)==null?void 0:E.symbol)+" "+o((L=r==null?void 0:r.target_coin_info)==null?void 0:L.symbol),1)):(c(),g("span",Zi,o($.type=="OrderPlacedEvent"?"-":"+")+o(a(P)($.amount))+" "+o((Y=r==null?void 0:r.pay_coin_info)==null?void 0:Y.symbol),1))])]),eo,to,e("td",null,[e("span",ao,o(a(Ye)(Number($.block_time),""))+" (UTC)",1)]),e("td",null,[e("div",so,[e("a",{href:a(Zt)(m.value,"tx",$.tx),target:"_blank"},oo,8,lo)])])],512),[[ut,a(we)[i]]]),oe(e("tr",ro,null,512),[[ut,a(we)[i]]])],64)}),128)),oe(e("tr",uo,null,512),[[ut,a(we)[i]]])],64)):F("",!0)],64)}),128))])])):F("",!0),h.value&&h.value.address&&a(J)&&a(J).length>0?(c(),j(Ai,{key:1,"page-list":a(J)},null,8,["page-list"])):F("",!0),a(J)&&a(J).length==0&&!a(Et)?(c(),j(aa,{key:2,platform:"history"})):F("",!0),a(J)&&a(J).length>0?(c(),g("div",{key:3,class:G(["pagination",a(J)&&a(J).length>0&&a(Et)?"loading-pagination":""])},[M(Ca,{"page-size":a(Ht),total:a(yt)&&a(yt).length,"current-page-num":a(ht),onChange:a(ii)},null,8,["page-size","total","current-page-num","onChange"])],2)):F("",!0),a(J)&&a(J).length==0&&a(Et)?(c(),g("div",co,[M(y)])):F("",!0),a(J)&&a(J).length>0&&a(Et)?(c(),j(y,{key:5,class:"order-spin"})):F("",!0)])}}});const _o=de(vo,[["__scopeId","data-v-7924f4ec"]]),mo={class:"order-or-history"},po={class:"tab-list"},fo=ce({__name:"trade-tab",setup(t){const u=Te(),l=w(()=>u),m=w(()=>l.value.orderNum),_=w(()=>l.value.historyNum),C=He(),h=w(()=>C),d=w(()=>[{value:"orders",label:"Open Orders",numValue:nt.value=="orders"&&h.value&&h.value.address?m:""},{value:"history",label:"Order History",numValue:nt.value=="history"&&h.value&&h.value.address?_:""}]);return(n,y)=>(c(),g("div",mo,[e("div",po,[M(ba,{"tab-list":d.value,"current-tab":a(nt),onClickTab:y[0]||(y[0]=r=>nt.value=r.value)},null,8,["tab-list","current-tab"])]),a(nt)=="orders"&&h.value&&h.value.address&&m.value>0?(c(),g("div",{key:0,class:"clear-all",onClick:y[1]||(y[1]=r=>a(ta)({},!0))},"Cancel All")):F("",!0)]))}});const go=de(fo,[["__scopeId","data-v-ef596d54"]]),ho={class:"trade-order"},yo=ce({__name:"trade-record",setup(t){return(u,l)=>(c(),g("div",ho,[M(go),a(nt)=="orders"?(c(),j(ei,{key:0})):(c(),j(_o,{key:1}))]))}});const Wo=de(yo,[["__scopeId","data-v-270cec3c"]]);export{Ca as N,$t as T,Dn as _,ga as a,ta as b,ot as c,Rt as d,gt as e,ft as f,aa as g,Oa as h,qt as i,J as j,Ai as k,Ht as l,yt as m,ht as n,Et as o,K as p,ii as q,go as r,nt as s,xa as t,Te as u,zo as v,Ia as w,jo as x,Wo as y};
