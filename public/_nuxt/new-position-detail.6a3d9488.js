import{_ as No}from"./new-position-title.f71b43c4.js";import{_ as ao}from"./token-warning.45227ae9.js";import{_ as Ro}from"./status-block.839e878f.js";import{j as zo,n as Yo,d as pe,e as oo,u as no,a as Q,g as fo,c as he,s as Ue,q as Pe,b as Oe,p as Io,I as Oo,J as qo,T as Co,C as Jo}from"./pool.6ba7e8d0.js";import{s as xe,m as Qo,l as Zo,b as Ko,a as Vo}from"./transform.c672907f.js";import{D as h}from"./decimal.0bdeb344.js";import{u as Je,a as so}from"./sha256.dd756687.js";import{a as Qe,r as B,l as _,H as Bo,q as _e,e as Ze,o as $,f as M,t as qe,N as Lo,h as a,p as wo,k as _o,m as lo,s as Mo,i as de,u as J,v as E,j as Ae,x as fe,y as Ao,a4 as xo,b as ro,C as Xe,a8 as So,O as $o,w as Ye,F as po,E as ho,B as uo,A as go,c as je,D as en,G as on,z as nn,a1 as tn,S as an}from"./entry.0f97a10d.js";import{i as eo}from"./import-icon.de3e6c66.js";import{_ as co}from"./assets-card.7ac8cb42.js";import{_ as sn}from"./coin-lock.7e1348b9.js";import{a as ln}from"./new-add-or-create.445d74b1.js";import{_ as rn,a as un}from"./icon-Add-Liquidity_2x.0acb06cb.js";/* empty css              *//* empty css              */import{u as Uo}from"./notifi.ec62f567.js";import{_ as jo}from"./farms-position-detail.f5228273.js";/* empty css              *//* empty css              */import{u as dn}from"./farms.d42553d4.js";import"./back.eb5089dc.js";import"./swap-setting.95ff9090.js";/* empty css              */import"./icon-error_2x.e4ea024a.js";/* empty css              */import"./img-lock_2x.a28135f4.js";import"./img-lock_2x.e5b460f4.js";import"./useWhale.cf36ea29.js";const bo=Math.PI,ko=2*bo,ze=1e-6,cn=ko-ze;function Eo(e){this._+=e[0];for(let n=1,i=e.length;n<i;++n)this._+=arguments[n]+e[n]}function vn(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Eo;const i=10**n;return function(s){this._+=s[0];for(let R=1,C=s.length;R<C;++R)this._+=Math.round(arguments[R]*i)/i+s[R]}}class mn{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?Eo:vn(n)}moveTo(n,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,i){this._append`L${this._x1=+n},${this._y1=+i}`}quadraticCurveTo(n,i,s,R){this._append`Q${+n},${+i},${this._x1=+s},${this._y1=+R}`}bezierCurveTo(n,i,s,R,C,O){this._append`C${+n},${+i},${+s},${+R},${this._x1=+C},${this._y1=+O}`}arcTo(n,i,s,R,C){if(n=+n,i=+i,s=+s,R=+R,C=+C,C<0)throw new Error(`negative radius: ${C}`);let O=this._x1,v=this._y1,o=s-n,c=R-i,p=O-n,d=v-i,k=p*p+d*d;if(this._x1===null)this._append`M${this._x1=n},${this._y1=i}`;else if(k>ze)if(!(Math.abs(d*o-c*p)>ze)||!C)this._append`L${this._x1=n},${this._y1=i}`;else{let W=s-O,ne=R-v,ee=o*o+c*c,ve=W*W+ne*ne,r=Math.sqrt(ee),f=Math.sqrt(k),L=C*Math.tan((bo-Math.acos((ee+k-ve)/(2*r*f)))/2),t=L/f,g=L/r;Math.abs(t-1)>ze&&this._append`L${n+t*p},${i+t*d}`,this._append`A${C},${C},0,0,${+(d*W>p*ne)},${this._x1=n+g*o},${this._y1=i+g*c}`}}arc(n,i,s,R,C,O){if(n=+n,i=+i,s=+s,O=!!O,s<0)throw new Error(`negative radius: ${s}`);let v=s*Math.cos(R),o=s*Math.sin(R),c=n+v,p=i+o,d=1^O,k=O?R-C:C-R;this._x1===null?this._append`M${c},${p}`:(Math.abs(this._x1-c)>ze||Math.abs(this._y1-p)>ze)&&this._append`L${c},${p}`,s&&(k<0&&(k=k%ko+ko),k>cn?this._append`A${s},${s},0,1,${d},${n-v},${i-o}A${s},${s},0,1,${d},${this._x1=c},${this._y1=p}`:k>ze&&this._append`A${s},${s},0,${+(k>=bo)},${d},${this._x1=n+s*Math.cos(C)},${this._y1=i+s*Math.sin(C)}`)}rect(n,i,s,R){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}h${s=+s}v${+R}h${-s}Z`}toString(){return this._}}function Ke(e){return function(){return e}}function fn(e){let n=3;return e.digits=function(i){if(!arguments.length)return n;if(i==null)n=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);n=s}return e},()=>new mn(n)}function pn(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Do(e){this._context=e}Do.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function hn(e){return new Do(e)}function gn(e){return e[0]}function bn(e){return e[1]}function kn(e,n){var i=Ke(!0),s=null,R=hn,C=null,O=fn(v);e=typeof e=="function"?e:e===void 0?gn:Ke(e),n=typeof n=="function"?n:n===void 0?bn:Ke(n);function v(o){var c,p=(o=pn(o)).length,d,k=!1,W;for(s==null&&(C=R(W=O())),c=0;c<=p;++c)!(c<p&&i(d=o[c],c,o))===k&&((k=!k)?C.lineStart():C.lineEnd()),k&&C.point(+e(d,c,o),+n(d,c,o));if(W)return C=null,W+""||null}return v.x=function(o){return arguments.length?(e=typeof o=="function"?o:Ke(+o),v):e},v.y=function(o){return arguments.length?(n=typeof o=="function"?o:Ke(+o),v):n},v.defined=function(o){return arguments.length?(i=typeof o=="function"?o:Ke(!!o),v):i},v.curve=function(o){return arguments.length?(R=o,s!=null&&(C=R(s)),v):R},v.context=function(o){return arguments.length?(o==null?s=C=null:C=R(s=o),v):s},v}function To(){}function Fo(e){this._context=e}Fo.prototype={areaStart:To,areaEnd:To,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function yn(e){return new Fo(e)}function Po(e,n,i){const s=new h(10).pow(n-i);return new h(1.0001).pow(e).mul(s)}const wn=Qe({props:{poolInfo:{type:Object,default:()=>({chartLoading:!1,token_a:{decimal:6},token_b:{decimal:6},currentLiquity:"50000000"})},minPrice:{type:String,default:""},maxPrice:{type:String,default:""},direction:{type:Boolean,default:!0},tickList:{type:Array,default:()=>[]},currentTick:{type:Number,default:0},chartLoading:{type:Boolean,default:!1},currentPriceTab:{type:String,default:""},before7dContractPriceLowest:{type:String,default:""},before7dContractPriceHighest:{type:String,default:""}},setup(e,n){const i=B(1),s=B(""),R=B(""),C=_(()=>{var t,g,A;return d.sqrtPriceX64ToPrice((t=e.poolInfo)==null?void 0:t.current_sqrt_price,(g=e.poolInfo)==null?void 0:g.coinA.decimals,(A=e.poolInfo)==null?void 0:A.coinB.decimals).toString()}),O=_(()=>{let t=0;return e.direction?t=(Number(e.minPrice)/Number(C.value)-1)*100:t=(Number(e.minPrice)/Number(1/Number(C.value))-1)*100,t=t>0&&t<.1?.1:t,t=t<0&&t>-.1?-.1:t,t}),v=_(()=>{let t=0;return e.direction?t=(Number(e.maxPrice)/Number(C.value)-1)*100:t=(Number(e.maxPrice)/Number(1/Number(C.value))-1)*100,t=t>0&&t<.1?.1:t,t=t<0&&t>-.1?-.1:t,t}),o=Je(),c=_(()=>o),p=_(()=>c.value.chainName?oo(c.value.chainName):{}),{TickMath:d,getNearestTickByTick:k}=p.value,W=()=>{const t=i.value/2;i.value=t,ve(e.poolInfo,t)},ne=()=>{const t=i.value*2;i.value=t,ve(e.poolInfo,t)},ee=(t=[])=>{let g=6;const A=Math.abs(Number(t[0])-Number(t[t.length-1]));return A>=6?g=0:A>=1?g=1:A>=.1?g=2:A>=.01?g=3:A>=.001?g=4:A>=1e-4?g=5:A>=1e-5?g=6:A>=1e-6?g=7:A>=1e-7&&(g=8),g},ve=(t,g=1)=>{if(t&&t.token_a&&!e.chartLoading&&e.minPrice&&e.maxPrice){console.log(e.poolInfo,"==>props.poolInfo");const A=Number(e.poolInfo.current_tick_index);console.log("0117###dataProcessing###currentTick###",A),console.log("0117###dataProcessing###props.poolInfo###",e.poolInfo),console.log("0117###dataProcessing###minPrice###",e.minPrice),console.log("0117###dataProcessing###maxPrice###",e.maxPrice),console.log("0117###dataProcessing###poolInfo###",e.poolInfo);let y=A+100*g,l=A-100*g,K,z;if(e.maxPrice==="∞")z=p.value.TickUtil.getMaxIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?z=d.priceToTickIndex(new h(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):z=d.priceToTickIndex(new h(1).div(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{z=443636}if(e.minPrice==="0")K=p.value.TickUtil.getMinIndex(Number(e.poolInfo.tickSpacing));else try{e.direction?K=d.priceToTickIndex(new h(e.minPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):K=d.priceToTickIndex(new h(1).div(e.maxPrice),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)}catch{K=-443636}let re=0;if(e.currentPriceTab!=="full range"){if(A>=K&&A<=z){const U=A-K,me=z-A;re=Math.max(Math.abs(U),Math.abs(me))}else A<K?re=Math.abs(z-A):re=Math.abs(A-K);y=A+re+100*g,l=A-re-100*g,console.log(g,A,"===>zooms")}else{const U=(Math.abs(A)>5e3,2e4);y=A+U*g,l=A-U*g}l<-443636&&(l=-443636),y>443636&&(y=443636),console.log(l,y,"===>201");const x=new h(t.liquidity).div(Math.pow(10,8)).toString();console.log(x,"==>currentLiquity");const q=e.tickList;console.log("0117####drawChart####tick_info_array####",q);const H=[],Y=[];let oe={};for(let U=0;U<q.length;U++){if(oe=q[U],oe.index<=A&&oe.index>=l){if(H.length<1&&U!==0){const me=q[U-1];H.unshift({...me,index:l})}H.unshift(oe)}else if(oe.index>A&&oe.index<=y&&(Y.push(oe),H.length<1&&U!==0)){const me=q[U-1];H.push({...me,index:l})}if(oe.index>y){const me=q[U];if(Y.push({...me,index:y}),H.length<1&&U!==0){const ye=q[U-1];H.push({...ye,index:l})}break}}console.log(A,l,y,"===>currentTick");let le="0";for(let U=H.length-1;U>=0;U--)le=new h(le).plus(new h(H[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),H[U].liquityAmount=le;let V=x;for(let U=0;U<Y.length;U++)V=new h(V).plus(new h(Y[U].liquidityNet.toString()).div(Math.pow(10,8))).toString(),Y[U].liquityAmount=V;console.log(H.length,Y.length,"leftArray");let ie=[];const Z=q&&q.length>0?{index:A,liquityAmount:Number(x)}:{index:A,liquityAmount:0};(H.length>0||Y.length>0)&&(console.log([Z,...Y],"279===>"),ie=[...H.reverse(),Z,...Y],e.direction||(ie=ie.reverse()));const ge=[];q.forEach(U=>{ge.push({...U,liquidityGross:U.liquidityGross.toString(),liquidityNet:U.liquidityNet.toString()})}),console.log("0117####drawChart####testTickInfoArray####",ge),console.log("0117####drawChart####currentLiquity####",x),console.log(ie,"===>chartData"),f(ie,l,y,K,z,A)}};let r=B(!1);Bo(()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,window.onresize=()=>{document.body.clientWidth<750?r.value=!1:r.value=!0,ve(e.poolInfo,i.value)}});const f=(t,g,A,y,l,K)=>{console.log("0117####drawChart####chartData####",t),console.log("0117####drawChart####tickMin####",g),console.log("0117####drawChart####tickMax####",A),console.log("0117####drawChart####minPriceTick####",y),console.log("0117####drawChart####maxPriceTick####",l),console.log("0117####drawChart####currentTick####",K),console.log("0117####drawChart####props.direction####",e.direction),console.log("0518###newd3###props.before7dContractPriceLowest###",e.before7dContractPriceLowest),console.log("0518###newd3###props.before7dContractPriceHighest###",e.before7dContractPriceHighest);let z,re;e.direction?(z=e.before7dContractPriceLowest?d.priceToTickIndex(new h(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?d.priceToTickIndex(new h(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):""):(z=e.before7dContractPriceLowest?d.priceToTickIndex(new h(1).div(e.before7dContractPriceLowest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"",re=e.before7dContractPriceHighest?d.priceToTickIndex(new h(1).div(e.before7dContractPriceHighest),e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals):"");const x={top:30,right:35,bottom:20,left:55};let q,H;r.value,q=340-x.left-x.right,H=205-x.top-x.bottom;const Y=A-g,oe=parseInt(String(Y/4));let le=[g+oe/4,g+oe,g+2*oe,A-oe,A-oe/4];const V=g,ie=A,Z=q/(ie-V);e.currentPriceTab==="full range"&&(le=[g,g+2*oe,A]),console.log("0117####drawChart####xArr####",le),console.log("0117####drawChart####utickMin####",V),console.log("0117####drawChart####utickMax####",ie),console.log("0117####drawChart####unit####",Z);const ge=le.map(T=>e.direction?Po(T,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString():new h(1).div(Po(T,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals)).toString());ee(ge),xe("#chart").selectAll("*").remove();const U=xe("#chart").attr("width",q+x.left+x.right).attr("height",H+x.top+x.bottom).append("g").attr("transform",`translate(${x.left},${x.right})`),me=Qo(t,function(T){return Number(Math.abs(T.liquityAmount))})||0,ye=Zo().range([0,H]).domain([me,0]);Ko().rangeRound([0,q]).padding(.1);const u=U.append("g").attr("id","barsBox").selectAll("rect").data(t).enter().append("rect");c.value.theme=="default"?u.attr("x",function(T,N){return N===0?0:e.direction?Math.abs(T.index-V)*Z:Math.abs(ie-T.index)*Z}).attr("y",function(T,N){return e.direction?N===t.length-1?0:ye(T.liquityAmount):N===t.length-1?0:ye(t[N+1].liquityAmount)}).attr("width",function(T,N){return N===0&&t.length===1&&T.liquityAmount>0?q:(e.direction,N!==t.length-1?Math.abs(t[N+1].index-T.index)*Z:0)}).attr("height",function(T,N){return N===0&&t.length===1&&T.liquityAmount>0?H:e.direction?N===t.length-1?0:H-ye(T.liquityAmount):N===t.length-1?0:H-ye(t[N+1].liquityAmount)}).attr("fill","#279477").attr("class","bars").attr("stroke-width",1).attr("stroke","#279477"):u.attr("x",function(T,N){return N===0?0:e.direction?Math.abs(T.index-V)*Z:Math.abs(ie-T.index)*Z}).attr("y",function(T,N){return e.direction?N===t.length-1?0:ye(Math.abs(T.liquityAmount)):N===t.length-1?0:ye(Math.abs(t[N+1].liquityAmount))}).attr("width",function(T,N){return N===0&&t.length===1&&T.liquityAmount>0?q:(e.direction,N!==t.length-1?Math.abs(t[N+1].index-T.index)*Z:0)}).attr("height",function(T,N){if(N===0&&t.length===1&&T.liquityAmount>0)return H;if(e.direction)return N===t.length-1?0:Number(T.liquityAmount)?H-ye(Math.abs(T.liquityAmount)):0;{if(N===t.length-1)return 0;const se=H-ye(Math.abs(t[N+1].liquityAmount));return Number(t[N+1].liquityAmount)?se:0}}).attr("fill","#407497").attr("class","bars").attr("stroke-width",1).attr("stroke","#407497");const m=U.append("g");m.append("line").attr("x1",0).attr("y1",155).attr("x2",q).attr("y2",155).attr("stroke-width",1).attr("stroke","#50535D"),m.append("g");let I=0;e.direction?I=Math.abs(K-V)*Z:I=Math.abs(K-ie)*Z,console.log(c.value.theme=="default","leftHandle#"),(c.value.theme=="default"?U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#68FFD8"):U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",2).attr("stroke","#76C8FF")).attr("transform","translate("+I+", 0)"),xe("#triangle").attr("width",8).attr("height",4);let j=[[0,0],[4,4],[8,0]],D=kn().x(function(T){return T[0]}).y(function(T){return T[1]}).curve(yn);const P=I-4;U.append("path").attr("d",D(j)).style("fill",c.value.theme=="default"?"#68FFD8":"#76C8FF").attr("transform","translate("+P+", 0)");let F,X,ae,ue;e.direction?(console.log("0525###d3###select###minPriceTick###",y),console.log("0525###d3###select###maxPriceTick###",l),console.log("0525###d3###select###props.minPrice###",e.minPrice),console.log("0525###d3###select###props.maxPrice###",e.maxPrice),F=y<V?-100:parseInt(String(Math.abs(y-V)*Z)),X=l<V?-100:parseInt(String(Math.abs(l-V)*Z)),ae=z<V?-100:Math.abs(z-V)*Z,ue=re<V?-100:Math.abs(re-V)*Z):(X=y<V?-100:Math.abs(ie-y)*Z,F=l<V?-100:Math.abs(ie-l)*Z,ue=z<V?-100:Math.abs(ie-z)*Z,ae=re<V?-100:Math.abs(ie-re)*Z),e.minPrice==="0"&&(F=0),e.maxPrice==="∞"&&(X=q),r.value?s.value=q-F+60+"px":s.value=q-F+52+"px",R.value=X+74+"px",console.log(F,X,"##minPriceTickX"),z&&ae<q&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ae+", 0)"),re&&ue<q&&U.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",155).attr("stroke-width",1).attr("stroke-dasharray","5, 5").attr("stroke","rgba(255, 255, 255, 0.5)").attr("transform","translate("+ue+", 0)");const be=Vo().extent([[0,0],[q,H]]).handleSize(30).on("end",we);U.append("g").attr("class","brush").call(be).call(be.move,[F,X]);function we(T){if(!T.sourceEvent||!T.selection)return;r.value?s.value=q-T.selection[0]+60+"px":s.value=q-T.selection[0]+52+"px",R.value=T.selection[1]+74+"px";let N,se;console.log("0525###d3###select###e.selection[0]###",T.selection[0]),console.log("0525###d3###select###e.selection[0]###",T.selection[1]),console.log("0525###d3###select###props.direction###",e.direction),console.log("0525###d3###select###width###",q),console.log("0525###d3###select###unit###",Z),console.log("0525###d3###select###utickMin###",V),console.log("0525###d3###select###utickMax###",ie),console.log("0525###d3###select###props.poolInfo###",e.poolInfo);let ke=0,b=0;e.direction?(ke=k(parseInt(String(T.selection[0]/Z+V)),Number(e.poolInfo.tickSpacing)),N=d.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),b=k(parseInt(String(T.selection[1]/Z+V)),Number(e.poolInfo.tickSpacing)),se=d.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),console.log("0525###d3###select###minTick###",ke),console.log("0525###d3###select###maxTick###",b),console.log("0525###d3###select###minPrice###",N),console.log("0525###d3###select###maxPrice###",se)):(b=k(ie-T.selection[0]/Z,Number(e.poolInfo.tickSpacing)),N=1/d.tickIndexToPrice(b,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString(),ke=k(ie-T.selection[1]/Z,Number(e.poolInfo.tickSpacing)),se=1/d.tickIndexToPrice(ke,e.poolInfo.token_a.decimals,e.poolInfo.token_b.decimals).toString()),n.emit("onChangeMinPrice",String(pe(String(N),6))),n.emit("onChangeMaxPrice",String(pe(String(se),6)))}c.value.theme=="default"?xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","#15322C"):xe(".selection").attr("stroke","rgba(255, 255, 255, 0)").attr("fill","rgba(255,255,255,0.7)")};B(""),_e(()=>[e.poolInfo,e.minPrice,e.maxPrice,e.currentPriceTab,e.tickList],([t,g,A,y])=>{console.log(t,g,A,A>g,"poolInfo && minPrice && maxPrice && (maxPrice > minPrice)"),t&&g&&A&&ve(t,i.value)},{immediate:!0});const L=B(!0);return _e(()=>e.chartLoading,(t,g)=>{t!==g&&(L.value=t)},{immediate:!0,deep:!0}),{store:c,loading:L,zoomOut:W,zoomIn:ne,rangeSizeLower:O,rangeSizeUpper:v,rangeSizeLowerPosition:s,rangeSizeUpperPosition:R,decimalFormat:zo,numberformat:Yo}}});const _n=e=>(wo("data-v-59ae7c8b"),e=e(),_o(),e),An={class:"chart-box"},In={class:"chart"},Cn=_n(()=>a("svg",{id:"chart"},null,-1)),Sn=[Cn];function $n(e,n,i,s,R,C){return $(),M("div",An,[qe(a("div",In,Sn,512),[[Lo,!e.loading]])])}const Wo=Ze(wn,[["render",$n],["__scopeId","data-v-59ae7c8b"]]),Tn=Qe({components:{StatusBlock:Ro,NewPositionChart:Wo,TokenWarning:ao},setup(e){const n=B(),i=B(),s=_(()=>{var t,g;return(g=(t=d.value)==null?void 0:t.poolInfo)==null?void 0:g.needReverse}),R=Je(),C=_(()=>R),O=_(()=>C.value.currentExplorer),v=_(()=>C.value.theme),o=_(()=>C.value.chainName),c=no(),p=_(()=>c),d=B({}),k=lo();_e(()=>[p.value.currentPositionInfo,o.value],([t,g])=>{var A;g=="Aptos"&&t?(d.value=t,n.value=d.value.token_a,i.value=d.value.token_b):g=="Sui"&&t&&(t==null?void 0:t.nftHash)==((A=k==null?void 0:k.query)==null?void 0:A.pos)&&(console.log(t,"==>newVal"),d.value=t,n.value=d.value.token_a,i.value=d.value.token_b,console.log(n.value,i.value,"###fromCoin.value"))},{immediate:!0});const W=t=>{var g;return(t==null?void 0:t.logoURI)||(t==null?void 0:t.logo_url)||((g=p.value.tokensObj[t==null?void 0:t.address])==null?void 0:g.logo_url)||(v.value==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},ne=_(()=>o.value?oo(o.value):{}),ee=B([]),ve=async t=>{console.log(t,"===>positionInfo.value.poolInfo");const g=await ne.value.getTicks(t),A=g?ne.value.getTickDataFromUrlData(g):[];console.log(A,"list===>"),ee.value=A};_e(()=>[d.value,p.value.poolsObj],([t,g])=>{console.log(t,!he(t),"177111"),t&&!he(t)&&t.poolInfo&&g&&!he(g)&&(console.log(t,g,"==>poolConfigObj"),ve(g[t.poolAddress]))},{immediate:!0});const r=B(!0);console.log(d.value,"188---------->");const f=(t,g)=>t!=="0"&&g!=="∞"?Ue(1/(1-Number((t/g)**.25)),2)+"x":"1x",L=_(()=>d.value.minPrice&&d.value.maxPrice?f(d.value.minPrice,d.value.maxPrice):"--");return{needReverse:s,getCoinIcon:W,theme:v,indexStore:R,direct:r,addCommom:Q,decimalUi:pe,tickList:ee,positionInfo:d,fromCoin:n,toCoin:i,getExplorerUrl:fo,lever:L,currentExplorer:O}}}),Pn=""+globalThis.__publicAssetsURL("image/aptos-price.png"),Nn=""+globalThis.__publicAssetsURL("sui-image/sui-price.png"),Rn=""+globalThis.__publicAssetsURL("image/icon-arrow@2x.png"),On=""+globalThis.__publicAssetsURL("sui-image/icon-arrow@2x.png");const Fe=e=>(wo("data-v-742e1150"),e=e(),_o(),e),qn={class:"new-position-info"},Bn={class:"pool-info"},Ln={class:"left"},Mn={class:"coin-a"},Un={alt:""},jn={class:"coin-b"},En={alt:""},Dn={class:"position-name"},Fn=["href"],Wn=Fe(()=>a("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),Hn=[Wn],Xn={key:0,class:"pool-fee"},Gn=Fe(()=>a("span",null,"Fee tier",-1)),zn={class:"right"},Yn={class:"h5-pool-info"},Jn={class:"coin-info"},Qn={class:"coin-a"},Zn={alt:""},Kn={class:"coin-b"},Vn={alt:""},xn={class:"position-name"},et=["href"],ot=Fe(()=>a("use",{"xlink:href":"#icon-icon-copy1"},null,-1)),nt=[ot],tt={key:0,class:"pool-fee"},it={class:"price-info"},at={class:"price-and-chart"},st={class:"left"},lt={class:"current-price"},rt=Fe(()=>a("span",null,"Current Price",-1)),ut={class:"coin-rate"},dt=Fe(()=>a("div",null,[a("svg",{class:"icon icon-up","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_up1"})])],-1)),ct=Fe(()=>a("div",null,[a("svg",{class:"icon icon-down","aria-hidden":"true"},[a("use",{"xlink:href":"#icon-exchange_down1"})])],-1)),vt=[dt,ct],mt={key:0},ft={key:1},pt={key:0,class:"position-range"},ht=Fe(()=>a("div",{class:"position-range-title"}," Position Range ",-1)),gt={key:0},bt={key:1},kt={key:2,src:Pn,alt:""},yt={key:3,src:Nn,alt:""},wt={key:4},_t={key:5},At={key:1,class:"position-range position-range-warp"},It={key:0,class:"position-range-title"},Ct={key:1,class:"position-range-title"},St={key:2},$t={key:3},Tt={class:"price-img"},Pt={key:0,src:Rn,alt:""},Nt={key:1,src:On,alt:""},Rt={key:4},Ot={key:5},qt={class:"lever"},Bt=Fe(()=>a("div",{class:"lever-title"},"Leverage",-1)),Lt={class:"lever-text"},Mt={class:"right"},Ut=Fe(()=>a("div",{class:"chat-mask"},null,-1));function jt(e,n,i,s,R,C){var p,d,k,W,ne,ee,ve,r,f,L,t,g,A,y,l,K,z,re,x,q,H,Y,oe,le,V,ie,Z,ge,U,me;const O=ao,v=Ro,o=Wo,c=Mo("image");return $(),M("div",qn,[a("div",Bn,[a("div",Ln,[a("div",Mn,[qe(a("img",Un,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(O,{address:e.needReverse?(W=(k=e.positionInfo)==null?void 0:k.token_b)==null?void 0:W.address:(d=(p=e.positionInfo)==null?void 0:p.token_a)==null?void 0:d.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",jn,[qe(a("img",En,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(O,{address:e.needReverse?(r=(ve=e.positionInfo)==null?void 0:ve.token_a)==null?void 0:r.address:(ee=(ne=e.positionInfo)==null?void 0:ne.token_b)==null?void 0:ee.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",Dn,[a("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(fo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},E((L=(f=e.positionInfo)==null?void 0:f.name)==null?void 0:L.split("|")[1]),9,Fn)]),($(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[0]||(n[0]=ye=>e.indexStore.copy(e.positionInfo.nftHash))},Hn)),e.positionInfo.fee?($(),M("div",Xn,[Gn,Ae(" "+E(e.positionInfo.fee*100)+"% ",1)])):fe("",!0)]),a("div",zn,[de(v,{"current-status":(t=e.positionInfo)==null?void 0:t.currentStatus},null,8,["current-status"])])]),a("div",Yn,[a("div",null,[a("div",Jn,[a("div",Qn,[qe(a("img",Zn,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_b):e.getCoinIcon(e.positionInfo.token_a)]]),de(O,{address:e.needReverse?(l=(y=e.positionInfo)==null?void 0:y.token_b)==null?void 0:l.address:(A=(g=e.positionInfo)==null?void 0:g.token_a)==null?void 0:A.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])]),a("div",Kn,[qe(a("img",Vn,null,512),[[c,e.needReverse?e.getCoinIcon(e.positionInfo.token_a):e.getCoinIcon(e.positionInfo.token_b)]]),de(O,{address:e.needReverse?(x=(re=e.positionInfo)==null?void 0:re.token_a)==null?void 0:x.address:(z=(K=e.positionInfo)==null?void 0:K.token_b)==null?void 0:z.address,"style-params":{width:"12px",height:"12px",left:"18px",bottom:"4px"}},null,8,["address"])])]),a("div",xn,[a("div",null,[a("a",{href:("getExplorerUrl"in e?e.getExplorerUrl:J(fo))(e.currentExplorer,"nftAddress",e.positionInfo.nftHash),target:"_blank"},E((H=(q=e.positionInfo)==null?void 0:q.name)==null?void 0:H.split("|")[1]),9,et),($(),M("svg",{class:"copy-icon","aria-hidden":"true",onClick:n[1]||(n[1]=ye=>e.indexStore.copy(e.positionInfo.nftHash))},nt))]),e.positionInfo.fee?($(),M("div",tt,E(e.positionInfo.fee*100)+"%",1)):fe("",!0)])]),de(v,{"current-status":(Y=e.positionInfo)==null?void 0:Y.currentStatus},null,8,["current-status"])]),a("div",it,[a("div",at,[a("div",st,[a("div",lt,[a("div",null,[rt,a("div",ut,[a("div",{onClick:n[2]||(n[2]=ye=>e.direct=!e.direct)},vt)])]),(e.needReverse?!e.direct:e.direct)?($(),M("div",mt,[Ae(E(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.currentPrice,6)))+"   ",1),a("span",null,E((oe=e.toCoin)==null?void 0:oe.symbol)+" per "+E((le=e.fromCoin)==null?void 0:le.symbol),1)])):($(),M("div",ft,[Ae(E(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.currentPriceReverse,6)))+"   ",1),a("span",null,E((V=e.fromCoin)==null?void 0:V.symbol)+" per "+E((ie=e.toCoin)==null?void 0:ie.symbol),1)]))]),e.positionInfo.minPrice&&e.positionInfo.minPrice.length<9&&e.positionInfo.maxPrice&&e.positionInfo.maxPrice.length?($(),M("div",pt,[ht,a("div",null,[(e.needReverse?!e.direct:e.direct)?($(),M("div",gt,[Ae(E(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.minPrice,6)))+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",bt,[Ae(E(((Z=e.positionInfo)==null?void 0:Z.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),e.theme=="default"?($(),M("img",kt)):($(),M("img",yt)),(e.needReverse?!e.direct:e.direct)?($(),M("div",wt,[Ae(E(((ge=e.positionInfo)==null?void 0:ge.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",_t,[Ae(E(((U=e.positionInfo)==null?void 0:U.maxPrice)!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)]))])])):($(),M("div",At,[(e.needReverse?!e.direct:e.direct)?($(),M("span",It," Position Range ")):($(),M("span",Ct," Position Range ")),(e.needReverse?!e.direct:e.direct)?($(),M("div",St,[Ae(E(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.minPrice,6)))+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",$t,[Ae(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1)])),a("div",Tt,[e.theme=="default"?($(),M("img",Pt)):($(),M("img",Nt))]),(e.needReverse?!e.direct:e.direct)?($(),M("div",Rt,[Ae(E(e.positionInfo.maxPrice!=="∞"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.positionInfo.maxPrice,6)):"∞")+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_b&&e.positionInfo.token_b.symbol),1)])):($(),M("div",Ot,[Ae(E(((me=e.positionInfo)==null?void 0:me.minPrice)!=="0"?("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(1/e.positionInfo.minPrice,6)):0)+" ",1),a("span",null,E(e.positionInfo&&e.positionInfo.token_a&&e.positionInfo.token_a.symbol),1),Ae("   ")]))])),a("div",qt,[Bt,a("div",Lt,E(e.lever),1)])]),a("div",Mt,[de(o,{"pool-info":e.positionInfo.poolInfo,"tick-list":e.tickList,"min-price":e.needReverse&&e.positionInfo.maxPrice!=="∞"?1/e.positionInfo.maxPrice:e.positionInfo.minPrice,"max-price":e.needReverse&&e.positionInfo.minPrice!=0?1/e.positionInfo.minPrice:e.positionInfo.maxPrice,direction:!e.needReverse,"current-price-tab":"custom","chart-loading":!1},null,8,["pool-info","tick-list","min-price","max-price","direction"]),Ut])])])])}const Ho=Ze(Tn,[["render",jt],["__scopeId","data-v-742e1150"]]),Et=Qe({components:{TokenWarning:ao},setup(e,n){const{t:i}=Ao(),{$notify:s}=xo(),R=Je(),C=_(()=>R),O=no(),v=_(()=>O),o=B({}),c=B({}),p=B({}),d=_(()=>C.value.chainName),k=_(()=>d.value?oo(d.value):{}),W=lo(),ne=B(!1),ee=async(u=null)=>{const m=u||o.value;console.log(m,"===>posInfo");const I=v.value.addressLpTokens[m.poolAddress];if(I){const w=await k.value.getTickDataByIndex(I.ticks_handle,Number(m.tick_lower_index)),j=await k.value.getTickDataByIndex(I.ticks_handle,Number(m.tick_upper_index));let D={};d.value==="Aptos"?D=await k.value.getPosRewardersAmount({poolAddress:A.currentRoute.value.query.address,positionName:A.currentRoute.value.query.token,tickLowerData:w,tickUpperData:j}):D=await k.value.fetchPosRewardersAmount({poolAddress:m.poolAddress,positionId:m.pos_object_id||m.clmm_position_id,coinTypeA:m.coin_type_a||m.coinTypeA,coinTypeB:m.coin_type_b||m.coinTypeB,rewarderInfo:m.poolInfo.rewarder_infos});const P=[];let F=new h(0);D.forEach((X,ae)=>{var T,N;const ue=(T=v.value.tokensObj[X.coin_address])==null?void 0:T.decimals,be=X.amount_owed.toString();let we=new h(be).div(Math.pow(10,ue)).toString();if(d.value=="Aptos"&&Number(we)>999999999&&(we="0"),m.poolInfo[`rewarder_display${ae+1}`]||Number(we)>0){const se=v.value.tokensObj[X.coin_address],ke=((N=v.value.RATES[X.coin_address])==null?void 0:N.price)||0,b=new h(we).mul(ke).toString();F=new h(F).plus(b),P.push({...X,...se,amount:Number(we)>0?Pe(we,ue):0,amountUSD:Number(b)>0?Pe(b,2):0,amountUSDText:b})}}),y.value=P,console.log(P,"====>result722")}};_e(()=>[v.value.currentPositionInfo,d.value],([u,m])=>{var I;m=="Aptos"&&u?(o.value=u,c.value=u==null?void 0:u.token_a,p.value=u==null?void 0:u.token_b):m=="Sui"&&u&&(u==null?void 0:u.nftHash)==((I=W==null?void 0:W.query)==null?void 0:I.pos)&&(console.log(u,"==>newVal"),o.value=u,c.value=u==null?void 0:u.token_a,p.value=u==null?void 0:u.token_b,ne.value=!1)},{immediate:!0}),_e(()=>[o.value,v.value.addressLpTokens],([u,m])=>{!he(u)&&!he(m)&&ee(u)},{immediate:!0});const ve=_(()=>{var u,m,I,w,j,D,P,F;if(o.value&&!he(o.value)&&v.value.RATES){const X=o.value.amountA*((m=v.value.RATES[(u=o.value)==null?void 0:u.token_a.address])==null?void 0:m.price),ae=o.value.amountB*((w=v.value.RATES[(I=o.value)==null?void 0:I.token_b.address])==null?void 0:w.price);if((D=v.value.RATES[(j=o.value)==null?void 0:j.token_a.address])!=null&&D.price&&((F=v.value.RATES[(P=o.value)==null?void 0:P.token_b.address])!=null&&F.price)){const ue=Number(X+ae);return ue>0&&ue<.01?"<0.01":Q(Ue(X+ae,2),2)}else return" --"}else return" --"}),r=_(()=>{var u,m,I,w;return console.log((m=(u=o.value)==null?void 0:u.poolInfo)==null?void 0:m.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(w=(I=o.value)==null?void 0:I.poolInfo)==null?void 0:w.needReverse}),f=_(()=>v.value.RATES),L=_(()=>{var u,m;if(f.value&&c.value&&p.value&&!he(f.value)&&!he(c.value)&&!he(p.value)){const I=[],w=Number(o.value.feeOwedA)||0,j=Number(o.value.feeOwedB)||0;console.log(w,j,"===292"),console.log(f.value,c.value.address,"===293"),console.log(f.value[c.value.address],"===>RATES.value[fromCoin.value.address]"),console.log(f.value[p.value.address],"===>RATES.value[toCoin.value.address]");const D=new h(w).mul(((u=f.value[c.value.address])==null?void 0:u.price)||0),P=new h(j).mul(((m=f.value[p.value.address])==null?void 0:m.price)||0);return console.log(D.toString(),P.toString(),"====>292"),I.push({amount:w,amountUSD:D.toString()},{amount:j,amountUSD:P.toString()}),I}return[]}),t=_(()=>{var m,I;let u=new h(0);return(m=L.value)==null||m.forEach(w=>{u=u.add(new h(w.amountUSD))}),d.value=="Sui"&&((I=y.value)==null||I.forEach(w=>{u=u.add(new h(w.amountUSDText))})),console.log(L.value,y.value,"===>pendingRewarderArr.value"),u.toNumber()}),g=_(()=>{var m;let u=new h(0);return(m=y.value)==null||m.forEach(I=>{u=u.add(new h(I.amountUSDText))}),u.toNumber()}),A=ro(),y=B([]),{setIsShowSuccess:l,setIsShowRejected:K,setIsShowWaiting:z,setTransactionDesc:re,setTransactionTxid:x}=R,q=so(),H=_(()=>q),Y=async()=>{ne.value=!0;let u={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:y.value.length,collect_fee:!0};u.coinTypeC=y.value[0]?y.value[0].coin_address:"",u.coinTypeD=y.value[1]?y.value[1].coin_address:"",u.coinTypeE=y.value[2]?y.value[2].coin_address:"",z(!0),re(),console.log(u,o.value,"###collectRewarderParams");try{let m;if(d.value==="Aptos"){const I=await k.value.getCollectRewarderTransactionPayload(u);m=await H.value.currentWallet.signAndSubmitTransaction(I)}else{u.pos_index=o.value.pos_object_id;const I=await k.value.getCollectRewarderTransactionPayload(u,o.value),w=await H.value.currentWallet.signAndExecuteTransactionBlock(I);m=k.value.handleTx(w)}if(m&&m.hash){x(m.hash),z(!1),l(!0);const I={title:"Claim",desc:"",hash:m.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed"};d.value!=="Aptos"&&(I.res=m.res),k.value.showTransitionPending(I);const w=await k.value.watchTransaction(I);console.log("0310###toClaimRewards###transitionStatus###",w),w&&n.emit("getDetails")}else console.log("0310###toClaimRewards###else###"),z(!1),K(!0),ne.value=!1}catch(m){z(!1),K(!0),ne.value=!1,console.log(m,"error===>")}},oe=B(!1),le=async()=>{console.log("0310###toClaimRewards##start###",o.value),oe.value=!0;const u=y.value;let m={coinTypeA:o.value.poolInfo.coinTypeA,coinTypeB:o.value.poolInfo.coinTypeB,coinTypeC:"",coinTypeD:"",coinTypeE:"",pool_address:o.value.poolAddress,pos_index:o.value.index,rewarder_nums:u.length};m.coinTypeC=u[0]?u[0].coin_address:"",m.coinTypeD=u[1]?u[1].coin_address:"",m.coinTypeE=u[2]?u[2].coin_address:"",console.log(m,"===>collectRewarderParams");try{let I;if(d.value==="Aptos"){const w=await k.value.getCollectRewarderTransactionPayload(m);I=await H.value.currentWallet.signAndSubmitTransaction(w)}else{m.pos_index=o.value.pos_object_id;const w=await k.value.getCollectRewarderTransactionPayload(m),j=await H.value.currentWallet.signAndExecuteTransactionBlock(w);I=k.value.handleTx(j)}if(console.log("0310###toClaimRewards##tx###",I),I&&I.hash){x(I.hash),z(!1),l(!0);const w=u[0].amount+u[0].symbol,j=m.coinTypeD?" and "+u[1].amount+u[1].symbol:"",D=m.coinTypeE?" and "+u[2].amount+u[2].symbol:"",P={title:"Claim",desc:"",hash:I.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:u[0].address,numa:`+ ${Number(u[0].amount)}`,logoa:v.value.tokensObj&&u[0]&&u[0].address&&v.value.tokensObj[u[0].address]&&v.value.tokensObj[u[0].address].logoURI,tokenb:u[1]&&u[1].address,numb:m.coinTypeD?`+ ${Number(u[1].amount)}`:"",logob:m.coinTypeD?v.value.tokensObj&&u[1]&&u[1].address&&v.value.tokensObj[u[1].address]&&v.value.tokensObj[u[1].address].logoURI:"",tokenc:u[2]&&u[2].address,numc:m.coinTypeE?`+ ${Number(u[2].amount)}`:"",logoc:m.coinTypeE?v.value.tokensObj&&u[2]&&u[2].address&&v.value.tokensObj[u[2].address]&&v.value.tokensObj[u[2].address].logoURI:""},text:w+j+D};d.value!=="Aptos"&&(P.res=I.res),k.value.showTransitionPending(P);const F=await k.value.watchTransaction(P);console.log("0310###toClaimRewards###transitionStatus###",F),F&&setTimeout(()=>{n.emit("getDetails"),k.value.getAccount(H.value.address)},3e3)}else console.log("0310###toClaimRewards###else###"),z(!1),K(!0);oe.value=!1}catch(I){console.log("0310###collectRewarderParams Error###",I),oe.value=!1,z(!1),K(!0)}},V=_(()=>v.value.positionDetailCurrentTab),ie=_(()=>{var I,w,j,D,P,F;const u=pe(r.value?(w=o.value)==null?void 0:w.amountB:(I=o.value)==null?void 0:I.amountA,r.value?(F=(P=o.value)==null?void 0:P.token_b)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_a)==null?void 0:D.decimals),m=r.value?v.value.positionActionAmount.toCoinAmount||0:v.value.positionActionAmount.fromCoinAmount||0;if(V.value=="increase")return m?new h(u).add(new h(m)).toString():"";if(m){const X=new h(u).minus(new h(m)).toString();return X<0?"0":String(X)}else return""}),Z=_(()=>{var I,w,j,D,P,F;const u=pe(r.value?(w=o.value)==null?void 0:w.amountA:(I=o.value)==null?void 0:I.amountB,r.value?(F=(P=o.value)==null?void 0:P.token_a)==null?void 0:F.decimals:(D=(j=o.value)==null?void 0:j.token_b)==null?void 0:D.decimals),m=r.value?v.value.positionActionAmount.fromCoinAmount||0:v.value.positionActionAmount.toCoinAmount||0;if(console.log(u,m,"===>427"),V.value=="increase")return m?new h(u).add(new h(m)).toString():"";if(m){const X=new h(u).minus(new h(m)).toString();return X<0?"0":String(X)}else return""}),ge=_(()=>r.value?v.value.positionActionAmount.toCoinAmount:v.value.positionActionAmount.fromCoinAmount),U=_(()=>r.value?v.value.positionActionAmount.fromCoinAmount:v.value.positionActionAmount.toCoinAmount),me=u=>{var m;return(u==null?void 0:u.logoURI)||(u==null?void 0:u.logo_url)||((m=v.value.tokensObj[u==null?void 0:u.address])==null?void 0:m.logo_url)||(C.value.theme==="default"?eo("/image/coins/unknown.png"):eo("/image/coins/sui-unknown.png"))},ye=_(()=>{var D,P,F,X,ae,ue,be,we,T,N,se,ke;const{fromCoinAmount:u,toCoinAmount:m}=v.value.positionActionAmount,I=v.value.positionDetailCurrentTab,w=pe(r.value?(P=o.value)==null?void 0:P.amountB:(D=o.value)==null?void 0:D.amountA,r.value?(ue=(ae=o.value)==null?void 0:ae.token_b)==null?void 0:ue.decimals:(X=(F=o.value)==null?void 0:F.token_a)==null?void 0:X.decimals),j=pe(r.value?(we=o.value)==null?void 0:we.amountA:(be=o.value)==null?void 0:be.amountB,r.value?(ke=(se=o.value)==null?void 0:se.token_a)==null?void 0:ke.decimals:(N=(T=o.value)==null?void 0:T.token_b)==null?void 0:N.decimals);return console.log(w,j,u,m,"621===>"),d.value=="Sui"||I=="remove"&&d.value=="Aptos"&&u==w&&m==j});return{amountUSD:ve,needReverse:r,decimalUi:pe,pendingFees:L,positionInfo:o,pendingRewarderArr:y,pendingYieldAmount:t,toClaim:async()=>{ne.value=!0;const u=Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`,m=Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`;re(i("newAdd.claimWaitingText",{from:r.value?m:u,and:Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and",to:r.value?u:m})),z(!0);let I;const w={pool:o.value.poolInfo,position:o.value};try{const j=await k.value.getCollectFeeTransactionPayload(w);if(d.value==="Aptos")I=await H.value.currentWallet.signAndSubmitTransaction(j);else{const D=await H.value.currentWallet.signAndExecuteTransactionBlock(j);I=k.value.handleTx(D)}if(I){x(I.hash),z(!1),l(!0);const D={title:"Claim",desc:"",hash:I.hash,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${o.value.token_a.address}`,numa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)}`,logoa:Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":v.value.tokensObj&&o.value&&o.value.token_a.address&&v.value.tokensObj[o.value.token_a.address]&&v.value.tokensObj[o.value.token_a.address].logoURI,tokenb:`${o.value.token_b.address}`,numb:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)}`,logob:Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":v.value.tokensObj&&o.value&&o.value.token_b.address&&v.value.tokensObj[o.value.token_b.address]&&v.value.tokensObj[o.value.token_b.address].logoURI},text:`Claim ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0?"":`${Pe(o.value.feeOwedA,o.value.token_a.decimals)} ${o.value.token_a.symbol}`}  
              ${Q(o.value.feeOwedA,o.value.token_a.decimals)==0||Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":"and"} ${Q(o.value.feeOwedB,o.value.token_b.decimals)==0?"":`${Pe(o.value.feeOwedB,o.value.token_b.decimals)} ${o.value.token_b.symbol}`}

            `};d.value!=="Aptos"&&(D.res=I.res),k.value.showTransitionPending(D);const P=await k.value.watchTransaction(D);console.log("0310##toClaim###transitionStatus####",P),P&&setTimeout(()=>{n.emit("getDetails")},1e3)}else z(!1),K(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),duration:4.5,message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"});ne.value=!1,console.log("claim####test###",I)}catch(j){console.log("claim###error####",j),ne.value=!1,z(!1),K(!0),s.error({icon:Xe("svg",{class:{icon:!0},"aria-hidden":!0},[Xe("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Xe("div",{class:"notification-title"},[Xe("span",{innerHTML:So.global.t("newAdd.claimFailed")},null)]),duration:4.5,description:i("newAdd.somethingWrong"),class:"ant-notification-copy ant-notification-error"})}},claimAll:Y,fromCoin:c,toCoin:p,showNum:Pe,claimLoading:ne,addCommom:Q,afterBase:ie,afterQuote:Z,fromCoinAmount:ge,toCoinAmount:U,checkNullObj:he,getCoinIcon:me,chainName:d,isShowAfterAmount:ye,pendingRewarderAmount:g,toClaimRewards:le,rewarderLoading:oe}}});const Dt={class:"liquidity-card"},Ft={class:"liquidity-title"},Wt={class:"liquidity-usd"},Ht=a("span",null,"Liquidity",-1),Xt={class:"liquidity-ratio"},Gt={class:"coin-ratio"},zt={class:"coin-a-ratio"},Yt={class:"coin-b-ratio"},Jt={class:"ratio-progress"},Qt={class:"base-quote-num"},Zt={class:"base-coin-num"},Kt=a("span",null,"Base",-1),Vt={alt:""},xt={key:0,class:"after"},ei={class:"quote-coin-num"},oi=a("span",null,"Quote",-1),ni={alt:""},ti={key:0,class:"after"},ii={class:"pending-yield"},ai={class:"left"},si={class:"pending-yield-title"},li={key:0,class:"after"},ri={class:"right"},ui={class:"fees-rewards"},di={class:"fees-rewards-item"},ci=a("span",null,"Fees",-1),vi={key:0,class:"after"},mi=a("span",null,"Fees",-1),fi={key:0,class:"after"},pi=a("span",null,"Bonus",-1),hi={alt:""},gi={key:0,class:"after"},bi={key:0,class:"pending-yield"},ki={class:"left"},yi=a("div",{class:"pending-yield-title"},"Pending rewards",-1),wi={key:0,class:"after"},_i={class:"right"},Ai={key:1,class:"fees-rewards"},Ii={class:"fees-rewards-item"},Ci=a("span",null,"Bonus",-1),Si={alt:""},$i={key:0,class:"after"};function Ti(e,n,i,s,R,C){var c,p,d,k,W,ne,ee,ve,r,f,L,t,g,A,y,l,K,z,re,x,q,H,Y,oe,le,V,ie,Z,ge,U,me,ye,De,u,m,I,w,j,D,P,F,X,ae,ue,be,we,T,N,se,ke,b,G,S,te,ce,$e,Ne,Ie,Te,Be,Le,We,Re,Me;const O=ao,v=uo,o=Mo("image");return $(),M("div",Dt,[a("div",Ft,[a("div",Wt,[Ht,a("div",null,"$"+E(e.amountUSD),1)]),a("div",Xt,[a("div",Gt,[a("div",zt,[a("span",null,E(e.needReverse?(p=e.toCoin)==null?void 0:p.symbol:(c=e.fromCoin)==null?void 0:c.symbol),1),Ae(" "+E(e.needReverse?(k=e.positionInfo)==null?void 0:k.toPercent:(d=e.positionInfo)==null?void 0:d.fromPercent)+"% ",1)]),a("div",Yt,[a("span",null,E(e.needReverse?(ne=e.fromCoin)==null?void 0:ne.symbol:(W=e.toCoin)==null?void 0:W.symbol),1),Ae(" "+E(e.needReverse?(ve=e.positionInfo)==null?void 0:ve.fromPercent:(ee=e.positionInfo)==null?void 0:ee.toPercent)+"% ",1)])]),a("div",Jt,[a("div",{class:"from-percent",style:$o({width:e.needReverse?((f=e.positionInfo)==null?void 0:f.toPercent)+"%":((r=e.positionInfo)==null?void 0:r.fromPercent)+"%"})},null,4),a("div",{class:"to-percent",style:$o({width:e.needReverse?((t=e.positionInfo)==null?void 0:t.fromPercent)+"%":((L=e.positionInfo)==null?void 0:L.toPercent)+"%"})},null,4)])])]),a("div",Qt,[a("div",Zt,[Kt,a("div",null,[qe(a("img",Vt,null,512),[[o,(e.needReverse?(A=e.toCoin)==null?void 0:A.logo_url:(g=e.fromCoin)==null?void 0:g.logo_url)||e.getCoinIcon(e.needReverse?(l=e.positionInfo)==null?void 0:l.token_b:(y=e.positionInfo)==null?void 0:y.token_a)]]),de(O,{address:e.needReverse?(x=(re=e.positionInfo)==null?void 0:re.token_b)==null?void 0:x.address:(z=(K=e.positionInfo)==null?void 0:K.token_a)==null?void 0:z.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.needReverse?(H=e.positionInfo)==null?void 0:H.amountB:(q=e.positionInfo)==null?void 0:q.amountA,e.needReverse?(V=(le=e.positionInfo)==null?void 0:le.token_b)==null?void 0:V.decimals:(oe=(Y=e.positionInfo)==null?void 0:Y.token_a)==null?void 0:oe.decimals))),1)]),e.afterBase&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)?($(),M("div",xt,E(("addCommom"in e?e.addCommom:J(Q))(e.afterBase))+" after ",1)):fe("",!0)]),a("div",ei,[oi,a("div",null,[qe(a("img",ni,null,512),[[o,(e.needReverse?(Z=e.fromCoin)==null?void 0:Z.logo_url:(ie=e.toCoin)==null?void 0:ie.logo_url)||e.getCoinIcon(e.needReverse?(U=e.positionInfo)==null?void 0:U.token_a:(ge=e.positionInfo)==null?void 0:ge.token_b)]]),de(O,{address:e.needReverse?(u=(De=e.positionInfo)==null?void 0:De.token_a)==null?void 0:u.address:(ye=(me=e.positionInfo)==null?void 0:me.token_b)==null?void 0:ye.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(("addCommom"in e?e.addCommom:J(Q))(("decimalUi"in e?e.decimalUi:J(pe))(e.needReverse?(I=e.positionInfo)==null?void 0:I.amountA:(m=e.positionInfo)==null?void 0:m.amountB,e.needReverse?(P=(D=e.positionInfo)==null?void 0:D.token_a)==null?void 0:P.decimals:(j=(w=e.positionInfo)==null?void 0:w.token_b)==null?void 0:j.decimals))),1)]),e.afterQuote&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)?($(),M("div",ti,E(("addCommom"in e?e.addCommom:J(Q))(e.afterQuote))+" after ",1)):fe("",!0)])]),a("div",ii,[a("div",ai,[a("div",si,E(e.chainName=="Sui"?"Pending Yield":"Pending fees"),1),a("div",null,[Ae(" $"+E(e.pendingYieldAmount>0&&e.pendingYieldAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingYieldAmount,2))+" ",1),e.pendingYieldAmount>0?($(),M("span",li,"$0 after")):fe("",!0)])]),a("div",ri,[de(v,{class:"claim-all",loading:e.claimLoading,disabled:e.claimLoading||e.pendingYieldAmount==0,onClick:n[0]||(n[0]=Ce=>e.chainName=="Sui"?e.claimAll():e.toClaim())},{default:Ye(()=>[Ae("Claim")]),_:1},8,["loading","disabled"])])]),a("div",ui,[a("div",di,[a("div",null,[ci,a("div",null,[qe(a("img",null,null,512),[[o,(e.needReverse?(X=e.toCoin)==null?void 0:X.logo_url:(F=e.fromCoin)==null?void 0:F.logo_url)||e.getCoinIcon(e.needReverse?(ue=e.positionInfo)==null?void 0:ue.token_b:(ae=e.positionInfo)==null?void 0:ae.token_a)]]),de(O,{address:e.needReverse?(N=(T=e.positionInfo)==null?void 0:T.token_b)==null?void 0:N.address:(we=(be=e.positionInfo)==null?void 0:be.token_a)==null?void 0:we.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(e.needReverse?("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedB,(G=(b=e.positionInfo)==null?void 0:b.token_b)==null?void 0:G.decimals):("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedA,(ke=(se=e.positionInfo)==null?void 0:se.token_a)==null?void 0:ke.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",vi," 0 after ")):fe("",!0)]),a("div",null,[mi,a("div",null,[qe(a("img",null,null,512),[[o,(e.needReverse?(te=e.fromCoin)==null?void 0:te.logo_url:(S=e.toCoin)==null?void 0:S.logo_url)||e.getCoinIcon(e.needReverse?($e=e.positionInfo)==null?void 0:$e.token_a:(ce=e.positionInfo)==null?void 0:ce.token_b)]]),de(O,{address:e.needReverse?(Be=(Te=e.positionInfo)==null?void 0:Te.token_a)==null?void 0:Be.address:(Ie=(Ne=e.positionInfo)==null?void 0:Ne.token_b)==null?void 0:Ie.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(e.needReverse?("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedA,(Me=(Re=e.positionInfo)==null?void 0:Re.token_a)==null?void 0:Me.decimals):("showNum"in e?e.showNum:J(Pe))(e.positionInfo.feeOwedB,(We=(Le=e.positionInfo)==null?void 0:Le.token_b)==null?void 0:We.decimals)),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",fi," 0 after ")):fe("",!0)]),e.chainName=="Sui"?($(!0),M(po,{key:0},ho(e.pendingRewarderArr,Ce=>($(),M("div",{key:Ce},[pi,a("div",null,[qe(a("img",hi,null,512),[[o,Ce.logo_url]]),de(O,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",gi," 0 after ")):fe("",!0)]))),128)):fe("",!0)])]),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?($(),M("div",bi,[a("div",ki,[yi,a("div",null,[Ae(" $"+E(e.pendingRewarderAmount>0&&e.pendingRewarderAmount<.01?"<0.01":("addCommom"in e?e.addCommom:J(Q))(e.pendingRewarderAmount,2))+" ",1),e.pendingRewarderAmount>0?($(),M("span",wi,"$0 after")):fe("",!0)])]),a("div",_i,[de(v,{class:"claim-all",loading:e.rewarderLoading,disabled:e.rewarderLoading||e.pendingRewarderAmount==0,onClick:e.toClaimRewards},{default:Ye(()=>[Ae("Claim")]),_:1},8,["loading","disabled","onClick"])])])):fe("",!0),e.chainName=="Aptos"&&e.pendingRewarderAmount>0?($(),M("div",Ai,[a("div",Ii,[($(!0),M(po,null,ho(e.pendingRewarderArr,Ce=>($(),M("div",{key:Ce},[Ci,a("div",null,[qe(a("img",Si,null,512),[[o,Ce.logo_url]]),de(O,{address:Ce.address,"style-params":{width:"10px",height:"10px",left:"15px",bottom:"8px"}},null,8,["address"]),a("span",null,E(Ce.amount),1)]),(e.fromCoinAmount||e.toCoinAmount)&&!("checkNullObj"in e?e.checkNullObj:J(he))(e.positionInfo)&&e.isShowAfterAmount?($(),M("div",$i," 0 after ")):fe("",!0)]))),128))])])):fe("",!0)])}const Xo=Ze(Et,[["render",Ti]]),Pi=Qe({components:{AssetsCard:co},setup(e,n){const i=B(""),s=B(""),R=Je(),C=_(()=>R),O=_(()=>C.value.theme),v=no(),o=_(()=>v),c=B(!1),p=B(!1),d=B(!0),k=_(()=>C.value.chainName),W=_(()=>k.value?oo(k.value):{}),ne=so(),ee=_(()=>ne),ve=_(()=>C.value.slippage),r=B(),f=B(),L=_(()=>ee.value.assets&&r.value&&ee.value.assets[r.value.address]?Io(ee.value.assets[r.value.address].balance,r.value.decimals):0),t=_(()=>ee.value.assets&&f.value&&ee.value.assets[f.value.address]?Io(ee.value.assets[f.value.address].balance,f.value.decimals):0),g=w=>{w==="fromCoin"?(d.value=!0,k.value==="Aptos"?i.value=L.value>0?r.value.symbol=="APT"?new h(Number(L.value)).sub(new h(.1)).lt(new h(0))?"0":new h(Number(L.value)).sub(new h(.1)).toString():String(L.value):"":i.value=L.value>0?r.value.symbol=="SUI"?new h(Number(L.value)).sub(new h(.05)).lt(new h(0))?"0":new h(Number(L.value)).sub(new h(.05)).toString():String(L.value):""):(d.value=!1,k.value==="Aptos"?s.value=t.value>0?f.value.symbol=="APT"?new h(Number(t.value)).sub(new h(.1)).lt(new h(0))?"0":new h(Number(t.value)).sub(new h(.1)).toString():String(t.value):"":s.value=t.value>0?f.value.symbol=="SUI"?new h(Number(t.value)).sub(new h(.05)).lt(new h(0))?"0":new h(Number(t.value)).sub(new h(.05)).toString():String(t.value):"")},A=w=>{w==="fromCoin"?(d.value=!0,i.value=Ue(new h(Number(L.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,s.value=Ue(new h(Number(t.value)).div(2).toString(),f.value.decimals).toString())},y=B({}),l=B(!0),K=B({}),z=B(),re=B(),x=()=>{var N;if(!y.value||!i.value&&!s.value)return;const{TickMath:w,TickUtil:j}=W.value;console.log(i.value,s.value,"====>369"),console.log(y.value,"===>positionInfo.value339");let D=y.value.minPrice,P=y.value.maxPrice.indexOf("+")>0?"∞":y.value.maxPrice;console.log(y.value,"positionInfo.value====>");let F=Number(y.value.tick_lower_index),X=Number(y.value.tick_upper_index);const ae=Number(y.value.current_tick_index);let ue,be,we=Number(D).toString(),T=y.value.maxPrice.indexOf("+")>0||y.value.maxPrice==="∞"?"∞":Number(P);if(we=="0"&&T=="∞"?(F=Number(y.value.tick_lower_index),X=Number(y.value.tick_upper_index)):(ue=w.priceToSqrtPriceX64(new h(D),r.value.decimals,f.value.decimals),be=w.priceToSqrtPriceX64(new h(P),r.value.decimals,f.value.decimals)),z.value=F,re.value=X,console.log(F,X,"tick_lowertick_lower"),P!=="∞"&&F>=X){c.value=!0,i.value="",p.value=!0,s.value="";return}if(P=="∞"||ae>=F&&ae<=X){console.log("0413###increase###11111"),c.value=!1,p.value=!1;let se;if(i.value||s.value){if(d.value){const ce=new h(i.value).mul(Math.pow(10,r.value.decimals)).toString();se=new Oe(ce)}else{const ce=new h(s.value).mul(Math.pow(10,f.value.decimals)).toString();se=new Oe(ce)}const{liquidityAmount:ke,tokenMaxA:b,tokenMaxB:G,tokenMaxAOrigin:S,tokenMaxBOrigin:te}=W.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:F,upperTick:X,coinAmount:se,iscoinA:l.value?d.value:!d.value,roundUp:!0,slippage:Number(ve.value)/100,curSqrtPrice:new Oe(y.value.current_sqrt_price)});K.value={liquidityAmount:ke,tokenMaxA:b,tokenMaxB:G,tokenMaxAOrigin:S,tokenMaxBOrigin:te},l.value?d.value?s.value=Number(G)>0?G:"":i.value=Number(b)>0?b:"":d.value?s.value=b:i.value=G}}else if(ae>X){if(console.log("0413###increase###22222"),i.value="",c.value=!0,p.value=!1,i.value||s.value){let se;const ke=new h(s.value).mul(Math.pow(10,(N=f.value)==null?void 0:N.decimals)).toString();se=new Oe(ke),K.value={liquidityAmount:Oo(ue,be,se),tokenMaxA:0,tokenMaxB:s.value}}}else if(ae<F){if(console.log("0413###increase###33333"),c.value=!1,p.value=!0,s.value="",i.value||s.value){let se;const ke=new h(i.value).mul(Math.pow(10,r.value.decimals)).toString();se=new Oe(ke),K.value={liquidityAmount:qo(ue,be,se),tokenMaxA:i.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),c.value=!0,i.value="",p.value=!0,s.value="";v.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s}),console.log(K.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount")};_e(()=>o.value.currentPositionInfo,w=>{if(w&&!he(w)){y.value=w,console.log(w,"newVal===>"),r.value=y.value.token_a,f.value=y.value.token_b;let j=Number(y.value.tick_lower_index),D=Number(y.value.tick_upper_index);const P=Number(y.value.current_tick_index);(w.maxPrice.indexOf("+")>0||w.maxPrice==="∞"?"∞":w.maxPrice)=="∞"||P>=j&&P<=D?(c.value=!1,p.value=!1):P>D?(i.value="",c.value=!0,p.value=!1):P<j?(c.value=!1,p.value=!0,s.value=""):(c.value=!0,i.value="",p.value=!0,s.value=""),x()}},{immediate:!0}),_e(i,(w,j)=>{w&&x(),w==""&&(s.value="")}),_e(s,(w,j)=>{w&&x(),w==""&&(i.value="")});const q=_(()=>{var w,j,D,P;return console.log((j=(w=y.value)==null?void 0:w.poolInfo)==null?void 0:j.needReverse,"===>positionInfo.value?.poolInfo?.needReverse"),(P=(D=y.value)==null?void 0:D.poolInfo)==null?void 0:P.needReverse}),H=_(()=>o.value.RATES),Y=_(()=>{var X,ae,ue,be;const w=((ae=H.value[(X=r.value)==null?void 0:X.address])==null?void 0:ae.price)||0,j=((be=H.value[(ue=f.value)==null?void 0:ue.address])==null?void 0:be.price)||0,D=new h(w).mul(new h(i.value||0)),P=new h(j).mul(new h(s.value||0)),F=D.add(P);return console.log(w,j,D.toString(),P.toString(),"====>amount"),F.toNumber()?F.toNumber()>0&&F.toNumber()>.01?Q(F.toString(),2):"<0.01":"--"}),oe=B(!1),{t:le,locale:V}=Ao(),ie=_(()=>{const w=Number(i.value)>Number(L.value),j=Number(s.value)>Number(t.value);return!i.value&&!s.value?le("button.enterAmount"):w?le("button.insufficientBalance",{name:r.value.symbol}):j?le("button.insufficientBalance",{name:f.value.symbol}):le("newAdd.addMore")}),Z=_(()=>{const w=Number(i.value)>Number(L.value),j=Number(s.value)>Number(t.value);return!!(!i.value&&!s.value||w||j)}),{setIsShowSuccess:ge,setIsShowRejected:U,setIsShowWaiting:me,setTransactionDesc:ye,setTransactionTxid:De,setPositiomNum:u}=R,m=B(!1);return{theme:O,showFromCoinLock:c,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:L,toCoinBlance:t,fromCoin:r,toCoin:f,maxBtnSelect:g,halfBtnSelect:A,fixedFromCoin:d,needReverse:q,totalAmount:Y,wallet:ee,addLiquidityBtnText:ie,isShowLiquidityModal:oe,indexStore:R,positionInfo:y,actionLoading:m,toAdd:async()=>{var X,ae,ue,be,we,T,N,se,ke,b;oe.value=!1,m.value=!0,De("");const w=c.value?"":`${i.value} ${(X=r.value)==null?void 0:X.symbol}`,j=p.value?"":`${s.value} ${(ae=f.value)==null?void 0:ae.symbol}`;ye(le("tips.increaseLiquiditySuccess",{from:q.value?j:w,and:!c.value&&!p.value?"and":"",to:q.value?w:j})),me(!0);const D=d.value;console.log(D,"===>fix_amount_a"),console.log(z.value,"tickLower.value===>"),console.log(re.value,"tickUpper.value,===>"),console.log("0222###increase###positionInfo###",y);const P=y.value.poolInfo.rewarder_infos;let F={};F.coinTypeC=P[0]?P[0].coinAddress:"",F.coinTypeD=P[1]?P[1].coinAddress:"",F.coinTypeE=P[2]?P[2].coinAddress:"",console.log("0103 toAdd positionInfo: ",y),console.log("0103 toAdd liquidityInput: ",K);try{const G=await W.value.getAddLiquidityTransactionPayload({pool:{poolAddress:y.value.poolAddress,token_a:y.value.token_a,token_b:y.value.token_b},amount:D?K.value.tokenMaxA:K.value.tokenMaxB,fix_amount_a:D,tick_lower:z.value,tick_upper:re.value,index:k.value==="Aptos"?y.value.index:y.value.pos_object_id,slippage:Number(ve.value)/100,roundUp:!0,collect_fee:!0,...F,curSqrtPrice:new Oe(y==null?void 0:y.value.poolInfo.current_sqrt_price),positionInfo:y});console.log(G,"===>payloadAdd11111");let S;if(k.value==="Aptos")S=await ee.value.currentWallet.signAndSubmitTransaction(G);else{const te=await ee.value.currentWallet.signAndExecuteTransactionBlock(G);S=W.value.handleTx(te)}if(console.log("toAdd###tx###",S),S&&S.hash){De(S.hash),me(!1),ge(!0),console.log(y,"===>positionInfo");const te={title:"Supplied",desc:le("tips.addLiquiditySuccessText",{from:c.value?"":`${i.value} ${(ue=r.value)==null?void 0:ue.symbol}`,and:!c.value&&!p.value?"and":"",to:p.value?"":`${s.value} ${(be=f.value)==null?void 0:be.symbol}`}),hash:S.hash,tit:"Liquidity Increased",icon:"icon-icon-Increased",tokenInfo:{tokena:q.value?`${(T=f.value)==null?void 0:T.address}`:`${(we=r.value)==null?void 0:we.address}`,numa:q.value?`- ${s.value}`:`- ${i.value}`,logoa:q.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:q.value?`${(se=r.value)==null?void 0:se.address}`:`${(N=f.value)==null?void 0:N.address}`,numb:q.value?`- ${i.value}`:`- ${s.value}`,logob:q.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Deopsit ${c.value?"":`${i.value} ${(ke=r.value)==null?void 0:ke.symbol}`} ${!c.value&&!p.value?"and":""} ${p.value?"":`${s.value} ${(b=f.value)==null?void 0:b.symbol}`}`};k.value!=="Aptos"&&(te.res=S.res),W.value.showTransitionPending(te),await W.value.watchTransaction(te)&&setTimeout(()=>{n.emit("getDetails"),W.value.getAccount(ee.value.address)},1e3),u()}else me(!1),U(!0);i.value="",s.value="",m.value=!1}catch(G){i.value="",s.value="",console.log("addError###",G),m.value=!1,me(!1),U(!0)}},addLiquidityBtnDisabled:Z,poolStore:v}}});const Ni={class:"new-position-asset"},Ri={class:"add-or-remove"},Oi={class:"liquidity-action-tab"},qi=a("div",{class:"increase tab-active"}," Increase ",-1),Bi={class:"card-item"},Li={class:"card-item"},Mi={key:0,class:"add",src:rn},Ui={key:1,class:"add",src:un},ji={class:"total-amount"},Ei=a("span",null,"Total Amount",-1);function Di(e,n,i,s,R,C){var p;const O=co,v=sn,o=uo,c=ln;return $(),M("div",Ni,[a("div",Ri,[a("div",Oi,[qi,a("div",{class:"remove",onClick:n[0]||(n[0]=d=>e.poolStore.setPositionDetailCurrentTab("remove"))}," Remove ")]),a("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[a("div",Bi,[de(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=d=>e.fromCoinAmount=d),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,onOnMax:n[2]||(n[2]=d=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=d=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=d=>{e.fromCoinAmount=d}),onOnFocus:n[5]||(n[5]=()=>{e.fixedFromCoin=!0})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showFromCoinLock?($(),je(v,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),a("div",Li,[de(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[6]||(n[6]=d=>e.toCoinAmount=d),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,onOnMax:n[7]||(n[7]=d=>e.maxBtnSelect("toCoin")),onOnHalf:n[8]||(n[8]=d=>e.halfBtnSelect("toCoin")),onOnInput:n[9]||(n[9]=d=>{e.toCoinAmount=d}),onOnFocus:n[10]||(n[10]=()=>{e.fixedFromCoin=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.showToCoinLock?($(),je(v,{key:0,"from-coin":e.fromCoin,"to-coin":e.toCoin},null,8,["from-coin","to-coin"])):fe("",!0)]),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme=="default"?($(),M("img",Mi)):fe("",!0),e.fromCoin&&e.toCoin&&!e.showToCoinLock&&!e.showFromCoinLock&&e.theme!=="default"?($(),M("img",Ui)):fe("",!0)],2),a("div",ji,[Ei,a("span",null,"$"+E(e.totalAmount),1)])]),e.wallet.connected?($(),je(o,{key:0,class:"big-btn liquidity-btn",disabled:e.addLiquidityBtnDisabled,loading:e.actionLoading,onClick:n[11]||(n[11]=d=>e.isShowLiquidityModal=!0)},{default:Ye(()=>[a("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["disabled","loading"])):($(),je(o,{key:1,class:"big-btn",onClick:n[12]||(n[12]=d=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[a("span",null,E(e.$t("button.connectWallet")),1)]),_:1})),e.isShowLiquidityModal?($(),je(c,{key:2,title:e.$t("button.increase"),"is-increase":!0,"from-coin":e.needReverse?e.toCoin:e.fromCoin,"to-coin":e.needReverse?e.fromCoin:e.toCoin,"from-coin-amount":e.needReverse?e.toCoinAmount:e.fromCoinAmount,"to-coin-amount":e.needReverse?e.fromCoinAmount:e.toCoinAmount,"min-price":e.positionInfo.minPrice,"max-price":e.positionInfo.maxPrice,"current-price":e.positionInfo.currentPrice,"current-price-reverse":1/e.positionInfo.currentPrice,"pool-info":(p=e.positionInfo)==null?void 0:p.poolInfo,"show-from-coin-lock":e.showFromCoinLock,"show-to-coin-lock":e.showToCoinLock,"position-total-amount":e.positionInfo.totalAmountUSD,"fixed-from-coin":!0,"tick-lower":e.positionInfo.tick_lower_index,"tick-upper":e.positionInfo.tick_upper_index,"current-price-tab":"custom",onToAdd:e.toAdd,onOnClose:n[13]||(n[13]=d=>e.isShowLiquidityModal=!1)},null,8,["title","from-coin","to-coin","from-coin-amount","to-coin-amount","min-price","max-price","current-price","current-price-reverse","pool-info","show-from-coin-lock","show-to-coin-lock","position-total-amount","tick-lower","tick-upper","onToAdd"])):fe("",!0)])}const yo=Ze(Pi,[["render",Di]]),Fi=Qe({components:{AssetsCard:co},setup(e,n){const i=B(""),s=B(""),R=Je(),C=_(()=>R),O=_(()=>C.value.theme),v=no(),o=_(()=>v),c=B(!1),p=B(!1),d=B(!0),k=_(()=>C.value.chainName),W=_(()=>k.value?oo(k.value):{}),ne=so(),ee=_(()=>ne),ve=_(()=>C.value.slippage),r=B(),f=B(),L=_(()=>{var b,G;return(G=(b=l.value)==null?void 0:b.poolInfo)==null?void 0:G.needReverse}),t=_(()=>{var b;return console.log(l==null?void 0:l.value,"==>positionInfo?.value"),console.log(!L.value,"===>!needReverse.value"),pe(l==null?void 0:l.value.amountA,(b=l==null?void 0:l.value.token_a)==null?void 0:b.decimals)}),g=_(()=>{var b;return pe(l==null?void 0:l.value.amountB,(b=l==null?void 0:l.value.token_b)==null?void 0:b.decimals)}),A=b=>{b==="fromCoin"?d.value=!0:d.value=!1,Y.value=100,le({value:1})},y=b=>{b==="fromCoin"?(d.value=!0,i.value=Ue(new h(Number(t.value)).div(2).toString(),r.value.decimals).toString()):(d.value=!1,s.value=Ue(new h(Number(g.value)).div(2).toString(),f.value.decimals).toString()),q.value=!1},l=B({}),K=B(!0),z=B({}),re=B(),x=B(),q=B(!0),H=()=>{var We;if(q.value||!l.value||!i.value&&!s.value||(console.log(i.value>t.value,Number(s.value)>Number(g.value),"==>toCoinAmount.value"),Number(i.value)>Number(t.value)||Number(s.value)>Number(g.value)))return;if(i.value==t.value&&s.value==g.value){Y.value=100,le({value:1}),q.value=!0;return}const{TickMath:b,TickUtil:G}=W.value;console.log(i.value,s.value,"====>369"),console.log(l.value,"===>positionInfo.value339");let S=l.value.minPrice,te=l.value.maxPrice.indexOf("+")>0?"∞":l.value.maxPrice;console.log(l.value,"positionInfo.value====>");let ce=Number(l.value.tick_lower_index),$e=Number(l.value.tick_upper_index);const Ne=Number(l.value.current_tick_index);let Ie,Te,Be=Number(S).toString(),Le=l.value.maxPrice.indexOf("+")>0||l.value.maxPrice==="∞"?"∞":Number(te);if(Be=="0"&&Le=="∞"?(ce=Number(l.value.tick_lower_index),$e=Number(l.value.tick_upper_index)):(Ie=b.priceToSqrtPriceX64(new h(S),r.value.decimals,f.value.decimals),Te=b.priceToSqrtPriceX64(new h(te),r.value.decimals,f.value.decimals)),re.value=ce,x.value=$e,console.log(ce,$e,"tick_lowertick_lower"),te!=="∞"&&ce>=$e){c.value=!0,i.value="",p.value=!0,s.value="";return}if(te=="∞"||Ne>=ce&&Ne<=$e){console.log("0413###increase###11111"),console.log(i.value,"==>341"),console.log(s.value,"==>341"),c.value=!1,p.value=!1;let Re;if(i.value||s.value){if(d.value){const Ge=new h(i.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(Ge)}else{const Ge=new h(s.value).mul(Math.pow(10,f.value.decimals)).toString();Re=new Oe(Ge)}const{liquidityAmount:Me,tokenMaxA:Ce,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:Se}=W.value.estLiquidityAndcoinAmountFromOneAmounts({tokenA:r.value,tokenB:f.value,lowerTick:ce,upperTick:$e,coinAmount:Re,iscoinA:K.value?d.value:!d.value,roundUp:k.value!="Sui",slippage:Number(ve.value)/100,curSqrtPrice:new Oe(l.value.current_sqrt_price)});z.value={liquidityAmount:Me,tokenMaxA:Ce,tokenMaxB:He,tokenMaxAOrigin:to,tokenMaxBOrigin:Se},console.log(He,Ce,"362===>"),K.value?d.value?s.value=Number(He)>0?He:"":i.value=Number(Ce)>0?Ce:"":d.value?s.value=Ce:i.value=He}}else if(Ne>$e){if(console.log("0413###increase###22222"),i.value="",c.value=!0,p.value=!1,i.value||s.value){let Re;const Me=new h(s.value).mul(Math.pow(10,(We=f.value)==null?void 0:We.decimals)).toString();Re=new Oe(Me),z.value={liquidityAmount:Oo(Ie,Te,Re),tokenMaxA:0,tokenMaxB:s.value}}}else if(Ne<ce){if(console.log("0413###increase###33333"),c.value=!1,p.value=!0,s.value="",i.value||s.value){let Re;const Me=new h(i.value).mul(Math.pow(10,r.value.decimals)).toString();Re=new Oe(Me),z.value={liquidityAmount:qo(Ie,Te,Re),tokenMaxA:i.value,tokenMaxB:0}}}else console.log("0413###increase###4444"),c.value=!0,p.value=!0;q.value=!1,Y.value=new h(z.value.liquidityAmount.toString()).div(l.value.liquidity).mul(100).toNumber().toFixed(2),oe.value=z.value.liquidityAmount,console.log(Y.value,"===>sliderVal.value"),console.log(z.value.liquidityAmount,"====>liquidityInput.value.liquidityAmount"),v.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s}),console.log(Y.value,"===>sliderVal.value")},Y=B(50),oe=B("0"),le=b=>{if(!q.value)return;q.value=!0;const G=l.value.token_a.decimals,S=l.value.token_b.decimals,te=l.value.tick_lower_index,ce=l.value.tick_upper_index,$e=Co.tickIndexToSqrtPriceX64(te),Ne=Co.tickIndexToSqrtPriceX64(ce);let Ie="";b.value!==1?Ie=new h(l.value.liquidity).mul(b.value).toString():Ie=l.value.liquidity,Ie=Ue(Ie,0)||"0",oe.value=Ie;const Te=Jo.getCoinAmountFromLiquidity(new Oe(Ie),new Oe(l.value.current_sqrt_price),$e,Ne,k.value!="Sui");console.log(Te.coinA.toString(),Te.coinB.toString(),G,S,"===>amountInfo");const Be=new h(Te.coinA.toString()).div(Math.pow(10,G)).toString(),Le=new h(Te.coinB.toString()).div(Math.pow(10,S)).toString();console.log(Be,Le,"amountA121212"),i.value=Number(Be)>0?Be:"",s.value=Number(Le)>0?Le:"",v.setPositionActionAmount({fromCoinAmount:i,toCoinAmount:s})};_e(()=>o.value.currentPositionInfo,b=>{if(b&&!he(b)){l.value=b,console.log(b,"newVal===>"),r.value=l.value.token_a,f.value=l.value.token_b,le({value:Y.value/100});let G=Number(l.value.tick_lower_index),S=Number(l.value.tick_upper_index);const te=Number(l.value.current_tick_index);(b.maxPrice.indexOf("+")>0||b.maxPrice==="∞"?"∞":b.maxPrice)=="∞"||te>=G&&te<=S?(c.value=!1,p.value=!1):te>S?(i.value="",c.value=!0,p.value=!1):te<G?(c.value=!1,p.value=!0,s.value=""):(c.value=!0,i.value="",p.value=!0,s.value=""),H()}},{immediate:!0}),_e(i,(b,G)=>{b&&H(),b==""&&(s.value="",Y.value=0)}),_e(s,(b,G)=>{b&&H(),b==""&&(i.value="",Y.value=0)});const V=_(()=>o.value.RATES),ie=_(()=>{var $e,Ne,Ie,Te;const b=((Ne=V.value[($e=r.value)==null?void 0:$e.address])==null?void 0:Ne.price)||0,G=((Te=V.value[(Ie=f.value)==null?void 0:Ie.address])==null?void 0:Te.price)||0,S=new h(b).mul(new h(i.value||0)),te=new h(G).mul(new h(s.value||0)),ce=S.add(te);return console.log(b,G,S.toString(),te.toString(),"====>amount"),Q(ce.toString(),2)}),Z=B(!1),{t:ge,locale:U}=Ao(),me=_(()=>{const b=Number(i.value)>Number(t.value),G=Number(s.value)>Number(g.value);return!i.value&&!s.value?ge("button.enterAmount"):b||G?"Invalid Amount":ge("button.remove")}),ye=_(()=>{const b=Number(i.value)>Number(t.value),G=Number(s.value)>Number(g.value);return!!(!i.value&&!s.value||b||G)}),{setIsShowSuccess:De,setIsShowRejected:u,setIsShowWaiting:m,setTransactionDesc:I,setTransactionTxid:w,setPositiomNum:j,setTransactionDescText:D}=R,P=B(!1);_e(Y,en((b,G)=>{b!==G&&(Number(b)>100?Y.value=100:b&&l.value?(console.log("687===>"),Y.value=b,le({value:Y.value/100})):(i.value="",s.value=""))},300)),_e(ve,b=>{b&&l.value&&le({value:Y.value/100})});const F=[{name:"25%",value:25},{name:"50%",value:50},{name:"75%",value:75},{name:"MAX",value:100}],X=Uo(),ae=_(()=>X),ue=_(()=>ae.value.status),be=B(!1),we=b=>{const G=b.sources;G.forEach(S=>{const{pool_address:te,position_index:ce}=JSON.parse(S.blockchainAddress);console.log(te,ce,"===>pool_address, position_index"),console.log(l.value.poolAddress,l.value.index,"===>positionInfo.value.index"),te==l.value.poolAddress&&Number(ce)==Number(l.value.index)&&(be.value=!0)}),console.log(G,"===>sources")},T=async()=>{await X.getSources();let b;ae.value.allSources.forEach(G=>{const{pool_address:S,position_index:te}=JSON.parse(G.blockchainAddress);S==l.value.poolAddress&&te==l.value.index&&(b=G.id)}),console.log(b,"sourceID649==>"),X.deleteSource(b)};_e(()=>[ae.value.sourceGroups,l.value],([b,G])=>{b&&b.sources&&b.sources.length>0&&G&&!he(G)&&we(b)},{immediate:!0,deep:!0});const N=ro(),se=lo();return{theme:O,showFromCoinLock:c,showToCoinLock:p,toCoinAmount:s,fromCoinAmount:i,fromCoinBlance:t,toCoinBlance:g,fromCoin:r,toCoin:f,maxBtnSelect:A,halfBtnSelect:y,fixedFromCoin:d,needReverse:L,totalAmount:ie,wallet:ee,addLiquidityBtnText:me,isShowLiquidityModal:Z,indexStore:R,positionInfo:l,actionLoading:P,addLiquidityBtnDisabled:ye,sliderVal:Y,ratioArr:F,setPercent:le,poolStore:v,isSlider:q,toRemove:async()=>{var ce,$e,Ne,Ie,Te,Be,Le,We,Re,Me,Ce,He,to;P.value=!0,w("");const b=Q(i.value,r.value.decimals)==0?"":`${pe(i.value,r.value.decimals)} ${r.value.symbol}`,G=Q(s.value,f.value.decimals)==0?"":`${pe(s.value,f.value.decimals)} ${f.value.symbol}`;I(ge("tips.removeLiquidiyText",{from:L.value?G:b,and:Q(i.value,r.value.decimals)==0||Q(s.value,f.value.decimals)==0?"":"and",to:L.value?b:G})),m(!0),console.log(l.value,"==>positionInfo.value");const S=l.value.poolInfo.rewarder_infos,te=S&&S.length>0&&k.value=="Sui"||S&&S.length>0&&Y.value==100?ge("modal.removeLiquidityText1"):ge("modal.removeLiquidityText2");D(te);try{let Se={};Se={pool:{...l.value.poolInfo,coinA:l.value.token_a,coinB:l.value.token_b},coinTypeA:l.value.poolInfo.coinTypeA,coinTypeB:l.value.poolInfo.coinTypeB,position:l.value,delta_liquidity:Y.value==100?new Oe(l.value.liquidity):new Oe(Ue(oe.value,0)),slippage:Number(ve.value),rewards_num:S.length,positionInfo:l.value},console.log(S,"===>pendingRewarderArr"),Se.coinTypeC=S[0]?S[0].coinAddress:"",Se.coinTypeD=S[1]?S[1].coinAddress:"",Se.coinTypeE=S[2]?S[2].coinAddress:"",console.log(Se,Y.value,Se.delta_liquidity.toString(),"===>params");const Ge=await W.value.getRemoveLiquidityTransactionPayload(Se);console.log(Ge,"===>payload");let Ee;if(k.value==="Aptos")Ee=await ee.value.currentWallet.signAndSubmitTransaction(Ge);else{const Ve=await ee.value.currentWallet.signAndExecuteTransactionBlock(Ge);Ee=W.value.handleTx(Ve),console.log("0331###remove###tx####",Ee)}if(Ee&&Ee.hash){w(Ee.hash),m(!1),De(!0);const Ve={title:ge("common.removeLiquidity"),desc:"",hash:Ee.hash,descTransactions:`Remove ${i.value} ${(ce=r.value)==null?void 0:ce.symbol} and ${s.value} ${($e=f.value)==null?void 0:$e.symbol} 
             from the pool`,sender:ee.value.address,chainName:k.value,tit:"Liquidity Removed",icon:"icon-icon-Removed",tokenInfo:{tokena:L.value?`${(Ie=f.value)==null?void 0:Ie.address}`:`${(Ne=r.value)==null?void 0:Ne.address}`,numa:L.value?`+ ${s.value}`:`+ ${i.value}`,logoa:L.value?o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI:o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI,tokenb:L.value?`${(Te=r.value)==null?void 0:Te.address}`:`${(Be=f.value)==null?void 0:Be.address}`,numb:L.value?`+ ${i.value}`:`+ ${s.value}`,logob:L.value?o.value.tokensObj&&r.value&&r.value.address&&o.value.tokensObj[r.value.address]&&o.value.tokensObj[r.value.address].logoURI:o.value.tokensObj&&f.value&&f.value.address&&o.value.tokensObj[f.value.address]&&o.value.tokensObj[f.value.address].logoURI},text:`Withdraw ${i.value} ${(Le=r.value)==null?void 0:Le.symbol} and ${s.value} ${(We=f.value)==null?void 0:We.symbol}`};k.value!=="Aptos"&&(Ve.res=Ee.res),W.value.showTransitionPending(Ve);const io=await W.value.watchTransaction(Ve);if(S.value&&S.value.length>0&&(Number((Re=S[0])==null?void 0:Re.amount)!==0||Se.coinTypeD&&Number((Me=S[1])==null?void 0:Me.amount)!==0||Se.coinTypeE&&Number((Ce=S[2])==null?void 0:Ce.amount)!==0)){const vo={title:ge("common.removeLiquidity"),desc:"",hash:Ee.hash,tit:"Rewards Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:S[0].symbol,numa:`+ ${Number(S[0].amount)}`,logoa:o.value.tokensObj&&S[0]&&S[0].address&&o.value.tokensObj[S[0].address]&&o.value.tokensObj[S[0].address].logoURI,tokenb:Se.coinTypeD?S[1].symbol:"",numb:Se.coinTypeD?`+ ${Number(S[1].amount)}`:"",logob:Se.coinTypeD?o.value.tokensObj&&S[1]&&S[1].address&&o.value.tokensObj[S[1].address]&&o.value.tokensObj[S[1].address].logoURI:"",tokenc:Se.coinTypeE?S[2].symbol:"",numc:Se.coinTypeE?`+ ${Number(S[2].amount)}`:"",logoc:Se.coinTypeE?o.value.tokensObj&&S[2]&&S[2].address&&o.value.tokensObj[S[2].address]&&o.value.tokensObj[S[2].address].logoURI:""},text:`Withdraw ${i.value} ${(He=r.value)==null?void 0:He.symbol} and ${s.value} ${(to=f.value)==null?void 0:to.symbol}`},mo=await W.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}if(Pe(l.value.feeOwedA,l.value.token_a.decimals)!==0||Pe(l.value.feeOwedB,l.value.token_b.decimals)!==0){const vo={title:"Claim",desc:"",hash:Ee.hash,chainName:k.value,tit:"Fees Claimed",icon:"icon-icon-Removed",tokenInfo:{tokena:`${l.value.token_a.symbol}`,numa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":`+ ${Pe(l.value.feeOwedA,l.value.token_a.decimals)}`,logoa:Q(l.value.feeOwedA,l.value.token_a.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_a.address&&o.value.tokensObj[l.value.token_a.address]&&o.value.tokensObj[l.value.token_a.address].logoURI,tokenb:`${l.value.token_b.symbol}`,numb:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":`+ ${Pe(l.value.feeOwedB,l.value.token_b.decimals)}`,logob:Q(l.value.feeOwedB,l.value.token_b.decimals)==0?"":o.value.tokensObj&&l.value&&l.value.token_b.address&&o.value.tokensObj[l.value.token_b.address]&&o.value.tokensObj[l.value.token_b.address].logoURI}},mo=await W.value.setTransations(vo);console.log("9999transitionStatusFees",io,mo)}io&&Number(Y.value)==100&&ue.value=="authenticated"&&be.value&&(await X.subscribePosition({pool_address:l.value.poolAddress,position_index:l.value.index},l.value.nftHash,!1),T()),io&&(i.value="",s.value="",setTimeout(()=>{n.emit("getDetails")},3e3),setTimeout(()=>{n.emit("getDetails")},6e3),console.log(Y.value,se.name,k.value,"998===>"),Number(Y.value)==100&&se.name=="new-position-detail"&&(k.value==="Aptos"?N.push("/position"):N.push("/pool/position")),Y.value=0)}else m(!1),u(!0);P.value=!1}catch(Se){console.log("Remove error",Se),P.value=!1,m(!1),u(!0)}},sFixD:Ue}}});const Wi={class:"new-position-asset"},Hi={class:"add-or-remove"},Xi={class:"liquidity-action-tab"},Gi=a("div",{class:"remove tab-active"},"Remove",-1),zi={class:"card-item"},Yi={key:0,class:"assets-card-mask"},Ji={class:"card-item"},Qi={key:0,class:"assets-card-mask"},Zi={class:"remove-ratio"},Ki=a("div",{class:"remove-ratio-title"},"Amount",-1),Vi={class:"remove-ratio-select"},xi={key:0,class:"ratio"},ea={key:1,class:"ratio"},oa={class:"ratio-list"},na=["onClick"];function ta(e,n,i,s,R,C){const O=co,v=on,o=uo;return $(),M("div",Wi,[a("div",Hi,[a("div",Xi,[a("div",{class:"increase",onClick:n[0]||(n[0]=c=>e.poolStore.setPositionDetailCurrentTab("increase"))}," Increase "),Gi]),a("div",{class:go(e.needReverse?"card-container reverse":"card-container")},[a("div",zi,[de(O,{modelValue:e.fromCoinAmount,"onUpdate:modelValue":n[1]||(n[1]=c=>e.fromCoinAmount=c),"input-value":e.fromCoinAmount,"coin-symbol":e.fromCoin?e.fromCoin.symbol:null,"coin-name":e.fromCoin?e.fromCoin.name:null,balance:e.fromCoinBlance,"coin-icon":e.fromCoin?e.fromCoin.logoURI:"",address:e.fromCoin?e.fromCoin.address:"","swap-direct":"From","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[2]||(n[2]=c=>e.maxBtnSelect("fromCoin")),onOnHalf:n[3]||(n[3]=c=>e.halfBtnSelect("fromCoin")),onOnInput:n[4]||(n[4]=c=>{e.fromCoinAmount=c,e.fixedFromCoin=!0,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.fromCoinBlance==0?($(),M("div",Yi)):fe("",!0)]),a("div",Ji,[de(O,{modelValue:e.toCoinAmount,"onUpdate:modelValue":n[5]||(n[5]=c=>e.toCoinAmount=c),"input-value":e.toCoinAmount,"coin-symbol":e.toCoin?e.toCoin.symbol:null,"coin-name":e.toCoin?e.toCoin.name:null,balance:e.toCoinBlance,"swap-direct":"To","coin-icon":e.toCoin?e.toCoin.logoURI:"",address:e.toCoin?e.toCoin.address:"","import-page":"deposit","has-arrow":!1,havehalf:!1,"amount-leabl":"Available",onOnMax:n[6]||(n[6]=c=>e.maxBtnSelect("toCoin")),onOnHalf:n[7]||(n[7]=c=>e.halfBtnSelect("toCoin")),onOnInput:n[8]||(n[8]=c=>{e.toCoinAmount=c,e.fixedFromCoin=!1,e.isSlider=!1})},null,8,["modelValue","input-value","coin-symbol","coin-name","balance","coin-icon","address"]),e.toCoinBlance==0?($(),M("div",Qi)):fe("",!0)])],2),a("div",Zi,[Ki,a("div",Vi,[Number(e.fromCoinBlance)>=Number(e.fromCoinAmount)&&Number(e.toCoinBlance)>=Number(e.toCoinAmount)?($(),M("div",xi,E(e.sliderVal>0&&Number(("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))<.01?"<0.01":("sFixD"in e?e.sFixD:J(Ue))(e.sliderVal,2))+"% ",1)):($(),M("div",ea," -- ")),a("div",oa,[($(!0),M(po,null,ho(e.ratioArr,(c,p)=>($(),M("div",{key:p,class:go(["ratio-item",e.sliderVal==c.value?"ratio-item-active":""]),onClick:()=>{e.isSlider=!0,e.sliderVal=c.value}},E(c.name),11,na))),128))])]),de(v,{value:e.sliderVal,"onUpdate:value":n[9]||(n[9]=c=>e.sliderVal=c)},null,8,["value"])])]),e.wallet.connected?($(),je(o,{key:0,class:"big-btn liquidity-btn",loading:e.actionLoading,disabled:e.addLiquidityBtnDisabled,onClick:e.toRemove},{default:Ye(()=>[a("span",null,E(e.addLiquidityBtnText),1)]),_:1},8,["loading","disabled","onClick"])):($(),je(o,{key:1,class:"big-btn",onClick:n[10]||(n[10]=c=>e.wallet.connected?e.isShowLiquidityModal=!0:e.wallet.setIsShowWalletModal(!0))},{default:Ye(()=>[a("span",null,E(e.$t("button.connectWallet")),1)]),_:1}))])}const ia=Ze(Fi,[["render",ta]]),aa=Qe({props:{positionInfo:{type:Object,default:()=>({})}},setup(e){const n=Uo(),i=_(()=>n),s=_(()=>i.value.status),R=Je();_e(()=>[i.value.targetGroups],p=>{console.log("0327###watch###newTargetGoups###",p)},{immediate:!0});const C=B(!1);_e(()=>s.value,p=>{p=="authenticated",C.value=!1},{immediate:!0});const O=B(!1),v=async()=>{O.value=!O.value,console.log(O.value,"===>checked.value");const p={pool_address:e.positionInfo.poolAddress,position_index:e.positionInfo.index},d=e.positionInfo.nftHash;console.log("0529###changeSwitch###positionInfo####",e.positionInfo);try{await n.subscribePosition(p,d,O.value)}catch{O.value=!O.value}},o=p=>{const d=p.sources;O.value=d.some(k=>JSON.parse(k.blockchainAddress).pool_address==e.positionInfo.poolAddress&&Number(JSON.parse(k.blockchainAddress).position_index)==Number(e.positionInfo.index))},c=ro();return console.log(c.currentRoute.value.query.token,"===>rouyter"),_e(()=>[i.value.sourceGroups,e.positionInfo],([p,d])=>{var k,W,ne;console.log(p,"==>newSourceGroups169"),console.log(d,"===>positionInfo170"),O.value=!1,p&&p.length>0&&p[0]&&d&&!he(d)&&((ne=(W=(k=c==null?void 0:c.currentRoute)==null?void 0:k.value)==null?void 0:W.query)==null?void 0:ne.token)==(d==null?void 0:d.name)&&(console.log("触发"),console.log(p,"==>newSourceGroups"),console.log(d,"===>positionInfo"),o(p[0]))},{immediate:!0,deep:!0}),{importIcon:eo,isShowSetUp:C,changeSwitch:v,checked:O,notifiStatus:s,store:R}}});const sa=e=>(wo("data-v-8f838b7e"),e=e(),_o(),e),la={class:"range-alerts"},ra={class:"range-alerts-top"},ua={class:"title"},da=sa(()=>a("div",{class:"title-all"},[a("span",{class:"Range"},"Range Alerts")],-1)),ca={key:1,class:"h5-switch-box"},va={class:"range-alerts-bottom"},ma={key:0,class:"pc-switch-box"};function fa(e,n,i,s,R,C){const O=uo,v=tn;return $(),M("div",la,[a("div",ra,[a("div",ua,[da,e.isShowSetUp||e.notifiStatus!=="authenticated"?($(),je(O,{key:0,class:"range-alerts-button",onClick:n[0]||(n[0]=nn(o=>e.store.setIsShowNotifi(!0),["stop"]))},{default:Ye(()=>[Ae(" Set up ")]),_:1})):fe("",!0),!e.isShowSetUp&&e.notifiStatus=="authenticated"?($(),M("div",ca,[de(v,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])]),a("div",va,[Ae(" Receive alerts via Telegram, SMS, or email when this position goes out of range. "),!e.isShowSetUp&&e.notifiStatus=="authenticated"?($(),M("div",ma,[de(v,{class:"range-alerts-switch",checked:e.checked,disabled:e.notifiStatus!=="authenticated",onChange:e.changeSwitch},null,8,["checked","disabled","onChange"])])):fe("",!0)])])}const Go=Ze(aa,[["render",fa],["__scopeId","data-v-8f838b7e"]]),pa=Qe({components:{NewPositionTitle:No,NewPositionInfo:Ho,NewPositionLiquidity:Xo,NewPositionAssetAdd:yo,NewPositionAssetRemove:yo,NewPositionNotifi:Go,FarmsPositionDetail:jo},setup(){const e=B(),n=B(),i=B(),s=Je(),R=_(()=>s),C=_(()=>R.value.chainName),O=no(),v=_(()=>O),o=dn(),c=ro();Bo(()=>{e.value={},O.setPositionActionAmount({fromCoinAmount:"",toCoinAmount:""}),v.value.setCurrentPositionLoading(!0),o.getFarmsPoolList()});const p=async()=>{v.value.setCurrentPositionLoading(!0);const r=c.currentRoute.value.query.token||"",f=c.currentRoute.value.query.collect||"",L=c.currentRoute.value.query.address||"",t=c.currentRoute.value.query.pos||"",g=c.currentRoute.value.query.id||"",A=c.currentRoute.value.query.positionSource||"",y=c.currentRoute.value.query.position_nft_id||"";C.value==="Aptos"?r&&f&&L&&v.value.setCurrentPositionInfo(L,f,r,C.value):(console.log("0414###position-detail###id#####",g),console.log("0414###position-detail###name#####",r),console.log("0414###position-detail###pool_address#####",L),console.log("0414###position-detail###pos#####",t),r&&L&&t?v.value.setCurrentPositionInfo(L,f,r,C.value,t):g?v.value.setCurrentPositionInfo("","","",C.value,g):v.value.setCurrentPositionInfo("","","",C.value,y,A))};_e(()=>v.value.poolConfigObj,r=>{r&&!he(r)&&p()},{immediate:!0});const d=_(()=>v.value.currentPositionLoading),k=_(()=>{var f,L,t;const r=((t=(L=(f=c==null?void 0:c.currentRoute)==null?void 0:f.value)==null?void 0:L.query)==null?void 0:t.address)||"";return r&&v.value.addressLpTokens&&!he(v.value.addressLpTokens)&&v.value.addressLpTokens[r]?v.value.addressLpTokens[r]:null});_e(()=>k.value,(r,f)=>{r&&!he(r)&&(e.value=r),r&&!he(r)&&r.current_sqrt_price!==(f==null?void 0:f.current_sqrt_price)&&p()},{immediate:!0});const W=lo();_e(()=>[v.value.currentPositionInfo,C.value],([r,f])=>{var L;f=="Aptos"&&r?(e.value=r,n.value=e.value.token_a,i.value=e.value.token_b):f=="Sui"&&r&&(r==null?void 0:r.nftHash)==((L=W==null?void 0:W.query)==null?void 0:L.pos)&&(console.log(r,"==>newVal"),e.value=r,n.value=e.value.token_a,i.value=e.value.token_b)},{immediate:!0});const ne=_(()=>v.value.positionDetailCurrentTab),ee=so();return _(()=>ee),_(()=>R.value.theme),console.log(JSON.stringify(e.value),"===>positionInfo.value135"),{positionInfo:e,fromCoin:n,toCoin:i,getDetails:p,currentPositionLoading:d,positionDetailCurrentTab:ne,clickRefresh:()=>{p()},chainName:C}}});const ha={class:"new-position-detail"},ga={class:"new-position-content"},ba={class:"left"},ka={class:"right"},ya={class:"loading-global"};function wa(e,n,i,s,R,C){const O=No,v=Ho,o=Xo,c=yo,p=ia,d=jo,k=Go,W=an;return $(),M("div",ha,[de(O,{onClickRefresh:e.clickRefresh},null,8,["onClickRefresh"]),a("div",ga,[a("div",ba,[de(v),de(o,{class:"pc-module",onGetDetails:e.getDetails},null,8,["onGetDetails"])]),a("div",ka,[e.positionDetailCurrentTab=="increase"?($(),je(c,{key:0,onGetDetails:e.getDetails},null,8,["onGetDetails"])):($(),je(p,{key:1,onGetDetails:e.getDetails},null,8,["onGetDetails"])),de(o,{class:"h5-module",onGetDetails:e.getDetails},null,8,["onGetDetails"]),de(d),e.positionInfo&&e.positionInfo.minPrice!=="0"&&e.positionInfo.maxPrice!=="∞"&&e.chainName=="Sui"?($(),je(k,{key:2,"position-info":e.positionInfo},null,8,["position-info"])):fe("",!0)])]),qe(a("div",ya,[de(W)],512),[[Lo,e.currentPositionLoading]])])}const Za=Ze(pa,[["render",wa],["__scopeId","data-v-c68b1b70"]]);export{Za as default};
