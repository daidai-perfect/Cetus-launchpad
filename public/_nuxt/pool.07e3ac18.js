var Ob=Object.defineProperty;var Rb=(t,e,n)=>e in t?Ob(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var xe=(t,e,n)=>(Rb(t,typeof e!="symbol"?e+"":e,n),n);import{ab as U0,ac as $b,ad as jl,a6 as Dc,l as Go,a4 as ea,C as Ge,a8 as Rn,R as M0,a7 as Ub}from"./entry.4c007e3b.js";import{n as Es,r as Mb,e as Sd,c as ke,b as Db,a as ph,u as D0,d as q0,s as f,f as Ce,o as I,g as he,l as re,h as qi,i as Mt,j as Re,k as le,m as G,p as cn,q as Li,t as uu,v as Z,w as wt,x as Ut,y as un,z as L0,A as rr,B as N0,C as j0,D as Wo,T as qb,E as Xp}from"./sha256.090e129e.js";import{D as ie}from"./decimal.0bdeb344.js";var fh={};(function(t){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.bytes=t.stringToBytes=t.str=t.bytesToString=t.hex=t.utf8=t.bech32m=t.bech32=t.base58check=t.base58xmr=t.base58xrp=t.base58flickr=t.base58=t.base64urlnopad=t.base64url=t.base64=t.base32crockford=t.base32hex=t.base32=t.base16=t.utils=t.assertNumber=void 0;function e(B){if(!Number.isSafeInteger(B))throw new Error(`Wrong integer: ${B}`)}t.assertNumber=e;function n(...B){const O=(_,A)=>C=>_(A(C)),v=Array.from(B).reverse().reduce((_,A)=>_?O(_,A.encode):A.encode,void 0),h=B.reduce((_,A)=>_?O(_,A.decode):A.decode,void 0);return{encode:v,decode:h}}function i(B){return{encode:O=>{if(!Array.isArray(O)||O.length&&typeof O[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return O.map(v=>{if(v<0||v>=B.length)throw new Error(`Digit index outside alphabet: ${v} (alphabet: ${B.length})`);return B[v]})},decode:O=>{if(!Array.isArray(O)||O.length&&typeof O[0]!="string")throw new Error("alphabet.decode input should be array of strings");return O.map(v=>{if(typeof v!="string")throw new Error(`alphabet.decode: not string element=${v}`);const h=B.indexOf(v);if(h===-1)throw new Error(`Unknown letter: "${v}". Allowed: ${B}`);return h})}}}function s(B=""){if(typeof B!="string")throw new Error("join separator should be string");return{encode:O=>{if(!Array.isArray(O)||O.length&&typeof O[0]!="string")throw new Error("join.encode input should be array of strings");for(let v of O)if(typeof v!="string")throw new Error(`join.encode: non-string input=${v}`);return O.join(B)},decode:O=>{if(typeof O!="string")throw new Error("join.decode input should be string");return O.split(B)}}}function o(B,O="="){if(typeof O!="string")throw new Error("padding chr should be string");return{encode(v){if(!Array.isArray(v)||v.length&&typeof v[0]!="string")throw new Error("padding.encode input should be array of strings");for(let h of v)if(typeof h!="string")throw new Error(`padding.encode: non-string input=${h}`);for(;v.length*B%8;)v.push(O);return v},decode(v){if(!Array.isArray(v)||v.length&&typeof v[0]!="string")throw new Error("padding.encode input should be array of strings");for(let _ of v)if(typeof _!="string")throw new Error(`padding.decode: non-string input=${_}`);let h=v.length;if(h*B%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;h>0&&v[h-1]===O;h--)if(!((h-1)*B%8))throw new Error("Invalid padding: string has too much padding");return v.slice(0,h)}}}function r(B){if(typeof B!="function")throw new Error("normalize fn should be function");return{encode:O=>O,decode:O=>B(O)}}function a(B,O,v){if(O<2)throw new Error(`convertRadix: wrong from=${O}, base cannot be less than 2`);if(v<2)throw new Error(`convertRadix: wrong to=${v}, base cannot be less than 2`);if(!Array.isArray(B))throw new Error("convertRadix: data should be array");if(!B.length)return[];let h=0;const _=[],A=Array.from(B);for(A.forEach(C=>{if(C<0||C>=O)throw new Error(`Wrong integer: ${C}`)});;){let C=0,M=!0;for(let N=h;N<A.length;N++){const F=A[N],x=O*C+F;if(!Number.isSafeInteger(x)||O*C/O!==C||x-F!==O*C)throw new Error("convertRadix: carry overflow");C=x%v;const m=Math.floor(x/v);if(A[N]=m,!Number.isSafeInteger(m)||m*v+C!==x)throw new Error("convertRadix: carry overflow");if(M)m?M=!1:h=N;else continue}if(_.push(C),M)break}for(let C=0;C<B.length-1&&B[C]===0;C++)_.push(0);return _.reverse()}const c=(B,O)=>O?c(O,B%O):B,u=(B,O)=>B+(O-c(B,O));function l(B,O,v,h){if(!Array.isArray(B))throw new Error("convertRadix2: data should be array");if(O<=0||O>32)throw new Error(`convertRadix2: wrong from=${O}`);if(v<=0||v>32)throw new Error(`convertRadix2: wrong to=${v}`);if(u(O,v)>32)throw new Error(`convertRadix2: carry overflow from=${O} to=${v} carryBits=${u(O,v)}`);let _=0,A=0;const C=2**v-1,M=[];for(const N of B){if(N>=2**O)throw new Error(`convertRadix2: invalid data word=${N} from=${O}`);if(_=_<<O|N,A+O>32)throw new Error(`convertRadix2: carry overflow pos=${A} from=${O}`);for(A+=O;A>=v;A-=v)M.push((_>>A-v&C)>>>0);_&=2**A-1}if(_=_<<v-A&C,!h&&A>=O)throw new Error("Excess padding");if(!h&&_)throw new Error(`Non-zero padding: ${_}`);return h&&A>0&&M.push(_>>>0),M}function d(B){return{encode:O=>{if(!(O instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from(O),2**8,B)},decode:O=>{if(!Array.isArray(O)||O.length&&typeof O[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a(O,B,2**8))}}}function p(B,O=!1){if(B<=0||B>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,B)>32||u(B,8)>32)throw new Error("radix2: carry overflow");return{encode:v=>{if(!(v instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return l(Array.from(v),8,B,!O)},decode:v=>{if(!Array.isArray(v)||v.length&&typeof v[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(l(v,B,8,O))}}}function g(B){if(typeof B!="function")throw new Error("unsafeWrapper fn should be function");return function(...O){try{return B.apply(null,O)}catch{}}}function b(B,O){if(typeof O!="function")throw new Error("checksum fn should be function");return{encode(v){if(!(v instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const h=O(v).slice(0,B),_=new Uint8Array(v.length+B);return _.set(v),_.set(h,v.length),_},decode(v){if(!(v instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const h=v.slice(0,-B),_=O(h).slice(0,B),A=v.slice(-B);for(let C=0;C<B;C++)if(_[C]!==A[C])throw new Error("Invalid checksum");return h}}}t.utils={alphabet:i,chain:n,checksum:b,radix:d,radix2:p,join:s,padding:o},t.base16=n(p(4),i("0123456789ABCDEF"),s("")),t.base32=n(p(5),i("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),o(5),s("")),t.base32hex=n(p(5),i("0123456789ABCDEFGHIJKLMNOPQRSTUV"),o(5),s("")),t.base32crockford=n(p(5),i("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),s(""),r(B=>B.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),t.base64=n(p(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),o(6),s("")),t.base64url=n(p(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),o(6),s("")),t.base64urlnopad=n(p(6),i("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),s(""));const w=B=>n(d(58),i(B),s(""));t.base58=w("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),t.base58flickr=w("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),t.base58xrp=w("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const T=[0,2,3,5,6,7,9,10,11];t.base58xmr={encode(B){let O="";for(let v=0;v<B.length;v+=8){const h=B.subarray(v,v+8);O+=t.base58.encode(h).padStart(T[h.length],"1")}return O},decode(B){let O=[];for(let v=0;v<B.length;v+=11){const h=B.slice(v,v+11),_=T.indexOf(h.length),A=t.base58.decode(h);for(let C=0;C<A.length-_;C++)if(A[C]!==0)throw new Error("base58xmr: wrong padding");O=O.concat(Array.from(A.slice(A.length-_)))}return Uint8Array.from(O)}};const E=B=>n(b(4,O=>B(B(O))),t.base58);t.base58check=E;const P=n(i("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),s("")),k=[996825010,642813549,513874426,1027748829,705979059];function S(B){const O=B>>25;let v=(B&33554431)<<5;for(let h=0;h<k.length;h++)(O>>h&1)===1&&(v^=k[h]);return v}function $(B,O,v=1){const h=B.length;let _=1;for(let A=0;A<h;A++){const C=B.charCodeAt(A);if(C<33||C>126)throw new Error(`Invalid prefix (${B})`);_=S(_)^C>>5}_=S(_);for(let A=0;A<h;A++)_=S(_)^B.charCodeAt(A)&31;for(let A of O)_=S(_)^A;for(let A=0;A<6;A++)_=S(_);return _^=v,P.encode(l([_%2**30],30,5,!1))}function H(B){const O=B==="bech32"?1:734539939,v=p(5),h=v.decode,_=v.encode,A=g(h);function C(x,m,R=90){if(typeof x!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof x}`);if(!Array.isArray(m)||m.length&&typeof m[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof m}`);const ye=x.length+7+m.length;if(R!==!1&&ye>R)throw new TypeError(`Length ${ye} exceeds limit ${R}`);const ce=x.toLowerCase(),ue=$(ce,m,O);return`${ce}1${P.encode(m)}${ue}`}function M(x,m=90){if(typeof x!="string")throw new Error(`bech32.decode input should be string, not ${typeof x}`);if(x.length<8||m!==!1&&x.length>m)throw new TypeError(`Wrong string length: ${x.length} (${x}). Expected (8..${m})`);const R=x.toLowerCase();if(x!==R&&x!==x.toUpperCase())throw new Error("String must be lowercase or uppercase");x=R;const ye=x.lastIndexOf("1");if(ye===0||ye===-1)throw new Error('Letter "1" must be present between prefix and data only');const ce=x.slice(0,ye),ue=x.slice(ye+1);if(ue.length<6)throw new Error("Data must be at least 6 characters long");const Ne=P.decode(ue).slice(0,-6),Le=$(ce,Ne,O);if(!ue.endsWith(Le))throw new Error(`Invalid checksum in ${x}: expected "${Le}"`);return{prefix:ce,words:Ne}}const N=g(M);function F(x){const{prefix:m,words:R}=M(x,!1);return{prefix:m,words:R,bytes:h(R)}}return{encode:C,decode:M,decodeToBytes:F,decodeUnsafe:N,fromWords:h,fromWordsUnsafe:A,toWords:_}}t.bech32=H("bech32"),t.bech32m=H("bech32m"),t.utf8={encode:B=>new TextDecoder().decode(B),decode:B=>new TextEncoder().encode(B)},t.hex=n(p(4),i("0123456789abcdef"),s(""),r(B=>{if(typeof B!="string"||B.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof B} with length ${B.length}`);return B.toLowerCase()}));const V={utf8:t.utf8,hex:t.hex,base16:t.base16,base32:t.base32,base64:t.base64,base64url:t.base64url,base58:t.base58,base58xmr:t.base58xmr},z="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",X=(B,O)=>{if(typeof B!="string"||!V.hasOwnProperty(B))throw new TypeError(z);if(!(O instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return V[B].encode(O)};t.bytesToString=X,t.str=t.bytesToString;const L=(B,O)=>{if(!V.hasOwnProperty(B))throw new TypeError(z);if(typeof O!="string")throw new TypeError("stringToBytes() expects string");return V[B].decode(O)};t.stringToBytes=L,t.bytes=t.stringToBytes})(fh);var zn={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});rn.output=rn.exists=rn.hash=rn.bytes=rn.bool=rn.number=void 0;function qc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}rn.number=qc;function F0(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}rn.bool=F0;function gh(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}rn.bytes=gh;function z0(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");qc(t.outputLen),qc(t.blockLen)}rn.hash=z0;function H0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}rn.exists=H0;function K0(t,e){gh(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}rn.output=K0;const Lb={number:qc,bool:F0,bytes:gh,hash:z0,exists:H0,output:K0};rn.default=Lb;var ar={},G0={},uo={},lu={};Object.defineProperty(lu,"__esModule",{value:!0});lu.crypto=void 0;lu.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=t.wrapConstructorWithOpts=t.wrapConstructor=t.checkOpts=t.Hash=t.concatBytes=t.toBytes=t.utf8ToBytes=t.asyncLoop=t.nextTick=t.hexToBytes=t.bytesToHex=t.isLE=t.rotr=t.createView=t.u32=t.u8=void 0;const e=lu,n=S=>new Uint8Array(S.buffer,S.byteOffset,S.byteLength);t.u8=n;const i=S=>new Uint32Array(S.buffer,S.byteOffset,Math.floor(S.byteLength/4));t.u32=i;const s=S=>new DataView(S.buffer,S.byteOffset,S.byteLength);t.createView=s;const o=(S,$)=>S<<32-$|S>>>$;if(t.rotr=o,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(S,$)=>$.toString(16).padStart(2,"0"));function a(S){if(!(S instanceof Uint8Array))throw new Error("Uint8Array expected");let $="";for(let H=0;H<S.length;H++)$+=r[S[H]];return $}t.bytesToHex=a;function c(S){if(typeof S!="string")throw new TypeError("hexToBytes: expected string, got "+typeof S);if(S.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const $=new Uint8Array(S.length/2);for(let H=0;H<$.length;H++){const V=H*2,z=S.slice(V,V+2),X=Number.parseInt(z,16);if(Number.isNaN(X)||X<0)throw new Error("Invalid byte sequence");$[H]=X}return $}t.hexToBytes=c;const u=async()=>{};t.nextTick=u;async function l(S,$,H){let V=Date.now();for(let z=0;z<S;z++){H(z);const X=Date.now()-V;X>=0&&X<$||(await(0,t.nextTick)(),V+=X)}}t.asyncLoop=l;function d(S){if(typeof S!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof S}`);return new TextEncoder().encode(S)}t.utf8ToBytes=d;function p(S){if(typeof S=="string"&&(S=d(S)),!(S instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof S})`);return S}t.toBytes=p;function g(...S){if(!S.every(V=>V instanceof Uint8Array))throw new Error("Uint8Array list expected");if(S.length===1)return S[0];const $=S.reduce((V,z)=>V+z.length,0),H=new Uint8Array($);for(let V=0,z=0;V<S.length;V++){const X=S[V];H.set(X,z),z+=X.length}return H}t.concatBytes=g;class b{clone(){return this._cloneInto()}}t.Hash=b;const w=S=>Object.prototype.toString.call(S)==="[object Object]"&&S.constructor===Object;function T(S,$){if($!==void 0&&(typeof $!="object"||!w($)))throw new TypeError("Options should be object or undefined");return Object.assign(S,$)}t.checkOpts=T;function E(S){const $=V=>S().update(p(V)).digest(),H=S();return $.outputLen=H.outputLen,$.blockLen=H.blockLen,$.create=()=>S(),$}t.wrapConstructor=E;function P(S){const $=(V,z)=>S(z).update(p(V)).digest(),H=S({});return $.outputLen=H.outputLen,$.blockLen=H.blockLen,$.create=V=>S(V),$}t.wrapConstructorWithOpts=P;function k(S=32){if(e.crypto.web)return e.crypto.web.getRandomValues(new Uint8Array(S));if(e.crypto.node)return new Uint8Array(e.crypto.node.randomBytes(S).buffer);throw new Error("The environment doesn't have randomBytes function")}t.randomBytes=k})(uo);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=void 0;const e=rn,n=uo;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,e.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return e.default.exists(this),this.iHash.update(r),this}digestInto(r){e.default.exists(this),e.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:p}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=p,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(o,r,a)=>new i(o,r).update(a).digest();t.hmac=s,t.hmac.create=(o,r)=>new i(o,r)})(G0);Object.defineProperty(ar,"__esModule",{value:!0});ar.pbkdf2Async=ar.pbkdf2=void 0;const za=rn,Nb=G0,Vo=uo;function W0(t,e,n,i){za.default.hash(t);const s=(0,Vo.checkOpts)({dkLen:32,asyncTick:10},i),{c:o,dkLen:r,asyncTick:a}=s;if(za.default.number(o),za.default.number(r),za.default.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,Vo.toBytes)(e),u=(0,Vo.toBytes)(n),l=new Uint8Array(r),d=Nb.hmac.create(t,c),p=d._cloneInto().update(u);return{c:o,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:p}}function V0(t,e,n,i,s){return t.destroy(),e.destroy(),i&&i.destroy(),s.fill(0),n}function jb(t,e,n,i){const{c:s,dkLen:o,DK:r,PRF:a,PRFSalt:c}=W0(t,e,n,i);let u;const l=new Uint8Array(4),d=(0,Vo.createView)(l),p=new Uint8Array(a.outputLen);for(let g=1,b=0;b<o;g++,b+=a.outputLen){const w=r.subarray(b,b+a.outputLen);d.setInt32(0,g,!1),(u=c._cloneInto(u)).update(l).digestInto(p),w.set(p.subarray(0,w.length));for(let T=1;T<s;T++){a._cloneInto(u).update(p).digestInto(p);for(let E=0;E<w.length;E++)w[E]^=p[E]}}return V0(a,c,r,u,p)}ar.pbkdf2=jb;async function Fb(t,e,n,i){const{c:s,dkLen:o,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=W0(t,e,n,i);let l;const d=new Uint8Array(4),p=(0,Vo.createView)(d),g=new Uint8Array(c.outputLen);for(let b=1,w=0;w<o;b++,w+=c.outputLen){const T=a.subarray(w,w+c.outputLen);p.setInt32(0,b,!1),(l=u._cloneInto(l)).update(d).digestInto(g),T.set(g.subarray(0,T.length)),await(0,Vo.asyncLoop)(s-1,r,E=>{c._cloneInto(l).update(g).digestInto(g);for(let P=0;P<T.length;P++)T[P]^=g[P]})}return V0(c,u,a,l,g)}ar.pbkdf2Async=Fb;var cr={},ba={};Object.defineProperty(ba,"__esModule",{value:!0});ba.SHA2=void 0;const Fl=rn,Dr=uo;function zb(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}let Hb=class extends Dr.Hash{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,Dr.createView)(this.buffer)}update(e){Fl.default.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=(0,Dr.toBytes)(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=(0,Dr.createView)(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Fl.default.exists(this),Fl.default.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let d=r;d<s;d++)n[d]=0;zb(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=(0,Dr.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}};ba.SHA2=Hb;Object.defineProperty(cr,"__esModule",{value:!0});cr.sha224=cr.sha256=void 0;const Kb=ba,Yn=uo,Gb=(t,e,n)=>t&e^~t&n,Wb=(t,e,n)=>t&e^t&n^e&n,Vb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ts=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ns=new Uint32Array(64);let X0=class extends Kb.SHA2{constructor(){super(64,32,8,!1),this.A=ts[0]|0,this.B=ts[1]|0,this.C=ts[2]|0,this.D=ts[3]|0,this.E=ts[4]|0,this.F=ts[5]|0,this.G=ts[6]|0,this.H=ts[7]|0}get(){const{A:e,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[e,n,i,s,o,r,a,c]}set(e,n,i,s,o,r,a,c){this.A=e|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)ns[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const p=ns[d-15],g=ns[d-2],b=(0,Yn.rotr)(p,7)^(0,Yn.rotr)(p,18)^p>>>3,w=(0,Yn.rotr)(g,17)^(0,Yn.rotr)(g,19)^g>>>10;ns[d]=w+ns[d-7]+b+ns[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const p=(0,Yn.rotr)(a,6)^(0,Yn.rotr)(a,11)^(0,Yn.rotr)(a,25),g=l+p+Gb(a,c,u)+Vb[d]+ns[d]|0,w=((0,Yn.rotr)(i,2)^(0,Yn.rotr)(i,13)^(0,Yn.rotr)(i,22))+Wb(i,s,o)|0;l=u,u=c,c=a,a=r+g|0,r=o,o=s,s=i,i=g+w|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){ns.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Xb=class extends X0{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};cr.sha256=(0,Yn.wrapConstructor)(()=>new X0);cr.sha224=(0,Yn.wrapConstructor)(()=>new Xb);var ai={},J0={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.add=t.toBig=t.split=t.fromBig=void 0;const e=BigInt(2**32-1),n=BigInt(32);function i(L,B=!1){return B?{h:Number(L&e),l:Number(L>>n&e)}:{h:Number(L>>n&e)|0,l:Number(L&e)|0}}t.fromBig=i;function s(L,B=!1){let O=new Uint32Array(L.length),v=new Uint32Array(L.length);for(let h=0;h<L.length;h++){const{h:_,l:A}=i(L[h],B);[O[h],v[h]]=[_,A]}return[O,v]}t.split=s;const o=(L,B)=>BigInt(L>>>0)<<n|BigInt(B>>>0);t.toBig=o;const r=(L,B,O)=>L>>>O,a=(L,B,O)=>L<<32-O|B>>>O,c=(L,B,O)=>L>>>O|B<<32-O,u=(L,B,O)=>L<<32-O|B>>>O,l=(L,B,O)=>L<<64-O|B>>>O-32,d=(L,B,O)=>L>>>O-32|B<<64-O,p=(L,B)=>B,g=(L,B)=>L,b=(L,B,O)=>L<<O|B>>>32-O,w=(L,B,O)=>B<<O|L>>>32-O,T=(L,B,O)=>B<<O-32|L>>>64-O,E=(L,B,O)=>L<<O-32|B>>>64-O;function P(L,B,O,v){const h=(B>>>0)+(v>>>0);return{h:L+O+(h/2**32|0)|0,l:h|0}}t.add=P;const k=(L,B,O)=>(L>>>0)+(B>>>0)+(O>>>0),S=(L,B,O,v)=>B+O+v+(L/2**32|0)|0,$=(L,B,O,v)=>(L>>>0)+(B>>>0)+(O>>>0)+(v>>>0),H=(L,B,O,v,h)=>B+O+v+h+(L/2**32|0)|0,V=(L,B,O,v,h)=>(L>>>0)+(B>>>0)+(O>>>0)+(v>>>0)+(h>>>0),z=(L,B,O,v,h,_)=>B+O+v+h+_+(L/2**32|0)|0,X={fromBig:i,split:s,toBig:t.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:p,rotr32L:g,rotlSH:b,rotlSL:w,rotlBH:T,rotlBL:E,add:P,add3L:k,add3H:S,add4L:$,add4H:H,add5H:z,add5L:V};t.default=X})(J0);Object.defineProperty(ai,"__esModule",{value:!0});ai.sha384=ai.sha512_256=ai.sha512_224=ai.sha512=ai.SHA512=void 0;const Jb=ba,ot=J0,du=uo,[Zb,Yb]=ot.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),is=new Uint32Array(80),ss=new Uint32Array(80);let va=class extends Jb.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:p,Gh:g,Gl:b,Hh:w,Hl:T}=this;return[e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T]}set(e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=p|0,this.Gh=g|0,this.Gl=b|0,this.Hh=w|0,this.Hl=T|0}process(e,n){for(let k=0;k<16;k++,n+=4)is[k]=e.getUint32(n),ss[k]=e.getUint32(n+=4);for(let k=16;k<80;k++){const S=is[k-15]|0,$=ss[k-15]|0,H=ot.default.rotrSH(S,$,1)^ot.default.rotrSH(S,$,8)^ot.default.shrSH(S,$,7),V=ot.default.rotrSL(S,$,1)^ot.default.rotrSL(S,$,8)^ot.default.shrSL(S,$,7),z=is[k-2]|0,X=ss[k-2]|0,L=ot.default.rotrSH(z,X,19)^ot.default.rotrBH(z,X,61)^ot.default.shrSH(z,X,6),B=ot.default.rotrSL(z,X,19)^ot.default.rotrBL(z,X,61)^ot.default.shrSL(z,X,6),O=ot.default.add4L(V,B,ss[k-7],ss[k-16]),v=ot.default.add4H(O,H,L,is[k-7],is[k-16]);is[k]=v|0,ss[k]=O|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:p,Fh:g,Fl:b,Gh:w,Gl:T,Hh:E,Hl:P}=this;for(let k=0;k<80;k++){const S=ot.default.rotrSH(d,p,14)^ot.default.rotrSH(d,p,18)^ot.default.rotrBH(d,p,41),$=ot.default.rotrSL(d,p,14)^ot.default.rotrSL(d,p,18)^ot.default.rotrBL(d,p,41),H=d&g^~d&w,V=p&b^~p&T,z=ot.default.add5L(P,$,V,Yb[k],ss[k]),X=ot.default.add5H(z,E,S,H,Zb[k],is[k]),L=z|0,B=ot.default.rotrSH(i,s,28)^ot.default.rotrBH(i,s,34)^ot.default.rotrBH(i,s,39),O=ot.default.rotrSL(i,s,28)^ot.default.rotrBL(i,s,34)^ot.default.rotrBL(i,s,39),v=i&o^i&a^o&a,h=s&r^s&c^r&c;E=w|0,P=T|0,w=g|0,T=b|0,g=d|0,b=p|0,{h:d,l:p}=ot.default.add(u|0,l|0,X|0,L|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const _=ot.default.add3L(L,O,h);i=ot.default.add3H(_,X,B,v),s=_|0}({h:i,l:s}=ot.default.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=ot.default.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=ot.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=ot.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:p}=ot.default.add(this.Eh|0,this.El|0,d|0,p|0),{h:g,l:b}=ot.default.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:w,l:T}=ot.default.add(this.Gh|0,this.Gl|0,w|0,T|0),{h:E,l:P}=ot.default.add(this.Hh|0,this.Hl|0,E|0,P|0),this.set(i,s,o,r,a,c,u,l,d,p,g,b,w,T,E,P)}roundClean(){is.fill(0),ss.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ai.SHA512=va;let Qb=class extends va{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},ev=class extends va{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},tv=class extends va{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};ai.sha512=(0,du.wrapConstructor)(()=>new va);ai.sha512_224=(0,du.wrapConstructor)(()=>new Qb);ai.sha512_256=(0,du.wrapConstructor)(()=>new ev);ai.sha384=(0,du.wrapConstructor)(()=>new tv);Object.defineProperty(zn,"__esModule",{value:!0});var Z0=zn.mnemonicToSeedSync=zn.mnemonicToSeed=zn.validateMnemonic=zn.entropyToMnemonic=zn.mnemonicToEntropy=zn.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const Y0=rn,Q0=ar,nv=cr,eg=ai,iv=uo,Ha=fh,sv=t=>t[0]==="あいこくしん";function tg(t){if(typeof t!="string")throw new TypeError(`Invalid mnemonic type: ${typeof t}`);return t.normalize("NFKD")}function mh(t){const e=tg(t),n=e.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:n}}function ng(t){Y0.default.bytes(t,16,20,24,28,32)}function ov(t,e=128){if(Y0.default.number(e),e%32!==0||e>256)throw new TypeError("Invalid entropy");return og((0,iv.randomBytes)(e/8),t)}zn.generateMnemonic=ov;const rv=t=>{const e=8-t.length/4;return new Uint8Array([(0,nv.sha256)(t)[0]>>e<<e])};function ig(t){if(!Array.isArray(t)||t.length!==2**11||typeof t[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return t.forEach(e=>{if(typeof e!="string")throw new Error(`Wordlist: non-string element: ${e}`)}),Ha.utils.chain(Ha.utils.checksum(1,rv),Ha.utils.radix2(11,!0),Ha.utils.alphabet(t))}function sg(t,e){const{words:n}=mh(t),i=ig(e).decode(n);return ng(i),i}zn.mnemonicToEntropy=sg;function og(t,e){return ng(t),ig(e).encode(t).join(sv(e)?"　":" ")}zn.entropyToMnemonic=og;function av(t,e){try{sg(t,e)}catch{return!1}return!0}zn.validateMnemonic=av;const rg=t=>tg(`mnemonic${t}`);function cv(t,e=""){return(0,Q0.pbkdf2Async)(eg.sha512,mh(t).nfkd,rg(e),{c:2048,dkLen:64})}zn.mnemonicToSeed=cv;function uv(t,e=""){return(0,Q0.pbkdf2)(eg.sha512,mh(t).nfkd,rg(e),{c:2048,dkLen:64})}Z0=zn.mnemonicToSeedSync=uv;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lv=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),zl=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ei=(t,e)=>t<<32-e|t>>>e,dv=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!dv)throw new Error("Non little-endian hardware is not supported");const hv=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ag(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=hv[t[n]];return e}function cg(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const i=n*2,s=t.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function pv(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function Ta(t){if(typeof t=="string"&&(t=pv(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}let _h=class{clone(){return this._cloneInto()}};function Aa(t){const e=i=>t().update(Ta(i)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function fv(t){const e=(i,s)=>t(s).update(Ta(i)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=i=>t(i),e}function xd(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function gv(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function ug(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function mv(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");xd(t.outputLen),xd(t.blockLen)}function _v(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function yv(t,e){ug(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Hn={number:xd,bool:gv,bytes:ug,hash:mv,exists:_v,output:yv};function wv(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}let lg=class extends _h{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=zl(this.buffer)}update(e){Hn.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=Ta(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=zl(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Hn.exists(this),Hn.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let c=r;c<s;c++)n[c]=0;wv(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=zl(e);this.get().forEach((c,u)=>a.setUint32(4*u,c,o))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}};const bv=(t,e,n)=>t&e^~t&n,vv=(t,e,n)=>t&e^t&n^e&n,Tv=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),os=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),rs=new Uint32Array(64);let Av=class extends lg{constructor(){super(64,32,8,!1),this.A=os[0]|0,this.B=os[1]|0,this.C=os[2]|0,this.D=os[3]|0,this.E=os[4]|0,this.F=os[5]|0,this.G=os[6]|0,this.H=os[7]|0}get(){const{A:e,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[e,n,i,s,o,r,a,c]}set(e,n,i,s,o,r,a,c){this.A=e|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)rs[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const p=rs[d-15],g=rs[d-2],b=Ei(p,7)^Ei(p,18)^p>>>3,w=Ei(g,17)^Ei(g,19)^g>>>10;rs[d]=w+rs[d-7]+b+rs[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const p=Ei(a,6)^Ei(a,11)^Ei(a,25),g=l+p+bv(a,c,u)+Tv[d]+rs[d]|0,w=(Ei(i,2)^Ei(i,13)^Ei(i,22))+vv(i,s,o)|0;l=u,u=c,c=a,a=r+g|0,r=o,o=s,s=i,i=g+w|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){rs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const kv=Aa(()=>new Av),Ka=BigInt(2**32-1),Pd=BigInt(32);function dg(t,e=!1){return e?{h:Number(t&Ka),l:Number(t>>Pd&Ka)}:{h:Number(t>>Pd&Ka)|0,l:Number(t&Ka)|0}}function Sv(t,e=!1){let n=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:r}=dg(t[s],e);[n[s],i[s]]=[o,r]}return[n,i]}const xv=(t,e)=>BigInt(t>>>0)<<Pd|BigInt(e>>>0),Pv=(t,e,n)=>t>>>n,Ev=(t,e,n)=>t<<32-n|e>>>n,Cv=(t,e,n)=>t>>>n|e<<32-n,Bv=(t,e,n)=>t<<32-n|e>>>n,Iv=(t,e,n)=>t<<64-n|e>>>n-32,Ov=(t,e,n)=>t>>>n-32|e<<64-n,Rv=(t,e)=>e,$v=(t,e)=>t,Uv=(t,e,n)=>t<<n|e>>>32-n,Mv=(t,e,n)=>e<<n|t>>>32-n,Dv=(t,e,n)=>e<<n-32|t>>>64-n,qv=(t,e,n)=>t<<n-32|e>>>64-n;function Lv(t,e,n,i){const s=(e>>>0)+(i>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Nv=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),jv=(t,e,n,i)=>e+n+i+(t/2**32|0)|0,Fv=(t,e,n,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0),zv=(t,e,n,i,s)=>e+n+i+s+(t/2**32|0)|0,Hv=(t,e,n,i,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0)+(s>>>0),Kv=(t,e,n,i,s,o)=>e+n+i+s+o+(t/2**32|0)|0,Je={fromBig:dg,split:Sv,toBig:xv,shrSH:Pv,shrSL:Ev,rotrSH:Cv,rotrSL:Bv,rotrBH:Iv,rotrBL:Ov,rotr32H:Rv,rotr32L:$v,rotlSH:Uv,rotlSL:Mv,rotlBH:Dv,rotlBL:qv,add:Lv,add3L:Nv,add3H:jv,add4L:Fv,add4H:zv,add5H:Kv,add5L:Hv},[hg,pg,fg]=[[],[],[]],Gv=BigInt(0),qr=BigInt(1),Wv=BigInt(2),Vv=BigInt(7),Xv=BigInt(256),Jv=BigInt(113);for(let t=0,e=qr,n=1,i=0;t<24;t++){[n,i]=[i,(2*n+3*i)%5],hg.push(2*(5*i+n)),pg.push((t+1)*(t+2)/2%64);let s=Gv;for(let o=0;o<7;o++)e=(e<<qr^(e>>Vv)*Jv)%Xv,e&Wv&&(s^=qr<<(qr<<BigInt(o))-qr);fg.push(s)}const[Zv,Yv]=Je.split(fg,!0),Jp=(t,e,n)=>n>32?Je.rotlBH(t,e,n):Je.rotlSH(t,e,n),Zp=(t,e,n)=>n>32?Je.rotlBL(t,e,n):Je.rotlSL(t,e,n);function Qv(t,e=24){const n=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let r=0;r<10;r++)n[r]=t[r]^t[r+10]^t[r+20]^t[r+30]^t[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=Jp(u,l,1)^n[a],p=Zp(u,l,1)^n[a+1];for(let g=0;g<50;g+=10)t[r+g]^=d,t[r+g+1]^=p}let s=t[2],o=t[3];for(let r=0;r<24;r++){const a=pg[r],c=Jp(s,o,a),u=Zp(s,o,a),l=hg[r];s=t[l],o=t[l+1],t[l]=c,t[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=t[r+a];for(let a=0;a<10;a++)t[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Zv[i],t[1]^=Yv[i]}n.fill(0)}let gg=class mg extends _h{constructor(e,n,i,s=!1,o=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Hn.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=lv(this.state)}keccak(){Qv(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Hn.exists(this);const{blockLen:n,state:i}=this;e=Ta(e);const s=e.length;for(let o=0;o<s;){const r=Math.min(n-this.pos,s-o);for(let a=0;a<r;a++)i[this.pos++]^=e[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:i,blockLen:s}=this;e[i]^=n,n&128&&i===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Hn.exists(this,!1),Hn.bytes(e),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,o=e.length;s<o;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,o-s);e.set(n.subarray(this.posOut,this.posOut+r),s),this.posOut+=r,s+=r}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Hn.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Hn.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:i,outputLen:s,rounds:o,enableXOF:r}=this;return e||(e=new mg(n,i,s,r,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=i,e.outputLen=s,e.enableXOF=r,e.destroyed=this.destroyed,e}};const Ds=(t,e,n)=>Aa(()=>new gg(e,t,n));Ds(6,144,224/8);const ur=Ds(6,136,256/8);Ds(6,104,384/8);Ds(6,72,512/8);Ds(1,144,224/8);Ds(1,136,256/8);Ds(1,104,384/8);Ds(1,72,512/8);const _g=(t,e,n)=>fv((i={})=>new gg(e,t,i.dkLen===void 0?n:i.dkLen,!0));_g(31,168,128/8);_g(31,136,256/8);let yg=class extends _h{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Hn.hash(e);const i=Ta(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(i.length>s?e.create().update(i).digest():i);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=e.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}update(e){return Hn.exists(this),this.iHash.update(e),this}digestInto(e){Hn.exists(this),Hn.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:s,destroyed:o,blockLen:r,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=o,e.blockLen=r,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const yh=(t,e,n)=>new yg(t,e).update(n).digest();yh.create=(t,e)=>new yg(t,e);const[e1,t1]=Je.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),as=new Uint32Array(80),cs=new Uint32Array(80);let wh=class extends lg{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:p,Gh:g,Gl:b,Hh:w,Hl:T}=this;return[e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T]}set(e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=p|0,this.Gh=g|0,this.Gl=b|0,this.Hh=w|0,this.Hl=T|0}process(e,n){for(let k=0;k<16;k++,n+=4)as[k]=e.getUint32(n),cs[k]=e.getUint32(n+=4);for(let k=16;k<80;k++){const S=as[k-15]|0,$=cs[k-15]|0,H=Je.rotrSH(S,$,1)^Je.rotrSH(S,$,8)^Je.shrSH(S,$,7),V=Je.rotrSL(S,$,1)^Je.rotrSL(S,$,8)^Je.shrSL(S,$,7),z=as[k-2]|0,X=cs[k-2]|0,L=Je.rotrSH(z,X,19)^Je.rotrBH(z,X,61)^Je.shrSH(z,X,6),B=Je.rotrSL(z,X,19)^Je.rotrBL(z,X,61)^Je.shrSL(z,X,6),O=Je.add4L(V,B,cs[k-7],cs[k-16]),v=Je.add4H(O,H,L,as[k-7],as[k-16]);as[k]=v|0,cs[k]=O|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:p,Fh:g,Fl:b,Gh:w,Gl:T,Hh:E,Hl:P}=this;for(let k=0;k<80;k++){const S=Je.rotrSH(d,p,14)^Je.rotrSH(d,p,18)^Je.rotrBH(d,p,41),$=Je.rotrSL(d,p,14)^Je.rotrSL(d,p,18)^Je.rotrBL(d,p,41),H=d&g^~d&w,V=p&b^~p&T,z=Je.add5L(P,$,V,t1[k],cs[k]),X=Je.add5H(z,E,S,H,e1[k],as[k]),L=z|0,B=Je.rotrSH(i,s,28)^Je.rotrBH(i,s,34)^Je.rotrBH(i,s,39),O=Je.rotrSL(i,s,28)^Je.rotrBL(i,s,34)^Je.rotrBL(i,s,39),v=i&o^i&a^o&a,h=s&r^s&c^r&c;E=w|0,P=T|0,w=g|0,T=b|0,g=d|0,b=p|0,{h:d,l:p}=Je.add(u|0,l|0,X|0,L|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const _=Je.add3L(L,O,h);i=Je.add3H(_,X,B,v),s=_|0}({h:i,l:s}=Je.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Je.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Je.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Je.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:p}=Je.add(this.Eh|0,this.El|0,d|0,p|0),{h:g,l:b}=Je.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:w,l:T}=Je.add(this.Gh|0,this.Gl|0,w|0,T|0),{h:E,l:P}=Je.add(this.Hh|0,this.Hl|0,E|0,P|0),this.set(i,s,o,r,a,c,u,l,d,p,g,b,w,T,E,P)}roundClean(){as.fill(0),cs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},n1=class extends wh{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},i1=class extends wh{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};const wg=Aa(()=>new wh);Aa(()=>new n1);Aa(()=>new i1);var Ed={},s1={get exports(){return Ed},set exports(t){Ed=t}},Lc={},o1={get exports(){return Lc},set exports(t){Lc=t}},bg=function(e,n){return function(){for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];return e.apply(n,s)}},r1=bg,bh=Object.prototype.toString,vh=function(t){return function(e){var n=bh.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function lo(t){return t=t.toLowerCase(),function(n){return vh(n)===t}}function Th(t){return Array.isArray(t)}function Nc(t){return typeof t>"u"}function a1(t){return t!==null&&!Nc(t)&&t.constructor!==null&&!Nc(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var vg=lo("ArrayBuffer");function c1(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&vg(t.buffer),e}function u1(t){return typeof t=="string"}function l1(t){return typeof t=="number"}function Tg(t){return t!==null&&typeof t=="object"}function mc(t){if(vh(t)!=="object")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}var d1=lo("Date"),h1=lo("File"),p1=lo("Blob"),f1=lo("FileList");function Ah(t){return bh.call(t)==="[object Function]"}function g1(t){return Tg(t)&&Ah(t.pipe)}function m1(t){var e="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||bh.call(t)===e||Ah(t.toString)&&t.toString()===e)}var _1=lo("URLSearchParams");function y1(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function w1(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function kh(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),Th(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}function Cd(){var t={};function e(s,o){mc(t[o])&&mc(s)?t[o]=Cd(t[o],s):mc(s)?t[o]=Cd({},s):Th(s)?t[o]=s.slice():t[o]=s}for(var n=0,i=arguments.length;n<i;n++)kh(arguments[n],e);return t}function b1(t,e,n){return kh(e,function(s,o){n&&typeof s=="function"?t[o]=r1(s,n):t[o]=s}),t}function v1(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}function T1(t,e,n,i){t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,n&&Object.assign(t.prototype,n)}function A1(t,e,n){var i,s,o,r={};e=e||{};do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],r[o]||(e[o]=t[o],r[o]=!0);t=Object.getPrototypeOf(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e}function k1(t,e,n){t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;var i=t.indexOf(e,n);return i!==-1&&i===n}function S1(t){if(!t)return null;var e=t.length;if(Nc(e))return null;for(var n=new Array(e);e-- >0;)n[e]=t[e];return n}var x1=function(t){return function(e){return t&&e instanceof t}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),bn={isArray:Th,isArrayBuffer:vg,isBuffer:a1,isFormData:m1,isArrayBufferView:c1,isString:u1,isNumber:l1,isObject:Tg,isPlainObject:mc,isUndefined:Nc,isDate:d1,isFile:h1,isBlob:p1,isFunction:Ah,isStream:g1,isURLSearchParams:_1,isStandardBrowserEnv:w1,forEach:kh,merge:Cd,extend:b1,trim:y1,stripBOM:v1,inherits:T1,toFlatObject:A1,kindOf:vh,kindOfTest:lo,endsWith:k1,toArray:S1,isTypedArray:x1,isFileList:f1},Po=bn;function Yp(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Ag=function(e,n,i){if(!n)return e;var s;if(i)s=i(n);else if(Po.isURLSearchParams(n))s=n.toString();else{var o=[];Po.forEach(n,function(c,u){c===null||typeof c>"u"||(Po.isArray(c)?u=u+"[]":c=[c],Po.forEach(c,function(d){Po.isDate(d)?d=d.toISOString():Po.isObject(d)&&(d=JSON.stringify(d)),o.push(Yp(u)+"="+Yp(d))}))}),s=o.join("&")}if(s){var r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e},P1=bn;function hu(){this.handlers=[]}hu.prototype.use=function(e,n,i){return this.handlers.push({fulfilled:e,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};hu.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};hu.prototype.forEach=function(e){P1.forEach(this.handlers,function(i){i!==null&&e(i)})};var E1=hu,C1=bn,B1=function(e,n){C1.forEach(e,function(s,o){o!==n&&o.toUpperCase()===n.toUpperCase()&&(e[n]=s,delete e[o])})},kg=bn;function lr(t,e,n,i,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s)}kg.inherits(lr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Sg=lr.prototype,xg={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(t){xg[t]={value:t}});Object.defineProperties(lr,xg);Object.defineProperty(Sg,"isAxiosError",{value:!0});lr.from=function(t,e,n,i,s,o){var r=Object.create(Sg);return kg.toFlatObject(t,r,function(c){return c!==Error.prototype}),lr.call(r,t.message,e,n,i,s),r.name=t.name,o&&Object.assign(r,o),r};var kr=lr,Pg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fi=bn;function I1(t,e){e=e||new FormData;var n=[];function i(o){return o===null?"":fi.isDate(o)?o.toISOString():fi.isArrayBuffer(o)||fi.isTypedArray(o)?typeof Blob=="function"?new Blob([o]):Buffer.from(o):o}function s(o,r){if(fi.isPlainObject(o)||fi.isArray(o)){if(n.indexOf(o)!==-1)throw Error("Circular reference detected in "+r);n.push(o),fi.forEach(o,function(c,u){if(!fi.isUndefined(c)){var l=r?r+"."+u:u,d;if(c&&!r&&typeof c=="object"){if(fi.endsWith(u,"{}"))c=JSON.stringify(c);else if(fi.endsWith(u,"[]")&&(d=fi.toArray(c))){d.forEach(function(p){!fi.isUndefined(p)&&e.append(l,i(p))});return}}s(c,l)}}),n.pop()}else e.append(r,i(o))}return s(t),e}var Eg=I1,Hl,Qp;function O1(){if(Qp)return Hl;Qp=1;var t=kr;return Hl=function(n,i,s){var o=s.config.validateStatus;!s.status||!o||o(s.status)?n(s):i(new t("Request failed with status code "+s.status,[t.ERR_BAD_REQUEST,t.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))},Hl}var Kl,ef;function R1(){if(ef)return Kl;ef=1;var t=bn;return Kl=t.isStandardBrowserEnv()?function(){return{write:function(i,s,o,r,a,c){var u=[];u.push(i+"="+encodeURIComponent(s)),t.isNumber(o)&&u.push("expires="+new Date(o).toGMTString()),t.isString(r)&&u.push("path="+r),t.isString(a)&&u.push("domain="+a),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(i){var s=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Kl}var $1=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},U1=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e},M1=$1,D1=U1,Cg=function(e,n){return e&&!M1(n)?D1(e,n):n},Gl,tf;function q1(){if(tf)return Gl;tf=1;var t=bn,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Gl=function(i){var s={},o,r,a;return i&&t.forEach(i.split(`
`),function(u){if(a=u.indexOf(":"),o=t.trim(u.substr(0,a)).toLowerCase(),r=t.trim(u.substr(a+1)),o){if(s[o]&&e.indexOf(o)>=0)return;o==="set-cookie"?s[o]=(s[o]?s[o]:[]).concat([r]):s[o]=s[o]?s[o]+", "+r:r}}),s},Gl}var Wl,nf;function L1(){if(nf)return Wl;nf=1;var t=bn;return Wl=t.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),s;function o(r){var a=r;return n&&(i.setAttribute("href",a),a=i.href),i.setAttribute("href",a),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:i.pathname.charAt(0)==="/"?i.pathname:"/"+i.pathname}}return s=o(window.location.href),function(a){var c=t.isString(a)?o(a):a;return c.protocol===s.protocol&&c.host===s.host}}():function(){return function(){return!0}}(),Wl}var Vl,sf;function pu(){if(sf)return Vl;sf=1;var t=kr,e=bn;function n(i){t.call(this,i??"canceled",t.ERR_CANCELED),this.name="CanceledError"}return e.inherits(n,t,{__CANCEL__:!0}),Vl=n,Vl}var Xl,of;function N1(){return of||(of=1,Xl=function(e){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}),Xl}var Jl,rf;function af(){if(rf)return Jl;rf=1;var t=bn,e=O1(),n=R1(),i=Ag,s=Cg,o=q1(),r=L1(),a=Pg,c=kr,u=pu(),l=N1();return Jl=function(p){return new Promise(function(b,w){var T=p.data,E=p.headers,P=p.responseType,k;function S(){p.cancelToken&&p.cancelToken.unsubscribe(k),p.signal&&p.signal.removeEventListener("abort",k)}t.isFormData(T)&&t.isStandardBrowserEnv()&&delete E["Content-Type"];var $=new XMLHttpRequest;if(p.auth){var H=p.auth.username||"",V=p.auth.password?unescape(encodeURIComponent(p.auth.password)):"";E.Authorization="Basic "+btoa(H+":"+V)}var z=s(p.baseURL,p.url);$.open(p.method.toUpperCase(),i(z,p.params,p.paramsSerializer),!0),$.timeout=p.timeout;function X(){if($){var O="getAllResponseHeaders"in $?o($.getAllResponseHeaders()):null,v=!P||P==="text"||P==="json"?$.responseText:$.response,h={data:v,status:$.status,statusText:$.statusText,headers:O,config:p,request:$};e(function(A){b(A),S()},function(A){w(A),S()},h),$=null}}if("onloadend"in $?$.onloadend=X:$.onreadystatechange=function(){!$||$.readyState!==4||$.status===0&&!($.responseURL&&$.responseURL.indexOf("file:")===0)||setTimeout(X)},$.onabort=function(){$&&(w(new c("Request aborted",c.ECONNABORTED,p,$)),$=null)},$.onerror=function(){w(new c("Network Error",c.ERR_NETWORK,p,$,$)),$=null},$.ontimeout=function(){var v=p.timeout?"timeout of "+p.timeout+"ms exceeded":"timeout exceeded",h=p.transitional||a;p.timeoutErrorMessage&&(v=p.timeoutErrorMessage),w(new c(v,h.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,p,$)),$=null},t.isStandardBrowserEnv()){var L=(p.withCredentials||r(z))&&p.xsrfCookieName?n.read(p.xsrfCookieName):void 0;L&&(E[p.xsrfHeaderName]=L)}"setRequestHeader"in $&&t.forEach(E,function(v,h){typeof T>"u"&&h.toLowerCase()==="content-type"?delete E[h]:$.setRequestHeader(h,v)}),t.isUndefined(p.withCredentials)||($.withCredentials=!!p.withCredentials),P&&P!=="json"&&($.responseType=p.responseType),typeof p.onDownloadProgress=="function"&&$.addEventListener("progress",p.onDownloadProgress),typeof p.onUploadProgress=="function"&&$.upload&&$.upload.addEventListener("progress",p.onUploadProgress),(p.cancelToken||p.signal)&&(k=function(O){$&&(w(!O||O&&O.type?new u:O),$.abort(),$=null)},p.cancelToken&&p.cancelToken.subscribe(k),p.signal&&(p.signal.aborted?k():p.signal.addEventListener("abort",k))),T||(T=null);var B=l(z);if(B&&["http","https","file"].indexOf(B)===-1){w(new c("Unsupported protocol "+B+":",c.ERR_BAD_REQUEST,p));return}$.send(T)})},Jl}var Zl,cf;function j1(){return cf||(cf=1,Zl=null),Zl}var nn=bn,uf=B1,lf=kr,F1=Pg,z1=Eg,H1={"Content-Type":"application/x-www-form-urlencoded"};function df(t,e){!nn.isUndefined(t)&&nn.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function K1(){var t;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(t=af()),t}function G1(t,e,n){if(nn.isString(t))try{return(e||JSON.parse)(t),nn.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(t)}var fu={transitional:F1,adapter:K1(),transformRequest:[function(e,n){if(uf(n,"Accept"),uf(n,"Content-Type"),nn.isFormData(e)||nn.isArrayBuffer(e)||nn.isBuffer(e)||nn.isStream(e)||nn.isFile(e)||nn.isBlob(e))return e;if(nn.isArrayBufferView(e))return e.buffer;if(nn.isURLSearchParams(e))return df(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var i=nn.isObject(e),s=n&&n["Content-Type"],o;if((o=nn.isFileList(e))||i&&s==="multipart/form-data"){var r=this.env&&this.env.FormData;return z1(o?{"files[]":e}:e,r&&new r)}else if(i||s==="application/json")return df(n,"application/json"),G1(e);return e}],transformResponse:[function(e){var n=this.transitional||fu.transitional,i=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,o=!i&&this.responseType==="json";if(o||s&&nn.isString(e)&&e.length)try{return JSON.parse(e)}catch(r){if(o)throw r.name==="SyntaxError"?lf.from(r,lf.ERR_BAD_RESPONSE,this,null,this.response):r}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:j1()},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};nn.forEach(["delete","get","head"],function(e){fu.headers[e]={}});nn.forEach(["post","put","patch"],function(e){fu.headers[e]=nn.merge(H1)});var Sh=fu,W1=bn,V1=Sh,X1=function(e,n,i){var s=this||V1;return W1.forEach(i,function(r){e=r.call(s,e,n)}),e},Yl,hf;function Bg(){return hf||(hf=1,Yl=function(e){return!!(e&&e.__CANCEL__)}),Yl}var pf=bn,Ql=X1,J1=Bg(),Z1=Sh,Y1=pu();function ed(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Y1}var Q1=function(e){ed(e),e.headers=e.headers||{},e.data=Ql.call(e,e.data,e.headers,e.transformRequest),e.headers=pf.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),pf.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var n=e.adapter||Z1.adapter;return n(e).then(function(s){return ed(e),s.data=Ql.call(e,s.data,s.headers,e.transformResponse),s},function(s){return J1(s)||(ed(e),s&&s.response&&(s.response.data=Ql.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})},Ln=bn,Ig=function(e,n){n=n||{};var i={};function s(l,d){return Ln.isPlainObject(l)&&Ln.isPlainObject(d)?Ln.merge(l,d):Ln.isPlainObject(d)?Ln.merge({},d):Ln.isArray(d)?d.slice():d}function o(l){if(Ln.isUndefined(n[l])){if(!Ln.isUndefined(e[l]))return s(void 0,e[l])}else return s(e[l],n[l])}function r(l){if(!Ln.isUndefined(n[l]))return s(void 0,n[l])}function a(l){if(Ln.isUndefined(n[l])){if(!Ln.isUndefined(e[l]))return s(void 0,e[l])}else return s(void 0,n[l])}function c(l){if(l in n)return s(e[l],n[l]);if(l in e)return s(void 0,e[l])}var u={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return Ln.forEach(Object.keys(e).concat(Object.keys(n)),function(d){var p=u[d]||o,g=p(d);Ln.isUndefined(g)&&p!==c||(i[d]=g)}),i},td,ff;function Og(){return ff||(ff=1,td={version:"0.27.2"}),td}var eT=Og().version,ks=kr,xh={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){xh[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});var gf={};xh.transitional=function(e,n,i){function s(o,r){return"[Axios v"+eT+"] Transitional option '"+o+"'"+r+(i?". "+i:"")}return function(o,r,a){if(e===!1)throw new ks(s(r," has been removed"+(n?" in "+n:"")),ks.ERR_DEPRECATED);return n&&!gf[r]&&(gf[r]=!0,console.warn(s(r," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,r,a):!0}};function tT(t,e,n){if(typeof t!="object")throw new ks("options must be an object",ks.ERR_BAD_OPTION_VALUE);for(var i=Object.keys(t),s=i.length;s-- >0;){var o=i[s],r=e[o];if(r){var a=t[o],c=a===void 0||r(a,o,t);if(c!==!0)throw new ks("option "+o+" must be "+c,ks.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ks("Unknown option "+o,ks.ERR_BAD_OPTION)}}var nT={assertOptions:tT,validators:xh},Rg=bn,iT=Ag,mf=E1,_f=Q1,gu=Ig,sT=Cg,$g=nT,Eo=$g.validators;function dr(t){this.defaults=t,this.interceptors={request:new mf,response:new mf}}dr.prototype.request=function(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=gu(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var i=n.transitional;i!==void 0&&$g.assertOptions(i,{silentJSONParsing:Eo.transitional(Eo.boolean),forcedJSONParsing:Eo.transitional(Eo.boolean),clarifyTimeoutError:Eo.transitional(Eo.boolean)},!1);var s=[],o=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(n)===!1||(o=o&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});var r=[];this.interceptors.response.forEach(function(g){r.push(g.fulfilled,g.rejected)});var a;if(!o){var c=[_f,void 0];for(Array.prototype.unshift.apply(c,s),c=c.concat(r),a=Promise.resolve(n);c.length;)a=a.then(c.shift(),c.shift());return a}for(var u=n;s.length;){var l=s.shift(),d=s.shift();try{u=l(u)}catch(p){d(p);break}}try{a=_f(u)}catch(p){return Promise.reject(p)}for(;r.length;)a=a.then(r.shift(),r.shift());return a};dr.prototype.getUri=function(e){e=gu(this.defaults,e);var n=sT(e.baseURL,e.url);return iT(n,e.params,e.paramsSerializer)};Rg.forEach(["delete","get","head","options"],function(e){dr.prototype[e]=function(n,i){return this.request(gu(i||{},{method:e,url:n,data:(i||{}).data}))}});Rg.forEach(["post","put","patch"],function(e){function n(i){return function(o,r,a){return this.request(gu(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}dr.prototype[e]=n(),dr.prototype[e+"Form"]=n(!0)});var oT=dr,nd,yf;function rT(){if(yf)return nd;yf=1;var t=pu();function e(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(r){i=r});var s=this;this.promise.then(function(o){if(s._listeners){var r,a=s._listeners.length;for(r=0;r<a;r++)s._listeners[r](o);s._listeners=null}}),this.promise.then=function(o){var r,a=new Promise(function(c){s.subscribe(c),r=c}).then(o);return a.cancel=function(){s.unsubscribe(r)},a},n(function(r){s.reason||(s.reason=new t(r),i(s.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]},e.prototype.unsubscribe=function(i){if(this._listeners){var s=this._listeners.indexOf(i);s!==-1&&this._listeners.splice(s,1)}},e.source=function(){var i,s=new e(function(r){i=r});return{token:s,cancel:i}},nd=e,nd}var id,wf;function aT(){return wf||(wf=1,id=function(e){return function(i){return e.apply(null,i)}}),id}var sd,bf;function cT(){if(bf)return sd;bf=1;var t=bn;return sd=function(n){return t.isObject(n)&&n.isAxiosError===!0},sd}var vf=bn,uT=bg,_c=oT,lT=Ig,dT=Sh;function Ug(t){var e=new _c(t),n=uT(_c.prototype.request,e);return vf.extend(n,_c.prototype,e),vf.extend(n,e),n.create=function(s){return Ug(lT(t,s))},n}var Dn=Ug(dT);Dn.Axios=_c;Dn.CanceledError=pu();Dn.CancelToken=rT();Dn.isCancel=Bg();Dn.VERSION=Og().version;Dn.toFormData=Eg;Dn.AxiosError=kr;Dn.Cancel=Dn.CanceledError;Dn.all=function(e){return Promise.all(e)};Dn.spread=aT();Dn.isAxiosError=cT();o1.exports=Dn;Lc.default=Dn;(function(t){t.exports=Lc})(s1);const Qs=U0(Ed);async function hT(t){var e;const{params:n,method:i,url:s,headers:o,body:r,overrides:a}=t,c={headers:o,method:i,url:s,params:n,data:r,withCredentials:(e=a==null?void 0:a.WITH_CREDENTIALS)!=null?e:!0};try{const u=await Qs(c);return{status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config}}catch(u){const l=u;if(l.response)return l.response;throw u}}var Bd={},pT={get exports(){return Bd},set exports(t){Bd=t}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function o(c,u,l,d,p){if(typeof l!="function")throw new TypeError("The listener must be a function");var g=new s(l,d||c,p),b=n?n+u:u;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],g]:c._events[b].push(g):(c._events[b]=g,c._eventsCount++),c}function r(c,u){--c._eventsCount===0?c._events=new i:delete c._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)e.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,g=d.length,b=new Array(g);p<g;p++)b[p]=d[p].fn;return b},a.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,p,g,b){var w=n?n+u:u;if(!this._events[w])return!1;var T=this._events[w],E=arguments.length,P,k;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),E){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,l),!0;case 3:return T.fn.call(T.context,l,d),!0;case 4:return T.fn.call(T.context,l,d,p),!0;case 5:return T.fn.call(T.context,l,d,p,g),!0;case 6:return T.fn.call(T.context,l,d,p,g,b),!0}for(k=1,P=new Array(E-1);k<E;k++)P[k-1]=arguments[k];T.fn.apply(T.context,P)}else{var S=T.length,$;for(k=0;k<S;k++)switch(T[k].once&&this.removeListener(u,T[k].fn,void 0,!0),E){case 1:T[k].fn.call(T[k].context);break;case 2:T[k].fn.call(T[k].context,l);break;case 3:T[k].fn.call(T[k].context,l,d);break;case 4:T[k].fn.call(T[k].context,l,d,p);break;default:if(!P)for($=1,P=new Array(E-1);$<E;$++)P[$-1]=arguments[$];T[k].fn.apply(T[k].context,P)}}return!0},a.prototype.on=function(u,l,d){return o(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return o(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,p){var g=n?n+u:u;if(!this._events[g])return this;if(!l)return r(this,g),this;var b=this._events[g];if(b.fn)b.fn===l&&(!p||b.once)&&(!d||b.context===d)&&r(this,g);else{for(var w=0,T=[],E=b.length;w<E;w++)(b[w].fn!==l||p&&!b[w].once||d&&b[w].context!==d)&&T.push(b[w]);T.length?this._events[g]=T.length===1?T[0]:T:r(this,g)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&r(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(pT);var Mg=Object.defineProperty,fT=Object.getOwnPropertyDescriptor,mu=(t,e)=>{for(var n in e)Mg(t,n,{get:e[n],enumerable:!0})},At=(t,e,n,i)=>{for(var s=i>1?void 0:i?fT(e,n):e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=(i?r(e,n,s):r(s))||s);return i&&s&&Mg(e,n,s),s},gT=/^m(\/[0-9]+')+$/,Dg=t=>t.replace("'",""),mT="ed25519 seed",_T=2147483648,qg=t=>{const n=yh.create(wg,mT).update(cg(t)).digest(),i=n.slice(0,32),s=n.slice(32);return{key:i,chainCode:s}},Lg=({key:t,chainCode:e},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const s=new Uint8Array(i),o=new Uint8Array([0]),r=new Uint8Array([...o,...t,...s]),a=yh.create(wg,e).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},yT=(t,e=!0)=>{const i=Es.sign.keyPair.fromSeed(t).secretKey.subarray(32),s=new Uint8Array([0]);return e?new Uint8Array([...s,...i]):i},Ng=t=>gT.test(t)?!t.split("/").slice(1).map(Dg).some(Number.isNaN):!1,jg=(t,e,n=_T)=>{if(!Ng(t))throw new Error("Invalid derivation path");const{key:i,chainCode:s}=qg(e);return t.split("/").slice(1).map(Dg).map(r=>parseInt(r,10)).reduce((r,a)=>Lg(r,a+n),{key:i,chainCode:s})},wT="1.20.0";async function zr(t){return new Promise(e=>{setTimeout(e,t)})}var Tf="/v1";function bT(t){let e=`${t}`;return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e.endsWith(Tf)||(e=`${e}${Tf}`),e}var Fg=2e5,zg=20,Hg=20,jc="0x1::aptos_coin::AptosCoin";function _u(t){let e,n,i;return typeof t=="object"?(e=t.hashFunction,n=t.ttlMs,i=t.tags):e=t,(s,o,r)=>{if(r.value!=null)r.value=Af(r.value,e,n,i);else if(r.get!=null)r.get=Af(r.get,e,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function Kg(t,e){return _u({ttlMs:t,hashFunction:e})}var yc=new Map;function vT(t){const e=new Set;for(const n of t){const i=yc.get(n);if(i)for(const s of i)e.has(s)||(s.clear(),e.add(s))}return e.size}function Af(t,e,n=0,i){const s=Symbol("__memoized_map__");return function(...o){let r;const a=this;a.hasOwnProperty(s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[s];if(Array.isArray(i))for(const u of i)yc.has(u)?yc.get(u).push(c):yc.set(u,[c]);if(e||o.length>0||n>0){let u;e===!0?u=o.map(p=>p.toString()).join("!"):e?u=e.apply(a,o):u=o[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const p=c.get(l);d=Date.now()-p>n}c.has(u)&&!d?r=c.get(u):(r=t.apply(a,o),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=t.apply(a,o),c.set(u,r))}return r}}var Ph=class extends Error{constructor(t,e,n){super(n),this.name="AptosApiError",this.url=e.url,this.status=e.status,this.statusText=e.statusText,this.data=e.data,this.request=t}},TT={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable"};async function AT(t,e,n,i,s,o){const r={...o==null?void 0:o.HEADERS,"x-aptos-client":`aptos-ts-sdk/${wT}`,"content-type":i??"application/json"};return o!=null&&o.TOKEN&&(r.Authorization=`Bearer ${o==null?void 0:o.TOKEN}`),await hT({url:t,method:e,body:n,params:s,headers:r,overrides:o})}async function Eh(t){const{url:e,endpoint:n,method:i,body:s,contentType:o,params:r,overrides:a}=t,c=`${e}/${n??""}`,u=await AT(c,i,s,o,r,a),l={status:u.status,statusText:u.statusText,data:u.data,headers:u.headers,config:u.config,url:c};if(l.status>=200&&l.status<300)return l;const d=TT[l.status];throw new Ph(t,l,d??"Generic Error")}async function Sn(t){return await Eh({...t,method:"GET"})}async function zs(t){return await Eh({...t,method:"POST"})}async function kf(t){const e=[];let n;const i=t.params;for(;;){i.start=n;const s=await Sn({url:t.url,endpoint:t.endpoint,params:i,originMethod:t.originMethod,overrides:t.overrides});if(n=s.headers["x-aptos-cursor"],delete s.headers,e.push(...s.data),n==null)break}return e}var Fc={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},Gg={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1",local:"http://localhost:8080/v1"},Id={"https://fullnode.mainnet.aptoslabs.com/v1":"mainnet","https://fullnode.testnet.aptoslabs.com/v1":"testnet","https://fullnode.devnet.aptoslabs.com/v1":"devnet","http://localhost:8080/v1":"local"},Wg=(t=>(t.MAINNET="mainnet",t.TESTNET="testnet",t.DEVNET="devnet",t.LOCAL="local",t))(Wg||{}),be=class{static fromBuffer(e){return be.fromUint8Array(e)}static fromUint8Array(e){return new be(ag(e))}static ensure(e){return typeof e=="string"?new be(e):e}constructor(e){e.startsWith("0x")?this.hexString=e:this.hexString=`0x${e}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(cg(this.noPrefix()))}},qe={};mu(qe,{AccountAddress:()=>yt,AccountAuthenticator:()=>Bs,AccountAuthenticatorEd25519:()=>Oh,AccountAuthenticatorMultiEd25519:()=>Rh,ArgumentABI:()=>Ea,AuthenticationKey:()=>to,ChainId:()=>xu,ChangeSet:()=>jT,Ed25519PublicKey:()=>ii,Ed25519Signature:()=>Ii,EntryFunction:()=>Ws,EntryFunctionABI:()=>hr,FeePayerRawTransaction:()=>Au,Identifier:()=>_n,Module:()=>Zg,ModuleId:()=>eo,MultiAgentRawTransaction:()=>Tu,MultiEd25519PublicKey:()=>ka,MultiEd25519Signature:()=>yu,MultiSig:()=>Dh,MultiSigTransactionPayload:()=>Mh,RawTransaction:()=>_o,RawTransactionWithData:()=>qh,RotationProofChallenge:()=>zT,Script:()=>vu,ScriptABI:()=>Mu,SignedTransaction:()=>Sa,StructTag:()=>$s,Transaction:()=>Yg,TransactionArgument:()=>xi,TransactionArgumentAddress:()=>Ru,TransactionArgumentBool:()=>Uu,TransactionArgumentU128:()=>Iu,TransactionArgumentU16:()=>Eu,TransactionArgumentU256:()=>Ou,TransactionArgumentU32:()=>Cu,TransactionArgumentU64:()=>Bu,TransactionArgumentU8:()=>Pu,TransactionArgumentU8Vector:()=>$u,TransactionAuthenticator:()=>Sr,TransactionAuthenticatorEd25519:()=>wu,TransactionAuthenticatorFeePayer:()=>Ih,TransactionAuthenticatorMultiAgent:()=>Bh,TransactionAuthenticatorMultiEd25519:()=>bu,TransactionPayload:()=>xa,TransactionPayloadEntryFunction:()=>Su,TransactionPayloadMultisig:()=>Lh,TransactionPayloadScript:()=>ku,TransactionScriptABI:()=>Du,TypeArgumentABI:()=>Pa,TypeTag:()=>yn,TypeTagAddress:()=>Os,TypeTagBool:()=>po,TypeTagParser:()=>mo,TypeTagParserError:()=>Jg,TypeTagSigner:()=>$h,TypeTagStruct:()=>Rs,TypeTagU128:()=>go,TypeTagU16:()=>xr,TypeTagU256:()=>Er,TypeTagU32:()=>Pr,TypeTagU64:()=>fo,TypeTagU8:()=>Yi,TypeTagVector:()=>Cr,UserTransaction:()=>Nh,WriteSet:()=>FT,objectStructTag:()=>DT,optionStructTag:()=>MT,stringStructTag:()=>Uh});var Vg={};mu(Vg,{Deserializer:()=>Ch,Serializer:()=>Ot,bcsSerializeBool:()=>RT,bcsSerializeBytes:()=>Ts,bcsSerializeFixedBytes:()=>UT,bcsSerializeStr:()=>$T,bcsSerializeU128:()=>IT,bcsSerializeU16:()=>CT,bcsSerializeU256:()=>OT,bcsSerializeU32:()=>BT,bcsSerializeU8:()=>Od,bcsSerializeUint64:()=>ET,bcsToBytes:()=>Ti,deserializeVector:()=>Cn,serializeVector:()=>mn,serializeVectorWithFunc:()=>PT});var kT=2**8-1,ST=2**16-1,aa=2**32-1,Xo=BigInt(2**64)-BigInt(1),Xg=BigInt(2**128)-BigInt(1),xT=BigInt(2**256)-BigInt(1),Ot=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){const n=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(n).set(new Uint8Array(this.buffer)),this.buffer=n}}serialize(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,n,i){this.ensureBufferWillHandleSize(n);const s=new DataView(this.buffer,this.offset);e.apply(s,[0,i,!0]),this.offset+=n}serializeStr(e){const n=new TextEncoder;this.serializeBytes(n.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.serialize(e)}serializeFixedBytes(e){this.serialize(e)}serializeBool(e){if(typeof e!="boolean")throw new Error("Value needs to be a boolean");const n=e?1:0;this.serialize(new Uint8Array([n]))}serializeU8(e){this.serialize(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){const n=BigInt(e.toString())&BigInt(aa),i=BigInt(e.toString())>>BigInt(32);this.serializeU32(Number(n)),this.serializeU32(Number(i))}serializeU128(e){const n=BigInt(e.toString())&Xo,i=BigInt(e.toString())>>BigInt(64);this.serializeU64(n),this.serializeU64(i)}serializeU256(e){const n=BigInt(e.toString())&Xg,i=BigInt(e.toString())>>BigInt(128);this.serializeU128(n),this.serializeU128(i)}serializeU32AsUleb128(e){let n=e;const i=[];for(;n>>>7;)i.push(n&127|128),n>>>=7;i.push(n),this.serialize(new Uint8Array(i))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};At([ho(0,kT)],Ot.prototype,"serializeU8",1);At([ho(0,ST)],Ot.prototype,"serializeU16",1);At([ho(0,aa)],Ot.prototype,"serializeU32",1);At([ho(BigInt(0),Xo)],Ot.prototype,"serializeU64",1);At([ho(BigInt(0),Xg)],Ot.prototype,"serializeU128",1);At([ho(BigInt(0),xT)],Ot.prototype,"serializeU256",1);At([ho(0,aa)],Ot.prototype,"serializeU32AsUleb128",1);function ho(t,e,n){return(i,s,o)=>{const r=o.value;return o.value=function(c){const u=BigInt(c.toString());if(u>BigInt(e.toString())||u<BigInt(t.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},o}}var Ch=class{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}read(e){if(this.offset+e>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const n=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}deserializeStr(){const e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeBytes(){const e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){const e=new Uint8Array(this.read(1))[0];if(e!==1&&e!==0)throw new Error("Invalid boolean value");return e===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const e=this.deserializeU32(),n=this.deserializeU32();return BigInt(BigInt(n)<<BigInt(32)|BigInt(e))}deserializeU128(){const e=this.deserializeU64(),n=this.deserializeU64();return BigInt(n<<BigInt(64)|e)}deserializeU256(){const e=this.deserializeU128(),n=this.deserializeU128();return BigInt(n<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),n=0;for(;e<aa;){const i=this.deserializeU8();if(e|=BigInt(i&127)<<BigInt(n),!(i&128))break;n+=7}if(e>aa)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}};function mn(t,e){e.serializeU32AsUleb128(t.length),t.forEach(n=>{n.serialize(e)})}function PT(t,e){const n=new Ot;n.serializeU32AsUleb128(t.length);const i=n[e];return t.forEach(s=>{i.call(n,s)}),n.getBytes()}function Cn(t,e){const n=t.deserializeUleb128AsU32(),i=[];for(let s=0;s<n;s+=1)i.push(e.deserialize(t));return i}function Ti(t){const e=new Ot;return t.serialize(e),e.getBytes()}function ET(t){const e=new Ot;return e.serializeU64(t),e.getBytes()}function Od(t){const e=new Ot;return e.serializeU8(t),e.getBytes()}function CT(t){const e=new Ot;return e.serializeU16(t),e.getBytes()}function BT(t){const e=new Ot;return e.serializeU32(t),e.getBytes()}function IT(t){const e=new Ot;return e.serializeU128(t),e.getBytes()}function OT(t){const e=new Ot;return e.serializeU256(t),e.getBytes()}function RT(t){const e=new Ot;return e.serializeBool(t),e.getBytes()}function $T(t){const e=new Ot;return e.serializeStr(t),e.getBytes()}function Ts(t){const e=new Ot;return e.serializeBytes(t),e.getBytes()}function UT(t){const e=new Ot;return e.serializeFixedBytes(t),e.getBytes()}var Qn=class{constructor(e){if(e.length!==Qn.LENGTH)throw new Error("Expected address of length 32");this.address=e}static fromHex(e){let n=be.ensure(e);n.noPrefix().length%2!==0&&(n=new be(`0${n.noPrefix()}`));const i=n.toUint8Array();if(i.length>Qn.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(i.length===Qn.LENGTH)return new Qn(i);const s=new Uint8Array(Qn.LENGTH);return s.set(i,Qn.LENGTH-i.length),new Qn(s)}static isValid(e){if(e==="")return!1;let n=be.ensure(e);return n.noPrefix().length%2!==0&&(n=new be(`0${n.noPrefix()}`)),n.toUint8Array().length<=Qn.LENGTH}toHexString(){return be.fromUint8Array(this.address).hex()}serialize(e){e.serializeFixedBytes(this.address)}static deserialize(e){return new Qn(e.deserializeFixedBytes(Qn.LENGTH))}static standardizeAddress(e){const n=e.toLowerCase();return`0x${(n.startsWith("0x")?n.slice(2):n).padStart(64,"0")}`}},yt=Qn;yt.LENGTH=32;yt.CORE_CODE_ADDRESS=Qn.fromHex("0x1");var wc=class{constructor(e){if(e.length!==wc.LENGTH)throw new Error(`Ed25519PublicKey length should be ${wc.LENGTH}`);this.value=e}toBytes(){return this.value}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const n=e.deserializeBytes();return new wc(n)}},ii=wc;ii.LENGTH=32;var bc=class{constructor(e){if(this.value=e,e.length!==bc.LENGTH)throw new Error(`Ed25519Signature length should be ${bc.LENGTH}`)}serialize(e){e.serializeBytes(this.value)}static deserialize(e){const n=e.deserializeBytes();return new bc(n)}},Ii=bc;Ii.LENGTH=64;var Rd=32,ka=class{constructor(e,n){if(this.public_keys=e,this.threshold=n,n>Rd)throw new Error(`"threshold" cannot be larger than ${Rd}`)}toBytes(){const e=new Uint8Array(this.public_keys.length*ii.LENGTH+1);return this.public_keys.forEach((n,i)=>{e.set(n.value,i*ii.LENGTH)}),e[this.public_keys.length*ii.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const n=e.deserializeBytes(),i=n[n.length-1],s=[];for(let o=0;o<n.length-1;o+=ii.LENGTH){const r=o;s.push(new ii(n.subarray(r,r+ii.LENGTH)))}return new ka(s,i)}},Hr=class{constructor(e,n){if(this.signatures=e,this.bitmap=n,n.length!==Hr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Hr.BITMAP_LEN}`)}toBytes(){const e=new Uint8Array(this.signatures.length*Ii.LENGTH+Hr.BITMAP_LEN);return this.signatures.forEach((n,i)=>{e.set(n.value,i*Ii.LENGTH)}),e.set(this.bitmap,this.signatures.length*Ii.LENGTH),e}static createBitmap(e){const i=new Uint8Array([0,0,0,0]),s=new Set;return e.forEach(o=>{if(o>=Rd)throw new Error(`Invalid bit value ${o}.`);if(s.has(o))throw new Error("Duplicated bits detected.");s.add(o);const r=Math.floor(o/8);let a=i[r];a|=128>>o%8,i[r]=a}),i}serialize(e){e.serializeBytes(this.toBytes())}static deserialize(e){const n=e.deserializeBytes(),i=n.subarray(n.length-4),s=[];for(let o=0;o<n.length-i.length;o+=Ii.LENGTH){const r=o;s.push(new Ii(n.subarray(r,r+Ii.LENGTH)))}return new Hr(s,i)}},yu=Hr;yu.BITMAP_LEN=4;var Sr=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return wu.load(e);case 1:return bu.load(e);case 2:return Bh.load(e);case 3:return Ih.load(e);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${n}`)}}},wu=class extends Sr{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=ii.deserialize(e),i=Ii.deserialize(e);return new wu(n,i)}},bu=class extends Sr{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=ka.deserialize(e),i=yu.deserialize(e);return new bu(n,i)}},Bh=class extends Sr{constructor(e,n,i){super(),this.sender=e,this.secondary_signer_addresses=n,this.secondary_signers=i}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),mn(this.secondary_signer_addresses,e),mn(this.secondary_signers,e)}static load(e){const n=Bs.deserialize(e),i=Cn(e,yt),s=Cn(e,Bs);return new Bh(n,i,s)}},Ih=class extends Sr{constructor(t,e,n,i){super(),this.sender=t,this.secondary_signer_addresses=e,this.secondary_signers=n,this.fee_payer=i}serialize(t){t.serializeU32AsUleb128(3),this.sender.serialize(t),mn(this.secondary_signer_addresses,t),mn(this.secondary_signers,t),this.fee_payer.address.serialize(t),this.fee_payer.authenticator.serialize(t)}static load(t){const e=Bs.deserialize(t),n=Cn(t,yt),i=Cn(t,Bs),s=yt.deserialize(t),o=Bs.deserialize(t),r={address:s,authenticator:o};return new Ih(e,n,i,r)}},Bs=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Oh.load(e);case 1:return Rh.load(e);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${n}`)}}},Oh=class extends Bs{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=ii.deserialize(e),i=Ii.deserialize(e);return new Oh(n,i)}},Rh=class extends Bs{constructor(e,n){super(),this.public_key=e,this.signature=n}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(e){const n=ka.deserialize(e),i=yu.deserialize(e);return new Rh(n,i)}},_n=class{constructor(e){this.value=e}serialize(e){e.serializeStr(this.value)}static deserialize(e){const n=e.deserializeStr();return new _n(n)}},yn=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return po.load(e);case 1:return Yi.load(e);case 2:return fo.load(e);case 3:return go.load(e);case 4:return Os.load(e);case 5:return $h.load(e);case 6:return Cr.load(e);case 7:return Rs.load(e);case 8:return xr.load(e);case 9:return Pr.load(e);case 10:return Er.load(e);default:throw new Error(`Unknown variant index for TypeTag: ${n}`)}}},po=class extends yn{serialize(e){e.serializeU32AsUleb128(0)}static load(e){return new po}},Yi=class extends yn{serialize(e){e.serializeU32AsUleb128(1)}static load(e){return new Yi}},xr=class extends yn{serialize(e){e.serializeU32AsUleb128(8)}static load(e){return new xr}},Pr=class extends yn{serialize(e){e.serializeU32AsUleb128(9)}static load(e){return new Pr}},fo=class extends yn{serialize(e){e.serializeU32AsUleb128(2)}static load(e){return new fo}},go=class extends yn{serialize(e){e.serializeU32AsUleb128(3)}static load(e){return new go}},Er=class extends yn{serialize(e){e.serializeU32AsUleb128(10)}static load(e){return new Er}},Os=class extends yn{serialize(e){e.serializeU32AsUleb128(4)}static load(e){return new Os}},$h=class extends yn{serialize(e){e.serializeU32AsUleb128(5)}static load(e){return new $h}},Cr=class extends yn{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(e){const n=yn.deserialize(e);return new Cr(n)}},Rs=class extends yn{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(e){const n=$s.deserialize(e);return new Rs(n)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===yt.CORE_CODE_ADDRESS.toHexString()}},$s=class{constructor(e,n,i,s){this.address=e,this.module_name=n,this.name=i,this.type_args=s}static fromString(e){const n=new mo(e).parseTypeTag();return new $s(n.value.address,n.value.module_name,n.value.name,n.value.type_args)}serialize(e){this.address.serialize(e),this.module_name.serialize(e),this.name.serialize(e),mn(this.type_args,e)}static deserialize(e){const n=yt.deserialize(e),i=_n.deserialize(e),s=_n.deserialize(e),o=Cn(e,yn);return new $s(n,i,s,o)}},Uh=new $s(yt.fromHex("0x1"),new _n("string"),new _n("String"),[]);function MT(t){return new $s(yt.fromHex("0x1"),new _n("option"),new _n("Option"),[t])}function DT(t){return new $s(yt.fromHex("0x1"),new _n("object"),new _n("Object"),[t])}function As(t){throw new Jg(t)}function Sf(t){return!!t.match(/\s/)}function xf(t){return!!t.match(/[_A-Za-z0-9]/g)}function qT(t){return!!t.match(/T\d+/g)}function LT(t,e){const n=t[e];if(n===":"){if(t.slice(e,e+2)==="::")return[["COLON","::"],2];As("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if(Sf(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(Sf(o))i=`${i}${o}`;else break}return[["SPACE",i],i.length]}else if(xf(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(xf(o))i=`${i}${o}`;else break}return qT(i)?[["GENERIC",i],i.length]:[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function NT(t){let e=0;const n=[];for(;e<t.length;){const[i,s]=LT(t,e);i[0]!=="SPACE"&&n.push(i),e+=s}return n}var mo=class{constructor(e,n){this.typeTags=[],this.tokens=NT(e),this.typeTags=n||[]}consume(e){const n=this.tokens.shift();(!n||n[1]!==e)&&As("Invalid type tag.")}consumeWholeGeneric(){for(this.consume("<");this.tokens[0][1]!==">";)this.tokens[0][1]==="<"&&this.consumeWholeGeneric(),this.tokens.shift();this.consume(">")}parseCommaList(e,n){const i=[];for(this.tokens.length<=0&&As("Invalid type tag.");this.tokens[0][1]!==e&&(i.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===e||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===e&&n)));)this.tokens.length<=0&&As("Invalid type tag.");return i}parseTypeTag(){this.tokens.length===0&&As("Invalid type tag.");const[e,n]=this.tokens.shift();if(n==="u8")return new Yi;if(n==="u16")return new xr;if(n==="u32")return new Pr;if(n==="u64")return new fo;if(n==="u128")return new go;if(n==="u256")return new Er;if(n==="bool")return new po;if(n==="address")return new Os;if(n==="vector"){this.consume("<");const i=this.parseTypeTag();return this.consume(">"),new Cr(i)}if(n==="string")return new Rs(Uh);if(e==="IDENT"&&(n.startsWith("0x")||n.startsWith("0X"))){const i=yt.fromHex(n);this.consume("::");const[s,o]=this.tokens.shift();s!=="IDENT"&&As("Invalid type tag."),this.consume("::");const[r,a]=this.tokens.shift();if(r!=="IDENT"&&As("Invalid type tag."),yt.CORE_CODE_ADDRESS.toHexString()===i.toHexString()&&o==="object"&&a==="Object")return this.consumeWholeGeneric(),new Os;let c=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),c=this.parseCommaList(">",!0),this.consume(">"));const u=new $s(i,new _n(o),new _n(a),c);return new Rs(u)}if(e==="GENERIC"){this.typeTags.length===0&&As("Can't convert generic type since no typeTags were specified.");const i=parseInt(n.substring(1),10);return new mo(this.typeTags[i]).parseTypeTag()}throw new Error("Invalid type tag.")}},Jg=class extends Error{constructor(t){super(t),this.name="TypeTagParserError"}},_o=class{constructor(e,n,i,s,o,r,a){this.sender=e,this.sequence_number=n,this.payload=i,this.max_gas_amount=s,this.gas_unit_price=o,this.expiration_timestamp_secs=r,this.chain_id=a}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(e){const n=yt.deserialize(e),i=e.deserializeU64(),s=xa.deserialize(e),o=e.deserializeU64(),r=e.deserializeU64(),a=e.deserializeU64(),c=xu.deserialize(e);return new _o(n,i,s,o,r,a,c)}},vu=class{constructor(e,n,i){this.code=e,this.ty_args=n,this.args=i}serialize(e){e.serializeBytes(this.code),mn(this.ty_args,e),mn(this.args,e)}static deserialize(e){const n=e.deserializeBytes(),i=Cn(e,yn),s=Cn(e,xi);return new vu(n,i,s)}},Ws=class{constructor(e,n,i,s){this.module_name=e,this.function_name=n,this.ty_args=i,this.args=s}static natural(e,n,i,s){return new Ws(eo.fromStr(e),new _n(n),i,s)}static natual(e,n,i,s){return Ws.natural(e,n,i,s)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),mn(this.ty_args,e),e.serializeU32AsUleb128(this.args.length),this.args.forEach(n=>{e.serializeBytes(n)})}static deserialize(e){const n=eo.deserialize(e),i=_n.deserialize(e),s=Cn(e,yn),o=e.deserializeUleb128AsU32(),r=[];for(let c=0;c<o;c+=1)r.push(e.deserializeBytes());const a=r;return new Ws(n,i,s,a)}},Mh=class{constructor(e){this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(e){return e.deserializeUleb128AsU32(),new Mh(Ws.deserialize(e))}},Dh=class{constructor(e,n){this.multisig_address=e,this.transaction_payload=n}serialize(e){this.multisig_address.serialize(e),this.transaction_payload===void 0?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(e){const n=yt.deserialize(e),i=e.deserializeBool();let s;return i&&(s=Mh.deserialize(e)),new Dh(n,s)}},Zg=class{constructor(e){this.code=e}serialize(e){e.serializeBytes(this.code)}static deserialize(e){const n=e.deserializeBytes();return new Zg(n)}},eo=class{constructor(e,n){this.address=e,this.name=n}static fromStr(e){const n=e.split("::");if(n.length!==2)throw new Error("Invalid module id.");return new eo(yt.fromHex(new be(n[0])),new _n(n[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(e){const n=yt.deserialize(e),i=_n.deserialize(e);return new eo(n,i)}},jT=class{serialize(e){throw new Error("Not implemented.")}static deserialize(e){throw new Error("Not implemented.")}},FT=class{serialize(e){throw new Error("Not implmented.")}static deserialize(e){throw new Error("Not implmented.")}},Sa=class{constructor(e,n){this.raw_txn=e,this.authenticator=n}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(e){const n=_o.deserialize(e),i=Sr.deserialize(e);return new Sa(n,i)}},qh=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Tu.load(e);case 1:return Au.load(e);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${n}`)}}},Tu=class extends qh{constructor(e,n){super(),this.raw_txn=e,this.secondary_signer_addresses=n}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),mn(this.secondary_signer_addresses,e)}static load(e){const n=_o.deserialize(e),i=Cn(e,yt);return new Tu(n,i)}},Au=class extends qh{constructor(t,e,n){super(),this.raw_txn=t,this.secondary_signer_addresses=e,this.fee_payer_address=n}serialize(t){t.serializeU32AsUleb128(1),this.raw_txn.serialize(t),mn(this.secondary_signer_addresses,t),this.fee_payer_address.serialize(t)}static load(t){const e=_o.deserialize(t),n=Cn(t,yt),i=yt.deserialize(t);return new Au(e,n,i)}},xa=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return ku.load(e);case 2:return Su.load(e);case 3:return Lh.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},ku=class extends xa{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){const n=vu.deserialize(e);return new ku(n)}},Su=class extends xa{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),this.value.serialize(e)}static load(e){const n=Ws.deserialize(e);return new Su(n)}},Lh=class extends xa{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const n=Dh.deserialize(e);return new Lh(n)}},xu=class{constructor(e){this.value=e}serialize(e){e.serializeU8(this.value)}static deserialize(e){const n=e.deserializeU8();return new xu(n)}},xi=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Pu.load(e);case 1:return Bu.load(e);case 2:return Iu.load(e);case 3:return Ru.load(e);case 4:return $u.load(e);case 5:return Uu.load(e);case 6:return Eu.load(e);case 7:return Cu.load(e);case 8:return Ou.load(e);default:throw new Error(`Unknown variant index for TransactionArgument: ${n}`)}}},Pu=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(0),e.serializeU8(this.value)}static load(e){const n=e.deserializeU8();return new Pu(n)}},Eu=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(6),e.serializeU16(this.value)}static load(e){const n=e.deserializeU16();return new Eu(n)}},Cu=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(7),e.serializeU32(this.value)}static load(e){const n=e.deserializeU32();return new Cu(n)}},Bu=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(1),e.serializeU64(this.value)}static load(e){const n=e.deserializeU64();return new Bu(n)}},Iu=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(2),e.serializeU128(this.value)}static load(e){const n=e.deserializeU128();return new Iu(n)}},Ou=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(8),e.serializeU256(this.value)}static load(e){const n=e.deserializeU256();return new Ou(n)}},Ru=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(3),this.value.serialize(e)}static load(e){const n=yt.deserialize(e);return new Ru(n)}},$u=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(4),e.serializeBytes(this.value)}static load(e){const n=e.deserializeBytes();return new $u(n)}},Uu=class extends xi{constructor(e){super(),this.value=e}serialize(e){e.serializeU32AsUleb128(5),e.serializeBool(this.value)}static load(e){const n=e.deserializeBool();return new Uu(n)}},Yg=class{getHashSalt(){const e=ur.create();return e.update("APTOS::Transaction"),e.digest()}static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Nh.load(e);default:throw new Error(`Unknown variant index for Transaction: ${n}`)}}},Nh=class extends Yg{constructor(e){super(),this.value=e}hash(){const e=ur.create();return e.update(this.getHashSalt()),e.update(Ti(this)),e.digest()}serialize(e){e.serializeU32AsUleb128(0),this.value.serialize(e)}static load(e){return new Nh(Sa.deserialize(e))}},Pa=class{constructor(e){this.name=e}serialize(e){e.serializeStr(this.name)}static deserialize(e){const n=e.deserializeStr();return new Pa(n)}},Ea=class{constructor(e,n){this.name=e,this.type_tag=n}serialize(e){e.serializeStr(this.name),this.type_tag.serialize(e)}static deserialize(e){const n=e.deserializeStr(),i=yn.deserialize(e);return new Ea(n,i)}},Mu=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return Du.load(e);case 1:return hr.load(e);default:throw new Error(`Unknown variant index for TransactionPayload: ${n}`)}}},Du=class extends Mu{constructor(e,n,i,s,o){super(),this.name=e,this.doc=n,this.code=i,this.ty_args=s,this.args=o}serialize(e){e.serializeU32AsUleb128(0),e.serializeStr(this.name),e.serializeStr(this.doc),e.serializeBytes(this.code),mn(this.ty_args,e),mn(this.args,e)}static load(e){const n=e.deserializeStr(),i=e.deserializeStr(),s=e.deserializeBytes(),o=Cn(e,Pa),r=Cn(e,Ea);return new Du(n,i,s,o,r)}},hr=class extends Mu{constructor(e,n,i,s,o){super(),this.name=e,this.module_name=n,this.doc=i,this.ty_args=s,this.args=o}serialize(e){e.serializeU32AsUleb128(1),e.serializeStr(this.name),this.module_name.serialize(e),e.serializeStr(this.doc),mn(this.ty_args,e),mn(this.args,e)}static load(e){const n=e.deserializeStr(),i=eo.deserialize(e),s=e.deserializeStr(),o=Cn(e,Pa),r=Cn(e,Ea);return new hr(n,i,s,o,r)}},Uo=class{constructor(e){if(e.length!==Uo.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=e}static fromMultiEd25519PublicKey(e){const n=e.toBytes(),i=new Uint8Array(n.length+1);i.set(n),i.set([Uo.MULTI_ED25519_SCHEME],n.length);const s=ur.create();return s.update(i),new Uo(s.digest())}static fromEd25519PublicKey(e){const n=e.value,i=new Uint8Array(n.length+1);i.set(n),i.set([Uo.ED25519_SCHEME],n.length);const s=ur.create();return s.update(i),new Uo(s.digest())}derivedAddress(){return be.fromUint8Array(this.bytes)}},to=Uo;to.LENGTH=32;to.MULTI_ED25519_SCHEME=1;to.ED25519_SCHEME=0;to.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var zT=class{constructor(e,n,i,s,o,r,a){this.accountAddress=e,this.moduleName=n,this.structName=i,this.sequenceNumber=s,this.originator=o,this.currentAuthKey=r,this.newPublicKey=a}serialize(e){this.accountAddress.serialize(e),e.serializeStr(this.moduleName),e.serializeStr(this.structName),e.serializeU64(this.sequenceNumber),this.originator.serialize(e),this.currentAuthKey.serialize(e),e.serializeBytes(this.newPublicKey)}},vc=class{static fromAptosAccountObject(e){return new vc(be.ensure(e.privateKeyHex).toUint8Array(),e.address)}static isValidPath(e){return/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(e)}static fromDerivePath(e,n){if(!vc.isValidPath(e))throw new Error("Invalid derivation path");const i=n.trim().split(/\s+/).map(o=>o.toLowerCase()).join(" "),{key:s}=jg(e,ag(Z0(i)));return new vc(s)}constructor(e,n){e?this.signingKey=Es.sign.keyPair.fromSeed(e.slice(0,32)):this.signingKey=Es.sign.keyPair(),this.accountAddress=be.ensure(n||this.authKey().hex())}address(){return this.accountAddress}authKey(){const e=new ii(this.signingKey.publicKey);return to.fromEd25519PublicKey(e).derivedAddress()}static getResourceAccountAddress(e,n){const i=Ti(yt.fromHex(e)),s=new Uint8Array([...i,...n,to.DERIVE_RESOURCE_ACCOUNT_SCHEME]),o=ur.create();return o.update(s),be.fromUint8Array(o.digest())}static getCollectionID(e,n){const i=new TextEncoder().encode(`${e}::${n}`),s=kv.create();return s.update(i),be.fromUint8Array(s.digest())}pubKey(){return be.fromUint8Array(this.signingKey.publicKey)}signBuffer(e){const n=Es.sign.detached(e,this.signingKey.secretKey);return be.fromUint8Array(n)}signHexString(e){const n=be.ensure(e).toUint8Array();return this.signBuffer(n)}verifySignature(e,n){const i=be.ensure(e).toUint8Array(),s=be.ensure(n).toUint8Array();return Es.sign.detached.verify(i,s,this.signingKey.publicKey)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:be.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},ca=vc;At([_u()],ca.prototype,"authKey",1);function yi(t){return t instanceof ca?t.address():be.ensure(t)}var Ca=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,HT=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,KT=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,Qg=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,GT=`
    query getAccountCoinsDataCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,WT=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,VT=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${HT}
${KT}`,XT=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,JT=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,ZT=`
    query getAccountTransactionsData($where_condition: account_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [account_transactions_order_by!]) {
  account_transactions(
    where: $where_condition
    order_by: $order_by
    limit: $limit
    offset: $offset
  ) {
    token_activities_v2 {
      ...TokenActivitiesFields
    }
    transaction_version
    account_address
  }
}
    ${Qg}`,YT=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collections_v2_order_by!]) {
  current_collections_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    max_supply
    mutable_description
    mutable_uri
    table_handle_v1
    token_standard
    total_minted_v2
    uri
  }
}
    `,QT=`
    query getCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,eA=`
    query getCurrentObjects($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,tA=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,nA=`
    query getIndexerLedgerInfo {
  ledger_infos {
    chain_id
  }
}
    `,iA=`
    query getNumberOfDelegators($poolAddress: String) {
  num_active_delegator_per_pool(
    where: {pool_address: {_eq: $poolAddress}, num_active_delegator: {_gt: "0"}}
    distinct_on: pool_address
  ) {
    num_active_delegator
    pool_address
  }
}
    `,sA=`
    query getOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Ca}`,oA=`
    query getOwnedTokensByTokenData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Ca}`,rA=`
    query getTokenActivities($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${Qg}`,aA=`
    query getTokenActivitiesCount($token_id: String) {
  token_activities_v2_aggregate(where: {token_data_id: {_eq: $token_id}}) {
    aggregate {
      count
    }
  }
}
    `,cA=`
    query getTokenCurrentOwnerData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Ca}`,uA=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,lA=`
    query getTokenOwnedFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Ca}`,dA=`
    query getTokenOwnersData($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${Ca}`,hA=`
    query getTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,pA=`
    query getUserTransactions($where_condition: user_transactions_bool_exp!, $offset: Int, $limit: Int, $order_by: [user_transactions_order_by!]) {
  user_transactions(
    order_by: $order_by
    where: $where_condition
    limit: $limit
    offset: $offset
  ) {
    version
  }
}
    `;function qu(t,e,n){if(!(e!=null&&e.includes(typeof t)))throw new Error(n||`Invalid arg: ${t} type should be ${e instanceof Array?e.join(" or "):e}`)}function jh(t){if(qu(t,["boolean","string"]),typeof t=="boolean")return t;if(t==="true")return!0;if(t==="false")return!1;throw new Error("Invalid boolean string.")}function Vs(t){if(qu(t,["number","string"]),typeof t=="number")return t;const e=Number.parseInt(t,10);if(Number.isNaN(e))throw new Error("Invalid number string.");return e}function Xs(t){return qu(t,["number","bigint","string"]),BigInt(t)}function Lu(t,e,n){Fh(t,e,n)}function Fh(t,e,n,i){if(e instanceof po)n.serializeBool(jh(t));else if(e instanceof Yi)n.serializeU8(Vs(t));else if(e instanceof xr)n.serializeU16(Vs(t));else if(e instanceof Pr)n.serializeU32(Vs(t));else if(e instanceof fo)n.serializeU64(Xs(t));else if(e instanceof go)n.serializeU128(Xs(t));else if(e instanceof Er)n.serializeU256(Xs(t));else if(e instanceof Os)em(t,n);else if(e instanceof Cr)fA(t,e,n);else if(e instanceof Rs)gA(t,e,n);else throw new Error("Unsupported arg type.")}function em(t,e){let n;if(typeof t=="string"||t instanceof be)n=yt.fromHex(t);else if(t instanceof yt)n=t;else throw new Error("Invalid account address.");n.serialize(e)}function fA(t,e,n,i){if(e.value instanceof Yi){if(t instanceof Uint8Array){n.serializeBytes(t);return}if(t instanceof be){n.serializeBytes(t.toUint8Array());return}if(typeof t=="string"){n.serializeStr(t);return}}if(!Array.isArray(t))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(t.length),t.forEach(s=>Fh(s,e.value,n))}function gA(t,e,n,i){const{address:s,module_name:o,name:r,type_args:a}=e.value,c=`${be.fromUint8Array(s.address).toShortString()}::${o.value}::${r.value}`;if(c==="0x1::string::String")qu(t,["string"]),n.serializeStr(t);else if(c==="0x1::object::Object")em(t,n);else if(c==="0x1::option::Option"){if(a.length!==1)throw new Error(`Option has the wrong number of type arguments ${a.length}`);mA(t,a[0],n)}else throw new Error("Unsupported struct type in function argument")}function mA(t,e,n,i){t==null?n.serializeU32AsUleb128(0):(n.serializeU32AsUleb128(1),Fh(t,e,n))}function tm(t,e){if(e instanceof po)return new Uu(jh(t));if(e instanceof Yi)return new Pu(Vs(t));if(e instanceof xr)return new Eu(Vs(t));if(e instanceof Pr)return new Cu(Vs(t));if(e instanceof fo)return new Bu(Xs(t));if(e instanceof go)return new Iu(Xs(t));if(e instanceof Er)return new Ou(Xs(t));if(e instanceof Os){let n;if(typeof t=="string"||t instanceof be)n=yt.fromHex(t);else if(t instanceof yt)n=t;else throw new Error("Invalid account address.");return new Ru(n)}if(e instanceof Cr&&e.value instanceof Yi){if(!(t instanceof Uint8Array))throw new Error(`${t} should be an instance of Uint8Array`);return new $u(t)}throw new Error("Unknown type for TransactionArgument.")}var _A="APTOS::RawTransaction",Pf="APTOS::RawTransactionWithData",wi=class{constructor(e,n){this.rawTxnBuilder=n,this.signingFunction=e}build(e,n,i){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(e,n,i)}static getSigningMessage(e){const n=ur.create();if(e instanceof _o)n.update(_A);else if(e instanceof Tu)n.update(Pf);else if(e instanceof Au)n.update(Pf);else throw new Error("Unknown transaction type.");const i=n.digest(),s=Ti(e),o=new Uint8Array(i.length+s.length);return o.set(i),o.set(s,i.length),o}},Tc=class extends wi{constructor(e,n,i){super(e,i),this.publicKey=n}rawToSigned(e){const n=wi.getSigningMessage(e),i=this.signingFunction(n),s=new wu(new ii(this.publicKey),i);return new Sa(e,s)}sign(e){return Ti(this.rawToSigned(e))}},nm=class extends wi{constructor(e,n){super(e),this.publicKey=n}rawToSigned(e){const n=wi.getSigningMessage(e),i=this.signingFunction(n),s=new bu(this.publicKey,i);return new Sa(e,s)}sign(e){return Ti(this.rawToSigned(e))}},zc=class{constructor(e,n){this.abiMap=new Map,e.forEach(i=>{const s=new Ch(i),o=Mu.deserialize(s);let r;if(o instanceof hr){const a=o,{address:c,name:u}=a.module_name;r=`${be.fromUint8Array(c.address).toShortString()}::${u.value}::${a.name}`}else r=o.name;if(this.abiMap.has(r))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(r,o)}),this.builderConfig={maxGasAmount:BigInt(Fg),expSecFromNow:zg,...n}}static toBCSArgs(e,n){if(e.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,s)=>{const o=new Ot;return Lu(i,e[s].type_tag,o),o.getBytes()})}static toTransactionArguments(e,n){if(e.length!==n.length)throw new Error("Wrong number of args provided.");return n.map((i,s)=>tm(i,e[s].type_tag))}setSequenceNumber(e){this.builderConfig.sequenceNumber=BigInt(e)}buildTransactionPayload(e,n,i){const s=n.map(a=>new mo(a).parseTypeTag());let o;if(!this.abiMap.has(e))throw new Error(`Cannot find function: ${e}`);const r=this.abiMap.get(e);if(r instanceof hr){const a=r,c=zc.toBCSArgs(a.args,i);o=new Su(new Ws(a.module_name,new _n(a.name),s,c))}else if(r instanceof Du){const a=r,c=zc.toTransactionArguments(a.args,i);o=new ku(new vu(a.code,s,c))}else throw new Error("Unknown ABI format.");return o}build(e,n,i){const{sender:s,sequenceNumber:o,gasUnitPrice:r,maxGasAmount:a,expSecFromNow:c,chainId:u}=this.builderConfig;if(!r)throw new Error("No gasUnitPrice provided.");const l=s instanceof yt?s:yt.fromHex(s),d=BigInt(Math.floor(Date.now()/1e3)+Number(c)),p=this.buildTransactionPayload(e,n,i);if(p)return new _o(l,BigInt(o),p,BigInt(a),BigInt(r),d,new xu(Number(u)));throw new Error("Invalid ABI.")}},Bt=class{constructor(e,n){this.aptosClient=e,this.builderConfig=n}async fetchABI(e){const i=(await this.aptosClient.getAccountModules(e)).map(o=>o.abi).flatMap(o=>o.exposed_functions.filter(r=>r.is_entry).map(r=>({fullName:`${o.address}::${o.name}::${r.name}`,...r}))),s=new Map;return i.forEach(o=>{s.set(o.fullName,o)}),s}async build(e,n,i){if(e=(S=>S.replace(/^0[xX]0*/g,"0x"))(e),e.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coin::transfer");const[r,a]=e.split("::"),c=await this.fetchABI(r);if(!c.has(e))throw new Error(`${e} doesn't exist.`);const u=c.get(e),d=u.params.filter(S=>S!=="signer"&&S!=="&signer").map((S,$)=>new Ea(`var${$}`,new mo(S,n).parseTypeTag())),p=new hr(u.name,eo.fromStr(`${r}::${a}`),"",u.generic_type_params.map((S,$)=>new Pa(`${$}`)),d),{sender:g,...b}=this.builderConfig,w=g instanceof yt?be.fromUint8Array(g.address):g,[{sequence_number:T},E,{gas_estimate:P}]=await Promise.all([b!=null&&b.sequenceNumber?Promise.resolve({sequence_number:b==null?void 0:b.sequenceNumber}):this.aptosClient.getAccount(w),b!=null&&b.chainId?Promise.resolve(b==null?void 0:b.chainId):this.aptosClient.getChainId(),b!=null&&b.gasUnitPrice?Promise.resolve({gas_estimate:b==null?void 0:b.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new zc([Ti(p)],{sender:g,sequenceNumber:T,chainId:E,gasUnitPrice:BigInt(P),...b}).build(e,n,i)}};At([Kg(10*60*1e3)],Bt.prototype,"fetchABI",1);var Mo=class{constructor(e,n,i=!1){if(!e)throw new Error("Node URL cannot be empty.");i?this.nodeUrl=e:this.nodeUrl=bT(e),this.config=n==null?{}:{...n}}async getAccount(e){const{data:n}=await Sn({url:this.nodeUrl,endpoint:`accounts/${be.ensure(e).hex()}`,originMethod:"getAccount",overrides:{...this.config}});return n}async getAccountTransactions(e,n){const{data:i}=await Sn({url:this.nodeUrl,endpoint:`accounts/${be.ensure(e).hex()}/transactions`,originMethod:"getAccountTransactions",params:{start:n==null?void 0:n.start,limit:n==null?void 0:n.limit},overrides:{...this.config}});return i}async getAccountModules(e,n){return await kf({url:this.nodeUrl,endpoint:`accounts/${e}/modules`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:1e3},originMethod:"getAccountModules",overrides:{...this.config}})}async getAccountModule(e,n,i){const{data:s}=await Sn({url:this.nodeUrl,endpoint:`accounts/${be.ensure(e).hex()}/module/${n}`,originMethod:"getAccountModule",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return s}async getAccountResources(e,n){return await kf({url:this.nodeUrl,endpoint:`accounts/${e}/resources`,params:{ledger_version:n==null?void 0:n.ledgerVersion,limit:9999},originMethod:"getAccountResources",overrides:{...this.config}})}async getAccountResource(e,n,i){const{data:s}=await Sn({url:this.nodeUrl,endpoint:`accounts/${be.ensure(e).hex()}/resource/${n}`,originMethod:"getAccountResource",params:{ledger_version:i==null?void 0:i.ledgerVersion},overrides:{...this.config}});return s}static generateBCSTransaction(e,n){return new Tc(s=>{const o=e.signBuffer(s);return new qe.Ed25519Signature(o.toUint8Array())},e.pubKey().toUint8Array()).sign(n)}static generateBCSSimulation(e,n){return new Tc(s=>{const o=new Uint8Array(64);return new qe.Ed25519Signature(o)},e.pubKey().toUint8Array()).sign(n)}async generateTransaction(e,n,i){const s={sender:e};if(i!=null&&i.sequence_number&&(s.sequenceNumber=i.sequence_number),i!=null&&i.gas_unit_price&&(s.gasUnitPrice=i.gas_unit_price),i!=null&&i.max_gas_amount&&(s.maxGasAmount=i.max_gas_amount),i!=null&&i.expiration_timestamp_secs){const r=Number.parseInt(i.expiration_timestamp_secs,10);s.expSecFromNow=r-Math.floor(Date.now()/1e3)}return new Bt(this,s).build(n.function,n.type_arguments,n.arguments)}async generateFeePayerTransaction(e,n,i,s=[],o){const r=await this.generateTransaction(e,n,o),a=s.map(u=>yt.fromHex(u));return new qe.FeePayerRawTransaction(r,a,yt.fromHex(i))}async submitFeePayerTransaction(e,n,i,s=[]){const o=new qe.TransactionAuthenticatorFeePayer(n,e.secondary_signer_addresses,s,{address:e.fee_payer_address,authenticator:i}),r=Ti(new qe.SignedTransaction(e.raw_txn,o));return await this.submitSignedBCSTransaction(r)}async signMultiTransaction(e,n){const i=new qe.Ed25519Signature(e.signBuffer(wi.getSigningMessage(n)).toUint8Array()),s=new qe.AccountAuthenticatorEd25519(new qe.Ed25519PublicKey(e.signingKey.publicKey),i);return Promise.resolve(s)}async signTransaction(e,n){return Promise.resolve(Mo.generateBCSTransaction(e,n))}async getEventsByCreationNumber(e,n,i){const{data:s}=await Sn({url:this.nodeUrl,endpoint:`accounts/${be.ensure(e).hex()}/events/${n}`,originMethod:"getEventsByCreationNumber",params:{start:i==null?void 0:i.start,limit:i==null?void 0:i.limit},overrides:{...this.config}});return s}async getEventsByEventHandle(e,n,i,s){const{data:o}=await Sn({url:this.nodeUrl,endpoint:`accounts/${be.ensure(e).hex()}/events/${n}/${i}`,originMethod:"getEventsByEventHandle",params:{start:s==null?void 0:s.start,limit:s==null?void 0:s.limit},overrides:{...this.config}});return o}async submitTransaction(e){return this.submitSignedBCSTransaction(e)}async simulateTransaction(e,n,i){let s;return e instanceof ca?s=Mo.generateBCSSimulation(e,n):e instanceof ka?s=new nm(()=>{const{threshold:r}=e,a=[],c=[];for(let l=0;l<r;l+=1)a.push(l),c.push(new qe.Ed25519Signature(new Uint8Array(64)));const u=qe.MultiEd25519Signature.createBitmap(a);return new qe.MultiEd25519Signature(c,u)},e).sign(n):s=new Tc(()=>{const r=new Uint8Array(64);return new qe.Ed25519Signature(r)},e.toBytes()).sign(n),this.submitBCSSimulation(s,i)}async submitSignedBCSTransaction(e){const{data:n}=await zs({url:this.nodeUrl,body:e,endpoint:"transactions",originMethod:"submitSignedBCSTransaction",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return n}async submitBCSSimulation(e,n){var i,s,o;const r={estimate_gas_unit_price:(i=n==null?void 0:n.estimateGasUnitPrice)!=null?i:!1,estimate_max_gas_amount:(s=n==null?void 0:n.estimateMaxGasAmount)!=null?s:!1,estimate_prioritized_gas_unit_price:(o=n==null?void 0:n.estimatePrioritizedGasUnitPrice)!=null?o:!1},{data:a}=await zs({url:this.nodeUrl,body:e,endpoint:"transactions/simulate",params:r,originMethod:"submitBCSSimulation",contentType:"application/x.aptos.signed_transaction+bcs",overrides:{...this.config}});return a}async getTransactions(e){var n;const{data:i}=await Sn({url:this.nodeUrl,endpoint:"transactions",originMethod:"getTransactions",params:{start:(n=e==null?void 0:e.start)==null?void 0:n.toString(),limit:e==null?void 0:e.limit},overrides:{...this.config}});return i}async getTransactionByHash(e){const{data:n}=await Sn({url:this.nodeUrl,endpoint:`transactions/by_hash/${e}`,originMethod:"getTransactionByHash",overrides:{...this.config}});return n}async getTransactionByVersion(e){const{data:n}=await Sn({url:this.nodeUrl,endpoint:`transactions/by_version/${e}`,originMethod:"getTransactionByVersion",overrides:{...this.config}});return n}async transactionPending(e){try{return(await this.getTransactionByHash(e)).type==="pending_transaction"}catch(n){if((n==null?void 0:n.status)===404)return!0;throw n}}async waitForTransactionWithResult(e,n){var i,s;const o=(i=n==null?void 0:n.timeoutSecs)!=null?i:Hg,r=(s=n==null?void 0:n.checkSuccess)!=null?s:!1;let a=!0,c=0,u;for(;a&&!(c>=o);){try{if(u=await this.getTransactionByHash(e),a=u.type==="pending_transaction",!a)break}catch(l){const d=l instanceof On,p=d&&l.status!==404&&l.status>=400&&l.status<500;if(!d||p)throw l}await zr(1e3),c+=1}if(u===void 0)throw new Error(`Waiting for transaction ${e} failed`);if(a)throw new im(`Waiting for transaction ${e} timed out after ${o} seconds`,u);if(!r)return u;if(!(u!=null&&u.success))throw new sm(`Transaction ${e} failed with an error: ${u.vm_status}`,u);return u}async waitForTransaction(e,n){await this.waitForTransactionWithResult(e,n)}async getLedgerInfo(){const{data:e}=await Sn({url:this.nodeUrl,originMethod:"getLedgerInfo",overrides:{...this.config}});return e}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(e,n,i){var s;return(await zs({url:this.nodeUrl,body:n,endpoint:`tables/${e}/item`,originMethod:"getTableItem",params:{ledger_version:(s=i==null?void 0:i.ledgerVersion)==null?void 0:s.toString()},overrides:{...this.config}})).data}async generateRawTransaction(e,n,i){const[{sequence_number:s},o,{gas_estimate:r}]=await Promise.all([i!=null&&i.providedSequenceNumber?Promise.resolve({sequence_number:i.providedSequenceNumber}):this.getAccount(e),this.getChainId(),i!=null&&i.gasUnitPrice?Promise.resolve({gas_estimate:i.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:a,gasUnitPrice:c,expireTimestamp:u}={maxGasAmount:BigInt(Fg),gasUnitPrice:BigInt(r),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+zg),...i};return new qe.RawTransaction(qe.AccountAddress.fromHex(e),BigInt(s),n,a,c,u,new qe.ChainId(o))}async generateSignSubmitTransaction(e,n,i){const s=await this.generateRawTransaction(e.address(),n,i),o=Mo.generateBCSTransaction(e,s);return(await this.submitSignedBCSTransaction(o)).hash}async signAndSubmitTransaction(e,n){const i=Mo.generateBCSTransaction(e,n);return(await this.submitSignedBCSTransaction(i)).hash}async publishPackage(e,n,i,s){const o=new Ot;mn(i,o);const r=new qe.TransactionPayloadEntryFunction(qe.EntryFunction.natural("0x1::code","publish_package_txn",[],[Ts(n),o.getBytes()]));return this.generateSignSubmitTransaction(e,r,s)}async createResourceAccountAndPublishPackage(e,n,i,s,o){const r=new Ot;mn(s,r);const a=new qe.TransactionPayloadEntryFunction(qe.EntryFunction.natural("0x1::resource_account","create_resource_account_and_publish_package",[],[Ts(n),Ts(i),r.getBytes()]));return this.generateSignSubmitTransaction(e,a,o)}async generateSignSubmitWaitForTransaction(e,n,i){const s=await this.generateSignSubmitTransaction(e,n,i);return this.waitForTransactionWithResult(s,i)}async estimateGasPrice(){const{data:e}=await Sn({url:this.nodeUrl,endpoint:"estimate_gas_price",originMethod:"estimateGasPrice",overrides:{...this.config}});return e}async estimateMaxGasAmount(e){const n=`0x1::coin::CoinStore<${jc}>`,[{gas_estimate:i},s]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(e)]),o=s.find(a=>a.type===n);return BigInt(o.data.coin.value)/BigInt(i)}async rotateAuthKeyEd25519(e,n,i){const{sequence_number:s,authentication_key:o}=await this.getAccount(e.address()),r=new ca(n),a=new qe.RotationProofChallenge(qe.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(s),qe.AccountAddress.fromHex(e.address()),new qe.AccountAddress(new be(o).toUint8Array()),r.pubKey().toUint8Array()),c=be.fromUint8Array(Ti(a)),u=e.signHexString(c),l=r.signHexString(c),d=new qe.TransactionPayloadEntryFunction(qe.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[Od(0),Ts(e.pubKey().toUint8Array()),Od(0),Ts(r.pubKey().toUint8Array()),Ts(u.toUint8Array()),Ts(l.toUint8Array())])),p=await this.generateRawTransaction(e.address(),d,i),g=Mo.generateBCSTransaction(e,p);return this.submitSignedBCSTransaction(g)}async lookupOriginalAddress(e){const n=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:i}}=n.data,s=await this.getTableItem(i,{key_type:"address",value_type:"address",key:be.ensure(e).hex()});return new be(s)}async getBlockByHeight(e,n){const{data:i}=await Sn({url:this.nodeUrl,endpoint:`blocks/by_height/${e}`,originMethod:"getBlockByHeight",params:{with_transactions:n},overrides:{...this.config}});return i}async getBlockByVersion(e,n){const{data:i}=await Sn({url:this.nodeUrl,endpoint:`blocks/by_version/${e}`,originMethod:"getBlockByVersion",params:{with_transactions:n},overrides:{...this.config}});return i}async view(e,n){const{data:i}=await zs({url:this.nodeUrl,body:e,endpoint:"view",originMethod:"getTableItem",params:{ledger_version:n},overrides:{...this.config}});return i}clearCache(e){vT(e)}},Qe=Mo;At([Yt],Qe.prototype,"getAccount",1);At([Yt],Qe.prototype,"getAccountTransactions",1);At([Yt,Kg(10*60*1e3)],Qe.prototype,"getAccountModules",1);At([Yt],Qe.prototype,"getAccountModule",1);At([Yt],Qe.prototype,"getAccountResources",1);At([Yt],Qe.prototype,"getAccountResource",1);At([Yt],Qe.prototype,"getEventsByCreationNumber",1);At([Yt],Qe.prototype,"getEventsByEventHandle",1);At([Yt],Qe.prototype,"submitSignedBCSTransaction",1);At([Yt],Qe.prototype,"submitBCSSimulation",1);At([Yt],Qe.prototype,"getTransactions",1);At([Yt],Qe.prototype,"getTransactionByHash",1);At([Yt],Qe.prototype,"getTransactionByVersion",1);At([Yt],Qe.prototype,"getLedgerInfo",1);At([_u()],Qe.prototype,"getChainId",1);At([Yt],Qe.prototype,"getTableItem",1);At([Yt,_u({ttlMs:5*60*1e3,tags:["gas_estimates"]})],Qe.prototype,"estimateGasPrice",1);At([Yt],Qe.prototype,"estimateMaxGasAmount",1);At([Yt],Qe.prototype,"getBlockByHeight",1);At([Yt],Qe.prototype,"getBlockByVersion",1);At([Yt],Qe.prototype,"view",1);var im=class extends Error{constructor(e,n){super(e),this.lastSubmittedTransaction=n}},sm=class extends Error{constructor(e,n){super(e),this.transaction=n}},On=class extends Error{constructor(e,n,i,s){super(n),this.status=e,this.message=n,this.errorCode=i,this.vmErrorCode=s}};function Yt(t,e,n){const i=n.value;return n.value=async function(...o){var r,a;try{return await i.apply(this,[...o])}catch(c){throw c instanceof Ph?new On(c.status,JSON.stringify({message:c.message,...c.data}),(r=c.data)==null?void 0:r.error_code,(a=c.data)==null?void 0:a.vm_error_code):c}},n}var qt=class{constructor(e,n){this.endpoint=e,this.config=n}static validateAddress(e){if(e.length<66)throw new Error(`${e} is less than 66 chars long.`)}async queryIndexer(e){const n=await zs({url:this.endpoint,body:e,overrides:{WITH_CREDENTIALS:!1,...this.config}});if(n.data.errors)throw new On(n.data.errors[0].extensions.code,JSON.stringify({message:n.data.errors[0].message,error_code:n.data.errors[0].extensions.code}));return n.data.data}async getIndexerLedgerInfo(){const e={query:nA};return this.queryIndexer(e)}async getAccountNFTs(e,n){const i=be.ensure(e).hex();qt.validateAddress(i);const s={query:VT,variables:{address:i,offset:n==null?void 0:n.offset,limit:n==null?void 0:n.limit}};return this.queryIndexer(s)}async getTokenActivities(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const r={token_data_id:{_eq:o}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:rA,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenActivitiesCount(e){const n={query:aA,variables:{token_id:e}};return this.queryIndexer(n)}async getAccountTokensCount(e,n){var i,s;const o={owner_address:{_eq:e},amount:{_gt:"0"}};n!=null&&n.tokenStandard&&(o.token_standard={_eq:n==null?void 0:n.tokenStandard});const r=be.ensure(e).hex();qt.validateAddress(r);const a={query:XT,variables:{where_condition:o,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit}};return this.queryIndexer(a)}async getTokenData(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const r={token_data_id:{_eq:o}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:uA,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnersData(e,n,i){var s,o;const r=be.ensure(e).hex();qt.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:dA,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getTokenCurrentOwnerData(e,n,i){var s,o;const r=be.ensure(e).hex();qt.validateAddress(r);const a={token_data_id:{_eq:r},amount:{_gt:"0"}};n&&(a.property_version_v1={_eq:n}),i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:cA,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getOwnedTokens(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const r={owner_address:{_eq:o},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:sA,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getOwnedTokensByTokenData(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const r={token_data_id:{_eq:o},amount:{_gt:0}};n!=null&&n.tokenStandard&&(r.token_standard={_eq:n==null?void 0:n.tokenStandard});const a={query:oA,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTokenOwnedFromCollectionAddress(e,n,i){var s,o;const r=be.ensure(e).hex();qt.validateAddress(r);const a=be.ensure(n).hex();qt.validateAddress(a);const c={owner_address:{_eq:r},current_token_data:{collection_id:{_eq:a}},amount:{_gt:0}};i!=null&&i.tokenStandard&&(c.token_standard={_eq:i==null?void 0:i.tokenStandard});const u={query:lA,variables:{where_condition:c,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(u)}async getTokenOwnedFromCollectionNameAndCreatorAddress(e,n,i,s){const o=await this.getCollectionAddress(i,n,s);return await this.getTokenOwnedFromCollectionAddress(e,o,s)}async getCollectionData(e,n,i){var s,o;const r=be.ensure(e).hex();qt.validateAddress(r);const a={collection_name:{_eq:n},creator_address:{_eq:r}};i!=null&&i.tokenStandard&&(a.token_standard={_eq:i==null?void 0:i.tokenStandard});const c={query:YT,variables:{where_condition:a,offset:(s=i==null?void 0:i.options)==null?void 0:s.offset,limit:(o=i==null?void 0:i.options)==null?void 0:o.limit,order_by:i==null?void 0:i.orderBy}};return this.queryIndexer(c)}async getCollectionAddress(e,n,i){return(await this.getCollectionData(e,n,i)).current_collections_v2[0].collection_id}async getCollectionsWithOwnedTokens(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const r={owner_address:{_eq:o}};n!=null&&n.tokenStandard&&(r.current_collection={token_standard:{_eq:n==null?void 0:n.tokenStandard}});const a={query:QT,variables:{where_condition:r,offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountTransactionsCount(e){const n=be.ensure(e).hex();qt.validateAddress(n);const i={query:JT,variables:{address:n}};return this.queryIndexer(i)}async getAccountTransactionsData(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const a={query:ZT,variables:{where_condition:{account_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getTopUserTransactions(e){const n={query:hA,variables:{limit:e}};return this.queryIndexer(n)}async getUserTransactions(e){var n,i;const s={version:{_lte:e==null?void 0:e.startVersion}},o={query:pA,variables:{where_condition:s,offset:(n=e==null?void 0:e.options)==null?void 0:n.offset,limit:(i=e==null?void 0:e.options)==null?void 0:i.limit,order_by:e==null?void 0:e.orderBy}};return this.queryIndexer(o)}async getDelegatedStakingActivities(e,n){const i=be.ensure(e).hex(),s=be.ensure(n).hex();qt.validateAddress(i),qt.validateAddress(s);const o={query:tA,variables:{delegatorAddress:i,poolAddress:s}};return this.queryIndexer(o)}async getNumberOfDelegators(e){const n=be.ensure(e).hex();qt.validateAddress(n);const i={query:iA,variables:{poolAddress:n}};return this.queryIndexer(i)}async getAccountCoinsData(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const a={query:WT,variables:{where_condition:{owner_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}async getAccountCoinsDataCount(e){const n=be.ensure(e).hex();qt.validateAddress(n);const i={query:GT,variables:{address:n}};return this.queryIndexer(i)}async getAccountOwnedObjects(e,n){var i,s;const o=be.ensure(e).hex();qt.validateAddress(o);const a={query:eA,variables:{where_condition:{owner_address:{_eq:o}},offset:(i=n==null?void 0:n.options)==null?void 0:i.offset,limit:(s=n==null?void 0:n.options)==null?void 0:s.limit,order_by:n==null?void 0:n.orderBy}};return this.queryIndexer(a)}},ua=class{constructor(e,n,i=!1){let s=null,o=null;if(typeof e=="object"&&yA(e)?(s=e.fullnodeUrl,o=e.indexerUrl,this.network="CUSTOM"):(s=Gg[e],o=Fc[e],this.network=e),this.network==="CUSTOM"&&!s)throw new Error("fullnode url is not provided");o&&(this.indexerClient=new qt(o,n)),this.aptosClient=new Qe(s,n,i)}};function om(t,e,n){Object.getOwnPropertyNames(e.prototype).forEach(i=>{const s=Object.getOwnPropertyDescriptor(e.prototype,i);s&&(s.value=function(...o){return this[n][i](...o)},Object.defineProperty(t.prototype,i,s))}),Object.getOwnPropertyNames(e).forEach(i=>{const s=Object.getOwnPropertyDescriptor(e,i);s&&(s.value=function(...o){return this[n][i](...o)},!t.hasOwnProperty.call(t,i)&&Object.defineProperty(t,i,s))})}om(ua,Qe,"aptosClient");om(ua,qt,"indexerClient");function yA(t){return t.fullnodeUrl!==void 0&&typeof t.fullnodeUrl=="string"}var zh=class{constructor(e,n){this.type=e,this.value=n}},Nu=class{constructor(){this.data={}}setProperty(e,n){this.data[e]=n}};function ju(t){let e;return t==="string"||t==="String"?e=new Rs(Uh):e=new mo(t).parseTypeTag(),e}function Hc(t,e){if(t.length!==e.length)throw new Error("Length of property values and types not match");const n=new Array;return e.forEach((i,s)=>{try{const o=ju(i),r=new Ot;Lu(t[s],o,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(t[s]))}}),n}function $d(t,e){if(!t||!e)throw new Error("value or type can not be empty");try{const n=ju(e),i=new Ot;return Lu(t,n,i),i.getBytes()}catch{return new TextEncoder().encode(t)}}function Hh(t){const e=t.map.data,n=new Nu;return e.forEach(i=>{const{key:s}=i,o=i.value.value,r=i.value.type,a=ju(r),c=rm(a,o),u=new zh(r,c);n.setProperty(s,u)}),n}function rm(t,e){const n=new Ch(new be(e).toUint8Array());let i="";return t instanceof Yi?i=n.deserializeU8().toString():t instanceof fo?i=n.deserializeU64().toString():t instanceof go?i=n.deserializeU128().toString():t instanceof po?i=n.deserializeBool()?"true":"false":t instanceof Os?i=be.fromUint8Array(n.deserializeFixedBytes(32)).hex():t instanceof Rs&&t.isStringTypeTag()?i=n.deserializeStr():i=e,i}var am={};mu(am,{PropertyMap:()=>Nu,PropertyValue:()=>zh,Token:()=>um,TokenData:()=>cm});var cm=class{constructor(e,n,i,s,o,r,a,c){this.collection=e,this.description=n,this.name=i,this.maximum=s,this.supply=o,this.uri=r,this.default_properties=Hh(a),this.mutability_config=c}},um=class{constructor(e,n,i){this.id=e,this.amount=n,this.token_properties=Hh(i)}},wA=class{constructor(e){this.aptosClient=e}async createCollection(e,n,i,s,o=Xo,r){const c=await new Bt(this.aptosClient,{sender:e.address(),...r}).build("0x3::token::create_collection_script",[],[n,i,s,o,[!1,!1,!1]]),u=Qe.generateBCSTransaction(e,c);return(await this.aptosClient.submitSignedBCSTransaction(u)).hash}async createToken(e,n,i,s,o,r,a=Xo,c=e.address(),u=0,l=0,d=[],p=[],g=[],b){const T=await new Bt(this.aptosClient,{sender:e.address(),...b}).build("0x3::token::create_token_script",[],[n,i,s,o,a,r,c,u,l,[!1,!1,!1,!1,!1],d,Hc(p,g),g]),E=Qe.generateBCSTransaction(e,T);return(await this.aptosClient.submitSignedBCSTransaction(E)).hash}async createTokenWithMutabilityConfig(e,n,i,s,o,r,a=Xo,c=e.address(),u=0,l=0,d=[],p=[],g=[],b=[!1,!1,!1,!1,!1],w){const E=await new Bt(this.aptosClient,{sender:e.address(),...w}).build("0x3::token::create_token_script",[],[n,i,s,o,a,r,c,u,l,b,d,p,g]),P=Qe.generateBCSTransaction(e,E);return(await this.aptosClient.submitSignedBCSTransaction(P)).hash}async offerToken(e,n,i,s,o,r,a=0,c){const l=await new Bt(this.aptosClient,{sender:e.address(),...c}).build("0x3::token_transfers::offer_script",[],[n,i,s,o,a,r]),d=Qe.generateBCSTransaction(e,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async claimToken(e,n,i,s,o,r=0,a){const u=await new Bt(this.aptosClient,{sender:e.address(),...a}).build("0x3::token_transfers::claim_script",[],[n,i,s,o,r]),l=Qe.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async cancelTokenOffer(e,n,i,s,o,r=0,a){const u=await new Bt(this.aptosClient,{sender:e.address(),...a}).build("0x3::token_transfers::cancel_offer_script",[],[n,i,s,o,r]),l=Qe.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async directTransferToken(e,n,i,s,o,r,a=0,c){const l=await new Bt(this.aptosClient,{sender:e.address(),...c}).build("0x3::token::direct_transfer_script",[],[i,s,o,a,r]),d=new qe.MultiAgentRawTransaction(l,[qe.AccountAddress.fromHex(n.address())]),p=new qe.Ed25519Signature(e.signBuffer(wi.getSigningMessage(d)).toUint8Array()),g=new qe.AccountAuthenticatorEd25519(new qe.Ed25519PublicKey(e.signingKey.publicKey),p),b=new qe.Ed25519Signature(n.signBuffer(wi.getSigningMessage(d)).toUint8Array()),w=new qe.AccountAuthenticatorEd25519(new qe.Ed25519PublicKey(n.signingKey.publicKey),b),T=new qe.TransactionAuthenticatorMultiAgent(g,[qe.AccountAddress.fromHex(n.address())],[w]),E=Ti(new qe.SignedTransaction(l,T));return(await this.aptosClient.submitSignedBCSTransaction(E)).hash}async directTransferTokenWithFeePayer(e,n,i,s,o,r,a,c=0,u){const d=await new Bt(this.aptosClient,{sender:e.address(),...u}).build("0x3::token::direct_transfer_script",[],[i,s,o,c,r]),p=new qe.FeePayerRawTransaction(d,[qe.AccountAddress.fromHex(n.address())],qe.AccountAddress.fromHex(a.address())),g=new qe.Ed25519Signature(e.signBuffer(wi.getSigningMessage(p)).toUint8Array()),b=new qe.AccountAuthenticatorEd25519(new qe.Ed25519PublicKey(e.signingKey.publicKey),g),w=new qe.Ed25519Signature(n.signBuffer(wi.getSigningMessage(p)).toUint8Array()),T=new qe.AccountAuthenticatorEd25519(new qe.Ed25519PublicKey(n.signingKey.publicKey),w),E=new qe.Ed25519Signature(a.signBuffer(wi.getSigningMessage(p)).toUint8Array()),P=new qe.AccountAuthenticatorEd25519(new qe.Ed25519PublicKey(a.signingKey.publicKey),E),k=new qe.TransactionAuthenticatorFeePayer(b,[qe.AccountAddress.fromHex(n.address())],[T],{address:qe.AccountAddress.fromHex(a.address()),authenticator:P}),S=Ti(new qe.SignedTransaction(d,k));return(await this.aptosClient.submitSignedBCSTransaction(S)).hash}async optInTokenTransfer(e,n,i){const o=await new Bt(this.aptosClient,{sender:e.address(),...i}).build("0x3::token::opt_in_direct_transfer",[],[n]),r=Qe.generateBCSTransaction(e,o);return(await this.aptosClient.submitSignedBCSTransaction(r)).hash}async transferWithOptIn(e,n,i,s,o,r,a,c){const l=await new Bt(this.aptosClient,{sender:e.address(),...c}).build("0x3::token::transfer_with_opt_in",[],[n,i,s,o,r,a]),d=Qe.generateBCSTransaction(e,l);return(await this.aptosClient.submitSignedBCSTransaction(d)).hash}async burnByCreator(e,n,i,s,o,r,a){const u=await new Bt(this.aptosClient,{sender:e.address(),...a}).build("0x3::token::burn_by_creator",[],[n,i,s,o,r]),l=Qe.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async burnByOwner(e,n,i,s,o,r,a){const u=await new Bt(this.aptosClient,{sender:e.address(),...a}).build("0x3::token::burn",[],[n,i,s,o,r]),l=Qe.generateBCSTransaction(e,u);return(await this.aptosClient.submitSignedBCSTransaction(l)).hash}async mutateTokenProperties(e,n,i,s,o,r,a,c,u,l,d){const g=await new Bt(this.aptosClient,{sender:e.address(),...d}).build("0x3::token::mutate_token_properties",[],[n,i,s,o,r,a,c,u,l]),b=Qe.generateBCSTransaction(e,g);return(await this.aptosClient.submitSignedBCSTransaction(b)).hash}async getCollectionData(e,n){const s=(await this.aptosClient.getAccountResources(e)).find(c=>c.type==="0x3::token::Collections"),{handle:o}=s.data.collection_data,r={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:n};return await this.aptosClient.getTableItem(o,r)}async getTokenData(e,n,i){const s=e instanceof be?e.hex():e,o=await this.aptosClient.getAccountResource(s,"0x3::token::Collections"),{handle:r}=o.data.token_data,c={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:s,collection:n,name:i}},u=await this.aptosClient.getTableItem(r,c);return new cm(u.collection,u.description,u.name,u.maximum,u.supply,u.uri,u.default_properties,u.mutability_config)}async getToken(e,n,i,s="0"){const o={creator:e instanceof be?e.hex():e,collection:n,name:i};return this.getTokenForAccount(e,{token_data_id:o,property_version:s})}async getTokenForAccount(e,n){const i=await this.aptosClient.getAccountResource(e instanceof be?e.hex():e,"0x3::token::TokenStore"),{handle:s}=i.data.tokens,o={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:n};try{const r=await this.aptosClient.getTableItem(s,o);return new um(r.id,r.amount,r.token_properties)}catch(r){return(r==null?void 0:r.status)===404?{id:n,amount:"0",token_properties:new Nu}:r}}},Kc=class{constructor(t){this.assetType="0x1::fungible_asset::Metadata",this.provider=t}async transfer(t,e,n,i,s){const o=await this.generateTransfer(t,e,n,i,s);return await this.provider.signAndSubmitTransaction(t,o)}async getPrimaryBalance(t,e){const n={function:"0x1::primary_fungible_store::balance",type_arguments:[this.assetType],arguments:[be.ensure(t).hex(),be.ensure(e).hex()]},i=await this.provider.view(n);return BigInt(i[0])}async generateTransfer(t,e,n,i,s){return await new Bt(this.provider,{sender:t.address(),...s}).build("0x1::primary_fungible_store::transfer",[this.assetType],[be.ensure(e).hex(),be.ensure(n).hex(),i])}},Co={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",VECTOR:"vector<u8>",STRING:"string"},bA=class{constructor(t){this.tokenType="0x4::token::Token",this.provider=t}async submitTransaction(t,e,n,i,s){const r=await new Bt(this.provider,{sender:t.address(),...s}).build(`0x4::aptos_token::${e}`,n,i),a=Qe.generateBCSTransaction(t,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async createCollection(t,e,n,i,s=Xo,o,r){var a,c,u,l,d,p,g,b,w,T,E;return this.submitTransaction(t,"create_collection",[],[e,s,n,i,(a=o==null?void 0:o.mutableDescription)!=null?a:!0,(c=o==null?void 0:o.mutableRoyalty)!=null?c:!0,(u=o==null?void 0:o.mutableURI)!=null?u:!0,(l=o==null?void 0:o.mutableTokenDescription)!=null?l:!0,(d=o==null?void 0:o.mutableTokenName)!=null?d:!0,(p=o==null?void 0:o.mutableTokenProperties)!=null?p:!0,(g=o==null?void 0:o.mutableTokenURI)!=null?g:!0,(b=o==null?void 0:o.tokensBurnableByCreator)!=null?b:!0,(w=o==null?void 0:o.tokensFreezableByCreator)!=null?w:!0,(T=o==null?void 0:o.royaltyNumerator)!=null?T:0,(E=o==null?void 0:o.royaltyDenominator)!=null?E:1],r)}async mint(t,e,n,i,s,o=[],r=[],a=[],c){return this.submitTransaction(t,"mint",[],[e,n,i,s,o,r,Hc(a,r)],c)}async mintSoulBound(t,e,n,i,s,o,r=[],a=[],c=[],u){return this.submitTransaction(t,"mint_soul_bound",[],[e,n,i,s,r,a,Hc(c,a),o.address().hex()],u)}async burnToken(t,e,n,i){return this.submitTransaction(t,"burn",[n||this.tokenType],[be.ensure(e).hex()],i)}async freezeTokenTransafer(t,e,n,i){return this.submitTransaction(t,"freeze_transfer",[n||this.tokenType],[be.ensure(e).hex()],i)}async unfreezeTokenTransafer(t,e,n,i){return this.submitTransaction(t,"unfreeze_transfer",[n||this.tokenType],[be.ensure(e).hex()],i)}async setTokenDescription(t,e,n,i,s){return this.submitTransaction(t,"set_description",[i||this.tokenType],[be.ensure(e).hex(),n],s)}async setTokenName(t,e,n,i,s){return this.submitTransaction(t,"set_name",[i||this.tokenType],[be.ensure(e).hex(),n],s)}async setTokenURI(t,e,n,i,s){return this.submitTransaction(t,"set_uri",[i||this.tokenType],[be.ensure(e).hex(),n],s)}async addTokenProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"add_property",[o||this.tokenType],[be.ensure(e).hex(),n,Co[i],$d(s,Co[i])],r)}async removeTokenProperty(t,e,n,i,s){return this.submitTransaction(t,"remove_property",[i||this.tokenType],[be.ensure(e).hex(),n],s)}async updateTokenProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"update_property",[o||this.tokenType],[be.ensure(e).hex(),n,Co[i],$d(s,Co[i])],r)}async addTypedProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"add_typed_property",[o||this.tokenType,Co[i]],[be.ensure(e).hex(),n,s],r)}async updateTypedProperty(t,e,n,i,s,o,r){return this.submitTransaction(t,"update_typed_property",[o||this.tokenType,Co[i]],[be.ensure(e).hex(),n,s],r)}async transferTokenOwnership(t,e,n,i,s){const r=await new Bt(this.provider,{sender:t.address(),...s}).build("0x1::object::transfer",[i||this.tokenType],[be.ensure(e).hex(),be.ensure(n).hex()]),a=Qe.generateBCSTransaction(t,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async transfer(t,e){let n=e;if(n==null&&(n=(await this.provider.getTokenData(be.ensure(t.tokenAddress).hex())).current_token_datas_v2[0].is_fungible_v2),n){const o=t;return await new Kc(this.provider).transfer(o.owner,o.tokenAddress,o.recipient,o.amount,o.extraArgs)}const i=t;return await this.transferTokenOwnership(i.owner,i.tokenAddress,i.recipient,i.tokenType,i.extraArgs)}async burnObject(t,e,n,i){const o=await new Bt(this.provider,{sender:t.address(),...i}).build("0x1::object::burn",[n||"0x1::object::ObjectCore"],[be.ensure(e).hex()]),r=Qe.generateBCSTransaction(t,o);return(await this.provider.submitSignedBCSTransaction(r)).hash}},Ud="0x1::aptos_account::transfer_coins",lm="0x1::coin::transfer",vA=class{constructor(t){this.aptosClient=t}async transfer(t,e,n,i){var s,o,r;const a=((s=i==null?void 0:i.coinType)!=null?s:"").toString().includes("::");if(i!=null&&i.coinType&&!a&&yt.isValid(i.coinType)){console.warn("to transfer a fungible asset, use `FungibleAssetClient()` class for better support");const w=new ua({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(o=Fc[Id[this.aptosClient.nodeUrl]])!=null?o:this.aptosClient.nodeUrl});return await new Kc(w).transfer(t,i==null?void 0:i.coinType,yi(e),n)}const c=(r=i==null?void 0:i.coinType)!=null?r:jc;let u;(i==null?void 0:i.createReceiverIfMissing)===void 0?u=Ud:u=i!=null&&i.createReceiverIfMissing?Ud:lm;const l=yi(e),p=await new Bt(this.aptosClient,{sender:t.address(),...i}).build(u,[c],[l,n]),g=Qe.generateBCSTransaction(t,p);return(await this.aptosClient.submitSignedBCSTransaction(g)).hash}async checkBalance(t,e){var n,i,s;const o=((n=e==null?void 0:e.coinType)!=null?n:"").toString().includes("::");if(e!=null&&e.coinType&&!o&&yt.isValid(e.coinType)){console.warn("to check balance of a fungible asset, use `FungibleAssetClient()` class for better support");const l=new ua({fullnodeUrl:this.aptosClient.nodeUrl,indexerUrl:(i=Fc[Id[this.aptosClient.nodeUrl]])!=null?i:this.aptosClient.nodeUrl});return await new Kc(l).getPrimaryBalance(yi(t),e==null?void 0:e.coinType)}const a=`0x1::coin::CoinStore<${(s=e==null?void 0:e.coinType)!=null?s:jc}>`,c=yi(t),u=await this.aptosClient.getAccountResource(c,a);return BigInt(u.data.coin.value)}},TA=class extends Qe{constructor(t,e,n){if(super(t,n),!e)throw new Error("Faucet URL cannot be empty.");this.faucetUrl=e,this.config=n}async fundAccount(t,e,n=Hg){const{data:i}=await zs({url:this.faucetUrl,endpoint:"mint",body:null,params:{address:be.ensure(t).noPrefix(),amount:e},overrides:{...this.config},originMethod:"fundAccount"}),s=[];for(let o=0;o<i.length;o+=1){const r=i[o];s.push(this.waitForTransaction(r,{timeoutSecs:n}))}return await Promise.all(s),i}},Md={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c"},Fi=/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/,dm=new RegExp("^(?:(?<subdomain>[^.]+)\\.(?!apt$))?(?<domain>[^.]+)(?:\\.apt)?$"),AA=class{constructor(t,e){var n;if(this.provider=t,!Md[this.provider.network]&&!e)throw new Error("Error: For custom providers, you must pass in a contract address");this.contractAddress=(n=Md[this.provider.network])!=null?n:e}async getPrimaryNameByAddress(t){const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::ReverseLookupRegistryV1`)).data,{handle:i}=n.registry,s={key_type:"address",value_type:`${this.contractAddress}::domains::NameRecordKeyV1`,key:t};try{const o=await this.provider.getTableItem(i,s);return o.subdomain_name.vec[0]?`${o.subdomain_name.vec[0]}.${o.domain_name}`:o.domain_name}catch(o){if(o.status===404)return null;throw new Error(o)}}async getAddressByName(t){var e,n;const{domain:i,subdomain:s}=(n=(e=t.match(dm))==null?void 0:e.groups)!=null?n:{};if(!i)return null;const o=s?await this.getRegistrationForSubdomainName(i,s):await this.getRegistrationForDomainName(i);return o===null?null:o.target}async mintAptosName(t,e,n=1,i){if(e.match(Fi)===null)throw new On(400,`Name ${e} is not valid`);const s=await this.getRegistrationForDomainName(e);if(s&&Math.ceil(Date.now()/1e3)<s.expirationTimestampSeconds)throw new On(400,`Name ${e} is not available`);const r=await new Bt(this.provider.aptosClient,{sender:t.address(),...i}).build(`${this.contractAddress}::domains::register_domain`,[],[e,n]),a=Qe.generateBCSTransaction(t,r);return(await this.provider.submitSignedBCSTransaction(a)).hash}async mintAptosSubdomain(t,e,n,i,s){if(n.match(Fi)===null)throw new On(400,`Domain name ${n} is not valid`);if(e.match(Fi)===null)throw new On(400,`Subdomain name ${e} is not valid`);const o=await this.getRegistrationForSubdomainName(n,e);if(o&&Math.ceil(Date.now()/1e3)<o.expirationTimestampSeconds)throw new On(400,`Name ${e}.${n} is not available`);const r=await this.getRegistrationForDomainName(n);if(r===null)throw new On(400,`Domain name ${n} does not exist`);const a=Math.ceil(Date.now()/1e3);if(r.expirationTimestampSeconds<a)throw new On(400,`Domain name ${n} expired`);const c=i||r.expirationTimestampSeconds;if(c<a)throw new On(400,`Expiration for ${e}.${n} is before now`);const l=await new Bt(this.provider.aptosClient,{sender:t.address(),...s}).build(`${this.contractAddress}::domains::register_subdomain`,[],[e,n,c]),d=Qe.generateBCSTransaction(t,l);return(await this.provider.submitSignedBCSTransaction(d)).hash}async setSubdomainAddress(t,e,n,i,s){const o=yt.standardizeAddress(i);if(n.match(Fi)===null)throw new On(400,`Name ${n} is not valid`);if(e.match(Fi)===null)throw new On(400,`Name ${e} is not valid`);const a=await new Bt(this.provider.aptosClient,{sender:t.address(),...s}).build(`${this.contractAddress}::domains::set_subdomain_address`,[],[e,n,o]),c=Qe.generateBCSTransaction(t,a);return(await this.provider.submitSignedBCSTransaction(c)).hash}async initReverseLookupRegistry(t,e){const i=await new Bt(this.provider.aptosClient,{sender:t.address(),...e}).build(`${this.contractAddress}::domains::init_reverse_lookup_registry_v1`,[],[]),s=Qe.generateBCSTransaction(t,i);return(await this.provider.submitSignedBCSTransaction(s)).hash}async getRegistrationForDomainName(t){if(t.match(Fi)===null)return null;const n=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:i}=n.registry,s={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[]},domain_name:t}};try{const o=await this.provider.getTableItem(i,s);return{target:o.target_address.vec.length===1?o.target_address.vec[0]:null,expirationTimestampSeconds:o.expiration_time_sec}}catch(o){if(o.status===404)return null;throw new Error(o)}}async getRegistrationForSubdomainName(t,e){if(t.match(Fi)===null||e.match(Fi)===null)return null;const i=(await this.provider.getAccountResource(this.contractAddress,`${this.contractAddress}::domains::NameRegistryV1`)).data,{handle:s}=i.registry,o={key_type:`${this.contractAddress}::domains::NameRecordKeyV1`,value_type:`${this.contractAddress}::domains::NameRecordV1`,key:{subdomain_name:{vec:[e]},domain_name:t}};try{const r=await this.provider.getTableItem(s,o);return{target:r.target_address.vec.length===1?r.target_address.vec[0]:null,expirationTimestampSeconds:r.expiration_time_sec}}catch(r){if(r.status===404)return null;throw new Error(r)}}},Ga=()=>Math.floor(Date.now()/1e3),hm=class{constructor(t,e,n,i,s){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.provider=t,this.account=e,this.maxWaitTime=n,this.maximumInFlight=i,this.sleepTime=s}async nextSequenceNumber(){for(;this.lock;)await zr(this.sleepTime);this.lock=!0;let t=BigInt(0);try{if((this.lastUncommintedNumber===null||this.currentNumber===null)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();const e=Ga();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await zr(this.sleepTime),Ga()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):await this.update()}t=this.currentNumber,this.currentNumber+=BigInt(1)}catch(e){console.error("error in getting next sequence number for this account",e)}finally{this.lock=!1}return t}async initialize(){const{sequence_number:t}=await this.provider.getAccount(this.account.address());this.currentNumber=BigInt(t),this.lastUncommintedNumber=BigInt(t)}async update(){const{sequence_number:t}=await this.provider.getAccount(this.account.address());return this.lastUncommintedNumber=BigInt(t),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await zr(this.sleepTime);this.lock=!0;try{await this.update();const t=Ga();for(;this.lastUncommintedNumber!==this.currentNumber;)Ga()-t>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, resyncing ${this.account.address()}`),await this.initialize()):(await zr(this.sleepTime),await this.update())}catch(t){console.error("error in synchronizing this account sequence number with the one on chain",t)}finally{this.lock=!1}}}},od=class{constructor(){this.queue=[],this.resolveMap=new Map,this.counter=0,this.cancelled=!1}enqueue(t){if(this.resolveMap.size>0){const e=this.resolveMap.get(0);if(e){this.resolveMap.delete(0),e(t);return}}this.queue.push(t)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise(e=>{this.counter+=1,this.resolveMap.set(this.counter,e)})}isEmpty(){return this.queue.length===0}cancel(){this.cancelled=!0,this.resolveMap.forEach(async t=>{t(await Promise.reject(new Dd("Task cancelled")))}),this.resolveMap.clear(),this.queue.length=0}isCancelled(){return this.cancelled}},Dd=class extends Error{constructor(t){super(t)}},Ef="fulfilled",pm=(t=>(t.TransactionSent="transactionSent",t.TransactionSendFailed="transactionsendFailed",t.TransactionExecuted="transactionExecuted",t.TransactionExecutionFailed="transactionexecutionFailed",t))(pm||{}),kA=class extends Bd{constructor(t,e,n=30,i=100,s=10){super(),this.taskQueue=new od,this.transactionsQueue=new od,this.outstandingTransactions=new od,this.sentTransactions=[],this.executedTransactions=[],this.provider=t,this.account=e,this.started=!1,this.accountSequnceNumber=new hm(t,e,n,i,s)}async submitNextTransaction(){try{for(;;){if(this.transactionsQueue.isEmpty())return;const t=await this.accountSequnceNumber.nextSequenceNumber();if(t===null)return;const e=await this.generateNextTransaction(this.account,t);if(!e)return;const n=this.provider.submitSignedBCSTransaction(e);await this.outstandingTransactions.enqueue([n,t])}}catch(t){if(t instanceof Dd)return;console.log(t)}}async processTransactions(){try{for(;;){const t=[],e=[];let[n,i]=await this.outstandingTransactions.dequeue();for(t.push(n),e.push(i);!this.outstandingTransactions.isEmpty();)[n,i]=await this.outstandingTransactions.dequeue(),t.push(n),e.push(i);const s=await Promise.allSettled(t);for(let o=0;o<s.length&&o<e.length;o+=1){const r=s[o];i=e[o],r.status===Ef?(this.sentTransactions.push([r.value.hash,i,null]),this.emit("transactionSent",[this.sentTransactions.length,r.value.hash]),await this.checkTransaction(r,i)):(this.sentTransactions.push([r.status,i,r.reason]),this.emit("transactionsendFailed",[this.sentTransactions.length,r.reason]))}}}catch(t){if(t instanceof Dd)return;console.log(t)}}async checkTransaction(t,e){const n=[];n.push(this.provider.waitForTransactionWithResult(t.value.hash,{checkSuccess:!0}));const i=await Promise.allSettled(n);for(let s=0;s<i.length;s+=1){const o=i[s];o.status===Ef?(this.executedTransactions.push([o.value.hash,e,null]),this.emit("transactionExecuted",[this.executedTransactions.length,o.value.hash])):(this.executedTransactions.push([o.status,e,o.reason]),this.emit("transactionexecutionFailed",[this.executedTransactions.length,o.reason]))}}async push(t){await this.transactionsQueue.enqueue(t)}async generateNextTransaction(t,e){if(this.transactionsQueue.isEmpty())return;const n=await this.transactionsQueue.dequeue(),i=await this.provider.generateRawTransaction(t.address(),n,{providedSequenceNumber:e});return Qe.generateBCSTransaction(t,i)}async run(){try{for(;!this.taskQueue.isCancelled();)await(await this.taskQueue.dequeue())()}catch(t){throw new Error(t)}}start(){if(this.started)throw new Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw new Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},fm={};mu(fm,{AptosErrorCode:()=>gm,MoveFunctionVisibility:()=>mm,RoleType:()=>_m});var gm=(t=>(t.ACCOUNT_NOT_FOUND="account_not_found",t.RESOURCE_NOT_FOUND="resource_not_found",t.MODULE_NOT_FOUND="module_not_found",t.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",t.VERSION_NOT_FOUND="version_not_found",t.TRANSACTION_NOT_FOUND="transaction_not_found",t.TABLE_ITEM_NOT_FOUND="table_item_not_found",t.BLOCK_NOT_FOUND="block_not_found",t.STATE_VALUE_NOT_FOUND="state_value_not_found",t.VERSION_PRUNED="version_pruned",t.BLOCK_PRUNED="block_pruned",t.INVALID_INPUT="invalid_input",t.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",t.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",t.VM_ERROR="vm_error",t.HEALTH_CHECK_FAILED="health_check_failed",t.MEMPOOL_IS_FULL="mempool_is_full",t.INTERNAL_ERROR="internal_error",t.WEB_FRAMEWORK_ERROR="web_framework_error",t.BCS_NOT_SUPPORTED="bcs_not_supported",t.API_DISABLED="api_disabled",t))(gm||{}),mm=(t=>(t.PRIVATE="private",t.PUBLIC="public",t.FRIEND="friend",t))(mm||{}),_m=(t=>(t.VALIDATOR="validator",t.FULL_NODE="full_node",t))(_m||{}),ym=(t=>(t.AccountAddress="account_address",t.TransactionVersion="transaction_version",t))(ym||{}),wm=(t=>(t.AccountAddress="account_address",t.MinBlockHeight="min_block_height",t.NumDistinctVersions="num_distinct_versions",t))(wm||{}),bm=(t=>(t.AccountAddress="account_address",t.TransactionVersion="transaction_version",t))(bm||{}),vm=(t=>(t.Address="address",t.TransactionVersion="transaction_version",t))(vm||{}),Tm=(t=>(t.BlockHeight="block_height",t.Epoch="epoch",t.FailedProposerIndices="failed_proposer_indices",t.Id="id",t.PreviousBlockVotesBitvec="previous_block_votes_bitvec",t.Proposer="proposer",t.Round="round",t.Timestamp="timestamp",t.Version="version",t))(Tm||{}),Am=(t=>(t.ActivityType="activity_type",t.Amount="amount",t.BlockHeight="block_height",t.CoinType="coin_type",t.EntryFunctionIdStr="entry_function_id_str",t.EventAccountAddress="event_account_address",t.EventCreationNumber="event_creation_number",t.EventIndex="event_index",t.EventSequenceNumber="event_sequence_number",t.IsGasFee="is_gas_fee",t.IsTransactionSuccess="is_transaction_success",t.OwnerAddress="owner_address",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(Am||{}),km=(t=>(t.Amount="amount",t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.OwnerAddress="owner_address",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(km||{}),Sm=(t=>(t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.CreatorAddress="creator_address",t.Decimals="decimals",t.Name="name",t.SupplyAggregatorTableHandle="supply_aggregator_table_handle",t.SupplyAggregatorTableKey="supply_aggregator_table_key",t.Symbol="symbol",t.TransactionCreatedTimestamp="transaction_created_timestamp",t.TransactionVersionCreated="transaction_version_created",t))(Sm||{}),xm=(t=>(t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.Supply="supply",t.TransactionEpoch="transaction_epoch",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(xm||{}),Pm=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Description="description",t.DescriptionMutable="description_mutable",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Supply="supply",t.TableHandle="table_handle",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.UriMutable="uri_mutable",t))(Pm||{}),Em=(t=>(t.Domain="domain",t.ExpirationTimestamp="expiration_timestamp",t.IsDeleted="is_deleted",t.LastTransactionVersion="last_transaction_version",t.RegisteredAddress="registered_address",t.Subdomain="subdomain",t.TokenName="token_name",t))(Em||{}),Cm=(t=>(t.Domain="domain",t.ExpirationTimestamp="expiration_timestamp",t.IsPrimary="is_primary",t.LastTransactionVersion="last_transaction_version",t.RegisteredAddress="registered_address",t.Subdomain="subdomain",t.TokenName="token_name",t))(Cm||{}),Bm=(t=>(t.Amount="amount",t.CoinType="coin_type",t.CoinTypeHash="coin_type_hash",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t))(Bm||{}),Im=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Description="description",t.DescriptionMutable="description_mutable",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Supply="supply",t.TableHandle="table_handle",t.UriMutable="uri_mutable",t))(Im||{}),Om=(t=>(t.CollectionId="collection_id",t.CollectionName="collection_name",t.CollectionUri="collection_uri",t.CreatorAddress="creator_address",t.DistinctTokens="distinct_tokens",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t.SingleTokenUri="single_token_uri",t))(Om||{}),Rm=(t=>(t.CollectionId="collection_id",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.CurrentSupply="current_supply",t.Description="description",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.MaxSupply="max_supply",t.MutableDescription="mutable_description",t.MutableUri="mutable_uri",t.TableHandleV1="table_handle_v1",t.TokenStandard="token_standard",t.TotalMintedV2="total_minted_v2",t.Uri="uri",t))(Rm||{}),$m=(t=>(t.ActiveTableHandle="active_table_handle",t.InactiveTableHandle="inactive_table_handle",t.LastTransactionVersion="last_transaction_version",t.OperatorCommissionPercentage="operator_commission_percentage",t.StakingPoolAddress="staking_pool_address",t.TotalCoins="total_coins",t.TotalShares="total_shares",t))($m||{}),Um=(t=>(t.DelegationPoolAddress="delegation_pool_address",t.DelegatorAddress="delegator_address",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.PendingVoter="pending_voter",t.TableHandle="table_handle",t.Voter="voter",t))(Um||{}),Mm=(t=>(t.DelegatorAddress="delegator_address",t.LastTransactionVersion="last_transaction_version",t.ParentTableHandle="parent_table_handle",t.PoolAddress="pool_address",t.PoolType="pool_type",t.Shares="shares",t.TableHandle="table_handle",t))(Mm||{}),Dm=(t=>(t.Amount="amount",t.AssetType="asset_type",t.IsFrozen="is_frozen",t.IsPrimary="is_primary",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t.StorageId="storage_id",t.TokenStandard="token_standard",t))(Dm||{}),qm=(t=>(t.AllowUngatedTransfer="allow_ungated_transfer",t.IsDeleted="is_deleted",t.LastGuidCreationNum="last_guid_creation_num",t.LastTransactionVersion="last_transaction_version",t.ObjectAddress="object_address",t.OwnerAddress="owner_address",t.StateKeyHash="state_key_hash",t))(qm||{}),Lm=(t=>(t.LastTransactionVersion="last_transaction_version",t.OperatorAddress="operator_address",t.StakingPoolAddress="staking_pool_address",t.VoterAddress="voter_address",t))(Lm||{}),Nm=(t=>(t.DecodedKey="decoded_key",t.DecodedValue="decoded_value",t.IsDeleted="is_deleted",t.Key="key",t.KeyHash="key_hash",t.LastTransactionVersion="last_transaction_version",t.TableHandle="table_handle",t))(Nm||{}),jm=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.DefaultProperties="default_properties",t.Description="description",t.DescriptionMutable="description_mutable",t.LargestPropertyVersion="largest_property_version",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Name="name",t.PayeeAddress="payee_address",t.PropertiesMutable="properties_mutable",t.RoyaltyMutable="royalty_mutable",t.RoyaltyPointsDenominator="royalty_points_denominator",t.RoyaltyPointsNumerator="royalty_points_numerator",t.Supply="supply",t.TokenDataIdHash="token_data_id_hash",t.UriMutable="uri_mutable",t))(jm||{}),Fm=(t=>(t.CollectionId="collection_id",t.Description="description",t.IsFungibleV2="is_fungible_v2",t.LargestPropertyVersionV1="largest_property_version_v1",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Maximum="maximum",t.Supply="supply",t.TokenDataId="token_data_id",t.TokenName="token_name",t.TokenProperties="token_properties",t.TokenStandard="token_standard",t.TokenUri="token_uri",t))(Fm||{}),zm=(t=>(t.Amount="amount",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Name="name",t.OwnerAddress="owner_address",t.PropertyVersion="property_version",t.TableType="table_type",t.TokenDataIdHash="token_data_id_hash",t.TokenProperties="token_properties",t))(zm||{}),Hm=(t=>(t.Amount="amount",t.IsFungibleV2="is_fungible_v2",t.IsSoulboundV2="is_soulbound_v2",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.OwnerAddress="owner_address",t.PropertyVersionV1="property_version_v1",t.StorageId="storage_id",t.TableTypeV1="table_type_v1",t.TokenDataId="token_data_id",t.TokenPropertiesMutatedV1="token_properties_mutated_v1",t.TokenStandard="token_standard",t))(Hm||{}),Km=(t=>(t.Amount="amount",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionId="collection_id",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.FromAddress="from_address",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Name="name",t.PropertyVersion="property_version",t.TableHandle="table_handle",t.ToAddress="to_address",t.TokenDataId="token_data_id",t.TokenDataIdHash="token_data_id_hash",t))(Km||{}),Gm=(t=>(t.Asc="ASC",t.Desc="DESC",t))(Gm||{}),Wm=(t=>(t.Amount="amount",t.DelegatorAddress="delegator_address",t.EventIndex="event_index",t.EventType="event_type",t.PoolAddress="pool_address",t.TransactionVersion="transaction_version",t))(Wm||{}),Vm=(t=>(t.FirstTransactionVersion="first_transaction_version",t.StakingPoolAddress="staking_pool_address",t))(Vm||{}),Xm=(t=>(t.DelegatorAddress="delegator_address",t.PoolAddress="pool_address",t))(Xm||{}),Jm=(t=>(t.AccountAddress="account_address",t.CreationNumber="creation_number",t.Data="data",t.EventIndex="event_index",t.SequenceNumber="sequence_number",t.TransactionBlockHeight="transaction_block_height",t.TransactionVersion="transaction_version",t.Type="type",t))(Jm||{}),Zm=(t=>(t.Amount="amount",t.AssetType="asset_type",t.BlockHeight="block_height",t.EntryFunctionIdStr="entry_function_id_str",t.EventIndex="event_index",t.GasFeePayerAddress="gas_fee_payer_address",t.IsFrozen="is_frozen",t.IsGasFee="is_gas_fee",t.IsTransactionSuccess="is_transaction_success",t.OwnerAddress="owner_address",t.StorageId="storage_id",t.TokenStandard="token_standard",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.Type="type",t))(Zm||{}),Ym=(t=>(t.AssetType="asset_type",t.CreatorAddress="creator_address",t.Decimals="decimals",t.IconUri="icon_uri",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Name="name",t.ProjectUri="project_uri",t.SupplyAggregatorTableHandleV1="supply_aggregator_table_handle_v1",t.SupplyAggregatorTableKeyV1="supply_aggregator_table_key_v1",t.Symbol="symbol",t.TokenStandard="token_standard",t))(Ym||{}),Qm=(t=>(t.Db="db",t.IsIndexerUp="is_indexer_up",t))(Qm||{}),e_=(t=>(t.ChainId="chain_id",t))(e_||{}),t_=(t=>(t.Address="address",t.TransactionVersion="transaction_version",t))(t_||{}),n_=(t=>(t.BuyItNowPrice="buy_it_now_price",t.CoinType="coin_type",t.CollectionId="collection_id",t.ContractAddress="contract_address",t.CurrentBidPrice="current_bid_price",t.CurrentBidder="current_bidder",t.EntryFunctionIdStr="entry_function_id_str",t.ExpirationTime="expiration_time",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.ListingId="listing_id",t.Marketplace="marketplace",t.Seller="seller",t.StartingBidPrice="starting_bid_price",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t))(n_||{}),i_=(t=>(t.Buyer="buyer",t.CoinType="coin_type",t.CollectionId="collection_id",t.CollectionOfferId="collection_offer_id",t.ContractAddress="contract_address",t.EntryFunctionIdStr="entry_function_id_str",t.ExpirationTime="expiration_time",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.ItemPrice="item_price",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Marketplace="marketplace",t.RemainingTokenAmount="remaining_token_amount",t.TokenStandard="token_standard",t))(i_||{}),s_=(t=>(t.CoinType="coin_type",t.CollectionId="collection_id",t.ContractAddress="contract_address",t.EntryFunctionIdStr="entry_function_id_str",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.ListingId="listing_id",t.Marketplace="marketplace",t.Price="price",t.Seller="seller",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t))(s_||{}),o_=(t=>(t.Buyer="buyer",t.CoinType="coin_type",t.CollectionId="collection_id",t.ContractAddress="contract_address",t.EntryFunctionIdStr="entry_function_id_str",t.ExpirationTime="expiration_time",t.FeeScheduleId="fee_schedule_id",t.IsDeleted="is_deleted",t.LastTransactionTimestamp="last_transaction_timestamp",t.LastTransactionVersion="last_transaction_version",t.Marketplace="marketplace",t.OfferId="offer_id",t.Price="price",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t))(o_||{}),r_=(t=>(t.Buyer="buyer",t.CoinType="coin_type",t.CollectionId="collection_id",t.CollectionName="collection_name",t.ContractAddress="contract_address",t.CreatorAddress="creator_address",t.EntryFunctionIdStr="entry_function_id_str",t.EventIndex="event_index",t.EventType="event_type",t.FeeScheduleId="fee_schedule_id",t.Marketplace="marketplace",t.OfferOrListingId="offer_or_listing_id",t.Price="price",t.PropertyVersion="property_version",t.Seller="seller",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenName="token_name",t.TokenStandard="token_standard",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(r_||{}),a_=(t=>(t.AssetUri="asset_uri",t.CdnAnimationUri="cdn_animation_uri",t.CdnImageUri="cdn_image_uri",t.CdnJsonUri="cdn_json_uri",t.RawAnimationUri="raw_animation_uri",t.RawImageUri="raw_image_uri",t))(a_||{}),c_=(t=>(t.NumActiveDelegator="num_active_delegator",t.PoolAddress="pool_address",t))(c_||{}),u_=(t=>(t.Asc="asc",t.AscNullsFirst="asc_nulls_first",t.AscNullsLast="asc_nulls_last",t.Desc="desc",t.DescNullsFirst="desc_nulls_first",t.DescNullsLast="desc_nulls_last",t))(u_||{}),l_=(t=>(t.LastSuccessVersion="last_success_version",t.LastUpdated="last_updated",t.Processor="processor",t))(l_||{}),d_=(t=>(t.NumVotes="num_votes",t.ProposalId="proposal_id",t.ShouldPass="should_pass",t.StakingPoolAddress="staking_pool_address",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.VoterAddress="voter_address",t))(d_||{}),h_=(t=>(t.DecodedKey="decoded_key",t.DecodedValue="decoded_value",t.Key="key",t.TableHandle="table_handle",t.TransactionVersion="transaction_version",t.WriteSetChangeIndex="write_set_change_index",t))(h_||{}),p_=(t=>(t.Handle="handle",t.KeyType="key_type",t.ValueType="value_type",t))(p_||{}),f_=(t=>(t.CoinAmount="coin_amount",t.CoinType="coin_type",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.EventAccountAddress="event_account_address",t.EventCreationNumber="event_creation_number",t.EventIndex="event_index",t.EventSequenceNumber="event_sequence_number",t.FromAddress="from_address",t.Name="name",t.PropertyVersion="property_version",t.ToAddress="to_address",t.TokenAmount="token_amount",t.TokenDataIdHash="token_data_id_hash",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.TransferType="transfer_type",t))(f_||{}),g_=(t=>(t.AfterValue="after_value",t.BeforeValue="before_value",t.EntryFunctionIdStr="entry_function_id_str",t.EventAccountAddress="event_account_address",t.EventIndex="event_index",t.FromAddress="from_address",t.IsFungibleV2="is_fungible_v2",t.PropertyVersionV1="property_version_v1",t.ToAddress="to_address",t.TokenAmount="token_amount",t.TokenDataId="token_data_id",t.TokenStandard="token_standard",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.Type="type",t))(g_||{}),m_=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.DefaultProperties="default_properties",t.Description="description",t.DescriptionMutable="description_mutable",t.LargestPropertyVersion="largest_property_version",t.Maximum="maximum",t.MaximumMutable="maximum_mutable",t.MetadataUri="metadata_uri",t.Name="name",t.PayeeAddress="payee_address",t.PropertiesMutable="properties_mutable",t.RoyaltyMutable="royalty_mutable",t.RoyaltyPointsDenominator="royalty_points_denominator",t.RoyaltyPointsNumerator="royalty_points_numerator",t.Supply="supply",t.TokenDataIdHash="token_data_id_hash",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t.UriMutable="uri_mutable",t))(m_||{}),__=(t=>(t.Amount="amount",t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Name="name",t.OwnerAddress="owner_address",t.PropertyVersion="property_version",t.TableHandle="table_handle",t.TableType="table_type",t.TokenDataIdHash="token_data_id_hash",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(__||{}),y_=(t=>(t.CollectionDataIdHash="collection_data_id_hash",t.CollectionName="collection_name",t.CreatorAddress="creator_address",t.Name="name",t.PropertyVersion="property_version",t.TokenDataIdHash="token_data_id_hash",t.TokenProperties="token_properties",t.TransactionTimestamp="transaction_timestamp",t.TransactionVersion="transaction_version",t))(y_||{}),w_=(t=>(t.BlockHeight="block_height",t.EntryFunctionIdStr="entry_function_id_str",t.Epoch="epoch",t.ExpirationTimestampSecs="expiration_timestamp_secs",t.GasUnitPrice="gas_unit_price",t.MaxGasAmount="max_gas_amount",t.ParentSignatureType="parent_signature_type",t.Sender="sender",t.SequenceNumber="sequence_number",t.Timestamp="timestamp",t.Version="version",t))(w_||{});const v5=Object.freeze(Object.defineProperty({__proto__:null,APTOS_COIN:jc,AccountSequenceNumber:hm,Account_Transactions_Select_Column:ym,Address_Events_Summary_Select_Column:wm,Address_Version_From_Events_Select_Column:bm,Address_Version_From_Move_Resources_Select_Column:vm,AnsClient:AA,ApiError:On,AptosAccount:ca,AptosApiError:Ph,AptosClient:Qe,AptosToken:bA,BCS:Vg,Block_Metadata_Transactions_Select_Column:Tm,CKDPriv:Lg,COIN_TRANSFER:lm,CoinClient:vA,Coin_Activities_Select_Column:Am,Coin_Balances_Select_Column:km,Coin_Infos_Select_Column:Sm,Coin_Supply_Select_Column:xm,Collection_Datas_Select_Column:Pm,Current_Ans_Lookup_Select_Column:Em,Current_Aptos_Names_Select_Column:Cm,Current_Coin_Balances_Select_Column:Bm,Current_Collection_Datas_Select_Column:Im,Current_Collection_Ownership_V2_View_Select_Column:Om,Current_Collections_V2_Select_Column:Rm,Current_Delegated_Staking_Pool_Balances_Select_Column:$m,Current_Delegated_Voter_Select_Column:Um,Current_Delegator_Balances_Select_Column:Mm,Current_Fungible_Asset_Balances_Select_Column:Dm,Current_Objects_Select_Column:qm,Current_Staking_Pool_Voter_Select_Column:Lm,Current_Table_Items_Select_Column:Nm,Current_Token_Datas_Select_Column:jm,Current_Token_Datas_V2_Select_Column:Fm,Current_Token_Ownerships_Select_Column:zm,Current_Token_Ownerships_V2_Select_Column:Hm,Current_Token_Pending_Claims_Select_Column:Km,Cursor_Ordering:Gm,Delegated_Staking_Activities_Select_Column:Wm,Delegated_Staking_Pools_Select_Column:Vm,Delegator_Distinct_Pool_Select_Column:Xm,Events_Select_Column:Jm,FailedTransactionError:sm,FaucetClient:TA,FungibleAssetClient:Kc,Fungible_Asset_Activities_Select_Column:Zm,Fungible_Asset_Metadata_Select_Column:Ym,HexString:be,IndexerClient:qt,Indexer_Status_Select_Column:Qm,Ledger_Infos_Select_Column:e_,Move_Resources_Select_Column:t_,Network:Wg,NetworkToIndexerAPI:Fc,NetworkToNodeAPI:Gg,Nft_Marketplace_V2_Current_Nft_Marketplace_Auctions_Select_Column:n_,Nft_Marketplace_V2_Current_Nft_Marketplace_Collection_Offers_Select_Column:i_,Nft_Marketplace_V2_Current_Nft_Marketplace_Listings_Select_Column:s_,Nft_Marketplace_V2_Current_Nft_Marketplace_Token_Offers_Select_Column:o_,Nft_Marketplace_V2_Nft_Marketplace_Activities_Select_Column:r_,Nft_Metadata_Crawler_Parsed_Asset_Uris_Select_Column:a_,NodeAPIToNetwork:Id,Num_Active_Delegator_Per_Pool_Select_Column:c_,Order_By:u_,Processor_Status_Select_Column:l_,PropertyMap:Nu,PropertyValue:zh,Proposal_Votes_Select_Column:d_,Provider:ua,TRANSFER_COINS:Ud,Table_Items_Select_Column:h_,Table_Metadatas_Select_Column:p_,TokenClient:wA,TokenTypes:am,Token_Activities_Select_Column:f_,Token_Activities_V2_Select_Column:g_,Token_Datas_Select_Column:m_,Token_Ownerships_Select_Column:__,Tokens_Select_Column:y_,TransactionBuilder:wi,TransactionBuilderABI:zc,TransactionBuilderEd25519:Tc,TransactionBuilderMultiEd25519:nm,TransactionBuilderRemoteABI:Bt,TransactionWorker:kA,TransactionWorkerEvents:pm,TxnBuilderTypes:qe,TypeTagParser:mo,Types:fm,User_Transactions_Select_Column:w_,WaitForTransactionError:im,ansContractsMap:Md,aptosRequest:Eh,argToTransactionArgument:tm,derivePath:jg,deserializePropertyMap:Hh,deserializeValueBasedOnTypeTag:rm,ensureBigInt:Xs,ensureBoolean:jh,ensureNumber:Vs,get:Sn,getAddressFromAccountOrAddress:yi,getMasterKeyFromSeed:qg,getPropertyType:ju,getPropertyValueRaw:Hc,getPublicKey:yT,getSinglePropertyValueRaw:$d,isValidPath:Ng,nameComponentPattern:Fi,namePattern:dm,post:zs,serializeArg:Lu},Symbol.toStringTag,{value:"Module"}));var Kn={},an={};Object.defineProperty(an,"__esModule",{value:!0});an.output=an.exists=an.hash=an.bytes=an.bool=an.number=void 0;function Gc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}an.number=Gc;function b_(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}an.bool=b_;function Kh(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}an.bytes=Kh;function v_(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Gc(t.outputLen),Gc(t.blockLen)}an.hash=v_;function T_(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}an.exists=T_;function A_(t,e){Kh(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}an.output=A_;const SA={number:Gc,bool:b_,bytes:Kh,hash:v_,exists:T_,output:A_};an.default=SA;var pr={},k_={},yo={},Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});Fu.crypto=void 0;Fu.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=t.wrapConstructorWithOpts=t.wrapConstructor=t.checkOpts=t.Hash=t.concatBytes=t.toBytes=t.utf8ToBytes=t.asyncLoop=t.nextTick=t.hexToBytes=t.bytesToHex=t.isLE=t.rotr=t.createView=t.u32=t.u8=void 0;const e=Fu,n=S=>new Uint8Array(S.buffer,S.byteOffset,S.byteLength);t.u8=n;const i=S=>new Uint32Array(S.buffer,S.byteOffset,Math.floor(S.byteLength/4));t.u32=i;const s=S=>new DataView(S.buffer,S.byteOffset,S.byteLength);t.createView=s;const o=(S,$)=>S<<32-$|S>>>$;if(t.rotr=o,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const r=Array.from({length:256},(S,$)=>$.toString(16).padStart(2,"0"));function a(S){if(!(S instanceof Uint8Array))throw new Error("Uint8Array expected");let $="";for(let H=0;H<S.length;H++)$+=r[S[H]];return $}t.bytesToHex=a;function c(S){if(typeof S!="string")throw new TypeError("hexToBytes: expected string, got "+typeof S);if(S.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const $=new Uint8Array(S.length/2);for(let H=0;H<$.length;H++){const V=H*2,z=S.slice(V,V+2),X=Number.parseInt(z,16);if(Number.isNaN(X)||X<0)throw new Error("Invalid byte sequence");$[H]=X}return $}t.hexToBytes=c;const u=async()=>{};t.nextTick=u;async function l(S,$,H){let V=Date.now();for(let z=0;z<S;z++){H(z);const X=Date.now()-V;X>=0&&X<$||(await(0,t.nextTick)(),V+=X)}}t.asyncLoop=l;function d(S){if(typeof S!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof S}`);return new TextEncoder().encode(S)}t.utf8ToBytes=d;function p(S){if(typeof S=="string"&&(S=d(S)),!(S instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof S})`);return S}t.toBytes=p;function g(...S){if(!S.every(V=>V instanceof Uint8Array))throw new Error("Uint8Array list expected");if(S.length===1)return S[0];const $=S.reduce((V,z)=>V+z.length,0),H=new Uint8Array($);for(let V=0,z=0;V<S.length;V++){const X=S[V];H.set(X,z),z+=X.length}return H}t.concatBytes=g;class b{clone(){return this._cloneInto()}}t.Hash=b;const w=S=>Object.prototype.toString.call(S)==="[object Object]"&&S.constructor===Object;function T(S,$){if($!==void 0&&(typeof $!="object"||!w($)))throw new TypeError("Options should be object or undefined");return Object.assign(S,$)}t.checkOpts=T;function E(S){const $=V=>S().update(p(V)).digest(),H=S();return $.outputLen=H.outputLen,$.blockLen=H.blockLen,$.create=()=>S(),$}t.wrapConstructor=E;function P(S){const $=(V,z)=>S(z).update(p(V)).digest(),H=S({});return $.outputLen=H.outputLen,$.blockLen=H.blockLen,$.create=V=>S(V),$}t.wrapConstructorWithOpts=P;function k(S=32){if(e.crypto.web)return e.crypto.web.getRandomValues(new Uint8Array(S));if(e.crypto.node)return new Uint8Array(e.crypto.node.randomBytes(S).buffer);throw new Error("The environment doesn't have randomBytes function")}t.randomBytes=k})(yo);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=void 0;const e=an,n=yo;class i extends n.Hash{constructor(r,a){super(),this.finished=!1,this.destroyed=!1,e.default.hash(r);const c=(0,n.toBytes)(a);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const u=this.blockLen,l=new Uint8Array(u);l.set(c.length>u?r.create().update(c).digest():c);for(let d=0;d<l.length;d++)l[d]^=54;this.iHash.update(l),this.oHash=r.create();for(let d=0;d<l.length;d++)l[d]^=106;this.oHash.update(l),l.fill(0)}update(r){return e.default.exists(this),this.iHash.update(r),this}digestInto(r){e.default.exists(this),e.default.bytes(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:a,iHash:c,finished:u,destroyed:l,blockLen:d,outputLen:p}=this;return r=r,r.finished=u,r.destroyed=l,r.blockLen=d,r.outputLen=p,r.oHash=a._cloneInto(r.oHash),r.iHash=c._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(o,r,a)=>new i(o,r).update(a).digest();t.hmac=s,t.hmac.create=(o,r)=>new i(o,r)})(k_);Object.defineProperty(pr,"__esModule",{value:!0});pr.pbkdf2Async=pr.pbkdf2=void 0;const Wa=an,xA=k_,Jo=yo;function S_(t,e,n,i){Wa.default.hash(t);const s=(0,Jo.checkOpts)({dkLen:32,asyncTick:10},i),{c:o,dkLen:r,asyncTick:a}=s;if(Wa.default.number(o),Wa.default.number(r),Wa.default.number(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=(0,Jo.toBytes)(e),u=(0,Jo.toBytes)(n),l=new Uint8Array(r),d=xA.hmac.create(t,c),p=d._cloneInto().update(u);return{c:o,dkLen:r,asyncTick:a,DK:l,PRF:d,PRFSalt:p}}function x_(t,e,n,i,s){return t.destroy(),e.destroy(),i&&i.destroy(),s.fill(0),n}function PA(t,e,n,i){const{c:s,dkLen:o,DK:r,PRF:a,PRFSalt:c}=S_(t,e,n,i);let u;const l=new Uint8Array(4),d=(0,Jo.createView)(l),p=new Uint8Array(a.outputLen);for(let g=1,b=0;b<o;g++,b+=a.outputLen){const w=r.subarray(b,b+a.outputLen);d.setInt32(0,g,!1),(u=c._cloneInto(u)).update(l).digestInto(p),w.set(p.subarray(0,w.length));for(let T=1;T<s;T++){a._cloneInto(u).update(p).digestInto(p);for(let E=0;E<w.length;E++)w[E]^=p[E]}}return x_(a,c,r,u,p)}pr.pbkdf2=PA;async function EA(t,e,n,i){const{c:s,dkLen:o,asyncTick:r,DK:a,PRF:c,PRFSalt:u}=S_(t,e,n,i);let l;const d=new Uint8Array(4),p=(0,Jo.createView)(d),g=new Uint8Array(c.outputLen);for(let b=1,w=0;w<o;b++,w+=c.outputLen){const T=a.subarray(w,w+c.outputLen);p.setInt32(0,b,!1),(l=u._cloneInto(l)).update(d).digestInto(g),T.set(g.subarray(0,T.length)),await(0,Jo.asyncLoop)(s-1,r,E=>{c._cloneInto(l).update(g).digestInto(g);for(let P=0;P<T.length;P++)T[P]^=g[P]})}return x_(c,u,a,l,g)}pr.pbkdf2Async=EA;var fr={},Ba={};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.SHA2=void 0;const rd=an,Lr=yo;function CA(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}let BA=class extends Lr.Hash{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,Lr.createView)(this.buffer)}update(e){rd.default.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=(0,Lr.toBytes)(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=(0,Lr.createView)(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){rd.default.exists(this),rd.default.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let d=r;d<s;d++)n[d]=0;CA(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=(0,Lr.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}};Ba.SHA2=BA;Object.defineProperty(fr,"__esModule",{value:!0});fr.sha224=fr.sha256=void 0;const IA=Ba,ei=yo,OA=(t,e,n)=>t&e^~t&n,RA=(t,e,n)=>t&e^t&n^e&n,$A=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),us=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ls=new Uint32Array(64);class P_ extends IA.SHA2{constructor(){super(64,32,8,!1),this.A=us[0]|0,this.B=us[1]|0,this.C=us[2]|0,this.D=us[3]|0,this.E=us[4]|0,this.F=us[5]|0,this.G=us[6]|0,this.H=us[7]|0}get(){const{A:e,B:n,C:i,D:s,E:o,F:r,G:a,H:c}=this;return[e,n,i,s,o,r,a,c]}set(e,n,i,s,o,r,a,c){this.A=e|0,this.B=n|0,this.C=i|0,this.D=s|0,this.E=o|0,this.F=r|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)ls[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const p=ls[d-15],g=ls[d-2],b=(0,ei.rotr)(p,7)^(0,ei.rotr)(p,18)^p>>>3,w=(0,ei.rotr)(g,17)^(0,ei.rotr)(g,19)^g>>>10;ls[d]=w+ls[d-7]+b+ls[d-16]|0}let{A:i,B:s,C:o,D:r,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const p=(0,ei.rotr)(a,6)^(0,ei.rotr)(a,11)^(0,ei.rotr)(a,25),g=l+p+OA(a,c,u)+$A[d]+ls[d]|0,w=((0,ei.rotr)(i,2)^(0,ei.rotr)(i,13)^(0,ei.rotr)(i,22))+RA(i,s,o)|0;l=u,u=c,c=a,a=r+g|0,r=o,o=s,s=i,i=g+w|0}i=i+this.A|0,s=s+this.B|0,o=o+this.C|0,r=r+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,s,o,r,a,c,u,l)}roundClean(){ls.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class UA extends P_{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}fr.sha256=(0,ei.wrapConstructor)(()=>new P_);fr.sha224=(0,ei.wrapConstructor)(()=>new UA);var ci={},E_={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.add=t.toBig=t.split=t.fromBig=void 0;const e=BigInt(2**32-1),n=BigInt(32);function i(L,B=!1){return B?{h:Number(L&e),l:Number(L>>n&e)}:{h:Number(L>>n&e)|0,l:Number(L&e)|0}}t.fromBig=i;function s(L,B=!1){let O=new Uint32Array(L.length),v=new Uint32Array(L.length);for(let h=0;h<L.length;h++){const{h:_,l:A}=i(L[h],B);[O[h],v[h]]=[_,A]}return[O,v]}t.split=s;const o=(L,B)=>BigInt(L>>>0)<<n|BigInt(B>>>0);t.toBig=o;const r=(L,B,O)=>L>>>O,a=(L,B,O)=>L<<32-O|B>>>O,c=(L,B,O)=>L>>>O|B<<32-O,u=(L,B,O)=>L<<32-O|B>>>O,l=(L,B,O)=>L<<64-O|B>>>O-32,d=(L,B,O)=>L>>>O-32|B<<64-O,p=(L,B)=>B,g=(L,B)=>L,b=(L,B,O)=>L<<O|B>>>32-O,w=(L,B,O)=>B<<O|L>>>32-O,T=(L,B,O)=>B<<O-32|L>>>64-O,E=(L,B,O)=>L<<O-32|B>>>64-O;function P(L,B,O,v){const h=(B>>>0)+(v>>>0);return{h:L+O+(h/2**32|0)|0,l:h|0}}t.add=P;const k=(L,B,O)=>(L>>>0)+(B>>>0)+(O>>>0),S=(L,B,O,v)=>B+O+v+(L/2**32|0)|0,$=(L,B,O,v)=>(L>>>0)+(B>>>0)+(O>>>0)+(v>>>0),H=(L,B,O,v,h)=>B+O+v+h+(L/2**32|0)|0,V=(L,B,O,v,h)=>(L>>>0)+(B>>>0)+(O>>>0)+(v>>>0)+(h>>>0),z=(L,B,O,v,h,_)=>B+O+v+h+_+(L/2**32|0)|0,X={fromBig:i,split:s,toBig:t.toBig,shrSH:r,shrSL:a,rotrSH:c,rotrSL:u,rotrBH:l,rotrBL:d,rotr32H:p,rotr32L:g,rotlSH:b,rotlSL:w,rotlBH:T,rotlBL:E,add:P,add3L:k,add3H:S,add4L:$,add4H:H,add5H:z,add5L:V};t.default=X})(E_);Object.defineProperty(ci,"__esModule",{value:!0});ci.sha384=ci.sha512_256=ci.sha512_224=ci.sha512=ci.SHA512=void 0;const MA=Ba,rt=E_,zu=yo,[DA,qA]=rt.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ds=new Uint32Array(80),hs=new Uint32Array(80);let Ia=class extends MA.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:p,Gh:g,Gl:b,Hh:w,Hl:T}=this;return[e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T]}set(e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=p|0,this.Gh=g|0,this.Gl=b|0,this.Hh=w|0,this.Hl=T|0}process(e,n){for(let k=0;k<16;k++,n+=4)ds[k]=e.getUint32(n),hs[k]=e.getUint32(n+=4);for(let k=16;k<80;k++){const S=ds[k-15]|0,$=hs[k-15]|0,H=rt.default.rotrSH(S,$,1)^rt.default.rotrSH(S,$,8)^rt.default.shrSH(S,$,7),V=rt.default.rotrSL(S,$,1)^rt.default.rotrSL(S,$,8)^rt.default.shrSL(S,$,7),z=ds[k-2]|0,X=hs[k-2]|0,L=rt.default.rotrSH(z,X,19)^rt.default.rotrBH(z,X,61)^rt.default.shrSH(z,X,6),B=rt.default.rotrSL(z,X,19)^rt.default.rotrBL(z,X,61)^rt.default.shrSL(z,X,6),O=rt.default.add4L(V,B,hs[k-7],hs[k-16]),v=rt.default.add4H(O,H,L,ds[k-7],ds[k-16]);ds[k]=v|0,hs[k]=O|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:p,Fh:g,Fl:b,Gh:w,Gl:T,Hh:E,Hl:P}=this;for(let k=0;k<80;k++){const S=rt.default.rotrSH(d,p,14)^rt.default.rotrSH(d,p,18)^rt.default.rotrBH(d,p,41),$=rt.default.rotrSL(d,p,14)^rt.default.rotrSL(d,p,18)^rt.default.rotrBL(d,p,41),H=d&g^~d&w,V=p&b^~p&T,z=rt.default.add5L(P,$,V,qA[k],hs[k]),X=rt.default.add5H(z,E,S,H,DA[k],ds[k]),L=z|0,B=rt.default.rotrSH(i,s,28)^rt.default.rotrBH(i,s,34)^rt.default.rotrBH(i,s,39),O=rt.default.rotrSL(i,s,28)^rt.default.rotrBL(i,s,34)^rt.default.rotrBL(i,s,39),v=i&o^i&a^o&a,h=s&r^s&c^r&c;E=w|0,P=T|0,w=g|0,T=b|0,g=d|0,b=p|0,{h:d,l:p}=rt.default.add(u|0,l|0,X|0,L|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const _=rt.default.add3L(L,O,h);i=rt.default.add3H(_,X,B,v),s=_|0}({h:i,l:s}=rt.default.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=rt.default.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=rt.default.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=rt.default.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:p}=rt.default.add(this.Eh|0,this.El|0,d|0,p|0),{h:g,l:b}=rt.default.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:w,l:T}=rt.default.add(this.Gh|0,this.Gl|0,w|0,T|0),{h:E,l:P}=rt.default.add(this.Hh|0,this.Hl|0,E|0,P|0),this.set(i,s,o,r,a,c,u,l,d,p,g,b,w,T,E,P)}roundClean(){ds.fill(0),hs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ci.SHA512=Ia;class LA extends Ia{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}let NA=class extends Ia{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},jA=class extends Ia{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};ci.sha512=(0,zu.wrapConstructor)(()=>new Ia);ci.sha512_224=(0,zu.wrapConstructor)(()=>new LA);ci.sha512_256=(0,zu.wrapConstructor)(()=>new NA);ci.sha384=(0,zu.wrapConstructor)(()=>new jA);Object.defineProperty(Kn,"__esModule",{value:!0});var C_=Kn.mnemonicToSeedSync=Kn.mnemonicToSeed=Kn.validateMnemonic=Kn.entropyToMnemonic=Kn.mnemonicToEntropy=Kn.generateMnemonic=void 0;/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */const B_=an,I_=pr,FA=fr,O_=ci,zA=yo,Va=fh,HA=t=>t[0]==="あいこくしん";function R_(t){if(typeof t!="string")throw new TypeError(`Invalid mnemonic type: ${typeof t}`);return t.normalize("NFKD")}function Gh(t){const e=R_(t),n=e.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:n}}function $_(t){B_.default.bytes(t,16,20,24,28,32)}function KA(t,e=128){if(B_.default.number(e),e%32!==0||e>256)throw new TypeError("Invalid entropy");return D_((0,zA.randomBytes)(e/8),t)}Kn.generateMnemonic=KA;const GA=t=>{const e=8-t.length/4;return new Uint8Array([(0,FA.sha256)(t)[0]>>e<<e])};function U_(t){if(!Array.isArray(t)||t.length!==2**11||typeof t[0]!="string")throw new Error("Worlist: expected array of 2048 strings");return t.forEach(e=>{if(typeof e!="string")throw new Error(`Wordlist: non-string element: ${e}`)}),Va.utils.chain(Va.utils.checksum(1,GA),Va.utils.radix2(11,!0),Va.utils.alphabet(t))}function M_(t,e){const{words:n}=Gh(t),i=U_(e).decode(n);return $_(i),i}Kn.mnemonicToEntropy=M_;function D_(t,e){return $_(t),U_(e).encode(t).join(HA(e)?"　":" ")}Kn.entropyToMnemonic=D_;function WA(t,e){try{M_(t,e)}catch{return!1}return!0}Kn.validateMnemonic=WA;const q_=t=>R_(`mnemonic${t}`);function VA(t,e=""){return(0,I_.pbkdf2Async)(O_.sha512,Gh(t).nfkd,q_(e),{c:2048,dkLen:64})}Kn.mnemonicToSeed=VA;function XA(t,e=""){return(0,I_.pbkdf2)(O_.sha512,Gh(t).nfkd,q_(e),{c:2048,dkLen:64})}C_=Kn.mnemonicToSeedSync=XA;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const JA=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),ad=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ZA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ZA)throw new Error("Non little-endian hardware is not supported");const YA=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function L_(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=YA[t[n]];return e}function N_(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let n=0;n<e.length;n++){const i=n*2,s=t.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[n]=o}return e}function QA(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function Oa(t){if(typeof t=="string"&&(t=QA(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}class Wh{clone(){return this._cloneInto()}}function Hu(t){const e=i=>t().update(Oa(i)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function ek(t){const e=(i,s)=>t(s).update(Oa(i)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=i=>t(i),e}function qd(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function tk(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function j_(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function nk(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");qd(t.outputLen),qd(t.blockLen)}function ik(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function sk(t,e){j_(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Gn={number:qd,bool:tk,bytes:j_,hash:nk,exists:ik,output:sk},Xa=BigInt(2**32-1),Ld=BigInt(32);function F_(t,e=!1){return e?{h:Number(t&Xa),l:Number(t>>Ld&Xa)}:{h:Number(t>>Ld&Xa)|0,l:Number(t&Xa)|0}}function ok(t,e=!1){let n=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:r}=F_(t[s],e);[n[s],i[s]]=[o,r]}return[n,i]}const rk=(t,e)=>BigInt(t>>>0)<<Ld|BigInt(e>>>0),ak=(t,e,n)=>t>>>n,ck=(t,e,n)=>t<<32-n|e>>>n,uk=(t,e,n)=>t>>>n|e<<32-n,lk=(t,e,n)=>t<<32-n|e>>>n,dk=(t,e,n)=>t<<64-n|e>>>n-32,hk=(t,e,n)=>t>>>n-32|e<<64-n,pk=(t,e)=>e,fk=(t,e)=>t,gk=(t,e,n)=>t<<n|e>>>32-n,mk=(t,e,n)=>e<<n|t>>>32-n,_k=(t,e,n)=>e<<n-32|t>>>64-n,yk=(t,e,n)=>t<<n-32|e>>>64-n;function wk(t,e,n,i){const s=(e>>>0)+(i>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const bk=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),vk=(t,e,n,i)=>e+n+i+(t/2**32|0)|0,Tk=(t,e,n,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0),Ak=(t,e,n,i,s)=>e+n+i+s+(t/2**32|0)|0,kk=(t,e,n,i,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(i>>>0)+(s>>>0),Sk=(t,e,n,i,s,o)=>e+n+i+s+o+(t/2**32|0)|0,Ze={fromBig:F_,split:ok,toBig:rk,shrSH:ak,shrSL:ck,rotrSH:uk,rotrSL:lk,rotrBH:dk,rotrBL:hk,rotr32H:pk,rotr32L:fk,rotlSH:gk,rotlSL:mk,rotlBH:_k,rotlBL:yk,add:wk,add3L:bk,add3H:vk,add4L:Tk,add4H:Ak,add5H:Sk,add5L:kk},[z_,H_,K_]=[[],[],[]],xk=BigInt(0),Nr=BigInt(1),Pk=BigInt(2),Ek=BigInt(7),Ck=BigInt(256),Bk=BigInt(113);for(let t=0,e=Nr,n=1,i=0;t<24;t++){[n,i]=[i,(2*n+3*i)%5],z_.push(2*(5*i+n)),H_.push((t+1)*(t+2)/2%64);let s=xk;for(let o=0;o<7;o++)e=(e<<Nr^(e>>Ek)*Bk)%Ck,e&Pk&&(s^=Nr<<(Nr<<BigInt(o))-Nr);K_.push(s)}const[Ik,Ok]=Ze.split(K_,!0),Cf=(t,e,n)=>n>32?Ze.rotlBH(t,e,n):Ze.rotlSH(t,e,n),Bf=(t,e,n)=>n>32?Ze.rotlBL(t,e,n):Ze.rotlSL(t,e,n);function Rk(t,e=24){const n=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let r=0;r<10;r++)n[r]=t[r]^t[r+10]^t[r+20]^t[r+30]^t[r+40];for(let r=0;r<10;r+=2){const a=(r+8)%10,c=(r+2)%10,u=n[c],l=n[c+1],d=Cf(u,l,1)^n[a],p=Bf(u,l,1)^n[a+1];for(let g=0;g<50;g+=10)t[r+g]^=d,t[r+g+1]^=p}let s=t[2],o=t[3];for(let r=0;r<24;r++){const a=H_[r],c=Cf(s,o,a),u=Bf(s,o,a),l=z_[r];s=t[l],o=t[l+1],t[l]=c,t[l+1]=u}for(let r=0;r<50;r+=10){for(let a=0;a<10;a++)n[a]=t[r+a];for(let a=0;a<10;a++)t[r+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Ik[i],t[1]^=Ok[i]}n.fill(0)}class Ku extends Wh{constructor(e,n,i,s=!1,o=24){if(super(),this.blockLen=e,this.suffix=n,this.outputLen=i,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Gn.number(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=JA(this.state)}keccak(){Rk(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Gn.exists(this);const{blockLen:n,state:i}=this;e=Oa(e);const s=e.length;for(let o=0;o<s;){const r=Math.min(n-this.pos,s-o);for(let a=0;a<r;a++)i[this.pos++]^=e[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:i,blockLen:s}=this;e[i]^=n,n&128&&i===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Gn.exists(this,!1),Gn.bytes(e),this.finish();const n=this.state,{blockLen:i}=this;for(let s=0,o=e.length;s<o;){this.posOut>=i&&this.keccak();const r=Math.min(i-this.posOut,o-s);e.set(n.subarray(this.posOut,this.posOut+r),s),this.posOut+=r,s+=r}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Gn.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Gn.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:n,suffix:i,outputLen:s,rounds:o,enableXOF:r}=this;return e||(e=new Ku(n,i,s,r,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=i,e.outputLen=s,e.enableXOF=r,e.destroyed=this.destroyed,e}}const qs=(t,e,n)=>Hu(()=>new Ku(e,t,n));qs(6,144,224/8);const gr=qs(6,136,256/8);qs(6,104,384/8);qs(6,72,512/8);qs(1,144,224/8);qs(1,136,256/8);qs(1,104,384/8);qs(1,72,512/8);const G_=(t,e,n)=>ek((i={})=>new Ku(e,t,i.dkLen===void 0?n:i.dkLen,!0));G_(31,168,128/8);G_(31,136,256/8);class W_ extends Wh{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Gn.hash(e);const i=Oa(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(i.length>s?e.create().update(i).digest():i);for(let r=0;r<o.length;r++)o[r]^=54;this.iHash.update(o),this.oHash=e.create();for(let r=0;r<o.length;r++)o[r]^=106;this.oHash.update(o),o.fill(0)}update(e){return Gn.exists(this),this.iHash.update(e),this}digestInto(e){Gn.exists(this),Gn.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:i,finished:s,destroyed:o,blockLen:r,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=o,e.blockLen=r,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Vh=(t,e,n)=>new W_(t,e).update(n).digest();Vh.create=(t,e)=>new W_(t,e);function $k(t,e,n,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,i);const s=BigInt(32),o=BigInt(4294967295),r=Number(n>>s&o),a=Number(n&o),c=i?4:0,u=i?0:4;t.setUint32(e+c,r,i),t.setUint32(e+u,a,i)}class Uk extends Wh{constructor(e,n,i,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=i,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ad(this.buffer)}update(e){Gn.exists(this);const{view:n,buffer:i,blockLen:s}=this;e=Oa(e);const o=e.length;for(let r=0;r<o;){const a=Math.min(s-this.pos,o-r);if(a===s){const c=ad(e);for(;s<=o-r;r+=s)this.process(c,r);continue}i.set(e.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Gn.exists(this),Gn.output(e,this),this.finished=!0;const{buffer:n,view:i,blockLen:s,isLE:o}=this;let{pos:r}=this;n[r++]=128,this.buffer.subarray(r).fill(0),this.padOffset>s-r&&(this.process(i,0),r=0);for(let c=r;c<s;c++)n[c]=0;$k(i,s-8,BigInt(this.length*8),o),this.process(i,0);const a=ad(e);this.get().forEach((c,u)=>a.setUint32(4*u,c,o))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const i=e.slice(0,n);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:i,length:s,finished:o,destroyed:r,pos:a}=this;return e.length=s,e.pos=a,e.finished=o,e.destroyed=r,s%n&&e.buffer.set(i),e}}const[Mk,Dk]=Ze.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ps=new Uint32Array(80),fs=new Uint32Array(80);class Xh extends Uk{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:i,Bl:s,Ch:o,Cl:r,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:p,Gh:g,Gl:b,Hh:w,Hl:T}=this;return[e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T]}set(e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T){this.Ah=e|0,this.Al=n|0,this.Bh=i|0,this.Bl=s|0,this.Ch=o|0,this.Cl=r|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=p|0,this.Gh=g|0,this.Gl=b|0,this.Hh=w|0,this.Hl=T|0}process(e,n){for(let k=0;k<16;k++,n+=4)ps[k]=e.getUint32(n),fs[k]=e.getUint32(n+=4);for(let k=16;k<80;k++){const S=ps[k-15]|0,$=fs[k-15]|0,H=Ze.rotrSH(S,$,1)^Ze.rotrSH(S,$,8)^Ze.shrSH(S,$,7),V=Ze.rotrSL(S,$,1)^Ze.rotrSL(S,$,8)^Ze.shrSL(S,$,7),z=ps[k-2]|0,X=fs[k-2]|0,L=Ze.rotrSH(z,X,19)^Ze.rotrBH(z,X,61)^Ze.shrSH(z,X,6),B=Ze.rotrSL(z,X,19)^Ze.rotrBL(z,X,61)^Ze.shrSL(z,X,6),O=Ze.add4L(V,B,fs[k-7],fs[k-16]),v=Ze.add4H(O,H,L,ps[k-7],ps[k-16]);ps[k]=v|0,fs[k]=O|0}let{Ah:i,Al:s,Bh:o,Bl:r,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:p,Fh:g,Fl:b,Gh:w,Gl:T,Hh:E,Hl:P}=this;for(let k=0;k<80;k++){const S=Ze.rotrSH(d,p,14)^Ze.rotrSH(d,p,18)^Ze.rotrBH(d,p,41),$=Ze.rotrSL(d,p,14)^Ze.rotrSL(d,p,18)^Ze.rotrBL(d,p,41),H=d&g^~d&w,V=p&b^~p&T,z=Ze.add5L(P,$,V,Dk[k],fs[k]),X=Ze.add5H(z,E,S,H,Mk[k],ps[k]),L=z|0,B=Ze.rotrSH(i,s,28)^Ze.rotrBH(i,s,34)^Ze.rotrBH(i,s,39),O=Ze.rotrSL(i,s,28)^Ze.rotrBL(i,s,34)^Ze.rotrBL(i,s,39),v=i&o^i&a^o&a,h=s&r^s&c^r&c;E=w|0,P=T|0,w=g|0,T=b|0,g=d|0,b=p|0,{h:d,l:p}=Ze.add(u|0,l|0,X|0,L|0),u=a|0,l=c|0,a=o|0,c=r|0,o=i|0,r=s|0;const _=Ze.add3L(L,O,h);i=Ze.add3H(_,X,B,v),s=_|0}({h:i,l:s}=Ze.add(this.Ah|0,this.Al|0,i|0,s|0)),{h:o,l:r}=Ze.add(this.Bh|0,this.Bl|0,o|0,r|0),{h:a,l:c}=Ze.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ze.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:p}=Ze.add(this.Eh|0,this.El|0,d|0,p|0),{h:g,l:b}=Ze.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:w,l:T}=Ze.add(this.Gh|0,this.Gl|0,w|0,T|0),{h:E,l:P}=Ze.add(this.Hh|0,this.Hl|0,E|0,P|0),this.set(i,s,o,r,a,c,u,l,d,p,g,b,w,T,E,P)}roundClean(){ps.fill(0),fs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class qk extends Xh{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class Lk extends Xh{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const V_=Hu(()=>new Xh);Hu(()=>new qk);Hu(()=>new Lk);var X_=typeof self=="object"?self.FormData:window.FormData,J_=Object.defineProperty,Nk=Object.getOwnPropertyDescriptor,Gu=(t,e)=>{for(var n in e)J_(t,n,{get:e[n],enumerable:!0})},kt=(t,e,n,i)=>{for(var s=i>1?void 0:i?Nk(e,n):e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=(i?r(e,n,s):r(s))||s);return i&&s&&J_(e,n,s),s},jk=/^m(\/[0-9]+')+$/,Z_=t=>t.replace("'",""),Fk="ed25519 seed",zk=2147483648,Hk=t=>{const n=Vh.create(V_,Fk).update(N_(t)).digest(),i=n.slice(0,32),s=n.slice(32);return{key:i,chainCode:s}},Kk=({key:t,chainCode:e},n)=>{const i=new ArrayBuffer(4);new DataView(i).setUint32(0,n);const s=new Uint8Array(i),o=new Uint8Array([0]),r=new Uint8Array([...o,...t,...s]),a=Vh.create(V_,e).update(r).digest(),c=a.slice(0,32),u=a.slice(32);return{key:c,chainCode:u}},Gk=t=>jk.test(t)?!t.split("/").slice(1).map(Z_).some(Number.isNaN):!1,Wk=(t,e,n=zk)=>{if(!Gk(t))throw new Error("Invalid derivation path");const{key:i,chainCode:s}=Hk(e);return t.split("/").slice(1).map(Z_).map(r=>parseInt(r,10)).reduce((r,a)=>Kk(r,a+n),{key:i,chainCode:s})},et=class{static fromBuffer(t){return et.fromUint8Array(t)}static fromUint8Array(t){return new et(L_(t))}static ensure(t){return typeof t=="string"?new et(t):t}constructor(t){t.startsWith("0x")?this.hexString=t:this.hexString=`0x${t}`}hex(){return this.hexString}noPrefix(){return this.hexString.slice(2)}toString(){return this.hex()}toShortString(){return`0x${this.hexString.replace(/^0x0*/,"")}`}toUint8Array(){return Uint8Array.from(N_(this.noPrefix()))}};async function Vk(t){return new Promise(e=>{setTimeout(e,t)})}var If="/v1";function Xk(t){let e=`${t}`;return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e.endsWith(If)||(e=`${e}${If}`),e}var Y_=2e5,Q_=20,Jk=20,Zk="0x1::aptos_coin::AptosCoin";function Wu(t){let e,n,i;return typeof t=="object"?(e=t.hashFunction,n=t.ttlMs,i=t.tags):e=t,(s,o,r)=>{if(r.value!=null)r.value=Of(r.value,e,n,i);else if(r.get!=null)r.get=Of(r.get,e,n,i);else throw new Error("Only put a Memoize() decorator on a method or get accessor.")}}function Yk(t,e){return Wu({ttlMs:t,hashFunction:e})}var Ac=new Map;function Qk(t){const e=new Set;for(const n of t){const i=Ac.get(n);if(i)for(const s of i)e.has(s)||(s.clear(),e.add(s))}return e.size}function Of(t,e,n=0,i){const s=Symbol("__memoized_map__");return function(...o){let r;const a=this;a.hasOwnProperty(s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!1,writable:!1,value:new Map});const c=a[s];if(Array.isArray(i))for(const u of i)Ac.has(u)?Ac.get(u).push(c):Ac.set(u,[c]);if(e||o.length>0||n>0){let u;e===!0?u=o.map(p=>p.toString()).join("!"):e?u=e.apply(a,o):u=o[0];const l=`${u}__timestamp`;let d=!1;if(n>0)if(!c.has(l))d=!0;else{const p=c.get(l);d=Date.now()-p>n}c.has(u)&&!d?r=c.get(u):(r=t.apply(a,o),c.set(u,r),n>0&&c.set(l,Date.now()))}else{const u=a;c.has(u)?r=c.get(u):(r=t.apply(a,o),c.set(u,r))}return r}}async function Rf(t,e,n,i){var s;const o=[];let r;for(;;){const a=await t(et.ensure(e).hex(),(s=i==null?void 0:i.ledgerVersion)==null?void 0:s.toString(),r,n);if(r=a.__headers["x-aptos-cursor"],delete a.__headers,o.push(...a),r==null)break}return o}var eS={mainnet:"https://indexer.mainnet.aptoslabs.com/v1/graphql",testnet:"https://indexer-testnet.staging.gcp.aptosdev.com/v1/graphql",devnet:"https://indexer-devnet.staging.gcp.aptosdev.com/v1/graphql"},tS={mainnet:"https://fullnode.mainnet.aptoslabs.com/v1",testnet:"https://fullnode.testnet.aptoslabs.com/v1",devnet:"https://fullnode.devnet.aptoslabs.com/v1"},D={};Gu(D,{AccountAddress:()=>Lt,AccountAuthenticator:()=>da,AccountAuthenticatorEd25519:()=>Yh,AccountAuthenticatorMultiEd25519:()=>Qh,ArgumentABI:()=>Na,AuthenticationKey:()=>io,ChainId:()=>Qu,ChangeSet:()=>pS,Ed25519PublicKey:()=>si,Ed25519Signature:()=>Oi,EntryFunction:()=>Js,EntryFunctionABI:()=>br,Identifier:()=>Pn,Module:()=>ty,ModuleId:()=>no,MultiAgentRawTransaction:()=>Zu,MultiEd25519PublicKey:()=>Ra,MultiEd25519Signature:()=>Vu,MultiSig:()=>np,MultiSigTransactionPayload:()=>tp,RawTransaction:()=>$r,RawTransactionWithData:()=>ny,RotationProofChallenge:()=>gS,Script:()=>Ua,ScriptABI:()=>rl,SignedTransaction:()=>Ma,StructTag:()=>mr,Transaction:()=>iy,TransactionArgument:()=>Pi,TransactionArgumentAddress:()=>yr,TransactionArgumentBool:()=>ol,TransactionArgumentU128:()=>il,TransactionArgumentU16:()=>tl,TransactionArgumentU256:()=>sl,TransactionArgumentU32:()=>nl,TransactionArgumentU64:()=>_r,TransactionArgumentU8:()=>el,TransactionArgumentU8Vector:()=>wr,TransactionAuthenticator:()=>$a,TransactionAuthenticatorEd25519:()=>Xu,TransactionAuthenticatorMultiAgent:()=>Zh,TransactionAuthenticatorMultiEd25519:()=>Ju,TransactionPayload:()=>Da,TransactionPayloadEntryFunction:()=>Yu,TransactionPayloadMultisig:()=>ip,TransactionPayloadScript:()=>qa,TransactionScriptABI:()=>al,TypeArgumentABI:()=>La,TypeTag:()=>wn,TypeTagAddress:()=>Ao,TypeTagBool:()=>bo,TypeTagSigner:()=>ep,TypeTagStruct:()=>ko,TypeTagU128:()=>To,TypeTagU16:()=>Br,TypeTagU256:()=>Or,TypeTagU32:()=>Ir,TypeTagU64:()=>vo,TypeTagU8:()=>Qi,TypeTagVector:()=>Rr,UserTransaction:()=>sp,WriteSet:()=>fS});var te={};Gu(te,{Deserializer:()=>Jh,Serializer:()=>Nt,bcsSerializeBool:()=>lS,bcsSerializeBytes:()=>Do,bcsSerializeFixedBytes:()=>hS,bcsSerializeStr:()=>dS,bcsSerializeU128:()=>uS,bcsSerializeU16:()=>aS,bcsSerializeU32:()=>cS,bcsSerializeU8:()=>Nd,bcsSerializeUint64:()=>rS,bcsToBytes:()=>es,deserializeVector:()=>hi,serializeVector:()=>Wn,serializeVectorWithFunc:()=>oS});var nS=2**8-1,iS=2**16-1,la=2**32-1,ta=BigInt(2**64)-BigInt(1),ey=BigInt(2**128)-BigInt(1),sS=BigInt(2**256)-BigInt(1),Nt=class{constructor(){this.buffer=new ArrayBuffer(64),this.offset=0}ensureBufferWillHandleSize(t){for(;this.buffer.byteLength<this.offset+t;){const e=new ArrayBuffer(this.buffer.byteLength*2);new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e}}serialize(t){this.ensureBufferWillHandleSize(t.length),new Uint8Array(this.buffer,this.offset).set(t),this.offset+=t.length}serializeWithFunction(t,e,n){this.ensureBufferWillHandleSize(e);const i=new DataView(this.buffer,this.offset);t.apply(i,[0,n,!0]),this.offset+=e}serializeStr(t){const e=new TextEncoder;this.serializeBytes(e.encode(t))}serializeBytes(t){this.serializeU32AsUleb128(t.length),this.serialize(t)}serializeFixedBytes(t){this.serialize(t)}serializeBool(t){if(typeof t!="boolean")throw new Error("Value needs to be a boolean");const e=t?1:0;this.serialize(new Uint8Array([e]))}serializeU8(t){this.serialize(new Uint8Array([t]))}serializeU16(t){this.serializeWithFunction(DataView.prototype.setUint16,2,t)}serializeU32(t){this.serializeWithFunction(DataView.prototype.setUint32,4,t)}serializeU64(t){const e=BigInt(t.toString())&BigInt(la),n=BigInt(t.toString())>>BigInt(32);this.serializeU32(Number(e)),this.serializeU32(Number(n))}serializeU128(t){const e=BigInt(t.toString())&ta,n=BigInt(t.toString())>>BigInt(64);this.serializeU64(e),this.serializeU64(n)}serializeU256(t){const e=BigInt(t.toString())&ey,n=BigInt(t.toString())>>BigInt(128);this.serializeU128(e),this.serializeU128(n)}serializeU32AsUleb128(t){let e=t;const n=[];for(;e>>>7;)n.push(e&127|128),e>>>=7;n.push(e),this.serialize(new Uint8Array(n))}getBytes(){return new Uint8Array(this.buffer).slice(0,this.offset)}};kt([wo(0,nS)],Nt.prototype,"serializeU8",1);kt([wo(0,iS)],Nt.prototype,"serializeU16",1);kt([wo(0,la)],Nt.prototype,"serializeU32",1);kt([wo(BigInt(0),ta)],Nt.prototype,"serializeU64",1);kt([wo(BigInt(0),ey)],Nt.prototype,"serializeU128",1);kt([wo(BigInt(0),sS)],Nt.prototype,"serializeU256",1);kt([wo(0,la)],Nt.prototype,"serializeU32AsUleb128",1);function wo(t,e,n){return(i,s,o)=>{const r=o.value;return o.value=function(c){const u=BigInt(c.toString());if(u>BigInt(e.toString())||u<BigInt(t.toString()))throw new Error(n||"Value is out of range");r.apply(this,[c])},o}}var Jh=class{constructor(t){this.buffer=new ArrayBuffer(t.length),new Uint8Array(this.buffer).set(t,0),this.offset=0}read(t){if(this.offset+t>this.buffer.byteLength)throw new Error("Reached to the end of buffer");const e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}deserializeStr(){const t=this.deserializeBytes();return new TextDecoder().decode(t)}deserializeBytes(){const t=this.deserializeUleb128AsU32();return new Uint8Array(this.read(t))}deserializeFixedBytes(t){return new Uint8Array(this.read(t))}deserializeBool(){const t=new Uint8Array(this.read(1))[0];if(t!==1&&t!==0)throw new Error("Invalid boolean value");return t===1}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){const t=this.deserializeU32(),e=this.deserializeU32();return BigInt(BigInt(e)<<BigInt(32)|BigInt(t))}deserializeU128(){const t=this.deserializeU64(),e=this.deserializeU64();return BigInt(e<<BigInt(64)|t)}deserializeU256(){const t=this.deserializeU128(),e=this.deserializeU128();return BigInt(e<<BigInt(128)|t)}deserializeUleb128AsU32(){let t=BigInt(0),e=0;for(;t<la;){const n=this.deserializeU8();if(t|=BigInt(n&127)<<BigInt(e),!(n&128))break;e+=7}if(t>la)throw new Error("Overflow while parsing uleb128-encoded uint32 value");return Number(t)}};function Wn(t,e){e.serializeU32AsUleb128(t.length),t.forEach(n=>{n.serialize(e)})}function oS(t,e){const n=new Nt;n.serializeU32AsUleb128(t.length);const i=n[e];return t.forEach(s=>{i.call(n,s)}),n.getBytes()}function hi(t,e){const n=t.deserializeUleb128AsU32(),i=[];for(let s=0;s<n;s+=1)i.push(e.deserialize(t));return i}function es(t){const e=new Nt;return t.serialize(e),e.getBytes()}function rS(t){const e=new Nt;return e.serializeU64(t),e.getBytes()}function Nd(t){const e=new Nt;return e.serializeU8(t),e.getBytes()}function aS(t){const e=new Nt;return e.serializeU16(t),e.getBytes()}function cS(t){const e=new Nt;return e.serializeU32(t),e.getBytes()}function uS(t){const e=new Nt;return e.serializeU128(t),e.getBytes()}function lS(t){const e=new Nt;return e.serializeBool(t),e.getBytes()}function dS(t){const e=new Nt;return e.serializeStr(t),e.getBytes()}function Do(t){const e=new Nt;return e.serializeBytes(t),e.getBytes()}function hS(t){const e=new Nt;return e.serializeFixedBytes(t),e.getBytes()}var ti=class{constructor(t){if(t.length!==ti.LENGTH)throw new Error("Expected address of length 32");this.address=t}static fromHex(t){let e=et.ensure(t);e.noPrefix().length%2!==0&&(e=new et(`0${e.noPrefix()}`));const n=e.toUint8Array();if(n.length>ti.LENGTH)throw new Error("Hex string is too long. Address's length is 32 bytes.");if(n.length===ti.LENGTH)return new ti(n);const i=new Uint8Array(ti.LENGTH);return i.set(n,ti.LENGTH-n.length),new ti(i)}static isValid(t){if(t==="")return!1;let e=et.ensure(t);return e.noPrefix().length%2!==0&&(e=new et(`0${e.noPrefix()}`)),e.toUint8Array().length<=ti.LENGTH}toHexString(){return et.fromUint8Array(this.address).hex()}serialize(t){t.serializeFixedBytes(this.address)}static deserialize(t){return new ti(t.deserializeFixedBytes(ti.LENGTH))}},Lt=ti;Lt.LENGTH=32;Lt.CORE_CODE_ADDRESS=ti.fromHex("0x1");var kc=class{constructor(t){if(t.length!==kc.LENGTH)throw new Error(`Ed25519PublicKey length should be ${kc.LENGTH}`);this.value=t}toBytes(){return this.value}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const e=t.deserializeBytes();return new kc(e)}},si=kc;si.LENGTH=32;var Sc=class{constructor(t){if(this.value=t,t.length!==Sc.LENGTH)throw new Error(`Ed25519Signature length should be ${Sc.LENGTH}`)}serialize(t){t.serializeBytes(this.value)}static deserialize(t){const e=t.deserializeBytes();return new Sc(e)}},Oi=Sc;Oi.LENGTH=64;var jd=32,Ra=class{constructor(t,e){if(this.public_keys=t,this.threshold=e,e>jd)throw new Error(`"threshold" cannot be larger than ${jd}`)}toBytes(){const t=new Uint8Array(this.public_keys.length*si.LENGTH+1);return this.public_keys.forEach((e,n)=>{t.set(e.value,n*si.LENGTH)}),t[this.public_keys.length*si.LENGTH]=this.threshold,t}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const e=t.deserializeBytes(),n=e[e.length-1],i=[];for(let s=0;s<e.length-1;s+=si.LENGTH){const o=s;i.push(new si(e.subarray(o,o+si.LENGTH)))}return new Ra(i,n)}},Kr=class{constructor(t,e){if(this.signatures=t,this.bitmap=e,e.length!==Kr.BITMAP_LEN)throw new Error(`"bitmap" length should be ${Kr.BITMAP_LEN}`)}toBytes(){const t=new Uint8Array(this.signatures.length*Oi.LENGTH+Kr.BITMAP_LEN);return this.signatures.forEach((e,n)=>{t.set(e.value,n*Oi.LENGTH)}),t.set(this.bitmap,this.signatures.length*Oi.LENGTH),t}static createBitmap(t){const n=new Uint8Array([0,0,0,0]),i=new Set;return t.forEach(s=>{if(s>=jd)throw new Error(`Invalid bit value ${s}.`);if(i.has(s))throw new Error("Duplicated bits detected.");i.add(s);const o=Math.floor(s/8);let r=n[o];r|=128>>s%8,n[o]=r}),n}serialize(t){t.serializeBytes(this.toBytes())}static deserialize(t){const e=t.deserializeBytes(),n=e.subarray(e.length-4),i=[];for(let s=0;s<e.length-n.length;s+=Oi.LENGTH){const o=s;i.push(new Oi(e.subarray(o,o+Oi.LENGTH)))}return new Kr(i,n)}},Vu=Kr;Vu.BITMAP_LEN=4;var $a=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return Xu.load(t);case 1:return Ju.load(t);case 2:return Zh.load(t);default:throw new Error(`Unknown variant index for TransactionAuthenticator: ${e}`)}}},Xu=class extends $a{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=si.deserialize(t),n=Oi.deserialize(t);return new Xu(e,n)}},Ju=class extends $a{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=Ra.deserialize(t),n=Vu.deserialize(t);return new Ju(e,n)}},Zh=class extends $a{constructor(t,e,n){super(),this.sender=t,this.secondary_signer_addresses=e,this.secondary_signers=n}serialize(t){t.serializeU32AsUleb128(2),this.sender.serialize(t),Wn(this.secondary_signer_addresses,t),Wn(this.secondary_signers,t)}static load(t){const e=da.deserialize(t),n=hi(t,Lt),i=hi(t,da);return new Zh(e,n,i)}},da=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return Yh.load(t);case 1:return Qh.load(t);default:throw new Error(`Unknown variant index for AccountAuthenticator: ${e}`)}}},Yh=class extends da{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(0),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=si.deserialize(t),n=Oi.deserialize(t);return new Yh(e,n)}},Qh=class extends da{constructor(t,e){super(),this.public_key=t,this.signature=e}serialize(t){t.serializeU32AsUleb128(1),this.public_key.serialize(t),this.signature.serialize(t)}static load(t){const e=Ra.deserialize(t),n=Vu.deserialize(t);return new Qh(e,n)}},Pn=class{constructor(t){this.value=t}serialize(t){t.serializeStr(this.value)}static deserialize(t){const e=t.deserializeStr();return new Pn(e)}},wn=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return bo.load(t);case 1:return Qi.load(t);case 2:return vo.load(t);case 3:return To.load(t);case 4:return Ao.load(t);case 5:return ep.load(t);case 6:return Rr.load(t);case 7:return ko.load(t);case 8:return Br.load(t);case 9:return Ir.load(t);case 10:return Or.load(t);default:throw new Error(`Unknown variant index for TypeTag: ${e}`)}}},bo=class extends wn{serialize(t){t.serializeU32AsUleb128(0)}static load(t){return new bo}},Qi=class extends wn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new Qi}},Br=class extends wn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new Br}},Ir=class extends wn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new Ir}},vo=class extends wn{serialize(t){t.serializeU32AsUleb128(2)}static load(t){return new vo}},To=class extends wn{serialize(t){t.serializeU32AsUleb128(3)}static load(t){return new To}},Or=class extends wn{serialize(t){t.serializeU32AsUleb128(1)}static load(t){return new Or}},Ao=class extends wn{serialize(t){t.serializeU32AsUleb128(4)}static load(t){return new Ao}},ep=class extends wn{serialize(t){t.serializeU32AsUleb128(5)}static load(t){return new ep}},Rr=class extends wn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),this.value.serialize(t)}static load(t){const e=wn.deserialize(t);return new Rr(e)}},ko=class extends wn{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),this.value.serialize(t)}static load(t){const e=mr.deserialize(t);return new ko(e)}isStringTypeTag(){return this.value.module_name.value==="string"&&this.value.name.value==="String"&&this.value.address.toHexString()===Lt.fromHex("0x1").toHexString()}},mr=class{constructor(t,e,n,i){this.address=t,this.module_name=e,this.name=n,this.type_args=i}static fromString(t){if(t.includes("<"))throw new Error("Not implemented");const e=t.split("::");if(e.length!==3)throw new Error("Invalid struct tag string literal.");return new mr(Lt.fromHex(e[0]),new Pn(e[1]),new Pn(e[2]),[])}serialize(t){this.address.serialize(t),this.module_name.serialize(t),this.name.serialize(t),Wn(this.type_args,t)}static deserialize(t){const e=Lt.deserialize(t),n=Pn.deserialize(t),i=Pn.deserialize(t),s=hi(t,wn);return new mr(e,n,i,s)}},$r=class{constructor(t,e,n,i,s,o,r){this.sender=t,this.sequence_number=e,this.payload=n,this.max_gas_amount=i,this.gas_unit_price=s,this.expiration_timestamp_secs=o,this.chain_id=r}serialize(t){this.sender.serialize(t),t.serializeU64(this.sequence_number),this.payload.serialize(t),t.serializeU64(this.max_gas_amount),t.serializeU64(this.gas_unit_price),t.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(t)}static deserialize(t){const e=Lt.deserialize(t),n=t.deserializeU64(),i=Da.deserialize(t),s=t.deserializeU64(),o=t.deserializeU64(),r=t.deserializeU64(),a=Qu.deserialize(t);return new $r(e,n,i,s,o,r,a)}},Ua=class{constructor(t,e,n){this.code=t,this.ty_args=e,this.args=n}serialize(t){t.serializeBytes(this.code),Wn(this.ty_args,t),Wn(this.args,t)}static deserialize(t){const e=t.deserializeBytes(),n=hi(t,wn),i=hi(t,Pi);return new Ua(e,n,i)}},Js=class{constructor(t,e,n,i){this.module_name=t,this.function_name=e,this.ty_args=n,this.args=i}static natural(t,e,n,i){return new Js(no.fromStr(t),new Pn(e),n,i)}static natual(t,e,n,i){return Js.natural(t,e,n,i)}serialize(t){this.module_name.serialize(t),this.function_name.serialize(t),Wn(this.ty_args,t),t.serializeU32AsUleb128(this.args.length),this.args.forEach(e=>{t.serializeBytes(e)})}static deserialize(t){const e=no.deserialize(t),n=Pn.deserialize(t),i=hi(t,wn),s=t.deserializeUleb128AsU32(),o=[];for(let a=0;a<s;a+=1)o.push(t.deserializeBytes());const r=o;return new Js(e,n,i,r)}},tp=class{constructor(t){this.transaction_payload=t}serialize(t){t.serializeU32AsUleb128(0),this.transaction_payload.serialize(t)}static deserialize(t){return new tp(Js.deserialize(t))}},np=class{constructor(t,e){this.multisig_address=t,this.transaction_payload=e}serialize(t){this.multisig_address.serialize(t),this.transaction_payload===void 0?t.serializeBool(!1):(t.serializeBool(!0),this.transaction_payload.serialize(t))}static deserialize(t){const e=Lt.deserialize(t),n=t.deserializeBool();let i;return n&&(i=tp.deserialize(t)),new np(e,i)}},ty=class{constructor(t){this.code=t}serialize(t){t.serializeBytes(this.code)}static deserialize(t){const e=t.deserializeBytes();return new ty(e)}},no=class{constructor(t,e){this.address=t,this.name=e}static fromStr(t){const e=t.split("::");if(e.length!==2)throw new Error("Invalid module id.");return new no(Lt.fromHex(new et(e[0])),new Pn(e[1]))}serialize(t){this.address.serialize(t),this.name.serialize(t)}static deserialize(t){const e=Lt.deserialize(t),n=Pn.deserialize(t);return new no(e,n)}},pS=class{serialize(t){throw new Error("Not implemented.")}static deserialize(t){throw new Error("Not implemented.")}},fS=class{serialize(t){throw new Error("Not implmented.")}static deserialize(t){throw new Error("Not implmented.")}},Ma=class{constructor(t,e){this.raw_txn=t,this.authenticator=e}serialize(t){this.raw_txn.serialize(t),this.authenticator.serialize(t)}static deserialize(t){const e=$r.deserialize(t),n=$a.deserialize(t);return new Ma(e,n)}},ny=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return Zu.load(t);default:throw new Error(`Unknown variant index for RawTransactionWithData: ${e}`)}}},Zu=class extends ny{constructor(t,e){super(),this.raw_txn=t,this.secondary_signer_addresses=e}serialize(t){t.serializeU32AsUleb128(0),this.raw_txn.serialize(t),Wn(this.secondary_signer_addresses,t)}static load(t){const e=$r.deserialize(t),n=hi(t,Lt);return new Zu(e,n)}},Da=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return qa.load(t);case 2:return Yu.load(t);case 3:return ip.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${e}`)}}},qa=class extends Da{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){const e=Ua.deserialize(t);return new qa(e)}},Yu=class extends Da{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),this.value.serialize(t)}static load(t){const e=Js.deserialize(t);return new Yu(e)}},ip=class extends Da{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const e=np.deserialize(t);return new ip(e)}},Qu=class{constructor(t){this.value=t}serialize(t){t.serializeU8(this.value)}static deserialize(t){const e=t.deserializeU8();return new Qu(e)}},Pi=class{static deserialize(e){const n=e.deserializeUleb128AsU32();switch(n){case 0:return el.load(e);case 1:return _r.load(e);case 2:return il.load(e);case 3:return yr.load(e);case 4:return wr.load(e);case 5:return ol.load(e);case 6:return tl.load(e);case 7:return nl.load(e);case 8:return sl.load(e);default:throw new Error(`Unknown variant index for TransactionArgument: ${n}`)}}},el=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(0),t.serializeU8(this.value)}static load(t){const e=t.deserializeU8();return new el(e)}},tl=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(6),t.serializeU16(this.value)}static load(t){const e=t.deserializeU16();return new tl(e)}},nl=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(7),t.serializeU32(this.value)}static load(t){const e=t.deserializeU32();return new nl(e)}},_r=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(1),t.serializeU64(this.value)}static load(t){const e=t.deserializeU64();return new _r(e)}},il=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(2),t.serializeU128(this.value)}static load(t){const e=t.deserializeU128();return new il(e)}},sl=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(8),t.serializeU256(this.value)}static load(t){const e=t.deserializeU256();return new sl(e)}},yr=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(3),this.value.serialize(t)}static load(t){const e=Lt.deserialize(t);return new yr(e)}},wr=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(4),t.serializeBytes(this.value)}static load(t){const e=t.deserializeBytes();return new wr(e)}},ol=class extends Pi{constructor(t){super(),this.value=t}serialize(t){t.serializeU32AsUleb128(5),t.serializeBool(this.value)}static load(t){const e=t.deserializeBool();return new ol(e)}},iy=class{getHashSalt(){const t=gr.create();return t.update("APTOS::Transaction"),t.digest()}static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return sp.load(t);default:throw new Error(`Unknown variant index for Transaction: ${e}`)}}},sp=class extends iy{constructor(t){super(),this.value=t}hash(){const t=gr.create();return t.update(this.getHashSalt()),t.update(es(this)),t.digest()}serialize(t){t.serializeU32AsUleb128(0),this.value.serialize(t)}static load(t){return new sp(Ma.deserialize(t))}},La=class{constructor(t){this.name=t}serialize(t){t.serializeStr(this.name)}static deserialize(t){const e=t.deserializeStr();return new La(e)}},Na=class{constructor(t,e){this.name=t,this.type_tag=e}serialize(t){t.serializeStr(this.name),this.type_tag.serialize(t)}static deserialize(t){const e=t.deserializeStr(),n=wn.deserialize(t);return new Na(e,n)}},rl=class{static deserialize(t){const e=t.deserializeUleb128AsU32();switch(e){case 0:return al.load(t);case 1:return br.load(t);default:throw new Error(`Unknown variant index for TransactionPayload: ${e}`)}}},al=class extends rl{constructor(t,e,n,i,s){super(),this.name=t,this.doc=e,this.code=n,this.ty_args=i,this.args=s}serialize(t){t.serializeU32AsUleb128(0),t.serializeStr(this.name),t.serializeStr(this.doc),t.serializeBytes(this.code),Wn(this.ty_args,t),Wn(this.args,t)}static load(t){const e=t.deserializeStr(),n=t.deserializeStr(),i=t.deserializeBytes(),s=hi(t,La),o=hi(t,Na);return new al(e,n,i,s,o)}},br=class extends rl{constructor(t,e,n,i,s){super(),this.name=t,this.module_name=e,this.doc=n,this.ty_args=i,this.args=s}serialize(t){t.serializeU32AsUleb128(1),t.serializeStr(this.name),this.module_name.serialize(t),t.serializeStr(this.doc),Wn(this.ty_args,t),Wn(this.args,t)}static load(t){const e=t.deserializeStr(),n=no.deserialize(t),i=t.deserializeStr(),s=hi(t,La),o=hi(t,Na);return new br(e,n,i,s,o)}},qo=class{constructor(t){if(t.length!==qo.LENGTH)throw new Error("Expected a byte array of length 32");this.bytes=t}static fromMultiEd25519PublicKey(t){const e=t.toBytes(),n=new Uint8Array(e.length+1);n.set(e),n.set([qo.MULTI_ED25519_SCHEME],e.length);const i=gr.create();return i.update(n),new qo(i.digest())}static fromEd25519PublicKey(t){const e=t.value,n=new Uint8Array(e.length+1);n.set(e),n.set([qo.ED25519_SCHEME],e.length);const i=gr.create();return i.update(n),new qo(i.digest())}derivedAddress(){return et.fromUint8Array(this.bytes)}},io=qo;io.LENGTH=32;io.MULTI_ED25519_SCHEME=1;io.ED25519_SCHEME=0;io.DERIVE_RESOURCE_ACCOUNT_SCHEME=255;var gS=class{constructor(t,e,n,i,s,o,r){this.accountAddress=t,this.moduleName=e,this.structName=n,this.sequenceNumber=i,this.originator=s,this.currentAuthKey=o,this.newPublicKey=r}serialize(t){this.accountAddress.serialize(t),t.serializeStr(this.moduleName),t.serializeStr(this.structName),t.serializeU64(this.sequenceNumber),this.originator.serialize(t),this.currentAuthKey.serialize(t),t.serializeBytes(this.newPublicKey)}},xc=class{static fromAptosAccountObject(t){return new xc(et.ensure(t.privateKeyHex).toUint8Array(),t.address)}static fromDerivePath(t,e){if(!xc.isValidPath(t))throw new Error("Invalid derivation path");const n=e.trim().split(/\s+/).map(s=>s.toLowerCase()).join(" "),{key:i}=Wk(t,L_(C_(n)));return new xc(i)}constructor(t,e){t?this.signingKey=Es.sign.keyPair.fromSeed(t.slice(0,32)):this.signingKey=Es.sign.keyPair(),this.accountAddress=et.ensure(e||this.authKey().hex())}address(){return this.accountAddress}authKey(){const t=new si(this.signingKey.publicKey);return io.fromEd25519PublicKey(t).derivedAddress()}static getResourceAccountAddress(t,e){const n=es(Lt.fromHex(t)),i=new Uint8Array([...n,...e,io.DERIVE_RESOURCE_ACCOUNT_SCHEME]),s=gr.create();return s.update(i),et.fromUint8Array(s.digest())}pubKey(){return et.fromUint8Array(this.signingKey.publicKey)}signBuffer(t){const e=Es.sign(t,this.signingKey.secretKey);return et.fromUint8Array(e.slice(0,64))}signHexString(t){const e=et.ensure(t).toUint8Array();return this.signBuffer(e)}toPrivateKeyObject(){return{address:this.address().hex(),publicKeyHex:this.pubKey().hex(),privateKeyHex:et.fromUint8Array(this.signingKey.secretKey.slice(0,32)).hex()}}},ha=xc;ha.isValidPath=t=>!!/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'+$/.test(t);kt([Wu()],ha.prototype,"authKey",1);function vr(t){return t instanceof ha?t.address():et.ensure(t)}var mS=`
    fragment TokenDataFields on current_token_datas {
  creator_address
  collection_name
  description
  metadata_uri
  name
  token_data_id_hash
  collection_data_id_hash
}
    `,_S=`
    fragment CollectionDataFields on current_collection_datas {
  metadata_uri
  supply
  description
  collection_name
  collection_data_id_hash
  table_handle
  creator_address
}
    `,yS=`
    query getAccountCurrentTokens($address: String!, $offset: Int, $limit: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $address}, amount: {_gt: 0}}
    order_by: [{last_transaction_version: desc}, {creator_address: asc}, {collection_name: asc}, {name: asc}]
    offset: $offset
    limit: $limit
  ) {
    amount
    current_token_data {
      ...TokenDataFields
    }
    current_collection_data {
      ...CollectionDataFields
    }
    last_transaction_version
    property_version
  }
}
    ${mS}
${_S}`,wS=`
    query getTokenActivities($idHash: String!) {
  token_activities(where: {token_data_id_hash: {_eq: $idHash}}) {
    creator_address
    collection_name
    name
    token_data_id_hash
    collection_data_id_hash
    from_address
    to_address
    transaction_version
    transaction_timestamp
    property_version
    transfer_type
    event_sequence_number
    token_amount
  }
}
    `,sy=class{constructor(t){this.endpoint=t}async queryIndexer(t){const{data:e}=await Qs.post(this.endpoint,t);if(e.errors)throw new Error(`Indexer data error ${e.errors}`);return e.data}async getAccountNFTs(t,e){const n={query:yS,variables:{address:t,offset:e==null?void 0:e.offset,limit:e==null?void 0:e.limit}};return this.queryIndexer(n)}async getTokenActivities(t){const e={query:wS,variables:{idHash:t}};return this.queryIndexer(e)}},bS={};Gu(bS,{$AccountData:()=>MS,$AccountSignature:()=>DS,$AccountSignature_Ed25519Signature:()=>qS,$AccountSignature_MultiEd25519Signature:()=>LS,$Address:()=>NS,$AptosError:()=>jS,$AptosErrorCode:()=>FS,$Block:()=>zS,$BlockMetadataTransaction:()=>HS,$DecodedTableData:()=>KS,$DeleteModule:()=>WS,$DeleteResource:()=>VS,$DeleteTableItem:()=>XS,$DeletedTableData:()=>GS,$DirectWriteSet:()=>JS,$Ed25519Signature:()=>ZS,$EncodeSubmissionRequest:()=>YS,$EntryFunctionId:()=>QS,$EntryFunctionPayload:()=>ex,$Event:()=>tx,$EventGuid:()=>nx,$GasEstimation:()=>ix,$GenesisPayload:()=>sx,$GenesisPayload_WriteSetPayload:()=>ox,$GenesisTransaction:()=>rx,$HashValue:()=>ax,$HealthCheckSuccess:()=>cx,$HexEncodedBytes:()=>ux,$IdentifierWrapper:()=>lx,$IndexResponse:()=>dx,$ModuleBundlePayload:()=>hx,$MoveAbility:()=>px,$MoveFunction:()=>fx,$MoveFunctionGenericTypeParam:()=>gx,$MoveFunctionVisibility:()=>mx,$MoveModule:()=>_x,$MoveModuleBytecode:()=>yx,$MoveModuleId:()=>wx,$MoveResource:()=>bx,$MoveScriptBytecode:()=>vx,$MoveStruct:()=>Tx,$MoveStructField:()=>Ax,$MoveStructGenericTypeParam:()=>kx,$MoveStructTag:()=>Sx,$MoveStructValue:()=>xx,$MoveType:()=>Px,$MoveValue:()=>Ex,$MultiAgentSignature:()=>Cx,$MultiEd25519Signature:()=>Bx,$MultisigPayload:()=>Ix,$MultisigTransactionPayload:()=>Ox,$PendingTransaction:()=>Rx,$RawTableItemRequest:()=>$x,$RoleType:()=>Ux,$ScriptPayload:()=>Mx,$ScriptWriteSet:()=>Dx,$StateCheckpointTransaction:()=>qx,$StateKeyWrapper:()=>Lx,$SubmitTransactionRequest:()=>Nx,$TableItemRequest:()=>jx,$Transaction:()=>Fx,$TransactionPayload:()=>Vx,$TransactionPayload_EntryFunctionPayload:()=>Xx,$TransactionPayload_ModuleBundlePayload:()=>Jx,$TransactionPayload_MultisigPayload:()=>Zx,$TransactionPayload_ScriptPayload:()=>Yx,$TransactionSignature:()=>t6,$TransactionSignature_Ed25519Signature:()=>n6,$TransactionSignature_MultiAgentSignature:()=>i6,$TransactionSignature_MultiEd25519Signature:()=>s6,$Transaction_BlockMetadataTransaction:()=>zx,$Transaction_GenesisTransaction:()=>Hx,$Transaction_PendingTransaction:()=>Kx,$Transaction_StateCheckpointTransaction:()=>Gx,$Transaction_UserTransaction:()=>Wx,$TransactionsBatchSingleSubmissionFailure:()=>Qx,$TransactionsBatchSubmissionResult:()=>e6,$U128:()=>o6,$U256:()=>r6,$U64:()=>a6,$UserTransaction:()=>c6,$VersionedEvent:()=>u6,$ViewRequest:()=>l6,$WriteModule:()=>d6,$WriteResource:()=>h6,$WriteSet:()=>p6,$WriteSetChange:()=>m6,$WriteSetChange_DeleteModule:()=>_6,$WriteSetChange_DeleteResource:()=>y6,$WriteSetChange_DeleteTableItem:()=>w6,$WriteSetChange_WriteModule:()=>b6,$WriteSetChange_WriteResource:()=>v6,$WriteSetChange_WriteTableItem:()=>T6,$WriteSetPayload:()=>A6,$WriteSet_DirectWriteSet:()=>f6,$WriteSet_ScriptWriteSet:()=>g6,$WriteTableItem:()=>k6,AccountsService:()=>dy,ApiError:()=>pa,AptosErrorCode:()=>wy,AptosGeneratedClient:()=>yy,BaseHttpRequest:()=>oy,BlocksService:()=>hy,CancelError:()=>ry,CancelablePromise:()=>ay,EventsService:()=>py,GeneralService:()=>fy,MoveFunctionVisibility:()=>by,OpenAPI:()=>US,RoleType:()=>vy,TablesService:()=>gy,TransactionsService:()=>my,ViewService:()=>_y});var oy=class{constructor(t){this.config=t}},pa=class extends Error{constructor(t,e,n){super(n),this.name="ApiError",this.url=e.url,this.status=e.status,this.statusText=e.statusText,this.body=e.body,this.request=t}},ry=class extends Error{constructor(t){super(t),this.name="CancelError"}get isCancelled(){return!0}},ay=class{constructor(t){this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._cancelHandlers=[],this._promise=new Promise((e,n)=>{this._resolve=e,this._reject=n;const i=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isResolved=!0,(a=this._resolve)==null||a.call(this,r))},s=r=>{var a;this._isResolved||this._isRejected||this._isCancelled||(this._isRejected=!0,(a=this._reject)==null||a.call(this,r))},o=r=>{this._isResolved||this._isRejected||this._isCancelled||this._cancelHandlers.push(r)};return Object.defineProperty(o,"isResolved",{get:()=>this._isResolved}),Object.defineProperty(o,"isRejected",{get:()=>this._isRejected}),Object.defineProperty(o,"isCancelled",{get:()=>this._isCancelled}),t(i,s,o)})}then(t,e){return this._promise.then(t,e)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(){var t;if(!(this._isResolved||this._isRejected||this._isCancelled)){if(this._isCancelled=!0,this._cancelHandlers.length)try{for(const e of this._cancelHandlers)e()}catch(e){console.warn("Cancellation threw an error",e);return}this._cancelHandlers.length=0,(t=this._reject)==null||t.call(this,new ry("Request aborted"))}}get isCancelled(){return this._isCancelled}},cy=class{constructor(t=new Map){this.jar=t}setCookie(t,e){var n;const i=t.origin.toLowerCase();this.jar.has(i)||this.jar.set(i,[]);const s=cy.parse(e);this.jar.set(i,[...((n=this.jar.get(i))==null?void 0:n.filter(o=>o.name!==s.name))||[],s])}getCookies(t){var e;const n=t.origin.toLowerCase();return this.jar.get(n)?((e=this.jar.get(n))==null?void 0:e.filter(i=>!i.expires||i.expires>new Date))||[]:[]}static parse(t){if(typeof t!="string")throw new Error("argument str must be a string");const e=t.split(";").map(i=>i.trim());let n;if(e.length>0){const[i,s]=e[0].split("=");if(!i||!s)throw new Error("Invalid cookie");n={name:i,value:s}}else throw new Error("Invalid cookie");return e.slice(1).forEach(i=>{const[s,o]=i.split("=");if(!s.trim())throw new Error("Invalid cookie");const r=s.toLowerCase(),a=(o==null?void 0:o.charAt(0))==="'"||(o==null?void 0:o.charAt(0))==='"'?o==null?void 0:o.slice(1,-1):o;if(r==="expires"&&(n.expires=new Date(a)),r==="path"&&(n.path=a),r==="samesite"){if(a!=="Lax"&&a!=="None"&&a!=="Strict")throw new Error("Invalid cookie SameSite value");n.sameSite=a}r==="secure"&&(n.secure=!0)}),n}},uy=new cy;Qs.interceptors.response.use(t=>(Array.isArray(t.headers["set-cookie"])&&t.headers["set-cookie"].forEach(e=>{uy.setCookie(new URL(t.config.url),e)}),t));Qs.interceptors.request.use(function(t){const e=uy.getCookies(new URL(t.url));return(e==null?void 0:e.length)>0&&t.headers&&(t.headers.cookie=e.map(n=>`${n.name}=${n.value}`).join("; ")),t});var op=t=>t!=null,cl=t=>typeof t=="string",cd=t=>cl(t)&&t!=="",ly=t=>typeof t=="object"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.arrayBuffer=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),vS=t=>t instanceof X_,TS=t=>t>=200&&t<300,AS=t=>btoa(t),kS=t=>{const e=[],n=(s,o)=>{e.push(`${encodeURIComponent(s)}=${encodeURIComponent(String(o))}`)},i=(s,o)=>{op(o)&&(Array.isArray(o)?o.forEach(r=>{i(s,r)}):typeof o=="object"?Object.entries(o).forEach(([r,a])=>{i(`${s}[${r}]`,a)}):n(s,o))};return Object.entries(t).forEach(([s,o])=>{i(s,o)}),e.length>0?`?${e.join("&")}`:""},SS=(t,e)=>{const n=t.ENCODE_PATH||encodeURI,i=e.url.replace("{api-version}",t.VERSION).replace(/{(.*?)}/g,(o,r)=>{var a;return(a=e.path)!=null&&a.hasOwnProperty(r)?n(String(e.path[r])):o}),s=`${t.BASE}${i}`;return e.query?`${s}${kS(e.query)}`:s},xS=t=>{if(t.formData){const e=new X_,n=(i,s)=>{cl(s)||ly(s)?e.append(i,s):e.append(i,JSON.stringify(s))};return Object.entries(t.formData).filter(([i,s])=>op(s)).forEach(([i,s])=>{Array.isArray(s)?s.forEach(o=>n(i,o)):n(i,s)}),e}},Ja=async(t,e)=>typeof e=="function"?e(t):e,PS=async(t,e,n)=>{const i=await Ja(e,t.TOKEN),s=await Ja(e,t.USERNAME),o=await Ja(e,t.PASSWORD),r=await Ja(e,t.HEADERS),a=typeof(n==null?void 0:n.getHeaders)=="function"&&(n==null?void 0:n.getHeaders())||{},c=Object.entries({Accept:"application/json",...r,...e.headers,...a}).filter(([u,l])=>op(l)).reduce((u,[l,d])=>({...u,[l]:String(d)}),{});if(cd(i)&&(c.Authorization=`Bearer ${i}`),cd(s)&&cd(o)){const u=AS(`${s}:${o}`);c.Authorization=`Basic ${u}`}return e.body&&(e.mediaType?c["Content-Type"]=e.mediaType:ly(e.body)?c["Content-Type"]=e.body.type||"application/octet-stream":cl(e.body)?c["Content-Type"]="text/plain":vS(e.body)||(c["Content-Type"]="application/json")),c},ES=t=>{if(t.body)return t.body},CS=async(t,e,n,i,s,o,r)=>{const a=Qs.CancelToken.source(),c={url:n,headers:o,data:i??s,method:e.method,withCredentials:t.WITH_CREDENTIALS,cancelToken:a.token};Object.keys(t.HEADERS||{}).filter(l=>l.toLowerCase()==="accept").map(l=>t.HEADERS[l]).includes("application/x-bcs")&&(c.responseType="arraybuffer"),r(()=>a.cancel("The user aborted a request."));try{return await Qs.request(c)}catch(l){const d=l;if(d.response)return d.response;throw l}},BS=(t,e)=>{if(e){const n=t.headers[e];if(cl(n))return n}},IS=t=>{if(t.status!==204)return t.data},OS=(t,e)=>{const i={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...t.errors}[e.status];if(i)throw new pa(t,e,i);if(!e.ok)throw new pa(t,e,"Generic Error")},RS=(t,e)=>new ay(async(n,i,s)=>{try{const o=SS(t,e),r=xS(e),a=ES(e),c=await PS(t,e,r);if(!s.isCancelled){const u=await CS(t,e,o,a,r,c,s),l=IS(u),d=BS(u,e.responseHeader),p={url:o,ok:TS(u.status),status:u.status,statusText:u.statusText,body:d??l};OS(e,p);const g=p.body;try{g.__headers=u.headers}catch{}n(g)}}catch(o){i(o)}}),$S=class extends oy{constructor(t){super(t)}request(t){return RS(this.config,t)}},dy=class{constructor(t){this.httpRequest=t}getAccount(t,e){return this.httpRequest.request({method:"GET",url:"/accounts/{address}",path:{address:t},query:{ledger_version:e}})}getAccountResources(t,e,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resources",path:{address:t},query:{ledger_version:e,start:n,limit:i}})}getAccountModules(t,e,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/modules",path:{address:t},query:{ledger_version:e,start:n,limit:i}})}getAccountResource(t,e,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/resource/{resource_type}",path:{address:t,resource_type:e},query:{ledger_version:n}})}getAccountModule(t,e,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/module/{module_name}",path:{address:t,module_name:e},query:{ledger_version:n}})}},hy=class{constructor(t){this.httpRequest=t}getBlockByHeight(t,e){return this.httpRequest.request({method:"GET",url:"/blocks/by_height/{block_height}",path:{block_height:t},query:{with_transactions:e}})}getBlockByVersion(t,e){return this.httpRequest.request({method:"GET",url:"/blocks/by_version/{version}",path:{version:t},query:{with_transactions:e}})}},py=class{constructor(t){this.httpRequest=t}getEventsByCreationNumber(t,e,n,i){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{creation_number}",path:{address:t,creation_number:e},query:{start:n,limit:i}})}getEventsByEventHandle(t,e,n,i,s){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/events/{event_handle}/{field_name}",path:{address:t,event_handle:e,field_name:n},query:{start:i,limit:s}})}},fy=class{constructor(t){this.httpRequest=t}spec(){return this.httpRequest.request({method:"GET",url:"/spec"})}healthy(t){return this.httpRequest.request({method:"GET",url:"/-/healthy",query:{duration_secs:t}})}getLedgerInfo(){return this.httpRequest.request({method:"GET",url:"/"})}},gy=class{constructor(t){this.httpRequest=t}getTableItem(t,e,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/item",path:{table_handle:t},query:{ledger_version:n},body:e,mediaType:"application/json"})}getRawTableItem(t,e,n){return this.httpRequest.request({method:"POST",url:"/tables/{table_handle}/raw_item",path:{table_handle:t},query:{ledger_version:n},body:e,mediaType:"application/json"})}},my=class{constructor(t){this.httpRequest=t}getTransactions(t,e){return this.httpRequest.request({method:"GET",url:"/transactions",query:{start:t,limit:e}})}submitTransaction(t){return this.httpRequest.request({method:"POST",url:"/transactions",body:t,mediaType:"application/json"})}getTransactionByHash(t){return this.httpRequest.request({method:"GET",url:"/transactions/by_hash/{txn_hash}",path:{txn_hash:t}})}getTransactionByVersion(t){return this.httpRequest.request({method:"GET",url:"/transactions/by_version/{txn_version}",path:{txn_version:t}})}getAccountTransactions(t,e,n){return this.httpRequest.request({method:"GET",url:"/accounts/{address}/transactions",path:{address:t},query:{start:e,limit:n}})}submitBatchTransactions(t){return this.httpRequest.request({method:"POST",url:"/transactions/batch",body:t,mediaType:"application/json"})}simulateTransaction(t,e,n,i){return this.httpRequest.request({method:"POST",url:"/transactions/simulate",query:{estimate_max_gas_amount:e,estimate_gas_unit_price:n,estimate_prioritized_gas_unit_price:i},body:t,mediaType:"application/json"})}encodeSubmission(t){return this.httpRequest.request({method:"POST",url:"/transactions/encode_submission",body:t,mediaType:"application/json"})}estimateGasPrice(){return this.httpRequest.request({method:"GET",url:"/estimate_gas_price"})}},_y=class{constructor(t){this.httpRequest=t}view(t,e){return this.httpRequest.request({method:"POST",url:"/view",query:{ledger_version:e},body:t,mediaType:"application/json"})}},yy=class{constructor(t,e=$S){var n,i,s,o;this.request=new e({BASE:(n=t==null?void 0:t.BASE)!=null?n:"/v1",VERSION:(i=t==null?void 0:t.VERSION)!=null?i:"1.2.0",WITH_CREDENTIALS:(s=t==null?void 0:t.WITH_CREDENTIALS)!=null?s:!1,CREDENTIALS:(o=t==null?void 0:t.CREDENTIALS)!=null?o:"include",TOKEN:t==null?void 0:t.TOKEN,USERNAME:t==null?void 0:t.USERNAME,PASSWORD:t==null?void 0:t.PASSWORD,HEADERS:t==null?void 0:t.HEADERS,ENCODE_PATH:t==null?void 0:t.ENCODE_PATH}),this.accounts=new dy(this.request),this.blocks=new hy(this.request),this.events=new py(this.request),this.general=new fy(this.request),this.tables=new gy(this.request),this.transactions=new my(this.request),this.view=new _y(this.request)}},US={BASE:"/v1",VERSION:"1.2.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},wy=(t=>(t.ACCOUNT_NOT_FOUND="account_not_found",t.RESOURCE_NOT_FOUND="resource_not_found",t.MODULE_NOT_FOUND="module_not_found",t.STRUCT_FIELD_NOT_FOUND="struct_field_not_found",t.VERSION_NOT_FOUND="version_not_found",t.TRANSACTION_NOT_FOUND="transaction_not_found",t.TABLE_ITEM_NOT_FOUND="table_item_not_found",t.BLOCK_NOT_FOUND="block_not_found",t.VERSION_PRUNED="version_pruned",t.BLOCK_PRUNED="block_pruned",t.INVALID_INPUT="invalid_input",t.INVALID_TRANSACTION_UPDATE="invalid_transaction_update",t.SEQUENCE_NUMBER_TOO_OLD="sequence_number_too_old",t.VM_ERROR="vm_error",t.HEALTH_CHECK_FAILED="health_check_failed",t.MEMPOOL_IS_FULL="mempool_is_full",t.INTERNAL_ERROR="internal_error",t.WEB_FRAMEWORK_ERROR="web_framework_error",t.BCS_NOT_SUPPORTED="bcs_not_supported",t.API_DISABLED="api_disabled",t))(wy||{}),by=(t=>(t.PRIVATE="private",t.PUBLIC="public",t.FRIEND="friend",t))(by||{}),vy=(t=>(t.VALIDATOR="validator",t.FULL_NODE="full_node",t))(vy||{}),MS={description:`Account data

    A simplified version of the onchain Account resource`,properties:{sequence_number:{type:"U64",isRequired:!0},authentication_key:{type:"HexEncodedBytes",isRequired:!0}}},DS={type:"one-of",description:`Account signature scheme

    The account signature scheme allows you to have two types of accounts:

    1. A single Ed25519 key account, one private key
    2. A k-of-n multi-Ed25519 key account, multiple private keys, such that k-of-n must sign a transaction.`,contains:[{type:"AccountSignature_Ed25519Signature"},{type:"AccountSignature_MultiEd25519Signature"}]},qS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},LS={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},NS={type:"string",description:`A hex encoded 32 byte Aptos account address.

    This is represented in a string as a 64 character hex string, sometimes
    shortened by stripping leading 0s, and adding a 0x.

    For example, address 0x0000000000000000000000000000000000000000000000000000000000000001 is represented as 0x1.
    `,format:"hex"},jS={description:`This is the generic struct we use for all API errors, it contains a string
    message and an Aptos API specific error code.`,properties:{message:{type:"string",description:"A message describing the error",isRequired:!0},error_code:{type:"AptosErrorCode",isRequired:!0},vm_error_code:{type:"number",description:"A code providing VM error details when submitting transactions to the VM",format:"uint64"}}},FS={type:"Enum"},zS={description:`A Block with or without transactions

    This contains the information about a transactions along with
    associated transactions if requested`,properties:{block_height:{type:"U64",isRequired:!0},block_hash:{type:"HashValue",isRequired:!0},block_timestamp:{type:"U64",isRequired:!0},first_version:{type:"U64",isRequired:!0},last_version:{type:"U64",isRequired:!0},transactions:{type:"array",contains:{type:"Transaction"}}}},HS={description:`A block metadata transaction

    This signifies the beginning of a block, and contains information
    about the specific block`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},id:{type:"HashValue",isRequired:!0},epoch:{type:"U64",isRequired:!0},round:{type:"U64",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0},previous_block_votes_bitvec:{type:"array",contains:{type:"number",format:"uint8"},isRequired:!0},proposer:{type:"Address",isRequired:!0},failed_proposer_indices:{type:"array",contains:{type:"number",format:"uint32"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},KS={description:"Decoded table data",properties:{key:{description:"Key of table in JSON",properties:{},isRequired:!0},key_type:{type:"string",description:"Type of key",isRequired:!0},value:{description:"Value of table in JSON",properties:{},isRequired:!0},value_type:{type:"string",description:"Type of value",isRequired:!0}}},GS={description:"Deleted table data",properties:{key:{description:"Deleted key",properties:{},isRequired:!0},key_type:{type:"string",description:"Deleted key type",isRequired:!0}}},WS={description:"Delete a module",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},module:{type:"MoveModuleId",isRequired:!0}}},VS={description:"Delete a resource",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},resource:{type:"MoveStructTag",isRequired:!0}}},XS={description:"Delete a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DeletedTableData"}}},JS={properties:{changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},ZS={description:"A single Ed25519 signature",properties:{public_key:{type:"HexEncodedBytes",isRequired:!0},signature:{type:"HexEncodedBytes",isRequired:!0}}},YS={description:"Request to encode a submission",properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},secondary_signers:{type:"array",contains:{type:"Address"}}}},QS={type:"string",description:"Entry function id is string representation of a entry function defined on-chain.\n\n    Format: `{address}::{module name}::{function name}`\n\n    Both `module name` and `function name` are case-sensitive.\n    "},ex={description:"Payload which runs a single entry function",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},tx={description:"An event from a transaction",properties:{guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},nx={properties:{creation_number:{type:"U64",isRequired:!0},account_address:{type:"Address",isRequired:!0}}},ix={description:"Struct holding the outputs of the estimate gas API",properties:{deprioritized_gas_estimate:{type:"number",description:"The deprioritized estimate for the gas unit price",format:"uint64"},gas_estimate:{type:"number",description:"The current estimate for the gas unit price",isRequired:!0,format:"uint64"},prioritized_gas_estimate:{type:"number",description:"The prioritized estimate for the gas unit price",format:"uint64"}}},sx={type:"one-of",description:"The writeset payload of the Genesis transaction",contains:[{type:"GenesisPayload_WriteSetPayload"}]},ox={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteSetPayload"}]},rx={description:`The genesis transaction

    This only occurs at the genesis transaction (version 0)`,properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},payload:{type:"GenesisPayload",isRequired:!0},events:{type:"array",contains:{type:"Event"},isRequired:!0}}},ax={type:"string"},cx={description:"Representation of a successful healthcheck",properties:{message:{type:"string",isRequired:!0}}},ux={type:"string",description:"All bytes (Vec<u8>) data is represented as hex-encoded string prefixed with `0x` and fulfilled with\n    two hex digits per byte.\n\n    Unlike the `Address` type, HexEncodedBytes will not trim any zeros.\n    ",format:"hex"},lx={type:"string"},dx={description:`The struct holding all data returned to the client by the
    index endpoint (i.e., GET "/").  Only for responding in JSON`,properties:{chain_id:{type:"number",description:"Chain ID of the current chain",isRequired:!0,format:"uint8"},epoch:{type:"U64",isRequired:!0},ledger_version:{type:"U64",isRequired:!0},oldest_ledger_version:{type:"U64",isRequired:!0},ledger_timestamp:{type:"U64",isRequired:!0},node_role:{type:"RoleType",isRequired:!0},oldest_block_height:{type:"U64",isRequired:!0},block_height:{type:"U64",isRequired:!0},git_hash:{type:"string",description:`Git hash of the build of the API endpoint.  Can be used to determine the exact
            software version used by the API endpoint.`}}},hx={properties:{modules:{type:"array",contains:{type:"MoveModuleBytecode"},isRequired:!0}}},px={type:"string"},fx={description:"Move function",properties:{name:{type:"IdentifierWrapper",isRequired:!0},visibility:{type:"MoveFunctionVisibility",isRequired:!0},is_entry:{type:"boolean",description:"Whether the function can be called as an entry function directly in a transaction",isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveFunctionGenericTypeParam"},isRequired:!0},params:{type:"array",contains:{type:"MoveType"},isRequired:!0},return:{type:"array",contains:{type:"MoveType"},isRequired:!0}}},gx={description:"Move function generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},mx={type:"Enum"},_x={description:"A Move module",properties:{address:{type:"Address",isRequired:!0},name:{type:"IdentifierWrapper",isRequired:!0},friends:{type:"array",contains:{type:"MoveModuleId"},isRequired:!0},exposed_functions:{type:"array",contains:{type:"MoveFunction"},isRequired:!0},structs:{type:"array",contains:{type:"MoveStruct"},isRequired:!0}}},yx={description:"Move module bytecode along with it's ABI",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveModule"}}},wx={type:"string",description:`Move module id is a string representation of Move module.

    Format: \`{address}::{module name}\`

    \`address\` should be hex-encoded 32 byte account address that is prefixed with \`0x\`.

    Module name is case-sensitive.
    `},bx={description:"A parsed Move resource",properties:{type:{type:"MoveStructTag",isRequired:!0},data:{type:"MoveStructValue",isRequired:!0}}},vx={description:"Move script bytecode",properties:{bytecode:{type:"HexEncodedBytes",isRequired:!0},abi:{type:"MoveFunction"}}},Tx={description:"A move struct",properties:{name:{type:"IdentifierWrapper",isRequired:!0},is_native:{type:"boolean",description:"Whether the struct is a native struct of Move",isRequired:!0},abilities:{type:"array",contains:{type:"MoveAbility"},isRequired:!0},generic_type_params:{type:"array",contains:{type:"MoveStructGenericTypeParam"},isRequired:!0},fields:{type:"array",contains:{type:"MoveStructField"},isRequired:!0}}},Ax={description:"Move struct field",properties:{name:{type:"IdentifierWrapper",isRequired:!0},type:{type:"MoveType",isRequired:!0}}},kx={description:"Move generic type param",properties:{constraints:{type:"array",contains:{type:"MoveAbility"},isRequired:!0}}},Sx={type:"string",description:"String representation of a MoveStructTag (on-chain Move struct type). This exists so you\n    can specify MoveStructTags as path / query parameters, e.g. for get_events_by_event_handle.\n\n    It is a combination of:\n    1. `move_module_address`, `module_name` and `struct_name`, all joined by `::`\n    2. `struct generic type parameters` joined by `, `\n\n    Examples:\n     * `0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>`\n     * `0x1::account::Account`\n\n    Note:\n    1. Empty chars should be ignored when comparing 2 struct tag ids.\n    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).\n\n    See [doc](https://aptos.dev/concepts/accounts) for more details.\n    ",pattern:"^0x[0-9a-zA-Z:_<>]+$"},xx={description:'This is a JSON representation of some data within an account resource. More specifically,\n    it is a map of strings to arbitrary JSON values / objects, where the keys are top level\n    fields within the given resource.\n\n    To clarify, you might query for 0x1::account::Account and see the example data.\n\n    Move `bool` type value is serialized into `boolean`.\n\n    Move `u8`, `u16` and `u32` type value is serialized into `integer`.\n\n    Move `u64`, `u128` and `u256` type value is serialized into `string`.\n\n    Move `address` type value (32 byte Aptos account address) is serialized into a HexEncodedBytes string.\n    For example:\n    - `0x1`\n    - `0x1668f6be25668c1a17cd8caf6b8d2f25`\n\n    Move `vector` type value is serialized into `array`, except `vector<u8>` which is serialized into a\n    HexEncodedBytes string with `0x` prefix.\n    For example:\n    - `vector<u64>{255, 255}` => `["255", "255"]`\n    - `vector<u8>{255, 255}` => `0xffff`\n\n    Move `struct` type value is serialized into `object` that looks like this (except some Move stdlib types, see the following section):\n    ```json\n    {\n        field1_name: field1_value,\n        field2_name: field2_value,\n        ......\n    }\n    ```\n\n    For example:\n    `{ "created": "0xa550c18", "role_id": "0" }`\n\n     **Special serialization for Move stdlib types**:\n    - [0x1::string::String](https://github.com/aptos-labs/aptos-core/blob/main/language/move-stdlib/docs/ascii.md)\n    is serialized into `string`. For example, struct value `0x1::string::String{bytes: b"Hello World!"}`\n    is serialized as `"Hello World!"` in JSON.\n    ',properties:{}},Px={type:"string",description:`String representation of an on-chain Move type tag that is exposed in transaction payload.
    Values:
    - bool
    - u8
    - u16
    - u32
    - u64
    - u128
    - u256
    - address
    - signer
    - vector: \`vector<{non-reference MoveTypeId}>\`
    - struct: \`{address}::{module_name}::{struct_name}::<{generic types}>\`

    Vector type value examples:
    - \`vector<u8>\`
    - \`vector<vector<u64>>\`
    - \`vector<0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>>\`

    Struct type value examples:
    - \`0x1::coin::CoinStore<0x1::aptos_coin::AptosCoin>
    - \`0x1::account::Account\`

    Note:
    1. Empty chars should be ignored when comparing 2 struct tag ids.
    2. When used in an URL path, should be encoded by url-encoding (AKA percent-encoding).
    `,pattern:"^(bool|u8|u64|u128|address|signer|vector<.+>|0x[0-9a-zA-Z:_<, >]+)$"},Ex={type:"any-of",description:"An enum of the possible Move value types",contains:[{type:"number",format:"uint8"},{type:"number",format:"uint16"},{type:"number",format:"uint32"},{type:"U64"},{type:"U128"},{type:"U256"},{type:"boolean"},{type:"Address"},{type:"array",contains:{type:"MoveValue"}},{type:"HexEncodedBytes"},{type:"MoveStructValue"},{type:"string"}]},Cx={description:`Multi agent signature for multi agent transactions

    This allows you to have transactions across multiple accounts`,properties:{sender:{type:"AccountSignature",isRequired:!0},secondary_signer_addresses:{type:"array",contains:{type:"Address"},isRequired:!0},secondary_signers:{type:"array",contains:{type:"AccountSignature"},isRequired:!0}}},Bx={description:`A Ed25519 multi-sig signature

    This allows k-of-n signing for a transaction`,properties:{public_keys:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},signatures:{type:"array",contains:{type:"HexEncodedBytes"},isRequired:!0},threshold:{type:"number",description:"The number of signatures required for a successful transaction",isRequired:!0,format:"uint8"},bitmap:{type:"HexEncodedBytes",isRequired:!0}}},Ix={description:`A multisig transaction that allows an owner of a multisig account to execute a pre-approved
    transaction as the multisig account.`,properties:{multisig_address:{type:"Address",isRequired:!0},transaction_payload:{type:"MultisigTransactionPayload"}}},Ox={type:"any-of",contains:[{type:"EntryFunctionPayload"}]},Rx={description:"A transaction waiting in mempool",properties:{hash:{type:"HashValue",isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"}}},$x={description:"Table Item request for the GetTableItemRaw API",properties:{key:{type:"HexEncodedBytes",isRequired:!0}}},Ux={type:"Enum"},Mx={description:"Payload which runs a script that can run multiple functions",properties:{code:{type:"MoveScriptBytecode",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},Dx={properties:{execute_as:{type:"Address",isRequired:!0},script:{type:"ScriptPayload",isRequired:!0}}},qx={description:"A state checkpoint transaction",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},Lx={type:"string",description:`Representation of a StateKey as a hex string. This is used for cursor based pagination.
    `},Nx={description:`A request to submit a transaction

    This requires a transaction and a signature of it`,properties:{sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature",isRequired:!0}}},jx={description:"Table Item request for the GetTableItem API",properties:{key_type:{type:"MoveType",isRequired:!0},value_type:{type:"MoveType",isRequired:!0},key:{description:"The value of the table item's key",properties:{},isRequired:!0}}},Fx={type:"one-of",description:"Enum of the different types of transactions in Aptos",contains:[{type:"Transaction_PendingTransaction"},{type:"Transaction_UserTransaction"},{type:"Transaction_GenesisTransaction"},{type:"Transaction_BlockMetadataTransaction"},{type:"Transaction_StateCheckpointTransaction"}]},zx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"BlockMetadataTransaction"}]},Hx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"GenesisTransaction"}]},Kx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"PendingTransaction"}]},Gx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"StateCheckpointTransaction"}]},Wx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"UserTransaction"}]},Vx={type:"one-of",description:"An enum of the possible transaction payloads",contains:[{type:"TransactionPayload_EntryFunctionPayload"},{type:"TransactionPayload_ScriptPayload"},{type:"TransactionPayload_ModuleBundlePayload"},{type:"TransactionPayload_MultisigPayload"}]},Xx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"EntryFunctionPayload"}]},Jx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ModuleBundlePayload"}]},Zx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultisigPayload"}]},Yx={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptPayload"}]},Qx={description:"Information telling which batch submission transactions failed",properties:{error:{type:"AptosError",isRequired:!0},transaction_index:{type:"number",description:"The index of which transaction failed, same as submission order",isRequired:!0,format:"uint64"}}},e6={description:`Batch transaction submission result

    Tells which transactions failed`,properties:{transaction_failures:{type:"array",contains:{type:"TransactionsBatchSingleSubmissionFailure"},isRequired:!0}}},t6={type:"one-of",description:"An enum representing the different transaction signatures available",contains:[{type:"TransactionSignature_Ed25519Signature"},{type:"TransactionSignature_MultiEd25519Signature"},{type:"TransactionSignature_MultiAgentSignature"}]},n6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"Ed25519Signature"}]},i6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiAgentSignature"}]},s6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"MultiEd25519Signature"}]},o6={type:"string",description:`A string containing a 128-bit unsigned integer.

    We represent u128 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u128s in JSON natively.
    `,format:"uint128"},r6={type:"string",description:`A string containing a 256-bit unsigned integer.

    We represent u256 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u256s in JSON natively.
    `,format:"uint256"},a6={type:"string",description:`A string containing a 64-bit unsigned integer.

    We represent u64 values as a string to ensure compatibility with languages such
    as JavaScript that do not parse u64s in JSON natively.
    `,format:"uint64"},c6={description:"A transaction submitted by a user to change the state of the blockchain",properties:{version:{type:"U64",isRequired:!0},hash:{type:"HashValue",isRequired:!0},state_change_hash:{type:"HashValue",isRequired:!0},event_root_hash:{type:"HashValue",isRequired:!0},state_checkpoint_hash:{type:"HashValue"},gas_used:{type:"U64",isRequired:!0},success:{type:"boolean",description:"Whether the transaction was successful",isRequired:!0},vm_status:{type:"string",description:"The VM status of the transaction, can tell useful information in a failure",isRequired:!0},accumulator_root_hash:{type:"HashValue",isRequired:!0},changes:{type:"array",contains:{type:"WriteSetChange"},isRequired:!0},sender:{type:"Address",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},max_gas_amount:{type:"U64",isRequired:!0},gas_unit_price:{type:"U64",isRequired:!0},expiration_timestamp_secs:{type:"U64",isRequired:!0},payload:{type:"TransactionPayload",isRequired:!0},signature:{type:"TransactionSignature"},events:{type:"array",contains:{type:"Event"},isRequired:!0},timestamp:{type:"U64",isRequired:!0}}},u6={description:"An event from a transaction with a version",properties:{version:{type:"U64",isRequired:!0},guid:{type:"EventGuid",isRequired:!0},sequence_number:{type:"U64",isRequired:!0},type:{type:"MoveType",isRequired:!0},data:{description:"The JSON representation of the event",properties:{},isRequired:!0}}},l6={description:"View request for the Move View Function API",properties:{function:{type:"EntryFunctionId",isRequired:!0},type_arguments:{type:"array",contains:{type:"MoveType"},isRequired:!0},arguments:{type:"array",contains:{properties:{}},isRequired:!0}}},d6={description:"Write a new module or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveModuleBytecode",isRequired:!0}}},h6={description:"Write a resource or update an existing one",properties:{address:{type:"Address",isRequired:!0},state_key_hash:{type:"string",description:"State key hash",isRequired:!0},data:{type:"MoveResource",isRequired:!0}}},p6={type:"one-of",description:"The associated writeset with a payload",contains:[{type:"WriteSet_ScriptWriteSet"},{type:"WriteSet_DirectWriteSet"}]},f6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DirectWriteSet"}]},g6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"ScriptWriteSet"}]},m6={type:"one-of",description:"A final state change of a transaction on a resource or module",contains:[{type:"WriteSetChange_DeleteModule"},{type:"WriteSetChange_DeleteResource"},{type:"WriteSetChange_DeleteTableItem"},{type:"WriteSetChange_WriteModule"},{type:"WriteSetChange_WriteResource"},{type:"WriteSetChange_WriteTableItem"}]},_6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteModule"}]},y6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteResource"}]},w6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"DeleteTableItem"}]},b6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteModule"}]},v6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteResource"}]},T6={type:"all-of",contains:[{properties:{type:{type:"string",isRequired:!0}}},{type:"WriteTableItem"}]},A6={description:"A writeset payload, used only for genesis",properties:{write_set:{type:"WriteSet",isRequired:!0}}},k6={description:"Change set to write a table item",properties:{state_key_hash:{type:"string",isRequired:!0},handle:{type:"HexEncodedBytes",isRequired:!0},key:{type:"HexEncodedBytes",isRequired:!0},value:{type:"HexEncodedBytes",isRequired:!0},data:{type:"DecodedTableData"}}},S6=new mr(Lt.fromHex("0x1"),new Pn("string"),new Pn("String"),[]);function ul(t,e,n){if(!(e!=null&&e.includes(typeof t)))throw new Error(n||`Invalid arg: ${t} type should be ${e instanceof Array?e.join(" or "):e}`)}function Ls(t){throw new Error(t)}function $f(t){return!!t.match(/\s/)}function Uf(t){return!!t.match(/[_A-Za-z0-9]/g)}function x6(t,e){const n=t[e];if(n===":"){if(t.slice(e,e+2)==="::")return[["COLON","::"],2];Ls("Unrecognized token.")}else{if(n==="<")return[["LT","<"],1];if(n===">")return[["GT",">"],1];if(n===",")return[["COMMA",","],1];if($f(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if($f(o))i=`${i}${o}`;else break}return[["SPACE",i],i.length]}else if(Uf(n)){let i="";for(let s=e;s<t.length;s+=1){const o=t[s];if(Uf(o))i=`${i}${o}`;else break}return[["IDENT",i],i.length]}}throw new Error("Unrecognized token.")}function P6(t){let e=0;const n=[];for(;e<t.length;){const[i,s]=x6(t,e);i[0]!=="SPACE"&&n.push(i),e+=s}return n}var ll=class{constructor(t){this.tokens=P6(t)}consume(t){const e=this.tokens.shift();(!e||e[1]!==t)&&Ls("Invalid type tag.")}parseCommaList(t,e){const n=[];for(this.tokens.length<=0&&Ls("Invalid type tag.");this.tokens[0][1]!==t&&(n.push(this.parseTypeTag()),!(this.tokens.length>0&&this.tokens[0][1]===t||(this.consume(","),this.tokens.length>0&&this.tokens[0][1]===t&&e)));)this.tokens.length<=0&&Ls("Invalid type tag.");return n}parseTypeTag(){this.tokens.length===0&&Ls("Invalid type tag.");const[t,e]=this.tokens.shift();if(e==="u8")return new Qi;if(e==="u16")return new Br;if(e==="u32")return new Ir;if(e==="u64")return new vo;if(e==="u128")return new To;if(e==="u256")return new Or;if(e==="bool")return new bo;if(e==="address")return new Ao;if(e==="vector"){this.consume("<");const n=this.parseTypeTag();return this.consume(">"),new Rr(n)}if(t==="IDENT"&&(e.startsWith("0x")||e.startsWith("0X"))){const n=e;this.consume("::");const[i,s]=this.tokens.shift();i!=="IDENT"&&Ls("Invalid type tag."),this.consume("::");const[o,r]=this.tokens.shift();o!=="IDENT"&&Ls("Invalid type tag.");let a=[];this.tokens.length>0&&this.tokens[0][1]==="<"&&(this.consume("<"),a=this.parseCommaList(">",!0),this.consume(">"));const c=new mr(Lt.fromHex(n),new Pn(s),new Pn(r),a);return new ko(c)}throw new Error("Invalid type tag.")}};function Ty(t){if(ul(t,["boolean","string"]),typeof t=="boolean")return t;if(t==="true")return!0;if(t==="false")return!1;throw new Error("Invalid boolean string.")}function Zo(t){if(ul(t,["number","string"]),typeof t=="number")return t;const e=Number.parseInt(t,10);if(Number.isNaN(e))throw new Error("Invalid number string.");return e}function Yo(t){return ul(t,["number","bigint","string"]),BigInt(t)}function rp(t,e,n){if(e instanceof bo){n.serializeBool(Ty(t));return}if(e instanceof Qi){n.serializeU8(Zo(t));return}if(e instanceof Br){n.serializeU16(Zo(t));return}if(e instanceof Ir){n.serializeU32(Zo(t));return}if(e instanceof vo){n.serializeU64(Yo(t));return}if(e instanceof To){n.serializeU128(Yo(t));return}if(e instanceof Or){n.serializeU256(Yo(t));return}if(e instanceof Ao){let i;if(typeof t=="string"||t instanceof et)i=Lt.fromHex(t);else if(t instanceof Lt)i=t;else throw new Error("Invalid account address.");i.serialize(n);return}if(e instanceof Rr){if(e.value instanceof Qi){if(t instanceof Uint8Array){n.serializeBytes(t);return}if(typeof t=="string"){n.serializeStr(t);return}}if(!Array.isArray(t))throw new Error("Invalid vector args.");n.serializeU32AsUleb128(t.length),t.forEach(i=>rp(i,e.value,n));return}if(e instanceof ko){const{address:i,module_name:s,name:o}=e.value;if(`${et.fromUint8Array(i.address).toShortString()}::${s.value}::${o.value}`!="0x1::string::String")throw new Error("The only supported struct arg is of type 0x1::string::String");ul(t,["string"]),n.serializeStr(t);return}throw new Error("Unsupported arg type.")}function E6(t,e){if(e instanceof bo)return new ol(Ty(t));if(e instanceof Qi)return new el(Zo(t));if(e instanceof Br)return new tl(Zo(t));if(e instanceof Ir)return new nl(Zo(t));if(e instanceof vo)return new _r(Yo(t));if(e instanceof To)return new il(Yo(t));if(e instanceof Or)return new sl(Yo(t));if(e instanceof Ao){let n;if(typeof t=="string"||t instanceof et)n=Lt.fromHex(t);else if(t instanceof Lt)n=t;else throw new Error("Invalid account address.");return new yr(n)}if(e instanceof Rr&&e.value instanceof Qi){if(!(t instanceof Uint8Array))throw new Error(`${t} should be an instance of Uint8Array`);return new wr(t)}throw new Error("Unknown type for TransactionArgument.")}var C6="APTOS::RawTransaction",B6="APTOS::RawTransactionWithData",Tr=class{constructor(t,e){this.rawTxnBuilder=e,this.signingFunction=t}build(t,e,n){if(!this.rawTxnBuilder)throw new Error("this.rawTxnBuilder doesn't exist.");return this.rawTxnBuilder.build(t,e,n)}static getSigningMessage(t){const e=gr.create();if(t instanceof $r)e.update(C6);else if(t instanceof Zu)e.update(B6);else throw new Error("Unknown transaction type.");const n=e.digest(),i=es(t),s=new Uint8Array(n.length+i.length);return s.set(n),s.set(i,n.length),s}},Pc=class extends Tr{constructor(t,e,n){super(t,n),this.publicKey=e}rawToSigned(t){const e=Tr.getSigningMessage(t),n=this.signingFunction(e),i=new Xu(new si(this.publicKey),n);return new Ma(t,i)}sign(t){return es(this.rawToSigned(t))}},I6=class extends Tr{constructor(t,e){super(t),this.publicKey=e}rawToSigned(t){const e=Tr.getSigningMessage(t),n=this.signingFunction(e),i=new Ju(this.publicKey,n);return new Ma(t,i)}sign(t){return es(this.rawToSigned(t))}},Wc=class{constructor(t,e){this.abiMap=new Map,t.forEach(n=>{const i=new Jh(n),s=rl.deserialize(i);let o;if(s instanceof br){const r=s,{address:a,name:c}=r.module_name;o=`${et.fromUint8Array(a.address).toShortString()}::${c.value}::${r.name}`}else o=s.name;if(this.abiMap.has(o))throw new Error("Found conflicting ABI interfaces");this.abiMap.set(o,s)}),this.builderConfig={maxGasAmount:BigInt(Y_),expSecFromNow:Q_,...e}}static toBCSArgs(t,e){if(t.length!==e.length)throw new Error("Wrong number of args provided.");return e.map((n,i)=>{const s=new Nt;return rp(n,t[i].type_tag,s),s.getBytes()})}static toTransactionArguments(t,e){if(t.length!==e.length)throw new Error("Wrong number of args provided.");return e.map((n,i)=>E6(n,t[i].type_tag))}setSequenceNumber(t){this.builderConfig.sequenceNumber=BigInt(t)}buildTransactionPayload(t,e,n){const i=e.map(r=>new ll(r).parseTypeTag());let s;if(!this.abiMap.has(t))throw new Error(`Cannot find function: ${t}`);const o=this.abiMap.get(t);if(o instanceof br){const r=o,a=Wc.toBCSArgs(r.args,n);s=new Yu(new Js(r.module_name,new Pn(r.name),i,a))}else if(o instanceof al){const r=o,a=Wc.toTransactionArguments(r.args,n);s=new qa(new Ua(r.code,i,a))}else throw new Error("Unknown ABI format.");return s}build(t,e,n){const{sender:i,sequenceNumber:s,gasUnitPrice:o,maxGasAmount:r,expSecFromNow:a,chainId:c}=this.builderConfig;if(!o)throw new Error("No gasUnitPrice provided.");const u=i instanceof Lt?i:Lt.fromHex(i),l=BigInt(Math.floor(Date.now()/1e3)+Number(a)),d=this.buildTransactionPayload(t,e,n);if(d)return new $r(u,BigInt(s),d,BigInt(r),BigInt(o),l,new Qu(Number(c)));throw new Error("Invalid ABI.")}},Ay=class{constructor(t,e){this.aptosClient=t,this.builderConfig=e}async fetchABI(t){const n=(await this.aptosClient.getAccountModules(t)).map(s=>s.abi).flatMap(s=>s.exposed_functions.filter(o=>o.is_entry).map(o=>({fullName:`${s.address}::${s.name}::${o.name}`,...o}))),i=new Map;return n.forEach(s=>{i.set(s.fullName,s)}),i}async build(t,e,n){if(t=(k=>k.replace(/^0[xX]0*/g,"0x"))(t),t.split("::").length!==3)throw new Error("'func' needs to be a fully qualified function name in format <address>::<module>::<function>, e.g. 0x1::coins::transfer");const[o,r]=t.split("::"),a=await this.fetchABI(o);if(!a.has(t))throw new Error(`${t} doesn't exist.`);const c=a.get(t),l=c.params.filter(k=>k!=="signer"&&k!=="&signer").map((k,S)=>new Na(`var${S}`,new ll(k).parseTypeTag())),d=new br(c.name,no.fromStr(`${o}::${r}`),"",c.generic_type_params.map((k,S)=>new La(`${S}`)),l),{sender:p,...g}=this.builderConfig,b=p instanceof Lt?et.fromUint8Array(p.address):p,[{sequence_number:w},T,{gas_estimate:E}]=await Promise.all([g!=null&&g.sequenceNumber?Promise.resolve({sequence_number:g==null?void 0:g.sequenceNumber}):this.aptosClient.getAccount(b),g!=null&&g.chainId?Promise.resolve(g==null?void 0:g.chainId):this.aptosClient.getChainId(),g!=null&&g.gasUnitPrice?Promise.resolve({gas_estimate:g==null?void 0:g.gasUnitPrice}):this.aptosClient.estimateGasPrice()]);return new Wc([es(d)],{sender:p,sequenceNumber:w,chainId:T,gasUnitPrice:BigInt(E),...g}).build(t,e,n)}};kt([Yk(10*60*1e3)],Ay.prototype,"fetchABI",1);var Gr=class{constructor(t,e,n=!1){if(!t)throw new Error("Node URL cannot be empty.");const i=e==null?{}:{...e};n?this.nodeUrl=t:this.nodeUrl=Xk(t),i.BASE=this.nodeUrl,(e==null?void 0:e.WITH_CREDENTIALS)===!1?i.WITH_CREDENTIALS=!1:i.WITH_CREDENTIALS=!0,this.client=new yy(i)}async getAccount(t){return this.client.accounts.getAccount(et.ensure(t).hex())}async getAccountTransactions(t,e){var n;return this.client.transactions.getAccountTransactions(et.ensure(t).hex(),(n=e==null?void 0:e.start)==null?void 0:n.toString(),e==null?void 0:e.limit)}async getAccountModules(t,e){const n=this.client.accounts.getAccountModules.bind({httpRequest:this.client.request});return await Rf(n,t,1e3,e)}async getAccountModule(t,e,n){var i;return this.client.accounts.getAccountModule(et.ensure(t).hex(),e,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async getAccountResources(t,e){const n=this.client.accounts.getAccountResources.bind({httpRequest:this.client.request});return await Rf(n,t,9999,e)}async getAccountResource(t,e,n){var i;return this.client.accounts.getAccountResource(et.ensure(t).hex(),e,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}static generateBCSTransaction(t,e){return new Pc(i=>{const s=t.signBuffer(i);return new D.Ed25519Signature(s.toUint8Array())},t.pubKey().toUint8Array()).sign(e)}static generateBCSSimulation(t,e){return new Pc(i=>{const s=new Uint8Array(64);return new D.Ed25519Signature(s)},t.pubKey().toUint8Array()).sign(e)}async generateTransaction(t,e,n){const i={sender:t};if(n!=null&&n.sequence_number&&(i.sequenceNumber=n.sequence_number),n!=null&&n.gas_unit_price&&(i.gasUnitPrice=n.gas_unit_price),n!=null&&n.max_gas_amount&&(i.maxGasAmount=n.max_gas_amount),n!=null&&n.expiration_timestamp_secs){const o=Number.parseInt(n.expiration_timestamp_secs,10);i.expSecFromNow=o-Math.floor(Date.now()/1e3)}return new Ay(this,i).build(e.function,e.type_arguments,e.arguments)}async signTransaction(t,e){return Promise.resolve(Gr.generateBCSTransaction(t,e))}async getEventsByCreationNumber(t,e,n){var i;return this.client.events.getEventsByCreationNumber(et.ensure(t).hex(),e.toString(),(i=n==null?void 0:n.start)==null?void 0:i.toString(),n==null?void 0:n.limit)}async getEventsByEventHandle(t,e,n,i){var s;return this.client.events.getEventsByEventHandle(et.ensure(t).hex(),e,n,(s=i==null?void 0:i.start)==null?void 0:s.toString(),i==null?void 0:i.limit)}async submitTransaction(t){return this.submitSignedBCSTransaction(t)}async simulateTransaction(t,e,n){let i;return t instanceof ha?i=Gr.generateBCSSimulation(t,e):t instanceof Ra?i=new I6(()=>{const{threshold:o}=t,r=[],a=[];for(let u=0;u<o;u+=1)r.push(u),a.push(new D.Ed25519Signature(new Uint8Array(64)));const c=D.MultiEd25519Signature.createBitmap(r);return new D.MultiEd25519Signature(a,c)},t).sign(e):i=new Pc(()=>{const o=new Uint8Array(64);return new D.Ed25519Signature(o)},t.toBytes()).sign(e),this.submitBCSSimulation(i,n)}async submitSignedBCSTransaction(t){return this.client.request.request({url:"/transactions",method:"POST",body:t,mediaType:"application/x.aptos.signed_transaction+bcs"})}async submitBCSSimulation(t,e){var n,i,s;const o={estimate_gas_unit_price:(n=e==null?void 0:e.estimateGasUnitPrice)!=null?n:!1,estimate_max_gas_amount:(i=e==null?void 0:e.estimateMaxGasAmount)!=null?i:!1,estimate_prioritized_gas_unit_price:(s=e==null?void 0:e.estimatePrioritizedGasUnitPrice)!=null?s:!1};return this.client.request.request({url:"/transactions/simulate",query:o,method:"POST",body:t,mediaType:"application/x.aptos.signed_transaction+bcs"})}async getTransactions(t){var e;return this.client.transactions.getTransactions((e=t==null?void 0:t.start)==null?void 0:e.toString(),t==null?void 0:t.limit)}async getTransactionByHash(t){return this.client.transactions.getTransactionByHash(t)}async getTransactionByVersion(t){return this.client.transactions.getTransactionByVersion(t.toString())}async transactionPending(t){try{return(await this.client.transactions.getTransactionByHash(t)).type==="pending_transaction"}catch(e){if((e==null?void 0:e.status)===404)return!0;throw e}}async waitForTransactionWithResult(t,e){var n,i;const s=(n=e==null?void 0:e.timeoutSecs)!=null?n:Jk,o=(i=e==null?void 0:e.checkSuccess)!=null?i:!1;let r=!0,a=0,c;for(;r&&!(a>=s);){try{if(c=await this.client.transactions.getTransactionByHash(t),r=c.type==="pending_transaction",!r)break}catch(u){const l=u instanceof pa,d=l&&u.status!==404&&u.status>=400&&u.status<500;if(!l||d)throw u}await Vk(1e3),a+=1}if(c===void 0)throw new Error(`Waiting for transaction ${t} failed`);if(r)throw new R6(`Waiting for transaction ${t} timed out after ${s} seconds`,c);if(!o)return c;if(!(c!=null&&c.success))throw new $6(`Transaction ${t} committed to the blockchain but execution failed`,c);return c}async waitForTransaction(t,e){await this.waitForTransactionWithResult(t,e)}async getLedgerInfo(){return this.client.general.getLedgerInfo()}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getTableItem(t,e,n){var i;return await this.client.tables.getTableItem(t,e,(i=n==null?void 0:n.ledgerVersion)==null?void 0:i.toString())}async generateRawTransaction(t,e,n){const[{sequence_number:i},s,{gas_estimate:o}]=await Promise.all([this.getAccount(t),this.getChainId(),n!=null&&n.gasUnitPrice?Promise.resolve({gas_estimate:n.gasUnitPrice}):this.estimateGasPrice()]),{maxGasAmount:r,gasUnitPrice:a,expireTimestamp:c}={maxGasAmount:BigInt(Y_),gasUnitPrice:BigInt(o),expireTimestamp:BigInt(Math.floor(Date.now()/1e3)+Q_),...n};return new D.RawTransaction(D.AccountAddress.fromHex(t),BigInt(i),e,r,a,c,new D.ChainId(s))}async generateSignSubmitTransaction(t,e,n){const i=await this.generateRawTransaction(t.address(),e,n),s=Gr.generateBCSTransaction(t,i);return(await this.submitSignedBCSTransaction(s)).hash}async publishPackage(t,e,n,i){const s=new Nt;Wn(n,s);const o=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural("0x1::code","publish_package_txn",[],[Do(e),s.getBytes()]));return this.generateSignSubmitTransaction(t,o,i)}async generateSignSubmitWaitForTransaction(t,e,n){const i=await this.generateSignSubmitTransaction(t,e,n);return this.waitForTransactionWithResult(i,n)}async estimateGasPrice(){return this.client.transactions.estimateGasPrice()}async estimateMaxGasAmount(t){const e=`0x1::coin::CoinStore<${Zk}>`,[{gas_estimate:n},i]=await Promise.all([this.estimateGasPrice(),this.getAccountResources(t)]),s=i.find(r=>r.type===e);return BigInt(s.data.coin.value)/BigInt(n)}async rotateAuthKeyEd25519(t,e,n){const{sequence_number:i,authentication_key:s}=await this.getAccount(t.address()),o=new ha(e),r=new D.RotationProofChallenge(D.AccountAddress.CORE_CODE_ADDRESS,"account","RotationProofChallenge",BigInt(i),D.AccountAddress.fromHex(t.address()),new D.AccountAddress(new et(s).toUint8Array()),o.pubKey().toUint8Array()),a=et.fromUint8Array(es(r)),c=t.signHexString(a),u=o.signHexString(a),l=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural("0x1::account","rotate_authentication_key",[],[Nd(0),Do(t.pubKey().toUint8Array()),Nd(0),Do(o.pubKey().toUint8Array()),Do(c.toUint8Array()),Do(u.toUint8Array())])),d=await this.generateRawTransaction(t.address(),l,n),p=Gr.generateBCSTransaction(t,d);return this.submitSignedBCSTransaction(p)}async lookupOriginalAddress(t){const e=await this.getAccountResource("0x1","0x1::account::OriginatingAddress"),{address_map:{handle:n}}=e.data,i=await this.getTableItem(n,{key_type:"address",value_type:"address",key:et.ensure(t).hex()});return new et(i)}async getBlockByHeight(t,e){return this.client.blocks.getBlockByHeight(t,e)}async getBlockByVersion(t,e){return this.client.blocks.getBlockByVersion(t,e)}async view(t,e){return this.client.view.view(t,e)}clearCache(t){Qk(t)}},vt=Gr;kt([Qt],vt.prototype,"getAccount",1);kt([Qt],vt.prototype,"getAccountTransactions",1);kt([Qt],vt.prototype,"getAccountModules",1);kt([Qt],vt.prototype,"getAccountModule",1);kt([Qt],vt.prototype,"getAccountResources",1);kt([Qt],vt.prototype,"getAccountResource",1);kt([Qt],vt.prototype,"getEventsByCreationNumber",1);kt([Qt],vt.prototype,"getEventsByEventHandle",1);kt([Qt],vt.prototype,"submitSignedBCSTransaction",1);kt([Qt],vt.prototype,"submitBCSSimulation",1);kt([Qt],vt.prototype,"getTransactions",1);kt([Qt],vt.prototype,"getTransactionByHash",1);kt([Qt],vt.prototype,"getTransactionByVersion",1);kt([Qt],vt.prototype,"getLedgerInfo",1);kt([Wu()],vt.prototype,"getChainId",1);kt([Qt],vt.prototype,"getTableItem",1);kt([Qt,Wu({ttlMs:5*60*1e3,tags:["gas_estimates"]})],vt.prototype,"estimateGasPrice",1);kt([Qt],vt.prototype,"estimateMaxGasAmount",1);kt([Qt],vt.prototype,"getBlockByHeight",1);kt([Qt],vt.prototype,"getBlockByVersion",1);kt([Qt],vt.prototype,"view",1);var O6=class extends Error{constructor(t,e,n,i){super(e),this.status=t,this.message=e,this.errorCode=n,this.vmErrorCode=i}},R6=class extends Error{constructor(t,e){super(t),this.lastSubmittedTransaction=e}},$6=class extends Error{constructor(t,e){super(t),this.transaction=e}};function Qt(t,e,n){const i=n.value;return n.value=async function(...o){var r,a;try{return await i.apply(this,[...o])}catch(c){throw c instanceof pa?new O6(c.status,JSON.stringify({message:c.message,...c.body}),(r=c.body)==null?void 0:r.error_code,(a=c.body)==null?void 0:a.vm_error_code):c}},n}var ky=class{constructor(t,e,n=!1){let i=null,s=null;if(typeof t=="object"&&U6(t)?(i=t.fullnodeUrl,s=t.indexerUrl):(i=tS[t],s=eS[t]),!i||!s)throw new Error("network is not provided");this.aptosClient=new vt(i,e,n),this.indexerClient=new sy(s)}};function Sy(t,e,n){Object.getOwnPropertyNames(e.prototype).forEach(i=>{const s=Object.getOwnPropertyDescriptor(e.prototype,i);s&&(s.value=function(...o){return this[n][i](...o)},Object.defineProperty(t.prototype,i,s))})}Sy(ky,vt,"aptosClient");Sy(ky,sy,"indexerClient");function U6(t){return t.fullnodeUrl!==void 0&&typeof t.fullnodeUrl=="string"&&t.indexerUrl!==void 0&&typeof t.indexerUrl=="string"}var M6="a11ceb0b0500000006010004020408030c0a05161d073339086c400000010100020700010307000104030100010504020007060c0508000800030503010801000405080008000304060c0801050306737472696e6705746f6b656e06537472696e6707546f6b656e4964136372656174655f746f6b656e5f69645f726177087472616e73666572000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000010c0b010b020b030b0411000c070b000b070b050b06110102",D6=["01186372656174655F636F6C6C656374696F6E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E3020637265617465206120656D70747920746F6B656E20636F6C6C656374696F6E207769746820706172616D65746572730005046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700076D6178696D756D020E6D75746174655F73657474696E670600","01136372656174655F746F6B656E5F736372697074000000000000000000000000000000000000000000000000000000000000000305746F6B656E1D2063726561746520746F6B656E20776974682072617720696E70757473000D0A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000B6465736372697074696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000762616C616E636502076D6178696D756D020375726907000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E670015726F79616C74795F70617965655F61646472657373041A726F79616C74795F706F696E74735F64656E6F6D696E61746F720218726F79616C74795F706F696E74735F6E756D657261746F72020E6D75746174655F73657474696E6706000D70726F70657274795F6B6579730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67000F70726F70657274795F76616C7565730606010E70726F70657274795F74797065730607000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700","01166469726563745f7472616e736665725f736372697074000000000000000000000000000000000000000000000000000000000000000305746f6b656e0000051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010C6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000006087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E0206616D6F756E7402","010C636C61696D5F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E73666572730000050673656E646572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","011363616E63656C5F6F666665725F73637269707400000000000000000000000000000000000000000000000000000000000000030F746F6B656E5F7472616E7366657273000005087265636569766572040763726561746F72040A636F6C6C656374696F6E07000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E6700046E616D6507000000000000000000000000000000000000000000000000000000000000000106737472696E6706537472696E67001070726F70657274795F76657273696F6E02","01176d75746174655f746f6b656e5f70726f70657274696573000000000000000000000000000000000000000000000000000000000000000305746f6b656eba02206d75746174652074686520746f6b656e2070726f706572747920616e64207361766520746865206e65772070726f706572747920696e20546f6b656e53746f72650a2069662074686520746f6b656e2070726f70657274795f76657273696f6e20697320302c2077652077696c6c206372656174652061206e65772070726f70657274795f76657273696f6e2070657220746f6b656e20746f2067656e65726174652061206e657720746f6b656e5f69642070657220746f6b656e0a2069662074686520746f6b656e2070726f70657274795f76657273696f6e206973206e6f7420302c2077652077696c6c206a75737420757064617465207468652070726f70657274794d617020616e642075736520746865206578697374696e6720746f6b656e5f6964202870726f70657274795f76657273696f6e2900090b746f6b656e5f6f776e6572040763726561746f72040f636f6c6c656374696f6e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000a746f6b656e5f6e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e670016746f6b656e5f70726f70657274795f76657273696f6e0206616d6f756e7402046b6579730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67000676616c7565730606010574797065730607000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700","01166f70745f696e5f6469726563745f7472616e73666572000000000000000000000000000000000000000000000000000000000000000305746f6b656e000001066f70745f696e00","01046275726e000000000000000000000000000000000000000000000000000000000000000305746f6b656e20204275726e206120746f6b656e2062792074686520746f6b656e206f776e657200051063726561746f72735f61646472657373040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402","010f6275726e5f62795f63726561746f72000000000000000000000000000000000000000000000000000000000000000305746f6b656e6a204275726e206120746f6b656e2062792063726561746f72207768656e2074686520746f6b656e2773204255524e41424c455f42595f43524541544f5220697320747275650a2054686520746f6b656e206973206f776e65642061742061646472657373206f776e65720005056f776e6572040a636f6c6c656374696f6e07000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e6700046e616d6507000000000000000000000000000000000000000000000000000000000000000106737472696e6706537472696e67001070726f70657274795f76657273696f6e0206616d6f756e7402"],xy=class{constructor(t,e){this.type=t,this.value=e}},ap=class{constructor(){this.data={}}setProperty(t,e){this.data[t]=e}};function Py(t){let e;return t==="string"||t==="String"?e=new ko(S6):e=new ll(t).parseTypeTag(),e}function q6(t,e){if(t.length!==e.length)throw new Error("Length of property values and types not match");const n=new Array;return e.forEach((i,s)=>{try{const o=Py(i),r=new Nt;rp(t[s],o,r),n.push(r.getBytes())}catch{n.push(new TextEncoder().encode(t[s]))}}),n}function Ey(t){const e=t.map.data,n=new ap;return e.forEach(i=>{const{key:s}=i,o=i.value.value,r=i.value.type,a=Py(r),c=L6(a,o),u=new xy(r,c);n.setProperty(s,u)}),n}function L6(t,e){const n=new Jh(new et(e).toUint8Array());let i="";return t instanceof Qi?i=n.deserializeU8().toString():t instanceof vo?i=n.deserializeU64().toString():t instanceof To?i=n.deserializeU128().toString():t instanceof bo?i=n.deserializeBool()?"true":"false":t instanceof Ao?i=et.fromUint8Array(n.deserializeFixedBytes(32)).hex():t instanceof ko&&t.isStringTypeTag()?i=n.deserializeStr():i=e,i}var N6={};Gu(N6,{PropertyMap:()=>ap,PropertyValue:()=>xy,Token:()=>By,TokenData:()=>Cy});var Cy=class{constructor(t,e,n,i,s,o,r,a){this.collection=t,this.description=e,this.name=n,this.maximum=i,this.supply=s,this.uri=o,this.default_properties=Ey(r),this.mutability_config=a}},By=class{constructor(t,e,n){this.id=t,this.amount=e,this.token_properties=Ey(n)}},j6=class{constructor(t){this.aptosClient=t,this.transactionBuilder=new Wc(D6.map(e=>new et(e).toUint8Array()))}async createCollection(t,e,n,i,s=ta,o){const r=this.transactionBuilder.buildTransactionPayload("0x3::token::create_collection_script",[],[e,n,i,s,[!1,!1,!1]]);return this.aptosClient.generateSignSubmitTransaction(t,r,o)}async createToken(t,e,n,i,s,o,r=ta,a=t.address(),c=0,u=0,l=[],d=[],p=[],g){const b=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[e,n,i,s,r,o,a,c,u,[!1,!1,!1,!1,!1],l,q6(d,p),p]);return this.aptosClient.generateSignSubmitTransaction(t,b,g)}async createTokenWithMutabilityConfig(t,e,n,i,s,o,r=ta,a=t.address(),c=0,u=0,l=[],d=[],p=[],g=[!1,!1,!1,!1,!1],b){const w=this.transactionBuilder.buildTransactionPayload("0x3::token::create_token_script",[],[e,n,i,s,r,o,a,c,u,g,l,d,p]);return this.aptosClient.generateSignSubmitTransaction(t,w,b)}async offerToken(t,e,n,i,s,o,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::offer_script",[],[e,n,i,s,r,o]);return this.aptosClient.generateSignSubmitTransaction(t,c,a)}async claimToken(t,e,n,i,s,o=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::claim_script",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async cancelTokenOffer(t,e,n,i,s,o=0,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token_transfers::cancel_offer_script",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async directTransferToken(t,e,n,i,s,o,r=0,a){const c=this.transactionBuilder.buildTransactionPayload("0x3::token::direct_transfer_script",[],[n,i,s,r,o]),u=await this.aptosClient.generateRawTransaction(t.address(),c,a),l=new D.MultiAgentRawTransaction(u,[D.AccountAddress.fromHex(e.address())]),d=new D.Ed25519Signature(t.signBuffer(Tr.getSigningMessage(l)).toUint8Array()),p=new D.AccountAuthenticatorEd25519(new D.Ed25519PublicKey(t.signingKey.publicKey),d),g=new D.Ed25519Signature(e.signBuffer(Tr.getSigningMessage(l)).toUint8Array()),b=new D.AccountAuthenticatorEd25519(new D.Ed25519PublicKey(e.signingKey.publicKey),g),w=new D.TransactionAuthenticatorMultiAgent(p,[D.AccountAddress.fromHex(e.address())],[b]),T=es(new D.SignedTransaction(u,w));return(await this.aptosClient.submitSignedBCSTransaction(T)).hash}async optInTokenTransfer(t,e,n){const i=this.transactionBuilder.buildTransactionPayload("0x3::token::opt_in_direct_transfer",[],[e]);return this.aptosClient.generateSignSubmitTransaction(t,i,n)}async transferWithOptIn(t,e,n,i,s,o,r,a){const c=new qa(new Ua(new et(M6).toUint8Array(),[],[new yr(D.AccountAddress.fromHex(e)),new wr(new TextEncoder().encode(n)),new wr(new TextEncoder().encode(i)),new _r(BigInt(s)),new yr(D.AccountAddress.fromHex(o)),new _r(BigInt(r))]));return this.aptosClient.generateSignSubmitTransaction(t,c,a)}async burnByCreator(t,e,n,i,s,o,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn_by_creator",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async burnByOwner(t,e,n,i,s,o,r){const a=this.transactionBuilder.buildTransactionPayload("0x3::token::burn",[],[e,n,i,s,o]);return this.aptosClient.generateSignSubmitTransaction(t,a,r)}async mutateTokenProperties(t,e,n,i,s,o,r,a,c,u,l){const d=this.transactionBuilder.buildTransactionPayload("0x3::token::mutate_token_properties",[],[e,n,i,s,o,r,a,c,u]);return this.aptosClient.generateSignSubmitTransaction(t,d,l)}async getCollectionData(t,e){const i=(await this.aptosClient.getAccountResources(t)).find(a=>a.type==="0x3::token::Collections"),{handle:s}=i.data.collection_data,o={key_type:"0x1::string::String",value_type:"0x3::token::CollectionData",key:e};return await this.aptosClient.getTableItem(s,o)}async getTokenData(t,e,n){const i=t instanceof et?t.hex():t,s=await this.aptosClient.getAccountResource(i,"0x3::token::Collections"),{handle:o}=s.data.token_data,a={key_type:"0x3::token::TokenDataId",value_type:"0x3::token::TokenData",key:{creator:i,collection:e,name:n}},c=await this.aptosClient.getTableItem(o,a);return new Cy(c.collection,c.description,c.name,c.maximum,c.supply,c.uri,c.default_properties,c.mutability_config)}async getToken(t,e,n,i="0"){const s={creator:t instanceof et?t.hex():t,collection:e,name:n};return this.getTokenForAccount(t,{token_data_id:s,property_version:i})}async getTokenForAccount(t,e){const n=await this.aptosClient.getAccountResource(t instanceof et?t.hex():t,"0x3::token::TokenStore"),{handle:i}=n.data.tokens,s={key_type:"0x3::token::TokenId",value_type:"0x3::token::Token",key:e};try{const o=await this.aptosClient.getTableItem(i,s);return new By(o.id,o.amount,o.token_properties)}catch(o){return(o==null?void 0:o.status)===404?{id:e,amount:"0",token_properties:new ap}:o}}},y={},F6={get exports(){return y},set exports(t){y=t}};(function(t){(function(e,n){function i(v,h){if(!v)throw new Error(h||"Assertion failed")}function s(v,h){v.super_=h;var _=function(){};_.prototype=h.prototype,v.prototype=new _,v.prototype.constructor=v}function o(v,h,_){if(o.isBN(v))return v;this.negative=0,this.words=null,this.length=0,this.red=null,v!==null&&((h==="le"||h==="be")&&(_=h,h=10),this._init(v||0,h||10,_||"be"))}typeof e=="object"?e.exports=o:n.BN=o,o.BN=o,o.wordSize=26;var r;try{typeof window<"u"&&typeof window.Buffer<"u"?r=window.Buffer:r=Mb.Buffer}catch{}o.isBN=function(h){return h instanceof o?!0:h!==null&&typeof h=="object"&&h.constructor.wordSize===o.wordSize&&Array.isArray(h.words)},o.max=function(h,_){return h.cmp(_)>0?h:_},o.min=function(h,_){return h.cmp(_)<0?h:_},o.prototype._init=function(h,_,A){if(typeof h=="number")return this._initNumber(h,_,A);if(typeof h=="object")return this._initArray(h,_,A);_==="hex"&&(_=16),i(_===(_|0)&&_>=2&&_<=36),h=h.toString().replace(/\s+/g,"");var C=0;h[0]==="-"&&(C++,this.negative=1),C<h.length&&(_===16?this._parseHex(h,C,A):(this._parseBase(h,_,C),A==="le"&&this._initArray(this.toArray(),_,A)))},o.prototype._initNumber=function(h,_,A){h<0&&(this.negative=1,h=-h),h<67108864?(this.words=[h&67108863],this.length=1):h<4503599627370496?(this.words=[h&67108863,h/67108864&67108863],this.length=2):(i(h<9007199254740992),this.words=[h&67108863,h/67108864&67108863,1],this.length=3),A==="le"&&this._initArray(this.toArray(),_,A)},o.prototype._initArray=function(h,_,A){if(i(typeof h.length=="number"),h.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(h.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var M,N,F=0;if(A==="be")for(C=h.length-1,M=0;C>=0;C-=3)N=h[C]|h[C-1]<<8|h[C-2]<<16,this.words[M]|=N<<F&67108863,this.words[M+1]=N>>>26-F&67108863,F+=24,F>=26&&(F-=26,M++);else if(A==="le")for(C=0,M=0;C<h.length;C+=3)N=h[C]|h[C+1]<<8|h[C+2]<<16,this.words[M]|=N<<F&67108863,this.words[M+1]=N>>>26-F&67108863,F+=24,F>=26&&(F-=26,M++);return this._strip()};function a(v,h){var _=v.charCodeAt(h);if(_>=48&&_<=57)return _-48;if(_>=65&&_<=70)return _-55;if(_>=97&&_<=102)return _-87;i(!1,"Invalid character in "+v)}function c(v,h,_){var A=a(v,_);return _-1>=h&&(A|=a(v,_-1)<<4),A}o.prototype._parseHex=function(h,_,A){this.length=Math.ceil((h.length-_)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var M=0,N=0,F;if(A==="be")for(C=h.length-1;C>=_;C-=2)F=c(h,_,C)<<M,this.words[N]|=F&67108863,M>=18?(M-=18,N+=1,this.words[N]|=F>>>26):M+=8;else{var x=h.length-_;for(C=x%2===0?_+1:_;C<h.length;C+=2)F=c(h,_,C)<<M,this.words[N]|=F&67108863,M>=18?(M-=18,N+=1,this.words[N]|=F>>>26):M+=8}this._strip()};function u(v,h,_,A){for(var C=0,M=0,N=Math.min(v.length,_),F=h;F<N;F++){var x=v.charCodeAt(F)-48;C*=A,x>=49?M=x-49+10:x>=17?M=x-17+10:M=x,i(x>=0&&M<A,"Invalid character"),C+=M}return C}o.prototype._parseBase=function(h,_,A){this.words=[0],this.length=1;for(var C=0,M=1;M<=67108863;M*=_)C++;C--,M=M/_|0;for(var N=h.length-A,F=N%C,x=Math.min(N,N-F)+A,m=0,R=A;R<x;R+=C)m=u(h,R,R+C,_),this.imuln(M),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m);if(F!==0){var ye=1;for(m=u(h,R,h.length,_),R=0;R<F;R++)ye*=_;this.imuln(ye),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m)}this._strip()},o.prototype.copy=function(h){h.words=new Array(this.length);for(var _=0;_<this.length;_++)h.words[_]=this.words[_];h.length=this.length,h.negative=this.negative,h.red=this.red};function l(v,h){v.words=h.words,v.length=h.length,v.negative=h.negative,v.red=h.red}if(o.prototype._move=function(h){l(h,this)},o.prototype.clone=function(){var h=new o(null);return this.copy(h),h},o.prototype._expand=function(h){for(;this.length<h;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},o.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch{o.prototype.inspect=d}else o.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(h,_){h=h||10,_=_|0||1;var A;if(h===16||h==="hex"){A="";for(var C=0,M=0,N=0;N<this.length;N++){var F=this.words[N],x=((F<<C|M)&16777215).toString(16);M=F>>>24-C&16777215,C+=2,C>=26&&(C-=26,N--),M!==0||N!==this.length-1?A=p[6-x.length]+x+A:A=x+A}for(M!==0&&(A=M.toString(16)+A);A.length%_!==0;)A="0"+A;return this.negative!==0&&(A="-"+A),A}if(h===(h|0)&&h>=2&&h<=36){var m=g[h],R=b[h];A="";var ye=this.clone();for(ye.negative=0;!ye.isZero();){var ce=ye.modrn(R).toString(h);ye=ye.idivn(R),ye.isZero()?A=ce+A:A=p[m-ce.length]+ce+A}for(this.isZero()&&(A="0"+A);A.length%_!==0;)A="0"+A;return this.negative!==0&&(A="-"+A),A}i(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var h=this.words[0];return this.length===2?h+=this.words[1]*67108864:this.length===3&&this.words[2]===1?h+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-h:h},o.prototype.toJSON=function(){return this.toString(16,2)},r&&(o.prototype.toBuffer=function(h,_){return this.toArrayLike(r,h,_)}),o.prototype.toArray=function(h,_){return this.toArrayLike(Array,h,_)};var w=function(h,_){return h.allocUnsafe?h.allocUnsafe(_):new h(_)};o.prototype.toArrayLike=function(h,_,A){this._strip();var C=this.byteLength(),M=A||Math.max(1,C);i(C<=M,"byte array longer than desired length"),i(M>0,"Requested array length <= 0");var N=w(h,M),F=_==="le"?"LE":"BE";return this["_toArrayLike"+F](N,C),N},o.prototype._toArrayLikeLE=function(h,_){for(var A=0,C=0,M=0,N=0;M<this.length;M++){var F=this.words[M]<<N|C;h[A++]=F&255,A<h.length&&(h[A++]=F>>8&255),A<h.length&&(h[A++]=F>>16&255),N===6?(A<h.length&&(h[A++]=F>>24&255),C=0,N=0):(C=F>>>24,N+=2)}if(A<h.length)for(h[A++]=C;A<h.length;)h[A++]=0},o.prototype._toArrayLikeBE=function(h,_){for(var A=h.length-1,C=0,M=0,N=0;M<this.length;M++){var F=this.words[M]<<N|C;h[A--]=F&255,A>=0&&(h[A--]=F>>8&255),A>=0&&(h[A--]=F>>16&255),N===6?(A>=0&&(h[A--]=F>>24&255),C=0,N=0):(C=F>>>24,N+=2)}if(A>=0)for(h[A--]=C;A>=0;)h[A--]=0},Math.clz32?o.prototype._countBits=function(h){return 32-Math.clz32(h)}:o.prototype._countBits=function(h){var _=h,A=0;return _>=4096&&(A+=13,_>>>=13),_>=64&&(A+=7,_>>>=7),_>=8&&(A+=4,_>>>=4),_>=2&&(A+=2,_>>>=2),A+_},o.prototype._zeroBits=function(h){if(h===0)return 26;var _=h,A=0;return _&8191||(A+=13,_>>>=13),_&127||(A+=7,_>>>=7),_&15||(A+=4,_>>>=4),_&3||(A+=2,_>>>=2),_&1||A++,A},o.prototype.bitLength=function(){var h=this.words[this.length-1],_=this._countBits(h);return(this.length-1)*26+_};function T(v){for(var h=new Array(v.bitLength()),_=0;_<h.length;_++){var A=_/26|0,C=_%26;h[_]=v.words[A]>>>C&1}return h}o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var h=0,_=0;_<this.length;_++){var A=this._zeroBits(this.words[_]);if(h+=A,A!==26)break}return h},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(h){return this.negative!==0?this.abs().inotn(h).iaddn(1):this.clone()},o.prototype.fromTwos=function(h){return this.testn(h-1)?this.notn(h).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return this.negative!==0},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(h){for(;this.length<h.length;)this.words[this.length++]=0;for(var _=0;_<h.length;_++)this.words[_]=this.words[_]|h.words[_];return this._strip()},o.prototype.ior=function(h){return i((this.negative|h.negative)===0),this.iuor(h)},o.prototype.or=function(h){return this.length>h.length?this.clone().ior(h):h.clone().ior(this)},o.prototype.uor=function(h){return this.length>h.length?this.clone().iuor(h):h.clone().iuor(this)},o.prototype.iuand=function(h){var _;this.length>h.length?_=h:_=this;for(var A=0;A<_.length;A++)this.words[A]=this.words[A]&h.words[A];return this.length=_.length,this._strip()},o.prototype.iand=function(h){return i((this.negative|h.negative)===0),this.iuand(h)},o.prototype.and=function(h){return this.length>h.length?this.clone().iand(h):h.clone().iand(this)},o.prototype.uand=function(h){return this.length>h.length?this.clone().iuand(h):h.clone().iuand(this)},o.prototype.iuxor=function(h){var _,A;this.length>h.length?(_=this,A=h):(_=h,A=this);for(var C=0;C<A.length;C++)this.words[C]=_.words[C]^A.words[C];if(this!==_)for(;C<_.length;C++)this.words[C]=_.words[C];return this.length=_.length,this._strip()},o.prototype.ixor=function(h){return i((this.negative|h.negative)===0),this.iuxor(h)},o.prototype.xor=function(h){return this.length>h.length?this.clone().ixor(h):h.clone().ixor(this)},o.prototype.uxor=function(h){return this.length>h.length?this.clone().iuxor(h):h.clone().iuxor(this)},o.prototype.inotn=function(h){i(typeof h=="number"&&h>=0);var _=Math.ceil(h/26)|0,A=h%26;this._expand(_),A>0&&_--;for(var C=0;C<_;C++)this.words[C]=~this.words[C]&67108863;return A>0&&(this.words[C]=~this.words[C]&67108863>>26-A),this._strip()},o.prototype.notn=function(h){return this.clone().inotn(h)},o.prototype.setn=function(h,_){i(typeof h=="number"&&h>=0);var A=h/26|0,C=h%26;return this._expand(A+1),_?this.words[A]=this.words[A]|1<<C:this.words[A]=this.words[A]&~(1<<C),this._strip()},o.prototype.iadd=function(h){var _;if(this.negative!==0&&h.negative===0)return this.negative=0,_=this.isub(h),this.negative^=1,this._normSign();if(this.negative===0&&h.negative!==0)return h.negative=0,_=this.isub(h),h.negative=1,_._normSign();var A,C;this.length>h.length?(A=this,C=h):(A=h,C=this);for(var M=0,N=0;N<C.length;N++)_=(A.words[N]|0)+(C.words[N]|0)+M,this.words[N]=_&67108863,M=_>>>26;for(;M!==0&&N<A.length;N++)_=(A.words[N]|0)+M,this.words[N]=_&67108863,M=_>>>26;if(this.length=A.length,M!==0)this.words[this.length]=M,this.length++;else if(A!==this)for(;N<A.length;N++)this.words[N]=A.words[N];return this},o.prototype.add=function(h){var _;return h.negative!==0&&this.negative===0?(h.negative=0,_=this.sub(h),h.negative^=1,_):h.negative===0&&this.negative!==0?(this.negative=0,_=h.sub(this),this.negative=1,_):this.length>h.length?this.clone().iadd(h):h.clone().iadd(this)},o.prototype.isub=function(h){if(h.negative!==0){h.negative=0;var _=this.iadd(h);return h.negative=1,_._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(h),this.negative=1,this._normSign();var A=this.cmp(h);if(A===0)return this.negative=0,this.length=1,this.words[0]=0,this;var C,M;A>0?(C=this,M=h):(C=h,M=this);for(var N=0,F=0;F<M.length;F++)_=(C.words[F]|0)-(M.words[F]|0)+N,N=_>>26,this.words[F]=_&67108863;for(;N!==0&&F<C.length;F++)_=(C.words[F]|0)+N,N=_>>26,this.words[F]=_&67108863;if(N===0&&F<C.length&&C!==this)for(;F<C.length;F++)this.words[F]=C.words[F];return this.length=Math.max(this.length,F),C!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(h){return this.clone().isub(h)};function E(v,h,_){_.negative=h.negative^v.negative;var A=v.length+h.length|0;_.length=A,A=A-1|0;var C=v.words[0]|0,M=h.words[0]|0,N=C*M,F=N&67108863,x=N/67108864|0;_.words[0]=F;for(var m=1;m<A;m++){for(var R=x>>>26,ye=x&67108863,ce=Math.min(m,h.length-1),ue=Math.max(0,m-v.length+1);ue<=ce;ue++){var Ne=m-ue|0;C=v.words[Ne]|0,M=h.words[ue]|0,N=C*M+ye,R+=N/67108864|0,ye=N&67108863}_.words[m]=ye|0,x=R|0}return x!==0?_.words[m]=x|0:_.length--,_._strip()}var P=function(h,_,A){var C=h.words,M=_.words,N=A.words,F=0,x,m,R,ye=C[0]|0,ce=ye&8191,ue=ye>>>13,Ne=C[1]|0,Le=Ne&8191,st=Ne>>>13,We=C[2]|0,$e=We&8191,nt=We>>>13,Xn=C[3]|0,Y=Xn&8191,oe=Xn>>>13,we=C[4]|0,de=we&8191,Ae=we>>>13,He=C[5]|0,Be=He&8191,Me=He>>>13,q=C[6]|0,j=q&8191,K=q>>>13,J=C[7]|0,Q=J&8191,ne=J>>>13,pe=C[8]|0,ee=pe&8191,me=pe>>>13,ve=C[9]|0,se=ve&8191,_e=ve>>>13,Fe=M[0]|0,Oe=Fe&8191,De=Fe>>>13,it=M[1]|0,Ie=it&8191,ht=it>>>13,Pt=M[2]|0,Ve=Pt&8191,gt=Pt>>>13,Bn=M[3]|0,ft=Bn&8191,dt=Bn>>>13,Jn=M[4]|0,ct=Jn&8191,Dt=Jn>>>13,Hp=M[5]|0,jt=Hp&8191,Ft=Hp>>>13,Kp=M[6]|0,zt=Kp&8191,Ht=Kp>>>13,Gp=M[7]|0,Kt=Gp&8191,Gt=Gp>>>13,Wp=M[8]|0,Wt=Wp&8191,Vt=Wp>>>13,Vp=M[9]|0,Xt=Vp&8191,Jt=Vp>>>13;A.negative=h.negative^_.negative,A.length=19,x=Math.imul(ce,Oe),m=Math.imul(ce,De),m=m+Math.imul(ue,Oe)|0,R=Math.imul(ue,De);var Tl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Tl>>>26)|0,Tl&=67108863,x=Math.imul(Le,Oe),m=Math.imul(Le,De),m=m+Math.imul(st,Oe)|0,R=Math.imul(st,De),x=x+Math.imul(ce,Ie)|0,m=m+Math.imul(ce,ht)|0,m=m+Math.imul(ue,Ie)|0,R=R+Math.imul(ue,ht)|0;var Al=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Al>>>26)|0,Al&=67108863,x=Math.imul($e,Oe),m=Math.imul($e,De),m=m+Math.imul(nt,Oe)|0,R=Math.imul(nt,De),x=x+Math.imul(Le,Ie)|0,m=m+Math.imul(Le,ht)|0,m=m+Math.imul(st,Ie)|0,R=R+Math.imul(st,ht)|0,x=x+Math.imul(ce,Ve)|0,m=m+Math.imul(ce,gt)|0,m=m+Math.imul(ue,Ve)|0,R=R+Math.imul(ue,gt)|0;var kl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(kl>>>26)|0,kl&=67108863,x=Math.imul(Y,Oe),m=Math.imul(Y,De),m=m+Math.imul(oe,Oe)|0,R=Math.imul(oe,De),x=x+Math.imul($e,Ie)|0,m=m+Math.imul($e,ht)|0,m=m+Math.imul(nt,Ie)|0,R=R+Math.imul(nt,ht)|0,x=x+Math.imul(Le,Ve)|0,m=m+Math.imul(Le,gt)|0,m=m+Math.imul(st,Ve)|0,R=R+Math.imul(st,gt)|0,x=x+Math.imul(ce,ft)|0,m=m+Math.imul(ce,dt)|0,m=m+Math.imul(ue,ft)|0,R=R+Math.imul(ue,dt)|0;var Sl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Sl>>>26)|0,Sl&=67108863,x=Math.imul(de,Oe),m=Math.imul(de,De),m=m+Math.imul(Ae,Oe)|0,R=Math.imul(Ae,De),x=x+Math.imul(Y,Ie)|0,m=m+Math.imul(Y,ht)|0,m=m+Math.imul(oe,Ie)|0,R=R+Math.imul(oe,ht)|0,x=x+Math.imul($e,Ve)|0,m=m+Math.imul($e,gt)|0,m=m+Math.imul(nt,Ve)|0,R=R+Math.imul(nt,gt)|0,x=x+Math.imul(Le,ft)|0,m=m+Math.imul(Le,dt)|0,m=m+Math.imul(st,ft)|0,R=R+Math.imul(st,dt)|0,x=x+Math.imul(ce,ct)|0,m=m+Math.imul(ce,Dt)|0,m=m+Math.imul(ue,ct)|0,R=R+Math.imul(ue,Dt)|0;var xl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(xl>>>26)|0,xl&=67108863,x=Math.imul(Be,Oe),m=Math.imul(Be,De),m=m+Math.imul(Me,Oe)|0,R=Math.imul(Me,De),x=x+Math.imul(de,Ie)|0,m=m+Math.imul(de,ht)|0,m=m+Math.imul(Ae,Ie)|0,R=R+Math.imul(Ae,ht)|0,x=x+Math.imul(Y,Ve)|0,m=m+Math.imul(Y,gt)|0,m=m+Math.imul(oe,Ve)|0,R=R+Math.imul(oe,gt)|0,x=x+Math.imul($e,ft)|0,m=m+Math.imul($e,dt)|0,m=m+Math.imul(nt,ft)|0,R=R+Math.imul(nt,dt)|0,x=x+Math.imul(Le,ct)|0,m=m+Math.imul(Le,Dt)|0,m=m+Math.imul(st,ct)|0,R=R+Math.imul(st,Dt)|0,x=x+Math.imul(ce,jt)|0,m=m+Math.imul(ce,Ft)|0,m=m+Math.imul(ue,jt)|0,R=R+Math.imul(ue,Ft)|0;var Pl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Pl>>>26)|0,Pl&=67108863,x=Math.imul(j,Oe),m=Math.imul(j,De),m=m+Math.imul(K,Oe)|0,R=Math.imul(K,De),x=x+Math.imul(Be,Ie)|0,m=m+Math.imul(Be,ht)|0,m=m+Math.imul(Me,Ie)|0,R=R+Math.imul(Me,ht)|0,x=x+Math.imul(de,Ve)|0,m=m+Math.imul(de,gt)|0,m=m+Math.imul(Ae,Ve)|0,R=R+Math.imul(Ae,gt)|0,x=x+Math.imul(Y,ft)|0,m=m+Math.imul(Y,dt)|0,m=m+Math.imul(oe,ft)|0,R=R+Math.imul(oe,dt)|0,x=x+Math.imul($e,ct)|0,m=m+Math.imul($e,Dt)|0,m=m+Math.imul(nt,ct)|0,R=R+Math.imul(nt,Dt)|0,x=x+Math.imul(Le,jt)|0,m=m+Math.imul(Le,Ft)|0,m=m+Math.imul(st,jt)|0,R=R+Math.imul(st,Ft)|0,x=x+Math.imul(ce,zt)|0,m=m+Math.imul(ce,Ht)|0,m=m+Math.imul(ue,zt)|0,R=R+Math.imul(ue,Ht)|0;var El=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(El>>>26)|0,El&=67108863,x=Math.imul(Q,Oe),m=Math.imul(Q,De),m=m+Math.imul(ne,Oe)|0,R=Math.imul(ne,De),x=x+Math.imul(j,Ie)|0,m=m+Math.imul(j,ht)|0,m=m+Math.imul(K,Ie)|0,R=R+Math.imul(K,ht)|0,x=x+Math.imul(Be,Ve)|0,m=m+Math.imul(Be,gt)|0,m=m+Math.imul(Me,Ve)|0,R=R+Math.imul(Me,gt)|0,x=x+Math.imul(de,ft)|0,m=m+Math.imul(de,dt)|0,m=m+Math.imul(Ae,ft)|0,R=R+Math.imul(Ae,dt)|0,x=x+Math.imul(Y,ct)|0,m=m+Math.imul(Y,Dt)|0,m=m+Math.imul(oe,ct)|0,R=R+Math.imul(oe,Dt)|0,x=x+Math.imul($e,jt)|0,m=m+Math.imul($e,Ft)|0,m=m+Math.imul(nt,jt)|0,R=R+Math.imul(nt,Ft)|0,x=x+Math.imul(Le,zt)|0,m=m+Math.imul(Le,Ht)|0,m=m+Math.imul(st,zt)|0,R=R+Math.imul(st,Ht)|0,x=x+Math.imul(ce,Kt)|0,m=m+Math.imul(ce,Gt)|0,m=m+Math.imul(ue,Kt)|0,R=R+Math.imul(ue,Gt)|0;var Cl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Cl>>>26)|0,Cl&=67108863,x=Math.imul(ee,Oe),m=Math.imul(ee,De),m=m+Math.imul(me,Oe)|0,R=Math.imul(me,De),x=x+Math.imul(Q,Ie)|0,m=m+Math.imul(Q,ht)|0,m=m+Math.imul(ne,Ie)|0,R=R+Math.imul(ne,ht)|0,x=x+Math.imul(j,Ve)|0,m=m+Math.imul(j,gt)|0,m=m+Math.imul(K,Ve)|0,R=R+Math.imul(K,gt)|0,x=x+Math.imul(Be,ft)|0,m=m+Math.imul(Be,dt)|0,m=m+Math.imul(Me,ft)|0,R=R+Math.imul(Me,dt)|0,x=x+Math.imul(de,ct)|0,m=m+Math.imul(de,Dt)|0,m=m+Math.imul(Ae,ct)|0,R=R+Math.imul(Ae,Dt)|0,x=x+Math.imul(Y,jt)|0,m=m+Math.imul(Y,Ft)|0,m=m+Math.imul(oe,jt)|0,R=R+Math.imul(oe,Ft)|0,x=x+Math.imul($e,zt)|0,m=m+Math.imul($e,Ht)|0,m=m+Math.imul(nt,zt)|0,R=R+Math.imul(nt,Ht)|0,x=x+Math.imul(Le,Kt)|0,m=m+Math.imul(Le,Gt)|0,m=m+Math.imul(st,Kt)|0,R=R+Math.imul(st,Gt)|0,x=x+Math.imul(ce,Wt)|0,m=m+Math.imul(ce,Vt)|0,m=m+Math.imul(ue,Wt)|0,R=R+Math.imul(ue,Vt)|0;var Bl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Bl>>>26)|0,Bl&=67108863,x=Math.imul(se,Oe),m=Math.imul(se,De),m=m+Math.imul(_e,Oe)|0,R=Math.imul(_e,De),x=x+Math.imul(ee,Ie)|0,m=m+Math.imul(ee,ht)|0,m=m+Math.imul(me,Ie)|0,R=R+Math.imul(me,ht)|0,x=x+Math.imul(Q,Ve)|0,m=m+Math.imul(Q,gt)|0,m=m+Math.imul(ne,Ve)|0,R=R+Math.imul(ne,gt)|0,x=x+Math.imul(j,ft)|0,m=m+Math.imul(j,dt)|0,m=m+Math.imul(K,ft)|0,R=R+Math.imul(K,dt)|0,x=x+Math.imul(Be,ct)|0,m=m+Math.imul(Be,Dt)|0,m=m+Math.imul(Me,ct)|0,R=R+Math.imul(Me,Dt)|0,x=x+Math.imul(de,jt)|0,m=m+Math.imul(de,Ft)|0,m=m+Math.imul(Ae,jt)|0,R=R+Math.imul(Ae,Ft)|0,x=x+Math.imul(Y,zt)|0,m=m+Math.imul(Y,Ht)|0,m=m+Math.imul(oe,zt)|0,R=R+Math.imul(oe,Ht)|0,x=x+Math.imul($e,Kt)|0,m=m+Math.imul($e,Gt)|0,m=m+Math.imul(nt,Kt)|0,R=R+Math.imul(nt,Gt)|0,x=x+Math.imul(Le,Wt)|0,m=m+Math.imul(Le,Vt)|0,m=m+Math.imul(st,Wt)|0,R=R+Math.imul(st,Vt)|0,x=x+Math.imul(ce,Xt)|0,m=m+Math.imul(ce,Jt)|0,m=m+Math.imul(ue,Xt)|0,R=R+Math.imul(ue,Jt)|0;var Il=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Il>>>26)|0,Il&=67108863,x=Math.imul(se,Ie),m=Math.imul(se,ht),m=m+Math.imul(_e,Ie)|0,R=Math.imul(_e,ht),x=x+Math.imul(ee,Ve)|0,m=m+Math.imul(ee,gt)|0,m=m+Math.imul(me,Ve)|0,R=R+Math.imul(me,gt)|0,x=x+Math.imul(Q,ft)|0,m=m+Math.imul(Q,dt)|0,m=m+Math.imul(ne,ft)|0,R=R+Math.imul(ne,dt)|0,x=x+Math.imul(j,ct)|0,m=m+Math.imul(j,Dt)|0,m=m+Math.imul(K,ct)|0,R=R+Math.imul(K,Dt)|0,x=x+Math.imul(Be,jt)|0,m=m+Math.imul(Be,Ft)|0,m=m+Math.imul(Me,jt)|0,R=R+Math.imul(Me,Ft)|0,x=x+Math.imul(de,zt)|0,m=m+Math.imul(de,Ht)|0,m=m+Math.imul(Ae,zt)|0,R=R+Math.imul(Ae,Ht)|0,x=x+Math.imul(Y,Kt)|0,m=m+Math.imul(Y,Gt)|0,m=m+Math.imul(oe,Kt)|0,R=R+Math.imul(oe,Gt)|0,x=x+Math.imul($e,Wt)|0,m=m+Math.imul($e,Vt)|0,m=m+Math.imul(nt,Wt)|0,R=R+Math.imul(nt,Vt)|0,x=x+Math.imul(Le,Xt)|0,m=m+Math.imul(Le,Jt)|0,m=m+Math.imul(st,Xt)|0,R=R+Math.imul(st,Jt)|0;var Ol=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Ol>>>26)|0,Ol&=67108863,x=Math.imul(se,Ve),m=Math.imul(se,gt),m=m+Math.imul(_e,Ve)|0,R=Math.imul(_e,gt),x=x+Math.imul(ee,ft)|0,m=m+Math.imul(ee,dt)|0,m=m+Math.imul(me,ft)|0,R=R+Math.imul(me,dt)|0,x=x+Math.imul(Q,ct)|0,m=m+Math.imul(Q,Dt)|0,m=m+Math.imul(ne,ct)|0,R=R+Math.imul(ne,Dt)|0,x=x+Math.imul(j,jt)|0,m=m+Math.imul(j,Ft)|0,m=m+Math.imul(K,jt)|0,R=R+Math.imul(K,Ft)|0,x=x+Math.imul(Be,zt)|0,m=m+Math.imul(Be,Ht)|0,m=m+Math.imul(Me,zt)|0,R=R+Math.imul(Me,Ht)|0,x=x+Math.imul(de,Kt)|0,m=m+Math.imul(de,Gt)|0,m=m+Math.imul(Ae,Kt)|0,R=R+Math.imul(Ae,Gt)|0,x=x+Math.imul(Y,Wt)|0,m=m+Math.imul(Y,Vt)|0,m=m+Math.imul(oe,Wt)|0,R=R+Math.imul(oe,Vt)|0,x=x+Math.imul($e,Xt)|0,m=m+Math.imul($e,Jt)|0,m=m+Math.imul(nt,Xt)|0,R=R+Math.imul(nt,Jt)|0;var Rl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Rl>>>26)|0,Rl&=67108863,x=Math.imul(se,ft),m=Math.imul(se,dt),m=m+Math.imul(_e,ft)|0,R=Math.imul(_e,dt),x=x+Math.imul(ee,ct)|0,m=m+Math.imul(ee,Dt)|0,m=m+Math.imul(me,ct)|0,R=R+Math.imul(me,Dt)|0,x=x+Math.imul(Q,jt)|0,m=m+Math.imul(Q,Ft)|0,m=m+Math.imul(ne,jt)|0,R=R+Math.imul(ne,Ft)|0,x=x+Math.imul(j,zt)|0,m=m+Math.imul(j,Ht)|0,m=m+Math.imul(K,zt)|0,R=R+Math.imul(K,Ht)|0,x=x+Math.imul(Be,Kt)|0,m=m+Math.imul(Be,Gt)|0,m=m+Math.imul(Me,Kt)|0,R=R+Math.imul(Me,Gt)|0,x=x+Math.imul(de,Wt)|0,m=m+Math.imul(de,Vt)|0,m=m+Math.imul(Ae,Wt)|0,R=R+Math.imul(Ae,Vt)|0,x=x+Math.imul(Y,Xt)|0,m=m+Math.imul(Y,Jt)|0,m=m+Math.imul(oe,Xt)|0,R=R+Math.imul(oe,Jt)|0;var $l=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+($l>>>26)|0,$l&=67108863,x=Math.imul(se,ct),m=Math.imul(se,Dt),m=m+Math.imul(_e,ct)|0,R=Math.imul(_e,Dt),x=x+Math.imul(ee,jt)|0,m=m+Math.imul(ee,Ft)|0,m=m+Math.imul(me,jt)|0,R=R+Math.imul(me,Ft)|0,x=x+Math.imul(Q,zt)|0,m=m+Math.imul(Q,Ht)|0,m=m+Math.imul(ne,zt)|0,R=R+Math.imul(ne,Ht)|0,x=x+Math.imul(j,Kt)|0,m=m+Math.imul(j,Gt)|0,m=m+Math.imul(K,Kt)|0,R=R+Math.imul(K,Gt)|0,x=x+Math.imul(Be,Wt)|0,m=m+Math.imul(Be,Vt)|0,m=m+Math.imul(Me,Wt)|0,R=R+Math.imul(Me,Vt)|0,x=x+Math.imul(de,Xt)|0,m=m+Math.imul(de,Jt)|0,m=m+Math.imul(Ae,Xt)|0,R=R+Math.imul(Ae,Jt)|0;var Ul=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Ul>>>26)|0,Ul&=67108863,x=Math.imul(se,jt),m=Math.imul(se,Ft),m=m+Math.imul(_e,jt)|0,R=Math.imul(_e,Ft),x=x+Math.imul(ee,zt)|0,m=m+Math.imul(ee,Ht)|0,m=m+Math.imul(me,zt)|0,R=R+Math.imul(me,Ht)|0,x=x+Math.imul(Q,Kt)|0,m=m+Math.imul(Q,Gt)|0,m=m+Math.imul(ne,Kt)|0,R=R+Math.imul(ne,Gt)|0,x=x+Math.imul(j,Wt)|0,m=m+Math.imul(j,Vt)|0,m=m+Math.imul(K,Wt)|0,R=R+Math.imul(K,Vt)|0,x=x+Math.imul(Be,Xt)|0,m=m+Math.imul(Be,Jt)|0,m=m+Math.imul(Me,Xt)|0,R=R+Math.imul(Me,Jt)|0;var Ml=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Ml>>>26)|0,Ml&=67108863,x=Math.imul(se,zt),m=Math.imul(se,Ht),m=m+Math.imul(_e,zt)|0,R=Math.imul(_e,Ht),x=x+Math.imul(ee,Kt)|0,m=m+Math.imul(ee,Gt)|0,m=m+Math.imul(me,Kt)|0,R=R+Math.imul(me,Gt)|0,x=x+Math.imul(Q,Wt)|0,m=m+Math.imul(Q,Vt)|0,m=m+Math.imul(ne,Wt)|0,R=R+Math.imul(ne,Vt)|0,x=x+Math.imul(j,Xt)|0,m=m+Math.imul(j,Jt)|0,m=m+Math.imul(K,Xt)|0,R=R+Math.imul(K,Jt)|0;var Dl=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Dl>>>26)|0,Dl&=67108863,x=Math.imul(se,Kt),m=Math.imul(se,Gt),m=m+Math.imul(_e,Kt)|0,R=Math.imul(_e,Gt),x=x+Math.imul(ee,Wt)|0,m=m+Math.imul(ee,Vt)|0,m=m+Math.imul(me,Wt)|0,R=R+Math.imul(me,Vt)|0,x=x+Math.imul(Q,Xt)|0,m=m+Math.imul(Q,Jt)|0,m=m+Math.imul(ne,Xt)|0,R=R+Math.imul(ne,Jt)|0;var ql=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(ql>>>26)|0,ql&=67108863,x=Math.imul(se,Wt),m=Math.imul(se,Vt),m=m+Math.imul(_e,Wt)|0,R=Math.imul(_e,Vt),x=x+Math.imul(ee,Xt)|0,m=m+Math.imul(ee,Jt)|0,m=m+Math.imul(me,Xt)|0,R=R+Math.imul(me,Jt)|0;var Ll=(F+x|0)+((m&8191)<<13)|0;F=(R+(m>>>13)|0)+(Ll>>>26)|0,Ll&=67108863,x=Math.imul(se,Xt),m=Math.imul(se,Jt),m=m+Math.imul(_e,Xt)|0,R=Math.imul(_e,Jt);var Nl=(F+x|0)+((m&8191)<<13)|0;return F=(R+(m>>>13)|0)+(Nl>>>26)|0,Nl&=67108863,N[0]=Tl,N[1]=Al,N[2]=kl,N[3]=Sl,N[4]=xl,N[5]=Pl,N[6]=El,N[7]=Cl,N[8]=Bl,N[9]=Il,N[10]=Ol,N[11]=Rl,N[12]=$l,N[13]=Ul,N[14]=Ml,N[15]=Dl,N[16]=ql,N[17]=Ll,N[18]=Nl,F!==0&&(N[19]=F,A.length++),A};Math.imul||(P=E);function k(v,h,_){_.negative=h.negative^v.negative,_.length=v.length+h.length;for(var A=0,C=0,M=0;M<_.length-1;M++){var N=C;C=0;for(var F=A&67108863,x=Math.min(M,h.length-1),m=Math.max(0,M-v.length+1);m<=x;m++){var R=M-m,ye=v.words[R]|0,ce=h.words[m]|0,ue=ye*ce,Ne=ue&67108863;N=N+(ue/67108864|0)|0,Ne=Ne+F|0,F=Ne&67108863,N=N+(Ne>>>26)|0,C+=N>>>26,N&=67108863}_.words[M]=F,A=N,N=C}return A!==0?_.words[M]=A:_.length--,_._strip()}function S(v,h,_){return k(v,h,_)}o.prototype.mulTo=function(h,_){var A,C=this.length+h.length;return this.length===10&&h.length===10?A=P(this,h,_):C<63?A=E(this,h,_):C<1024?A=k(this,h,_):A=S(this,h,_),A},o.prototype.mul=function(h){var _=new o(null);return _.words=new Array(this.length+h.length),this.mulTo(h,_)},o.prototype.mulf=function(h){var _=new o(null);return _.words=new Array(this.length+h.length),S(this,h,_)},o.prototype.imul=function(h){return this.clone().mulTo(h,this)},o.prototype.imuln=function(h){var _=h<0;_&&(h=-h),i(typeof h=="number"),i(h<67108864);for(var A=0,C=0;C<this.length;C++){var M=(this.words[C]|0)*h,N=(M&67108863)+(A&67108863);A>>=26,A+=M/67108864|0,A+=N>>>26,this.words[C]=N&67108863}return A!==0&&(this.words[C]=A,this.length++),_?this.ineg():this},o.prototype.muln=function(h){return this.clone().imuln(h)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(h){var _=T(h);if(_.length===0)return new o(1);for(var A=this,C=0;C<_.length&&_[C]===0;C++,A=A.sqr());if(++C<_.length)for(var M=A.sqr();C<_.length;C++,M=M.sqr())_[C]!==0&&(A=A.mul(M));return A},o.prototype.iushln=function(h){i(typeof h=="number"&&h>=0);var _=h%26,A=(h-_)/26,C=67108863>>>26-_<<26-_,M;if(_!==0){var N=0;for(M=0;M<this.length;M++){var F=this.words[M]&C,x=(this.words[M]|0)-F<<_;this.words[M]=x|N,N=F>>>26-_}N&&(this.words[M]=N,this.length++)}if(A!==0){for(M=this.length-1;M>=0;M--)this.words[M+A]=this.words[M];for(M=0;M<A;M++)this.words[M]=0;this.length+=A}return this._strip()},o.prototype.ishln=function(h){return i(this.negative===0),this.iushln(h)},o.prototype.iushrn=function(h,_,A){i(typeof h=="number"&&h>=0);var C;_?C=(_-_%26)/26:C=0;var M=h%26,N=Math.min((h-M)/26,this.length),F=67108863^67108863>>>M<<M,x=A;if(C-=N,C=Math.max(0,C),x){for(var m=0;m<N;m++)x.words[m]=this.words[m];x.length=N}if(N!==0)if(this.length>N)for(this.length-=N,m=0;m<this.length;m++)this.words[m]=this.words[m+N];else this.words[0]=0,this.length=1;var R=0;for(m=this.length-1;m>=0&&(R!==0||m>=C);m--){var ye=this.words[m]|0;this.words[m]=R<<26-M|ye>>>M,R=ye&F}return x&&R!==0&&(x.words[x.length++]=R),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(h,_,A){return i(this.negative===0),this.iushrn(h,_,A)},o.prototype.shln=function(h){return this.clone().ishln(h)},o.prototype.ushln=function(h){return this.clone().iushln(h)},o.prototype.shrn=function(h){return this.clone().ishrn(h)},o.prototype.ushrn=function(h){return this.clone().iushrn(h)},o.prototype.testn=function(h){i(typeof h=="number"&&h>=0);var _=h%26,A=(h-_)/26,C=1<<_;if(this.length<=A)return!1;var M=this.words[A];return!!(M&C)},o.prototype.imaskn=function(h){i(typeof h=="number"&&h>=0);var _=h%26,A=(h-_)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=A)return this;if(_!==0&&A++,this.length=Math.min(A,this.length),_!==0){var C=67108863^67108863>>>_<<_;this.words[this.length-1]&=C}return this._strip()},o.prototype.maskn=function(h){return this.clone().imaskn(h)},o.prototype.iaddn=function(h){return i(typeof h=="number"),i(h<67108864),h<0?this.isubn(-h):this.negative!==0?this.length===1&&(this.words[0]|0)<=h?(this.words[0]=h-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(h),this.negative=1,this):this._iaddn(h)},o.prototype._iaddn=function(h){this.words[0]+=h;for(var _=0;_<this.length&&this.words[_]>=67108864;_++)this.words[_]-=67108864,_===this.length-1?this.words[_+1]=1:this.words[_+1]++;return this.length=Math.max(this.length,_+1),this},o.prototype.isubn=function(h){if(i(typeof h=="number"),i(h<67108864),h<0)return this.iaddn(-h);if(this.negative!==0)return this.negative=0,this.iaddn(h),this.negative=1,this;if(this.words[0]-=h,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var _=0;_<this.length&&this.words[_]<0;_++)this.words[_]+=67108864,this.words[_+1]-=1;return this._strip()},o.prototype.addn=function(h){return this.clone().iaddn(h)},o.prototype.subn=function(h){return this.clone().isubn(h)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(h,_,A){var C=h.length+A,M;this._expand(C);var N,F=0;for(M=0;M<h.length;M++){N=(this.words[M+A]|0)+F;var x=(h.words[M]|0)*_;N-=x&67108863,F=(N>>26)-(x/67108864|0),this.words[M+A]=N&67108863}for(;M<this.length-A;M++)N=(this.words[M+A]|0)+F,F=N>>26,this.words[M+A]=N&67108863;if(F===0)return this._strip();for(i(F===-1),F=0,M=0;M<this.length;M++)N=-(this.words[M]|0)+F,F=N>>26,this.words[M]=N&67108863;return this.negative=1,this._strip()},o.prototype._wordDiv=function(h,_){var A=this.length-h.length,C=this.clone(),M=h,N=M.words[M.length-1]|0,F=this._countBits(N);A=26-F,A!==0&&(M=M.ushln(A),C.iushln(A),N=M.words[M.length-1]|0);var x=C.length-M.length,m;if(_!=="mod"){m=new o(null),m.length=x+1,m.words=new Array(m.length);for(var R=0;R<m.length;R++)m.words[R]=0}var ye=C.clone()._ishlnsubmul(M,1,x);ye.negative===0&&(C=ye,m&&(m.words[x]=1));for(var ce=x-1;ce>=0;ce--){var ue=(C.words[M.length+ce]|0)*67108864+(C.words[M.length+ce-1]|0);for(ue=Math.min(ue/N|0,67108863),C._ishlnsubmul(M,ue,ce);C.negative!==0;)ue--,C.negative=0,C._ishlnsubmul(M,1,ce),C.isZero()||(C.negative^=1);m&&(m.words[ce]=ue)}return m&&m._strip(),C._strip(),_!=="div"&&A!==0&&C.iushrn(A),{div:m||null,mod:C}},o.prototype.divmod=function(h,_,A){if(i(!h.isZero()),this.isZero())return{div:new o(0),mod:new o(0)};var C,M,N;return this.negative!==0&&h.negative===0?(N=this.neg().divmod(h,_),_!=="mod"&&(C=N.div.neg()),_!=="div"&&(M=N.mod.neg(),A&&M.negative!==0&&M.iadd(h)),{div:C,mod:M}):this.negative===0&&h.negative!==0?(N=this.divmod(h.neg(),_),_!=="mod"&&(C=N.div.neg()),{div:C,mod:N.mod}):this.negative&h.negative?(N=this.neg().divmod(h.neg(),_),_!=="div"&&(M=N.mod.neg(),A&&M.negative!==0&&M.isub(h)),{div:N.div,mod:M}):h.length>this.length||this.cmp(h)<0?{div:new o(0),mod:this}:h.length===1?_==="div"?{div:this.divn(h.words[0]),mod:null}:_==="mod"?{div:null,mod:new o(this.modrn(h.words[0]))}:{div:this.divn(h.words[0]),mod:new o(this.modrn(h.words[0]))}:this._wordDiv(h,_)},o.prototype.div=function(h){return this.divmod(h,"div",!1).div},o.prototype.mod=function(h){return this.divmod(h,"mod",!1).mod},o.prototype.umod=function(h){return this.divmod(h,"mod",!0).mod},o.prototype.divRound=function(h){var _=this.divmod(h);if(_.mod.isZero())return _.div;var A=_.div.negative!==0?_.mod.isub(h):_.mod,C=h.ushrn(1),M=h.andln(1),N=A.cmp(C);return N<0||M===1&&N===0?_.div:_.div.negative!==0?_.div.isubn(1):_.div.iaddn(1)},o.prototype.modrn=function(h){var _=h<0;_&&(h=-h),i(h<=67108863);for(var A=(1<<26)%h,C=0,M=this.length-1;M>=0;M--)C=(A*C+(this.words[M]|0))%h;return _?-C:C},o.prototype.modn=function(h){return this.modrn(h)},o.prototype.idivn=function(h){var _=h<0;_&&(h=-h),i(h<=67108863);for(var A=0,C=this.length-1;C>=0;C--){var M=(this.words[C]|0)+A*67108864;this.words[C]=M/h|0,A=M%h}return this._strip(),_?this.ineg():this},o.prototype.divn=function(h){return this.clone().idivn(h)},o.prototype.egcd=function(h){i(h.negative===0),i(!h.isZero());var _=this,A=h.clone();_.negative!==0?_=_.umod(h):_=_.clone();for(var C=new o(1),M=new o(0),N=new o(0),F=new o(1),x=0;_.isEven()&&A.isEven();)_.iushrn(1),A.iushrn(1),++x;for(var m=A.clone(),R=_.clone();!_.isZero();){for(var ye=0,ce=1;!(_.words[0]&ce)&&ye<26;++ye,ce<<=1);if(ye>0)for(_.iushrn(ye);ye-- >0;)(C.isOdd()||M.isOdd())&&(C.iadd(m),M.isub(R)),C.iushrn(1),M.iushrn(1);for(var ue=0,Ne=1;!(A.words[0]&Ne)&&ue<26;++ue,Ne<<=1);if(ue>0)for(A.iushrn(ue);ue-- >0;)(N.isOdd()||F.isOdd())&&(N.iadd(m),F.isub(R)),N.iushrn(1),F.iushrn(1);_.cmp(A)>=0?(_.isub(A),C.isub(N),M.isub(F)):(A.isub(_),N.isub(C),F.isub(M))}return{a:N,b:F,gcd:A.iushln(x)}},o.prototype._invmp=function(h){i(h.negative===0),i(!h.isZero());var _=this,A=h.clone();_.negative!==0?_=_.umod(h):_=_.clone();for(var C=new o(1),M=new o(0),N=A.clone();_.cmpn(1)>0&&A.cmpn(1)>0;){for(var F=0,x=1;!(_.words[0]&x)&&F<26;++F,x<<=1);if(F>0)for(_.iushrn(F);F-- >0;)C.isOdd()&&C.iadd(N),C.iushrn(1);for(var m=0,R=1;!(A.words[0]&R)&&m<26;++m,R<<=1);if(m>0)for(A.iushrn(m);m-- >0;)M.isOdd()&&M.iadd(N),M.iushrn(1);_.cmp(A)>=0?(_.isub(A),C.isub(M)):(A.isub(_),M.isub(C))}var ye;return _.cmpn(1)===0?ye=C:ye=M,ye.cmpn(0)<0&&ye.iadd(h),ye},o.prototype.gcd=function(h){if(this.isZero())return h.abs();if(h.isZero())return this.abs();var _=this.clone(),A=h.clone();_.negative=0,A.negative=0;for(var C=0;_.isEven()&&A.isEven();C++)_.iushrn(1),A.iushrn(1);do{for(;_.isEven();)_.iushrn(1);for(;A.isEven();)A.iushrn(1);var M=_.cmp(A);if(M<0){var N=_;_=A,A=N}else if(M===0||A.cmpn(1)===0)break;_.isub(A)}while(!0);return A.iushln(C)},o.prototype.invm=function(h){return this.egcd(h).a.umod(h)},o.prototype.isEven=function(){return(this.words[0]&1)===0},o.prototype.isOdd=function(){return(this.words[0]&1)===1},o.prototype.andln=function(h){return this.words[0]&h},o.prototype.bincn=function(h){i(typeof h=="number");var _=h%26,A=(h-_)/26,C=1<<_;if(this.length<=A)return this._expand(A+1),this.words[A]|=C,this;for(var M=C,N=A;M!==0&&N<this.length;N++){var F=this.words[N]|0;F+=M,M=F>>>26,F&=67108863,this.words[N]=F}return M!==0&&(this.words[N]=M,this.length++),this},o.prototype.isZero=function(){return this.length===1&&this.words[0]===0},o.prototype.cmpn=function(h){var _=h<0;if(this.negative!==0&&!_)return-1;if(this.negative===0&&_)return 1;this._strip();var A;if(this.length>1)A=1;else{_&&(h=-h),i(h<=67108863,"Number is too big");var C=this.words[0]|0;A=C===h?0:C<h?-1:1}return this.negative!==0?-A|0:A},o.prototype.cmp=function(h){if(this.negative!==0&&h.negative===0)return-1;if(this.negative===0&&h.negative!==0)return 1;var _=this.ucmp(h);return this.negative!==0?-_|0:_},o.prototype.ucmp=function(h){if(this.length>h.length)return 1;if(this.length<h.length)return-1;for(var _=0,A=this.length-1;A>=0;A--){var C=this.words[A]|0,M=h.words[A]|0;if(C!==M){C<M?_=-1:C>M&&(_=1);break}}return _},o.prototype.gtn=function(h){return this.cmpn(h)===1},o.prototype.gt=function(h){return this.cmp(h)===1},o.prototype.gten=function(h){return this.cmpn(h)>=0},o.prototype.gte=function(h){return this.cmp(h)>=0},o.prototype.ltn=function(h){return this.cmpn(h)===-1},o.prototype.lt=function(h){return this.cmp(h)===-1},o.prototype.lten=function(h){return this.cmpn(h)<=0},o.prototype.lte=function(h){return this.cmp(h)<=0},o.prototype.eqn=function(h){return this.cmpn(h)===0},o.prototype.eq=function(h){return this.cmp(h)===0},o.red=function(h){return new B(h)},o.prototype.toRed=function(h){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),h.convertTo(this)._forceRed(h)},o.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(h){return this.red=h,this},o.prototype.forceRed=function(h){return i(!this.red,"Already a number in reduction context"),this._forceRed(h)},o.prototype.redAdd=function(h){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,h)},o.prototype.redIAdd=function(h){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,h)},o.prototype.redSub=function(h){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,h)},o.prototype.redISub=function(h){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,h)},o.prototype.redShl=function(h){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,h)},o.prototype.redMul=function(h){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,h),this.red.mul(this,h)},o.prototype.redIMul=function(h){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,h),this.red.imul(this,h)},o.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(h){return i(this.red&&!h.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,h)};var $={k256:null,p224:null,p192:null,p25519:null};function H(v,h){this.name=v,this.p=new o(h,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}H.prototype._tmp=function(){var h=new o(null);return h.words=new Array(Math.ceil(this.n/13)),h},H.prototype.ireduce=function(h){var _=h,A;do this.split(_,this.tmp),_=this.imulK(_),_=_.iadd(this.tmp),A=_.bitLength();while(A>this.n);var C=A<this.n?-1:_.ucmp(this.p);return C===0?(_.words[0]=0,_.length=1):C>0?_.isub(this.p):_.strip!==void 0?_.strip():_._strip(),_},H.prototype.split=function(h,_){h.iushrn(this.n,0,_)},H.prototype.imulK=function(h){return h.imul(this.k)};function V(){H.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(V,H),V.prototype.split=function(h,_){for(var A=4194303,C=Math.min(h.length,9),M=0;M<C;M++)_.words[M]=h.words[M];if(_.length=C,h.length<=9){h.words[0]=0,h.length=1;return}var N=h.words[9];for(_.words[_.length++]=N&A,M=10;M<h.length;M++){var F=h.words[M]|0;h.words[M-10]=(F&A)<<4|N>>>22,N=F}N>>>=22,h.words[M-10]=N,N===0&&h.length>10?h.length-=10:h.length-=9},V.prototype.imulK=function(h){h.words[h.length]=0,h.words[h.length+1]=0,h.length+=2;for(var _=0,A=0;A<h.length;A++){var C=h.words[A]|0;_+=C*977,h.words[A]=_&67108863,_=C*64+(_/67108864|0)}return h.words[h.length-1]===0&&(h.length--,h.words[h.length-1]===0&&h.length--),h};function z(){H.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(z,H);function X(){H.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(X,H);function L(){H.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(L,H),L.prototype.imulK=function(h){for(var _=0,A=0;A<h.length;A++){var C=(h.words[A]|0)*19+_,M=C&67108863;C>>>=26,h.words[A]=M,_=C}return _!==0&&(h.words[h.length++]=_),h},o._prime=function(h){if($[h])return $[h];var _;if(h==="k256")_=new V;else if(h==="p224")_=new z;else if(h==="p192")_=new X;else if(h==="p25519")_=new L;else throw new Error("Unknown prime "+h);return $[h]=_,_};function B(v){if(typeof v=="string"){var h=o._prime(v);this.m=h.p,this.prime=h}else i(v.gtn(1),"modulus must be greater than 1"),this.m=v,this.prime=null}B.prototype._verify1=function(h){i(h.negative===0,"red works only with positives"),i(h.red,"red works only with red numbers")},B.prototype._verify2=function(h,_){i((h.negative|_.negative)===0,"red works only with positives"),i(h.red&&h.red===_.red,"red works only with red numbers")},B.prototype.imod=function(h){return this.prime?this.prime.ireduce(h)._forceRed(this):(l(h,h.umod(this.m)._forceRed(this)),h)},B.prototype.neg=function(h){return h.isZero()?h.clone():this.m.sub(h)._forceRed(this)},B.prototype.add=function(h,_){this._verify2(h,_);var A=h.add(_);return A.cmp(this.m)>=0&&A.isub(this.m),A._forceRed(this)},B.prototype.iadd=function(h,_){this._verify2(h,_);var A=h.iadd(_);return A.cmp(this.m)>=0&&A.isub(this.m),A},B.prototype.sub=function(h,_){this._verify2(h,_);var A=h.sub(_);return A.cmpn(0)<0&&A.iadd(this.m),A._forceRed(this)},B.prototype.isub=function(h,_){this._verify2(h,_);var A=h.isub(_);return A.cmpn(0)<0&&A.iadd(this.m),A},B.prototype.shl=function(h,_){return this._verify1(h),this.imod(h.ushln(_))},B.prototype.imul=function(h,_){return this._verify2(h,_),this.imod(h.imul(_))},B.prototype.mul=function(h,_){return this._verify2(h,_),this.imod(h.mul(_))},B.prototype.isqr=function(h){return this.imul(h,h.clone())},B.prototype.sqr=function(h){return this.mul(h,h)},B.prototype.sqrt=function(h){if(h.isZero())return h.clone();var _=this.m.andln(3);if(i(_%2===1),_===3){var A=this.m.add(new o(1)).iushrn(2);return this.pow(h,A)}for(var C=this.m.subn(1),M=0;!C.isZero()&&C.andln(1)===0;)M++,C.iushrn(1);i(!C.isZero());var N=new o(1).toRed(this),F=N.redNeg(),x=this.m.subn(1).iushrn(1),m=this.m.bitLength();for(m=new o(2*m*m).toRed(this);this.pow(m,x).cmp(F)!==0;)m.redIAdd(F);for(var R=this.pow(m,C),ye=this.pow(h,C.addn(1).iushrn(1)),ce=this.pow(h,C),ue=M;ce.cmp(N)!==0;){for(var Ne=ce,Le=0;Ne.cmp(N)!==0;Le++)Ne=Ne.redSqr();i(Le<ue);var st=this.pow(R,new o(1).iushln(ue-Le-1));ye=ye.redMul(st),R=st.redSqr(),ce=ce.redMul(R),ue=Le}return ye},B.prototype.invm=function(h){var _=h._invmp(this.m);return _.negative!==0?(_.negative=0,this.imod(_).redNeg()):this.imod(_)},B.prototype.pow=function(h,_){if(_.isZero())return new o(1).toRed(this);if(_.cmpn(1)===0)return h.clone();var A=4,C=new Array(1<<A);C[0]=new o(1).toRed(this),C[1]=h;for(var M=2;M<C.length;M++)C[M]=this.mul(C[M-1],h);var N=C[0],F=0,x=0,m=_.bitLength()%26;for(m===0&&(m=26),M=_.length-1;M>=0;M--){for(var R=_.words[M],ye=m-1;ye>=0;ye--){var ce=R>>ye&1;if(N!==C[0]&&(N=this.sqr(N)),ce===0&&F===0){x=0;continue}F<<=1,F|=ce,x++,!(x!==A&&(M!==0||ye!==0))&&(N=this.mul(N,C[F]),x=0,F=0)}m=26}return N},B.prototype.convertTo=function(h){var _=h.umod(this.m);return _===h?_.clone():_},B.prototype.convertFrom=function(h){var _=h.clone();return _.red=null,_},o.mont=function(h){return new O(h)};function O(v){B.call(this,v),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(O,B),O.prototype.convertTo=function(h){return this.imod(h.ushln(this.shift))},O.prototype.convertFrom=function(h){var _=this.imod(h.mul(this.rinv));return _.red=null,_},O.prototype.imul=function(h,_){if(h.isZero()||_.isZero())return h.words[0]=0,h.length=1,h;var A=h.imul(_),C=A.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=A.isub(C).iushrn(this.shift),N=M;return M.cmp(this.m)>=0?N=M.isub(this.m):M.cmpn(0)<0&&(N=M.iadd(this.m)),N._forceRed(this)},O.prototype.mul=function(h,_){if(h.isZero()||_.isZero())return new o(0)._forceRed(this);var A=h.mul(_),C=A.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=A.isub(C).iushrn(this.shift),N=M;return M.cmp(this.m)>=0?N=M.isub(this.m):M.cmpn(0)<0&&(N=M.iadd(this.m)),N._forceRed(this)},O.prototype.invm=function(h){var _=this.imod(h._invmp(this.m).mul(this.r2));return _._forceRed(this)}})(t,$b)})(F6);var z6="Invariant failed";function H6(t,e){if(!t)throw new Error(z6)}const Iy="3.7.5",K6=Iy,G6=typeof atob=="function",W6=typeof btoa=="function",Ur=typeof Buffer=="function",Mf=typeof TextDecoder=="function"?new TextDecoder:void 0,Df=typeof TextEncoder=="function"?new TextEncoder:void 0,V6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Wr=Array.prototype.slice.call(V6),Za=(t=>{let e={};return t.forEach((n,i)=>e[n]=i),e})(Wr),X6=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,fn=String.fromCharCode.bind(String),qf=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Oy=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Ry=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),$y=t=>{let e,n,i,s,o="";const r=t.length%3;for(let a=0;a<t.length;){if((n=t.charCodeAt(a++))>255||(i=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|s,o+=Wr[e>>18&63]+Wr[e>>12&63]+Wr[e>>6&63]+Wr[e&63]}return r?o.slice(0,r-3)+"===".substring(r):o},cp=W6?t=>btoa(t):Ur?t=>Buffer.from(t,"binary").toString("base64"):$y,Fd=Ur?t=>Buffer.from(t).toString("base64"):t=>{let n=[];for(let i=0,s=t.length;i<s;i+=4096)n.push(fn.apply(null,t.subarray(i,i+4096)));return cp(n.join(""))},Ec=(t,e=!1)=>e?Oy(Fd(t)):Fd(t),J6=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?fn(192|e>>>6)+fn(128|e&63):fn(224|e>>>12&15)+fn(128|e>>>6&63)+fn(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return fn(240|e>>>18&7)+fn(128|e>>>12&63)+fn(128|e>>>6&63)+fn(128|e&63)}},Z6=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Uy=t=>t.replace(Z6,J6),Lf=Ur?t=>Buffer.from(t,"utf8").toString("base64"):Df?t=>Fd(Df.encode(t)):t=>cp(Uy(t)),Qo=(t,e=!1)=>e?Oy(Lf(t)):Lf(t),Nf=t=>Qo(t,!0),Y6=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Q6=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return fn((n>>>10)+55296)+fn((n&1023)+56320);case 3:return fn((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return fn((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},My=t=>t.replace(Y6,Q6),Dy=t=>{if(t=t.replace(/\s+/g,""),!X6.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,n="",i,s;for(let o=0;o<t.length;)e=Za[t.charAt(o++)]<<18|Za[t.charAt(o++)]<<12|(i=Za[t.charAt(o++)])<<6|(s=Za[t.charAt(o++)]),n+=i===64?fn(e>>16&255):s===64?fn(e>>16&255,e>>8&255):fn(e>>16&255,e>>8&255,e&255);return n},up=G6?t=>atob(Ry(t)):Ur?t=>Buffer.from(t,"base64").toString("binary"):Dy,qy=Ur?t=>qf(Buffer.from(t,"base64")):t=>qf(up(t).split("").map(e=>e.charCodeAt(0))),Ly=t=>qy(Ny(t)),e2=Ur?t=>Buffer.from(t,"base64").toString("utf8"):Mf?t=>Mf.decode(qy(t)):t=>My(up(t)),Ny=t=>Ry(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),zd=t=>e2(Ny(t)),t2=t=>{if(typeof t!="string")return!1;const e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},jy=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),Fy=function(){const t=(e,n)=>Object.defineProperty(String.prototype,e,jy(n));t("fromBase64",function(){return zd(this)}),t("toBase64",function(e){return Qo(this,e)}),t("toBase64URI",function(){return Qo(this,!0)}),t("toBase64URL",function(){return Qo(this,!0)}),t("toUint8Array",function(){return Ly(this)})},zy=function(){const t=(e,n)=>Object.defineProperty(Uint8Array.prototype,e,jy(n));t("toBase64",function(e){return Ec(this,e)}),t("toBase64URI",function(){return Ec(this,!0)}),t("toBase64URL",function(){return Ec(this,!0)})},n2=()=>{Fy(),zy()},er={version:Iy,VERSION:K6,atob:up,atobPolyfill:Dy,btoa:cp,btoaPolyfill:$y,fromBase64:zd,toBase64:Qo,encode:Qo,encodeURI:Nf,encodeURL:Nf,utob:Uy,btou:My,decode:zd,isValid:t2,fromUint8Array:Ec,toUint8Array:Ly,extendString:Fy,extendUint8Array:zy,extendBuiltins:n2};var Ss;(function(t){t[t.EQUAL=0]="EQUAL",t[t.GREATER=1]="GREATER",t[t.LESS=-1]="LESS"})(Ss||(Ss={}));var i2=function(){function t(e){this.compare=e||t.defaultCompareFunction}return t.defaultCompareFunction=function(e,n){return e===n?Ss.EQUAL:e<n?Ss.LESS:Ss.GREATER},t.prototype.equal=function(e,n){return this.compare(e,n)===Ss.EQUAL},t.prototype.lessThan=function(e,n){return this.compare(e,n)===Ss.LESS},t.prototype.greaterThan=function(e,n){return this.compare(e,n)===Ss.GREATER},t.prototype.lessThanOrEqual=function(e,n){return this.lessThan(e,n)||this.equal(e,n)},t.prototype.greaterThanOrEqual=function(e,n){return this.greaterThan(e,n)||this.equal(e,n)},t.prototype.reverse=function(){var e=this.compare;this.compare=function(n,i){return e(i,n)}},t}(),jf=function(){function t(e){this.value=e,this.next=null}return t}(),Ff=function(){function t(e){this.value=e,this.next=null,this.prev=null}return t}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Hd=function(t,e){return Hd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},Hd(t,e)};function Mr(t,e){Hd(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function fa(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,s,o,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(u){return function(l){return c([u,l])}}function c(u){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],s=0}finally{i=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function s2(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),s,o=[],r;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function Ai(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s2(arguments[e]));return t}var o2="obfuse error occur";function Vc(t,e){if(!t)throw new Error("[linked-list] "+(e||o2))}var r2=-1,Hy=function(){function t(){for(var e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this._head=null,this._tail=null,this._length=0,this.compare=new i2,n.length>0&&n.forEach(function(s){e.append(s)})}return Object.defineProperty(t.prototype,"head",{get:function(){return this._head?this._head.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tail",{get:function(){return this._tail?this._tail.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loopLength",{get:function(){var e=!1,n=1;if(!this._head)return 0;for(var i=this._head,s=this._head;s.next&&s.next.next;)if(s=s.next.next,i=i.next,i===s){e=!0;break}if(e){for(s=s.next;i!==s;)n++,s=s.next;return n}else return 0},enumerable:!0,configurable:!0}),t.prototype.getNode=function(e){var n=this._length;Vc(n>0&&e>=0&&e<n,"[linked-list] index "+e+" out of scope of list, which length is "+n);for(var i=this._head,s=0;s<e;)i=i.next,s++;return i},t.prototype.get=function(e){var n=this.getNode(e);return n?n.value:null},t.prototype.find=function(e){var n=e.value,i=e.callback;if(!this._head)return null;for(var s=this._head;s;){if(i&&i(s.value)||n!==void 0&&this.compare.equal(s.value,n))return s;s=s.next}return null},t.prototype.indexOf=function(e){if(!this._head)return r2;for(var n=this._head,i=-1;n.next;){if(i++,this.compare.equal(n.value,e))return i;n=n.next}return n===this._tail&&this.compare.equal(n.value,e)&&(i+=1),i},t.prototype.first=function(e){Vc(e>=0,"[linked-list] param 'num' ("+e+") should not less than 0");for(var n=this.iterator(),i=[],s=Math.min(e,this.length),o=0;o<s;o++){var r=n.next();i.push(r.value)}return i},t.prototype.toArray=function(){return Ai(this)},t.prototype.isEmpty=function(){return this._head===null},t.prototype.iterator=function(){var e;return fa(this,function(n){switch(n.label){case 0:e=this._head,n.label=1;case 1:return e?[4,e.value]:[3,3];case 2:return n.sent(),e=e.next,[3,1];case 3:return[2]}})},t.prototype[Symbol.iterator]=function(){return this.iterator()},t}(),ga=function(t){Mr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.apply(this,Ai(n))||this}return e.prototype.append=function(n){var i=new jf(n);return this._tail?(this._tail.next=i,this._tail=i):this._head=this._tail=i,this._length++,!0},e.prototype.prepend=function(n){var i=new jf(n);return this._head?(i.next=this._head,this._head=i):this._head=this._tail=i,this._length++,!0},e.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,i.next=null):this._head=this._tail=null,this._length--,n;for(var s=i;;){if(this.compare.equal(i.value,n))return i.next?s.next=i.next:(this._tail=s,this._tail.next=null),i.next=null,this._length--,n;if(i.next)s=i,i=i.next;else return}}},e.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},e.prototype.removeTail=function(){var n=this._tail;if(n){if(!this._head.next)this._head=null,this._tail=null;else{for(var i=this._head;i.next!==n;)i=i.next;i.next=null,this._tail=i}return this._length--,n.value}},e.prototype.reverse=function(){if(this._head){var n=this._head,i=null,s;for(this._tail=this._head;n!==null;)s=n.next,n.next=i,i=n,n=s;this._head=i}},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,Ai([void 0],n)))},e}(Hy),a2=function(t){Mr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,Ai(n))||this;return s.cyclization(),s}return e.prototype.iterator=function(){var n;return fa(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},e.prototype.circleIterator=function(){var n;return fa(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},e.prototype[Symbol.iterator]=function(){return this.iterator()},e.prototype.mapToNormalListFn=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];this.breakCircle();var o=t.prototype[n].apply(this,i);return this.cyclization(),o},e.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},e.prototype.append=function(n){return this.mapToNormalListFn("append",n)},e.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},e.prototype.find=function(n){return this.mapToNormalListFn("find",n)},e.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},e.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},e.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},e.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},e.prototype.first=function(n){Vc(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),s=[],o=0;o<n;o++){var r=i.next();s.push(r.value)}return s},e.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},e.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},e}(ga);(function(t){Mr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,Ai(n))||this;return s.cyclization(),s}return e.prototype.breakCircle=function(){this._tail&&this._tail.next===this._head&&(this._tail.next=null)},e.prototype.cyclization=function(){this._tail&&this._tail.next===null&&(this._tail.next=this._head)},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,Ai([void 0],n)))},e})(a2);var c2=function(t){Mr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.apply(this,Ai(n))||this}return e.prototype.append=function(n){var i=new Ff(n);return this._tail?(this._tail.next=i,i.prev=this._tail,this._tail=i):this._head=this._tail=i,this._length++,!0},e.prototype.prepend=function(n){var i=new Ff(n);return this._head?(i.next=this._head,this._head.prev=i,this._head=i):this._head=this._tail=i,this._length++,!0},e.prototype.remove=function(n){var i=this._head;if(i){if(this.compare.equal(i.value,n))return i.next?(this._head=i.next,this._head.prev=null,i.next=i.prev=null):this._head=this._tail=null,this._length--,n;for(;;){if(this.compare.equal(i.value,n))return i.next?(i.prev.next=i.next,i.next.prev=i.prev,i.next=i.prev=null):(i.prev.next=null,this._tail=i.prev,i.next=i.prev=null),this._length--,i.value;if(i.next)i=i.next;else return}}},e.prototype.removeHead=function(){var n=this._head;if(n)return this._head.next?(n.next.prev=null,this._head=n.next,n.next=null):(this._head=null,this._tail=null),this._length--,n.value},e.prototype.removeTail=function(){var n=this._tail;if(n)return this._head.next?(n.prev.next=null,this._tail=n.prev,n.next=n.prev=null):(this._head=null,this._tail=null),this._length--,n.value},e.prototype.reverse=function(){if(this._head){var n=this._head,i=null,s;for(this._tail=this._head;n!==null;)s=n.next,n.next=i,n.prev=s,i=n,n=s;this._head=i}},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,Ai([void 0],n)))},e}(Hy),u2=function(t){Mr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,Ai(n))||this;return s.cyclization(),s}return e.prototype.iterator=function(){var n;return fa(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,n===this._head&&(n=null),[3,1];case 3:return[2]}})},e.prototype.circleIterator=function(){var n;return fa(this,function(i){switch(i.label){case 0:n=this._head,i.label=1;case 1:return n?[4,n.value]:[3,3];case 2:return i.sent(),n=n.next,[3,1];case 3:return[2]}})},e.prototype[Symbol.iterator]=function(){return this.iterator()},e.prototype.mapToNormalListFn=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];this.breakCircle();var o=t.prototype[n].apply(this,i);return this.cyclization(),o},e.prototype.getNode=function(n){return this.mapToNormalListFn("getNode",n)},e.prototype.append=function(n){return this.mapToNormalListFn("append",n)},e.prototype.prepend=function(n){return this.mapToNormalListFn("prepend",n)},e.prototype.find=function(n){return this.mapToNormalListFn("find",n)},e.prototype.indexOf=function(n){return this.mapToNormalListFn("indexOf",n)},e.prototype.remove=function(n){return this.mapToNormalListFn("remove",n)},e.prototype.removeHead=function(){return this.mapToNormalListFn("removeHead")},e.prototype.removeTail=function(){return this.mapToNormalListFn("removeTail")},e.prototype.first=function(n){Vc(n>=0,"[linked-list] param 'num' ("+n+") should not less than 0");for(var i=this.circleIterator(),s=[],o=0;o<n;o++){var r=i.next();s.push(r.value)}return s},e.prototype.toArray=function(){return this.mapToNormalListFn("toArray")},e.prototype.reverse=function(){return this.mapToNormalListFn("reverse")},e}(c2);(function(t){Mr(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=t.apply(this,Ai(n))||this;return s.cyclization(),s}return e.prototype.breakCircle=function(){this._tail&&this._head&&this._tail.next===this._head&&(this._tail.next=null,this._head.prev=null)},e.prototype.cyclization=function(){this._head&&this._tail&&this._tail.next===null&&(this._tail.next=this._head,this._head.prev=this._tail)},e.prototype.clone=function(){var n=this.toArray();return new(e.bind.apply(e,Ai([void 0],n)))},e})(u2);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function l2(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),s,o=[],r;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function d2(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l2(arguments[e]));return t}var h2=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.queue=new(ga.bind.apply(ga,d2([void 0],e)))}return Object.defineProperty(t.prototype,"length",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"peek",{get:function(){return this.queue.head},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.queue.isEmpty()},t.prototype.enqueue=function(e){return this.queue.append(e)},t.prototype.dequeue=function(){var e=this.queue.removeHead();return typeof e<"u"?e:void 0},t.prototype.toArray=function(){return this.queue.toArray()},t}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function p2(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),s,o=[],r;try{for(;(e===void 0||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(a){r={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function f2(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p2(arguments[e]));return t}var ud=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.stack=new(ga.bind.apply(ga,f2([void 0],e)))}return Object.defineProperty(t.prototype,"length",{get:function(){return this.stack.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"peek",{get:function(){return this.stack.tail},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.stack.isEmpty()},t.prototype.push=function(e){return this.stack.append(e)},t.prototype.pop=function(){var e=this.stack.removeTail();return typeof e<"u"?e:void 0},t.prototype.popBottom=function(){var e=this.stack.removeHead();return typeof e<"u"?e:void 0},t.prototype.toArray=function(){return this.stack.toArray()},t}(),Ky=function(){function t(e,n,i){i===void 0&&(i=0),this.startVertex=e,this.endVertex=n,this.weight=i}return t.prototype.getKey=function(){var e=this.startVertex.getKey(),n=this.endVertex.getKey();return e+"_"+n},t.prototype.reverse=function(){var e=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=e,this},t.prototype.clone=function(){return new t(this.startVertex,this.endVertex,this.weight)},t.prototype.toString=function(){return this.getKey()},t}();function Kd(t,e,n){if(n===void 0&&(n="cc-graph"),!t)throw new Error((n?"["+n+"]":"")+" Invariant failed: "+e)}function g2(t,e){e===void 0&&(e=!0);var n=typeof t<"u"&&t!==null;return e?n&&t!=="undefined"&&t!=="null":n}var Xc=function(){function t(e){Kd(g2(e),"Graph vertex must have a value"),this.value=e,this.edges=new Map}return t.prototype.addEdge=function(e){return this.edges.set(e.getKey(),e),this},t.prototype.deleteEdge=function(e){this.edges.delete(e.getKey())},t.prototype.getNeighbors=function(){var e=this,n=this.getEdges(),i=function(s){return s.startVertex===e?s.endVertex:s.startVertex};return n.map(i)},t.prototype.getEdges=function(){return Array.from(this.edges.values())},t.prototype.getDegree=function(){return this.getEdges().length},t.prototype.hasEdge=function(e){var n=this.getEdges().find(function(i){return i===e});return!!n},t.prototype.hasNeighbor=function(e){var n=this.getEdges().find(function(i){return i.startVertex===e||i.endVertex===e});return!!n},t.prototype.findEdge=function(e){var n=function(s){return s.startVertex===e||s.endVertex===e},i=this.getEdges().find(n);return i||null},t.prototype.getKey=function(){return this.value},t.prototype.deleteAllEdges=function(){var e=this;return this.getEdges().forEach(function(n){return e.deleteEdge(n)}),this},t.prototype.toString=function(e){return e?e(this.value):""+this.value},t}();function zf(t,e,n,i){if(t){e.push(t),i.set(t.getKey(),!0);var s=t.getNeighbors().filter(function(o){return!i.get(o.getKey())});n.push(s)}}function Hf(t,e,n){var i=t.pop();i&&n.set(i.getKey(),!1),e.pop()}var Gy=function(){function t(e){e===void 0&&(e=!1),this.vertices={},this.edges={},this.isDirected=e}return t.prototype.addVertex=function(e){return this.vertices[e.getKey()]=e,this},t.prototype.getVertexByKey=function(e){return this.vertices[e]},t.prototype.getNeighbors=function(e){return e.getNeighbors()},t.prototype.getAllVertices=function(){return Object.values(this.vertices)},t.prototype.getAllEdges=function(){return Object.values(this.edges)},t.prototype.addEdge=function(e,n){if(n===void 0&&(n=!1),this.edges[e.getKey()]){if(n)return this;Kd(!1,"Edge has already been added before")}var i=this.getVertexByKey(e.startVertex.getKey()),s=this.getVertexByKey(e.endVertex.getKey());if(i||(this.addVertex(e.startVertex),i=this.getVertexByKey(e.startVertex.getKey())),s||(this.addVertex(e.endVertex),s=this.getVertexByKey(e.endVertex.getKey())),this.edges[e.getKey()]=e,this.isDirected)i.addEdge(e);else{i.addEdge(e);var o=e.clone();s.addEdge(o.reverse())}return this},t.prototype.deleteEdge=function(e,n){if(n===void 0&&(n=!1),!this.edges[e.getKey()]){if(n)return this;Kd(!1,"Edge not found in graph")}delete this.edges[e.getKey()];var i=this.getVertexByKey(e.startVertex.getKey()),s=this.getVertexByKey(e.endVertex.getKey());return i.deleteEdge(e),s.deleteEdge(e),this},t.prototype.findEdge=function(e,n){var i=this.getVertexByKey(e.getKey());return i?i.findEdge(n):null},t.prototype.getWeight=function(){return this.getAllEdges().reduce(function(e,n){return e+n.weight},0)},t.prototype.reverse=function(){var e=this;return this.getAllEdges().forEach(function(n){e.deleteEdge(n),n.reverse(),e.addEdge(n)}),this},t.prototype.getVerticesIndices=function(){var e={};return this.getAllVertices().forEach(function(n,i){e[n.getKey()]=i}),e},t.prototype.getAdjacencyMatrix=function(){var e=this,n=this.getAllVertices(),i=this.getVerticesIndices(),s=Array(n.length).fill(null).map(function(){return Array(n.length).fill(1/0)});return n.forEach(function(o,r){o.getNeighbors().forEach(function(a){var c=i[a.getKey()],u=e.findEdge(o,a);u&&(s[r][c]=u.weight)})}),s},t.prototype.toString=function(){return Object.keys(this.vertices).toString()},t.prototype.bfs=function(e){var n,i,s;return jl(this,function(o){switch(o.label){case 0:n=new Map,i=new h2,i.enqueue(e),o.label=1;case 1:return i.isEmpty()?[3,4]:(s=i.dequeue(),s&&!n.has(s.getKey())?[4,s]:[3,3]);case 2:o.sent(),n.set(s.getKey(),s),s.getNeighbors().forEach(function(r){return i.enqueue(r)}),o.label=3;case 3:return[3,1];case 4:return[2]}})},t.prototype.dfs=function(e){var n,i,s;return jl(this,function(o){switch(o.label){case 0:n=new Map,i=new ud,i.push(e),o.label=1;case 1:return i.isEmpty()?[3,4]:(s=i.pop(),s&&!n.has(s.getKey())?[4,s]:[3,3]);case 2:o.sent(),n.set(s.getKey(),s),s.getNeighbors().forEach(function(r){return i.push(r)}),o.label=3;case 3:return[3,1];case 4:return[2]}})},t.prototype.findAllPath=function(e,n){var i,s,o,r,a,c,u;return jl(this,function(l){switch(l.label){case 0:return i=[],e!==n?[3,2]:(i.push(e),[4,i]);case 1:return l.sent(),[2];case 2:s=new Map,o=new ud,r=new ud,zf(e,o,r,s),l.label=3;case 3:if(o.isEmpty())return[3,6];if(a=r.pop(),a&&a.length)c=a.shift(),r.push(a),c&&zf(c,o,r,s);else return r.push(a),Hf(o,r,s),[3,3];return u=o.peek,u!==n?[3,5]:[4,o.toArray()];case 4:l.sent(),Hf(o,r,s),l.label=5;case 5:return[3,3];case 6:return[2]}})},t}();ie.config({precision:64,rounding:ie.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var xn=ie,dn=class extends Error{constructor(e,n){super(e),this.message=e,this.errorCode=n}static isClmmpoolsErrorCode(e,n){return e instanceof dn&&e.errorCode===n}},ge=new y(0),Zs=new y(1),dl=new y(2);dl.pow(new y(128));var Jc=dl.pow(new y(64)).sub(Zs),m2=dl.pow(new y(128)).sub(Zs),Ke=class{static toX64_BN(e){return e.mul(new y(2).pow(new y(64)))}static toX64_Decimal(e){return e.mul(xn.pow(2,64))}static toX64(e){return new y(e.mul(xn.pow(2,64)).floor().toFixed())}static fromX64(e){return new xn(e.toString()).mul(xn.pow(2,-64))}static fromX64_Decimal(e){return e.mul(xn.pow(2,-64))}static fromX64_BN(e){return e.div(new y(2).pow(new y(64)))}static shiftRightRoundUp(e){let n=e.shrn(64);return e.mod(Jc).gt(ge)&&(n=n.add(Zs)),n}static divRoundUp(e,n){return e.mod(n).eq(ge)?e.div(n):e.div(n).add(new y(1))}static subUnderflowU128(e,n){return e.lt(n)?e.sub(n).add(m2):e.sub(n)}static checkUnsignedSub(e,n){const i=e.sub(n);if(i.isNeg())throw new dn("Unsigned integer sub overflow","UnsignedIntegerOverflow");return i}static checkMul(e,n,i){const s=e.mul(n);if(this.isOverflow(s,i))throw new dn("Multiplication overflow","MultiplicationOverflow");return s}static checkMulDivFloor(e,n,i,s){if(i.eq(ge))throw new dn("Devide by zero","DivideByZero");const o=e.mul(n).div(i);if(this.isOverflow(o,s))throw new dn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivCeil(e,n,i,s){if(i.eq(ge))throw new dn("Devide by zero","DivideByZero");const o=e.mul(n).add(i.sub(Zs)).div(i);if(this.isOverflow(o,s))throw new dn("Multiplication div overflow","MulDivOverflow");return o}static checkMulDivRound(e,n,i,s){if(i.eq(ge))throw new dn("Devide by zero","DivideByZero");const o=e.mul(n.add(i.shrn(1))).div(i);if(this.isOverflow(o,s))throw new dn("Multiplication div overflow","MulDivOverflow");return o}static checkMulShiftRight(e,n,i,s){const o=e.mul(n).div(new y(2).pow(new y(i)));if(this.isOverflow(o,s))throw new dn("Multiplication shift right overflow","MulShiftRightOverflow");return o}static checkMulShiftRight64RoundUpIf(e,n,i,s){const o=e.mul(n),a=s&&o.and(Jc).gt(ge)?o.shrn(64).add(Zs):o.shrn(64);if(this.isOverflow(a,i))throw new dn("Multiplication shift right overflow","MulShiftRightOverflow");return a}static checkMulShiftLeft(e,n,i,s){const o=e.mul(n).shln(i);if(this.isOverflow(o,s))throw new dn("Multiplication shift left overflow","MulShiftLeftOverflow");return o}static checkDivRoundUpIf(e,n,i){if(n.eq(ge))throw new dn("Devide by zero","DivideByZero");return i?this.divRoundUp(e,n):e.div(n)}static isOverflow(e,n){return e.gte(dl.pow(new y(n)))}};function Wy(t){return{coinA:t.coinTypeA.toString(),coinB:t.coinTypeB.toString(),currentSqrtPrice:new y(t.current_sqrt_price),currentTickIndex:t.current_tick_index,feeGrowthGlobalA:new y(t.fee_growth_global_a),feeGrowthGlobalB:new y(t.fee_growth_global_b),feeProtocolCoinA:new y(t.fee_protocol_coin_a),feeProtocolCoinB:new y(t.fee_protocol_coin_b),feeRate:t.fee_rate,liquidity:new y(t.liquidity),tickIndexes:[],tickSpacing:Number(t.tickSpacing),ticks:[],collection_name:t.collectionName}}function _2(t){const e=new y(t);return e.lt(ge)?{bits:e.neg().xor(new y(2).pow(new y(64)).sub(new y(1))).add(new y(1)).toString()}:{bits:e.toString()}}var Vy="0x1::coin::CoinInfo",Xy="0x1::coin::CoinStore",Kf="0x3::token::TokenStore",y2="0x3::token::WithdrawEvent",w2="PoolLiquidityCoin",Hs="clmm_router",Jy="factory",Zy="Pools",b2="pool",v2="Pool",T2="crowdsale",A2="CrowdsalePool",k2="fairlaunch",S2="FairlaunchPool",Ci="cetus_script",Yy="cscoin",Qy="liquidity",Gd="scripts";function x2(t){return t.startsWith("0x")?`${t.slice(2)}`:t}function Ri(t){let e="";const n=x2(t),i=n.length/2;for(let s=0;s<i;s++)e+=String.fromCharCode(parseInt(n.substr(s*2,2),16));return P2(e)}function P2(t){let e,n,i,s,o,r;for(e="",i=t.length,n=0;n<i;)switch(s=t.charCodeAt(n++),s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=t.charAt(n-1);break;case 12:case 13:o=t.charCodeAt(n++),e+=String.fromCharCode((s&31)<<6|o&63);break;case 14:o=t.charCodeAt(n++),r=t.charCodeAt(n++),e+=String.fromCharCode((s&15)<<12|(o&63)<<6|(r&63)<<0);break}return e}var E2=/^0x1::coin::CoinStore<(.+)>$/;function Ye(t,...e){const n=Array.isArray(e[e.length-1])?e.pop():[];let s=[t,...e].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function Gf(t){return Ye(et.fromUint8Array(t.value.address.address).hex(),t.value.module_name.value,t.value.name.value,[])}function C2(t){const e=t.value.type_args[0],n=t.value.type_args[1],i=Gf(e),s=Gf(n),o=Ye(et.fromUint8Array(t.value.address.address).hex(),t.value.module_name.value,t.value.name.value,[i,s]);return{coinA:i,coinB:s,lpAddress:o}}function lp(t){var e;let n=t.replace(/\s/g,"");const i=n.match(/(<.+>)$/),s=(e=i==null?void 0:i[0])==null?void 0:e.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s)return n=n.slice(0,n.indexOf("<")),{...lp(n),type_arguments:[...s]};const o=n.split("::");return{full_address:n,address:o[0],module:o[1],name:o[2],type_arguments:[]}}function Wf(t){const e=t.match(E2);return e?e[1]:""}function B2(t){return`${Xy}<${t}>`}function I2(t){return`${Vy}<${t}>`}var hl=class{constructor(e,n=0){this.overdueTime=n,this.value=e}getCacheData(){return this.value===null?null:this.overdueTime===0?this.value:Date.parse(new Date().toString())>this.overdueTime?(this.value=null,null):this.value}},Vf=443636,Xf=-443636,pl="79226673515401279992447579055",fl="4295048016",No=new y(1e6),Zc=class{static getDefaultSqrtPriceLimit(e){return new y(e?fl:pl)}static getDefaultOtherAmountThreshold(e){return e?ge:Jc}},Yc=class{constructor(e,n){this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=e,this.denominator=n}static fromDecimal(e){return Yc.fromFraction(e.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(e,n){const i=typeof e=="number"?new y(e.toString()):e,s=typeof n=="number"?new y(n.toString()):n;return new Yc(i,s)}},O2=14,R2="59543866431248",$2="184467440737095516",U2="15793534762490258745";function M2(t,e,n){const i=t.toTwos(n).shln(e);return i.imaskn(n+1),i.fromTwos(n)}function ut(t,e,n){const i=t.toTwos(n).shrn(e);return i.imaskn(n-e+1),i.fromTwos(n-e)}function D2(t){let e;return t&1?e=new y("79232123823359799118286999567"):e=new y("79228162514264337593543950336"),t&2&&(e=ut(e.mul(new y("79236085330515764027303304731")),96,256)),t&4&&(e=ut(e.mul(new y("79244008939048815603706035061")),96,256)),t&8&&(e=ut(e.mul(new y("79259858533276714757314932305")),96,256)),t&16&&(e=ut(e.mul(new y("79291567232598584799939703904")),96,256)),t&32&&(e=ut(e.mul(new y("79355022692464371645785046466")),96,256)),t&64&&(e=ut(e.mul(new y("79482085999252804386437311141")),96,256)),t&128&&(e=ut(e.mul(new y("79736823300114093921829183326")),96,256)),t&256&&(e=ut(e.mul(new y("80248749790819932309965073892")),96,256)),t&512&&(e=ut(e.mul(new y("81282483887344747381513967011")),96,256)),t&1024&&(e=ut(e.mul(new y("83390072131320151908154831281")),96,256)),t&2048&&(e=ut(e.mul(new y("87770609709833776024991924138")),96,256)),t&4096&&(e=ut(e.mul(new y("97234110755111693312479820773")),96,256)),t&8192&&(e=ut(e.mul(new y("119332217159966728226237229890")),96,256)),t&16384&&(e=ut(e.mul(new y("179736315981702064433883588727")),96,256)),t&32768&&(e=ut(e.mul(new y("407748233172238350107850275304")),96,256)),t&65536&&(e=ut(e.mul(new y("2098478828474011932436660412517")),96,256)),t&131072&&(e=ut(e.mul(new y("55581415166113811149459800483533")),96,256)),t&262144&&(e=ut(e.mul(new y("38992368544603139932233054999993551")),96,256)),ut(e,32,256)}function q2(t){const e=Math.abs(t);let n;return e&1?n=new y("18445821805675392311"):n=new y("18446744073709551616"),e&2&&(n=ut(n.mul(new y("18444899583751176498")),64,256)),e&4&&(n=ut(n.mul(new y("18443055278223354162")),64,256)),e&8&&(n=ut(n.mul(new y("18439367220385604838")),64,256)),e&16&&(n=ut(n.mul(new y("18431993317065449817")),64,256)),e&32&&(n=ut(n.mul(new y("18417254355718160513")),64,256)),e&64&&(n=ut(n.mul(new y("18387811781193591352")),64,256)),e&128&&(n=ut(n.mul(new y("18329067761203520168")),64,256)),e&256&&(n=ut(n.mul(new y("18212142134806087854")),64,256)),e&512&&(n=ut(n.mul(new y("17980523815641551639")),64,256)),e&1024&&(n=ut(n.mul(new y("17526086738831147013")),64,256)),e&2048&&(n=ut(n.mul(new y("16651378430235024244")),64,256)),e&4096&&(n=ut(n.mul(new y("15030750278693429944")),64,256)),e&8192&&(n=ut(n.mul(new y("12247334978882834399")),64,256)),e&16384&&(n=ut(n.mul(new y("8131365268884726200")),64,256)),e&32768&&(n=ut(n.mul(new y("3584323654723342297")),64,256)),e&65536&&(n=ut(n.mul(new y("696457651847595233")),64,256)),e&131072&&(n=ut(n.mul(new y("26294789957452057")),64,256)),e&262144&&(n=ut(n.mul(new y("37481735321082")),64,256)),n}var pt=class{static priceToSqrtPriceX64(e,n,i){return Ke.toX64(e.mul(xn.pow(10,i-n)).sqrt())}static sqrtPriceX64ToPrice(e,n,i){return Ke.fromX64(e).pow(2).mul(xn.pow(10,n-i))}static tickIndexToSqrtPriceX64(e){return e>0?new y(D2(e)):new y(q2(e))}static sqrtPriceX64ToTickIndex(e){if(e.gt(new y(pl))||e.lt(new y(fl)))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const n=e.bitLength()-1,i=new y(n-64),s=M2(i,32,128);let o=new y("8000000000000000","hex"),r=0,a=new y(0),c=n>=64?e.shrn(n-63):e.shln(63-n);for(;o.gt(new y(0))&&r<O2;){c=c.mul(c);const w=c.shrn(127);c=c.shrn(63+w.toNumber()),a=a.add(o.mul(w)),o=o.shrn(1),r+=1}const u=a.shrn(32),d=s.add(u).mul(new y(R2)),p=ut(d.sub(new y($2)),64,128).toNumber(),g=ut(d.add(new y(U2)),64,128).toNumber();return p===g?p:pt.tickIndexToSqrtPriceX64(g).lte(e)?g:p}static tickIndexToPrice(e,n,i){return pt.sqrtPriceX64ToPrice(pt.tickIndexToSqrtPriceX64(e),n,i)}static priceToTickIndex(e,n,i){return pt.sqrtPriceX64ToTickIndex(pt.priceToSqrtPriceX64(e,n,i))}static priceToInitializableTickIndex(e,n,i,s){return pt.getInitializableTickIndex(pt.priceToTickIndex(e,n,i),s)}static getInitializableTickIndex(e,n){return e-e%n}static getNextInitializableTickIndex(e,n){return pt.getInitializableTickIndex(e,n)+n}static getPrevInitializableTickIndex(e,n){return pt.getInitializableTickIndex(e,n)-n}};function ew(t){const e=[];for(const n of t){const i={index:Number(BigInt.asIntN(64,BigInt(n.index.bits)).toString()),sqrtPrice:new y(n.sqrt_price),liquidityNet:new y(BigInt.asIntN(64,BigInt(n.liquidity_net.bits)).toString()),liquidityGross:new y(n.liquidity_gross),feeGrowthOutsideA:new y(n.fee_growth_outside_a),feeGrowthOutsideB:new y(n.fee_growth_outside_b),rewardersGrowthOutside:[new y(n.rewarders_growth_outside[0]),new y(n.rewarders_growth_outside[1]),new y(n.rewarders_growth_outside[2])]};e.push(i)}return e}function Jf(t){return t.isAxiosError,t}function ze(t){return xn.isDecimal(t)?t:new xn(t===void 0?0:t)}function dp(t){return ze(10).pow(ze(t).abs())}function L2(t){return t!=null&&t!==""&&!isNaN(Number(t.toString()))}new y(365);new y(24);new y(3600);new y(.5);function N2(t,e,n,i,s,o){const r=new ie(t.toString()).div(new ie(10**n)),a=new ie(e.toString()).div(new ie(10**i));return r.mul(s).add(a.mul(o))}function j2(t,e,n,i,s,o,r,a,c,u,l,d,p,g,b,w,T,E,P,k,S,$,H,V){const z=new ie(d),X=new ie(p),L=new ie(w),B=new ie(T),O=new ie(E),v=new ie(P),h=new ie(k),_=new ie(S),A=new ie($),C=new ie(H),M=new ie(V),N=pt.tickIndexToSqrtPriceX64(e),F=pt.tickIndexToSqrtPriceX64(n),x=Ke.toX64_Decimal(Ke.fromX64(N)).round(),m=Ke.toX64_Decimal(Ke.fromX64(F)).round(),R=Ke.toX64_Decimal(Ke.fromX64(i)).round();let ye;const ce=z.mul(new ie(10**o)).mul(m.mul(x)).div(m.sub(x)).round(),ue=X.mul(new ie(10**r)).div(m.sub(x)).round();t<e?ye=ce:t>n?ye=ue:ye=ie.min(ce,ue);const Ne=ye.mul(R.sub(x)),st=ye.mul(m.sub(R)).div(R.mul(m)).div(new ie(10**o)).mul(h).add(Ne.div(new ie(10**r).mul(_))),We=N2(g,b,o,r,h,_),$e=st.div(We),nt=ye.eq(new ie(0))?new ie(0):new ie(l/1e4).mul(L).mul(new ie(ye.toString()).div(new ie(s.toString()).add(new ie(ye.toString())))).div(st),Xn=$e.eq(new ie(0))?new ie(0):$e.mul(new ie(36500/7)).div(st),Y=B.div(new ie(10**a)).mul(A).mul(Xn),oe=O.div(new ie(10**c)).mul(C).mul(Xn),we=v.div(new ie(10**u)).mul(M).mul(Xn);return{feeAPR:nt,posRewarder0APR:Y,posRewarder1APR:oe,posRewarder2APR:we}}function F2(t,e,n,i){const s=Math.max(t,n),r=Math.min(e,i)-s,a=e-t,c=i-n,u=new ie(a.toString()),l=new ie(c.toString()),d=new ie(r.toString());let p=new ie("0");return r<0?p=new ie("0"):a===r?p=l.div(d):c===r?p=d.div(u):p=d.mul(d).div(l).div(u),p}function z2(t){const{clmmpool:e,position:n,tickLower:i,tickUpper:s}=t,{current_tick_index:o,fee_growth_global_a:r,fee_growth_global_b:a}=e;console.log({currentTickIndex:o,feeGrowthGlobalAX64:r,feeGrowthGlobalBX64:a});const{tick_lower_index:c,tick_upper_index:u,liquidity:l,fee_owed_a:d,fee_owed_b:p,fee_growth_inside_a:g,fee_growth_inside_b:b}=n,{feeGrowthOutsideA:w,feeGrowthOutsideB:T}=i,{feeGrowthOutsideA:E,feeGrowthOutsideB:P}=s;let k=null,S=null;o<Number(c)?(k=Ke.subUnderflowU128(new y(r),new y(w)),S=Ke.subUnderflowU128(new y(a),new y(T))):(k=w,S=T);let $=null,H=null;o<Number(u)?($=E,H=P):($=Ke.subUnderflowU128(new y(r),new y(E)),H=Ke.subUnderflowU128(new y(a),new y(P)));const V=Ke.subUnderflowU128(Ke.subUnderflowU128(new y(r),new y(k)),new y($)),z=Ke.subUnderflowU128(Ke.subUnderflowU128(new y(a),new y(S)),new y(H)),X=Ke.subUnderflowU128(new y(V),new y(g)).mul(new y(l)).shrn(64),L=Ke.subUnderflowU128(new y(z),new y(b)).mul(new y(l)).shrn(64),B=new y(ze(d).add(ze(X.toString())).toString()),O=new y(ze(p).add(ze(L.toString())).toString());return{feeOwedA:B,feeOwedB:O}}var gs=1e9,H2=5*60*1e3,Ya=24*60*60*1e3;function Zf(t){return Date.parse(new Date().toString())+t}var K2=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async getPoolImmutablesResource(e=!1){const n=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,i=`${n}_getMmutablesPools`,s=this.getCacheData(i);let o;if(!e&&s!=null)o=s;else{const r=Ye(n,Jy,Zy),a=await this._sdk.Resources.fetchAccountResource(n,r);o=JSON.parse(JSON.stringify(a==null?void 0:a.data)),this.updateCache(i,o,Ya)}return o}async getLaunchpadPools(e=[],n=0,i=100,s=null,o=!1){const r=this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,a=[],u=(await this.getPoolImmutablesResource(o)).data.data,l=e.length>0;for(let d=0;d<u.length;d+=1){const p=u[d],{pool_address:g,creater_address:b,pool_type:w}=p.value;if(s==="fixed_price"&&w!==0||s==="fair_launch"&&w===0||l&&!e.includes(g))continue;if(!l){const z=Number(d);if(z<n||z>=n+i)continue}const T=p.key,E=Ye(T.coin_raise.account_address,Ri(T.coin_raise.module_name),Ri(T.coin_raise.struct_name)),P=Ye(T.coin_sale.account_address,Ri(T.coin_sale.module_name),Ri(T.coin_sale.struct_name)),k=gi.buildLaunchpadPoolType(w===0,r,P,E),S={coin_type_sale:P,coin_type_raise:E,pool_type:k,pool_address:g,creator:b,pool_mode:w===0?"fixed_price":"fair_launch"},$=await this.getLaunchpadPoolState(S.pool_address,S.pool_type,S.pool_mode),H={...S,...$};await this.calculateLaunchpadPoolField(H),a.push(H);const V=`${g}_pool`;this.updateCache(V,H,Ya)}return a}async getLaunchpadPool(e,n=!0){const i=`${e}_pool`,s=this.getCacheData(i);let o;if(s!==null&&!n&&(o=s),o==null)return(await this.getLaunchpadPools([e]))[0];const r=await this.getLaunchpadPoolState(e,o.pool_type,o.pool_mode),a={...o,...r};return await this.calculateLaunchpadPoolField(a),this.updateCache(i,a,Ya),a}async getSpecifyCoinDecimals(e){const n={};(await this._sdk.Token.getSpecifyTokenListByCache(e)).forEach(r=>{n[r.address]=r.decimals});const s=e.filter(r=>n[r]===void 0);return(await this._sdk.Resources.getSpecifyCoinInfos(s)).forEach(r=>{n[r.coinAddress]=Number(r.decimals)}),n}async calculateLaunchpadPoolField(e){const n=await this.getSpecifyCoinDecimals([e.coin_type_sale,e.coin_type_raise]),i=Number(n[e.coin_type_sale]),s=Number(n[e.coin_type_raise]);if(e.initialize_price=gi.priceFixToReal(e.initialize_price,i,s),gi.isFixedPricePool(e))e.raise_total=gi.raiseTotalAmount(e,i,s);else{e.raise_total=gi.raiseTotalAmount(e,i,s);const r=ze(e.raise_coin_amount).div(ze(10).pow(ze(s))),a=ze(e.sale_total).div(ze(10).pow(ze(i)));a.toNumber()>0?e.price=r.div(a).toNumber():e.price=0}return gi.updatePoolStaus(e),!0}async getLaunchpadPoolState(e,n,i,s=!0){const o=`${e}_${n}_getLaunchpadPoolState`;if(!s){const u=this.getCacheData(o);if(u!==null)return u}const r=await this._sdk.Resources.fetchAccountResource(e,n),a=JSON.parse(JSON.stringify(r==null?void 0:r.data)),c=gi.buildLaunchpadFixedPoolState(i,a);return this.updateCache(o,c,Ya),c}async getOwnerLaunchpadCoins(e){const n=await this._sdk.Resources.getCoinStores(e),i=[];return n.forEach(s=>{const o=lp(s.coinAddress);o.module===Yy&&i.push({coin_type_sale:o.type_arguments[0],coin_type_raise:o.type_arguments[1],coin_address:s.coinAddress,balance:Number(s.coin.value)})}),i}async getSimplePosition(e){const n=await this._sdk.Resources.fetchAccountResource(e,Ye(this._sdk.sdkOptions.networkOptions.launchpad.cetusLaunchpad,"clmmProxy","LockedPosition")),i=JSON.parse(JSON.stringify(n==null?void 0:n.data));return{position_name:i.token_id.token_data_id.name,collection:i.token_id.token_data_id.collection,creator:i.token_id.token_data_id.creator,unlock_time:i.unlock_time,is_redeem:i.is_redeem}}async hasPoolWhitelist(e){const{launchpad:n}=this._sdk.sdkOptions.networkOptions,i={handle:"",exist:!1};try{const s=await this._sdk.Resources.fetchAccountResource(e,Ye(n.cetusLaunchpad,"whitelist","Whitelist")),o=JSON.parse(JSON.stringify(s==null?void 0:s.data));return i.exist=Number(o.users.length)>0,i.handle=o.users.inner.handle,i}catch(s){console.log(s)}return i}async inPoolWhitelist(e,n){if(!n.exist)return!1;try{return await this._sdk.client.getTableItem(n.handle,{key_type:"address",value_type:"u8",key:e}),!0}catch(i){console.log(i)}return!1}buildLaunchpadCoinType(e,n){return Ye(this._sdk.sdkOptions.networkOptions.launchpad.crowdCoin,"cscoin","CS",[e,n])}creatPoolTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s="is_admin"in e,o=`${i.cetusLaunchpad}::${Ci}`,r=s?e.is_admin?"create_crowdsale_pool_authority":"create_crowdsale_pool":"create_fairlaunch_pool",a=gi.priceRealToFix(e.initialize_price,e.sale_decimals,e.raise_decimals);console.log("fixPrice:",a);const c=pt.priceToSqrtPriceX64(ze(e.initialize_price),e.sale_decimals,e.raise_decimals).toString();return s?gi.buildCreatCrowdsalePoolPayload(e,c,a,o,r,n):gi.buildCreatFairlaunchPoolPayload(e,c,a,o,r,n)}updatePoolTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o="update_pool";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr)),te.bcsSerializeUint64(e.start_time),te.bcsSerializeUint64(e.liquidity_rate*100),te.bcsSerializeUint64(e.activity_duration),te.bcsSerializeUint64(e.calmdown_duraction),te.bcsSerializeUint64(e.settle_duration),te.bcsSerializeUint64(e.locked_duration)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.start_time,e.liquidity_rate*100,e.activity_duration,e.calmdown_duraction,e.settle_duration,e.locked_duration];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}purchaseTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o="purchase";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr)),te.bcsSerializeUint64(e.raise_amount_in)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.raise_amount_in];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}revokeTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o="revoke";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr)),te.bcsSerializeUint64(e.cs_coin_amount)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}settleTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o=e.pool_mode==="fixed_price",r=o?"crowd_sale_settle":"fair_launch_settle";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))];return o?new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,r,u,[])):new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,r,u,[te.bcsSerializeU128(BigInt(e.initialize_sqrt_price))]))}const a=Ye(s,r),c=[e.coin_type_sale,e.coin_type_raise];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:o?[]:[e.initialize_sqrt_price]}}claimTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o="claim";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr)),te.bcsSerializeUint64(e.cs_coin_amount)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr,e.cs_coin_amount];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}claimFeeTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o="claim_fee";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr))];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}withdrawTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o=e.is_withdraw_sale?"withdraw_sale":"withdraw_raise";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr))];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.pool_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}redeemPositionTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o="redeem_position";if(n){const c=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,c,[]))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:[]}}userToWhitelistTransactionPayload(e,n=!1){const{launchpad:i}=this.sdk.sdkOptions.networkOptions,s=`${i.cetusLaunchpad}::${Ci}`,o=e.isAdd?"add_user_to_whitelist":"remove_user_from_whitelist";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.user_addr))];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coin_type_sale,e.coin_type_raise],c=[e.user_addr];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}updateCache(e,n,i=H2){let s=this._cache[e];s?(s.overdueTime=Zf(i),s.value=n):s=new hl(n,Zf(i)),this._cache[e]=s}getCacheData(e){const n=this._cache[e];return n!==void 0&&n.getCacheData()?n.value:null}};function G2(t,e,n,i){const s=t.shln(64),o=n.sub(e);return i?Ke.divRoundUp(s,o):s.div(o)}var gi=class{static minSettlePurchaseAmount(e){return ze(e.sale_total).mul(e.initialize_price).mul(e.least_raise_rate).toNumber()}static get_sale_liquidity_amount(e,n,i,s,o,r){const a=Wd.getMinIndex(e),c=Wd.getMaxIndex(e),u=this.priceRealToFix(s,o,r),l=new y(n*u*i),d=new y(pt.priceToSqrtPriceX64(ze(u),0,0).toString()),p=G2(l,pt.tickIndexToSqrtPriceX64(a),d,!1);return sP(d,pt.tickIndexToSqrtPriceX64(c),p,!0).toString()}static raiseTotalAmount(e,n,i){const s=ze(n-i).abs().toNumber();return n>i?Number(ze(e.sale_total).mul(e.initialize_price).div(ze(10).pow(ze(s))).toString()):Number(ze(e.sale_total).mul(e.initialize_price).mul(ze(10).pow(ze(s))).toString())}static priceRealToFix(e,n,i){const s=ze(n-i).toNumber();return Number(ze(e).div(ze(10).pow(ze(s))).toString())}static priceFixToReal(e,n,i){const s=ze(n-i).toNumber();return Number(ze(e).mul(ze(10).pow(ze(s))).toString())}static buildLaunchpadPoolType(e,n,i,s){return e?Ye(Ye(n,T2,A2),[i,s]):Ye(Ye(n,k2,S2),[i,s])}static isFixedPricePool(e){return e.pool_mode==="fixed_price"}static getFairLaunchSettleSqrtPrice(e,n,i){if(e.pool_status!=="Settle")throw new Error("The pool is not in settle ");const s=pt.priceToSqrtPriceX64(ze(e.price),n,i).toString();return console.log("sqrtPrice: ",s.toString()),s.toString()}static async updatePoolStaus(e){const n=gi.isFixedPricePool(e),i=Number(ze(Date.now()/1e3).toFixed(0));if(e.end_activity_time=Number(e.start_activity_time)+Number(e.activity_duration),n)if(e.end_settle_time=Number(e.end_activity_time)+Number(e.settle_duration),e.is_settle)e.pool_status="Ended";else if(i<Number(e.start_activity_time))e.pool_status="Upcoming";else if(i>=e.start_activity_time&&i<e.end_activity_time)e.pool_status="Live";else if(i>=e.end_activity_time&&i<e.end_settle_time){const s=e.raise_coin_amount,o=ze(e.raise_total).mul(ze(e.least_raise_rate)).toNumber();s<o?e.pool_status="Failed":e.pool_status="Settle"}else e.pool_status="Failed";else if(e.end_calm_down_time=Number(e.end_activity_time)+Number(e.calmdown_duration),e.end_settle_time=Number(e.end_calm_down_time)+Number(e.settle_duration),e.is_settle)e.pool_status="Ended";else if(i<Number(e.start_activity_time))e.pool_status="Upcoming";else if(i>=e.start_activity_time&&i<e.end_activity_time)e.pool_status="Live";else if(i>=e.end_activity_time&&i<e.end_calm_down_time)e.pool_status="Calmdown";else if(i>=e.end_calm_down_time&&i<e.end_settle_time){const s=e.raise_coin_amount,o=ze(e.raise_total).mul(ze(e.least_raise_rate)).toNumber();s<o?e.pool_status="Failed":e.pool_status="Settle"}else e.pool_status="Failed";return!0}static buildLaunchpadFixedPoolState(e,n){return e==="fixed_price"?{sale_coin_amount:n.sale_coin.value,raise_coin_amount:n.raise_coin.value,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,initialize_price:Number(n.initialize_price)/gs,initialize_sqrt_price:BigInt(n.initialize_sqrt_price),is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_rate)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,sale_total:n.sale_total,raise_total:0,settle_duration:n.settle_duration,start_activity_time:n.start_time,unused_raise:n.unused_raise,unused_sale:n.unused_sale,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_settle_time:0}:{price:0,sale_coin_amount:0,raise_coin_amount:n.raise_coin.value,sale_total:n.sale_coin.value,raise_total:0,calmdown_duration:n.calmdown_duration,initialize_price:Number(n.price)/gs,activity_duration:n.activity_duration,clmm_pool_address:n.clmm_pool_address,cs_burn_cap:n.cs_burn_cap.dummy_field,cs_mint_cap:n.cs_mint_cap.dummy_field,fee_amount:n.fee_amount,fee_rate:n.fee_rate,is_settle:n.is_settle,least_raise_rate:Number(n.least_raise_amount)/100,liquidity_rate:Number(n.liquidity_rate)/100,locked_duration:n.locked_duration,settle_duration:n.settle_duration,start_activity_time:n.start_time,has_whiteList:n.has_white_list,pool_status:"Upcoming",end_activity_time:0,end_calm_down_time:0,end_settle_time:0}}static buildCreatCrowdsalePoolPayload(e,n,i,s,o,r=!1){if(r){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],d=e.is_admin?[te.bcsSerializeU128(i*gs),te.bcsSerializeU128(BigInt(n)),te.bcsSerializeUint64(e.tick_spacing),te.bcsSerializeUint64(e.sale_total),te.bcsSerializeUint64(e.start_time),te.bcsSerializeUint64(e.least_raise_rate*100),te.bcsSerializeUint64(e.activity_duration),te.bcsSerializeUint64(e.settle_duration),te.bcsSerializeUint64(e.locked_duration),te.bcsSerializeU8(0)]:[te.bcsSerializeU128(i*gs),te.bcsSerializeU128(BigInt(n)),te.bcsSerializeUint64(e.tick_spacing),te.bcsSerializeUint64(e.sale_total),te.bcsSerializeUint64(e.start_time),te.bcsSerializeUint64(e.least_raise_rate*100),te.bcsSerializeUint64(e.liquidity_rate*100),te.bcsSerializeUint64(e.activity_duration),te.bcsSerializeUint64(e.settle_duration),te.bcsSerializeUint64(e.locked_duration),te.bcsSerializeU8(0)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,l,d))}const a=Ye(s,o),c=[e.coin_type_sale,e.coin_type_raise],u=e.is_admin?[i*gs,n,e.tick_spacing,e.sale_total,e.start_time,e.least_raise_rate*100,e.activity_duration,e.settle_duration,e.locked_duration,0]:[i*gs,n,e.tick_spacing,e.sale_total,e.start_time,e.least_raise_rate*100,e.liquidity_rate*100,e.activity_duration,e.settle_duration,e.locked_duration,0];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}static buildCreatFairlaunchPoolPayload(e,n,i,s,o,r=!1){if(r){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_sale)),new D.TypeTagStruct(D.StructTag.fromString(e.coin_type_raise))],d=[te.bcsSerializeU128(i*gs),te.bcsSerializeU128(BigInt(n)),te.bcsSerializeUint64(e.tick_spacing),te.bcsSerializeUint64(e.sale_total),te.bcsSerializeUint64(e.start_time),te.bcsSerializeUint64(e.least_raise_rate*100),te.bcsSerializeUint64(e.liquidity_rate*100),te.bcsSerializeUint64(e.activity_duration),te.bcsSerializeUint64(e.calmdown_duraction),te.bcsSerializeUint64(e.settle_duration),te.bcsSerializeUint64(e.locked_duration)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,l,d))}const a=Ye(s,o),c=[e.coin_type_sale,e.coin_type_raise],u=[i*gs,n,e.tick_spacing,e.sale_total,e.start_time,e.liquidity_rate*100,te.bcsSerializeUint64(e.least_raise_rate*100),e.activity_duration,e.calmdown_duraction,e.settle_duration,e.locked_duration];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}};function W2(t){let e;switch(t){case 5:e=5;break;case 10:e=10;break;case 20:e=20;break;case 25:e=25;break;case 50:e=50;break;case 100:e=100;break;default:e=1}const n=100/e+1,i=new Array(n);for(let s=0;s<n;s+=1)i[s]=s*e;return i}function Cc(t,e){const n=W2(e),i=new Array(n.length);for(let s=0;s<n.length;s+=1)i[s]=t.muln(n[s]).divn(100);return i}function V2(t,e,n,i){for(let s=e;s<t;s+=1)n.amountInArray[s]=n.amountInArray[s].add(i.amountIn),n.amountOutArray[s]=n.amountOutArray[s].add(i.amountOut),n.feeAmountArray[s]=n.feeAmountArray[s].add(i.feeAmount);return n}function X2(t,e,n,i,s){let o=new y(i.liquidity),{currentSqrtPrice:r}=i,a={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]};n.forEach(()=>{a.amountInArray.push(ge),a.amountOutArray.push(ge),a.feeAmountArray.push(ge),a.nextSqrtPriceArray.push(ge)});let c,u;const l=Zc.getDefaultSqrtPriceLimit(t),d=n.length;let p=n[1],g=1,b;t?b=s.sort((w,T)=>T.index-w.index):b=s.sort((w,T)=>w.index-T.index);for(const w of b){if(t){if(i.currentTickIndex<w.index)continue}else if(i.currentTickIndex>w.index)continue;if(w===null)continue;t&&l.gt(w.sqrtPrice)||!t&&l.lt(w.sqrtPrice)?c=l:c=w.sqrtPrice;let T={amountIn:ge,amountOut:ge,nextSqrtPrice:ge,feeAmount:ge};const E=r,P=o;let k=p,S=g;for(let $=g;$<d;$+=1){const H=iw(r,c,o,p,new y(i.feeRate),e);if(T=H,H.amountIn.eq(ge)||(p=e?p.sub(H.amountIn.add(H.feeAmount)):p.sub(H.amountOut)),p.eq(ge))a.amountInArray[$]=a.amountInArray[$].add(H.amountIn),a.amountOutArray[$]=a.amountOutArray[$].add(H.amountOut),a.feeAmountArray[$]=a.feeAmountArray[$].add(H.feeAmount),H.nextSqrtPrice.eq(w.sqrtPrice)?(u=t?w.liquidityNet.mul(new y(-1)):w.liquidityNet,o=u.gt(ge)?o.add(u):o.sub(u.abs()),r=w.sqrtPrice):r=H.nextSqrtPrice,a.amountInArray[$]=a.amountInArray[$].add(a.feeAmountArray[$]),a.nextSqrtPriceArray[$]=r,o=P,r=E,$!==d-1&&(p=k.add(n[$+1].sub(n[S]))),g+=1;else{a=V2(d,$,a,H),k=p,S=g;break}}if(g===d)break;T.nextSqrtPrice.eq(w.sqrtPrice)?(u=t?w.liquidityNet.mul(new y(-1)):w.liquidityNet,o=u.gt(ge)?o.add(u):o.sub(u.abs()),r=w.sqrtPrice):r=T.nextSqrtPrice}return e?n.forEach((w,T)=>{a.isExceed.push(a.amountInArray[T].lt(w))}):n.forEach((w,T)=>{a.isExceed.push(a.amountOutArray[T].lt(w))}),a}var J2=class{constructor(t,e,n,i,s,o){this.minSplitUnit=e,this.a2b=i,this.byAmountIn=s,this.clmmpool=n,this.ticks=o,this.amountArray=[],this.createSplitSwapParams=this.createSplitSwapParams.bind(this),this.createSplitSwapParams(t,e),this.splitSwapResult={amountInArray:[],amountOutArray:[],feeAmountArray:[],nextSqrtPriceArray:[],isExceed:[]},this.computeSwap=this.computeSwap.bind(this)}createSplitSwapParams(t,e){const n=Cc(t,e);this.amountArray=n}computeSwap(){const t=Wy(this.clmmpool);return this.splitSwapResult=X2(this.a2b,this.byAmountIn,this.amountArray,t,this.ticks),this.splitSwapResult}},Wd=class{static getMinIndex(e){return Xf+Math.abs(Xf)%e}static getMaxIndex(e){return Vf-Vf%e}};function Z2(t,e,n,i,s,o){const r=t.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=o[c];e!==null&&(t.current_tick_index<i?u=o[c].sub(new y(e.rewardersGrowthOutside[c])):u=e.rewardersGrowthOutside[c]);let l=new y(0);n!==null&&(t.current_tick_index>=s?l=o[c].sub(new y(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=Ke.subUnderflowU128(Ke.subUnderflowU128(new y(o[c]),new y(u)),new y(l));a.push(d)}return a}function Y2(t){if(t){const e={};return t.maxGasAmount&&(e.maxGasAmount=BigInt(t.maxGasAmount)),t.gasUnitPrice&&(e.gasUnitPrice=BigInt(t.gasUnitPrice)),t.expireTimestamp&&(e.expireTimestamp=BigInt(t.expireTimestamp)),e}}function Q2(t,e){return new Pc(i=>{const s=new Uint8Array(64);return new D.Ed25519Signature(s)},t.toUint8Array()).sign(e)}function eP(t){if(t){const e={};return t.maxGasAmount&&(e.max_gas_amount=t.maxGasAmount.toString()),t.gasUnitPrice&&(e.gas_unit_price=t.gasUnitPrice.toString()),t.expireTimestamp&&(e.expiration_timestamp_secs=t.expireTimestamp.toString()),e}}async function tP(t,e,n,i,s=!0){if(n instanceof D.TransactionPayload){const l=await t.generateRawTransaction(e.address,n,Y2(i)),d=Q2(e.pubkey,l),p=await t.submitBCSSimulation(d);return s&&console.log(p[0]),p[0]}const o=n,r=await t.generateTransaction(e.address,o,eP(i)),a={type:"ed25519_signature",public_key:e.pubkey.hex(),signature:et.fromUint8Array(new Uint8Array(64)).hex()},c={sender:e.address.hex(),sequence_number:r.sequence_number.toString(),max_gas_amount:r.max_gas_amount.toString(),gas_unit_price:r.gas_unit_price.toString(),expiration_timestamp_secs:r.expiration_timestamp_secs.toString(),payload:o,signature:a},u=await t.client.transactions.simulateTransaction(c);return s&&console.log(u[0]),u[0]}async function Qa(t,e,n,i){return tP(t,e,n,i,!1)}function Yf(t,e){const n=new te.Serializer;n.serializeU32AsUleb128(t.length);const i=n[e];return t.forEach(s=>{n.serializeU32AsUleb128(s.length),s.forEach(o=>{i.call(n,o)})}),n.getBytes()}function nP(t){const e=new te.Serializer;return e.serializeU32AsUleb128(t.length),t.forEach(n=>{e.serializeU32AsUleb128(n.length),n.forEach(i=>{i.serialize(e)})}),e.getBytes()}function iP(t){const e=new te.Serializer;return e.serializeU32AsUleb128(t.length),t.forEach(n=>{n.serialize(e)}),e.getBytes()}function sP(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t),o=n.mul(s).shln(64),r=t.mul(e),a=o.div(r),c=o.mod(r);return i&&!c.eq(ge)?a.add(new y(1)):a}function tw(t,e,n,i){if(n.eq(ge))return t;const s=Ke.checkMulShiftLeft(t,e,64,256),o=e.shln(64),r=Ke.checkMul(t,n,256);if(!i&&o.lte(r))throw new dn("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?Ke.checkDivRoundUpIf(s,o.add(r),!0):Ke.checkDivRoundUpIf(s,o.sub(r),!0);if(a.lt(new y(fl)))throw new dn("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new y(pl)))throw new dn("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function nw(t,e,n,i){const s=Ke.checkDivRoundUpIf(n.shln(64),e,!i),o=i?t.add(s):t.sub(s);if(o.lt(new y(fl))||o.gt(new y(pl)))throw new dn("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return o}function oP(t,e,n,i){return i?tw(t,e,n,!0):nw(t,e,n,!0)}function rP(t,e,n,i){return i?nw(t,e,n,!1):tw(t,e,n,!1)}function Qf(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(ge)||s.eq(ge))return ge;let o;if(i){const r=new y(n).mul(new y(s)).shln(64),a=e.mul(t),c=r.div(a);o=r.mod(a).eq(ge)?c:c.add(Zs)}else{const r=new y(n).mul(new y(s));o=r.and(Jc).gt(ge)?r.shrn(64).add(Zs):r.shrn(64)}return o}function e0(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(ge)||s.eq(ge))return ge;let o;if(i)o=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=e.mul(t);o=r.div(a)}return o}function iw(t,e,n,i,s,o){if(n===ge)return{amountIn:ge,amountOut:ge,nextSqrtPrice:e,feeAmount:ge};const r=t.gte(e);let a,c,u,l;if(o){const d=Ke.checkMulDivFloor(i,Ke.checkUnsignedSub(No,s),No,64),p=Qf(t,e,n,r);p.gt(d)?(a=d,l=Ke.checkUnsignedSub(i,d),u=oP(t,n,d,r)):(a=p,l=Ke.checkMulDivCeil(a,s,No.sub(s),64),u=e),c=e0(t,u,n,r)}else{const d=e0(t,e,n,r);d.gt(i)?(c=i,u=rP(t,n,i,r)):(c=d,u=e),a=Qf(t,u,n,r),l=Ke.checkMulDivCeil(a,s,No.sub(s),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function aP(t,e,n,i,s){let o=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:ge,amountOut:ge,feeAmount:ge,refAmount:ge,nextSqrtPrice:ge,crossTickNum:0};let u,l;const d=Zc.getDefaultSqrtPriceLimit(t);for(const p of s){if(t){if(i.currentTickIndex<p.index)continue}else if(i.currentTickIndex>p.index)continue;if(p===null)continue;t&&d.gt(p.sqrtPrice)||!t&&d.lt(p.sqrtPrice)?u=d:u=p.sqrtPrice;const g=iw(a,u,r,o,new y(i.feeRate),e);if(g.amountIn.eq(ge)||(o=e?o.sub(g.amountIn.add(g.feeAmount)):o.sub(g.amountOut)),c.amountIn=c.amountIn.add(g.amountIn),c.amountOut=c.amountOut.add(g.amountOut),c.feeAmount=c.feeAmount.add(g.feeAmount),g.nextSqrtPrice.eq(p.sqrtPrice)?(l=t?p.liquidityNet.mul(new y(-1)):p.liquidityNet,r=l.gt(ge)?r.add(l):r.sub(l.abs()),a=p.sqrtPrice):a=g.nextSqrtPrice,c.crossTickNum+=1,o.eq(ge))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function jo(t,e,n){const i=y.min(t,e),s=y.max(t,e),o=Ke.fromX64_BN(n.mul(s).mul(i)),r=s.sub(i);return o.div(r)}function Fo(t,e,n){const i=y.min(t,e),o=y.max(t,e).sub(i);return n.shln(64).div(o)}var ni=class{constructor(){}static getFeeRate(e){return Yc.fromFraction(e,1e6)}static updateFeeRate(e,n,i,s,o){const r=Ke.checkMulDivCeil(n,new y(s),No,64),a=i===0?ge:Ke.checkMulDivFloor(n,new y(i),No,64),c=n.mul(r).mul(a);if(o?e.feeProtocolCoinA=e.feeProtocolCoinA.add(r):e.feeProtocolCoinB=e.feeProtocolCoinB.add(r),c.eq(ge)||e.liquidity.eq(ge))return{refFee:a,clmm:e};const u=c.shln(64).div(e.liquidity);return o?e.feeGrowthGlobalA=e.feeGrowthGlobalA.add(u):e.feeGrowthGlobalB=e.feeGrowthGlobalB.add(u),{refFee:a,clmm:e}}static getProtocolFeeRate(e){return Yc.fromFraction(e,1e4)}static getCoinAmountFromLiquidity(e,n,i,s,o){const r=new xn(e.toString()),a=new xn(n.toString()),c=new xn(i.toString()),u=new xn(s.toString());let l,d;return n.lt(i)?(l=Ke.toX64_Decimal(r).mul(u.sub(c)).div(c.mul(u)),d=new xn(0)):n.lt(s)?(l=Ke.toX64_Decimal(r).mul(u.sub(a)).div(a.mul(u)),d=Ke.fromX64_Decimal(r.mul(a.sub(c)))):(l=new xn(0),d=Ke.fromX64_Decimal(r.mul(u.sub(c)))),o?{coinA:new y(l.ceil().toString()),coinB:new y(d.ceil().toString())}:{coinA:new y(l.floor().toString()),coinB:new y(d.floor().toString())}}static estimateLiquidityFromcoinAmounts(e,n,i,s){if(n>i)throw new Error("lower tick cannot be greater than lower tick");const o=pt.sqrtPriceX64ToTickIndex(e),r=pt.tickIndexToSqrtPriceX64(n),a=pt.tickIndexToSqrtPriceX64(i);if(o<n)return jo(r,a,s.coinA);if(o>=i)return Fo(a,r,s.coinB);const c=jo(e,a,s.coinA),u=Fo(e,r,s.coinB);return y.min(c,u)}static estLiquidityAndcoinAmountFromOneAmounts(e,n,i,s,o,r,a){const c=pt.sqrtPriceX64ToTickIndex(a),u=pt.tickIndexToSqrtPriceX64(e),l=pt.tickIndexToSqrtPriceX64(n);let d;if(c<e){if(!s)throw new Error("lower tick cannot calculate liquidity by coinB");d=jo(u,l,i)}else if(c>n){if(s)throw new Error("upper tick cannot calculate liquidity by coinA");d=Fo(l,u,i)}else s?d=jo(a,l,i):d=Fo(a,u,i);const p=ni.getCoinAmountFromLiquidity(d,a,u,l,o),g=p.coinA.mul(new y(1+r)),b=p.coinB.mul(new y(1+r));return{tokenMaxA:g,tokenMaxB:b,liquidityAmount:d}}static estCoinAmountsFromTotalAmount(e,n,i,s,o,r){const{ratioA:a,ratioB:c}=ni.calculateDepositRatioFixTokenA(e,n,i);console.log({ratioA:a,ratioB:c});const u=ze(s).mul(a).div(o),l=ze(s).mul(c).div(r);return{amountA:u,amountB:l}}static calculateDepositRatioFixTokenA(e,n,i){const s=new y(1),{tokenMaxB:o}=ni.estLiquidityAndcoinAmountFromOneAmounts(e,n,s,!0,!0,0,i),r=pt.sqrtPriceX64ToPrice(i,0,0),a=ze(s.toString()).mul(r),c=a.add(o.toString()),u=a.div(c),l=ze(o.toString()).div(c);return{ratioA:u,ratioB:l}}},cP=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async fetchAccountResource(e,n,i=0){let s=this._cache[e+n];if(s!=null&&s.getCacheData())return s.value;const o=await this.sdk.Resources.fetchAccountResource(e,n);return s=new hl(o,i),this._cache[e+n]=s,o}calculateRates(e){const{currentPool:n}=e,i=Wy(n);let s;e.a2b?s=e.swapTicks.sort((p,g)=>g.index-p.index):s=e.swapTicks.sort((p,g)=>p.index-g.index);const o=aP(e.a2b,e.byAmountIn,e.amount,i,s);let r=!1;e.byAmountIn?r=o.amountIn.lt(e.amount):r=o.amountOut.lt(e.amount);const a=Zc.getDefaultSqrtPriceLimit(e.a2b);e.a2b&&o.nextSqrtPrice.lt(a)&&(r=!0),!e.a2b&&o.nextSqrtPrice.gt(a)&&(r=!0);let c=0;o.crossTickNum>6&&o.crossTickNum<40&&(c=22e3*(o.crossTickNum-6)),o.crossTickNum>40&&(r=!0);const u=pt.sqrtPriceX64ToPrice(i.currentSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),l=pt.sqrtPriceX64ToPrice(o.nextSqrtPrice,e.decimalsA,e.decimalsB).toNumber(),d=Math.abs(u-l)/u*100;return{estimatedAmountIn:o.amountIn,estimatedAmountOut:o.amountOut,estimatedEndSqrtPrice:o.nextSqrtPrice,estimatedFeeAmount:o.feeAmount,isExceed:r,extraComputeLimit:c,amount:e.amount,aToB:e.a2b,byAmountIn:e.byAmountIn,priceImpactPct:d}}transformSwapData(e){const{modules:n}=this._sdk.sdkOptions.networkOptions,i=e.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.ClmmIntegrate}::calculator::CalculatedSwapResult`);return i.length===0?[]:i[0].data.data.data||[]}async preswap(e){const{modules:n,simulationAccount:i}=this.sdk.sdkOptions.networkOptions,s=new vt(this.sdk.sdkOptions.rpcUrl),o=`${n.ClmmIntegrate}::scripts`,r="calculate_swap_result",a=[new D.TypeTagStruct(D.StructTag.fromString(e.pool.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.pool.coinTypeB))],c=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool.poolAddress)),te.bcsSerializeBool(e.a2b),te.bcsSerializeBool(e.by_amount_in),te.bcsSerializeUint64(BigInt(e.amount))],u=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r,a,c)),l=vr(i.address),d=await s.generateRawTransaction(l,u),p=vr(i.pubkey),g=new D.Ed25519PublicKey(p.toUint8Array()),b=await s.simulateTransaction(g,d),w=this.transformSwapData(b[0].changes),T=pt.sqrtPriceX64ToPrice(new y(e.pool.current_sqrt_price),e.decimalsA,e.decimalsB).toNumber(),E=pt.sqrtPriceX64ToPrice(new y(w.after_sqrt_price),e.decimalsA,e.decimalsB).toNumber(),P=Math.abs(T-E)/T*100;return{estimatedAmountIn:w.amount_in&&w.fee_amount?new y(w.amount_in).add(new y(w.fee_amount)).toString():"",estimatedAmountOut:w.amount_out,estimatedEndSqrtPrice:w.after_sqrt_price,estimatedFeeAmount:w.fee_amount,isExceed:w.is_exceed,amount:e.amount,aToB:e.a2b,byAmountIn:e.by_amount_in,priceImpactPct:P}}createSwapTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Hs}`,o="swap",r=Zc.getDefaultSqrtPriceLimit(e.a_to_b);if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_addr)),te.bcsSerializeBool(e.a_to_b),te.bcsSerializeBool(e.by_amount_in),te.bcsSerializeUint64(BigInt(e.amount)),te.bcsSerializeUint64(BigInt(e.amount_limit)),te.bcsSerializeU128(BigInt(r.toString())),te.bcsSerializeStr(e.partner)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const a=[e.pool_addr,e.a_to_b,e.by_amount_in,e.amount,e.amount_limit,r.toString(),e.partner],c=[e.coinTypeA,e.coinTypeB];return{type:"entry_function_payload",function:Ye(s,o),type_arguments:c,arguments:a}}},uP=class{constructor(e){this._sdk=e}get sdk(){return this._sdk}createAddLiquidityTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=!("delta_liquidity"in e),o=`${i.LiquidswapDeployer}::${Hs}`,r=s?"add_liquidity_fix_token":"add_liquidity";if(n){const d=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB))],p=s?[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeUint64(Number(e.amount_a)),te.bcsSerializeUint64(Number(e.amount_b)),te.bcsSerializeBool(e.fix_amount_a),te.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_lower))),te.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_upper))),te.bcsSerializeBool(e.is_open),te.bcsSerializeUint64(e.index)]:[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeU128(e.delta_liquidity.toNumber()),te.bcsSerializeUint64(Number(e.max_amount_a)),te.bcsSerializeUint64(Number(e.max_amount_b)),te.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_lower))),te.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_upper))),te.bcsSerializeBool(e.is_open),te.bcsSerializeUint64(e.index)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r,d,p))}const a=BigInt.asUintN(64,BigInt(e.tick_lower)).toString(),c=BigInt.asUintN(64,BigInt(e.tick_upper)).toString(),u=s?[e.pool,e.amount_a,e.amount_b,e.fix_amount_a,a,c,e.is_open,e.index]:[e.pool,e.delta_liquidity.toString(),String(e.max_amount_a),String(e.max_amount_b),a,c,e.is_open,e.index],l=[e.coinTypeA,e.coinTypeB];return{type:"entry_function_payload",function:Ye(o,r),type_arguments:l,arguments:u}}removeLiquidityTransactionPayload(e,n=!1){H6(e.delta_liquidity.gtn(0));const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Hs}`,o=`${i.ClmmIntegrate}::${Qy}`,r=["remove_liquidity","remove_all_liquidity","remove_all_liquidity_for_two","remove_all_liquidity_for_three"];let a,c,u=[];if(e.rewards_num===0){if(n){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB))],d=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeU128(e.delta_liquidity.toNumber()),te.bcsSerializeUint64(e.min_amount_a),te.bcsSerializeUint64(e.min_amount_b),te.bcsSerializeUint64(e.pos_index),te.bcsSerializeBool(e.is_close)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,r[0],l,d))}a=Ye(s,r[0]),c=[e.coinTypeA,e.coinTypeB],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}else if(e.rewards_num===1){if(n){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeC))],d=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeU128(e.delta_liquidity.toNumber()),te.bcsSerializeUint64(e.min_amount_a),te.bcsSerializeUint64(e.min_amount_b),te.bcsSerializeUint64(e.pos_index),te.bcsSerializeBool(e.is_close)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r[1],l,d))}a=Ye(o,r[1]),c=[e.coinTypeA,e.coinTypeB,e.coinTypeC],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}else if(e.rewards_num===2){if(n){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeC)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeD))],d=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeU128(e.delta_liquidity.toNumber()),te.bcsSerializeUint64(e.min_amount_a),te.bcsSerializeUint64(e.min_amount_b),te.bcsSerializeUint64(e.pos_index),te.bcsSerializeBool(e.is_close)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r[2],l,d))}a=Ye(o,r[2]),c=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}else{if(n){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeC)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeD)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeE))],d=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeU128(e.delta_liquidity.toNumber()),te.bcsSerializeUint64(e.min_amount_a),te.bcsSerializeUint64(e.min_amount_b),te.bcsSerializeUint64(e.pos_index),te.bcsSerializeBool(e.is_close)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r[3],l,d))}a=Ye(o,r[3]),c=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD,e.coinTypeE],u=[e.pool,e.delta_liquidity.toNumber(),e.min_amount_a,e.min_amount_b,e.pos_index,e.is_close]}return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}closePositionTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Hs}`,o="close_position";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_address)),te.bcsSerializeUint64(e.pos_index)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coinTypeA,e.coinTypeB],c=[e.pool_address,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectFeeTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Hs}`,o="collect_fee";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool)),te.bcsSerializeUint64(e.pos_index)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coinTypeA,e.coinTypeB],c=[e.pool,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}};function lP(t){let e="";const i=new ll(t).parseTypeTag().value.type_args;if(i.length>0){const s=i[0];s.value.name.value===w2||s.value.name.value===Yy?e=C2(s).lpAddress:e=Ye(et.fromUint8Array(s.value.address.address).toShortString(),s.value.module_name.value,s.value.name.value,[])}return e}var dP=5*60*1e3,Bi=24*60*60*1e3;function t0(t){return Date.parse(new Date().toString())+t}var hP=class{constructor(t){this._cache={},this._sdk=t}get sdk(){return this._sdk}async getPoolImmutablesResource(t=!1){const e=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,n=`${e}_getMmutablesPools`,i=this.getCacheData(n);let s;if(!t&&i!=null)s=i;else{const r=Ye(e,Jy,Zy),a=await this.fetchAccountResource(e,r);s=JSON.parse(JSON.stringify(a==null?void 0:a.data.data)),this.updateCache(n,s,Bi)}return s.data}buildPoolImmutables(t,e,n){const i=n.key,s=Ye(i.coin_type_a.account_address,Ri(i.coin_type_a.module_name),Ri(i.coin_type_a.struct_name)),o=Ye(i.coin_type_b.account_address,Ri(i.coin_type_b.module_name),Ri(i.coin_type_b.struct_name)),r=Ye(Ye(e,b2,v2),[s,o]);return{coinTypeA:s,coinTypeB:o,poolType:r,poolAddress:t,tickSpacing:i.tick_spacing}}async getPoolImmutables(t=[],e=0,n=100,i=!0){const s=this._sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer,o=[],r=await this.getPoolImmutablesResource(i),a=t.length>0;for(let c=0;c<r.length;c+=1){const u=r[c],l=u.value;if(!(a&&!t.includes(l))){if(!a){const d=Number(c);if(d<e||d>=e+n)continue}o.push(this.buildPoolImmutables(l,s,u))}}return o}async getPools(t=[],e=0,n=100){const i=[],s=(await this.sdk.getGlobalConfig()).is_pause,o=await this.getPoolImmutables(t,e,n,!1);for(let r=0;r<o.length;r+=1){const a=o[r],c=await this.getPoolState(a.poolAddress,a.poolType,s),u={...a,...c};i.push(u);const l=`${a.poolAddress}_pool`;this.updateCache(l,u,Bi)}return i}async getPool(t,e=!0){const n=`${t}_pool`,i=this.getCacheData(n);let s;if(i!==null&&!e&&(s=i),s==null)return(await this.getPools([t]))[0];const o=(await this.sdk.getGlobalConfig(!0)).is_pause,r=await this.getPoolState(t,s.poolType,o),a={...s,...r};return this.updateCache(n,a,Bi),a}async getPoolState(t,e,n,i=!0){const s=`${t}_${e}getPool`;if(!i){const l=this.getCacheData(s);if(l!==null)return l}const o=await this.fetchAccountResource(t,e),r=JSON.parse(JSON.stringify(o==null?void 0:o.data)),a=r.rewarder_infos,c=[];a.forEach(l=>{const d=Ye(l.coin_type.account_address,Ri(l.coin_type.module_name),Ri(l.coin_type.struct_name)),p=Ke.fromX64(new y(l.emissions_per_second)),g=Math.floor(p.toNumber()*60*60*24);c.push({...l,coinAddress:d,emissionsEveryDay:g})});const u={coinAmountA:r.coin_a.value,coinAmountB:r.coin_b.value,current_sqrt_price:r.current_sqrt_price,current_tick_index:Number(BigInt.asIntN(64,BigInt(r.current_tick_index.bits)).toString()),fee_growth_global_a:r.fee_growth_global_a,fee_growth_global_b:r.fee_growth_global_b,fee_protocol_coin_a:r.fee_protocol_coin_a,fee_protocol_coin_b:r.fee_protocol_coin_b,fee_rate:r.fee_rate,liquidity:r.liquidity,index:r.index,positionIndex:r.position_index,tick_indexes_handle:r.tick_indexes.handle,ticks_handle:r.ticks.handle,positions_handle:r.positions.handle,collectionName:r.collection_name,uri:r.uri,is_pause:n||r.is_pause,rewarder_infos:c,rewarder_last_updated_time:r.rewarder_last_updated_time};return this.updateCache(s,u,Bi),u}async getTickDataByIndex(t,e){const n=await this._sdk.client.getTableItem(t,{key_type:`${this.sdk.sdkOptions.networkOptions.modules.IntegerMate}::i64::I64`,value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Tick`,key:_2(e)}),i=JSON.parse(JSON.stringify(n));return{index:i.index,sqrtPrice:i.sqrt_price,liquidityGross:i.liquidity_gross,liquidityNet:i.liquidity_net,feeGrowthOutsideA:i.fee_growth_outside_a,feeGrowthOutsideB:i.fee_growth_outside_b,rewardersGrowthOutside:i.rewarders_growth_outside}}async getPoolLowerAndUpperTicks(t,e){const n=[],i=[],s=e.ticks_handle,o=await this.sdk.Resources.getPositionList(t,[e]);for(const r of o){const a=await this.sdk.Resources.getTickDataByIndex(s,r.tick_lower_index),c=await this.sdk.Resources.getTickDataByIndex(s,r.tick_upper_index);n.push(a),i.push(c)}return[n,i]}async getPositionInfoByIndex(t,e){const n=await this._sdk.client.getTableItem(t,{key_type:"u64",value_type:`${this.sdk.sdkOptions.networkOptions.modules.LiquidswapDeployer}::pool::Position`,key:e.toString()}),i=JSON.parse(JSON.stringify(n));return{name:"",pool:i.pool,liquidity:i.liquidity,tick_lower_index:BigInt.asIntN(64,BigInt(i.tick_lower_index.bits)).toString(),tick_upper_index:BigInt.asIntN(64,BigInt(i.tick_upper_index.bits)).toString(),fee_growth_inside_a:i.fee_growth_inside_a,fee_growth_inside_b:i.fee_growth_inside_b,fee_owed_a:i.fee_owed_a,fee_owed_b:i.fee_owed_b,reward_amount_owed_0:i.rewarder_infos[0].amount_owed,reward_amount_owed_1:i.rewarder_infos[1].amount_owed,reward_amount_owed_2:i.rewarder_infos[2].amount_owed,reward_growth_inside_0:i.rewarder_infos[0].growth_inside,reward_growth_inside_1:i.rewarder_infos[1].growth_inside,reward_growth_inside_2:i.rewarder_infos[2].growth_inside,index:e}}createPositionName(t,e){return`Cetus LP | Pool${t}-${e}`}async getPositionInfo(t,e,n=!0){if(L2(e)){const i=await this.getPositionInfoByIndex(t.positions_handle,Number(e));return i.name=this.createPositionName(t.index,i.index),i}return this.getPositionInfoByTokenName(t.poolAddress,t.positions_handle,t.collectionName,e,n)}async getPositionIndex(t,e,n,i=!1){const s=`${t}_${e}_${n}_getPositionIndex`;if(!i){const a=this.getCacheData(s);if(a!==null)return a}const o=await this._sdk.tokenClient.getTokenData(t,e,n),r=JSON.parse(JSON.stringify(o)).default_properties.data.index.value;return this.updateCache(s,r,Bi),r}async getPositionInfoByTokenName(t,e,n,i,s=!0){const o=`${t}_${n}_${i}_getPositionInfo`;if(!s){const c=this.getCacheData(o);if(c!==null)return c}const r=await this.getPositionIndex(t,n,i,!1),a=await this.getPositionInfoByIndex(e,r);return a.name=i,this.updateCache(o,a,Bi),a}async getGlobalConfig(t,e=!0){const n=`${t}_getGlobalConfig`;if(!e){const r=this.getCacheData(n);if(r!==null)return r}const i=await this.fetchAccountResource(t,Ye(t,"config","GlobalConfig")),s=JSON.parse(JSON.stringify(i)).data,o={protocol_fee_rate:s.protocol_fee_rate,is_pause:s.is_pause};return this.updateCache(n,o,Bi),o}async getSpecifyCoinInfos(t){const e=[];for(const n of t){const i=`${n}_getCoinInfos`,s=this.getCacheData(i);if(s!==null)e.push(s);else{const o=lp(n).address,r=await this._sdk.Resources.fetchAccountResource(o,I2(n));if(r!=null){const a={coinAddress:n,...r.data};e.push(a),this.updateCache(i,a,Bi)}}}return e}async getCoinInfos(t,e=!0){const n=`${t}_getCoinInfos`;if(!e){const o=this.getCacheData(n);if(o!==null)return o}const i=await this.fetchAccountResources(t),s=[];return i==null||i.forEach(o=>{if(o.type.startsWith(Vy)){const r=lP(o.type);r.length>0&&s.push({coinAddress:r,...o.data})}}),this.updateCache(n,s,Bi),s}async getCoinStores(t,e=!0){const n=`${t}_getCoinStores`;if(!e){const o=this.getCacheData(n);if(o!==null)return o}const i=await this.fetchAccountResources(t),s=[];return i==null||i.forEach(o=>{if(o.type.startsWith(Xy)){const r=Wf(o.type);r.length>0&&s.push({coinAddress:r,...o.data})}}),this.updateCache(n,s,Bi),s}async getCoinStore(t,e){const n=await this.fetchAccountResource(t,B2(e));if(n){const i=Wf(n.type);if(i.length>0)return{coinAddress:i,...n.data}}return null}async getPositionList(t,e){const n=[];if(e.length===0)return[];const i=await this.getFilterTokenEvent(t);for(let s=0;s<i.length;s++){const o=i[s];try{for(const r of e)if(o.creator===r.poolAddress){const a=await this.getPositionInfoByTokenName(o.creator,r.positions_handle,o.collection,o.name);a.pool.length>0&&n.push({...o,...a})}}catch(r){console.log(r)}}return n}async getCollectionList(t){return await this.getFilterTokenEvent(t)}async getFilterTokenEvent(t){const e=[],n=[];let i=[];try{i=await this._sdk.client.getEventsByEventHandle(t,Kf,"deposit_events")}catch(o){console.log(o)}i.forEach(o=>{e.push({key:`${o.data.id.token_data_id.creator}_${o.data.id.token_data_id.name}`,creator:o.data.id.token_data_id.creator,name:o.data.id.token_data_id.name,collection:o.data.id.token_data_id.collection,count:0})});let s=[];try{s=await this._sdk.client.getEventsByEventHandle(t,Kf,"withdraw_events")}catch(o){console.log(o)}return s.forEach(o=>{if(o.type===y2){for(const r of e)if(r.count===0&&r.key===`${o.data.id.token_data_id.creator}_${o.data.id.token_data_id.name}`){r.count-=1;break}}}),e.forEach(o=>{o.count===0&&n.push({...o})}),n}async fetchAccountResource(t,e){var n;try{return await this._sdk.client.getAccountResource(t,e)}catch(i){if(Jf(i)&&((n=i.response)==null?void 0:n.status)===404)return null;throw i}}async fetchAccountResources(t){var e;try{return await this._sdk.client.getAccountResources(t)}catch(n){if(Jf(n)&&((e=n.response)==null?void 0:e.status)===404)return null;throw n}}updateCache(t,e,n=dP){let i=this._cache[t];i?(i.overdueTime=t0(n),i.value=e):i=new hl(e,t0(n)),this._cache[t]=i}getCacheData(t){const e=this._cache[t];return e!==void 0&&e.getCacheData()?e.value:null}},pP=class{constructor(e){this._sdk=e}get sdk(){return this._sdk}creatPoolTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=e.delta_liquidity.gt(ge),o=s?`${i.LiquidswapDeployer}::${Qy}`:`${i.LiquidswapDeployer}::${Hs}`,r=s?"create_and_add_liquidity":"create_pool";if(n){const l=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB))],d=s?[te.bcsSerializeUint64(e.tick_spacing),te.bcsSerializeU128(BigInt(e.initialize_sqrt_price.toString())),te.bcsSerializeStr(e.uri),te.bcsSerializeU128(BigInt(e.delta_liquidity.toString())),te.bcsSerializeUint64(BigInt(e.max_amount_a.toString())),te.bcsSerializeUint64(BigInt(e.max_amount_b.toString())),te.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_lower))),te.bcsSerializeUint64(BigInt.asUintN(64,BigInt(e.tick_upper)))]:[te.bcsSerializeUint64(e.tick_spacing),te.bcsSerializeU128(BigInt(e.initialize_sqrt_price.toString())),te.bcsSerializeStr(e.uri)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r,l,d))}const a=Ye(o,r),c=[e.coinTypeA,e.coinTypeB],u=s?[e.tick_spacing.toString(),e.initialize_sqrt_price.toString(),e.uri.toString(),e.delta_liquidity.toString(),e.max_amount_a.toString(),e.max_amount_b.toString(),BigInt.asUintN(64,BigInt(e.tick_lower)).toString(),BigInt.asUintN(64,BigInt(e.tick_upper)).toString()]:[e.tick_spacing.toString(),e.initialize_sqrt_price.toString(),e.uri.toString()];return{type:"entry_function_payload",function:a,type_arguments:c,arguments:u}}},fP=class{constructor(e){this._sdk=e,this.growthGlobal=[ge,ge,ge]}get sdk(){return this._sdk}async listRewarderInfosFromClmmpool(e){const n=await this.sdk.Resources.getPool(e),i=[];for(const s of n.rewarder_infos)i.push(s);return i}async emissionsEveryDay(e){const n=await this.listRewarderInfosFromClmmpool(e);if(!n)return null;const i=[];for(const s of n){const o=Ke.fromX64(new y(s.emissions_per_second));i.push({emissions:Math.floor(o.toNumber()*60*60*24),coin_address:s.coinAddress})}return i}async collectRewarderAmount(e,n){const i=await this.sdk.Resources.getPositionInfo(e,n);return i?{reward_amount_owed_0:i.reward_amount_owed_0,reward_amount_owed_1:i.reward_amount_owed_1,reward_amount_owed_2:i.reward_amount_owed_2}:null}async updatePoolRewarder(e,n){const i=await this.sdk.Resources.getPool(e),s=i.rewarder_last_updated_time;if(i.rewarder_last_updated_time=n,i.liquidity===0||n.eq(s))return i;const o=n.div(new y(1e3)).sub(new y(s)).add(new y(15)),r=i.rewarder_infos;for(let a=0;a<r.length;a+=1){const c=r[a],u=Ke.checkMulDivFloor(o,new y(c.emissions_per_second),new y(i.liquidity),128);this.growthGlobal[a]=new y(c.growth_global).add(new y(u))}return i}async posRewardersAmount(e,n,i,s){const o=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(e,new y(o)),a=await this.sdk.Resources.getPositionInfo(r,n),c=parseInt(a.tick_lower_index,10),u=parseInt(a.tick_upper_index,10),l=Z2(r,i,s,c,u,this.growthGlobal),d=[],p=[];if(l.length>0){const g=Ke.subUnderflowU128(l[0],new y(a.reward_growth_inside_0)),b=Ke.checkMulShiftRight(new y(a.liquidity),g,64,256);d.push(l[0]),p.push({amount_owed:new y(a.reward_amount_owed_0).add(b),coin_address:r.rewarder_infos[0].coinAddress})}if(l.length>1){const g=Ke.subUnderflowU128(l[1],new y(a.reward_growth_inside_1)),b=Ke.checkMulShiftRight(new y(a.liquidity),g,64,256);d.push(l[1]),p.push({amount_owed:new y(a.reward_amount_owed_1).add(b),coin_address:r.rewarder_infos[1].coinAddress})}if(l.length>2){const g=Ke.subUnderflowU128(l[2],new y(a.reward_growth_inside_2)),b=Ke.checkMulShiftRight(new y(a.liquidity),g,64,256);d.push(l[2]),p.push({amount_owed:new y(a.reward_amount_owed_2).add(b),coin_address:r.rewarder_infos[2].coinAddress})}return p}async poolRewardersAmount(e,n,i,s){const o=Date.parse(new Date().toString()),r=await this.updatePoolRewarder(n,new y(o)),a=await this.sdk.Resources.getPositionList(e,[r]),c=[ge,ge,ge];for(let u=0;u<a.length;u+=1){const l=await this.posRewardersAmount(n,a[u],i[u],s[u]);for(let d=0;d<3;d+=1)c[d]=c[d].add(l[d].amount_owed)}return c}collectPosRewarderTransactionPayload(e,n=!1){const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.LiquidswapDeployer}::${Hs}`,o="collect_rewarder";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeC))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_address)),te.bcsSerializeU8(e.index),te.bcsSerializeUint64(e.pos_index)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coinTypeA,e.coinTypeB,e.coinTypeC],c=[e.pool_address,e.index,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}collectPoolRewarderTransactionPayload(e,n=!1){if(e.rewarder_nums===1){const o={pool_address:e.pool_address,index:0,pos_index:e.pos_index,coinTypeA:e.coinTypeA,coinTypeB:e.coinTypeB,coinTypeC:e.coinTypeC};return this.collectPosRewarderTransactionPayload(o,n)}const{modules:i}=this.sdk.sdkOptions.networkOptions,s=`${i.ClmmIntegrate}::${Gd}`;if(e.rewarder_nums===2){const o="collect_rewarder_for_two";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeC)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeD))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_address)),te.bcsSerializeUint64(e.pos_index)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD],c=[e.pool_address,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}if(e.rewarder_nums===3){const o="collect_rewarder_for_three";if(n){const u=[new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeB)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeC)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeD)),new D.TypeTagStruct(D.StructTag.fromString(e.coinTypeE))],l=[te.bcsToBytes(D.AccountAddress.fromHex(e.pool_address)),te.bcsSerializeUint64(e.pos_index)];return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,u,l))}const r=Ye(s,o),a=[e.coinTypeA,e.coinTypeB,e.coinTypeC,e.coinTypeD,e.coinTypeE],c=[e.pool_address,e.pos_index];return{type:"entry_function_payload",function:r,type_arguments:a,arguments:c}}}},gP=5*60*1e3,ec=24*60*60*1e3;function n0(t){return Date.parse(new Date().toString())+t}var mP=class{constructor(e){this._cache={},this._sdk=e}get sdk(){return this._sdk}async getOwnerTokenList(e,n,i=!1){const s="getAllRegisteredTokenList";if(!i){const d=this.getCacheData(s);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,r=`${o.TokenDeployer}::coin_list`,a="fetch_full_list",c=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(r,a,[],[te.bcsToBytes(D.AccountAddress.fromHex(n))])),u=await Qa(new vt(this.sdk.sdkOptions.rpcUrl),e,c),l=this.transformTokenData(u.changes);return this.updateCache(s,l,ec),l}async getTokenListByCoinType(e,n=0,i=20){const{fraphQLUrl:s}=this._sdk.sdkOptions;if(!s)throw Error("The fraphQLUrl is not configured in the SDK");const o={query:`query MyQuery {
  coin_infos(
  limit: ${i}, offset: ${n},  order_by: {name: desc}, where: {  coin_type: {_regex: "${e}"}}
  ) {
    coin_type
    symbol
    name
    decimals
    creator_address
    coin_type_hash
  }
}
`,variables:null,operationName:"MyQuery"},r=await Qs.post(s,o),a=[];return r.data.data.coin_infos.forEach(c=>{a.push({address:c.coin_type,symbol:c.symbol,official_symbol:c.symbol,decimals:c.decimals,name:c.name,coingecko_id:"",project_url:"",logo_url:""})}),a}async getSpecifyTokenListByCache(e){const n="getAllRegisteredTokenList",i=this.getCacheData(n),s=[];if(i!==null){const o=i;for(const r of e)for(const a of o)if(r===a.address){s.push(a);continue}}return s}async getAllRegisteredTokenList(e,n=!1){const i="getAllRegisteredTokenList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,o=`${s.TokenDeployer}::coin_list`,r="fetch_all_registered_coin_info",a=new vt(this.sdk.sdkOptions.rpcUrl),c=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r,[],[])),u=await Qa(a,e,c),l=this.transformTokenData(u.changes);return this.updateCache(i,l,ec),l}transformTokenData(e){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,s=e.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::coin_list::CoinList<${i.TokenDeployer}::coin_list::CoinInfo>`);if(s.length===0)return n;const r=s[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(er.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getAllRegisteredPoolList(e,n=!1){const i="getAllRegisteredPoolList";if(!n){const d=this.getCacheData(i);if(d!==null)return d}const{modules:s}=this._sdk.sdkOptions.networkOptions,o=`${s.TokenDeployer}::lp_list`,r="fetch_all_registered_coin_info",a=new vt(this.sdk.sdkOptions.rpcUrl),c=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r,[],[])),u=await Qa(a,e,c),l=this.transformPoolData(u.changes);return this.updateCache(i,l,ec),l}async getOwnerPoolList(e,n,i=!1){const s="getAllRegisteredPoolList";if(!i){const d=this.getCacheData(s);if(d!==null)return d}const{modules:o}=this._sdk.sdkOptions.networkOptions,r=`${o.TokenDeployer}::lp_list`,a="fetch_full_list",c=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(r,a,[],[te.bcsToBytes(D.AccountAddress.fromHex(n))])),u=await Qa(new vt(this.sdk.sdkOptions.rpcUrl),e,c),l=this.transformPoolData(u.changes);return this.updateCache(s,l,ec),l}transformPoolData(e){const n=[],{modules:i}=this._sdk.sdkOptions.networkOptions,s=e.filter(a=>a.type!=="write_resource"?!1:a.data.type===`${i.TokenDeployer}::lp_list::PoolList<${i.TokenDeployer}::lp_list::PoolInfo>`);if(s.length===0)return n;const r=s[0].data.data;return"full_list"in r&&r.full_list.value_list.forEach(a=>{const c={...a},u=a.extensions.data;for(const l of u){if(l.key==="labels")try{l.value=JSON.parse(decodeURIComponent(er.decode(l.value)))}catch{}c[l.key]=l.value}n.push(c)}),n}async getOwnerWarpPoolList(e,n,i=!1){const s=await this.getOwnerTokenList(n,e,i),o=await this.getOwnerPoolList(n,e,i),r=[];for(const a of o){for(const c of s)c.address===a.coin_a_address&&(a.coinA=c),c.address===a.coin_b_address&&(a.coinB=c);r.push(a)}return r}async getWarpPoolList(e,n=!1){const i=await this.getAllRegisteredTokenList(e,n),s=await this.getAllRegisteredPoolList(e,n),o=[];for(const r of s){for(const a of i)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);o.push(r)}return o}updateCache(e,n,i=gP){let s=this._cache[e];s?(s.overdueTime=n0(i),s.value=n):s=new hl(n,n0(i)),this._cache[e]=s}getCacheData(e){const n=this._cache[e];return n!==void 0&&n.getCacheData()?n.value:null}},_P=3e4,Rt={maxAmountOut:ge,isExceed:!1,path:[]};function i0(t,e){return{pair:`${t}-${e}`,reversePair:`${e}-${t}`}}function yP(t,e,n,i){const s=t.length;if(!t.length)throw new Error("routerTable is empty");if(s!==e.length)throw new Error("routerTable length not equal to feeRateArray length");let o=i?ge:new y(2).pow(new y(64)),r=[];const a=100/(t[0].length-1);switch(s){case 1:{o=t[0][t[0].length-1],n[0][n[0].length-1]||r.push({feeRate:e[0],percent:100});break}case 2:{for(let c=0;c<t[0].length;c+=1){const u=t[0].length-c-1,l=t[0][c].add(t[1][u]);if(l.gt(o)&&i||l.lt(o)&&!i)if(!n[0][c]&&!n[1][u])r=[],o=l,c>0&&r.push({feeRate:e[0],percent:c*a}),u>0&&r.push({feeRate:e[1],percent:u*a});else continue}break}case 3:{for(let c=0;c<t[0].length;c+=1)for(let u=0;u<t[0].length-c;u+=1){const l=t[0].length-c-u-1,d=t[0][c].add(t[1][u]).add(t[2][l]);if(d.gt(o)&&i||d.lt(o)&&!i){if(n[0][c]||n[1][u]||n[2][l])continue;r=[],o=d,c>0&&r.push({feeRate:e[0],percent:a*c}),u>0&&r.push({feeRate:e[1],percent:u*a}),l>0&&r.push({feeRate:e[2],percent:l*a})}}break}case 4:{for(let c=0;c<t[0].length;c+=1)for(let u=0;u<t[0].length-c;u+=1)for(let l=0;l<t[0].length-c-u;l+=1){const d=t[0].length-c-u-l-1,p=t[0][c].add(t[1][u]).add(t[2][l]).add(t[3][d]);if(p.gt(o)&&i||p.lt(o)&&!i){if(n[0][c]||n[1][u]||n[2][l]||n[3][d])continue;r=[],o=p,c>0&&r.push({feeRate:e[0],percent:a*c}),u>0&&r.push({feeRate:e[1],percent:u*a}),l>0&&r.push({feeRate:e[2],percent:l*a}),d>0&&r.push({feeRate:e[3],percent:d*a})}}break}}return r.length===0||o.eq(ge)?{maxAmountOut:ge,path:[],isExceed:!0}:{maxAmountOut:o,path:r,isExceed:!1}}var wP=class{constructor(e){this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new Gy,this._coinSymbolMap=new Map,this._coinAddressMap=new Map,this.poolAddressMap=new Map,this.poolMap=new Map,this.ticksMap=new Map,this._sdk=e,this.leastRefreshTime=Date.now(),this.createTxParams={partitionQuantities:[],swapDirects:[],poolAddresses:[],percents:[],totalAmounts:[],partner:"",amountLimit:"0",amountOut:"0",coinTypes:[]},this.splitUnit=50,this.poolDirectionMap=new Map,this.isInited=!1,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.splitSwap=this.splitSwap.bind(this),this.splitSwapForRouter=this.splitSwapForRouter.bind(this),this.splitSwapForRouters=this.splitSwapForRouters.bind(this),this.refreshPoolofSwapRouter=this.refreshPoolofSwapRouter.bind(this),this.getBestSplitResultInOnePair=this.getBestSplitResultInOnePair.bind(this),this.findBestSplitPriceWithOneSkip=this.findBestSplitPriceWithOneSkip.bind(this),this.findBestSplitPriceWithTwoSkip=this.findBestSplitPriceWithTwoSkip.bind(this),this.findBestSplitPriceWithThreeSkip=this.findBestSplitPriceWithThreeSkip.bind(this),this.findBestSplitPrice=this.findBestSplitPrice.bind(this),this.price=this.price.bind(this),this.routerSwap=this.routerSwap.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(e,n){const{pair:i,reversePair:s}=i0(e,n);let o=this.poolAddressMap.get(i);if(o!=null)return{addressMap:o,direction:!0};if(o=this.poolAddressMap.get(s),o!=null)return{addressMap:o,direction:!1}}async setCoinList(){this.coinProviders.coins.forEach(e=>{this._coinSymbolMap.set(e.symbol,e),this._coinAddressMap.set(e.address,e)})}loadGraph(){return this.pathProviders.forEach(e=>{const{paths:n}=e;n.forEach(i=>{var s,o;const r=(s=this.graph.getVertexByKey(i.base))!=null?s:new Xc(i.base),a=(o=this.graph.getVertexByKey(i.quote))!=null?o:new Xc(i.quote);this.graph.addEdge(new Ky(r,a));const c=this._coinSymbolMap.get(i.base),u=this._coinSymbolMap.get(i.quote);if(c!=null&&u!=null){const l=i0(i.base,i.quote).pair;this.poolAddressMap.set(l,i.addressMap)}})}),this}addPathProvider(e){return this.pathProviders.push(e),this}addCoinProvider(e){return this.coinProviders=e,this}tokenInfo(e){return this._coinAddressMap.has(e)?this._coinAddressMap.get(e):this._coinSymbolMap.get(e)}getCreateTxParams(){return this.createTxParams}isPoolDirectionSet(e){return this.poolDirectionMap.get(e)!=null}getPoolDirection(e){if(this.isPoolDirectionSet(e))return this.poolDirectionMap.get(e)}setPoolDirection(e,n){this.poolDirectionMap.set(e,n)}getBestSplitResultInOnePair(e,n,i,s,o,r){if(s.eq(ge))return{maxAmountOut:ge,path:[],isExceed:!1};console.log(s.toString());const a=[],c=[],u=[],l=this.getPoolAddressMapAndDirection(n,i),d=l==null?void 0:l.addressMap;if(d)for(const[p,g]of d.entries()){const b=this.poolMap.get(g),w=this.poolDirectionMap.get(g),T=o===w,E=this.ticksMap.get(g),k=new J2(s,e,b,T,r,E).computeSwap();r?a.push(k.amountOutArray):a.push(k.amountInArray),u.push(k.isExceed),c.push(p)}return yP(a.slice(0,4),c.slice(0,4),u.slice(0,4),r)}findBestSplitPriceWithOneSkip(e,n,i,s,o){const r={maxAmountOut:new y(0),path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},a=[],c=[],u=[],l=[];if(!o){let g=Rt,b=Rt;if(s){if(g=this.getBestSplitResultInOnePair(50,e[0][0],e[0][1],n,i[0][0],s),g.isExceed||(b=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],g.maxAmountOut,i[0][1],s),b.isExceed))return r.isExceed=!0,r;r.maxAmountOut=b.maxAmountOut}else{if(b=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],n,i[0][1],s),b.isExceed||(g=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],b.maxAmountOut,i[0][0],s),g.isExceed))return r.isExceed=!0,r;r.maxAmountOut=g.maxAmountOut}a.push(g.path),a.push([]),a.push(b.path);const w=[],T=[],E=[];g.path.forEach(V=>{var z;s?w.push(n.muln(V.percent).divn(100)):w.push(b.maxAmountOut.muln(V.percent).divn(100)),E.push(V.percent);const X=(z=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:z.addressMap.get(V.feeRate);T.push(X)});const P=[],k=[],S=[];b.path.forEach(V=>{var z;s?P.push(g.maxAmountOut.muln(V.percent).divn(100)):P.push(n.muln(V.percent).divn(100)),S.push(V.percent);const X=(z=this.getPoolAddressMapAndDirection(e[0][2],e[0][3]))==null?void 0:z.addressMap.get(V.feeRate);k.push(X)});let $=ge;w.forEach(V=>{$=$.add(V)});const H=ge;return P.forEach(V=>{H.add(V)}),c.push($.toString()),c.push(ge.toString()),u.push(E),u.push([]),u.push(S),l.push(T),l.push([]),l.push(k),r.totalAmounts=c,r.path=a,r.percents=u,r.poolAddresses=l,s?r.maxAmountOut=b.maxAmountOut:r.maxAmountOut=g.maxAmountOut,r.path.length||(r.isExceed=!0),r}let d=ge;s||(d=new y(2).pow(new y(64)));const p=Cc(n,this.splitUnit);for(let g=0;g<p.length;g+=1){const b=this.getBestSplitResultInOnePair(50,e[0][0],e[0][1],p[g],i[0][0],s);if(b.isExceed)continue;let w=Rt,T=Rt;if(s){if(w=this.getBestSplitResultInOnePair(50,e[1][0],e[1][1],p[p.length-g-1],i[1][0],s),w.isExceed||(T=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],w.maxAmountOut,i[1][1],s),T.isExceed))continue}else if(T=this.getBestSplitResultInOnePair(50,e[1][2],e[1][3],p[p.length-g-1],i[1][1],s),T.isExceed||(w=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],T.maxAmountOut,i[1][0],s),w.isExceed))continue;const E=[],P=[],k=[];b.path.forEach(v=>{var h;E.push(n.muln(g*this.splitUnit).divn(100).muln(v.percent).divn(100)),k.push(v.percent);const _=(h=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:h.addressMap.get(v.feeRate);P.push(_)});const S=[],$=[],H=[];w.path.forEach(v=>{var h;s?S.push(n.muln((p.length-g-1)*this.splitUnit).divn(100).muln(v.percent).divn(100)):S.push(T.maxAmountOut.muln(v.percent).divn(100)),H.push(v.percent);const _=(h=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:h.addressMap.get(v.feeRate);$.push(_)});const V=[],z=[],X=[];T.path.forEach(v=>{var h;s?V.push(w.maxAmountOut.muln(v.percent).divn(100)):V.push(n.muln((p.length-g-1)*this.splitUnit).divn(100).muln(v.percent).divn(100)),X.push(v.percent);const _=(h=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:h.addressMap.get(v.feeRate);z.push(_)});const L=[],B=[],O=[];if(T.maxAmountOut.add(b.maxAmountOut).gt(d)||w.maxAmountOut.add(b.maxAmountOut).lt(d)){s?d=T.maxAmountOut.add(b.maxAmountOut):d=w.maxAmountOut.add(b.maxAmountOut);let v=ge;E.forEach(_=>{v=v.add(_)});const h=ge;S.forEach(_=>{h.add(_)}),L.push(w.path),L.push(b.path),L.push(T.path),B.push(h.toString()),B.push(v.toString()),u.push(H),u.push(k),u.push(X),O.push($),O.push(P),O.push(z),r.maxAmountOut=d,r.path=L,r.totalAmounts=B,r.percents=u,r.poolAddresses=O,r.path.length||(r.isExceed=!0)}}return r}findBestSplitPriceWithTwoSkip(e,n,i,s,o){const r={maxAmountOut:ge,path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1},a=Cc(n,this.splitUnit);let c=ge;if(s||(c=new y(2).pow(new y(64))),!o){for(let u=0;u<a.length;u+=1){let l=Rt,d=Rt,p=Rt,g=Rt;if(s){if(l=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],a[u],i[1][0],s),l.isExceed||(d=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],l.maxAmountOut,i[1][1],s),d.isExceed)||(p=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],a[a.length-u-1],i[1][0],s),p.isExceed)||(g=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],p.maxAmountOut,i[1][1],s),g.isExceed))continue}else if(d=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],a[u],i[1][1],s),d.isExceed||(l=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],d.maxAmountOut,i[1][0],s),l.isExceed)||(g=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],a[a.length-u-1],i[1][1],s),g.isExceed)||(p=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],g.maxAmountOut,i[1][0],s),p.isExceed))continue;const b=[],w=[],T=[];l.path.forEach(h=>{var _;s?b.push(n.muln(u*this.splitUnit).divn(100).muln(h.percent).divn(100)):b.push(d.maxAmountOut.muln(h.percent).divn(100)),T.push(h.percent);const A=(_=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:_.addressMap.get(h.feeRate);w.push(A)});const E=[],P=[],k=[];d.path.forEach(h=>{var _;s?E.push(l.maxAmountOut.muln(h.percent).divn(100)):E.push(n.muln(u*this.splitUnit).divn(100).muln(h.percent).divn(100)),k.push(h.percent);const A=(_=this.getPoolAddressMapAndDirection(e[0][2],e[0][3]))==null?void 0:_.addressMap.get(h.feeRate);P.push(A)});const S=[],$=[],H=[];p.path.forEach(h=>{var _;s?S.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(h.percent).divn(100)):S.push(g.maxAmountOut.muln(h.percent).divn(100)),H.push(h.percent);const A=(_=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:_.addressMap.get(h.feeRate);$.push(A)});const V=[],z=[],X=[];g.path.forEach(h=>{var _;s?V.push(p.maxAmountOut.muln(h.percent).divn(100)):V.push(n.muln((a.length-u-1)*this.splitUnit).divn(100).muln(h.percent).divn(100)),X.push(h.percent);const A=(_=this.getPoolAddressMapAndDirection(e[1][1],e[1][2]))==null?void 0:_.addressMap.get(h.feeRate);z.push(A)});const L=[],B=[],O=[],v=[];if(d.maxAmountOut.add(g.maxAmountOut).gt(c)&&s||!s&&l.maxAmountOut.add(p.maxAmountOut).lt(c)){s?c=d.maxAmountOut.add(g.maxAmountOut):c=l.maxAmountOut.add(p.maxAmountOut);let h=ge;b.forEach(A=>{h=h.add(A)});let _=ge;S.forEach(A=>{_=_.add(A)}),L.push(l.path),L.push(d.path),L.push([]),L.push(p.path),L.push(g.path),B.push(h.toString()),B.push(_.toString()),B.push(ge.toString()),v.push(T),v.push(H),v.push([]),v.push(k),v.push(X),O.push(w),O.push($),O.push([]),O.push(P),O.push(z),r.maxAmountOut=c,r.percents=v,r.totalAmounts=B,r.path=L,r.poolAddresses=O}}return r.path.length||(r.isExceed=!0),r}for(let u=0;u<a.length;u+=1)for(let l=0;l<a.length-u-1;l+=1){const d=a.length-u-l-1,p=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],a[d],i[0][0],s);if(p.isExceed)continue;let g=Rt,b=Rt,w=Rt,T=Rt;if(s){if(g=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],a[l],i[1][0],s),g.isExceed||(b=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],g.maxAmountOut,i[1][1],s),b.isExceed)||(w=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],a[u],i[2][0],s),w.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],w.maxAmountOut,i[2][1],s),T.isExceed))continue}else if(b=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],a[l],i[1][1],s),b.isExceed||(g=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],b.maxAmountOut,i[1][0],s),g.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],a[u],i[2][1],s),T.isExceed)||(w=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],T.maxAmountOut,i[2][0],s),w.isExceed))continue;const E=[],P=[],k=[];g.path.forEach(x=>{var m;s?E.push(n.muln(l*this.splitUnit).divn(100).muln(x.percent).divn(100)):E.push(b.maxAmountOut.muln(x.percent).divn(100)),k.push(x.percent);const R=(m=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:m.addressMap.get(x.feeRate);P.push(R)});const S=[],$=[],H=[];b.path.forEach(x=>{var m;s?S.push(g.maxAmountOut.muln(x.percent).divn(100)):S.push(n.muln(l*this.splitUnit).divn(100).muln(x.percent).divn(100)),H.push(x.percent);const R=(m=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:m.addressMap.get(x.feeRate);$.push(R)});const V=[],z=[],X=[];w.path.forEach(x=>{var m;s?V.push(n.muln(u*this.splitUnit).divn(100).muln(x.percent).divn(100)):V.push(T.maxAmountOut.muln(x.percent).divn(100)),X.push(x.percent);const R=(m=this.getPoolAddressMapAndDirection(e[2][0],e[2][1]))==null?void 0:m.addressMap.get(x.feeRate);z.push(R)});const L=[],B=[],O=[];T.path.forEach(x=>{var m;s?L.push(w.maxAmountOut.muln(x.percent).divn(100)):L.push(n.muln(u*this.splitUnit).divn(100).muln(x.percent).divn(100)),O.push(x.percent);const R=(m=this.getPoolAddressMapAndDirection(e[2][2],e[2][3]))==null?void 0:m.addressMap.get(x.feeRate);B.push(R)});const v=[],h=[],_=[];p.path.forEach(x=>{var m;v.push(n.muln(d*this.splitUnit).divn(100).muln(x.percent).divn(100)),_.push(x.percent);const R=(m=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:m.addressMap.get(x.feeRate);h.push(R)});let A=ge;s?A=p.maxAmountOut.add(b.maxAmountOut).add(T.maxAmountOut):A=p.maxAmountOut.add(g.maxAmountOut).add(w.maxAmountOut);const C=[],M=[],N=[],F=[];if(A.gt(c)&&s||A.lt(c)&&!s){let x=ge;E.forEach(ye=>{x=x.add(ye)});let m=ge;V.forEach(ye=>{m=m.add(ye)});let R=ge;v.forEach(ye=>{R=R.add(ye)}),c=A,C.push(g.path),C.push(w.path),C.push(p.path),C.push(b.path),C.push(T.path),M.push(x.toString()),M.push(m.toString()),M.push(R.toString()),N.push(k),N.push(X),N.push(_),N.push(H),N.push(O),F.push(P),F.push(z),F.push(h),F.push($),F.push(B),r.maxAmountOut=A,r.path=C,r.totalAmounts=M,r.poolAddresses=F,r.percents=N}}return r.path.length||(r.isExceed=!0),r}findBestSplitPriceWithThreeSkip(e,n,i,s,o){const r={maxAmountOut:new y(0),path:[],totalAmounts:[],percents:[],poolAddresses:[],isExceed:!1};let a=ge;s||(a=new y(2).pow(new y(64)));const c=Cc(n,this.splitUnit);for(let u=0;u<c.length;u+=1)for(let l=0;l<c.length-u-1;l+=1)if(o)for(let d=0;d<c.length-u-l-1;d+=1){const p=c.length-u-l-d-1,g=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],c[d],i[0][0],s);let b=Rt,w=Rt,T=Rt,E=Rt,P=Rt,k=Rt;if(s){if(b=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],c[l],i[1][0],s),b.isExceed||(w=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],b.maxAmountOut,i[1][1],s),w.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],c[u],i[2][0],s),T.isExceed)||(E=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],T.maxAmountOut,i[2][1],s),E.isExceed)||(P=this.getBestSplitResultInOnePair(5,e[3][0],e[3][1],c[p],i[3][0],s),P.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[3][2],e[3][3],P.maxAmountOut,i[3][1],s),k.isExceed))continue}else if(w=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],c[l],i[1][1],s),w.isExceed||(b=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],w.maxAmountOut,i[1][0],s),b.isExceed)||(E=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],c[u],i[2][1],s),E.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],E.maxAmountOut,i[2][0],s),T.isExceed)||(k=this.getBestSplitResultInOnePair(5,e[3][2],e[3][3],c[p],i[3][1],s),k.isExceed)||(P=this.getBestSplitResultInOnePair(5,e[3][0],e[3][1],k.maxAmountOut,i[3][0],s),P.isExceed))continue;const S=[],$=[],H=[];b.path.forEach(We=>{var $e;s?S.push(n.muln(l*this.splitUnit).divn(100).muln(We.percent).divn(100)):S.push(w.maxAmountOut.muln(We.percent).divn(100)),H.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:$e.addressMap.get(We.feeRate);$.push(nt)});const V=[],z=[],X=[];w.path.forEach(We=>{var $e;s?V.push(b.maxAmountOut.muln(We.percent).divn(100)):V.push(n.muln(l*this.splitUnit).divn(100).muln(We.percent).divn(100)),X.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:$e.addressMap.get(We.feeRate);z.push(nt)});const L=[],B=[],O=[];T.path.forEach(We=>{var $e;s?L.push(n.muln(u*this.splitUnit).divn(100).muln(We.percent).divn(100)):L.push(E.maxAmountOut.muln(We.percent).divn(100)),O.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[2][0],e[2][1]))==null?void 0:$e.addressMap.get(We.feeRate);B.push(nt)});const v=[],h=[],_=[];E.path.forEach(We=>{var $e;s?v.push(T.maxAmountOut.muln(We.percent).divn(100)):v.push(n.muln(u*this.splitUnit).divn(100).muln(We.percent).divn(100)),_.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[2][2],e[2][3]))==null?void 0:$e.addressMap.get(We.feeRate);h.push(nt)});const A=[],C=[],M=[];P.path.forEach(We=>{var $e;s?A.push(n.muln(p*this.splitUnit).divn(100).muln(We.percent).divn(100)):A.push(k.maxAmountOut.muln(We.percent).divn(100)),M.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[3][0],e[3][1]))==null?void 0:$e.addressMap.get(We.feeRate);C.push(nt)});const N=[],F=[],x=[];k.path.forEach(We=>{var $e;s?N.push(P.maxAmountOut.muln(We.percent).divn(100)):N.push(n.muln(p*this.splitUnit).divn(100).muln(We.percent).divn(100)),x.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[3][2],e[3][3]))==null?void 0:$e.addressMap.get(We.feeRate);F.push(nt)});const m=[],R=[],ye=[];g.path.forEach(We=>{var $e;m.push(n.muln(d*this.splitUnit).divn(100).muln(We.percent).divn(100)),ye.push(We.percent);const nt=($e=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:$e.addressMap.get(We.feeRate);R.push(nt)});let ce=ge;s?ce=g.maxAmountOut.add(w.maxAmountOut).add(E.maxAmountOut).add(k.maxAmountOut):ce=g.maxAmountOut.add(b.maxAmountOut).add(T.maxAmountOut).add(P.maxAmountOut);const ue=[],Ne=[],Le=[],st=[];if(ce.gt(a)&&s||!s&&ce.lt(a)){let We=ge;S.forEach(Y=>{We=We.add(Y)});let $e=ge;L.forEach(Y=>{$e=$e.add(Y)});let nt=ge;A.forEach(Y=>{nt=nt.add(Y)});let Xn=ge;m.forEach(Y=>{Xn=Xn.add(Y)}),a=ce,ue.push(b.path),ue.push(T.path),ue.push(P.path),ue.push(g.path),ue.push(w.path),ue.push(E.path),ue.push(k.path),Ne.push(We.toString()),Ne.push($e.toString()),Ne.push(nt.toString()),Ne.push(Xn.toString()),Le.push(H),Le.push(O),Le.push(M),Le.push(ye),Le.push(X),Le.push(_),Le.push(x),st.push($),st.push(B),st.push(C),st.push(R),st.push(z),st.push(h),st.push(F),r.maxAmountOut=ce,r.path=ue,r.totalAmounts=Ne,r.percents=Le,r.poolAddresses=st}}else{const d=c.length-u-l-1;let p=Rt,g=Rt,b=Rt,w=Rt,T=Rt,E=Rt;if(s){if(p=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],c[l],i[0][0],s),p.isExceed||(g=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],p.maxAmountOut,i[0][1],s),g.isExceed)||(b=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],c[u],i[1][0],s),b.isExceed)||(w=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],b.maxAmountOut,i[1][1],s),w.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],c[d],i[2][0],s),T.isExceed)||(E=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],b.maxAmountOut,i[2][1],s),E.isExceed))continue}else if(g=this.getBestSplitResultInOnePair(5,e[0][2],e[0][3],c[l],i[0][1],s),g.isExceed||(p=this.getBestSplitResultInOnePair(5,e[0][0],e[0][1],g.maxAmountOut,i[0][0],s),p.isExceed)||(w=this.getBestSplitResultInOnePair(5,e[1][2],e[1][3],c[u],i[1][1],s),w.isExceed)||(b=this.getBestSplitResultInOnePair(5,e[1][0],e[1][1],w.maxAmountOut,i[1][0],s),b.isExceed)||(E=this.getBestSplitResultInOnePair(5,e[2][2],e[2][3],c[d],i[2][1],s),E.isExceed)||(T=this.getBestSplitResultInOnePair(5,e[2][0],e[2][1],w.maxAmountOut,i[2][0],s),T.isExceed))continue;const P=[],k=[],S=[];p.path.forEach(ce=>{var ue;s?P.push(n.muln(l*this.splitUnit).divn(100).muln(ce.percent).divn(100)):P.push(g.maxAmountOut.muln(ce.percent).divn(100)),S.push(ce.percent);const Ne=(ue=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:ue.addressMap.get(ce.feeRate);k.push(Ne)});const $=[],H=[],V=[];g.path.forEach(ce=>{var ue;s?$.push(p.maxAmountOut.muln(ce.percent).divn(100)):$.push(n.muln(l*this.splitUnit).divn(100).muln(ce.percent).divn(100)),V.push(ce.percent);const Ne=(ue=this.getPoolAddressMapAndDirection(e[0][2],e[0][3]))==null?void 0:ue.addressMap.get(ce.feeRate);H.push(Ne)});const z=[],X=[],L=[];b.path.forEach(ce=>{var ue;s?z.push(n.muln(u*this.splitUnit).divn(100).muln(ce.percent).divn(100)):z.push(w.maxAmountOut.muln(ce.percent).divn(100)),L.push(ce.percent);const Ne=(ue=this.getPoolAddressMapAndDirection(e[1][0],e[1][1]))==null?void 0:ue.addressMap.get(ce.feeRate);X.push(Ne)});const B=[],O=[],v=[];w.path.forEach(ce=>{var ue;s?B.push(b.maxAmountOut.muln(ce.percent).divn(100)):B.push(n.muln(u*this.splitUnit).divn(100).muln(ce.percent).divn(100)),v.push(ce.percent);const Ne=(ue=this.getPoolAddressMapAndDirection(e[1][2],e[1][3]))==null?void 0:ue.addressMap.get(ce.feeRate);O.push(Ne)});const h=[],_=[],A=[];T.path.forEach(ce=>{var ue;s?h.push(n.muln(d*this.splitUnit).divn(100).muln(ce.percent).divn(100)):h.push(E.maxAmountOut.muln(ce.percent).divn(100)),A.push(ce.percent);const Ne=(ue=this.getPoolAddressMapAndDirection(e[2][0],e[2][1]))==null?void 0:ue.addressMap.get(ce.feeRate);_.push(Ne)});const C=[],M=[],N=[];E.path.forEach(ce=>{var ue;s?C.push(T.maxAmountOut.muln(ce.percent).divn(100)):C.push(n.muln(d*this.splitUnit).divn(100).muln(ce.percent).divn(100)),N.push(ce.percent);const Ne=(ue=this.getPoolAddressMapAndDirection(e[2][2],e[2][3]))==null?void 0:ue.addressMap.get(ce.feeRate);M.push(Ne)});const F=[],x=[],m=[],R=[];let ye=ge;if(s?ye=g.maxAmountOut.add(w.maxAmountOut).add(E.maxAmountOut):ye=p.maxAmountOut.add(b.maxAmountOut).add(T.maxAmountOut),ye.gt(a)&&s||ye.lt(a)&&!s){let ce=ge;P.forEach(Le=>{ce=ce.add(Le)});let ue=ge;z.forEach(Le=>{ue=ue.add(Le)});let Ne=ge;h.forEach(Le=>{Ne=Ne.add(Le)}),a=ye,F.push(p.path),F.push(b.path),F.push(T.path),F.push([]),F.push(g.path),F.push(w.path),F.push(E.path),x.push(ce.toString()),x.push(ue.toString()),x.push(Ne.toString()),x.push(ge.toString()),m.push(S),m.push(L),m.push(A),m.push([]),m.push(V),m.push(v),m.push(N),R.push(k),R.push(X),R.push(_),R.push([]),R.push(H),R.push(O),R.push(M),r.maxAmountOut=ye,r.path=F,r.percents=m,r.totalAmounts=x,r.poolAddresses=R}}return r.path.length||(r.isExceed=!0),r}findBestSplitPrice(e,n,i,s,o,r){var a,c,u,l;let d=e.length,p=!1;e[0].length===2&&(p=!0,d-=1);let g={maxAmountOut:ge,path:[],poolAddresses:[],totalAmounts:[],percents:[],isExceed:!1},b={maxAmountOut:ge,path:[],isExceed:!1};const w=[],T=[];let E=ge;const P=[];switch(console.log(d,"skipNumber"),d){case 0:b=this.getBestSplitResultInOnePair(50,e[0][0],e[0][1],n,i[0][0],s),g.maxAmountOut=b.maxAmountOut,g.path.push(b.path),b.path.forEach(z=>{var X;const L=(X=this.getPoolAddressMapAndDirection(e[0][0],e[0][1]))==null?void 0:X.addressMap.get(z.feeRate);w.push(L);const B=n.muln(z.percent).divn(100);T.push(B),P.push(z.percent)}),T.forEach(z=>{E=E.add(z)}),g.percents.push(P),g.totalAmounts.push(E.toString()),g.poolAddresses.push(w);break;case 1:g=this.findBestSplitPriceWithOneSkip(e,n,i,s,p);break;case 2:g=this.findBestSplitPriceWithTwoSkip(e,n,i,s,p);break;case 3:g=this.findBestSplitPriceWithThreeSkip(e,n,i,s,p);break}if(g.isExceed)return g;const k=[];for(let z=0;z<g.path.length;z+=1){const{length:X}=g.path[z];k.push(X)}const S=[];if(d!==0)if(p){for(let X=1;X<1+d;X+=1){const L=[];if(k[X-1]>0)for(let B=0;B<k[X-1];B+=1)L.push(i[X][0]);S.push(L)}const z=[];for(let X=0;X<k[d];X+=1)if(k[d]>0)for(let L=0;L<k[d];L+=1)z.push(i[0][0]);S.push(z);for(let X=1;X<1+d;X+=1){const L=[];if(k[X+d]>0)for(let B=0;B<k[X+d];B+=1)L.push(i[X][1]);S.push(L)}}else{for(let z=0;z<d;z+=1){const X=[];if(k[z]>0)for(let L=0;L<k[z];L+=1)X.push(i[z][0]);S.push(X)}S.push([]);for(let z=0;z<d;z+=1){const X=[];if(k[z+d+1]>0)for(let L=0;L<k[z+d+1];L+=1)X.push(i[z][1]);S.push(X)}}else S.push([i[0][0]]);for(let z=0;z<g.poolAddresses.length;z+=1)for(let X=0;X<g.poolAddresses[z].length;X+=1){const L=this.getPoolDirection(g.poolAddresses[z][X]);L&&(S[z][X]=S[z][X]&&L)}const $=[],H=(a=this._coinSymbolMap.get(e[0][0]))==null?void 0:a.address;$.push(H);for(let z=0;z<e.length;z+=1)if(e[z].length!==2){const X=(c=this._coinSymbolMap.get(e[z][1]))==null?void 0:c.address;$.push(X)}if(e[0].length===2){const z=(u=this._coinSymbolMap.get(e[0][1]))==null?void 0:u.address;$.push(z)}else{const z=(l=this._coinSymbolMap.get(e[0][e[0].length-1]))==null?void 0:l.address;$.push(z)}const V=s?g.maxAmountOut.muln((1-o)*1e5).divn(1e5).toString():g.maxAmountOut.muln((1+o)*1e5).divn(1e5).toString();return this.createTxParams={partitionQuantities:k,swapDirects:S,poolAddresses:g.poolAddresses,totalAmounts:g.totalAmounts,percents:g.percents,amountLimit:V,amountOut:n.toString(),partner:r,coinTypes:$},g}async price(e,n,i,s,o,r){var a,c;const u=this.tokenInfo(e),l=this.tokenInfo(n);if(u===void 0||l===void 0)return;const d=this.graph.getVertexByKey(u.symbol),p=this.graph.getVertexByKey(l.symbol),g=this.graph.findAllPath(d,p),b=Array.from(g),w=[],T=[],E=[];for(let P=0;P<b.length;P+=1){const k=b[P];if(k.length>3)continue;const S=[],$=[];for(let H=0;H<k.length-1;H+=1){const V=k[H].value.toString(),z=k[H+1].value.toString(),X=(a=this.getPoolAddressMapAndDirection(V,z))==null?void 0:a.addressMap,L=(c=this.getPoolAddressMapAndDirection(V,z))==null?void 0:c.direction;X!==void 0&&L!==void 0&&($.push(L),S.push(V),S.push(z),X.forEach(B=>{w.push(B)}))}if(E.push($),T.push(S),S.length===2&&T.length>1){const H=T[0].slice();T[0]=S,T[T.length-1]=H;const V=E[0].slice();E[0]=$,E[T.length-1]=V}}return await this.refreshPoolofSwapRouter(w),this.findBestSplitPrice(T,i,E,s,o,r)}async routerSwap(e,n,i,s,o,r){const a=await this.price(e,n,i,s,o,r),c=this.getCreateTxParams();if(a.isExceed)return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:[],showRouters:[],gasFee:0};const u=this.splitSwapForRouters(c,s,!0),{simulationAccount:l}=this.sdk.sdkOptions.networkOptions,d=new vt(this.sdk.sdkOptions.rpcUrl),p=vr(l.address),g=await d.generateRawTransaction(p,u),b=vr(l.pubkey),w=new D.Ed25519PublicKey(b.toUint8Array()),T=await d.simulateTransaction(w,g),E=T[0].gas_used,P=T[0].gas_unit_price,k=parseInt(E,10)*parseInt(P,10),S=[];let $=ge;a.totalAmounts.forEach(V=>{$=$.add(new y(V))}),a.totalAmounts.forEach(V=>{let z;$.isZero()?z=0:z=Number(V)/Number($.toString())*100,S.push(z)});const H=[];for(let V=0;V<a.totalAmounts.length;V+=1){const z={amount:a.totalAmounts[V],poolAddress:[]};V===Math.floor(a.poolAddresses.length/2)?a.poolAddresses[V].length>0&&(z.poolAddress.push(a.poolAddresses[V]),H.unshift(z)):a.poolAddresses[V].length>0&&(z.poolAddress.push(a.poolAddresses[V],a.poolAddresses[V+Math.floor(a.poolAddresses.length/2)+1]),H.push(z))}return{maxAmountOut:a.maxAmountOut,path:a.path,poolAddresses:a.poolAddresses,percents:a.percents,totalAmounts:a.totalAmounts,isExceed:a.isExceed,totalPercents:S,showRouters:H,gasFee:k}}splitSwap(e,n,i=!1){const{modules:s}=this.sdk.sdkOptions.networkOptions,o=`${s.ClmmIntegrate}::${Gd}`,r=n?"exact_input_split_swap":"exact_output_split_swap",a=[];e.poolAddresses.forEach(p=>{const g=[];p.forEach(b=>{g.push(D.AccountAddress.fromHex(b))}),a.push(g)});const c=[te.bcsSerializeUint64(e.partitionQuantities[0]),te.serializeVectorWithFunc(e.swapDirects[0],"serializeBool"),iP(a[0]),te.serializeVectorWithFunc(e.percents[0],"serializeU64"),te.bcsSerializeUint64(parseInt(e.totalAmounts[0],10)),te.bcsSerializeUint64(parseInt(e.amountLimit,10)),te.bcsSerializeStr(e.partner)];if(i){const p=[];for(const g of e.coinTypes){const b=new D.TypeTagStruct(D.StructTag.fromString(g));p.push(b)}return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(o,r,p,c))}const u=Ye(o,r),l=e.coinTypes,d=[e.partitionQuantities[0],e.swapDirects[0],e.poolAddresses[0],e.percents[0],e.totalAmounts[0],e.amountLimit,e.partner];return{type:"entry_function_payload",function:u,type_arguments:l,arguments:d}}splitSwapForRouter(e,n,i,s=!1){const{modules:o}=this.sdk.sdkOptions.networkOptions,r=`${o.ClmmIntegrate}::${Gd}`,a=[];e.poolAddresses.forEach(p=>{const g=[];p.forEach(b=>{g.push(D.AccountAddress.fromHex(b))}),a.push(g)});const c=[te.serializeVectorWithFunc(e.partitionQuantities,"serializeU64"),Yf(e.swapDirects,"serializeBool"),nP(a),Yf(e.percents,"serializeU64"),te.serializeVectorWithFunc(e.totalAmounts,"serializeU64"),te.bcsSerializeUint64(parseInt(e.amountLimit,10)),te.bcsSerializeStr(e.partner)];if(s){const p=[];for(const g of e.coinTypes){const b=new D.TypeTagStruct(D.StructTag.fromString(g));p.push(b)}return new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(r,i,p,c))}const u=[e.partitionQuantities,e.swapDirects,e.poolAddresses,e.percents,e.totalAmounts,e.amountLimit,e.partner],l=Ye(r,i),d=e.coinTypes;return{type:"entry_function_payload",function:l,type_arguments:d,arguments:u}}splitSwapForRouters(e,n,i=!1){const{length:s}=e.partitionQuantities;let o;switch(s){case 3:n?o="exact_input_split_swap_for_router_three":o="exact_output_split_swap_for_router_three";break;case 5:n?o="exact_input_split_swap_for_router_four":o="exact_output_split_swap_for_router_four";break;case 7:n?o="exact_input_split_swap_for_router_five":o="exact_output_split_swap_for_router_five";break;default:return this.splitSwap(e,n,i)}return this.splitSwapForRouter(e,n,o,i)}findUnFetchPools(e){const n=[];for(const i of e)this.poolMap.get(i)==null&&n.push(i);return n}async refreshPoolofSwapRouter(e){var n,i,s;const o=Date.now();if(this.isInited){const a=this.findUnFetchPools(e);if(o-this.leastRefreshTime<_P&&a.length===0)return}else this.isInited=!0;const r=await this._sdk.Resources.getPools(e);for(let a=0;a<e.length;a+=1)if(this.poolMap.set(r[a].poolAddress,r[a]),this.getPoolDirection(r[a].poolAddress)==null){const c=(n=this._coinAddressMap.get(r[a].coinTypeA))==null?void 0:n.symbol,u=(i=this._coinAddressMap.get(r[a].coinTypeB))==null?void 0:i.symbol,l=(s=this.getPoolAddressMapAndDirection(c,u))==null?void 0:s.direction;this.poolDirectionMap.set(r[a].poolAddress,l);const d=await this._sdk.Fetcher.fetchTicks({pool:r[a].poolAddress,coinTypeA:r[a].coinTypeA,coinTypeB:r[a].coinTypeB}),p=ew(d);this.ticksMap.set(r[a].poolAddress,p)}this.leastRefreshTime=o}},bP=class{constructor(t){this._sdk=t}get sdk(){return this._sdk}transformTickData(t){const e=[],{modules:n}=this._sdk.sdkOptions.networkOptions,i=t.filter(r=>r.type!=="write_resource"?!1:r.data.type===`${n.FetcherDeployer}::fetcher::FetchTicksResult`);if(i.length===0)return{ticks:e,index:0,offset:0};const o=i[0].data.data;return{ticks:o.ticks||[],index:Number(o.index),offset:Number(o.offset)}}async getTicks(t){const{modules:e,simulationAccount:n}=this.sdk.sdkOptions.networkOptions,i=new vt(this.sdk.sdkOptions.rpcUrl),s=`${e.FetcherDeployer}::scripts`,o="fetch_ticks",r=[new D.TypeTagStruct(D.StructTag.fromString(t.coinTypeA)),new D.TypeTagStruct(D.StructTag.fromString(t.coinTypeB))],a=[te.bcsToBytes(D.AccountAddress.fromHex(t.pool)),te.bcsSerializeUint64(t.index),te.bcsSerializeUint64(t.offset),te.bcsSerializeUint64(t.limit)],c=new D.TransactionPayloadEntryFunction(D.EntryFunction.natural(s,o,r,a)),u=vr(n.address),l=await i.generateRawTransaction(u,c),d=vr(n.pubkey),p=new D.Ed25519PublicKey(d.toUint8Array()),g=await i.simulateTransaction(p,l);return this.transformTickData(g[0].changes)}async fetchTicks(t){let e=[],n=0,i=0;const s=512;for(;;){const o=await this.getTicks({pool:t.pool,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,index:n,offset:i,limit:s});if(e=[...e,...o.ticks],o.ticks.length<s)break;o.offset<999?(i=o.offset+1,n=o.index):(n=o.index+1,i=0)}return e}},vP=class{constructor(t){this.globalConfig={protocol_fee_rate:"",is_pause:!1},this._sdkOptions=t,this._client=new vt(t.rpcUrl),this._tokenClient=new j6(this._client),this._swap=new cP(this),this._position=new uP(this),this._resources=new hP(this),this._pool=new pP(this),this._rewarder=new fP(this),this._router=new wP(this),this._token=new mP(this),this._fetcher=new bP(this),this._launchpad=new K2(this),this.globalConfig.protocol_fee_rate=""}async getGlobalConfig(t=!1){return(this.globalConfig.protocol_fee_rate.length===0||t)&&(this.globalConfig=await this._resources.getGlobalConfig(this._sdkOptions.networkOptions.modules.LiquidswapDeployer)),this.globalConfig}get client(){return this._client}get tokenClient(){return this._tokenClient}get Swap(){return this._swap}get Position(){return this._position}get Pool(){return this._pool}get Resources(){return this._resources}get Rewarder(){return this._rewarder}get Token(){return this._token}get Router(){return this._router}get Fetcher(){return this._fetcher}get Launchpad(){return this._launchpad}get sdkOptions(){return this._sdkOptions}};function $t(t,e){const n=dp(e);return ze(t).div(n).toString()}function sn(t,e){const n=dp(e);return ze(t).mul(n)}function TP(t){const e=t.split("x");let n=t;return e[1][0]==="0"&&(n=e[0]+"x"+e[1].slice(1)),n}const z5=(t,e)=>JSON.stringify(t)===JSON.stringify(e),s0=t=>{switch(t){case"account":return"account";case"token":return"";case"nftAddress":return"token";case"tx":return"txn";case"poolAddress":return"account"}},AP=t=>{switch(t){case"account":return"address";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"object"}},sw=t=>{switch(t){case"account":return"address";case"token":return"object";case"tx":return"tx";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}},o0=t=>{switch(t){case"account":return"account";case"token":return"object";case"tx":return"txblock";case"poolAddress":return"object";case"nftAddress":return"object";case"coin":return"coin"}};function H5(){const e=(localStorage.getItem("theme")||"sui")=="sui"?"Sui":"Aptos";return localStorage.getItem(`${e}-currentExplorerName`)||Sd[e][0].name}function Qc(t,e,n){const i=localStorage.getItem("theme")||"sui",s=i=="sui"?"Sui":"Aptos";console.log(t,"url###111");const o=t.indexOf("suivision")>-1?"SuiVision":t.indexOf("suiscan")>-1?"Suiscan":"";console.log(t,o,"url##");const r=ke[s].network;let a;return s=="Aptos"?e=="nftAddress"?a=`${t}/${s0(e)}/${n}/0?network=${r}`:a=`${t}/${s0(e)}/${n}?network=${r}`:o=="SuiVision"?a=`${t}/${o0(e)}/${n}`:o=="Suiscan"?a=`${t}/${r}/${sw(e)}/${n}`:a=`${t}/${AP(e)}/${n}?network=${r}`,console.log("href, chain, chainName, url, urlName, network==>",e,o0(e),a,i,s,t,o,r),a}function K5(t,e){const n="Sui",i=Sd[n][2].link,s=Sd[n][2].name,o=ke[n].network;let r;return s=="Suiscan"&&(r=`${i}/${o}/${sw(t)}/${e}`),r}function eu(t,e){const n=dp(ze(e));return Number(ze(t).mul(n))}function G5(t){const e=t.toString(),n=e.indexOf(".");if(n!==-1){for(let i=n+1;i<e.length;i++)if(e[i]!=="0")return i-n-1}return-1}function W5(t,e){let n=t,i=e;if(t.includes("sui::SUI")&&t.includes("sui::SUI")){if(t.slice(-10)===e.slice(-10))return!0}else return t[2]=="0"&&(n=t.slice(0,2)+t.slice(3)),e[2]=="0"&&(i=e.slice(0,2)+e.slice(3)),(n==null?void 0:n.toLowerCase())==(i==null?void 0:i.toLowerCase());return!1}const V5=t=>ie.isDecimal(t)?t:new ie(t===void 0?0:t),kP=(t,e,n=!0)=>{if(`${t}`=="0")return!parseFloat(e)||!n?0:"0.".padEnd(e+2,"0");if(!t)return"--";const i=parseFloat(t),s=t.toString(),o=i<0;let r=s;if(s.toLowerCase().includes("e")){const a=s.match(/(\d+?)(?:\.(\d*))?e([+-])(\d+)/),c=a[1],u=a[2],l=a[3],d=a[4];let p="",g=u?u.substr(d):"";if(g&&(g=`.${g}`),l!=="-"){for(let b=0;b<d;b+=1){const w=u[b]||"0";p+=w}r=c+p+g}else{let b="0";for(let w=0;w<d;w+=1)p=(c[c.length-w-1]||"0")+p;c.length>d&&(b=c.substr(0,c.length-d)),r=`${b}.${p}${u}`}}if(e&&n){let a=`${r.split(".")[0]}.`;const c=r.split(".")[1]||"";for(let u=0;u<e;u+=1)a+=c[u]||"0";r=a}if(r.length>14){const a=r.split(".");a[0].length>14?r=`${a[0].slice(0,14)}+`:(r=r.slice(0,13),r.indexOf(".")===12&&(r=r.slice(0,12)))}return`${o?"-":""}${r}`};function Et(t,e){if(e=e>-1?e:0,`${t}`=="0")return parseFloat(e)?"0.".padEnd(e+2,"0"):"0";if(!t)return"--";let n=!1;parseFloat(t)<0&&(n=!0);const i=`${Math.abs(parseFloat(t))}`;if(i==="NaN")return"--";let s=i;if(i.toLowerCase().includes("e")){if(i.toLowerCase().includes("+"))return kP(i,e);const r=i.toLowerCase().split("e");let a=r[0];const c=Math.abs(parseFloat(r[1]));let u="",l=a.length,d;for(r[0].split(".")[1]&&(a=r[0].split(".")[0]+r[0].split(".")[1],l=r[0].split(".")[0].length),d=0;d<c-l;d+=1)u+="0";s=`0.${u}${a}`}if(`${e}`!="0"&&!e||`${parseFloat(t)}`=="NaN")return(n?"-":"")+s;const o=s.split(".");if(e===0)s=parseInt(s,10);else if(e>0&&o[1])if(o[1].length>e)if(o[1].includes("999999999")){const r=parseFloat(s).toFixed(e+1);s=r.slice(0,r.length-1)}else s=`${o[0]}.${o[1].slice(0,e)}`;else s=parseFloat(s).toFixed(e);else s=parseFloat(s).toFixed(e);if(s.length>=14&&s.includes(".")){const r=s.split(".");r[0].length>14?s=`${r[0].slice(0,14)}+`:(s=s.slice(0,13),s.indexOf(".")===12&&(s=s.slice(0,12)))}return(n?"-":"")+s}function SP(t,e){const n=String(t);if(!n.includes("."))return n;const i=n.split("."),s=i[0],o=i[1].slice(0,e);return Ks(o)?`${s}.${Ks(o)}`:`${s}`}function Ks(t){return t.replace(/(\s|0|\.)+$/g,"")}function Cs(t,e){if(typeof t=="number"&&isNaN(t)||!Number(t))return 0;if(!String(t).includes("."))return t;const n=String(t).split(".");if(n[1]&&n[1].length<=e&&Number(n[1]))return t;const i=Math.pow(10,-e);if(Number(t)<i)return n[1]&&Ks(n[1])?n[0]+"."+Ks(n[1]):n[0];const s=SP(t,e),o=String(s).split(".");return s==="--"?"--":o[1]&&Ks(String(o[1]))?o[0]+"."+Ks(String(o[1])):o[0]}const xP=(t,e=0)=>isNaN(t)||!t?t:(t=String(t),Number(t)==0?0:!isNaN(e)&&e?(e===0&&(t=t.split(".")[0]),t.replace(/(\d+)(\.\d+)?/,(n,i,s)=>i.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+(s?s.slice(0,e+1):""))):t.replace(/^\d+/,n=>n.replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")));function PP(t,e){const i=String(t).split(".");let s=!0;if(!i[1]||i[1]&&i[1].length<=e||i[0]!=="0")return!1;if(i&&i[1]&&i[0]==="0"&&i[1][i[1].length-1]==="1")for(let o=0;o<i[1].length-1;o++)i[1]!=="0"&&(s=!1);else s=!1;return s}function EP(t){const e=String(t);if(!e.includes("."))return t;const n=e.split("."),i=n[0],s=Ks(n[1]);return s&&`${i}.${s}`}const $i=(t,e,n=2)=>{if(t=="∞"||typeof t=="string"&&t.indexOf("+")>-1)return t;if(isNaN(t)||Number(t)==0)return"0";const i=Cs(t,e),s=Math.pow(10,-e);return Number(i)&&Math.abs(Number(i))<=s||PP(i,e)?$i(t,e+n):EP(i)};function X5(t){if(t){const e=t.toString(),n=e.indexOf(".")>-1?/(\d)(?=(\d{3})+\.)/g:/(\d)(?=(?:\d{3})+$)/g;return e.replace(n,"$1,")}}function CP(t){return Object.keys(t).length===0}function Zi(t){return t.toString().length===1?"0"+t:t}function r0(t){const e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return e+"-"+Zi(n)+"-"+Zi(i)}function BP(t){const e=t.getMonth()+1,n=t.getDate();return Zi(e)+"/"+Zi(n)}function a0(t){const e=t.getHours(),n=t.getMinutes(),i=t.getSeconds();return Zi(e)+":"+Zi(n)+":"+Zi(i)}function IP(t){const e=t.getHours(),n=t.getMinutes();return Zi(e)+":"+Zi(n)}const J5=(t,e)=>{if(t){const n=new Date(Number(t));if(!e)return r0(n)+" "+a0(n);switch(e){case"HMS":return a0(n);case"YMD":return r0(n);case"MD":return BP(n);case"HM":return IP(n)}}},Z5=(t,e)=>isNaN(t)||!t?t:Number(t)<1e-6&&Number(t)!==0?"<0.000001":xP(Cs(String(t),e),e);function Y5(t){const e=t.replace("%","");return Number(e)}function Q5(t,e=1){return!t||isNaN(Number(t))?t:Math.abs(String(t))<1e3?$i(t,e):$i(Number(t)/1e3,e)+"k"}const zo=async t=>new Promise(e=>{setTimeout(()=>{e(1)},t)}),eR=t=>t>=1e9?(t/1e9).toFixed(1)+"b":t>=1e6?(t/1e6).toFixed(1)+"m":t>=1e3?(t/1e3).toFixed(1)+"k":t.toString();function tR(t){const e=Number($i(t,2));return e>=1e9?(e/1e9).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"b":e>=1e6?(e/1e6).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g,",")+"m":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const nR=(t,e)=>t>=1e9?(t/1e9).toFixed(e)+"b":t>=1e6?(t/1e6).toFixed(e)+"m":t>=1e3?(t/1e3).toFixed(e)+"k":t.toString(),iR=t=>{const e=Math.floor(t/1e3),n=Math.floor(new Date().getTime()/1e3),i=60,s=60*i,o=24*s,r=30*o,a=365*o,c=n-e;if(c<i)return"recently";if(c<s){const u=Math.floor(c/i);return u==1?`${u} minute ago`:`${u} minutes ago`}else if(c<o){const u=Math.floor(c/s);return u==1?`${u} hour ago`:`${u} hours ago`}else if(c<r){const u=Math.floor(c/o);return u==1?`${u} day ago`:`${u} days ago`}else if(c<a){const u=Math.floor(c/r);return u==1?`${u} mouth ago`:`${u} mouths ago`}else{const u=Math.floor(c/a);return u==1?`${u} year ago`:`${u} years ago`}};var OP=Db();const RP=U0(OP),$P=-443636;function sR(t,e){const n=UP(t),i=(n-$P)%e;return i>e/2?n-i+e:n-i}const ow=new ie("1.0001");function UP(t){return t.log(ow).toDP(0,ie.ROUND_HALF_UP).toNumber()}function oR(t){return ow.pow(t)}function Bc(t,e,n){const i=Math.abs(t)%e;return t>0?i>e/2||n&&e<=2?t+e-i:t-i:i>e/2?t-e+i:t+i}function MP(){const t=ke.Aptos.liquidswapDeployer,e={rpcUrl:localStorage.getItem("Aptos-currentRpclocal2")||ke.Aptos.rpcUrl,fraphQLUrl:ke.Aptos.fraphQLUrl,networkOptions:{nativeToken:"0x1::aptos_coin::AptosCoin",launchpad:{cetusLaunchpad:ke.Aptos.Launchpad,crowdCoin:ke.Aptos.LaunchpadCrowdCoin},simulationAccount:{pubkey:ke.Aptos.accountPublicKey,address:ke.Aptos.accountAddress},modules:{LiquidswapDeployer:t,ClmmIntegrate:ke.Aptos.clmmIntegrate,FetcherDeployer:ke.Aptos.fetcher,TokenDeployer:ke.Aptos.TokenDeployer,IntegerMate:ke.Aptos.IntegerMate}}},n=Dc(new vP(e)),i=ph(),s=D0(),o=Go(()=>s),r=Go(()=>o.value.currentExplorer),{$notify:a}=ea(),c=Y=>{const{$notify:oe}=ea();oe.success({key:Y.hash+"loading",icon:Ge("img",{class:{"notify-icon":!0,"loading-animate":!0},src:o.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:Y.title},null)]),description:Ge("div",{class:"notification-title"},[Ge("div",{class:"notification-text",innerHTML:Rn.global.t("newAdd.confirmingTransaction")},null),Ge("a",{href:Qc(r.value,"tx",Y.hash),target:"_blank",innerHTML:Rn.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},u=Y=>{a.success({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-icon-change1"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:`${Y.title} `+Rn.global.t("newAdd.success")},null)]),description:Ge("div",{class:"notification-title"},[Ge("div",{class:"notification-text",innerHTML:Y.desc},null),Ge("a",{href:Qc(r.value,"tx",Y.hash),target:"_blank",innerHTML:Rn.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},l=Y=>{a.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:`${Y} `+Rn.global.t("newAdd.failed")},null)]),description:Rn.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},d=async(Y,oe=!1)=>{const we=await n.client.waitForTransactionWithResult(Y.hash);if(console.log("watchTransaction###res###",we),we&&we.success){a.close(Y.hash+"loading"),console.log("watchTransaction#####success"),u(Y);const de={walletAddress:i.address,chainName:"Aptos",...Y,...we,date:new Date().getTime()+6048e5};return s.setTransactionList(de),oe?{status:!0,nftInfo:we.events.filter(Be=>Be.type.includes("CreateTokenDataEvent"))}:!0}else{if(we&&!we.success)return a.close(Y.hash+"loading"),console.log("watchTransaction#####error"),l(Y.title),!1;console.log("watchTransaction#####one more"),setTimeout(()=>d(Y,oe),3e3)}},p=async(Y,oe=!1)=>{const we=await n.client.waitForTransactionWithResult(Y.hash);if(console.log("watchTransaction###res###",we),we&&we.success){console.log("watchTransaction#####success");const de={walletAddress:i.address,chainName:"Aptos",...Y,...we,date:new Date().getTime()+6048e5};s.setTransactionList(de)}},g=async Y=>{try{const oe=await n.Resources.getCoinStores(Y),we=[];return oe.forEach(de=>{let Ae="";de.coinAddress.includes("0x0000000000000000000000000000000000000000000000000000000000000001")?Ae=de.coinAddress.replace(/0x0000000000000000000000000000000000000000000000000000000000000001/,"0x1"):Ae=de.coinAddress,we.push({...de,coinAddress:Ae})}),we}catch{return[]}},b=async Y=>{try{i.setLoading(!0);const oe=await g(Y),we={};oe.forEach(de=>{const Ae=de?de.coin.value:"0";we[de.coinAddress]={...de,balance:Ae}}),console.log("1212###assets####",we),i.setAssets(we),i.setLoading(!1)}catch(oe){console.log("getAccount##error###",oe),i.setLoading(!1),i.setAssets({})}},w=async()=>{const Y={pubkey:yi(ke.Aptos.accountPublicKey),address:yi(ke.Aptos.accountAddress)},oe=await n.Token.getAllRegisteredTokenList(Y);return console.log("0215####tokenList####",oe),oe},T=async(Y,oe,we)=>n.Resources.getPoolState(Y,oe,we),E=async Y=>{const oe={pubkey:yi(ke.Aptos.accountPublicKey),address:yi(ke.Aptos.accountAddress)};return await n.Token.getOwnerWarpPoolList(ke.Aptos.TokenDeployer,oe)},P=async Y=>await n.Resources.getPool(Y);return{setTransations:p,showTransitionPending:c,showTransitionSuccess:u,showTransitionError:l,watchTransaction:d,getAccount:b,getPoolState:T,getPools:async Y=>await n.Resources.getPools(Y),getPool:P,registerCoin:Y=>({function:"0x1::managed_coin::register",type_arguments:[Y],arguments:[],type:"entry_function_payload"}),estLiquidityAndcoinAmountFromOneAmounts:Y=>{console.log("estLiquidityAndcoinAmountFromOneAmounts###params####",Y);const{tokenA:oe,tokenB:we,lowerTick:de,upperTick:Ae,coinAmount:He,iscoinA:Be,roundUp:Me,slippage:q,curSqrtPrice:j}=Y,K=ni.estLiquidityAndcoinAmountFromOneAmounts(de,Ae,He,Be,Me,q,j),J=oe.decimals,Q=we.decimals,{tokenMaxA:ne,tokenMaxB:pe,liquidityAmount:ee}=K;return{tokenMaxAOrigin:ne.toString(),tokenMaxBOrigin:pe.toString(),tokenMaxA:$t(ne.toString(),J),tokenMaxB:$t(pe.toString(),Q),liquidityAmount:ee}},getCoinAmountFromLiquidity:Y=>{const{pool:oe,position:we,roundUp:de}=Y,Ae=Number(we.tick_lower_index),He=Number(we.tick_upper_index),Be=pt.tickIndexToSqrtPriceX64(Ae),Me=pt.tickIndexToSqrtPriceX64(He),q=ni.getCoinAmountFromLiquidity(new y(we.liquidity),new y(oe.current_sqrt_price),Be,Me,de),j=$t(q.coinA.toString(),oe.coinA.decimals),K=$t(q.coinB.toString(),oe.coinB.decimals);return{coinaAmount:j,coinbAmount:K}},getAddLiquidityTransactionPayload:async Y=>{const{pool:oe,amount:we,fix_amount_a:de,roundUp:Ae,tick_lower:He,tick_upper:Be,index:Me,slippage:q}=Y;console.log(Y,"===>params411");const j=await P(oe.poolAddress),K=de?sn(we,oe.token_a.decimals):sn(we,oe.token_b.decimals),J=pt.sqrtPriceX64ToTickIndex(new y(j.current_sqrt_price));let Q,ne;if(J>=He&&J<=Be){const ee=ni.estLiquidityAndcoinAmountFromOneAmounts(He,Be,new y(K.toString()),de,Ae,q,new y(j.current_sqrt_price));Q=de?K.toNumber():ee.tokenMaxA.toNumber(),ne=de?ee.tokenMaxB.toNumber():K.toNumber()}else J>Be?(Q=0,ne=K.toNumber()):J<He&&(Q=K.toNumber(),ne=0);return n.Position.createAddLiquidityTransactionPayload({pool:oe.poolAddress,coinTypeA:oe.token_a.address,coinTypeB:oe.token_b.address,amount_a:Q,amount_b:ne,fix_amount_a:de,tick_lower:He,tick_upper:Be,is_open:!Me,index:Me})},getRemoveLiquidityTransactionPayload:async Y=>{const{pool:oe,coinTypeA:we,coinTypeB:de,coinTypeC:Ae,coinTypeD:He,coinTypeE:Be,position:Me,delta_liquidity:q,rewards_num:j}=Y;console.log("getRemoveLiquidityTransactionPayload####delta_liquidity#####",q.toString());const K=await P(oe.poolAddress),J={...oe,...K},Q=Number(Me.tick_lower_index),ne=Number(Me.tick_upper_index),pe=pt.tickIndexToSqrtPriceX64(Q),ee=pt.tickIndexToSqrtPriceX64(ne),me=ni.getCoinAmountFromLiquidity(q,new y(J.current_sqrt_price),pe,ee,!0),ve=ze(me.coinA.toString()).mul(ze(1-Y.slippage/100)),se=ze(me.coinB.toString()).mul(ze(1-Y.slippage/100));return await n.Position.removeLiquidityTransactionPayload({pool:oe.poolAddress,coinTypeA:we,coinTypeB:de,coinTypeC:Ae,coinTypeD:He,coinTypeE:Be,delta_liquidity:q,min_amount_a:Number(Et(ve.toString(),0)),min_amount_b:Number(Et(se.toString(),0)),pos_index:Y.position.index,is_close:!1,rewards_num:j})},getCollectFeeTransactionPayload:async Y=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:Y.pool.poolAddress,coinTypeA:Y.pool.token_a.address,coinTypeB:Y.pool.token_b.address,pos_index:Y.position.index});const oe=await n.Position.collectFeeTransactionPayload({pool:Y.pool.poolAddress,coinTypeA:Y.pool.token_a.address,coinTypeB:Y.pool.token_b.address,pos_index:Y.position.index});return console.log("1130###getCollectFeeTransactionPayload###result##",oe),oe},getPositionList:async(Y,oe)=>{if(ke.Aptos.network==="mainnet"){const we={operationName:"AccountTokensData",variables:{owner_address:Y,limit:1e5,offset:0},query:`query AccountTokensData($owner_address: String, $limit: Int, $offset: Int) {
  current_token_ownerships(
    where: {owner_address: {_eq: $owner_address}, amount: {_gt: "0"}}
    limit: $limit
    offset: $offset
  ) {
    token_data_id_hash
 creator_address
 name
    collection_name
  table_type
    property_version
    amount
    __typename
  }
}`},de=await $fetch("https://indexer.mainnet.aptoslabs.com/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(we)});console.log("0116###pools####",oe);const Ae=de&&de.data&&de.data.current_token_ownerships||[];console.log("###list",Ae);const He=[];for(let Be=0;Be<Ae.length;Be++){const Me=Ae[Be],q=oe[TP(Me.creator_address)];if(console.log(q,"##pool"),q){const j=Me.name.split("-")[1],K=q.positions_handle,J=await n.Resources.getPositionInfoByIndex(K,j);He.push({...J,tokenName:Me.name})}}return console.log("0221###aptos###getPositionList###",He),He}else{const we=Object.values(oe);console.log(we,"###poolList");const de=await n.Resources.getPositionList(Y,we);return console.log("0221###aptos###getPositionList###list###",de),de}},getPositionInfo:async(Y,oe,we,de="")=>({...await n.Resources.getPositionInfo(Y,we),tokenName:we,collectionName:oe}),getSwapTransactionPayload:async Y=>{const{pool:oe,a2b:we,byAmountIn:de,amount:Ae,slippage:He}=Y,Be=oe.poolAddress||oe.address,Me=oe.token_a.decimals,q=oe.token_b.decimals,j=await P(oe.address);let K;we&&de||!we&&!de?K=sn(Ae,Me):K=sn(Ae,q);const J=await n.Swap.preswap({pool:j,decimalsA:Me,decimalsB:q,a2b:we,by_amount_in:de,amount:K.toString()});console.log("1130###getSwapTransactionPayload###preSwapRes###",J),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountOut###",J.estimatedAmountOut.toString()),console.log("1130###getSwapTransactionPayload###preSwapRes.estimatedAmountIn###",J.estimatedAmountIn.toString());const Q=ze(J.estimatedAmountOut.toString()),ne=ze(J.estimatedAmountIn.toString()),pe=de?Q.sub(Q.mul(He)):ne.add(ne.mul(He));console.log("1130###amountLimit####",pe.toString()),console.log("1130###swap##params###",{pool_addr:Be,coinTypeA:oe.token_a.address,coinTypeB:oe.token_b.address,a_to_b:J.aToB,by_amount_in:J.byAmountIn,amount:J.amount.toString(),amount_limit:Et(pe.toString(),0)||""});const ee=n.Swap.createSwapTransactionPayload({pool_addr:Be,coinTypeA:oe.token_a.address,coinTypeB:oe.token_b.address,a_to_b:J.aToB,by_amount_in:J.byAmountIn,amount:J.amount.toString(),amount_limit:Et(pe.toString(),0)||"",partner:""});return console.log("1130###swap##result###",ee),ee},getCoin:Y=>({type:"entry_function_payload",function:"0x84dc9d921d277db5047dcb17addc2ecfbddfad087dd4ea825b2d17785755cb29::cetus_faucet",arguments:[],type_arguments:[]}),preSwap:async Y=>{const{pool:oe,a2b:we,byAmountIn:de,amount:Ae}=Y;console.log(Y,"===>params");const He=oe.coinA.decimals,Be=oe.coinB.decimals;let Me=oe;oe.coinTypeA||(Me={...oe,poolAddress:oe.address,coinTypeA:oe.coinA.address,coinTypeB:oe.coinB.address});let q;we&&de||!we&&!de?q=sn(Ae,He):q=sn(Ae,Be);const j=await n.Swap.preswap({pool:Me,decimalsA:He,decimalsB:Be,a2b:we,by_amount_in:de,amount:q.toString()});return{...j,estimatedAmountIn:Cs($t(j.estimatedAmountIn.toString(),we?He:Be),we?He:Be),estimatedAmountOut:Cs($t(j.estimatedAmountOut.toString(),we?Be:He),we?Be:He),priceImpactPct:Et(j.priceImpactPct,2)}},getTicks:async Y=>{try{return await n.Fetcher.fetchTicks({pool:Y.poolAddress,coinTypeA:Y.coinTypeA,coinTypeB:Y.coinTypeB})}catch(oe){console.log("getTicks Error###",oe)}},TickMath:pt,TickUtil:Wd,ClmmPoolUtil:ni,getNearestTickByTick:Bc,getTickDataFromUrlData:ew,getCollectFeesQuote:async Y=>{console.log(Y,"params====>");const{pool:oe,position:we,tickLowerData:de,tickUpperData:Ae}=Y,He=z2({clmmpool:oe,position:we,tickLower:de,tickUpper:Ae}),Be=$t(He.feeOwedA.toString(),oe.token_a.decimals),Me=$t(He.feeOwedB.toString(),oe.token_b.decimals);return console.log("0118###useApots###result.feeOwedA.toString()###",He.feeOwedA.toString()),console.log("0118###useApots###result.feeOwedB.toString()###",He.feeOwedB.toString()),console.log("0118###useApots###feeOwedA###",Be),console.log("0118###useApots###feeOwedB###",Me),{feeOwedA:Number(Be)>99999999999||Number(Be)<0?"0":Be,feeOwedB:Number(Me)>99999999999||Number(Me)<0?"0":Me}},mintCoin:Y=>({function:`${ke.Aptos.faucetObjectId}::coin::mint`,type_arguments:[`${ke.Aptos.faucetObjectId}::coin::${Y.name}`],arguments:[Y.amount],type:"entry_function_payload"}),getNftHash:Y=>{const oe=`${Y.creator}::${Y.collection}::${Y.name}`;return RP(oe).toString()},getCollectRewarderTransactionPayload:Y=>n.Rewarder.collectPoolRewarderTransactionPayload(Y),getPosRewardersAmount:async Y=>{console.log(JSON.stringify(Y),"=====>params792");const{poolAddress:oe,positionName:we,tickLowerData:de,tickUpperData:Ae}=Y;return await n.Rewarder.posRewardersAmount(oe,we,de,Ae)},getTokenList:w,getTickDataByIndex:async(Y,oe)=>(console.log(Y,oe,"getTickDataByIndex"),await n.Resources.getTickDataByIndex(Y,oe)),initSwapRouter:async Y=>{n.Router.addPathProvider(Y),await n.Router.setCoinList({pubkey:yi(ke.Aptos.accountPublicKey),address:yi(ke.Aptos.accountAddress)}),await n.Router.loadGraph()},getSwapRouter:async(Y,oe)=>await n.Router.price(Y,oe),getEstPositionAPRWithDelta:async(Y,oe,we,de,Ae,He,Be,Me,q,j,K,J,Q,ne,pe,ee,me,ve,se,_e,Fe,Oe,De,it)=>await j2(Y,oe,we,de,Ae,He,Be,Me,q,j,K,J,Q,ne,pe,ee,me,ve,se,_e,Fe,Oe,De,it),getPriceImpactPct:(Y,oe,we)=>{const de=pt.sqrtPriceX64ToPrice(new y(Y.current_sqrt_price),Y.coinA.decimals,Y.coinB.decimals).toNumber(),Ae=we?de:1/de,He=Math.abs(Ae-Number(oe))/Number(Ae)*100;return Number(Et(He,2))},getLpList:E,getEstPositionAPRWithMulti:async(Y,oe,we,de)=>await F2(Y,oe,we,de),getCreatPoolTransactionPayload:async Y=>{const{coinTypeA:oe,coinTypeB:we,tick_lower:de,tick_upper:Ae,tick_spacing:He,initialize_sqrt_price:Be,max_amount_a:Me,max_amount_b:q,slippage:j,fix_amount_a:K,decimalsA:J,decimalsB:Q,liquidityInput:ne}=Y;console.log(Y,"params===>");const pe=K?sn(Me,J):sn(q,Q);console.log(pe,"===>coinAmount");const ee=pt.sqrtPriceX64ToTickIndex(new y(Be));let me,ve;const se=pt.tickIndexToSqrtPriceX64(de),_e=pt.tickIndexToSqrtPriceX64(Ae);console.log(se,"===>minPriceX64"),console.log(_e,"===>maxPriceX64");let Fe;return ee>de&&ee<Ae?(Fe=ni.estLiquidityAndcoinAmountFromOneAmounts(de,Ae,new y(pe.toString()),K,!0,j,new y(Be)),me=K?pe.toNumber():Fe.tokenMaxA.toNumber(),ve=K?Fe.tokenMaxB.toNumber():pe.toNumber()):ee>=Ae?(Fe=Fo(se,_e,new y(pe.toString())),me=new y(ne.tokenMaxA*Math.pow(10,J)),ve=new y(ne.tokenMaxB*Math.pow(10,Q))):ee<=de&&(Fe=jo(se,_e,new y(pe.toString())),me=new y(ne.tokenMaxA*Math.pow(10,J)),ve=new y(ne.tokenMaxB*Math.pow(10,Q))),console.log(Fe,"===>preAddResult"),await n.Pool.creatPoolTransactionPayload({coinTypeA:oe,coinTypeB:we,tick_spacing:He,initialize_sqrt_price:new y(Be),uri:"",delta_liquidity:ee>de&&ee<Ae?Fe.liquidityAmount:Fe,max_amount_a:me,max_amount_b:ve,tick_lower:de,tick_upper:Ae},!0)},getTokenListByCoinType:async()=>await n.Token.getTokenListByCoinType("",0,99999),getPoolImmutables:async()=>await n.Resources.getPoolImmutables(),estimateLiquidityForCoinA:jo,estimateLiquidityForCoinB:Fo,getTokenBySymbol:async(Y,oe)=>{if(!oe)return null;let we=null;for(const de in Y){const Ae=Y[de];if(Ae.address.toUpperCase()===oe.toUpperCase()){we=Ae;break}}return we},estCoinAmountsFromTotalAmount:Y=>{const{lowerTick:oe,upperTick:we,decimalsA:de,decimalsB:Ae,curSqrtPrice:He,totalAmount:Be,tokenPriceA:Me,tokenPriceB:q}=Y;console.log(JSON.stringify({...Y,curSqrtPrice:He.toString()}),"params===>");const j=ni.estCoinAmountsFromTotalAmount(oe,we,He,Be,Me,q);console.log("coinAmounts: ",j);const K=eu(j.amountA.toFixed(de,ie.ROUND_UP).toString(),de),J=eu(j.amountB.toFixed(Ae,ie.ROUND_UP).toString(),Ae),Q={coinA:new y(K),coinB:new y(J)};return{amountA:$t(K.toString(),de),amountB:$t(J.toString(),Ae),tokenAmountsInfo:Q}},getCreateAddLiquidityPayload:async Y=>{const{curSqrtPrice:oe,tickLower:we,tickUpper:de,tokenAmounts:Ae,pool:He,slippage:Be}=Y;console.log(JSON.stringify(Y),"####getCreateAddLiquidityPayload 1593");const Me=ni.estimateLiquidityFromcoinAmounts(oe,we,de,Ae),q=new ie(Ae.coinA.toString()).mul(1+Be),j=new ie(Ae.coinB.toString()).mul(1+Be),K={coinTypeA:He.coinTypeA,coinTypeB:He.coinTypeB,tick_lower:we,tick_upper:de,pool:He.address,delta_liquidity:Me,max_amount_a:ie.ceil(q).toString(),max_amount_b:ie.ceil(j).toString(),is_open:!0,index:0};return console.log(JSON.stringify(K),"==>addLiquidityPayloadParams"),await n.Position.createAddLiquidityTransactionPayload(K)},calculateDepositRatioFixTokenA:(Y,oe,we)=>ni.calculateDepositRatioFixTokenA(Y,oe,we)}}function DP(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:t===43?62:t===47?63:0}function ki(t,e){for(var n=t.replace(/[^A-Za-z0-9+/]/g,""),i=n.length,s=e?Math.ceil((i*3+1>>2)/e)*e:i*3+1>>2,o=new Uint8Array(s),r,a,c=0,u=0,l=0;l<i;l++)if(a=l&3,c|=DP(n.charCodeAt(l))<<6*(3-a),a===3||i-l===1){for(r=0;r<3&&u<s;r++,u++)o[u]=c>>>(16>>>r&24)&255;c=0}return o}function tc(t){return t<26?t+65:t<52?t+71:t<62?t-4:t===62?43:t===63?47:65}function Gs(t){for(var e=2,n="",i=t.length,s=0,o=0;o<i;o++)e=o%3,s|=t[o]<<(16>>>e&24),(e===2||t.length-o===1)&&(n+=String.fromCodePoint(tc(s>>>18&63),tc(s>>>12&63),tc(s>>>6&63),tc(s&63)),s=0);return n.slice(0,n.length-2+e)+(e===2?"":e===1?"=":"==")}function hp(t){var s;const e=t.startsWith("0x")?t.slice(2):t,i=((s=(e.length%2===0?e:`0${e}}`).match(/.{2}/g))==null?void 0:s.map(o=>parseInt(o,16)))??[];return Uint8Array.from(i)}function gl(t){return t.reduce((e,n)=>e+n.toString(16).padStart(2,"0"),"")}var qP=32;function ld(t,e){let n=new Uint8Array(e),i=0;for(;t>0;)n[i]=Number(t%BigInt(256)),t=t/BigInt(256),i+=1;return n}var ml=t=>q0.encode(t),_l=t=>q0.decode(t),LP=class{constructor(t){this.bytePosition=0,this.dataView=new DataView(t.buffer)}shift(t){return this.bytePosition+=t,this}read8(){let t=this.dataView.getUint8(this.bytePosition);return this.shift(1),t}read16(){let t=this.dataView.getUint16(this.bytePosition,!0);return this.shift(2),t}read32(){let t=this.dataView.getUint32(this.bytePosition,!0);return this.shift(4),t}read64(){let t=this.read32(),n=this.read32().toString(16)+t.toString(16).padStart(8,"0");return BigInt("0x"+n).toString(10)}read128(){let t=BigInt(this.read64()),n=BigInt(this.read64()).toString(16)+t.toString(16).padStart(16,"0");return BigInt("0x"+n).toString(10)}read256(){let t=BigInt(this.read128()),n=BigInt(this.read128()).toString(16)+t.toString(16).padStart(32,"0");return BigInt("0x"+n).toString(10)}readBytes(t){let e=this.bytePosition+this.dataView.byteOffset,n=new Uint8Array(this.dataView.buffer,e,t);return this.shift(t),n}readULEB(){let t=this.bytePosition+this.dataView.byteOffset,e=new Uint8Array(this.dataView.buffer,t),{value:n,length:i}=FP(e);return this.shift(i),n}readVec(t){let e=this.readULEB(),n=[];for(let i=0;i<e;i++)n.push(t(this,i,e));return n}},NP=class{constructor({size:t=1024,maxSize:e,allocateSize:n=1024}={}){this.bytePosition=0,this.size=t,this.maxSize=e||t,this.allocateSize=n,this.dataView=new DataView(new ArrayBuffer(t))}ensureSizeOrGrow(t){const e=this.bytePosition+t;if(e>this.size){const n=Math.min(this.maxSize,this.size+this.allocateSize);if(e>n)throw new Error(`Attempting to serialize to BCS, but buffer does not have enough size. Allocated size: ${this.size}, Max size: ${this.maxSize}, Required size: ${e}`);this.size=n;const i=new ArrayBuffer(this.size);new Uint8Array(i).set(new Uint8Array(this.dataView.buffer)),this.dataView=new DataView(i)}}shift(t){return this.bytePosition+=t,this}write8(t){return this.ensureSizeOrGrow(1),this.dataView.setUint8(this.bytePosition,Number(t)),this.shift(1)}write16(t){return this.ensureSizeOrGrow(2),this.dataView.setUint16(this.bytePosition,Number(t),!0),this.shift(2)}write32(t){return this.ensureSizeOrGrow(4),this.dataView.setUint32(this.bytePosition,Number(t),!0),this.shift(4)}write64(t){return ld(BigInt(t),8).forEach(e=>this.write8(e)),this}write128(t){return ld(BigInt(t),16).forEach(e=>this.write8(e)),this}write256(t){return ld(BigInt(t),32).forEach(e=>this.write8(e)),this}writeULEB(t){return jP(t).forEach(e=>this.write8(e)),this}writeVec(t,e){return this.writeULEB(t.length),Array.from(t).forEach((n,i)=>e(this,n,i,t.length)),this}*[Symbol.iterator](){for(let t=0;t<this.bytePosition;t++)yield this.dataView.getUint8(t);return this.toBytes()}toBytes(){return new Uint8Array(this.dataView.buffer.slice(0,this.bytePosition))}toString(t){return zP(this.toBytes(),t)}};function jP(t){let e=[],n=0;if(t===0)return[0];for(;t>0;)e[n]=t&127,(t>>=7)&&(e[n]|=128),n+=1;return e}function FP(t){let e=0,n=0,i=0;for(;;){let s=t[i];if(i+=1,e|=(s&127)<<n,!(s&128))break;n+=7}return{value:e,length:i}}var qn=class Vr{constructor(e){if(this.types=new Map,this.counter=0,e instanceof Vr){this.schema=e.schema,this.types=new Map(e.types);return}if(this.schema=e,this.registerAddressType(Vr.ADDRESS,e.addressLength,e.addressEncoding),this.registerVectorType(e.vectorType),e.types&&e.types.structs)for(let n of Object.keys(e.types.structs))this.registerStructType(n,e.types.structs[n]);if(e.types&&e.types.enums)for(let n of Object.keys(e.types.enums))this.registerEnumType(n,e.types.enums[n]);if(e.types&&e.types.aliases)for(let n of Object.keys(e.types.aliases))this.registerAlias(n,e.types.aliases[n]);e.withPrimitives!==!1&&KP(this)}tempKey(){return`bcs-struct-${++this.counter}`}ser(e,n,i){if(typeof e=="string"||Array.isArray(e)){const{name:s,params:o}=this.parseTypeName(e);return this.getTypeInterface(s).encode(this,n,i,o)}if(typeof e=="object"){const s=this.tempKey();return new Vr(this).registerStructType(s,e).ser(s,n,i)}throw new Error(`Incorrect type passed into the '.ser()' function. 
${JSON.stringify(e)}`)}de(e,n,i){if(typeof n=="string")if(i)n=HP(n,i);else throw new Error("To pass a string to `bcs.de`, specify encoding");if(typeof e=="string"||Array.isArray(e)){const{name:s,params:o}=this.parseTypeName(e);return this.getTypeInterface(s).decode(this,n,o)}if(typeof e=="object"){const s=new Vr(this),o=this.tempKey();return s.registerStructType(o,e).de(o,n,i)}throw new Error(`Incorrect type passed into the '.de()' function. 
${JSON.stringify(e)}`)}hasType(e){return this.types.has(e)}registerAlias(e,n){return this.types.set(e,n),this}registerType(e,n,i,s=()=>!0){const{name:o,params:r}=this.parseTypeName(e);return this.types.set(o,{encode(a,c,u,l){const d=r.reduce((p,g,b)=>Object.assign(p,{[g]:l[b]}),{});return this._encodeRaw.call(a,new NP(u),c,l,d)},decode(a,c,u){const l=r.reduce((d,p,g)=>Object.assign(d,{[p]:u[g]}),{});return this._decodeRaw.call(a,new LP(c),u,l)},_encodeRaw(a,c,u,l){if(s(c))return n.call(this,a,c,u,l);throw new Error(`Validation failed for type ${o}, data: ${c}`)},_decodeRaw(a,c,u){return i.call(this,a,c,u)}}),this}registerAddressType(e,n,i="hex"){switch(i){case"base64":return this.registerType(e,function(o,r){return ki(r).reduce((a,c)=>a.write8(c),o)},function(o){return Gs(o.readBytes(n))});case"hex":return this.registerType(e,function(o,r){return hp(r).reduce((a,c)=>a.write8(c),o)},function(o){return gl(o.readBytes(n))});default:throw new Error("Unsupported encoding! Use either hex or base64")}}registerVectorType(e){let{name:n,params:i}=this.parseTypeName(e);if(i.length>1)throw new Error("Vector can have only one type parameter; got "+n);return this.registerType(e,function(o,r,a,c){return o.writeVec(r,(u,l)=>{let d=a[0];if(!d)throw new Error(`Incorrect number of type parameters passed a to vector '${e}'`);let{name:p,params:g}=this.parseTypeName(d);if(this.hasType(p))return this.getTypeInterface(p)._encodeRaw.call(this,u,l,g,c);if(!(p in c))throw new Error(`Unable to find a matching type definition for ${p} in vector; make sure you passed a generic`);let{name:b,params:w}=this.parseTypeName(c[p]);return this.getTypeInterface(b)._encodeRaw.call(this,u,l,w,c)})},function(o,r,a){return o.readVec(c=>{let u=r[0];if(!u)throw new Error(`Incorrect number of type parameters passed to a vector '${e}'`);let{name:l,params:d}=this.parseTypeName(u);if(this.hasType(l))return this.getTypeInterface(l)._decodeRaw.call(this,c,d,a);if(!(l in a))throw new Error(`Unable to find a matching type definition for ${l} in vector; make sure you passed a generic`);let{name:p,params:g}=this.parseTypeName(a[l]);return this.getTypeInterface(p)._decodeRaw.call(this,c,g,a)})})}registerStructType(e,n){for(let a in n){let c=this.tempKey(),u=n[a];!Array.isArray(u)&&typeof u!="string"&&(n[a]=c,this.registerStructType(c,u))}let i=Object.freeze(n),s=Object.keys(i),{name:o,params:r}=this.parseTypeName(e);return this.registerType(e,function(c,u,l,d){if(!u||u.constructor!==Object)throw new Error(`Expected ${o} to be an Object, got: ${u}`);if(l.length!==r.length)throw new Error(`Incorrect number of generic parameters passed; expected: ${r.length}, got: ${l.length}`);for(let p of s){if(!(p in u))throw new Error(`Struct ${o} requires field ${p}:${i[p]}`);const{name:g,params:b}=this.parseTypeName(i[p]);if(!r.includes(g))this.getTypeInterface(g)._encodeRaw.call(this,c,u[p],b,d);else{const w=r.indexOf(g);let{name:T,params:E}=this.parseTypeName(l[w]);if(this.hasType(T)){this.getTypeInterface(T)._encodeRaw.call(this,c,u[p],E,d);continue}if(!(T in d))throw new Error(`Unable to find a matching type definition for ${T} in ${o}; make sure you passed a generic`);let{name:P,params:k}=this.parseTypeName(d[T]);this.getTypeInterface(P)._encodeRaw.call(this,c,u[p],k,d)}}return c},function(c,u,l){if(u.length!==r.length)throw new Error(`Incorrect number of generic parameters passed; expected: ${r.length}, got: ${u.length}`);let d={};for(let p of s){const{name:g,params:b}=this.parseTypeName(i[p]);if(!r.includes(g))d[p]=this.getTypeInterface(g)._decodeRaw.call(this,c,b,l);else{const w=r.indexOf(g);let{name:T,params:E}=this.parseTypeName(u[w]);if(this.hasType(T)){d[p]=this.getTypeInterface(T)._decodeRaw.call(this,c,E,l);continue}if(!(T in l))throw new Error(`Unable to find a matching type definition for ${T} in ${o}; make sure you passed a generic`);let{name:P,params:k}=this.parseTypeName(l[T]);d[p]=this.getTypeInterface(P)._decodeRaw.call(this,c,k,l)}}return d})}registerEnumType(e,n){for(let a in n){let c=this.tempKey(),u=n[a];u!==null&&!Array.isArray(u)&&typeof u!="string"&&(n[a]=c,this.registerStructType(c,u))}let i=Object.freeze(n),s=Object.keys(i),{name:o,params:r}=this.parseTypeName(e);return this.registerType(e,function(c,u,l,d){if(!u)throw new Error(`Unable to write enum "${o}", missing data.
Received: "${u}"`);if(typeof u!="object")throw new Error(`Incorrect data passed into enum "${o}", expected object with properties: "${s.join(" | ")}".
Received: "${JSON.stringify(u)}"`);let p=Object.keys(u)[0];if(p===void 0)throw new Error(`Empty object passed as invariant of the enum "${o}"`);let g=s.indexOf(p);if(g===-1)throw new Error(`Unknown invariant of the enum "${o}", allowed values: "${s.join(" | ")}"; received "${p}"`);let b=s[g],w=i[b];if(c.write8(g),w===null)return c;let T=r.indexOf(w),E=T===-1?w:l[T];{let{name:P,params:k}=this.parseTypeName(E);return this.getTypeInterface(P)._encodeRaw.call(this,c,u[p],k,d)}},function(c,u,l){let d=c.readULEB(),p=s[d],g=i[p];if(d===-1)throw new Error(`Decoding type mismatch, expected enum "${o}" invariant index, received "${d}"`);if(g===null)return{[p]:!0};let b=r.indexOf(g),w=b===-1?g:u[b];{let{name:T,params:E}=this.parseTypeName(w);return{[p]:this.getTypeInterface(T)._decodeRaw.call(this,c,E,l)}}})}getTypeInterface(e){let n=this.types.get(e);if(typeof n=="string"){let i=[];for(;typeof n=="string";){if(i.includes(n))throw new Error(`Recursive definition found: ${i.join(" -> ")} -> ${n}`);i.push(n),n=this.types.get(n)}}if(n===void 0)throw new Error(`Type ${e} is not registered`);return n}parseTypeName(e){if(Array.isArray(e)){let[c,...u]=e;return{name:c,params:u}}if(typeof e!="string")throw new Error(`Illegal type passed as a name of the type: ${e}`);let[n,i]=this.schema.genericSeparators||["<",">"],s=e.indexOf(n),o=Array.from(e).reverse().indexOf(i);if(s===-1&&o===-1)return{name:e,params:[]};if(s===-1||o===-1)throw new Error(`Unclosed generic in name '${e}'`);let r=e.slice(0,s),a=pp(e.slice(s+1,e.length-o-1),this.schema.genericSeparators);return{name:r,params:a}}};qn.U8="u8";qn.U16="u16";qn.U32="u32";qn.U64="u64";qn.U128="u128";qn.U256="u256";qn.BOOL="bool";qn.VECTOR="vector";qn.ADDRESS="address";qn.STRING="string";qn.HEX="hex-string";qn.BASE58="base58-string";qn.BASE64="base64-string";var Te=qn;function zP(t,e){switch(e){case"base58":return ml(t);case"base64":return Gs(t);case"hex":return gl(t);default:throw new Error("Unsupported encoding, supported values are: base64, hex")}}function HP(t,e){switch(e){case"base58":return _l(t);case"base64":return ki(t);case"hex":return hp(t);default:throw new Error("Unsupported encoding, supported values are: base64, hex")}}function KP(t){t.registerType(Te.U8,function(e,n){return e.write8(n)},function(e){return e.read8()},e=>e<256),t.registerType(Te.U16,function(e,n){return e.write16(n)},function(e){return e.read16()},e=>e<65536),t.registerType(Te.U32,function(e,n){return e.write32(n)},function(e){return e.read32()},e=>e<=4294967296n),t.registerType(Te.U64,function(e,n){return e.write64(n)},function(e){return e.read64()}),t.registerType(Te.U128,function(e,n){return e.write128(n)},function(e){return e.read128()}),t.registerType(Te.U256,function(e,n){return e.write256(n)},function(e){return e.read256()}),t.registerType(Te.BOOL,function(e,n){return e.write8(n)},function(e){return e.read8().toString(10)==="1"}),t.registerType(Te.STRING,function(e,n){return e.writeVec(Array.from(n),(i,s)=>i.write8(s.charCodeAt(0)))},function(e){return e.readVec(n=>n.read8()).map(n=>String.fromCharCode(Number(n))).join("")},e=>!0),t.registerType(Te.HEX,function(e,n){return e.writeVec(Array.from(hp(n)),(i,s)=>i.write8(s))},function(e){let n=e.readVec(i=>i.read8());return gl(new Uint8Array(n))}),t.registerType(Te.BASE58,function(e,n){return e.writeVec(Array.from(_l(n)),(i,s)=>i.write8(s))},function(e){let n=e.readVec(i=>i.read8());return ml(new Uint8Array(n))}),t.registerType(Te.BASE64,function(e,n){return e.writeVec(Array.from(ki(n)),(i,s)=>i.write8(s))},function(e){let n=e.readVec(i=>i.read8());return Gs(new Uint8Array(n))})}function rw(){return{genericSeparators:["<",">"],vectorType:"vector",addressLength:qP,addressEncoding:"hex"}}function pp(t,e=["<",">"]){const[n,i]=e,s=[];let o="",r=0;for(let a=0;a<t.length;a++){const c=t[a];if(c===n&&r++,c===i&&r--,r===0&&c===","){s.push(o.trim()),o="";continue}o+=c}return s.push(o.trim()),s}const GP=32;function c0(t){try{return _l(t).length===GP}catch{return!1}}const aw=32;function xs(t){return WP(t)&&VP(t)===aw}function Xr(t){return xs(t)}function en(t,e=!1){let n=t.toLowerCase();return!e&&n.startsWith("0x")&&(n=n.slice(2)),`0x${n.padStart(aw*2,"0")}`}function gn(t,e=!1){return en(t,e)}function WP(t){return/^(0x|0X)?[a-fA-F0-9]+$/.test(t)&&t.length%2===0}function VP(t){return/^(0x|0X)/.test(t)?(t.length-2)/2:t.length/2}BigInt(1e9);gn("0x6");gn("0x5");f();f();f();f();f();f();const So=Ce([I({AddressOwner:f()}),I({ObjectOwner:f()}),I({Shared:I({initial_shared_version:he(f())})}),re("Immutable")]),XP=qi("SuiJsonValue",()=>!0),JP=Ce([I({u32:f()}),I({u64:f()}),I({f64:f()})]);I({attributes:Mt(f(),he(JP)),featureFlags:Mt(f(),Re()),maxSupportedProtocolVersion:f(),minSupportedProtocolVersion:f(),protocolVersion:f()});Ce([f(),re("package")]);const bi=I({digest:f(),objectId:f(),version:Ce([le(),f()])}),ZP=I({payment:G(bi),owner:f(),price:f(),budget:f()}),YP=cn(bi,I({type:f(),owner:So,previousTransaction:f()})),QP=Mt(f(),Li()),eE=Mt(f(),uu()),tE=I({type:f(),fields:QP,hasPublicTransfer:Re()}),Vd=I({disassembled:eE}),nE=Ce([cn(tE,I({dataType:re("moveObject")})),cn(Vd,I({dataType:re("package")}))]),iE=I({type:f(),hasPublicTransfer:Re(),version:f(),bcsBytes:f()}),sE=I({id:f(),moduleMap:Mt(f(),f())}),oE=Ce([cn(iE,I({dataType:re("moveObject")})),cn(sE,I({dataType:re("package")}))]);BigInt(1e9);f();const cw=I({code:f(),error:Z(f()),object_id:Z(f()),parent_object_id:Z(f()),version:Z(f()),digest:Z(f())}),rE=I({data:he(Z(Mt(f(),f()))),error:he(Z(cw))}),aE=Ce([rE,Z(Mt(f(),f()))]),uw=I({objectId:f(),version:f(),digest:f(),type:he(Z(f())),content:he(Z(nE)),bcs:he(Z(oE)),owner:he(Z(So)),previousTransaction:he(Z(f())),storageRebate:he(Z(f())),display:he(Z(aE))});I({showType:he(Z(Re())),showContent:he(Z(Re())),showBcs:he(Z(Re())),showOwner:he(Z(Re())),showPreviousTransaction:he(Z(Re())),showStorageRebate:he(Z(Re())),showDisplay:he(Z(Re()))});Ce([re("Exists"),re("notExists"),re("Deleted")]);G(YP);const cE=I({data:he(Z(uw)),error:he(Z(cw))});function uE(t){return t.data}function lE(t){if(t.error&&"object_id"in t.error&&"version"in t.error&&"digest"in t.error){const e=t.error;return{objectId:e.object_id,version:e.version,digest:e.digest}}}function dE(t){if("reference"in t)return t.reference;const e=uE(t);return e?{objectId:e.objectId,version:e.version,digest:e.digest}:lE(t)}I({objectId:f(),atCheckpoint:Z(le())});I({data:G(cE),nextCursor:Z(he(f())),hasNextPage:Re()});Ce([I({details:uw,status:re("VersionFound")}),I({details:f(),status:re("ObjectNotExists")}),I({details:bi,status:re("ObjectDeleted")}),I({details:wt([f(),le()]),status:re("VersionNotFound")}),I({details:I({asked_version:le(),latest_version:le(),object_id:f()}),status:re("VersionTooHigh")})]);const lw=I({txDigest:f(),eventSeq:f()}),dw=I({id:lw,packageId:f(),transactionModule:f(),sender:f(),type:f(),parsedJson:Z(Mt(f(),Li())),bcs:Z(f()),timestampMs:Z(f())});I({data:G(dw),nextCursor:he(lw),hasNextPage:Re()});f();const hE=I({epoch:f(),storage_charge:f(),computation_charge:f(),storage_rebate:f(),epoch_start_timestamp_ms:Z(f())}),pE=I({epoch:f(),round:f(),commit_timestamp_ms:f()}),fE=I({objects:G(f())}),mi=Ce([re("GasCoin"),I({Input:le()}),I({Result:le()}),I({NestedResult:wt([le(),le()])})]),gE=I({arguments:Z(G(mi)),type_arguments:Z(G(f())),package:f(),module:f(),function:f()}),mE=Ce([I({MoveCall:gE}),I({TransferObjects:wt([G(mi),mi])}),I({SplitCoins:wt([mi,G(mi)])}),I({MergeCoins:wt([mi,G(mi)])}),I({Publish:Ce([wt([Vd,G(f())]),G(f())])}),I({Upgrade:Ce([wt([Vd,G(f()),f(),mi]),wt([G(f()),f(),mi])])}),I({MakeMoveVec:wt([he(f()),G(mi)])})]),_E=Ce([I({type:re("pure"),valueType:he(f()),value:XP}),I({type:re("object"),objectType:re("immOrOwnedObject"),objectId:f(),version:f(),digest:f()}),I({type:re("object"),objectType:re("sharedObject"),objectId:f(),initialSharedVersion:f(),mutable:Re()})]),yE=I({transactions:G(mE),inputs:G(_E)}),wE=Ce([cn(hE,I({kind:re("ChangeEpoch")})),cn(pE,I({kind:re("ConsensusCommitPrologue")})),cn(fE,I({kind:re("Genesis")})),cn(yE,I({kind:re("ProgrammableTransaction")}))]),hw=I({messageVersion:re("v1"),transaction:wE,sender:f(),gasData:ZP});f();const bE=Ce([f(),G(f())]);I({epoch:f(),signature:bE,signers_map:G(le())});const vE=I({computationCost:f(),storageCost:f(),storageRebate:f(),nonRefundableStorageFee:f()}),TE=Ce([re("success"),re("failure")]),AE=I({status:TE,error:Z(f())}),nc=I({owner:So,reference:bi}),kE=I({objectId:f(),sequenceNumber:f()}),fp=I({messageVersion:re("v1"),status:AE,executedEpoch:f(),modifiedAtVersions:Z(G(kE)),gasUsed:vE,sharedObjects:Z(G(bi)),transactionDigest:f(),created:Z(G(nc)),mutated:Z(G(nc)),unwrapped:Z(G(nc)),deleted:Z(G(bi)),unwrappedThenDeleted:Z(G(bi)),wrapped:Z(G(bi)),gasObject:nc,eventsDigest:he(Z(f())),dependencies:Z(G(f()))}),gp=G(dw),SE=wt([G(le()),f()]),xE=wt([mi,G(le()),f()]),PE=I({mutableReferenceOutputs:Z(G(xE)),returnValues:Z(G(SE))});I({effects:fp,events:gp,results:Z(G(PE)),error:Z(f())});f();const EE=I({data:hw,txSignatures:G(f())}),CE=I({type:re("published"),packageId:f(),version:f(),digest:f(),modules:G(f())}),BE=I({type:re("transferred"),sender:f(),recipient:So,objectType:f(),objectId:f(),version:f(),digest:f()}),IE=I({type:re("mutated"),sender:f(),owner:So,objectType:f(),objectId:f(),version:f(),previousVersion:f(),digest:f()}),OE=I({type:re("deleted"),sender:f(),objectType:f(),objectId:f(),version:f()}),RE=I({type:re("wrapped"),sender:f(),objectType:f(),objectId:f(),version:f()}),$E=I({type:re("created"),sender:f(),owner:So,objectType:f(),objectId:f(),version:f(),digest:f()}),pw=Ce([CE,BE,IE,OE,RE,$E]),fw=I({owner:So,coinType:f(),amount:f()}),UE=I({digest:f(),transaction:Z(EE),effects:Z(fp),events:Z(gp),timestampMs:Z(f()),checkpoint:Z(f()),confirmedLocalExecution:Z(Re()),objectChanges:Z(G(pw)),balanceChanges:Z(G(fw)),errors:Z(G(f()))});I({showInput:Z(Re()),showEffects:Z(Re()),showEvents:Z(Re()),showObjectChanges:Z(Re()),showBalanceChanges:Z(Re())});I({data:G(UE),nextCursor:he(f()),hasNextPage:Re()});I({effects:fp,events:gp,objectChanges:G(pw),balanceChanges:G(fw),input:Z(hw)});const ME=Ce([f(),I({Object:f()})]);G(ME);const DE=I({address:f(),name:f()}),qE=Ce([re("Private"),re("Public"),re("Friend")]),mp=I({abilities:G(f())}),LE=I({constraints:mp,isPhantom:Re()}),NE=I({TypeParameter:le()}),dd=wt([I({module:f(),package:f(),function:f()}),f()]);I({rank3Days:G(dd),rank7Days:G(dd),rank30Days:G(dd)});function gw(t){if(!t)return!1;if(typeof t=="string"||Ut(t,NE)||mw(t))return!0;if(typeof t!="object")return!1;const e=t;return!!(Ut(e.Reference,tr)||Ut(e.MutableReference,tr)||Ut(e.Vector,tr))}const tr=qi("SuiMoveNormalizedType",gw);function mw(t){if(!t||typeof t!="object")return!1;const e=t;if(!e.Struct||typeof e.Struct!="object")return!1;const n=e.Struct;return!(typeof n.address!="string"||typeof n.module!="string"||typeof n.name!="string"||!Array.isArray(n.typeArguments)||!n.typeArguments.every(i=>gw(i)))}qi("SuiMoveNormalizedStructType",mw);const jE=I({visibility:qE,isEntry:Re(),typeParameters:G(mp),parameters:G(tr),return:G(tr)}),FE=I({name:f(),type:tr}),zE=I({abilities:mp,typeParameters:G(LE),fields:G(FE)}),HE=I({fileFormatVersion:le(),address:f(),name:f(),friends:G(DE),structs:Mt(f(),zE),exposedFunctions:Mt(f(),jE)});Mt(f(),HE);function _w(t){return typeof t=="object"&&"MutableReference"in t?t.MutableReference:void 0}function KE(t){return typeof t=="object"&&"Reference"in t?t.Reference:void 0}function yw(t){if(typeof t=="object"&&"Struct"in t)return t;const e=KE(t),n=_w(t);if(typeof e=="object"&&"Struct"in e)return e;if(typeof n=="object"&&"Struct"in n)return n}const GE=I({apy:le(),address:f()});I({epoch:f(),apys:G(GE)});I({value:le()});const WE=I({stakedSuiId:f(),stakeRequestEpoch:f(),stakeActiveEpoch:f(),principal:f(),status:Ce([re("Active"),re("Pending"),re("Unstaked")]),estimatedReward:Z(f())});I({validatorAddress:f(),stakingPool:f(),stakes:G(WE)});const VE=I({balance:I({value:le()}),distribution_counter:le(),current_distribution_amount:le(),stake_subsidy_period_length:le(),stake_subsidy_decrease_rate:le()});I({type:f(),fields:VE});I({value:le()});const XE=I({id:f(),size:le(),head:I({vec:G()}),tail:I({vec:G()})});I({id:f(),size:le()});I({type:f(),fields:XE});const JE=I({exchangeRates:I({id:f(),size:le()}),id:f(),pendingStake:le(),pendingPoolTokenWithdraw:le(),pendingTotalSuiWithdraw:le(),poolTokenBalance:le(),rewardsPool:I({value:le()}),activationEpoch:I({vec:G()}),deactivationEpoch:I({vec:G()}),suiBalance:le()});I({type:f(),fields:JE});const ZE=G(wt([f(),f()]));I({epoch:f(),validators:ZE});const ww=I({suiAddress:f(),protocolPubkeyBytes:f(),networkPubkeyBytes:f(),workerPubkeyBytes:f(),proofOfPossessionBytes:f(),operationCapId:f(),name:f(),description:f(),imageUrl:f(),projectUrl:f(),p2pAddress:f(),netAddress:f(),primaryAddress:f(),workerAddress:f(),nextEpochProtocolPubkeyBytes:he(f()),nextEpochProofOfPossession:he(f()),nextEpochNetworkPubkeyBytes:he(f()),nextEpochWorkerPubkeyBytes:he(f()),nextEpochNetAddress:he(f()),nextEpochP2pAddress:he(f()),nextEpochPrimaryAddress:he(f()),nextEpochWorkerAddress:he(f()),votingPower:f(),gasPrice:f(),commissionRate:f(),nextEpochStake:f(),nextEpochGasPrice:f(),nextEpochCommissionRate:f(),stakingPoolId:f(),stakingPoolActivationEpoch:he(f()),stakingPoolDeactivationEpoch:he(f()),stakingPoolSuiBalance:f(),rewardsPool:f(),poolTokenBalance:f(),pendingStake:f(),pendingPoolTokenWithdraw:f(),pendingTotalSuiWithdraw:f(),exchangeRatesId:f(),exchangeRatesSize:f()});I({epoch:f(),protocolVersion:f(),systemStateVersion:f(),storageFundTotalObjectStorageRebates:f(),storageFundNonRefundableBalance:f(),referenceGasPrice:f(),safeMode:Re(),safeModeStorageRewards:f(),safeModeComputationRewards:f(),safeModeStorageRebates:f(),safeModeNonRefundableStorageFee:f(),epochStartTimestampMs:f(),epochDurationMs:f(),stakeSubsidyStartEpoch:f(),maxValidatorCount:f(),minValidatorJoiningStake:f(),validatorLowStakeThreshold:f(),validatorVeryLowStakeThreshold:f(),validatorLowStakeGracePeriod:f(),stakeSubsidyBalance:f(),stakeSubsidyDistributionCounter:f(),stakeSubsidyCurrentDistributionAmount:f(),stakeSubsidyPeriodLength:f(),stakeSubsidyDecreaseRate:le(),totalStake:f(),activeValidators:G(ww),pendingActiveValidatorsId:f(),pendingActiveValidatorsSize:f(),pendingRemovals:G(f()),stakingPoolMappingsId:f(),stakingPoolMappingsSize:f(),inactivePoolsId:f(),inactivePoolsSize:f(),validatorCandidatesId:f(),validatorCandidatesSize:f(),atRiskValidators:G(wt([f(),f()])),validatorReportRecords:G(wt([f(),G(f())]))});const YE=I({coinType:f(),coinObjectId:f(),version:f(),digest:f(),balance:f(),previousTransaction:f()});I({data:G(YE),nextCursor:he(f()),hasNextPage:Re()});I({coinType:f(),coinObjectCount:le(),totalBalance:f(),lockedBalance:I({epochId:Z(le()),number:Z(le())})});I({value:f()});const QE=I({lastCheckpointId:f(),epochEndTimestamp:f(),protocolVersion:f(),referenceGasPrice:f(),totalStake:f(),storageFundReinvestment:f(),storageCharge:f(),storageRebate:f(),storageFundBalance:f(),stakeSubsidyAmount:f(),totalGasFees:f(),totalStakeRewardsDistributed:f(),leftoverStorageFundInflow:f()}),eC=I({epoch:f(),validators:G(ww),epochTotalTransactions:f(),firstCheckpointId:f(),epochStartTimestamp:f(),endOfEpochInfo:he(QE),referenceGasPrice:he(le())});I({data:G(eC),nextCursor:he(f()),hasNextPage:Re()});I({data:G(f()),hasNextPage:Re(),nextCursor:he(f())});const tC=Ce([re("DynamicField"),re("DynamicObject")]),nC=I({type:f(),value:Li()}),iC=I({name:nC,bcsName:f(),type:tC,objectType:f(),objectId:f(),version:le(),digest:f()});I({data:G(iC),nextCursor:he(f()),hasNextPage:Re()});const sC=I({computationCost:f(),storageCost:f(),storageRebate:f(),nonRefundableStorageFee:f()});f();f();I({digest:G(le())});const bw=Li();f();const oC=I({nextEpochCommittee:G(wt([f(),f()])),nextEpochProtocolVersion:f(),epochCommitments:G(bw)});I({transaction:f(),effects:f()});const rC=I({epoch:f(),sequenceNumber:f(),digest:f(),networkTotalTransactions:f(),previousDigest:Z(f()),epochRollingGasCostSummary:sC,timestampMs:f(),endOfEpochData:Z(oC),validatorSignature:f(),transactions:G(f()),checkpointCommitments:G(bw)});I({data:G(rC),nextCursor:he(f()),hasNextPage:Re()});I({currentTps:le(),tps30Days:le(),currentCheckpoint:f(),currentEpoch:f(),totalAddresses:f(),totalObjects:f(),totalPackages:f()});const aC=I({checkpoint:le(),epoch:le(),timestampMs:le(),cumulativeAddresses:le(),cumulativeActiveAddresses:le(),dailyActiveAddresses:le()});G(aC);const vw="0x2",_p="0x1",cC="object",uC="ID",lC=`${vw}::sui::SUI`;gn("0x6");I({decimals:le(),name:f(),symbol:f(),description:f(),iconUrl:he(f()),id:he(f())});const dC="ascii",hC="String",pC="string",fC="String",gC="option",mC="Option",_C={address:vw,module:cC,name:uC},yC={address:_p,module:dC,name:hC},wC={address:_p,module:pC,name:fC},bC={address:_p,module:gC,name:mC},ic=(t,e)=>t.address===e.address&&t.module===e.module&&t.name===e.name;function vC(t){var n;const e=(n=yw(t))==null?void 0:n.Struct;return(e==null?void 0:e.address)==="0x2"&&(e==null?void 0:e.module)==="tx_context"&&(e==null?void 0:e.name)==="TxContext"}function hd(t,e){if(!(typeof e>"u")&&typeof e!==t)throw new Error(`Expect ${e} to be ${t}, received ${typeof e}`)}const TC=["Address","Bool","U8","U16","U32","U64","U128","U256"];function Xd(t,e){if(typeof t=="string"&&TC.includes(t)){if(t in["U8","U16","U32","U64","U128","U256"])hd("number",e);else if(t==="Bool")hd("boolean",e);else if(t==="Address"&&(hd("string",e),e&&!xs(e)))throw new Error("Invalid Sui Address");return t.toLowerCase()}else if(typeof t=="string")throw new Error(`Unknown pure normalized type ${JSON.stringify(t,null,2)}`);if("Vector"in t){if((e===void 0||typeof e=="string")&&t.Vector==="U8")return"string";if(e!==void 0&&!Array.isArray(e))throw new Error(`Expect ${e} to be a array, received ${typeof e}`);const n=Xd(t.Vector,e?e[0]:void 0);return n===void 0?void 0:`vector<${n}>`}if("Struct"in t){if(ic(t.Struct,yC))return"string";if(ic(t.Struct,wC))return"utf8string";if(ic(t.Struct,_C))return"address";if(ic(t.Struct,bC)){const n={Vector:t.Struct.typeArguments[0]};return Xd(n,e)}}}const Bo="vector",AC={kind:"TransactionKind",sender:Te.ADDRESS,gasData:"GasData",expiration:"TransactionExpiration"},kC={enums:{"Option<T>":{None:null,Some:"T"},ObjectArg:{ImmOrOwned:"SuiObjectRef",Shared:"SharedObjectRef"},CallArg:{Pure:[Bo,Te.U8],Object:"ObjectArg",ObjVec:[Bo,"ObjectArg"]},TypeTag:{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:"TypeTag",struct:"StructTag",u16:null,u32:null,u256:null},TransactionKind:{ProgrammableTransaction:"ProgrammableTransaction",ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null},TransactionExpiration:{None:null,Epoch:"unsafe_u64"},TransactionData:{V1:"TransactionDataV1"}},structs:{SuiObjectRef:{objectId:Te.ADDRESS,version:Te.U64,digest:"ObjectDigest"},SharedObjectRef:{objectId:Te.ADDRESS,initialSharedVersion:Te.U64,mutable:Te.BOOL},StructTag:{address:Te.ADDRESS,module:Te.STRING,name:Te.STRING,typeParams:[Bo,"TypeTag"]},GasData:{payment:[Bo,"SuiObjectRef"],owner:Te.ADDRESS,price:Te.U64,budget:Te.U64},SenderSignedData:{data:"TransactionData",txSignatures:[Bo,[Bo,Te.U8]]},TransactionDataV1:AC},aliases:{ObjectDigest:Te.BASE58}},yp=new Te({...rw(),types:kC});yp.registerType("utf8string",(t,e)=>{const n=Array.from(new TextEncoder().encode(e));return t.writeVec(n,(i,s)=>i.write8(s))},t=>{let e=t.readVec(n=>n.read8());return new TextDecoder().decode(new Uint8Array(e))});yp.registerType("unsafe_u64",(t,e)=>t.write64(e),t=>Number.parseInt(t.read64(),10));const SC=/^vector<(.+)>$/,xC=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/;let Jd=class Lo{static parseFromStr(e,n=!1){if(e==="address")return{address:null};if(e==="bool")return{bool:null};if(e==="u8")return{u8:null};if(e==="u16")return{u16:null};if(e==="u32")return{u32:null};if(e==="u64")return{u64:null};if(e==="u128")return{u128:null};if(e==="u256")return{u256:null};if(e==="signer")return{signer:null};const i=e.match(SC);if(i)return{vector:Lo.parseFromStr(i[1],n)};const s=e.match(xC);if(s)return{struct:{address:n?en(s[1]):s[1],module:s[2],name:s[3],typeParams:s[5]===void 0?[]:Lo.parseStructTypeArgs(s[5],n)}};throw new Error(`Encountered unexpected token when parsing type args for ${e}`)}static parseStructTypeArgs(e,n=!1){return pp(e).map(i=>Lo.parseFromStr(i,n))}static tagToString(e){if("bool"in e)return"bool";if("u8"in e)return"u8";if("u16"in e)return"u16";if("u32"in e)return"u32";if("u64"in e)return"u64";if("u128"in e)return"u128";if("u256"in e)return"u256";if("address"in e)return"address";if("signer"in e)return"signer";if("vector"in e)return`vector<${Lo.tagToString(e.vector)}>`;if("struct"in e){const n=e.struct,i=n.typeParams.map(Lo.tagToString).join(", ");return`${n.address}::${n.module}::${n.name}${i?`<${i}>`:""}`}throw new Error("Invalid TypeTag")}};const Tw="Argument",vn="vector",PC="Option",EC="CallArg",u0="TypeTag",CC="ProgrammableTransaction",Zd="ProgrammableMoveCall",Aw="Transaction",l0="CompressedSignature",d0="PublicKey",h0="MultiSigPublicKey",p0="MultiSigPkMap",BC="MultiSig",wp="EnumKind",IC=[wp,Aw],Ni=[wp,Tw],kw="SimpleProgrammableMoveCall",ui=new Te(yp);bp(ui,"FixedArray[64]",64);bp(ui,"FixedArray[33]",33);bp(ui,"FixedArray[32]",32);ui.registerStructType(CC,{inputs:[vn,EC],transactions:[vn,IC]}).registerEnumType(Tw,{GasCoin:null,Input:{index:Te.U16},Result:{index:Te.U16},NestedResult:{index:Te.U16,resultIndex:Te.U16}}).registerStructType(Zd,{package:Te.ADDRESS,module:Te.STRING,function:Te.STRING,type_arguments:[vn,u0],arguments:[vn,Ni]}).registerEnumType(Aw,{MoveCall:kw,TransferObjects:{objects:[vn,Ni],address:Ni},SplitCoins:{coin:Ni,amounts:[vn,Ni]},MergeCoins:{destination:Ni,sources:[vn,Ni]},Publish:{modules:[vn,[vn,Te.U8]],dependencies:[vn,Te.ADDRESS]},MakeMoveVec:{type:[PC,u0],objects:[vn,Ni]},Upgrade:{modules:[vn,[vn,Te.U8]],dependencies:[vn,Te.ADDRESS],packageId:Te.ADDRESS,ticket:Ni}}).registerEnumType(l0,{ED25519:["FixedArray[64]","u8"],Secp256k1:["FixedArray[64]","u8"],Secp256r1:["FixedArray[64]","u8"]}).registerEnumType(d0,{ED25519:["FixedArray[32]","u8"],Secp256k1:["FixedArray[33]","u8"],Secp256r1:["FixedArray[33]","u8"]}).registerStructType(p0,{pubKey:d0,weight:Te.U8}).registerStructType(h0,{pk_map:[vn,p0],threshold:Te.U16}).registerStructType(BC,{sigs:[vn,l0],bitmap:Te.U16,multisig_pk:h0});ui.registerType([wp,"T"],function(e,n,i,s){const r={[n.kind]:n},[a]=i;return this.getTypeInterface(a)._encodeRaw.call(this,e,r,i,s)},function(e,n,i){const[s]=n,o=this.getTypeInterface(s)._decodeRaw.call(this,e,n,i),r=Object.keys(o)[0];return{kind:r,...o[r]}},t=>{if(typeof t!="object"&&!("kind"in t))throw new Error(`EnumKind: Missing property "kind" in the input ${JSON.stringify(t)}`);return!0});ui.registerType(kw,function(e,n,i,s){const[o,r,a]=n.target.split("::"),c=n.typeArguments.map(u=>Jd.parseFromStr(u,!0));return this.getTypeInterface(Zd)._encodeRaw.call(this,e,{package:en(o),module:r,function:a,type_arguments:c,arguments:n.arguments},i,s)},function(e,n,i){let s=ui.getTypeInterface(Zd)._decodeRaw.call(this,e,n,i);return{target:[s.package,s.module,s.function].join("::"),arguments:s.arguments,typeArguments:s.type_arguments.map(Jd.tagToString)}},t=>t.target.split("::").length===3);function bp(t,e,n){t.registerType(e,function(s,o,r,a){if(o.length!==n)throw new Error(`Expected fixed array of length ${n}, got ${o.length}`);if(r.length!==1)throw new Error(`Expected one type parameter in a fixed array, got ${r.length}`);let[c]=typeof r[0]=="string"?[r[0],[]]:r[0];for(let u of o)this.getTypeInterface(c)._encodeRaw.call(this,s,u,r,a);return s},function(s,o,r){if(o.length!==1)throw new Error(`Expected one type parameter in a fixed array, got ${o.length}`);let a=[],[c]=typeof o[0]=="string"?[o[0],[]]:o[0];for(let u=0;u<n;u++)a.push(this.getTypeInterface(c)._decodeRaw.call(this,s,o,r));return a})}const OC=Ce([I({ImmOrOwned:bi}),I({Shared:I({objectId:f(),initialSharedVersion:Ce([un(),f()]),mutable:Re()})})]),tu=I({Pure:G(un())}),RC=I({Object:OC}),na=Ce([tu,RC]),Ki={Pure(t,e){return{Pure:Array.from(t instanceof Uint8Array?t:ui.ser(e,t,{maxSize:1/0}).toBytes())}},ObjectRef({objectId:t,digest:e,version:n}){return{Object:{ImmOrOwned:{digest:e,version:n,objectId:en(t)}}}},SharedObjectRef({objectId:t,mutable:e,initialSharedVersion:n}){return{Object:{Shared:{mutable:e,initialSharedVersion:n,objectId:en(t)}}}}};function f0(t){return typeof t=="string"?en(t):"ImmOrOwned"in t.Object?en(t.Object.ImmOrOwned.objectId):en(t.Object.Shared.objectId)}function $C(t){return typeof t=="object"&&"Object"in t&&"Shared"in t.Object?t.Object.Shared:void 0}function UC(t){var e;return((e=$C(t))==null?void 0:e.mutable)??!1}function jn(t,e){return L0(t,e)}const nu=Symbol("transaction-argument-type"),MC=t=>Ce([I({None:Ce([re(!0),re(null)])}),I({Some:t})]),ma=I({kind:re("Input"),index:un(),value:Z(Li()),type:Z(Ce([re("pure"),re("object")]))}),vp=[ma,I({kind:re("GasCoin")}),I({kind:re("Result"),index:un()}),I({kind:re("NestedResult"),index:un(),resultIndex:un()})],DC=Ce([...vp]),so=Ce([...vp]);so[nu]={kind:"object"};const Sw=t=>{const e=Ce([...vp]);return e[nu]={kind:"pure",type:t},e},xw=I({kind:re("MoveCall"),target:qi("target",f().validator),typeArguments:G(f()),arguments:G(DC)}),Pw=I({kind:re("TransferObjects"),objects:G(so),address:Sw(Te.ADDRESS)}),Ew=I({kind:re("SplitCoins"),coin:so,amounts:G(Sw("u64"))}),Cw=I({kind:re("MergeCoins"),destination:so,sources:G(so)}),Bw=I({kind:re("MakeMoveVec"),type:Z(MC(Mt(f(),uu()))),objects:G(so)}),Iw=I({kind:re("Publish"),modules:G(G(un())),dependencies:G(f())}),Ow=I({kind:re("Upgrade"),modules:G(G(un())),dependencies:G(f()),packageId:f(),ticket:so}),Rw=[xw,Pw,Ew,Cw,Iw,Ow,Bw],$w=Ce([...Rw]);function qC(t){return rr(t,$w),Rw.find(e=>Ut(t,e))}const ms={MoveCall(t){return jn({kind:"MoveCall",target:t.target,arguments:t.arguments??[],typeArguments:t.typeArguments??[]},xw)},TransferObjects(t,e){return jn({kind:"TransferObjects",objects:t,address:e},Pw)},SplitCoins(t,e){return jn({kind:"SplitCoins",coin:t,amounts:e},Ew)},MergeCoins(t,e){return jn({kind:"MergeCoins",destination:t,sources:e},Cw)},Publish({modules:t,dependencies:e}){return jn({kind:"Publish",modules:t.map(n=>typeof n=="string"?Array.from(ki(n)):n),dependencies:e.map(n=>gn(n))},Iw)},Upgrade({modules:t,dependencies:e,packageId:n,ticket:i}){return jn({kind:"Upgrade",modules:t.map(s=>typeof s=="string"?Array.from(ki(s)):s),dependencies:e.map(s=>gn(s)),packageId:n,ticket:i},Ow)},MakeMoveVec({type:t,objects:e}){return jn({kind:"MakeMoveVec",type:t?{Some:Jd.parseFromStr(t)}:{None:null},objects:e},Bw)}};function LC(t,e){const n=Array.from(`${t}::`).map(s=>s.charCodeAt(0)),i=new Uint8Array(n.length+e.length);return i.set(n),i.set(e,n.length),N0(i,{dkLen:32})}const NC=Z(he(Ce([I({Epoch:un()}),I({None:Ce([re(!0),re(null)])})]))),g0=qi("StringEncodedBigint",t=>{if(!["string","number","bigint"].includes(typeof t))return!1;try{return BigInt(t),!0}catch{return!1}}),jC=I({budget:Z(g0),price:Z(g0),payment:Z(G(bi)),owner:Z(f())}),sc=I({version:re(1),sender:Z(f()),expiration:NC,gasConfig:jC,inputs:G(ma),transactions:G($w)});function m0(t){return en(t).replace("0x","")}let oc=class Jr{constructor(e){this.version=1,this.sender=e==null?void 0:e.sender,this.expiration=e==null?void 0:e.expiration,this.gasConfig=(e==null?void 0:e.gasConfig)??{},this.inputs=(e==null?void 0:e.inputs)??[],this.transactions=(e==null?void 0:e.transactions)??[]}static fromKindBytes(e){const n=ui.de("TransactionKind",e),i=n==null?void 0:n.ProgrammableTransaction;if(!i)throw new Error("Unable to deserialize from bytes.");const s=jn({version:1,gasConfig:{},inputs:i.inputs.map((o,r)=>jn({kind:"Input",value:o,index:r,type:Ut(o,tu)?"pure":"object"},ma)),transactions:i.transactions},sc);return Jr.restore(s)}static fromBytes(e){var r;const n=ui.de("TransactionData",e),i=n==null?void 0:n.V1,s=(r=i==null?void 0:i.kind)==null?void 0:r.ProgrammableTransaction;if(!i||!s)throw new Error("Unable to deserialize from bytes.");const o=jn({version:1,sender:i.sender,expiration:i.expiration,gasConfig:i.gasData,inputs:s.inputs.map((a,c)=>jn({kind:"Input",value:a,index:c,type:Ut(a,tu)?"pure":"object"},ma)),transactions:s.transactions},sc);return Jr.restore(o)}static restore(e){rr(e,sc);const n=new Jr;return Object.assign(n,e),n}static getDigestFromBytes(e){const n=LC("TransactionData",e);return ml(n)}build({maxSizeBytes:e=1/0,overrides:n,onlyTransactionKind:i}={}){const s=this.inputs.map(l=>(rr(l.value,na),l.value)),o={ProgrammableTransaction:{inputs:s,transactions:this.transactions}};if(i)return ui.ser("TransactionKind",o,{maxSize:e}).toBytes();const r=(n==null?void 0:n.expiration)??this.expiration,a=(n==null?void 0:n.sender)??this.sender,c={...this.gasConfig,...n==null?void 0:n.gasConfig};if(!a)throw new Error("Missing transaction sender");if(!c.budget)throw new Error("Missing gas budget");if(!c.payment)throw new Error("Missing gas payment");if(!c.price)throw new Error("Missing gas price");const u={sender:m0(a),expiration:r||{None:!0},gasData:{payment:c.payment,owner:m0(this.gasConfig.owner??a),price:BigInt(c.price),budget:BigInt(c.budget)},kind:{ProgrammableTransaction:{inputs:s,transactions:this.transactions}}};return ui.ser("TransactionData",{V1:u},{maxSize:e}).toBytes()}getDigest(){const e=this.build({onlyTransactionKind:!1});return Jr.getDigestFromBytes(e)}snapshot(){return jn(this,sc)}};var Tp=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},St=(t,e,n)=>(Tp(t,e,"read from private field"),n?n.call(t):e.get(t)),_s=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},rc=(t,e,n,i)=>(Tp(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),$n=(t,e,n)=>(Tp(t,e,"access private method"),n),mt,Ic,Yd,Us,oo,Ap,Uw,kp,Mw,Sp,Dw,xp,qw,Oc,Qd;const FC={maxPureArgumentSize:16*1024,maxTxGas:5e10,maxGasObjects:256,maxTxSizeBytes:128*1024};function zC(t){const e={kind:"Result",index:t},n=[],i=s=>n[s]??(n[s]={kind:"NestedResult",index:t,resultIndex:s});return new Proxy(e,{set(){throw new Error("The transaction result is a proxy, and does not support setting properties directly")},get(s,o){if(o in s)return Reflect.get(s,o);if(o===Symbol.iterator)return function*(){let a=0;for(;;)yield i(a),a++};if(typeof o=="symbol")return;const r=parseInt(o,10);if(!(Number.isNaN(r)||r<0))return i(r)}})}function _a(t){if(!t.client&&!t.provider)throw new Error("No provider passed to Transaction#build, but transaction data was not sufficient to build offline.");return t.client??t.provider}const eh=Symbol.for("@mysten/transaction"),pd={maxTxGas:"max_tx_gas",maxGasObjects:"max_gas_payment_objects",maxTxSizeBytes:"max_tx_size_bytes",maxPureArgumentSize:"max_pure_argument_size"},HC=1000n,KC=50,GC=(t,e)=>Array.from({length:Math.ceil(t.length/e)},(n,i)=>t.slice(i*e,i*e+e));function WC(t){return!!t&&typeof t=="object"&&t[eh]===!0}const VC=class th{constructor(e){_s(this,Ic),_s(this,Us),_s(this,Ap),_s(this,kp),_s(this,Sp),_s(this,xp),_s(this,Oc),_s(this,mt,void 0),rc(this,mt,new oc(e?e.blockData:void 0))}static is(e){return!!e&&typeof e=="object"&&e[eh]===!0}static fromKind(e){const n=new th;return rc(n,mt,oc.fromKindBytes(typeof e=="string"?ki(e):e)),n}static from(e){const n=new th;return typeof e!="string"||!e.startsWith("{")?rc(n,mt,oc.fromBytes(typeof e=="string"?ki(e):e)):rc(n,mt,oc.restore(JSON.parse(e))),n}static get Transactions(){return ms}static get Inputs(){return Ki}setSender(e){St(this,mt).sender=e}setSenderIfNotSet(e){St(this,mt).sender||(St(this,mt).sender=e)}setExpiration(e){St(this,mt).expiration=e}setGasPrice(e){St(this,mt).gasConfig.price=String(e)}setGasBudget(e){St(this,mt).gasConfig.budget=String(e)}setGasOwner(e){St(this,mt).gasConfig.owner=e}setGasPayment(e){St(this,mt).gasConfig.payment=e.map(n=>j0(n,bi))}get blockData(){return St(this,mt).snapshot()}get[eh](){return!0}get gas(){return{kind:"GasCoin"}}object(e){const n=f0(e);return St(this,mt).inputs.find(s=>s.type==="object"&&n===f0(s.value))??$n(this,Ic,Yd).call(this,"object",e)}objectRef(...e){return this.object(Ki.ObjectRef(...e))}sharedObjectRef(...e){return this.object(Ki.SharedObjectRef(...e))}pure(e,n){return $n(this,Ic,Yd).call(this,"pure",e instanceof Uint8Array?Ki.Pure(e):n?Ki.Pure(e,n):e)}add(e){const n=St(this,mt).transactions.push(e);return zC(n-1)}splitCoins(...e){return this.add(ms.SplitCoins(...e))}mergeCoins(...e){return this.add(ms.MergeCoins(...e))}publish(...e){return this.add(ms.Publish(...e))}upgrade(...e){return this.add(ms.Upgrade(...e))}moveCall(...e){return this.add(ms.MoveCall(...e))}transferObjects(...e){return this.add(ms.TransferObjects(...e))}makeMoveVec(...e){return this.add(ms.MakeMoveVec(...e))}serialize(){return JSON.stringify(St(this,mt).snapshot())}async sign(e){const{signer:n,...i}=e,s=await this.build(i);return n.signTransactionBlock(s)}async build(e={}){return await $n(this,Oc,Qd).call(this,e),St(this,mt).build({maxSizeBytes:$n(this,Us,oo).call(this,"maxTxSizeBytes",e),onlyTransactionKind:e.onlyTransactionKind})}async getDigest(e={}){return await $n(this,Oc,Qd).call(this,e),St(this,mt).getDigest()}};mt=new WeakMap;Ic=new WeakSet;Yd=function(t,e){const n=St(this,mt).inputs.length,i=jn({kind:"Input",value:typeof e=="bigint"?String(e):e,index:n,type:t},ma);return St(this,mt).inputs.push(i),i};Us=new WeakSet;oo=function(t,{protocolConfig:e,limits:n}){if(n&&typeof n[t]=="number")return n[t];if(!e)return FC[t];const i=e==null?void 0:e.attributes[pd[t]];if(!i)throw new Error(`Missing expected protocol config: "${pd[t]}"`);const s="u64"in i?i.u64:"u32"in i?i.u32:i.f64;if(!s)throw new Error(`Unexpected protocol config value found for: "${pd[t]}"`);return Number(s)};Ap=new WeakSet;Uw=function(t){const e=$n(this,Us,oo).call(this,"maxPureArgumentSize",t);St(this,mt).inputs.forEach((n,i)=>{if(Ut(n.value,tu)&&n.value.Pure.length>e)throw new Error(`Input at index ${i} is too large, max pure input size is ${e} bytes, got ${n.value.Pure.length} bytes`)})};kp=new WeakSet;Mw=async function(t){if(St(this,mt).gasConfig.payment){const s=$n(this,Us,oo).call(this,"maxGasObjects",t);if(St(this,mt).gasConfig.payment.length>s)throw new Error(`Payment objects exceed maximum amount: ${s}`)}if(t.onlyTransactionKind||St(this,mt).gasConfig.payment)return;const e=St(this,mt).gasConfig.owner??St(this,mt).sender,i=(await _a(t).getCoins({owner:e,coinType:lC})).data.filter(s=>!St(this,mt).inputs.find(r=>Ut(r.value,na)&&"Object"in r.value&&"ImmOrOwned"in r.value.Object?s.coinObjectId===r.value.Object.ImmOrOwned.objectId:!1)).slice(0,$n(this,Us,oo).call(this,"maxGasObjects",t)-1).map(s=>({objectId:s.coinObjectId,digest:s.digest,version:s.version}));if(!i.length)throw new Error("No valid gas coins found for the transaction.");this.setGasPayment(i)};Sp=new WeakSet;Dw=async function(t){t.onlyTransactionKind||St(this,mt).gasConfig.price||this.setGasPrice(await _a(t).getReferenceGasPrice())};xp=new WeakSet;qw=async function(t){const{inputs:e,transactions:n}=St(this,mt),i=[],s=[];if(n.forEach(o=>{if(o.kind==="MoveCall"){o.arguments.some(c=>c.kind==="Input"&&!Ut(e[c.index].value,na))&&i.push(o);return}const r=qC(o);r.schema&&Object.entries(o).forEach(([a,c])=>{if(a==="kind")return;const u=r.schema[a],l=u.type==="array",d=l?u.schema[nu]:u[nu];if(!d)return;const p=g=>{const b=e[g];if(!b)throw new Error(`Missing input ${c.index}`);if(!Ut(b.value,na))if(d.kind==="object"&&typeof b.value=="string")s.push({id:b.value,input:b});else if(d.kind==="pure")b.value=Ki.Pure(b.value,d.type);else throw new Error("Unexpected input format.")};if(l)c.forEach(g=>{g.kind==="Input"&&p(g.index)});else{if(c.kind!=="Input")return;p(c.index)}})}),i.length&&await Promise.all(i.map(async o=>{const[r,a,c]=o.target.split("::"),u=await _a(t).getNormalizedMoveFunction({package:gn(r),module:a,function:c}),d=u.parameters.length>0&&vC(u.parameters.at(-1))?u.parameters.slice(0,u.parameters.length-1):u.parameters;if(d.length!==o.arguments.length)throw new Error("Incorrect number of arguments.");d.forEach((p,g)=>{const b=o.arguments[g];if(b.kind!=="Input")return;const w=e[b.index];if(Ut(w.value,na))return;const T=w.value,E=Xd(p,T);if(E){w.value=Ki.Pure(T,E);return}if(yw(p)!=null||typeof p=="object"&&"TypeParameter"in p){if(typeof T!="string")throw new Error(`Expect the argument to be an object id string, got ${JSON.stringify(T,null,2)}`);s.push({id:T,input:w,normalizedType:p});return}throw new Error(`Unknown call arg type ${JSON.stringify(p,null,2)} for value ${JSON.stringify(T,null,2)}`)})})),s.length){const o=[...new Set(s.map(({id:l})=>l))],r=GC(o,KC),a=(await Promise.all(r.map(l=>_a(t).multiGetObjects({ids:l,options:{showOwner:!0}})))).flat();let c=new Map(o.map((l,d)=>[l,a[d]]));const u=Array.from(c).filter(([l,d])=>d.error).map(([l,d])=>l);if(u.length)throw new Error(`The following input objects are invalid: ${u.join(", ")}`);s.forEach(({id:l,input:d,normalizedType:p})=>{var T;const g=c.get(l),b=(T=g.data)==null?void 0:T.owner,w=b&&typeof b=="object"&&"Shared"in b?b.Shared.initial_shared_version:void 0;if(w){const E=UC(d.value)||p!=null&&_w(p)!=null;d.value=Ki.SharedObjectRef({objectId:l,initialSharedVersion:w,mutable:E})}else d.value=Ki.ObjectRef(dE(g))})}};Oc=new WeakSet;Qd=async function(t){if(!t.onlyTransactionKind&&!St(this,mt).sender)throw new Error("Missing transaction sender");const e=t.client||t.provider;if(!t.protocolConfig&&!t.limits&&e&&(t.protocolConfig=await e.getProtocolConfig()),await Promise.all([$n(this,Sp,Dw).call(this,t),$n(this,xp,qw).call(this,t)]),!t.onlyTransactionKind&&(await $n(this,kp,Mw).call(this,t),!St(this,mt).gasConfig.budget)){const n=await _a(t).dryRunTransactionBlock({transactionBlock:St(this,mt).build({maxSizeBytes:$n(this,Us,oo).call(this,"maxTxSizeBytes",t),overrides:{gasConfig:{budget:String($n(this,Us,oo).call(this,"maxTxGas",t)),payment:[]}}})});if(n.effects.status.status!=="success")throw new Error(`Dry run failed, could not automatically determine a budget: ${n.effects.status.error}`,{cause:n});const i=HC*BigInt(this.blockData.gasConfig.price||1n),s=BigInt(n.effects.gasUsed.computationCost)+i,o=s+BigInt(n.effects.gasUsed.storageCost)-BigInt(n.effects.gasUsed.storageRebate);this.setGasBudget(o>s?o:s)}$n(this,Ap,Uw).call(this,t)};let Ct=VC,ac;const XC=new Uint8Array(16);function JC(){if(!ac&&(ac=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ac))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ac(XC)}const ln=[];for(let t=0;t<256;++t)ln.push((t+256).toString(16).slice(1));function ZC(t,e=0){return ln[t[e+0]]+ln[t[e+1]]+ln[t[e+2]]+ln[t[e+3]]+"-"+ln[t[e+4]]+ln[t[e+5]]+"-"+ln[t[e+6]]+ln[t[e+7]]+"-"+ln[t[e+8]]+ln[t[e+9]]+"-"+ln[t[e+10]]+ln[t[e+11]]+ln[t[e+12]]+ln[t[e+13]]+ln[t[e+14]]+ln[t[e+15]]}const YC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_0={randomUUID:YC};function y0(t,e,n){if(_0.randomUUID&&!e&&!t)return _0.randomUUID();t=t||{};const i=t.random||(t.rng||JC)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=i[s];return e}return ZC(i)}const QC="0.41.2",eB="1.10.0";var Pp=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},oi=(t,e,n)=>(Pp(t,e,"read from private field"),n?n.call(t):e.get(t)),jr=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ys=(t,e,n,i)=>(Pp(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),tB=(t,e,n,i)=>({set _(s){Ys(t,e,s,n)},get _(){return oi(t,e,i)}}),nh=(t,e,n)=>(Pp(t,e,"access private method"),n),Ui,Ps,nr,Rc,ih,Ep,Lw;const nB=(t,e)=>{const n=new URL(t);return n.protocol=n.protocol.replace("http","ws"),e&&(n.port=e.toString()),n.toString()},iB={callTimeout:3e4,reconnectTimeout:3e3,maxReconnects:5};class sB{constructor(e,n={}){jr(this,Rc),jr(this,Ep),jr(this,Ui,void 0),jr(this,Ps,void 0),jr(this,nr,void 0),this.endpoint=e,this.options={...iB,...n},this.endpoint.startsWith("http")&&(this.endpoint=nB(this.endpoint)),Ys(this,Ui,null),Ys(this,Ps,new Map),Ys(this,nr,0)}async request(e){const i=await nh(this,Rc,ih).call(this).request({method:e.method,params:e.params},this.options.callTimeout),s=e.initialId||i;return oi(this,Ps).set(s,{...e,id:i,initialId:s}),async()=>{const o=nh(this,Rc,ih).call(this),r=oi(this,Ps).get(s);return r?(oi(this,Ps).delete(s),o.request({method:e.unsubscribe,params:[r.id]},this.options.callTimeout)):!1}}}Ui=new WeakMap;Ps=new WeakMap;nr=new WeakMap;Rc=new WeakSet;ih=function(){if(oi(this,Ui))return oi(this,Ui);const t=new Wo.WebSocketTransport(this.endpoint),e=new Wo.RequestManager([t]);return Ys(this,Ui,new Wo.Client(e)),t.connection.addEventListener("open",()=>{Ys(this,nr,0)}),t.connection.addEventListener("close",()=>{tB(this,nr)._++,oi(this,nr)<=this.options.maxReconnects&&setTimeout(()=>{nh(this,Ep,Lw).call(this)},this.options.reconnectTimeout)}),oi(this,Ui).onNotification(n=>{const i=n.params;oi(this,Ps).forEach(s=>{s.method===n.method&&i.subscription===s.id&&s.onMessage(i.result)})}),oi(this,Ui)};Ep=new WeakSet;Lw=function(){var t;(t=oi(this,Ui))==null||t.close(),Ys(this,Ui,null),oi(this,Ps).forEach(e=>this.request(e))};class oB{constructor({url:e,websocket:{url:n,...i}={},rpc:s}){const o=new Wo.HTTPTransport((s==null?void 0:s.url)??e,{headers:{"Content-Type":"application/json","Client-Sdk-Type":"typescript","Client-Sdk-Version":QC,"Client-Target-Api-Version":eB,...s==null?void 0:s.headers}});this.rpcClient=new Wo.Client(new Wo.RequestManager([o])),this.websocketClient=new sB(n??e,i)}async request(e){return await this.rpcClient.request(e)}async subscribe(e){const n=await this.websocketClient.request(e);return async()=>!!await n()}}const rB=Symbol.for("@mysten/SuiClient");class aB{get[rB](){return!0}constructor(e){this.transport=e.transport??new oB({url:e.url})}async getRpcApiVersion(){return(await this.transport.request({method:"rpc.discover",params:[]})).info.version}async getCoins(e){if(!e.owner||!xs(en(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getCoins",params:[e.owner,e.coinType,e.cursor,e.limit]})}async getAllCoins(e){if(!e.owner||!xs(en(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllCoins",params:[e.owner,e.cursor,e.limit]})}async getBalance(e){if(!e.owner||!xs(en(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getBalance",params:[e.owner,e.coinType]})}async getAllBalances(e){if(!e.owner||!xs(en(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllBalances",params:[e.owner]})}async getCoinMetadata(e){return await this.transport.request({method:"suix_getCoinMetadata",params:[e.coinType]})}async getTotalSupply(e){return await this.transport.request({method:"suix_getTotalSupply",params:[e.coinType]})}async call(e,n){return await this.transport.request({method:e,params:n})}async getMoveFunctionArgTypes(e){return await this.transport.request({method:"sui_getMoveFunctionArgTypes",params:[e.package,e.module,e.function]})}async getNormalizedMoveModulesByPackage(e){return await this.transport.request({method:"sui_getNormalizedMoveModulesByPackage",params:[e.package]})}async getNormalizedMoveModule(e){return await this.transport.request({method:"sui_getNormalizedMoveModule",params:[e.package,e.module]})}async getNormalizedMoveFunction(e){return await this.transport.request({method:"sui_getNormalizedMoveFunction",params:[e.package,e.module,e.function]})}async getNormalizedMoveStruct(e){return await this.transport.request({method:"sui_getNormalizedMoveStruct",params:[e.package,e.module,e.struct]})}async getOwnedObjects(e){if(!e.owner||!xs(en(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getOwnedObjects",params:[e.owner,{filter:e.filter,options:e.options},e.cursor,e.limit]})}async getObject(e){if(!e.id||!Xr(gn(e.id)))throw new Error("Invalid Sui Object id");return await this.transport.request({method:"sui_getObject",params:[e.id,e.options]})}async tryGetPastObject(e){return await this.transport.request({method:"sui_tryGetPastObject",params:[e.id,e.version,e.options]})}async multiGetObjects(e){if(e.ids.forEach(i=>{if(!i||!Xr(gn(i)))throw new Error(`Invalid Sui Object id ${i}`)}),e.ids.length!==new Set(e.ids).size)throw new Error(`Duplicate object ids in batch call ${e.ids}`);return await this.transport.request({method:"sui_multiGetObjects",params:[e.ids,e.options]})}async queryTransactionBlocks(e){return await this.transport.request({method:"suix_queryTransactionBlocks",params:[{filter:e.filter,options:e.options},e.cursor,e.limit,(e.order||"descending")==="descending"]})}async getTransactionBlock(e){if(!c0(e.digest))throw new Error("Invalid Transaction digest");return await this.transport.request({method:"sui_getTransactionBlock",params:[e.digest,e.options]})}async multiGetTransactionBlocks(e){if(e.digests.forEach(i=>{if(!c0(i))throw new Error(`Invalid Transaction digest ${i}`)}),e.digests.length!==new Set(e.digests).size)throw new Error(`Duplicate digests in batch call ${e.digests}`);return await this.transport.request({method:"sui_multiGetTransactionBlocks",params:[e.digests,e.options]})}async executeTransactionBlock(e){return await this.transport.request({method:"sui_executeTransactionBlock",params:[typeof e.transactionBlock=="string"?e.transactionBlock:Gs(e.transactionBlock),Array.isArray(e.signature)?e.signature:[e.signature],e.options,e.requestType]})}async signAndExecuteTransactionBlock({transactionBlock:e,signer:n,...i}){let s;e instanceof Uint8Array?s=e:(e.setSenderIfNotSet(await n.getPublicKey().toSuiAddress()),s=await e.build({client:this}));const{signature:o,bytes:r}=await n.signTransactionBlock(s);return this.executeTransactionBlock({transactionBlock:r,signature:o,...i})}async getTotalTransactionBlocks(){const e=await this.transport.request({method:"sui_getTotalTransactionBlocks",params:[]});return BigInt(e)}async getReferenceGasPrice(){const e=await this.transport.request({method:"suix_getReferenceGasPrice",params:[]});return BigInt(e)}async getStakes(e){if(!e.owner||!xs(en(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getStakes",params:[e.owner]})}async getStakesByIds(e){return e.stakedSuiIds.forEach(n=>{if(!n||!Xr(gn(n)))throw new Error(`Invalid Sui Stake id ${n}`)}),await this.transport.request({method:"suix_getStakesByIds",params:[e.stakedSuiIds]})}async getLatestSuiSystemState(){return await this.transport.request({method:"suix_getLatestSuiSystemState",params:[]})}async queryEvents(e){return await this.transport.request({method:"suix_queryEvents",params:[e.query,e.cursor,e.limit,(e.order||"descending")==="descending"]})}async subscribeEvent(e){return this.transport.subscribe({method:"suix_subscribeEvent",unsubscribe:"suix_unsubscribeEvent",params:[e.filter],onMessage:e.onMessage})}async subscribeTransaction(e){return this.transport.subscribe({method:"suix_subscribeTransaction",unsubscribe:"suix_unsubscribeTransaction",params:[e.filter],onMessage:e.onMessage})}async devInspectTransactionBlock(e){let n;if(WC(e.transactionBlock))e.transactionBlock.setSenderIfNotSet(e.sender),n=Gs(await e.transactionBlock.build({client:this,onlyTransactionKind:!0}));else if(typeof e.transactionBlock=="string")n=e.transactionBlock;else if(e.transactionBlock instanceof Uint8Array)n=Gs(e.transactionBlock);else throw new Error("Unknown transaction block format.");return await this.transport.request({method:"sui_devInspectTransactionBlock",params:[e.sender,n,e.gasPrice,e.epoch]})}async dryRunTransactionBlock(e){return await this.transport.request({method:"sui_dryRunTransactionBlock",params:[typeof e.transactionBlock=="string"?e.transactionBlock:Gs(e.transactionBlock)]})}async getDynamicFields(e){if(!e.parentId||!Xr(gn(e.parentId)))throw new Error("Invalid Sui Object id");return await this.transport.request({method:"suix_getDynamicFields",params:[e.parentId,e.cursor,e.limit]})}async getDynamicFieldObject(e){return await this.transport.request({method:"suix_getDynamicFieldObject",params:[e.parentId,e.name]})}async getLatestCheckpointSequenceNumber(){const e=await this.transport.request({method:"sui_getLatestCheckpointSequenceNumber",params:[]});return String(e)}async getCheckpoint(e){return await this.transport.request({method:"sui_getCheckpoint",params:[e.id]})}async getCheckpoints(e){return await this.transport.request({method:"sui_getCheckpoints",params:[e.cursor,e==null?void 0:e.limit,e.descendingOrder]})}async getCommitteeInfo(e){return await this.transport.request({method:"suix_getCommitteeInfo",params:[e==null?void 0:e.epoch]})}async getNetworkMetrics(){return await this.transport.request({method:"suix_getNetworkMetrics",params:[]})}async getAddressMetrics(){return await this.transport.request({method:"suix_getLatestAddressMetrics",params:[]})}async getAllEpochAddressMetrics(e){return await this.transport.request({method:"suix_getAllEpochAddressMetrics",params:[e==null?void 0:e.descendingOrder]})}async getEpochs(e){return await this.transport.request({method:"suix_getEpochs",params:[e==null?void 0:e.cursor,e==null?void 0:e.limit,e==null?void 0:e.descendingOrder]})}async getMoveCallMetrics(){return await this.transport.request({method:"suix_getMoveCallMetrics",params:[]})}async getCurrentEpoch(){return await this.transport.request({method:"suix_getCurrentEpoch",params:[]})}async getValidatorsApy(){return await this.transport.request({method:"suix_getValidatorsApy",params:[]})}async getChainIdentifier(){const e=await this.getCheckpoint({id:"0"}),n=_l(e.digest);return gl(n.slice(0,4))}async resolveNameServiceAddress(e){return await this.transport.request({method:"suix_resolveNameServiceAddress",params:[e.name]})}async resolveNameServiceNames(e){return await this.transport.request({method:"suix_resolveNameServiceNames",params:[e.address,e.cursor,e.limit]})}async getProtocolConfig(e){return await this.transport.request({method:"sui_getProtocolConfig",params:[e==null?void 0:e.version]})}async waitForTransactionBlock({signal:e,timeout:n=60*1e3,pollInterval:i=2*1e3,...s}){const o=AbortSignal.timeout(n),r=new Promise((a,c)=>{o.addEventListener("abort",()=>c(o.reason))});for(r.catch(()=>{});!o.aborted;){e==null||e.throwIfAborted();try{return await this.getTransactionBlock(s)}catch{await Promise.race([new Promise(c=>setTimeout(c,i)),r])}}throw o.throwIfAborted(),new Error("Unexpected error while waiting for transaction block.")}}var cB=Object.defineProperty,uB=(t,e,n)=>e in t?cB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lB=(t,e,n)=>(uB(t,typeof e!="symbol"?e+"":e,n),n),Vn=5*60*1e3,Ee=24*60*60*1e3;function bt(t){return Date.parse(new Date().toString())+t}var kn=class{constructor(t,e=0){xe(this,"overdueTime");xe(this,"value");this.overdueTime=e,this.value=t}isValid(){return this.value===null?!1:this.overdueTime===0?!0:!(Date.parse(new Date().toString())>this.overdueTime)}};ie.config({precision:64,rounding:ie.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var pn=ie,hn=class extends Error{constructor(e,n){super(e);xe(this,"message");xe(this,"errorCode");this.message=e,this.errorCode=n}static isClmmpoolsErrorCode(e,n){return e instanceof hn&&e.errorCode===n}},Ue=new y(0),Mi=new y(1),yl=new y(2);yl.pow(new y(128));var Ar=yl.pow(new y(64)).sub(Mi),dB=yl.pow(new y(128)).sub(Mi),at=class{static toX64_BN(t){return t.mul(new y(2).pow(new y(64)))}static toX64_Decimal(t){return t.mul(pn.pow(2,64))}static toX64(t){return new y(t.mul(pn.pow(2,64)).floor().toFixed())}static fromX64(t){return new pn(t.toString()).mul(pn.pow(2,-64))}static fromX64_Decimal(t){return t.mul(pn.pow(2,-64))}static fromX64_BN(t){return t.div(new y(2).pow(new y(64)))}static shiftRightRoundUp(t){let e=t.shrn(64);return t.mod(Ar).gt(Ue)&&(e=e.add(Mi)),e}static divRoundUp(t,e){return t.mod(e).eq(Ue)?t.div(e):t.div(e).add(new y(1))}static subUnderflowU128(t,e){return t.lt(e)?t.sub(e).add(dB):t.sub(e)}static checkUnsignedSub(t,e){const n=t.sub(e);if(n.isNeg())throw new hn("Unsigned integer sub overflow","UnsignedIntegerOverflow");return n}static checkMul(t,e,n){const i=t.mul(e);if(this.isOverflow(i,n))throw new hn("Multiplication overflow","MultiplicationOverflow");return i}static checkMulDivFloor(t,e,n,i){if(n.eq(Ue))throw new hn("Devide by zero","DivideByZero");const s=t.mul(e).div(n);if(this.isOverflow(s,i))throw new hn("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivCeil(t,e,n,i){if(n.eq(Ue))throw new hn("Devide by zero","DivideByZero");const s=t.mul(e).add(n.sub(Mi)).div(n);if(this.isOverflow(s,i))throw new hn("Multiplication div overflow","MulDivOverflow");return s}static checkMulDivRound(t,e,n,i){if(n.eq(Ue))throw new hn("Devide by zero","DivideByZero");const s=t.mul(e.add(n.shrn(1))).div(n);if(this.isOverflow(s,i))throw new hn("Multiplication div overflow","MulDivOverflow");return s}static checkMulShiftRight(t,e,n,i){const s=t.mul(e).div(new y(2).pow(new y(n)));if(this.isOverflow(s,i))throw new hn("Multiplication shift right overflow","MulShiftRightOverflow");return s}static checkMulShiftRight64RoundUpIf(t,e,n,i){const s=t.mul(e),r=i&&s.and(Ar).gt(Ue)?s.shrn(64).add(Mi):s.shrn(64);if(this.isOverflow(r,n))throw new hn("Multiplication shift right overflow","MulShiftRightOverflow");return r}static checkMulShiftLeft(t,e,n,i){const s=t.mul(e).shln(n);if(this.isOverflow(s,i))throw new hn("Multiplication shift left overflow","MulShiftLeftOverflow");return s}static checkDivRoundUpIf(t,e,n){if(e.eq(Ue))throw new hn("Devide by zero","DivideByZero");return n?this.divRoundUp(t,e):t.div(e)}static isOverflow(t,e){return t.gte(yl.pow(new y(e)))}};function hB(t){return{coinA:t.coinTypeA,coinB:t.coinTypeB,currentSqrtPrice:new y(t.current_sqrt_price),currentTickIndex:t.current_tick_index,feeGrowthGlobalA:new y(t.fee_growth_global_a),feeGrowthGlobalB:new y(t.fee_growth_global_b),feeProtocolCoinA:new y(t.fee_protocol_coin_a),feeProtocolCoinB:new y(t.fee_protocol_coin_b),feeRate:new y(t.fee_rate),liquidity:new y(t.liquidity),tickIndexes:[],tickSpacing:Number(t.tickSpacing),ticks:[],collection_name:""}}var sh=443636,oh=-443636,wl="79226673515401279992447579055",bl="4295048016",Ho=new y(1e6),fe="0x0000000000000000000000000000000000000000000000000000000000000006",ia="pool_script",Is="pool_script_v2",ir="router",w0="router_with_partner",di="fetcher_script",pB="expect_swap",fB="utils",fd="custodian_v2",gB="clob_v2",mB="endpoints_v2",Nw=(t=>(t.Deleted="Deleted",t.Exists="Exists",t.NotExists="NotExists",t))(Nw||{});function W(t){if(t.config===void 0)throw Error(`package: ${t.package_id}  not config in sdk SdkOptions`);return t.config}var _B=14,yB="59543866431248",wB="184467440737095516",bB="15793534762490258745",vB=443636;function TB(t,e,n){const i=t.toTwos(n).shln(e);return i.imaskn(n+1),i.fromTwos(n)}function lt(t,e,n){const i=t.toTwos(n).shrn(e);return i.imaskn(n-e+1),i.fromTwos(n-e)}function AB(t){let e;return t&1?e=new y("79232123823359799118286999567"):e=new y("79228162514264337593543950336"),t&2&&(e=lt(e.mul(new y("79236085330515764027303304731")),96,256)),t&4&&(e=lt(e.mul(new y("79244008939048815603706035061")),96,256)),t&8&&(e=lt(e.mul(new y("79259858533276714757314932305")),96,256)),t&16&&(e=lt(e.mul(new y("79291567232598584799939703904")),96,256)),t&32&&(e=lt(e.mul(new y("79355022692464371645785046466")),96,256)),t&64&&(e=lt(e.mul(new y("79482085999252804386437311141")),96,256)),t&128&&(e=lt(e.mul(new y("79736823300114093921829183326")),96,256)),t&256&&(e=lt(e.mul(new y("80248749790819932309965073892")),96,256)),t&512&&(e=lt(e.mul(new y("81282483887344747381513967011")),96,256)),t&1024&&(e=lt(e.mul(new y("83390072131320151908154831281")),96,256)),t&2048&&(e=lt(e.mul(new y("87770609709833776024991924138")),96,256)),t&4096&&(e=lt(e.mul(new y("97234110755111693312479820773")),96,256)),t&8192&&(e=lt(e.mul(new y("119332217159966728226237229890")),96,256)),t&16384&&(e=lt(e.mul(new y("179736315981702064433883588727")),96,256)),t&32768&&(e=lt(e.mul(new y("407748233172238350107850275304")),96,256)),t&65536&&(e=lt(e.mul(new y("2098478828474011932436660412517")),96,256)),t&131072&&(e=lt(e.mul(new y("55581415166113811149459800483533")),96,256)),t&262144&&(e=lt(e.mul(new y("38992368544603139932233054999993551")),96,256)),lt(e,32,256)}function kB(t){const e=Math.abs(t);let n;return e&1?n=new y("18445821805675392311"):n=new y("18446744073709551616"),e&2&&(n=lt(n.mul(new y("18444899583751176498")),64,256)),e&4&&(n=lt(n.mul(new y("18443055278223354162")),64,256)),e&8&&(n=lt(n.mul(new y("18439367220385604838")),64,256)),e&16&&(n=lt(n.mul(new y("18431993317065449817")),64,256)),e&32&&(n=lt(n.mul(new y("18417254355718160513")),64,256)),e&64&&(n=lt(n.mul(new y("18387811781193591352")),64,256)),e&128&&(n=lt(n.mul(new y("18329067761203520168")),64,256)),e&256&&(n=lt(n.mul(new y("18212142134806087854")),64,256)),e&512&&(n=lt(n.mul(new y("17980523815641551639")),64,256)),e&1024&&(n=lt(n.mul(new y("17526086738831147013")),64,256)),e&2048&&(n=lt(n.mul(new y("16651378430235024244")),64,256)),e&4096&&(n=lt(n.mul(new y("15030750278693429944")),64,256)),e&8192&&(n=lt(n.mul(new y("12247334978882834399")),64,256)),e&16384&&(n=lt(n.mul(new y("8131365268884726200")),64,256)),e&32768&&(n=lt(n.mul(new y("3584323654723342297")),64,256)),e&65536&&(n=lt(n.mul(new y("696457651847595233")),64,256)),e&131072&&(n=lt(n.mul(new y("26294789957452057")),64,256)),e&262144&&(n=lt(n.mul(new y("37481735321082")),64,256)),n}var Se=class{static priceToSqrtPriceX64(t,e,n){return at.toX64(t.mul(pn.pow(10,n-e)).sqrt())}static sqrtPriceX64ToPrice(t,e,n){return at.fromX64(t).pow(2).mul(pn.pow(10,e-n))}static tickIndexToSqrtPriceX64(t){return t>0?new y(AB(t)):new y(kB(t))}static sqrtPriceX64ToTickIndex(t){if(t.gt(new y(wl))||t.lt(new y(bl)))throw new Error("Provided sqrtPrice is not within the supported sqrtPrice range.");const e=t.bitLength()-1,n=new y(e-64),i=TB(n,32,128);let s=new y("8000000000000000","hex"),o=0,r=new y(0),a=e>=64?t.shrn(e-63):t.shln(63-e);for(;s.gt(new y(0))&&o<_B;){a=a.mul(a);const b=a.shrn(127);a=a.shrn(63+b.toNumber()),r=r.add(s.mul(b)),s=s.shrn(1),o+=1}const c=r.shrn(32),l=i.add(c).mul(new y(yB)),d=lt(l.sub(new y(wB)),64,128).toNumber(),p=lt(l.add(new y(bB)),64,128).toNumber();return d===p?d:Se.tickIndexToSqrtPriceX64(p).lte(t)?p:d}static tickIndexToPrice(t,e,n){return Se.sqrtPriceX64ToPrice(Se.tickIndexToSqrtPriceX64(t),e,n)}static priceToTickIndex(t,e,n){return Se.sqrtPriceX64ToTickIndex(Se.priceToSqrtPriceX64(t,e,n))}static priceToInitializableTickIndex(t,e,n,i){return Se.getInitializableTickIndex(Se.priceToTickIndex(t,e,n),i)}static getInitializableTickIndex(t,e){return t-t%e}static getNextInitializableTickIndex(t,e){return Se.getInitializableTickIndex(t,e)+e}static getPrevInitializableTickIndex(t,e){return Se.getInitializableTickIndex(t,e)-e}};function SB(t){const e=[];for(const n of t){const i={objectId:n.objectId,index:Number(Zt(BigInt(n.index)).toString()),sqrtPrice:n.sqrtPrice,liquidityNet:new y(BigInt.asIntN(128,BigInt(BigInt(n.liquidityNet.toString()))).toString()),liquidityGross:n.liquidityGross,feeGrowthOutsideA:n.feeGrowthOutsideA,feeGrowthOutsideB:n.feeGrowthOutsideB,rewardersGrowthOutside:[new y(n.rewardersGrowthOutside[0]),new y(n.rewardersGrowthOutside[1]),new y(n.rewardersGrowthOutside[2])]};e.push(i)}return e}function xB(t){return U(t).add(U(vB))}new y(365);new y(24);new y(3600);new y(.5);function PB(t,e,n,i){const s=Math.max(t,n),r=Math.min(e,i)-s,a=e-t,c=i-n,u=new ie(a.toString()),l=new ie(c.toString()),d=new ie(r.toString());let p=new ie("0");return r<0?p=new ie("0"):a===r?p=l.div(d):c===r?p=d.div(u):p=d.mul(d).div(l).div(u),p}var Gi=class{static getDefaultSqrtPriceLimit(t){return new y(t?bl:wl)}static getDefaultOtherAmountThreshold(t){return t?Ue:Ar}};function jw(t,e,n,i){if(n.eq(Ue))return t;const s=at.checkMulShiftLeft(t,e,64,256),o=e.shln(64),r=at.checkMul(t,n,256);if(!i&&o.lte(r))throw new hn("getNextSqrtPriceAUp - Unable to divide liquidityShl64 by product","DivideByZero");const a=i?at.checkDivRoundUpIf(s,o.add(r),!0):at.checkDivRoundUpIf(s,o.sub(r),!0);if(a.lt(new y(bl)))throw new hn("getNextSqrtPriceAUp - Next sqrt price less than min sqrt price","CoinAmountMinSubceeded ");if(a.gt(new y(wl)))throw new hn("getNextSqrtPriceAUp - Next sqrt price greater than max sqrt price","CoinAmountMaxExceeded");return a}function Fw(t,e,n,i){const s=at.checkDivRoundUpIf(n.shln(64),e,!i),o=i?t.add(s):t.sub(s);if(o.lt(new y(bl))||o.gt(new y(wl)))throw new hn("getNextSqrtPriceAUp - Next sqrt price out of bounds","SqrtPriceOutOfBounds");return o}function EB(t,e,n,i){return i?jw(t,e,n,!0):Fw(t,e,n,!0)}function CB(t,e,n,i){return i?Fw(t,e,n,!1):jw(t,e,n,!1)}function b0(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(Ue)||s.eq(Ue))return Ue;let o;if(i){const r=new y(n).mul(new y(s)).shln(64),a=e.mul(t),c=r.div(a);o=r.mod(a).eq(Ue)?c:c.add(Mi)}else{const r=new y(n).mul(new y(s));o=r.and(Ar).gt(Ue)?r.shrn(64).add(Mi):r.shrn(64)}return o}function v0(t,e,n,i){const s=t.gt(e)?t.sub(e):e.sub(t);if(n.lte(Ue)||s.eq(Ue))return Ue;let o;if(i)o=n.mul(s).shrn(64);else{const r=n.mul(s).shln(64),a=e.mul(t);o=r.div(a)}return o}function BB(t,e,n,i,s,o){if(n===Ue)return{amountIn:Ue,amountOut:Ue,nextSqrtPrice:e,feeAmount:Ue};const r=t.gte(e);let a,c,u,l;if(o){const d=at.checkMulDivFloor(i,at.checkUnsignedSub(Ho,s),Ho,64),p=b0(t,e,n,r);p.gt(d)?(a=d,l=at.checkUnsignedSub(i,d),u=EB(t,n,d,r)):(a=p,l=at.checkMulDivCeil(a,s,Ho.sub(s),64),u=e),c=v0(t,u,n,r)}else{const d=v0(t,e,n,r);d.gt(i)?(c=i,u=CB(t,n,i,r)):(c=d,u=e),a=b0(t,u,n,r),l=at.checkMulDivCeil(a,s,Ho.sub(s),64)}return{amountIn:a,amountOut:c,nextSqrtPrice:u,feeAmount:l}}function IB(t,e,n,i,s){let o=n,r=i.liquidity,{currentSqrtPrice:a}=i;const c={amountIn:Ue,amountOut:Ue,feeAmount:Ue,refAmount:Ue,nextSqrtPrice:Ue,crossTickNum:0};let u,l;const d=Gi.getDefaultSqrtPriceLimit(t);for(const p of s){if(t&&i.currentTickIndex<p.index||!t&&i.currentTickIndex>p.index||p===null)continue;t&&d.gt(p.sqrtPrice)||!t&&d.lt(p.sqrtPrice)?u=d:u=p.sqrtPrice;const g=BB(a,u,r,o,i.feeRate,e);if(g.amountIn.eq(Ue)||(o=e?o.sub(g.amountIn.add(g.feeAmount)):o.sub(g.amountOut)),c.amountIn=c.amountIn.add(g.amountIn),c.amountOut=c.amountOut.add(g.amountOut),c.feeAmount=c.feeAmount.add(g.feeAmount),g.nextSqrtPrice.eq(p.sqrtPrice)?(l=t?p.liquidityNet.mul(new y(-1)):p.liquidityNet,r=l.gt(Ue)?r.add(l):r.sub(l.abs()),a=p.sqrtPrice):a=g.nextSqrtPrice,c.crossTickNum+=1,o.eq(Ue))break}return c.amountIn=c.amountIn.add(c.feeAmount),c.nextSqrtPrice=a,c}function Zr(t,e,n){const i=y.min(t,e),s=y.max(t,e),o=at.fromX64_BN(n.mul(s).mul(i)),r=s.sub(i);return o.div(r)}function Yr(t,e,n){const i=y.min(t,e),o=y.max(t,e).sub(i);return n.shln(64).div(o)}var It=class{static updateFeeRate(t,e,n,i,s){const o=at.checkMulDivCeil(e,new y(i),Ho,64),r=n===0?Ue:at.checkMulDivFloor(e,new y(n),Ho,64),a=e.mul(o).mul(r);if(s?t.feeProtocolCoinA=t.feeProtocolCoinA.add(o):t.feeProtocolCoinB=t.feeProtocolCoinB.add(o),a.eq(Ue)||t.liquidity.eq(Ue))return{refFee:r,clmm:t};const c=a.shln(64).div(t.liquidity);return s?t.feeGrowthGlobalA=t.feeGrowthGlobalA.add(c):t.feeGrowthGlobalB=t.feeGrowthGlobalB.add(c),{refFee:r,clmm:t}}static getCoinAmountFromLiquidity(t,e,n,i,s){const o=new pn(t.toString()),r=new pn(e.toString()),a=new pn(n.toString()),c=new pn(i.toString());let u,l;return e.lt(n)?(u=at.toX64_Decimal(o).mul(c.sub(a)).div(a.mul(c)),l=new pn(0)):e.lt(i)?(u=at.toX64_Decimal(o).mul(c.sub(r)).div(r.mul(c)),l=at.fromX64_Decimal(o.mul(r.sub(a)))):(u=new pn(0),l=at.fromX64_Decimal(o.mul(c.sub(a)))),s?{coinA:new y(u.ceil().toString()),coinB:new y(l.ceil().toString())}:{coinA:new y(u.floor().toString()),coinB:new y(l.floor().toString())}}static estLiquidityAndcoinAmountFromOneAmounts(t,e,n,i,s,o,r){const a=Se.sqrtPriceX64ToTickIndex(r),c=Se.tickIndexToSqrtPriceX64(t),u=Se.tickIndexToSqrtPriceX64(e);let l;if(a<t){if(!i)throw new Error("lower tick cannot calculate liquidity by coinB");l=Zr(c,u,n)}else if(a>e){if(i)throw new Error("upper tick cannot calculate liquidity by coinA");l=Yr(u,c,n)}else i?l=Zr(r,u,n):l=Yr(r,c,n);const d=It.getCoinAmountFromLiquidity(l,r,c,u,s),p=s?U(d.coinA.toString()).mul(1+o).toString():U(d.coinA.toString()).mul(1-o).toString(),g=s?U(d.coinB.toString()).mul(1+o).toString():U(d.coinB.toString()).mul(1-o).toString();return{coinAmountA:d.coinA,coinAmountB:d.coinB,tokenMaxA:s?new y(pn.ceil(p).toString()):new y(pn.floor(p).toString()),tokenMaxB:s?new y(pn.ceil(g).toString()):new y(pn.floor(g).toString()),liquidityAmount:l,fix_amount_a:i}}static estimateLiquidityFromcoinAmounts(t,e,n,i){if(e>n)throw new Error("lower tick cannot be greater than lower tick");const s=Se.sqrtPriceX64ToTickIndex(t),o=Se.tickIndexToSqrtPriceX64(e),r=Se.tickIndexToSqrtPriceX64(n);if(s<e)return Zr(o,r,i.coinA);if(s>=n)return Yr(r,o,i.coinB);const a=Zr(t,r,i.coinA),c=Yr(t,o,i.coinB);return y.min(a,c)}static estCoinAmountsFromTotalAmount(t,e,n,i,s,o){const{ratioA:r,ratioB:a}=It.calculateDepositRatioFixTokenA(t,e,n);console.log({ratioA:r,ratioB:a});const c=U(i).mul(r).div(s),u=U(i).mul(a).div(o);return{amountA:c,amountB:u}}static calculateDepositRatioFixTokenA(t,e,n){const i=new y(1e8),{coinAmountB:s}=It.estLiquidityAndcoinAmountFromOneAmounts(t,e,i,!0,!0,0,n),o=Se.sqrtPriceX64ToPrice(n,0,0),r=U(i.toString()).mul(o),a=r.add(s.toString()),c=r.div(a),u=U(s.toString()).div(a);return{ratioA:c,ratioB:u}}};function zw(t){return t.startsWith("0x")?`${t.slice(2)}`:t}var OB=0,Hw=1,RB=2;function T0(t,e){return t===e?OB:t<e?Hw:RB}function $B(t,e){let n=0;const i=t.length<=e.length?t.length:e.length,s=T0(t.length,e.length);for(;n<i;){const o=T0(t.charCodeAt(n),e.charCodeAt(n));if(n+=1,o!==0)return o}return s}function iu(t,e){return $B(t,e)===Hw}function su(t,...e){const n=Array.isArray(e[e.length-1])?e.pop():[];let s=[t,...e].filter(Boolean).join("::");return n&&n.length&&(s+=`<${n.join(", ")}>`),s}function ae(t){var e;try{let n=t.replace(/\s/g,"");const i=n.match(/(<.+>)$/),s=(e=i==null?void 0:i[0])==null?void 0:e.match(/(\w+::\w+::\w+)(?:<.*?>(?!>))?/g);if(s){n=n.slice(0,n.indexOf("<"));const u={...ae(n),type_arguments:s.map(l=>ae(l).source_address)};return u.type_arguments=u.type_arguments.map(l=>Tt.isSuiCoin(l)?l:ae(l).source_address),u.source_address=su(u.full_address,u.type_arguments),u}const o=n.split("::"),a={full_address:n,address:n===Kw||n===LB?"0x2":gn(o[0]),module:o[1],name:o[2],type_arguments:[],source_address:""};return a.full_address=`${a.address}::${a.module}::${a.name}`,a.source_address=su(a.full_address,a.type_arguments),a}catch{return{full_address:t,address:"",module:"",name:"",type_arguments:[],source_address:t}}}function Mn(t){return ae(t).source_address}function UB(t){return t.toLowerCase().startsWith("0x")?gn(t):t}var MB=(t,e=!0)=>{const n=t.split("::"),i=n.shift();let s=gn(i);return e&&(s=zw(s)),`${s}::${n.join("::")}`};function Cp(t){for(const e in t){const n=typeof t[e];if(n==="object")Cp(t[e]);else if(n==="string"){const i=t[e];t[e]=UB(i)}}}var DB="0x2::coin::Coin",qB=/^0x2::coin::Coin<(.+)>$/,Kw="0x2::sui::SUI",LB="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI",Tt=class{static getCoinTypeArg(t){const e=t.type.match(qB);return e?e[1]:null}static isSUI(t){const e=Tt.getCoinTypeArg(t);return e?Tt.getCoinSymbol(e)==="SUI":!1}static getCoinSymbol(t){return t.substring(t.lastIndexOf(":")+1)}static getBalance(t){return BigInt(t.fields.balance)}static totalBalance(t,e){let n=BigInt(0);return t.forEach(i=>{e===i.coinAddress&&(n+=BigInt(i.balance))}),n}static getID(t){return t.fields.id.id}static getCoinTypeFromArg(t){return`${DB}<${t}>`}static getFaucetCoins(t){const{events:e}=t,n=[];return e==null||e.forEach(i=>{const{type:s}=i;if(ae(s).name==="InitEvent"){const o=i.parsedJson;n.push({transactionModule:i.transactionModule,suplyID:o.suplyID,decimals:o.decimals})}}),n}static getCoinAssets(t,e){const n=[];return e.forEach(i=>{Mn(i.coinAddress)===Mn(t)&&n.push(i)}),n}static isSuiCoin(t){return ae(t).full_address===Kw}static selectCoinObjectIdGreaterThanOrEqual(t,e,n=[]){const i=Tt.selectCoinAssetGreaterThanOrEqual(t,e,n),s=i.selectedCoins.map(a=>a.coinObjectId),o=i.remainingCoins,r=i.selectedCoins.map(a=>a.balance.toString());return{objectArray:s,remainCoins:o,amountArray:r}}static selectCoinAssetGreaterThanOrEqual(t,e,n=[]){const i=Tt.sortByBalance(t.filter(c=>!n.includes(c.coinObjectId))),s=Tt.calculateTotalBalance(i);if(s<e)return{selectedCoins:[],remainingCoins:i};if(s===e)return{selectedCoins:i,remainingCoins:[]};let o=BigInt(0);const r=[],a=[...i];for(;o<s;){const c=e-o,u=a.findIndex(d=>d.balance>=c);if(u!==-1){r.push(a[u]),a.splice(u,1);break}const l=a.pop();l.balance>0&&(r.push(l),o+=l.balance)}return{selectedCoins:Tt.sortByBalance(r),remainingCoins:Tt.sortByBalance(a)}}static sortByBalance(t){return t.sort((e,n)=>e.balance<n.balance?-1:e.balance>n.balance?1:0)}static sortByBalanceDes(t){return t.sort((e,n)=>e.balance>n.balance?-1:e.balance<n.balance?0:1)}static calculateTotalBalance(t){return t.reduce((e,n)=>e+n.balance,BigInt(0))}};function NB(t,e,n){let i=new y(0),s=new y(0);t.current_tick_index<e.index?(i=at.subUnderflowU128(new y(t.fee_growth_global_a),new y(e.feeGrowthOutsideA)),s=at.subUnderflowU128(new y(t.fee_growth_global_b),new y(e.feeGrowthOutsideB))):(i=new y(e.feeGrowthOutsideA),s=new y(e.feeGrowthOutsideB));let o=new y(0),r=new y(0);t.current_tick_index<n.index?(o=new y(n.feeGrowthOutsideA),r=new y(n.feeGrowthOutsideB)):(o=at.subUnderflowU128(new y(t.fee_growth_global_a),new y(n.feeGrowthOutsideA)),r=at.subUnderflowU128(new y(t.fee_growth_global_b),new y(n.feeGrowthOutsideB)));const a=at.subUnderflowU128(at.subUnderflowU128(new y(t.fee_growth_global_a),i),o),c=at.subUnderflowU128(at.subUnderflowU128(new y(t.fee_growth_global_b),s),r);return{fee_growth_inside_a:a,fee_growth_inside_b:c}}function jB(t,e,n){const i=at.subUnderflowU128(e,new y(t.fee_growth_inside_a)),s=new y(t.liquidity).mul(i).shrn(64),o=at.subUnderflowU128(n,new y(t.fee_growth_inside_b)),r=new y(t.liquidity).mul(o).shrn(64),a=new y(t.fee_owed_a).add(s),c=new y(t.fee_owed_b).add(r);return{position_id:t.pos_object_id,feeOwedA:a,feeOwedB:c}}function FB(t){const{fee_growth_inside_a:e,fee_growth_inside_b:n}=NB(t.clmmpool,t.tickLower,t.tickUpper);return jB(t.position,e,n)}var sa=class{constructor(t,e){xe(this,"numerator");xe(this,"denominator");this.toString=()=>`${this.numerator.toString()}/${this.denominator.toString()}`,this.numerator=t,this.denominator=e}static fromDecimal(t){return sa.fromFraction(t.toDecimalPlaces(1).mul(10).toNumber(),1e3)}static fromFraction(t,e){const n=typeof t=="number"?new y(t.toString()):t,i=typeof e=="number"?new y(e.toString()):e;return new sa(n,i)}};function rh(t,{numerator:e,denominator:n},i){return i?t.mul(n.add(e)).div(n):t.mul(n).div(n.add(e))}function gd(t,e,n){return{tokenMaxA:rh(t.coinA,e,n),tokenMaxB:rh(t.coinB,e,n)}}function U(t){return ie.isDecimal(t)?t:new ie(t===void 0?0:t)}function zB(t){return U(10).pow(U(t).abs())}function ja(t){return t.data}function Gw(t){if(t.error&&"object_id"in t.error&&"version"in t.error&&"digest"in t.error){const{error:e}=t;return{objectId:e.object_id,version:e.version,digest:e.digest}}}function Ww(t){if(t.error&&"object_id"in t.error&&!("version"in t.error)&&!("digest"in t.error))return t.error.object_id}function HB(t){if("reference"in t)return t.reference;const e=ja(t);return e?{objectId:e.objectId,version:e.version,digest:e.digest}:Gw(t)}function Di(t){var e;return"objectId"in t?t.objectId:((e=HB(t))==null?void 0:e.objectId)??Ww(t)}function KB(t){return t.data!==void 0}function GB(t){return t.content!==void 0}function Vw(t){const e="data"in t?ja(t):t;if(!(!e||!GB(e)||e.content.dataType!=="moveObject"))return e.content}function Si(t){var e;return(e=Vw(t))==null?void 0:e.type}function ro(t){var n;const e=KB(t)?t.data:t;return!(e!=null&&e.type)&&"data"in t?((n=e==null?void 0:e.content)==null?void 0:n.dataType)==="package"?"package":Si(t):e==null?void 0:e.type}function Fa(t){var e;return(e=ja(t))==null?void 0:e.previousTransaction}function ou(t){var e;return(e=ja(t))==null?void 0:e.owner}function WB(t){var n;const e=(n=ja(t))==null?void 0:n.display;return e||{data:null,error:null}}function je(t){var n;const e=(n=Vw(t))==null?void 0:n.fields;if(e)return"fields"in e?e.fields:e}function VB(t,e){const n=zB(U(e));return Number(U(t).mul(n))}function En(t,e=32){return BigInt.asUintN(e,BigInt(t)).toString()}function Zt(t,e=32){return Number(BigInt.asIntN(e,BigInt(t)))}function XB(t,e,n){const i=ae(t).name,s=ae(e).name;return`${i}-${s}[${n}]`}function md(t){const e=Si(t),n=ae(e),i=je(t),s=[];i.rewarder_manager.fields.rewarders.forEach(r=>{const{emissions_per_second:a}=r.fields,c=at.fromX64(new y(a)),u=Math.floor(c.toNumber()*60*60*24);s.push({emissions_per_second:a,coinAddress:ae(r.fields.reward_coin.fields.name).source_address,growth_global:r.fields.growth_global,emissionsEveryDay:u})});const o={poolAddress:Di(t),poolType:e,coinTypeA:n.type_arguments[0],coinTypeB:n.type_arguments[1],coinAmountA:i.coin_a,coinAmountB:i.coin_b,current_sqrt_price:i.current_sqrt_price,current_tick_index:Zt(BigInt(i.current_tick_index.fields.bits)),fee_growth_global_a:i.fee_growth_global_a,fee_growth_global_b:i.fee_growth_global_b,fee_protocol_coin_a:i.fee_protocol_coin_a,fee_protocol_coin_b:i.fee_protocol_coin_b,fee_rate:i.fee_rate,is_pause:i.is_pause,liquidity:i.liquidity,position_manager:{positions_handle:i.position_manager.fields.positions.fields.id.id,size:i.position_manager.fields.positions.fields.size},rewarder_infos:s,rewarder_last_updated_time:i.rewarder_manager.fields.last_updated_time,tickSpacing:i.tick_spacing,ticks_handle:i.tick_manager.fields.ticks.fields.id.id,uri:i.url,index:Number(i.index),name:""};return o.name=XB(o.coinTypeA,o.coinTypeB,o.tickSpacing),o}function vl(t){const e=WB(t).data,n={creator:"",description:"",image_url:"",link:"",name:"",project_url:""};return e&&(n.creator=e.creator,n.description=e.description,n.image_url=e.image_url,n.link=e.link,n.name=e.name,n.project_url=e.project_url),n}function sr(t){let e={creator:"",description:"",image_url:"",link:"",name:"",project_url:""},n={...e,pos_object_id:"",owner:"",type:"",coin_type_a:"",coin_type_b:"",liquidity:"",tick_lower_index:0,tick_upper_index:0,index:0,pool:"",reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"},i=je(t);if(i){const r=Si(t),a=ou(t);"nft"in i?(i=i.nft.fields,e.description=i.description,e.name=i.name,e.link=i.url):e=vl(t),n={...e,pos_object_id:i.id.id,owner:a.AddressOwner,type:r,coin_type_a:i.coin_type_a.fields.name,coin_type_b:i.coin_type_b.fields.name,liquidity:i.liquidity,tick_lower_index:Zt(BigInt(i.tick_lower_index.fields.bits)),tick_upper_index:Zt(BigInt(i.tick_upper_index.fields.bits)),index:i.index,pool:i.pool,reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0",fee_growth_inside_a:"0",fee_owed_a:"0",fee_growth_inside_b:"0",fee_owed_b:"0",position_status:"Exists"}}const s=Gw(t);s&&(n.pos_object_id=s.objectId,n.position_status="Deleted");const o=Ww(t);return o&&(n.pos_object_id=o,n.position_status="NotExists"),n}function Xw(t){const e={reward_amount_owed_0:"0",reward_amount_owed_1:"0",reward_amount_owed_2:"0",reward_growth_inside_0:"0",reward_growth_inside_1:"0",reward_growth_inside_2:"0"};t="fields"in t?t.fields:t,t.rewards.forEach((o,r)=>{const{amount_owned:a,growth_inside:c}="fields"in o?o.fields:o;r===0?(e.reward_amount_owed_0=a,e.reward_growth_inside_0=c):r===1?(e.reward_amount_owed_1=a,e.reward_growth_inside_1=c):r===2&&(e.reward_amount_owed_2=a,e.reward_growth_inside_2=c)});const n="fields"in t.tick_lower_index?t.tick_lower_index.fields.bits:t.tick_lower_index.bits,i="fields"in t.tick_upper_index?t.tick_upper_index.fields.bits:t.tick_upper_index.bits;return{liquidity:t.liquidity,tick_lower_index:Zt(BigInt(n)),tick_upper_index:Zt(BigInt(i)),...e,fee_growth_inside_a:t.fee_growth_inside_a,fee_owed_a:t.fee_owned_a,fee_growth_inside_b:t.fee_growth_inside_b,fee_owed_b:t.fee_owned_b,pos_object_id:t.position_id}}function _d(t){const n=je(t).value.fields.value.fields;return{objectId:Di(t),index:Zt(BigInt(n.index.fields.bits)),sqrtPrice:new y(n.sqrt_price),liquidityNet:new y(n.liquidity_net.fields.bits),liquidityGross:new y(n.liquidity_gross),feeGrowthOutsideA:new y(n.fee_growth_outside_a),feeGrowthOutsideB:new y(n.fee_growth_outside_b),rewardersGrowthOutside:n.rewards_growth_outside}}function JB(t){return{objectId:"",index:Zt(BigInt(t.index.bits)),sqrtPrice:new y(t.sqrt_price),liquidityNet:new y(t.liquidity_net.bits),liquidityGross:new y(t.liquidity_gross),feeGrowthOutsideA:new y(t.fee_growth_outside_a),feeGrowthOutsideB:new y(t.fee_growth_outside_b),rewardersGrowthOutside:t.rewards_growth_outside}}var Fr=class{static getMinIndex(t){return oh+Math.abs(oh)%t}static getMaxIndex(t){return sh-sh%t}};function rR(t,e){const n=Math.abs(t)%e;return t>0?n>e/2?t+e-n:t-n:n>e/2?t-e+n:t+n}function ZB(t,e,n,i,s,o){const r=t.rewarder_infos,a=[];for(let c=0;c<r.length;c+=1){let u=o[c];e!==null&&(t.current_tick_index<i?u=o[c].sub(new y(e.rewardersGrowthOutside[c])):u=e.rewardersGrowthOutside[c]);let l=new y(0);n!==null&&(t.current_tick_index>=s?l=o[c].sub(new y(n.rewardersGrowthOutside[c])):l=n.rewardersGrowthOutside[c]);const d=at.subUnderflowU128(at.subUnderflowU128(new y(o[c]),new y(u)),new y(l));a.push(d)}return a}function Bp(t){const e=Tt.isSuiCoin(t.coinTypeA),n=Tt.isSuiCoin(t.coinTypeB);return{isAdjustCoinA:e,isAdjustCoinB:n}}function YB(t,e){return ie.ceil(U(t).div(1+e)).toString()}var Xe=class{static createCollectRewarderAndFeeParams(t,e,n,i,s,o){s===void 0&&(s=[...i]),o===void 0&&(o=[...i]);const r=Mn(n.coinTypeA),a=Mn(n.coinTypeB);if(n.collect_fee){const u=Xe.buildCoinForAmount(e,s,BigInt(0),r,!1);s=u.remainCoins;const l=Xe.buildCoinForAmount(e,o,BigInt(0),a,!1);o=l.remainCoins,e=t.Position.createCollectFeePaylod({pool_id:n.pool_id,pos_id:n.pos_id,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB},e,u.targetCoin,l.targetCoin)}const c=[];return n.rewarder_coin_types.forEach(u=>{switch(Mn(u)){case r:c.push(Xe.buildCoinForAmount(e,s,BigInt(0),u,!1).targetCoin);break;case a:c.push(Xe.buildCoinForAmount(e,o,BigInt(0),u,!1).targetCoin);break;default:c.push(Xe.buildCoinForAmount(e,i,BigInt(0),u,!1).targetCoin);break}}),e=t.Rewarder.createCollectRewarderPaylod(n,e,c),e}static async adjustTransactionForGas(t,e,n,i){i.setSender(t.senderAddress);const s=Tt.selectCoinAssetGreaterThanOrEqual(e,n).selectedCoins;if(s.length===0)throw new Error("Insufficient balance");const o=Tt.calculateTotalBalance(e);if(o-n>1e9)return{fixAmount:n};const r=await t.fullClient.calculationTxGas(i);if(Tt.selectCoinAssetGreaterThanOrEqual(e,BigInt(r),s.map(c=>c.coinObjectId)).selectedCoins.length===0){const c=BigInt(r)+BigInt(500);if(o-n<c){if(n-=c,n<0)throw new Error("gas Insufficient balance");const u=new Ct;return{fixAmount:n,newTx:u}}}return{fixAmount:n}}static async buildAddLiquidityFixTokenForGas(t,e,n,i){let s=await Xe.buildAddLiquidityFixToken(t,e,n);const{isAdjustCoinA:o}=Bp(n),r=o?n.amount_a:n.amount_b,a=await Xe.adjustTransactionForGas(t,Tt.getCoinAssets(o?n.coinTypeA:n.coinTypeB,e),BigInt(r),s),{fixAmount:c}=a,{newTx:u}=a;if(u!==void 0){let l,d;if(o)n.amount_a=Number(c),l=Xe.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,c.toString(),n.slippage,n.coinTypeA,e,!1),d=Xe.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,e,!1);else return n.amount_b=Number(c),l=Xe.buildAddLiquidityFixTokenCoinInput(u,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,e,!1),d=Xe.buildAddLiquidityFixTokenCoinInput(u,n.fix_amount_a,c.toString(),n.slippage,n.coinTypeB,e,!1),n=Xe.fixAddLiquidityFixTokenParams(n,i.slippage,i.curSqrtPrice),s=await Xe.buildAddLiquidityFixTokenArgs(u,t,e,n,l,d),s}return s}static async buildAddLiquidityFixToken(t,e,n){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");let i=new Ct;const s=Xe.buildAddLiquidityFixTokenCoinInput(i,!n.fix_amount_a,n.amount_a,n.slippage,n.coinTypeA,e,!1),o=Xe.buildAddLiquidityFixTokenCoinInput(i,n.fix_amount_a,n.amount_b,n.slippage,n.coinTypeB,e,!1);return i=Xe.buildAddLiquidityFixTokenArgs(i,t,e,n,s,o),i}static buildAddLiquidityFixTokenCoinInput(t,e,n,i,s,o,r=!0){return e?Xe.buildCoinForAmountInterval(t,o,{amountSecond:BigInt(YB(n,i)),amountFirst:BigInt(n)},s,r):Xe.buildCoinForAmount(t,o,BigInt(n),s,r)}static fixAddLiquidityFixTokenParams(t,e,n){const i=t.fix_amount_a?t.amount_a:t.amount_b,s=It.estLiquidityAndcoinAmountFromOneAmounts(Number(t.tick_lower),Number(t.tick_upper),new y(i),t.fix_amount_a,!0,e,n);return t.amount_a=t.fix_amount_a?t.amount_a:s.tokenMaxA.toNumber(),t.amount_b=t.fix_amount_a?s.tokenMaxB.toNumber():t.amount_b,t}static buildAddLiquidityFixTokenArgs(t,e,n,i,s,o){const r=[i.coinTypeA,i.coinTypeB],a=i.is_open?"open_position_with_liquidity_by_fix_coin":"add_liquidity_by_fix_coin",{clmm_pool:c,integrate:u}=e.sdkOptions;i.is_open||(t=Xe.createCollectRewarderAndFeeParams(e,t,i,n,s.remainCoins,o.remainCoins));const l=W(c),d=i.is_open?[t.object(l.global_config_id),t.object(i.pool_id),t.pure(En(BigInt(i.tick_lower)).toString()),t.pure(En(BigInt(i.tick_upper)).toString()),s.targetCoin,o.targetCoin,t.pure(i.amount_a),t.pure(i.amount_b),t.pure(i.fix_amount_a),t.object(fe)]:[t.object(l.global_config_id),t.object(i.pool_id),t.object(i.pos_id),s.targetCoin,o.targetCoin,t.pure(i.amount_a),t.pure(i.amount_b),t.pure(i.fix_amount_a),t.object(fe)];return t.moveCall({target:`${u.published_at}::${Is}::${a}`,typeArguments:r,arguments:d}),t}static async buildSwapTransactionForGas(t,e,n,i){let s=Xe.buildSwapTransaction(t,e,n);s.setSender(t.senderAddress);const o=await Xe.adjustTransactionForGas(t,Tt.getCoinAssets(e.a2b?e.coinTypeA:e.coinTypeB,n),BigInt(e.by_amount_in?e.amount:e.amount_limit),s),{fixAmount:r,newTx:a}=o;if(a!==void 0){a.setSender(t.senderAddress),e.by_amount_in?e.amount=r.toString():e.amount_limit=r.toString(),e=await Xe.fixSwapParams(t,e,i);const c=Xe.buildCoinForAmount(s,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA),u=Xe.buildCoinForAmount(s,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB);s=Xe.buildSwapTransactionArgs(a,e,t.sdkOptions,c,u)}return s}static buildSwapTransaction(t,e,n){let i=new Ct;i.setSender(t.senderAddress);const s=Xe.buildCoinForAmount(i,n,e.a2b?BigInt(e.by_amount_in?e.amount:e.amount_limit):BigInt(0),e.coinTypeA,!1),o=Xe.buildCoinForAmount(i,n,e.a2b?BigInt(0):BigInt(e.by_amount_in?e.amount:e.amount_limit),e.coinTypeB,!1);return i=Xe.buildSwapTransactionArgs(i,e,t.sdkOptions,s,o),i}static buildSwapTransactionArgs(t,e,n,i,s){const{clmm_pool:o,integrate:r}=n,a=Gi.getDefaultSqrtPriceLimit(e.a2b),c=[e.coinTypeA,e.coinTypeB],{global_config_id:u}=W(o);if(u===void 0)throw Error("clmm.config.global_config_id is undefined");const l=e.swap_partner!==void 0,d=l?e.a2b?"swap_a2b_with_partner":"swap_b2a_with_partner":e.a2b?"swap_a2b":"swap_b2a",p=l?[t.pure(u),t.pure(e.pool_id),t.pure(e.swap_partner),i.targetCoin,s.targetCoin,t.pure(e.by_amount_in),t.pure(e.amount),t.pure(e.amount_limit),t.pure(a.toString()),t.pure(fe)]:[t.pure(u),t.pure(e.pool_id),i.targetCoin,s.targetCoin,t.pure(e.by_amount_in),t.pure(e.amount),t.pure(e.amount_limit),t.pure(a.toString()),t.pure(fe)];return t.moveCall({target:`${r.published_at}::${Is}::${d}`,typeArguments:c,arguments:p}),t}static async fixSwapParams(t,e,n){const{currentPool:i}=n;try{const s=await t.Swap.preswap({decimalsA:n.decimalsA,decimalsB:n.decimalsB,a2b:e.a2b,byAmountIn:e.by_amount_in,amount:e.amount,pool:i,currentSqrtPrice:i.current_sqrt_price,coinTypeA:i.coinTypeA,coinTypeB:i.coinTypeB}),o=n.byAmountIn?s.estimatedAmountOut:s.estimatedAmountIn,r=rh(o,n.slippage,!n.byAmountIn);e.amount_limit=r.toString()}catch(s){console.log("fixSwapParams",s)}return e}static async syncBuildCoinInputForAmount(t,e,n,i,s=!0){if(t.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const o=await t.getOwnerCoinAssets(t.senderAddress,i);return Xe.buildCoinForAmount(e,o,n,i,s).targetCoin}static buildCoinForAmount(t,e,n,i,s=!0,o=!1){const r=Tt.getCoinAssets(i,e);if(n===BigInt(0)&&r.length===0)return Xe.buildZeroValueCoin(e,t,i,s);const a=Tt.calculateTotalBalance(r);if(a<n)throw new Error(`The amount(${a}) is Insufficient balance for ${i} , expect ${n} `);return Xe.buildCoin(t,e,r,n,i,s,o)}static buildCoin(t,e,n,i,s,o=!0,r=!1){if(Tt.isSuiCoin(s)){if(o){const P=t.splitCoins(t.gas,[t.pure(i.toString())]);return{targetCoin:t.makeMoveVec({objects:[P]}),remainCoins:e,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:t.gas}}if(i===0n&&n.length>1){const P=Tt.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:t.object(P.objectArray[0]),remainCoins:P.remainCoins,tragetCoinAmount:P.amountArray[0],isMintZeroCoin:!1}}const T=Tt.selectCoinObjectIdGreaterThanOrEqual(n,i);return{targetCoin:t.splitCoins(t.gas,[t.pure(i.toString())]),remainCoins:T.remainCoins,tragetCoinAmount:i.toString(),isMintZeroCoin:!1,originalSplitedCoin:t.gas}}const a=Tt.selectCoinObjectIdGreaterThanOrEqual(n,i),c=a.amountArray.reduce((T,E)=>Number(T)+Number(E),0).toString(),u=a.objectArray;if(o)return{targetCoin:t.makeMoveVec({objects:u.map(T=>t.object(T))}),remainCoins:a.remainCoins,tragetCoinAmount:a.amountArray.reduce((T,E)=>Number(T)+Number(E),0).toString(),isMintZeroCoin:!1};const[l,...d]=u,p=t.object(l);let g=p,b=a.amountArray.reduce((T,E)=>Number(T)+Number(E),0).toString(),w;return d.length>0&&t.mergeCoins(p,d.map(T=>t.object(T))),r&&Number(c)>Number(i)&&(g=t.splitCoins(p,[t.pure(i.toString())]),b=i.toString(),w=p),{targetCoin:g,remainCoins:a.remainCoins,originalSplitedCoin:w,tragetCoinAmount:b,isMintZeroCoin:!1}}static buildZeroValueCoin(t,e,n,i=!0){const s=Xe.callMintZeroValueCoin(e,n);let o;return i?o=e.makeMoveVec({objects:[s]}):o=s,{targetCoin:o,remainCoins:t,isMintZeroCoin:!0,tragetCoinAmount:"0"}}static buildCoinForAmountInterval(t,e,n,i,s=!0){const o=Tt.getCoinAssets(i,e);if(n.amountFirst===BigInt(0))return o.length>0?Xe.buildCoin(t,[...e],[...o],n.amountFirst,i,s):Xe.buildZeroValueCoin(e,t,i,s);const r=Tt.calculateTotalBalance(o);if(r>=n.amountFirst)return Xe.buildCoin(t,[...e],[...o],n.amountFirst,i,s);if(r<n.amountSecond)throw new Error(`The amount(${r}) is Insufficient balance for ${i} , expect ${n.amountSecond} `);return Xe.buildCoin(t,[...e],[...o],n.amountSecond,i,s)}static async buildRouterSwapTransaction(t,e,n,i){let s=new Ct;return e.paths.length>1&&(e.partner=""),s=await this.buildRouterBasePathTx(t,e,n,i,s),s}static async buildRouterBasePathTx(t,e,n,i,s){const o=e.paths.filter(P=>P&&P.poolAddress),r=Number(o.reduce((P,k)=>P.add(k.amountIn),Ue).toString()),a=Number(o.reduce((P,k)=>P.add(k.amountOut),Ue).toString()),c=Math.round(n?Number(a.toString())*(1-e.priceSlippagePoint):Number(r.toString())*(1+e.priceSlippagePoint)),u=e.paths[0].coinType[0],l=e.paths[0].coinType[e.paths[0].coinType.length-1],d=Xe.buildCoinForAmount(s,i,BigInt(n?r:c),u,!1,!0),p=d.originalSplitedCoin!==void 0,g=Xe.buildCoinForAmount(s,i,0n,l,!1),b=await this.buildRouterBasePathReturnCoins(t,e,n,d,g,s),w=[],{toCoin:T,fromCoin:E}=b;if(s=b.tx,g.isMintZeroCoin?w.push(T):g.originalSplitedCoin!==void 0?s.mergeCoins(g.originalSplitedCoin,[T]):s.mergeCoins(g.targetCoin,[T]),p){const P=d==null?void 0:d.originalSplitedCoin;s.mergeCoins(P,[E])}else w.push(E);return w.length>0&&s.transferObjects(w,s.pure(t.senderAddress)),s}static async buildRouterBasePathReturnCoins(t,e,n,i,s,o){const{clmm_pool:r,integrate:a}=t.sdkOptions,c=W(r).global_config_id,u=e.paths.filter(k=>k&&k.poolAddress),l=Number(u.reduce((k,S)=>k.add(S.amountIn),Ue).toString()),d=Number(u.reduce((k,S)=>k.add(S.amountOut),Ue).toString()),p=Math.round(n?Number(d.toString())*(1-e.priceSlippagePoint):Number(l.toString())*(1+e.priceSlippagePoint)),g=e.paths[0].coinType[0],b=e.paths[0].coinType[e.paths[0].coinType.length-1];let w=i.targetCoin,T;s.isMintZeroCoin||s.originalSplitedCoin!==void 0?T=s.targetCoin:T=Xe.callMintZeroValueCoin(o,b);const E=e.partner==="",P=E?ir:w0;for(const k of u)if(k.poolAddress.length===1){const S=k.a2b[0],$={amount:Number(k.amountIn.toString()),amountLimit:p,poolCoinA:k.a2b[0]?g:b,poolCoinB:k.a2b[0]?b:g},H=E?"swap":"swap_with_partner",V=S?w:T,z=S?T:w,X=n?k.amountIn.toString():k.amountOut.toString(),L=Gi.getDefaultSqrtPriceLimit(S).toString(),B=E?[o.object(c),o.object(k.poolAddress[0]),V,z,o.pure(S),o.pure(n),o.pure(X),o.pure(L),o.pure(!1),o.object(fe)]:[o.object(c),o.object(k.poolAddress[0]),o.pure(e.partner),V,z,o.pure(S),o.pure(n),o.pure(X),o.pure(L),o.pure(!1),o.object(fe)],O=[$.poolCoinA,$.poolCoinB],v=o.moveCall({target:`${t.sdkOptions.integrate.published_at}::${P}::${H}`,typeArguments:O,arguments:B});w=S?v[0]:v[1],T=S?v[1]:v[0]}else{const S=n?k.amountIn:k.rawAmountLimit[0],$=n?0:k.amountOut;let H="";k.a2b[0]?k.a2b[1]?H="swap_ab_bc":H="swap_ab_cb":k.a2b[1]?H="swap_ba_bc":H="swap_ba_cb",E||(H=`${H}_with_partner`);const V=Gi.getDefaultSqrtPriceLimit(k.a2b[0]),z=Gi.getDefaultSqrtPriceLimit(k.a2b[1]),X=E?[o.object(c),o.object(k.poolAddress[0]),o.object(k.poolAddress[1]),w,T,o.pure(n),o.pure(S.toString()),o.pure($.toString()),o.pure(V.toString()),o.pure(z.toString()),o.object(fe)]:[o.object(c),o.object(k.poolAddress[0]),o.object(k.poolAddress[1]),o.pure(e.partner),w,T,o.pure(n),o.pure(S.toString()),o.pure($.toString()),o.pure(V.toString()),o.pure(z.toString()),o.object(fe)],L=[k.coinType[0],k.coinType[1],k.coinType[2]],B=o.moveCall({target:`${a.published_at}::${P}::${H}`,typeArguments:L,arguments:X});w=B[0],T=B[1]}return this.checkCoinThreshold(t,n,o,T,p,b),{fromCoin:w,toCoin:T,tx:o}}static async buildAggregatorSwapReturnCoins(t,e,n,i,s,o,r){e.splitPaths.length>1&&(s="");let a,c;const u=e.splitPaths.some(l=>l.basePaths.some(d=>d.label==="Deepbook"));if((!e.byAmountIn||e.splitPaths.length===1)&&!u){const l=[];for(const g of e.splitPaths){const b=[],w=[],T=[],E=[];for(let k=0;k<g.basePaths.length;k+=1){const S=g.basePaths[k];b.push(S.direction),w.push(S.poolAddress),T.push(new y(S.inputAmount.toString())),k===0?E.push(S.fromCoin,S.toCoin):E.push(S.toCoin)}const P={amountIn:new y(g.inputAmount.toString()),amountOut:new y(g.outputAmount.toString()),poolAddress:w,a2b:b,rawAmountLimit:T,isExceed:!1,coinType:E};l.push(P)}const d={paths:l,partner:s,priceSlippagePoint:o},p=await this.buildRouterBasePathReturnCoins(t,d,e.byAmountIn,n,i,r);a=p.fromCoin,c=p.toCoin,r=p.tx}else{const l=Math.round(e.outputAmount*(1-o));a=n.targetCoin,i.isMintZeroCoin||i.originalSplitedCoin!==void 0?c=i.targetCoin:c=Xe.callMintZeroValueCoin(r,e.toCoin);let d=!1,p;if(u){const[g,b]=A0.createAccountCap(t.senderAddress,t.sdkOptions,r);r=b,p=g,d=!0}for(let g=0;g<e.splitPaths.length;g+=1){const b=e.splitPaths[g];let w;for(let T=0;T<b.basePaths.length;T+=1){const E=b.basePaths[T];if(E.label==="Deepbook")if(T===0)if(b.basePaths.length===1){const P=this.buildDeepbookBasePathTx(t,E,r,p,a,c,!1);a=P.from,c=P.to}else{w=Xe.callMintZeroValueCoin(r,E.toCoin);const P=this.buildDeepbookBasePathTx(t,E,r,p,a,w,!1);a=P.from,w=P.to}else{const P=this.buildDeepbookBasePathTx(t,E,r,p,w,c,!0);w=P.from,c=P.to}if(E.label==="Cetus")if(T===0)if(b.basePaths.length===1){const P=this.buildClmmBasePathTx(t,E,r,e.byAmountIn,a,c,!1,s);a=P.from,c=P.to}else{w=Xe.callMintZeroValueCoin(r,E.toCoin);const P=this.buildClmmBasePathTx(t,E,r,e.byAmountIn,a,w,!1,s);a=P.from,w=P.to}else{const P=this.buildClmmBasePathTx(t,E,r,e.byAmountIn,w,c,!0,s);w=P.from,c=P.to,r.moveCall({target:`${t.sdkOptions.integrate.published_at}::${fB}::send_coin`,typeArguments:[E.fromCoin],arguments:[w,r.pure(t.senderAddress)]})}}}this.checkCoinThreshold(t,e.byAmountIn,r,c,l,e.toCoin),d&&(r=A0.deleteAccountCapByObject(p,t.sdkOptions,r))}return{fromCoin:a,toCoin:c,tx:r}}static async buildAggregatorSwapTransaction(t,e,n,i,s){let o=new Ct;const r=e.byAmountIn?Math.round(e.outputAmount*(1-s)):Math.round(e.inputAmount*(1+s)),a=Xe.buildCoinForAmount(o,n,e.byAmountIn?BigInt(e.inputAmount):BigInt(r),e.fromCoin,!1,!0),c=a.originalSplitedCoin!==void 0,u=Xe.buildCoinForAmount(o,n,0n,e.toCoin,!1),l=await this.buildAggregatorSwapReturnCoins(t,e,a,u,i,s,o),{fromCoin:d,toCoin:p}=l;o=l.tx;const g=[];if(u.isMintZeroCoin?g.push(p):u.originalSplitedCoin!==void 0?o.mergeCoins(u.originalSplitedCoin,[p]):o.mergeCoins(u.targetCoin,[p]),c){const b=a.originalSplitedCoin;o.mergeCoins(b,[d])}else g.push(d);return g.length>0&&o.transferObjects(g,o.pure(t.senderAddress)),o}static checkCoinThreshold(t,e,n,i,s,o){e&&n.moveCall({target:`${t.sdkOptions.integrate.published_at}::${ir}::check_coin_threshold`,typeArguments:[o],arguments:[i,n.pure(s)]})}static buildDeepbookBasePathTx(t,e,n,i,s,o,r){const a=e.direction?s:o,c=e.direction?o:s,u=[n.object(e.poolAddress),i,n.pure(e.inputAmount),n.pure(0),n.pure(e.direction),a,c,n.pure(r),n.object(fe)],l=e.direction?[e.fromCoin,e.toCoin]:[e.toCoin,e.fromCoin],d=n.moveCall({target:`${t.sdkOptions.deepbook_endpoint_v2.published_at}::endpoints_v2::swap`,typeArguments:l,arguments:u});return s=e.direction?d[0]:d[1],o=e.direction?d[1]:d[0],{from:s,to:o,tx:n}}static buildClmmBasePathTx(t,e,n,i,s,o,r,a){const{clmm_pool:c,integrate:u}=t.sdkOptions,l=W(c).global_config_id;let d=e.direction?s:o,p=e.direction?o:s;const g=a==="",b=g?ir:w0,w=g?"swap":"swap_with_partner",T=i?e.inputAmount.toString():e.outputAmount.toString(),E=Gi.getDefaultSqrtPriceLimit(e.direction),P=g?[n.object(l),n.object(e.poolAddress),d,p,n.pure(e.direction),n.pure(i),n.pure(T),n.pure(E.toString()),n.pure(r),n.object(fe)]:[n.object(l),n.object(e.poolAddress),n.pure(a),d,p,n.pure(e.direction),n.pure(i),n.pure(T),n.pure(E.toString()),n.pure(r),n.object(fe)],k=e.direction?[e.fromCoin,e.toCoin]:[e.toCoin,e.fromCoin],S=n.moveCall({target:`${u.published_at}::${b}::${w}`,typeArguments:k,arguments:P});return d=S[0],p=S[1],s=e.direction?d:p,o=e.direction?p:d,{from:s,to:o,tx:n}}static buildCoinTypePair(t,e){const n=[];if(t.length===2){const i=[];i.push(t[0],t[1]),n.push(i)}else{const i=[];i.push(t[0],t[t.length-1]),n.push(i);for(let s=1;s<t.length-1;s+=1){if(e[s-1]===0)continue;const o=[];o.push(t[0],t[s],t[t.length-1]),n.push(o)}}return n}},tt=Xe;lB(tt,"callMintZeroValueCoin",(t,e)=>t.moveCall({target:"0x2::coin::zero",typeArguments:[e]}));var Io=new y(1e9),A0=class{static createAccountCap(t,e,n,i=!1){const{deepbook:s}=e,[o]=n.moveCall({target:`${s.published_at}::${gB}::create_account`,typeArguments:[],arguments:[]});return i&&n.transferObjects([o],n.pure(t)),[o,n]}static deleteAccountCap(t,e,n){const{deepbook:i}=e,s=[n.pure(t)];return n.moveCall({target:`${i.published_at}::${fd}::delete_account_cap`,typeArguments:[],arguments:s}),n}static deleteAccountCapByObject(t,e,n){const{deepbook:i}=e,s=[t];return n.moveCall({target:`${i.published_at}::${fd}::delete_account_cap`,typeArguments:[],arguments:s}),n}static async getAccountCap(t){const e=await t.fullClient.getOwnedObjectsByPage(t.senderAddress,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{MoveModule:{package:t.sdkOptions.deepbook.package_id,module:fd}}});return e.data.length===0?"":e.data[0].data.objectId}static async getPools(t){const e=t.sdkOptions.deepbook.package_id,n=[];try{(await t.fullClient.queryEventsByPage({MoveEventType:`${e}::clob_v2::PoolCreated`})).data.forEach(s=>{const o=s.parsedJson;o&&n.push({poolID:o.pool_id,tickSize:Number(o.tick_size),lotSize:Number(o.lot_size),takerFeeRate:Number(o.taker_fee_rate),makerRebateRate:Number(o.maker_rebate_rate),baseAsset:o.base_asset.name,quoteAsset:o.quote_asset.name})})}catch(i){console.log("getPoolImmutables",i)}return n}static async getPoolAsks(t,e,n,i){var p;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:o}=t.sdkOptions,r=new Ct,a=[],c=[n,i],u=[r.pure(e),r.pure("0"),r.pure("999999999999"),r.pure(fe)];r.moveCall({target:`${o.published_at}::endpoints_v2::get_level2_book_status_ask_side`,arguments:u,typeArguments:c});const d=(p=(await t.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:p.filter(g=>ae(g.type).name==="BookStatus");if(d.length===0)return a;for(let g=0;g<d[0].parsedJson.depths.length;g++){const b=d[0].parsedJson.price[g],w=d[0].parsedJson.depths[g],T={price:parseInt(b,10),quantity:parseInt(w,10)};a.push(T)}return a}static async getPoolBids(t,e,n,i){var p;const{simulationAccount:s}=t.sdkOptions,{deepbook_endpoint_v2:o}=t.sdkOptions,r=new Ct,a=[],c=[n,i],u=[r.pure(e),r.pure("0"),r.pure("999999999999"),r.pure(fe)];r.moveCall({target:`${o.published_at}::endpoints_v2::get_level2_book_status_bid_side`,arguments:u,typeArguments:c});const d=(p=(await t.fullClient.devInspectTransactionBlock({transactionBlock:r,sender:s.address})).events)==null?void 0:p.filter(g=>ae(g.type).name==="BookStatus");if(d.length===0)return a;for(let g=0;g<d[0].parsedJson.depths.length;g++){const b=d[0].parsedJson.price[g],w=d[0].parsedJson.depths[g],T={price:parseInt(b,10),quantity:parseInt(w,10)};a.push(T)}return a}static async preSwap(t,e,n,i){let s=!1,o=Ue,r=new y(i),a=Ue;const c=new y(i);if(n){let u=await this.getPoolBids(t,e.poolID,e.baseAsset,e.quoteAsset);u===null&&(s=!0),u=u.sort((l,d)=>d.price-l.price);for(let l=0;l<u.length;l+=1){const d=new y(u[l].quantity),p=new y(u[l].price),g=d.mul(new y(p)).mul(new y(e.takerFeeRate)).div(Io).div(Io);if(r.gt(d))r=r.sub(d),o=o.add(d.mul(p).div(Io).sub(g)),a=a.add(g);else{const b=r.mul(new y(u[l].price)).div(Io),w=b.mul(new y(e.takerFeeRate)).div(Io);o=o.add(b.sub(w)),r=r.sub(r),a=a.add(w)}if(r.eq(Ue))break}}else{const u=await this.getPoolAsks(t,e.poolID,e.baseAsset,e.quoteAsset);u===null&&(s=!0);for(let l=0;l<u.length;l+=1){const d=new y(u[l].price).mul(new y(u[l].quantity)).div(new y(1e9)),p=d.mul(new y(e.takerFeeRate)).div(Io),g=d.add(p);if(r.gt(d))o=o.add(new y(u[l].quantity)),r=r.sub(g),a=a.add(p);else{const b=new y(u[l].quantity).div(new y(e.lotSize)),w=g.div(b),T=r.div(w);o=o.add(T.muln(e.lotSize)),r=r.sub(T.mul(w)),a=a.add(T.div(b).mul(p))}if(r.eq(Ue))break}}return{poolAddress:e.poolID,estimatedAmountIn:c.sub(r).toNumber(),estimatedAmountOut:o.toNumber(),estimatedFeeAmount:a,isExceed:s,amount:Number(i),aToB:n,byAmountIn:!0}}static async simulateSwap(t,e,n,i,s,o){var $;const{deepbook_endpoint_v2:r}=t.sdkOptions;let a=new Ct;const c=await this.getAccountCap(t);let u;if(c===""){const H=this.createAccountCap(t.senderAddress,t.sdkOptions,a),V=H[0];a=H[1],u=V}else u=a.pure(c);const l=await t.getOwnerCoinAssets(t.senderAddress),d=tt.buildCoinForAmount(a,l,BigInt(o),n,!1),p=d==null?void 0:d.targetCoin,g=tt.buildCoinForAmount(a,l,BigInt(o),i,!1),b=g==null?void 0:g.targetCoin,w=[n,i],T=[a.pure(e),u,a.pure(o),a.pure(0),a.pure(s),p,b,a.pure(fe)];a.moveCall({target:`${r.published_at}::${mB}::swap`,arguments:T,typeArguments:w});const{simulationAccount:E}=t.sdkOptions,k=($=(await t.fullClient.devInspectTransactionBlock({transactionBlock:a,sender:E.address})).events)==null?void 0:$.filter(H=>ae(H.type).name==="DeepbookSwapEvent");if(k.length===0)return null;const S=k[0].parsedJson;return{poolAddress:S.pool,estimatedAmountIn:S.amount_in,estimatedAmountOut:S.amount_out,aToB:S.atob}}},QB=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPositionList(t,e="all"){const n={data:[],hasNextPage:!0},i=await this._sdk.fullClient.getDynamicFieldsByPage(t,e);n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor;const s=i.data.map(r=>r.name.value),o=await this._sdk.Position.getSipmlePositionList(s);return n.data=o,n}async getPoolImmutables(t=[],e=0,n=100,i=!1){const{package_id:s}=this._sdk.sdkOptions.clmm_pool,o=`${s}_getInitPoolEvent`,r=this.getCache(o,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{(await this._sdk.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`})).data.forEach(d=>{const p=d.parsedJson;p&&a.push({poolAddress:p.pool_id,tickSpacing:p.tick_spacing,coinTypeA:ae(p.coin_type_a).full_address,coinTypeB:ae(p.coin_type_b).full_address})}),this.updateCache(o,a,Ee)}catch(l){console.log("getPoolImmutables",l)}const u=t.length>0;for(let l=0;l<a.length;l+=1){const d=a[l];u&&!t.includes(d.poolAddress)||!u&&(l<e||l>=e+n)||c.push(d)}return c}async getPools(t=[],e=0,n=100){const i=[];let s=[];t.length>0?s=[...t]:(await this.getPoolImmutables([],e,n,!1)).forEach(a=>s.push(a.poolAddress));const o=await this._sdk.fullClient.batchGetObjects(s,{showContent:!0,showType:!0});for(const r of o){const a=md(r);i.push(a);const c=`${a.poolAddress}_getPoolObject`;this.updateCache(c,a,Ee)}return i}async getPoolImmutablesWithPage(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.clmm_pool,i=[],s={data:[],hasNextPage:!1},o=t==="all",r=`${n}_getPoolImmutables`;if(o){const a=this.getCache(r,e);a&&i.push(...a)}if(i.length===0)try{const a=`${n}::factory::CreatePoolEvent`,c=await this._sdk.fullClient.queryEventsByPage({MoveEventType:a},t);s.hasNextPage=c.hasNextPage,s.nextCursor=c.nextCursor,c.data.forEach(u=>{const l=u.parsedJson;if(l){const d={poolAddress:l.pool_id,tickSpacing:l.tick_spacing,coinTypeA:ae(l.coin_type_a).full_address,coinTypeB:ae(l.coin_type_b).full_address};i.push(d)}})}catch(a){console.log("getPoolImmutables",a)}return s.data=i,o&&this.updateCache(`${n}_getPoolImmutables`,i,Ee),s}async getPoolsWithPage(t=[]){const e=[];let n=[];t.length>0?n=[...t]:(await this.getPoolImmutablesWithPage()).data.forEach(o=>n.push(o.poolAddress));const i=await this._sdk.fullClient.batchGetObjects(n,{showContent:!0,showType:!0});for(const s of i){const o=md(s);e.push(o);const r=`${o.poolAddress}_getPoolObject`;this.updateCache(r,o,Ee)}return e}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}}),o=md(s);return this.updateCache(n,o),o}async creatPoolsTransactionPayload(t){for(const n of t)if(iu(en(n.coinTypeA),en(n.coinTypeB))){const i=n.coinTypeB;n.coinTypeB=n.coinTypeA,n.coinTypeA=i}return await this.creatPool(t)}async creatPoolTransactionPayload(t){if(iu(en(t.coinTypeA),en(t.coinTypeB))){const e=t.coinTypeB;t.coinTypeB=t.coinTypeA,t.coinTypeA=e}return"fix_amount_a"in t?await this.creatPoolAndAddLiquidity(t):await this.creatPool([t])}async getClmmConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.clmm_pool,n=`${e}_getInitEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=Fa(s),r=(await this._sdk.fullClient.queryEventsByPage({Transaction:o})).data,a={pools_id:"",global_config_id:"",global_vault_id:"",admin_cap_id:""};return r.length>0&&(r.forEach(c=>{const u=c.parsedJson;if(c.type)switch(ae(c.type).full_address){case`${e}::config::InitConfigEvent`:a.global_config_id=u.global_config_id,a.admin_cap_id=u.admin_cap_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=u.pools_id;break;case`${e}::rewarder::RewarderInitEvent`:a.global_vault_id=u.global_vault_id;break;case`${e}::partner::InitPartnerEvent`:a.partners_id=u.partners_id;break}}),this.updateCache(n,a,Ee)),a}async getSuiTransactionResponse(t,e=!1){const n=`${t}_getSuiTransactionResponse`,i=this.getCache(n,e);if(i!==void 0)return i;let s;try{s=await this._sdk.fullClient.getTransactionBlock({digest:t,options:{showEvents:!0,showEffects:!0,showBalanceChanges:!0,showInput:!0,showObjectChanges:!0}})}catch{s=await this._sdk.fullClient.getTransactionBlock({digest:t,options:{showEvents:!0,showEffects:!0}})}return this.updateCache(n,s,Ee),s}async creatPool(t){const e=new Ct,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,s=W(i),o=s.global_config_id,r=s.pools_id;return t.forEach(a=>{const c=[e.object(o),e.object(r),e.pure(a.tick_spacing.toString()),e.pure(a.initialize_sqrt_price),e.pure(a.uri),e.object(fe)];e.moveCall({target:`${n.published_at}::${ia}::create_pool`,typeArguments:[a.coinTypeA,a.coinTypeB],arguments:c})}),e}async creatPoolAndAddLiquidity(t){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const e=new Ct,{integrate:n,clmm_pool:i}=this.sdk.sdkOptions,s=W(i),o=s.global_config_id,r=s.pools_id,a=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),c=tt.buildAddLiquidityFixTokenCoinInput(e,!t.fix_amount_a,t.amount_a,t.slippage,t.coinTypeA,a,!1),u=tt.buildAddLiquidityFixTokenCoinInput(e,t.fix_amount_a,t.amount_b,t.slippage,t.coinTypeB,a,!1),l=[e.pure(o),e.pure(r),e.pure(t.tick_spacing.toString()),e.pure(t.initialize_sqrt_price),e.pure(t.uri),c.targetCoin,u.targetCoin,e.pure(En(BigInt(t.tick_lower)).toString()),e.pure(En(BigInt(t.tick_upper)).toString()),e.pure(t.amount_a),e.pure(t.amount_b),e.pure(t.fix_amount_a),e.pure(fe)];return e.moveCall({target:`${n.published_at}::${Is}::create_pool_with_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:l}),e}async fetchTicks(t){let e=[],n=[];for(;;){const s=await this.getTicks({pool_id:t.pool_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,start:n,limit:512});if(e=[...e,...s],s.length<512)break;n=[s[s.length-1].index]}return e}async getTicks(t){var c;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=[],s=[t.coinTypeA,t.coinTypeB],o=new Ct,r=[o.pure(t.pool_id),o.pure(t.start),o.pure(t.limit.toString())];return o.moveCall({target:`${e.published_at}::${di}::fetch_ticks`,arguments:r,typeArguments:s}),(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:n.address})).events)==null||c.forEach(u=>{ae(u.type).name==="FetchTicksResultEvent"&&u.parsedJson.ticks.forEach(l=>{i.push(JB(l))})}),i}async fetchPositionRewardList(t){var r;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=[];let s=[];const o=512;for(;;){const a=[t.coinTypeA,t.coinTypeB],c=new Ct,u=[c.pure(t.pool_id),c.pure(s),c.pure(o.toString())];c.moveCall({target:`${e.published_at}::${di}::fetch_positions`,arguments:u,typeArguments:a});const l=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:c,sender:n.address}),d=[];if((r=l.events)==null||r.forEach(p=>{ae(p.type).name==="FetchPositionsEvent"&&p.parsedJson.positions.forEach(g=>{const b=Xw(g);d.push(b)})}),i.push(...d),d.length<o)break;s=[d[d.length-1].pos_object_id]}return i}async fetchTicksByRpc(t){let e=[],n=null;const i=512;for(;;){const s=[],o=await this.sdk.fullClient.getDynamicFields({parentId:t,cursor:n,limit:i});if(n=o.nextCursor,o.data.forEach(r=>{ae(r.objectType).module==="skip_list"&&s.push(r.objectId)}),e=[...e,...await this.getTicksByRpc(s)],n===null||o.data.length<i)break}return e}async getTicksByRpc(t){const e=[],n=await this.sdk.fullClient.batchGetObjects(t,{showContent:!0,showType:!0});for(const i of n)e.push(_d(i));return e}async getTickDataByIndex(t,e){const n={type:"u64",value:En(BigInt(xB(e).toString())).toString()},i=await this.sdk.fullClient.getDynamicFieldObject({parentId:t,name:n});return _d(i)}async getTickDataByObjectId(t){const e=await this.sdk.fullClient.getObject({id:t,options:{showContent:!0}});return _d(e)}async getPartnerRefFeeAmount(t){const e=await this._sdk.fullClient.batchGetObjects([t],{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0});let n;e.forEach(a=>{n=a.data.content.fields.balances});const i=await this._sdk.fullClient.getDynamicFieldsByPage(n.fields.id.id),s=[];i.data.forEach(a=>{s.push(a.objectId)});const o=[];return(await this._sdk.fullClient.batchGetObjects(s,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(a=>{const c={coinAddress:a.data.content.fields.name,coinObjectId:a.data.objectId,balance:BigInt(a.data.content.fields.value)};o.push(c)}),o}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},eI=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}buildPositionType(){return`${this._sdk.sdkOptions.clmm_pool.package_id}::position::Position`}async getPositionList(t,e=[]){const n=[],i=await this._sdk.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.clmm_pool.package_id}}),s=e.length>0;for(const o of i.data)if(ae(o.data.type).full_address===this.buildPositionType()){const a=sr(o),c=`${a.pos_object_id}_getPositionList`;this.updateCache(c,a,Ee),s?e.includes(a.pool)&&n.push(a):n.push(a)}return n}async getPosition(t,e,n=!0){let i=await this.getSimplePosition(e);return n&&(i=await this.updatePositionRewarders(t,i)),i}async getPositionById(t,e=!0){const n=await this.getSimplePosition(t);if(e){const i=await this._sdk.Pool.getPool(n.pool,!1);return await this.updatePositionRewarders(i.position_manager.positions_handle,n)}return n}async getSimplePosition(t){const e=`${t}_getPositionList`;let n=this.getSimplePositionByCache(t);if(n===void 0){const i=await this.sdk.fullClient.getObject({id:t,options:{showContent:!0,showType:!0,showDisplay:!0,showOwner:!0}});n=sr(i),this.updateCache(e,n,Ee)}return n}getSimplePositionByCache(t){const e=`${t}_getPositionList`;return this.getCache(e)}async getSipmlePositionList(t){const e=[],n=[];return t.forEach(i=>{const s=this.getSimplePositionByCache(i);s?e.push(s):n.push(i)}),n.length>0&&(await this._sdk.fullClient.batchGetObjects(n,{showOwner:!0,showContent:!0,showDisplay:!0,showType:!0})).forEach(s=>{const o=sr(s);e.push(o);const r=`${o.pos_object_id}_getPositionList`;this.updateCache(r,o,Ee)}),e}async updatePositionRewarders(t,e){const n=await this.getPositionRewarders(t,e.pos_object_id);return{...e,...n}}async getPositionRewarders(t,e){try{const n=await this._sdk.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),s=je(n.data).value.fields.value;return Xw(s)}catch(n){console.log(n);return}}async fetchPosFeeAmount(t){var c;const{clmm_pool:e,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new Ct;for(const u of t){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(W(e).global_config_id),s.object(u.poolAddress),s.pure(u.positionId)];s.moveCall({target:`${n.published_at}::${di}::fetch_position_fees`,arguments:d,typeArguments:l})}const r=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address})).events)==null?void 0:c.filter(u=>ae(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new y(l.fee_owned_a),feeOwedB:new y(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async batchFetchPositionFees(t){const e=[];for(const i of t){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB})}const n={};if(e.length>0){const i=await this.fetchPosFeeAmount(e);for(const s of i)n[s.position_id]=s;return n}return n}async createAddLiquidityFixTokenPayload(t,e){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:i,isAdjustCoinB:s}=Bp(t);if(t=t,t.fix_amount_a&&i||!t.fix_amount_a&&s)return await tt.buildAddLiquidityFixTokenForGas(this._sdk,n,t,e)}return tt.buildAddLiquidityFixToken(this._sdk,n,t)}async createAddLiquidityPayload(t){const{integrate:e,clmm_pool:n}=this._sdk.sdkOptions;if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=En(BigInt(t.tick_lower)).toString(),s=En(BigInt(t.tick_upper)).toString(),o=[t.coinTypeA,t.coinTypeB];let r=new Ct;const a=!Xr(t.pos_id),c=BigInt(t.max_amount_a),u=BigInt(t.max_amount_b),l=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress),d=tt.buildCoinForAmount(r,l,c,t.coinTypeA,!1),p=tt.buildCoinForAmount(r,l,u,t.coinTypeB,!1);return a?r.moveCall({target:`${e.published_at}::${Is}::open_position_with_liquidity`,typeArguments:o,arguments:[r.object(W(n).global_config_id),r.object(t.pool_id),r.pure(i),r.pure(s),d.targetCoin,p.targetCoin,r.pure(t.max_amount_a),r.pure(t.max_amount_b),r.pure(t.delta_liquidity),r.object(fe)]}):(r=tt.createCollectRewarderAndFeeParams(this._sdk,r,t,l,d.remainCoins,p.remainCoins),r.moveCall({target:`${e.published_at}::${Is}::add_liquidity`,typeArguments:o,arguments:[r.object(W(n).global_config_id),r.object(t.pool_id),r.object(t.pos_id),d.targetCoin,p.targetCoin,r.pure(t.max_amount_a),r.pure(t.max_amount_b),r.pure(t.delta_liquidity),r.object(fe)]})),r}async removeLiquidityTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions,i="remove_liquidity";let s=new Ct;const o=[t.coinTypeA,t.coinTypeB],r=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);s=tt.createCollectRewarderAndFeeParams(this._sdk,s,t,r);const a=[s.object(W(e).global_config_id),s.object(t.pool_id),s.object(t.pos_id),s.pure(t.delta_liquidity),s.pure(t.min_amount_a),s.pure(t.min_amount_b),s.object(fe)];return s.moveCall({target:`${n.published_at}::${ia}::${i}`,typeArguments:o,arguments:a}),s}async closePositionTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions;let i=new Ct;const s=[t.coinTypeA,t.coinTypeB],o=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);return i=tt.createCollectRewarderAndFeeParams(this._sdk,i,t,o),i.moveCall({target:`${n.published_at}::${ia}::close_position`,typeArguments:s,arguments:[i.object(W(e).global_config_id),i.object(t.pool_id),i.object(t.pos_id),i.pure(t.min_amount_a),i.pure(t.min_amount_b),i.object(fe)]}),i}openPositionTransactionPayload(t){const{clmm_pool:e,integrate:n}=this.sdk.sdkOptions,i=new Ct,s=[t.coinTypeA,t.coinTypeB],o=En(BigInt(t.tick_lower)).toString(),r=En(BigInt(t.tick_upper)).toString(),a=[i.pure(W(e).global_config_id),i.pure(t.pool_id),i.pure(o),i.pure(r)];return i.moveCall({target:`${n.published_at}::${ia}::open_position`,typeArguments:s,arguments:a}),i}async collectFeeTransactionPayload(t){const e=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null,!0),n=new Ct,i=tt.buildCoinForAmount(n,e,BigInt(0),t.coinTypeA,!1),s=tt.buildCoinForAmount(n,e,BigInt(0),t.coinTypeB,!1);return this.createCollectFeePaylod(t,n,i.targetCoin,s.targetCoin),n}createCollectFeePaylod(t,e,n,i){const{clmm_pool:s,integrate:o}=this.sdk.sdkOptions,r=[t.coinTypeA,t.coinTypeB],a=[e.object(W(s).global_config_id),e.object(t.pool_id),e.object(t.pos_id),n,i];return e.moveCall({target:`${o.published_at}::${Is}::collect_fee`,typeArguments:r,arguments:a}),e}async calculateFee(t){const e=await this.collectFeeTransactionPayload(t),n=await this._sdk.fullClient.devInspectTransactionBlock({transactionBlock:e,sender:this._sdk.senderAddress});for(const i of n.events)if(ae(i.type).name==="CollectFeeEvent"){const s=i.parsedJson;return{feeOwedA:s.amount_a,feeOwedB:s.amount_b}}return{feeOwedA:"0",feeOwedB:"0"}}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},tI=class{constructor(t){xe(this,"_sdk");xe(this,"growthGlobal");this._sdk=t,this.growthGlobal=[Ue,Ue,Ue]}get sdk(){return this._sdk}async emissionsEveryDay(t){const n=(await this.sdk.Pool.getPool(t)).rewarder_infos;if(!n)return null;const i=[];for(const s of n){const o=at.fromX64(new y(s.emissions_per_second));i.push({emissions:Math.floor(o.toNumber()*60*60*24),coin_address:s.coinAddress})}return i}async updatePoolRewarder(t,e){const n=await this.sdk.Pool.getPool(t),i=n.rewarder_last_updated_time;if(n.rewarder_last_updated_time=e.toString(),Number(n.liquidity)===0||e.eq(new y(i)))return n;const s=e.div(new y(1e3)).sub(new y(i)).add(new y(15)),o=n.rewarder_infos;for(let r=0;r<o.length;r+=1){const a=o[r],c=at.checkMulDivFloor(s,new y(a.emissions_per_second),new y(n.liquidity),128);this.growthGlobal[r]=new y(a.growth_global).add(new y(c))}return n}async posRewardersAmount(t,e,n){const i=Date.parse(new Date().toString()),s=await this.updatePoolRewarder(t,new y(i)),o=await this.sdk.Position.getPositionRewarders(e,n);if(o===void 0)return[];const r=s.ticks_handle,a=await this.sdk.Pool.getTickDataByIndex(r,o.tick_lower_index),c=await this.sdk.Pool.getTickDataByIndex(r,o.tick_upper_index);return this.posRewardersAmountInternal(s,o,a,c)}async poolRewardersAmount(t,e){const n=Date.parse(new Date().toString()),i=await this.updatePoolRewarder(e,new y(n)),s=await this.sdk.Position.getPositionList(t,[e]),o=await this.getPoolLowerAndUpperTicks(i.ticks_handle,s),r=[Ue,Ue,Ue];for(let a=0;a<s.length;a+=1){const c=await this.posRewardersAmountInternal(i,s[a],o[0][a],o[1][a]);for(let u=0;u<3;u+=1)r[u]=r[u].add(c[u].amount_owed)}return r}posRewardersAmountInternal(t,e,n,i){const s=e.tick_lower_index,o=e.tick_upper_index,r=ZB(t,n,i,s,o,this.growthGlobal),a=[],c=[];if(r.length>0){let u=at.subUnderflowU128(r[0],new y(e.reward_growth_inside_0));u.gt(new y("3402823669209384634633745948738404"))&&(u=Mi);const l=at.checkMulShiftRight(new y(e.liquidity),u,64,128);a.push(r[0]),c.push({amount_owed:new y(e.reward_amount_owed_0).add(l),coin_address:t.rewarder_infos[0].coinAddress})}if(r.length>1){let u=at.subUnderflowU128(r[1],new y(e.reward_growth_inside_1));u.gt(new y("3402823669209384634633745948738404"))&&(u=Mi);const l=at.checkMulShiftRight(new y(e.liquidity),u,64,128);a.push(r[1]),c.push({amount_owed:new y(e.reward_amount_owed_1).add(l),coin_address:t.rewarder_infos[1].coinAddress})}if(r.length>2){let u=at.subUnderflowU128(r[2],new y(e.reward_growth_inside_2));u.gt(new y("3402823669209384634633745948738404"))&&(u=Mi);const l=at.checkMulShiftRight(new y(e.liquidity),u,64,128);a.push(r[2]),c.push({amount_owed:new y(e.reward_amount_owed_2).add(l),coin_address:t.rewarder_infos[2].coinAddress})}return c}async batchFetchPositionRewarders(t){const e=[];for(const i of t){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos})}const n={};if(e.length>0){const i=await this.fetchPosRewardersAmount(e);for(const s of i)n[s.positionId]=s.rewarderAmountOwed;return n}return n}async batchFetchPositionFees(t){const e=[];for(const i of t){const s=await this._sdk.Position.getPositionById(i,!1),o=await this._sdk.Pool.getPool(s.pool,!1);e.push({poolAddress:o.poolAddress,positionId:s.pos_object_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB})}const n={};if(e.length>0){const i=await this.fetchPosFeeAmount(e);for(const s of i)n[s.position_id]=s;return n}return n}async fetchPosFeeAmount(t){var c;const{clmm_pool:e,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new Ct;for(const u of t){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(W(e).global_config_id),s.object(u.poolAddress),s.pure(u.positionId)];s.moveCall({target:`${n.published_at}::${di}::fetch_position_fees`,arguments:d,typeArguments:l})}const r=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address})).events)==null?void 0:c.filter(u=>ae(u.type).name==="FetchPositionFeesEvent");if(r.length===0)return[];const a=[];for(let u=0;u<r.length;u+=1){const{parsedJson:l}=r[u],d={feeOwedA:new y(l.fee_owned_a),feeOwedB:new y(l.fee_owned_b),position_id:l.position_id};a.push(d)}return a}async fetchPosRewardersAmount(t){var c;const{clmm_pool:e,integrate:n,simulationAccount:i}=this.sdk.sdkOptions,s=new Ct;for(const u of t){const l=[u.coinTypeA,u.coinTypeB],d=[s.object(W(e).global_config_id),s.object(u.poolAddress),s.pure(u.positionId),s.object(fe)];s.moveCall({target:`${n.published_at}::${di}::fetch_position_rewards`,arguments:d,typeArguments:l})}const r=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:s,sender:i.address})).events)==null?void 0:c.filter(u=>ae(u.type).name==="FetchPositionRewardsEvent");if(r.length===0)return[];if(r.length!==t.length)throw new Error("valueData.length !== params.pools.length");const a=[];for(let u=0;u<r.length;u+=1){console.log("params ",t[u]);const l={poolAddress:t[u].poolAddress,positionId:t[u].positionId,rewarderAmountOwed:[]};for(let d=0;d<t[u].rewarderInfo.length;d+=1)l.rewarderAmountOwed.push({amount_owed:new y(r[u].parsedJson.data[d]),coin_address:t[u].rewarderInfo[d].coinAddress});a.push(l)}return a}async fetchPoolRewardersAmount(t,e){const n=await this.sdk.Pool.getPool(e),i=await this.sdk.Position.getPositionList(t,[e]),s=[];for(const a of i)s.push({poolAddress:n.poolAddress,positionId:a.pos_object_id,rewarderInfo:n.rewarder_infos,coinTypeA:n.coinTypeA,coinTypeB:n.coinTypeB});const o=await this.fetchPosRewardersAmount(s),r=[Ue,Ue,Ue];if(o!=null)for(const a of o)for(let c=0;c<a.rewarderAmountOwed.length;c+=1)r[c]=r[c].add(a.rewarderAmountOwed[c].amount_owed);return r}async getPoolLowerAndUpperTicks(t,e){const n=[],i=[];for(const s of e){const o=await this.sdk.Pool.getTickDataByIndex(t,s.tick_lower_index),r=await this.sdk.Pool.getTickDataByIndex(t,s.tick_upper_index);n.push(o),i.push(r)}return[n,i]}async collectRewarderTransactionPayload(t){const e=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress,null);let n=new Ct;return n=tt.createCollectRewarderAndFeeParams(this._sdk,n,t,e),n}createCollectRewarderPaylod(t,e,n){const{clmm_pool:i,integrate:s}=this.sdk.sdkOptions,o=W(i),r=[t.coinTypeA,t.coinTypeB];return t.rewarder_coin_types.forEach((a,c)=>{e&&e.moveCall({target:`${s.published_at}::${Is}::collect_reward`,typeArguments:[...r,a],arguments:[e.object(o.global_config_id),e.object(t.pool_id),e.object(t.pos_id),e.object(o.global_vault_id),n[c],e.object(fe)]})}),e}};function cc(t,e){return{pair:`${t}-${e}`,reversePair:`${e}-${t}`}}var nI=class{constructor(t){xe(this,"graph");xe(this,"pathProviders");xe(this,"coinProviders");xe(this,"_coinAddressMap");xe(this,"poolAddressMap");xe(this,"_sdk");this.pathProviders=[],this.coinProviders={coins:[]},this.graph=new Gy(!1),this._coinAddressMap=new Map,this.poolAddressMap=new Map,this._sdk=t,this.getPoolAddressMapAndDirection=this.getPoolAddressMapAndDirection.bind(this),this.setCoinList=this.setCoinList.bind(this),this.loadGraph=this.loadGraph.bind(this),this.addCoinProvider=this.addCoinProvider.bind(this),this.addPathProvider=this.addPathProvider.bind(this),this.preRouterSwapA2B2C=this.preRouterSwapA2B2C.bind(this),this.price=this.price.bind(this),this.getPoolWithTVL=this.getPoolWithTVL.bind(this)}get sdk(){return this._sdk}getPoolAddressMapAndDirection(t,e){const{pair:n,reversePair:i}=cc(t,e);let s=this.poolAddressMap.get(n);if(s!=null)return{addressMap:s,direction:!0};if(s=this.poolAddressMap.get(i),s!=null)return{addressMap:s,direction:!1}}setCoinList(){this.coinProviders.coins.forEach(t=>{this._coinAddressMap.set(t.address,t)})}loadGraph(t,e){this.addCoinProvider(t),this.addPathProvider(e),this.setCoinList(),this.pathProviders.forEach(n=>{const{paths:i}=n;i.forEach(s=>{const o=this.graph.getVertexByKey(s.base)??new Xc(s.base),r=this.graph.getVertexByKey(s.quote)??new Xc(s.quote);this.graph.addEdge(new Ky(o,r));const a=this._coinAddressMap.get(s.base),c=this._coinAddressMap.get(s.quote);if(a!=null&&c!=null){const u=cc(s.base,s.quote).pair;this.poolAddressMap.set(u,s.addressMap)}})})}addPathProvider(t){for(let e=0;e<t.paths.length;e+=1){const{base:n,quote:i}=t.paths[e];n.localeCompare(i)<0&&(t.paths[e].base=i,t.paths[e].quote=n),n==="0x2::sui::SUI"&&(t.paths[e].base=i,t.paths[e].quote=n),i==="0x2::sui::SUI"&&(t.paths[e].base=n,t.paths[e].quote=i)}return this.pathProviders.push(t),this}addCoinProvider(t){return this.coinProviders=t,this}tokenInfo(t){return this._coinAddressMap.get(t)}getFeeRate(t,e,n){const i=cc(t,e).pair,s=this.poolAddressMap.get(i);if(s!=null){for(const[a,c]of s.entries())if(c===n)return a*100}const o=cc(t,e).reversePair,r=this.poolAddressMap.get(o);if(r!=null){for(const[a,c]of r.entries())if(c===n)return a*100}return 0}async price(t,e,n,i,s,o,r){const a=this.tokenInfo(t),c=this.tokenInfo(e);if(a===void 0||c===void 0)throw new Error("From/To coin is undefined");const u=this.graph.getVertexByKey(a.address),l=this.graph.getVertexByKey(c.address),d=this.graph.findAllPath(u,l),p=Array.from(d);if(p.length===0)throw new Error("No find valid path in coin graph");let g=[];for(let L=0;L<p.length;L+=1){const B=p[L];if(B.length>3)continue;const O=[],v=[],h=[],_=[];for(let A=0;A<B.length-1;A+=1){const C=B[A].value.toString(),M=B[A+1].value.toString(),N=this.getPoolAddressMapAndDirection(C,M),F=N==null?void 0:N.addressMap,x=N==null?void 0:N.direction;F!=null&&x!=null&&(v.push(x),O.push(C),O.push(M),F.forEach(m=>{A===0?h.push(m):_.push(m)}))}for(const A of h)if(_.length>0)for(const C of _){const M={stepNums:2,poolAB:A,poolBC:C,a2b:v[0],b2c:v[1],amount:n,byAmountIn:i,coinTypeA:O[0],coinTypeB:O[1],coinTypeC:O[3]};g.push(M)}else{const C={stepNums:1,poolAB:A,poolBC:void 0,a2b:v[0],b2c:void 0,amount:n,byAmountIn:i,coinTypeA:O[0],coinTypeB:O[1],coinTypeC:void 0};g.push(C)}}const b=g.filter(L=>L.stepNums===1);let w=g.filter(L=>L.stepNums!==1),T=[];try{T=await this.getPoolWithTVL()}catch{T=[]}if(T.length>0){const L=new Map(T.map(B=>[B.poolAddress,B]));w.sort((B,O)=>{let v=0,h=0;if(L.has(B.poolAB)&&L.has(B.poolBC)){const _=L.get(B.poolAB),A=L.get(B.poolBC);v=Math.min(_.tvl,A.tvl)}if(L.has(O.poolAB)&&L.has(O.poolBC)){const _=L.get(O.poolAB),A=L.get(O.poolBC);h=Math.min(_.tvl,A.tvl)}return h-v})}if(g=[...b,...w],g.length===0){if(r!=null){const L=await this.sdk.Swap.preSwapWithMultiPool(r),B={amountIn:new y(L.estimatedAmountIn),amountOut:new y(L.estimatedAmountOut),poolAddress:[L.poolAddress],a2b:[L.aToB],rawAmountLimit:i?[L.estimatedAmountOut]:[L.estimatedAmountIn],isExceed:L.isExceed,coinType:[t,e]},O={paths:[B],partner:o,priceSlippagePoint:s};return{amountIn:new y(L.estimatedAmountIn),amountOut:new y(L.estimatedAmountOut),paths:[B],a2b:L.aToB,b2c:void 0,byAmountIn:i,isExceed:L.isExceed,targetSqrtPrice:[L.estimatedEndSqrtPrice],currentSqrtPrice:[L.estimatedStartSqrtPrice],coinTypeA:t,coinTypeB:e,coinTypeC:void 0,createTxParams:O}}throw new Error("No parameters available for service downgrade")}const E=await this.preRouterSwapA2B2C(g.slice(0,16));if(E==null){if(r!=null){const B=await this.sdk.Swap.preSwapWithMultiPool(r),O={amountIn:new y(B.estimatedAmountIn),amountOut:new y(B.estimatedAmountOut),poolAddress:[B.poolAddress],a2b:[B.aToB],rawAmountLimit:i?[B.estimatedAmountOut]:[B.estimatedAmountIn],isExceed:B.isExceed,coinType:[t,e]},v={paths:[O],partner:o,priceSlippagePoint:s};return{amountIn:new y(B.estimatedAmountIn),amountOut:new y(B.estimatedAmountOut),paths:[O],a2b:B.aToB,b2c:void 0,byAmountIn:i,isExceed:B.isExceed,targetSqrtPrice:[B.estimatedEndSqrtPrice],currentSqrtPrice:[B.estimatedStartSqrtPrice],coinTypeA:t,coinTypeB:e,coinTypeC:void 0,createTxParams:v}}return{amountIn:Ue,amountOut:Ue,paths:[],a2b:!1,b2c:!1,byAmountIn:i,isExceed:!0,targetSqrtPrice:[],currentSqrtPrice:[],coinTypeA:"",coinTypeB:"",coinTypeC:void 0,createTxParams:void 0}}const P=E.index,k=g[P].poolBC!=null?[g[P].poolAB,g[P].poolBC]:[g[P].poolAB],S=i?[E.amountMedium,E.amountOut]:[E.amountIn,E.amountMedium],$=[];$.push(g[P].a2b),E.stepNum>1&&$.push(g[P].b2c);const H=[];H.push(g[P].coinTypeA),H.push(g[P].coinTypeB),E.stepNum>1&&H.push(g[P].coinTypeC);const V={amountIn:E.amountIn,amountOut:E.amountOut,poolAddress:k,a2b:$,rawAmountLimit:S,isExceed:E.isExceed,coinType:H},z={paths:[V],partner:o,priceSlippagePoint:s};return{amountIn:E.amountIn,amountOut:E.amountOut,paths:[V],a2b:g[P].a2b,b2c:E.stepNum>1?g[P].b2c:void 0,byAmountIn:i,isExceed:E.isExceed,targetSqrtPrice:E.targetSqrtPrice,currentSqrtPrice:E.currentSqrtPrice,coinTypeA:g[P].coinTypeA,coinTypeB:g[P].coinTypeB,coinTypeC:E.stepNum>1?g[P].coinTypeC:void 0,createTxParams:z}}async preRouterSwapA2B2C(t){var d;if(t.length===0)return null;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=new Ct;for(const p of t)if(p.stepNums>1){const g=[i.object(p.poolAB),i.object(p.poolBC),i.pure(p.a2b),i.pure(p.b2c),i.pure(p.byAmountIn),i.pure(p.amount.toString())],b=[];p.a2b?b.push(p.coinTypeA,p.coinTypeB):b.push(p.coinTypeB,p.coinTypeA),p.b2c?b.push(p.coinTypeB,p.coinTypeC):b.push(p.coinTypeC,p.coinTypeB),i.moveCall({target:`${e.published_at}::${ir}::calculate_router_swap_result`,typeArguments:b,arguments:g})}else{const g=[i.pure(p.poolAB),i.pure(p.a2b),i.pure(p.byAmountIn),i.pure(p.amount.toString())],b=p.a2b?[p.coinTypeA,p.coinTypeB]:[p.coinTypeB,p.coinTypeA];i.moveCall({target:`${e.published_at}::${pB}::get_expect_swap_result`,arguments:g,typeArguments:b})}const o=(d=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:d.filter(p=>ae(p.type).name==="CalculatedRouterSwapResultEvent"||ae(p.type).name==="ExpectSwapResultEvent");if(o.length===0)return null;let r=t[0].byAmountIn?Ue:Ar,a=0;for(let p=0;p<o.length;p+=1)if(!o[p].parsedJson.data.is_exceed)if(t[0].byAmountIn){const g=new y(o[p].parsedJson.data.amount_out);g.gt(r)&&(a=p,r=g)}else{const g=t[p].stepNums>1?new y(o[p].parsedJson.data.amount_in):new y(o[p].parsedJson.data.amount_in).add(new y(o[p].parsedJson.data.fee_amount));g.lt(r)&&(a=p,r=g)}const c=[],u=[];return t[a].stepNums>1?(u.push(o[a].parsedJson.data.target_sqrt_price_ab,o[a].parsedJson.data.target_sqrt_price_cd),c.push(o[a].parsedJson.data.current_sqrt_price_ab,o[a].parsedJson.data.current_sqrt_price_cd)):(u.push(o[a].parsedJson.data.after_sqrt_price),c.push(o[a].parsedJson.current_sqrt_price)),{index:a,amountIn:t[0].byAmountIn?t[a].amount:r,amountMedium:o[a].parsedJson.data.amount_medium,amountOut:t[0].byAmountIn?r:t[a].amount,targetSqrtPrice:u,currentSqrtPrice:c,isExceed:o[a].parsedJson.data.is_exceed,stepNum:t[a].stepNums}}async getPoolWithTVL(){const t=[],{swapCountUrl:e}=this._sdk.sdkOptions;if(!e)return t;let n;try{n=await fetch(e)}catch{throw new Error(`Failed to get pool list with liquidity from ${e}.`)}let i;try{i=await n.json()}catch{throw new Error(`Failed tp [arse response from ${e}].`)}if(i.code!==200)throw new Error(`Failed to get pool list from ${e}. Statu code is ${i.code}.`);const s=i.data.pools;for(const o of s)t.push({poolAddress:o.swap_account,tvl:Number(o.tvl_in_usd)});return t}},iI=class{constructor(t){xe(this,"_sdk");xe(this,"calculateSingleImpact",(t,e)=>e.minus(t).div(e).mul(100));this._sdk=t}get sdk(){return this._sdk}calculateSwapFee(t){let e=U(0);return t.forEach(n=>{const i=n.basePaths.length;if(i>0){const s=n.basePaths[0],o=s.label==="Cetus"?new ie(s.feeRate).div(10**6):new ie(s.feeRate).div(10**9),r=U(s.inputAmount).div(10**s.fromDecimal).mul(o);if(e=e.add(r),i>1){const a=n.basePaths[1],c=s.direction?s.currentPrice:new ie(1).div(s.currentPrice),u=a.direction?a.currentPrice:new ie(1).div(a.currentPrice),l=a.label==="Cetus"?new ie(a.feeRate).div(10**6):new ie(a.feeRate).div(10**9),p=U(a.outputAmount).div(10**a.toDecimal).mul(l).div(c.mul(u));e=e.add(p)}}}),e.toString()}calculateSwapPriceImpact(t){let e=U(0);return t.forEach(n=>{const i=n.basePaths.length;if(i===1){const s=n.basePaths[0],o=U(s.outputAmount).div(10**s.toDecimal),r=U(s.inputAmount).div(10**s.fromDecimal),a=o.div(r),c=s.direction?new ie(s.currentPrice):new ie(1).div(s.currentPrice);e=e.add(this.calculateSingleImpact(a,c))}if(i===2){const s=n.basePaths[0],o=n.basePaths[1],r=s.direction?new ie(s.currentPrice):new ie(1).div(s.currentPrice),a=o.direction?new ie(o.currentPrice):new ie(1).div(o.currentPrice),c=r.mul(a),u=new ie(o.outputAmount).div(10**o.toDecimal),l=new ie(s.inputAmount).div(10**s.fromDecimal),d=u.div(l);e=e.add(this.calculateSingleImpact(d,c))}}),e.toString()}async calculateFee(t,e,n,i){const s=await this.sdk.Token.getTokenListByCoinTypes([e.coinTypeA,e.coinTypeB]),o=s[e.coinTypeA].decimals,r=s[e.coinTypeB].decimals,a=Se.sqrtPriceX64ToPrice(new y(e.current_sqrt_price),o,r),c=U(e.fee_rate).div(1e4).div(100),u=t===e.coinTypeA;return console.log({a2b:u,feeTier:c}),{fee:U(n).mul(c),to_amount:i,currPrice:a,to_type:u?e.coinTypeB:e.coinTypeA,decimalsA:o,decimalsB:r}}changeAmount(t,e,n,i){let s;return t?s=U(e).mul(n):s=U(e).div(n),s.div(10**i)}async preSwapWithMultiPool(t){var u;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=new Ct,s=[t.coinTypeA,t.coinTypeB];for(let l=0;l<t.poolAddresses.length;l+=1){const d=[i.pure(t.poolAddresses[l]),i.pure(t.a2b),i.pure(t.byAmountIn),i.pure(t.amount)];i.moveCall({target:`${e.published_at}::${di}::calculate_swap_result`,arguments:d,typeArguments:s})}const r=(u=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:u.filter(l=>ae(l.type).name==="CalculatedSwapResultEvent");if(r.length===0)return null;if(r.length!==t.poolAddresses.length)throw new Error("valueData.length !== params.pools.length");let a=t.byAmountIn?Ue:Ar,c=0;for(let l=0;l<r.length;l+=1)if(!r[l].parsedJson.data.is_exceed)if(t.byAmountIn){const d=new y(r[l].parsedJson.data.amount_out);d.gt(a)&&(c=l,a=d)}else{const d=new y(r[l].parsedJson.data.amount_out);d.lt(a)&&(c=l,a=d)}return this.transformSwapWithMultiPoolData({poolAddress:t.poolAddresses[c],a2b:t.a2b,byAmountIn:t.byAmountIn,amount:t.amount,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB},r[c].parsedJson)}async preswap(t){var c;const{integrate:e,simulationAccount:n}=this.sdk.sdkOptions,i=new Ct,s=[t.coinTypeA,t.coinTypeB],o=[i.pure(t.pool.poolAddress),i.pure(t.a2b),i.pure(t.byAmountIn),i.pure(t.amount)];i.moveCall({target:`${e.published_at}::${di}::calculate_swap_result`,arguments:o,typeArguments:s});const a=(c=(await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:c.filter(u=>ae(u.type).name==="CalculatedSwapResultEvent");return a.length===0?null:this.transformSwapData(t,a[0].parsedJson.data)}transformSwapData(t,e){const n=e.amount_in&&e.fee_amount?new y(e.amount_in).add(new y(e.fee_amount)).toString():"";return{poolAddress:t.pool.poolAddress,currentSqrtPrice:t.currentSqrtPrice,estimatedAmountIn:n,estimatedAmountOut:e.amount_out,estimatedEndSqrtPrice:e.after_sqrt_price,estimatedFeeAmount:e.fee_amount,isExceed:e.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn}}transformSwapWithMultiPoolData(t,e){const{data:n}=e,i=n.amount_in&&n.fee_amount?new y(n.amount_in).add(new y(n.fee_amount)).toString():"";return{poolAddress:t.poolAddress,estimatedAmountIn:i,estimatedAmountOut:n.amount_out,estimatedEndSqrtPrice:n.after_sqrt_price,estimatedStartSqrtPrice:e.current_sqrt_price,estimatedFeeAmount:n.fee_amount,isExceed:n.is_exceed,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn}}calculateRates(t){const{currentPool:e}=t,n=hB(e);let i;t.a2b?i=t.swapTicks.sort((d,p)=>p.index-d.index):i=t.swapTicks.sort((d,p)=>d.index-p.index);const s=IB(t.a2b,t.byAmountIn,t.amount,n,i);let o=!1;t.byAmountIn?(console.log(s.amountIn.toString(),t.amount.toString(),t.byAmountIn),o=s.amountIn.lt(t.amount)):(console.log(s.amountOut.toString(),t.amount.toString(),t.byAmountIn),o=s.amountOut.lt(t.amount));const r=Gi.getDefaultSqrtPriceLimit(t.a2b);t.a2b&&s.nextSqrtPrice.lt(r)&&(o=!0),!t.a2b&&s.nextSqrtPrice.gt(r)&&(o=!0);let a=0;s.crossTickNum>6&&s.crossTickNum<40&&(a=22e3*(s.crossTickNum-6)),s.crossTickNum>40&&(o=!0);const c=Se.sqrtPriceX64ToPrice(n.currentSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),u=Se.sqrtPriceX64ToPrice(s.nextSqrtPrice,t.decimalsA,t.decimalsB).toNumber(),l=Math.abs(c-u)/c*100;return{estimatedAmountIn:s.amountIn,estimatedAmountOut:s.amountOut,estimatedEndSqrtPrice:s.nextSqrtPrice,estimatedFeeAmount:s.feeAmount,isExceed:o,extraComputeLimit:a,amount:t.amount,aToB:t.a2b,byAmountIn:t.byAmountIn,priceImpactPct:l}}async createSwapTransactionPayload(t,e){if(this._sdk.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=await this._sdk.getOwnerCoinAssets(this._sdk.senderAddress);if(e){const{isAdjustCoinA:i,isAdjustCoinB:s}=Bp(t);if(t.a2b&&i||!t.a2b&&s)return await tt.buildSwapTransactionForGas(this._sdk,t,n,e)}return tt.buildSwapTransaction(this.sdk,t,n)}},sI=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getAllRegisteredTokenList(t=!1){return await this.factchTokenList("",t)}async getOwnerTokenList(t="",e=!1){return await this.factchTokenList(t,e)}async getAllRegisteredPoolList(t=!1){return await this.factchPoolList("",t)}async getOwnerPoolList(t="",e=!1){return await this.factchPoolList(t,e)}async getWarpPoolList(t=!1){return await this.factchWarpPoolList("","",t)}async getOwnerWarpPoolList(t="",e="",n=!1){return await this.factchWarpPoolList(t,e,n)}async getTokenListByCoinTypes(t){const e={},n="getAllRegisteredTokenList",i=this.getCache(n);if(i!==void 0){const o=i;for(const r of t)for(const a of o)if(Mn(r)===Mn(a.address)){e[r]=a;continue}}const s=t.filter(o=>e[o]===void 0);for(const o of s){const r=`${o}_metadata`,a=this.getCache(r);if(a!==void 0)e[o]=a;else{const c=await this._sdk.fullClient.getCoinMetadata({coinType:o});if(c){const u={id:c.id,name:c.name,symbol:c.symbol,official_symbol:c.symbol,coingecko_id:"",decimals:c.decimals,project_url:"",logo_url:c.iconUrl,address:o};e[o]=u,this.updateCache(r,u,Ee)}}}return e}async factchTokenList(t="",e=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,s="getAllRegisteredTokenList",o=this.getCache(s,e);if(o!==void 0)return o;const r=t.length>0,a=512;let c=0,u=[];if(i===void 0)throw Error("please config token ofsdkOptions");const l=W(i);for(;;){const p=new Ct;p.moveCall({target:`${i.published_at}::coin_list::${r?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:r?[p.pure(l.coin_registry_id),p.pure(t),p.pure(c),p.pure(a)]:[p.pure(l.coin_registry_id),p.pure(c),p.pure(a)]});const g=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:p,sender:n.address}),b=[];if((d=g.events)==null||d.forEach(w=>{ae(w.type).full_address===`${i.published_at}::coin_list::FetchCoinListEvent`&&w.parsedJson.full_list.value_list.forEach(E=>{b.push(this.transformData(E,!1))})}),u=[...u,...b],b.length<a)break;c=u.length}return u}async factchPoolList(t="",e=!1){var d;const{simulationAccount:n,token:i}=this.sdk.sdkOptions,s="getAllRegisteredPoolList",o=this.getCache(s,e);if(o!==void 0)return o;let r=[];const a=512;let c=0;const u=t.length>0;if(i===void 0)throw Error("please config token ofsdkOptions");const l=W(i);for(;;){const p=new Ct;p.moveCall({target:`${i.published_at}::lp_list::${u?"fetch_full_list_with_limit":"fetch_all_registered_coin_info_with_limit"}`,arguments:u?[p.pure(l.pool_registry_id),p.pure(t),p.pure(c),p.pure(a)]:[p.pure(l.pool_registry_id),p.pure(c),p.pure(a)]});const g=await this.sdk.fullClient.devInspectTransactionBlock({transactionBlock:p,sender:n.address}),b=[];if((d=g.events)==null||d.forEach(w=>{ae(w.type).full_address===`${i.published_at}::lp_list::FetchPoolListEvent`&&w.parsedJson.full_list.value_list.forEach(E=>{b.push(this.transformData(E,!0))})}),r=[...r,...b],b.length<a)break;c=r.length}return r}async factchWarpPoolList(t="",e="",n=!1){const i=await this.factchPoolList(t,n);if(i.length===0)return[];const s=await this.factchTokenList(e,n),o=[];for(const r of i){for(const a of s)a.address===r.coin_a_address&&(r.coinA=a),a.address===r.coin_b_address&&(r.coinB=a);o.push(r)}return o}async getTokenConfigEvent(t=!1){const e=this._sdk.sdkOptions.token.package_id,n=`${e}_getTokenConfigEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=Fa(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:o}),a={coin_registry_id:"",pool_registry_id:"",coin_list_owner:"",pool_list_owner:""};return r.data.length>0&&r.data.forEach(c=>{const u=ae(c.type);if(c.transactionModule==="coin_list")switch(u.name){case"InitListEvent":a.coin_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent":a.coin_registry_id=c.parsedJson.registry_id;break}else if(c.transactionModule==="lp_list")switch(u.name){case"InitListEvent<address>":a.pool_list_owner=c.parsedJson.list_id;break;case"InitRegistryEvent<address>":a.pool_registry_id=c.parsedJson.registry_id;break}}),a.coin_registry_id.length>0&&this.updateCache(n,a,Ee),a}transformData(t,e){const n={...t};if(e)try{n.coin_a_address=ae(n.coin_a_address).full_address,n.coin_b_address=ae(n.coin_b_address).full_address}catch{}else n.address=ae(n.address).full_address;if(t.extensions){const i=t.extensions.contents;for(const s of i){const{key:o}=s;let{value:r}=s;if(o==="labels")try{r=JSON.parse(decodeURIComponent(er.decode(r)))}catch{}o==="pyth_id"&&(r=gn(r)),n[o]=r}delete n.extensions}return n}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},oI=class{constructor(t){xe(this,"_sdk");this._sdk=t}get sdk(){return this._sdk}calculatePrice(t,e,n,i,s){const o=i?e:n,r=i?n:e;return s==="Cetus"?Se.sqrtPriceX64ToPrice(t,o,r):new ie(t.toString()).div(new ie(10).pow(new ie(r+9-o)))}parseJsonResult(t){return{isExceed:t.is_exceed,isTimeout:t.is_timeout,inputAmount:t.input_amount,outputAmount:t.output_amount,fromCoin:t.from_coin,toCoin:t.to_coin,byAmountIn:t.by_amount_in,splitPaths:t.split_paths.map(n=>({pathIndex:n.path_index,lastQuoteOutput:n.last_quote_output,percent:n.percent,basePaths:n.best_path.map(s=>({direction:s.direction,label:s.label,poolAddress:s.provider,fromCoin:s.from_coin,toCoin:s.to_coin,outputAmount:s.output_amount,inputAmount:s.input_amount,feeRate:s.fee_rate,currentSqrtPrice:new y(s.current_sqrt_price.toString()),afterSqrtPrice:s.label==="Cetus"?new y(s.after_sqrt_price.toString()):Ue,fromDecimal:s.from_decimal,toDecimal:s.to_decimal,currentPrice:this.calculatePrice(new y(s.current_sqrt_price.toString()),s.from_decimal,s.to_decimal,s.direction,s.label)})),inputAmount:n.input_amount,outputAmount:n.output_amount}))}}async fetchWithTimeout(t,e,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n);try{const o=await fetch(t,{...e,signal:i.signal});return clearTimeout(s),o}catch{return null}}async fetchAndParseData(t,e){try{const i=await this.fetchWithTimeout(t,e,1500);return i.status===200?this.parseJsonResult(await i.json()):null}catch{return null}}async getBestRouter(t,e,n,i,s,o,r,a,c=!1,u=!1,l=[]){let d=null,p="v2",g={},b=this.sdk.sdkOptions.aggregatorUrl;if(l.length>0){const w=new URL(b);b=`${w.protocol}//${w.hostname}/router_with_lp_changes`,g={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:t,to:e,amount:n,by_amount_in:i,order_split:c,external_router:u,sender_address:"None",request_id:encodeURIComponent(y0()),lp_changes:l})}}else b=`
      ${b}?from=${encodeURIComponent(t)}&to=${encodeURIComponent(e)}&amount=${encodeURIComponent(n)}&by_amount_in=${encodeURIComponent(i)}&order_split=${encodeURIComponent(c)}&external_router=${encodeURIComponent(u)}&sender_address=''&request_id=${encodeURIComponent(y0())}
      `;if(console.log({apiUrl:b,options:g}),d=await this.fetchAndParseData(b,g),console.log({result:d}),d!=null&&d.isTimeout||d==null){const w=await this.sdk.Router.price(t,e,new y(n),i,s,o,a),T=[];for(const P of w.paths){const k=[];if(P.poolAddress.length>1){const $=this.sdk.Router.tokenInfo(P.coinType[0]).decimals,H=this.sdk.Router.tokenInfo(P.coinType[1]).decimals,V=P.a2b[0]?Se.sqrtPriceX64ToPrice(new y(w.currentSqrtPrice[0]),$,H):Se.sqrtPriceX64ToPrice(new y(w.currentSqrtPrice[0]),H,$),z={direction:P.a2b[0],label:"Cetus",poolAddress:P.poolAddress[0],fromCoin:P.coinType[0],toCoin:P.coinType[1],feeRate:this.sdk.Router.getFeeRate(P.coinType[0],P.coinType[1],P.poolAddress[0]),outputAmount:w.byAmountIn?P.rawAmountLimit[0].toString():P.rawAmountLimit[1].toString(),inputAmount:P.amountIn.toString(),currentSqrtPrice:w.currentSqrtPrice[0],currentPrice:V,fromDecimal:$,toDecimal:H},X=this.sdk.Router.tokenInfo(P.coinType[1]).decimals,L=this.sdk.Router.tokenInfo(P.coinType[2]).decimals,B=P.a2b[1]?Se.sqrtPriceX64ToPrice(new y(w.currentSqrtPrice[1]),X,L):Se.sqrtPriceX64ToPrice(new y(w.currentSqrtPrice[1]),L,X),O={direction:P.a2b[1],label:"Cetus",poolAddress:P.poolAddress[1],fromCoin:P.coinType[1],toCoin:P.coinType[2],feeRate:this.sdk.Router.getFeeRate(P.coinType[1],P.coinType[2],P.poolAddress[1]),outputAmount:P.amountOut.toString(),inputAmount:w.byAmountIn?P.rawAmountLimit[0].toString():P.rawAmountLimit[1].toString(),currentSqrtPrice:w.currentSqrtPrice[1],currentPrice:B,fromDecimal:X,toDecimal:L};k.push(z,O)}else{const $=this.sdk.Router.tokenInfo(P.coinType[0]).decimals,H=this.sdk.Router.tokenInfo(P.coinType[1]).decimals,V=P.a2b[0]?Se.sqrtPriceX64ToPrice(new y(w.currentSqrtPrice[0]),$,H):Se.sqrtPriceX64ToPrice(new y(w.currentSqrtPrice[0]),H,$),z={direction:P.a2b[0],label:"Cetus",poolAddress:P.poolAddress[0],fromCoin:P.coinType[0],toCoin:P.coinType[1],feeRate:this.sdk.Router.getFeeRate(P.coinType[0],P.coinType[1],P.poolAddress[0]),outputAmount:P.amountOut.toString(),inputAmount:P.amountIn.toString(),currentSqrtPrice:w.currentSqrtPrice[0],currentPrice:V,fromDecimal:$,toDecimal:H};k.push(z)}const S={percent:Number(P.amountIn)/Number(w.amountIn)*100,inputAmount:Number(P.amountIn.toString()),outputAmount:Number(P.amountOut.toString()),pathIndex:0,lastQuoteOutput:0,basePaths:k};T.push(S)}const E={isExceed:w.isExceed,isTimeout:!0,inputAmount:Number(w.amountIn.toString()),outputAmount:Number(w.amountOut.toString()),fromCoin:w.coinTypeA,toCoin:w.coinTypeC!=null?w.coinTypeC:w.coinTypeB,byAmountIn:w.byAmountIn,splitPaths:T};p="v1",d=E}return{result:d,version:p}}},rI=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getTokenListByCoinTypes(t){const e={},{coin_list_handle:n}=W(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,s=this.getCache(i);if(s!==void 0){const r=s;for(const a of t)for(const c of r)if(Mn(a)===Mn(c.address)){e[a]=c;continue}}const o=t.filter(r=>e[r]===void 0);for(const r of o){const a=`${r}_metadata`,c=this.getCache(a);if(c!==void 0)e[r]=c;else{const u=await this._sdk.fullClient.getCoinMetadata({coinType:r});if(u){const l={id:u.id,pyth_id:"",name:u.name,symbol:u.symbol,official_symbol:u.symbol,coingecko_id:"",decimals:u.decimals,project_url:"",logo_url:u.iconUrl,address:r};e[r]=l,this.updateCache(a,l,Ee)}else console.log(`not found ${r}`)}}return e}async getCoinConfigs(t=!1,e=!0){const{coin_list_handle:n}=W(this.sdk.sdkOptions.cetus_config),i=`${n}_getCoinConfigs`,s=this.getCache(i,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{const l=this.buildCoinConfig(u,e);this.updateCache(`${n}_${l.address}_getCoinConfig`,l,Ee),c.push({...l})}),this.updateCache(i,c,Ee),c}async getCoinConfig(t,e=!1,n=!0){const{coin_list_handle:i}=W(this.sdk.sdkOptions.cetus_config),s=`${i}_${t}_getCoinConfig`,o=this.getCache(s,e);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"0x1::type_name::TypeName",value:{name:MB(t)}}}),a=this.buildCoinConfig(r,n);return this.updateCache(s,a,Ee),a}buildCoinConfig(t,e=!0){let n=je(t);n=n.value.fields;const i={...n};return i.id=Di(t),i.address=ae(n.coin_type.fields.name).full_address,n.pyth_id&&(i.pyth_id=gn(n.pyth_id)),this.transformExtensions(i,n.extension_fields.fields.contents,e),delete i.coin_type,i}async getClmmPoolConfigs(t=!1,e=!0){const{clmm_pools_handle:n}=W(this.sdk.sdkOptions.cetus_config),i=`${n}_getClmmPoolConfigs`,s=this.getCache(i,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{const l=this.buildClmmPoolConfig(u,e);this.updateCache(`${l.pool_address}_getClmmPoolConfig`,l,Ee),c.push({...l})}),this.updateCache(i,c,Ee),c}async getClmmPoolConfig(t,e=!1,n=!0){const{clmm_pools_handle:i}=W(this.sdk.sdkOptions.cetus_config),s=`${t}_getClmmPoolConfig`,o=this.getCache(s,e);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:t}}),a=this.buildClmmPoolConfig(r,n);return this.updateCache(s,a,Ee),a}buildClmmPoolConfig(t,e=!0){let n=je(t);n=n.value.fields;const i={...n};return i.id=Di(t),i.pool_address=gn(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,e),i}async getLaunchpadPoolConfigs(t=!1,e=!0){const{launchpad_pools_handle:n}=W(this.sdk.sdkOptions.cetus_config),i=`${n}_getLaunchpadPoolConfigs`,s=this.getCache(i,t);if(s)return s;const r=(await this._sdk.fullClient.getDynamicFieldsByPage(n)).data.map(u=>u.objectId),a=await this._sdk.fullClient.batchGetObjects(r,{showContent:!0}),c=[];return a.forEach(u=>{const l=this.buildLaunchpadPoolConfig(u,e);this.updateCache(`${l.pool_address}_getLaunchpadPoolConfig`,l,Ee),c.push({...l})}),this.updateCache(i,c,Ee),c}async getLaunchpadPoolConfig(t,e=!1,n=!0){const{launchpad_pools_handle:i}=W(this.sdk.sdkOptions.cetus_config),s=`${t}_getLaunchpadPoolConfig`,o=this.getCache(s,e);if(o)return o;const r=await this._sdk.fullClient.getDynamicFieldObject({parentId:i,name:{type:"address",value:t}}),a=this.buildLaunchpadPoolConfig(r,n);return this.updateCache(s,a,Ee),a}buildLaunchpadPoolConfig(t,e=!0){let n=je(t);n=n.value.fields;const i={...n};i.id=Di(t),i.pool_address=gn(n.pool_address),this.transformExtensions(i,n.extension_fields.fields.contents,e);const s=[];n.social_media.fields.contents.forEach(o=>{s.push({name:o.fields.value.fields.name,link:o.fields.value.fields.link})}),i.social_media=s;try{i.regulation=decodeURIComponent(er.decode(i.regulation).replace(/%/g,"%25"))}catch{i.regulation=er.decode(i.regulation)}return i}transformExtensions(t,e,n=!0){const i=[];for(const s of e){const{key:o}=s.fields;let{value:r}=s.fields;if(o==="labels")try{r=JSON.parse(decodeURIComponent(er.decode(r)))}catch{}n&&(t[o]=r),i.push({key:o,value:r})}delete t.extension_fields,n||(t.extensions=i)}async getCetusConfig(t=!1){const e=this._sdk.sdkOptions.cetus_config.package_id,n=`${e}_getCetusConfig`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=Fa(s),r=await this._sdk.fullClient.queryEventsByPage({Transaction:o});let a={coin_list_id:"",launchpad_pools_id:"",clmm_pools_id:"",admin_cap_id:"",global_config_id:"",coin_list_handle:"",launchpad_pools_handle:"",clmm_pools_handle:""};if(r.data.length>0)for(const c of r.data)switch(ae(c.type).name){case"InitCoinListEvent":a.coin_list_id=c.parsedJson.coin_list_id;break;case"InitLaunchpadPoolsEvent":a.launchpad_pools_id=c.parsedJson.launchpad_pools_id;break;case"InitClmmPoolsEvent":a.clmm_pools_id=c.parsedJson.pools_id;break;case"InitConfigEvent":a.global_config_id=c.parsedJson.global_config_id,a.admin_cap_id=c.parsedJson.admin_cap_id;break}return a=await this.getCetusConfigHandle(a),a.clmm_pools_id.length>0&&this.updateCache(n,a,Ee),a}async getCetusConfigHandle(t){const e=[t.clmm_pools_id,t.coin_list_id,t.launchpad_pools_id];return(await this._sdk.fullClient.multiGetObjects({ids:e,options:{showContent:!0}})).forEach(i=>{const s=je(i),o=ro(i);switch(ae(o).name){case"ClmmPools":t.clmm_pools_handle=s.pools.fields.id.id;break;case"CoinList":t.coin_list_handle=s.coins.fields.id.id;break;case"LaunchpadPools":t.launchpad_pools_handle=s.pools.fields.id.id;break}}),t}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},aI=class extends aB{async queryEventsByPage(t,e="all"){let n=[],i=!0;const s=e==="all";let o=s?null:e.cursor;do{const r=await this.queryEvents({query:t,cursor:o,limit:s?null:e.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,o=r.nextCursor):i=!1}while(s&&i);return{data:n,nextCursor:o,hasNextPage:i}}async getOwnedObjectsByPage(t,e,n="all"){let i=[],s=!0;const o=n==="all";let r=o?null:n.cursor;do{const a=await this.getOwnedObjects({owner:t,...e,cursor:r,limit:o?null:n.limit});a.data?(i=[...i,...a.data],s=a.hasNextPage,r=a.nextCursor):s=!1}while(o&&s);return{data:i,nextCursor:r,hasNextPage:s}}async getDynamicFieldsByPage(t,e="all"){let n=[],i=!0;const s=e==="all";let o=s?null:e.cursor;do{const r=await this.getDynamicFields({parentId:t,cursor:o,limit:s?null:e.limit});r.data?(n=[...n,...r.data],i=r.hasNextPage,o=r.nextCursor):i=!1}while(s&&i);return{data:n,nextCursor:o,hasNextPage:i}}async batchGetObjects(t,e,n=50){let i=[];try{for(let s=0;s<Math.ceil(t.length/n);s++){const o=await this.multiGetObjects({ids:t.slice(s*n,n*(s+1)),options:e});i=[...i,...o]}}catch(s){console.log(s)}return i}async calculationTxGas(t){const{sender:e}=t.blockData;if(e===void 0)throw Error("sdk sender is empty");const n=await this.devInspectTransactionBlock({transactionBlock:t,sender:e}),{gasUsed:i}=n.effects;return Number(i.computationCost)+Number(i.storageCost)-Number(i.storageRebate)}async sendTransaction(t,e){try{return await this.signAndExecuteTransactionBlock({transactionBlock:e,signer:t,options:{showEffects:!0,showEvents:!0}})}catch(n){console.log("error: ",n)}}},Ns=class{constructor(t){xe(this,"_cache",{});xe(this,"_rpcModule");xe(this,"_pool");xe(this,"_position");xe(this,"_swap");xe(this,"_rewarder");xe(this,"_router");xe(this,"_router_v2");xe(this,"_token");xe(this,"_config");xe(this,"_sdkOptions");xe(this,"_senderAddress","");this._sdkOptions=t,this._rpcModule=new aI({url:t.fullRpcUrl}),this._swap=new iI(this),this._pool=new QB(this),this._position=new eI(this),this._rewarder=new tI(this),this._router=new nI(this),this._router_v2=new oI(this),this._token=new sI(this),this._config=new rI(this),Cp(this._sdkOptions)}get senderAddress(){return this._senderAddress}set senderAddress(t){this._senderAddress=t}get Swap(){return this._swap}get fullClient(){return this._rpcModule}get sdkOptions(){return this._sdkOptions}get Pool(){return this._pool}get Position(){return this._position}get Rewarder(){return this._rewarder}get Router(){return this._router}get RouterV2(){return this._router_v2}get CetusConfig(){return this._config}get Token(){return this._token}async getOwnerCoinAssets(t,e,n=!0){const i=[];let s=null;const o=`${this.sdkOptions.fullRpcUrl}_${t}_${e}_getOwnerCoinAssets`,r=this.getCache(o,n);if(r)return r;for(;;){const a=await(e?this.fullClient.getCoins({owner:t,coinType:e,cursor:s}):this.fullClient.getAllCoins({owner:t,cursor:s}));if(a.data.forEach(c=>{BigInt(c.balance)>0&&i.push({coinAddress:ae(c.coinType).source_address,coinObjectId:c.coinObjectId,balance:BigInt(c.balance)})}),s=a.nextCursor,!a.hasNextPage)break}return this.updateCache(o,i,30*1e3),i}async getOwnerCoinBalances(t,e){let n=[];return e?n=[await this.fullClient.getBalance({owner:t,coinType:e})]:n=[...await this.fullClient.getAllBalances({owner:t})],n}updateCache(t,e,n=Ee){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},cI=Ns;const Jw=32;function Zw(t){return uI(t)&&lI(t)===Jw}function tn(t,e=!1){let n=t.toLowerCase();return!e&&n.startsWith("0x")&&(n=n.slice(2)),`0x${n.padStart(Jw*2,"0")}`}function pi(t,e=!1){return tn(t,e)}function uI(t){return/^(0x|0X)?[a-fA-F0-9]+$/.test(t)&&t.length%2===0}function lI(t){return/^(0x|0X)/.test(t)?(t.length-2)/2:t.length/2}BigInt(1e9);pi("0x6");pi("0x5");f();f();f();f();f();f();const xo=Ce([I({AddressOwner:f()}),I({ObjectOwner:f()}),I({Shared:I({initial_shared_version:he(f())})}),re("Immutable")]),dI=qi("SuiJsonValue",()=>!0),hI=Ce([I({u32:f()}),I({u64:f()}),I({f64:f()})]);I({attributes:Mt(f(),he(hI)),featureFlags:Mt(f(),Re()),maxSupportedProtocolVersion:f(),minSupportedProtocolVersion:f(),protocolVersion:f()});Ce([f(),re("package")]);const vi=I({digest:f(),objectId:f(),version:Ce([le(),f()])}),pI=I({payment:G(vi),owner:f(),price:f(),budget:f()}),fI=cn(vi,I({type:f(),owner:xo,previousTransaction:f()})),gI=Mt(f(),Li()),mI=Mt(f(),uu()),_I=I({type:f(),fields:gI,hasPublicTransfer:Re()}),ah=I({disassembled:mI}),yI=Ce([cn(_I,I({dataType:re("moveObject")})),cn(ah,I({dataType:re("package")}))]),wI=I({type:f(),hasPublicTransfer:Re(),version:f(),bcsBytes:f()}),bI=I({id:f(),moduleMap:Mt(f(),f())}),vI=Ce([cn(wI,I({dataType:re("moveObject")})),cn(bI,I({dataType:re("package")}))]);BigInt(1e9);f();const Yw=I({code:f(),error:Z(f()),object_id:Z(f()),parent_object_id:Z(f()),version:Z(f()),digest:Z(f())}),TI=I({data:he(Z(Mt(f(),f()))),error:he(Z(Yw))}),AI=Ce([TI,Z(Mt(f(),f()))]),Qw=I({objectId:f(),version:f(),digest:f(),type:he(Z(f())),content:he(Z(yI)),bcs:he(Z(vI)),owner:he(Z(xo)),previousTransaction:he(Z(f())),storageRebate:he(Z(f())),display:he(Z(AI))});I({showType:he(Z(Re())),showContent:he(Z(Re())),showBcs:he(Z(Re())),showOwner:he(Z(Re())),showPreviousTransaction:he(Z(Re())),showStorageRebate:he(Z(Re())),showDisplay:he(Z(Re()))});Ce([re("Exists"),re("notExists"),re("Deleted")]);G(fI);const kI=I({data:he(Z(Qw)),error:he(Z(Yw))});function SI(t){return t.data}function xI(t){if(t.error&&"object_id"in t.error&&"version"in t.error&&"digest"in t.error){const e=t.error;return{objectId:e.object_id,version:e.version,digest:e.digest}}}function PI(t){if("reference"in t)return t.reference;const e=SI(t);return e?{objectId:e.objectId,version:e.version,digest:e.digest}:xI(t)}I({objectId:f(),atCheckpoint:Z(le())});I({data:G(kI),nextCursor:Z(he(f())),hasNextPage:Re()});Ce([I({details:Qw,status:re("VersionFound")}),I({details:f(),status:re("ObjectNotExists")}),I({details:vi,status:re("ObjectDeleted")}),I({details:wt([f(),le()]),status:re("VersionNotFound")}),I({details:I({asked_version:le(),latest_version:le(),object_id:f()}),status:re("VersionTooHigh")})]);const eb=I({txDigest:f(),eventSeq:f()}),tb=I({id:eb,packageId:f(),transactionModule:f(),sender:f(),type:f(),parsedJson:Z(Mt(f(),Li())),bcs:Z(f()),timestampMs:Z(f())});I({data:G(tb),nextCursor:he(eb),hasNextPage:Re()});f();const EI=I({epoch:f(),storage_charge:f(),computation_charge:f(),storage_rebate:f(),epoch_start_timestamp_ms:Z(f())}),CI=I({epoch:f(),round:f(),commit_timestamp_ms:f()}),BI=I({objects:G(f())}),_i=Ce([re("GasCoin"),I({Input:le()}),I({Result:le()}),I({NestedResult:wt([le(),le()])})]),II=I({arguments:Z(G(_i)),type_arguments:Z(G(f())),package:f(),module:f(),function:f()}),OI=Ce([I({MoveCall:II}),I({TransferObjects:wt([G(_i),_i])}),I({SplitCoins:wt([_i,G(_i)])}),I({MergeCoins:wt([_i,G(_i)])}),I({Publish:Ce([wt([ah,G(f())]),G(f())])}),I({Upgrade:Ce([wt([ah,G(f()),f(),_i]),wt([G(f()),f(),_i])])}),I({MakeMoveVec:wt([he(f()),G(_i)])})]),RI=Ce([I({type:re("pure"),valueType:he(f()),value:dI}),I({type:re("object"),objectType:re("immOrOwnedObject"),objectId:f(),version:f(),digest:f()}),I({type:re("object"),objectType:re("sharedObject"),objectId:f(),initialSharedVersion:f(),mutable:Re()})]),$I=I({transactions:G(OI),inputs:G(RI)}),UI=Ce([cn(EI,I({kind:re("ChangeEpoch")})),cn(CI,I({kind:re("ConsensusCommitPrologue")})),cn(BI,I({kind:re("Genesis")})),cn($I,I({kind:re("ProgrammableTransaction")}))]),nb=I({messageVersion:re("v1"),transaction:UI,sender:f(),gasData:pI});f();const MI=Ce([f(),G(f())]);I({epoch:f(),signature:MI,signers_map:G(le())});const DI=I({computationCost:f(),storageCost:f(),storageRebate:f(),nonRefundableStorageFee:f()}),qI=Ce([re("success"),re("failure")]),LI=I({status:qI,error:Z(f())}),uc=I({owner:xo,reference:vi}),NI=I({objectId:f(),sequenceNumber:f()}),Ip=I({messageVersion:re("v1"),status:LI,executedEpoch:f(),modifiedAtVersions:Z(G(NI)),gasUsed:DI,sharedObjects:Z(G(vi)),transactionDigest:f(),created:Z(G(uc)),mutated:Z(G(uc)),unwrapped:Z(G(uc)),deleted:Z(G(vi)),unwrappedThenDeleted:Z(G(vi)),wrapped:Z(G(vi)),gasObject:uc,eventsDigest:he(Z(f())),dependencies:Z(G(f()))}),Op=G(tb),jI=wt([G(le()),f()]),FI=wt([_i,G(le()),f()]),zI=I({mutableReferenceOutputs:Z(G(FI)),returnValues:Z(G(jI))});I({effects:Ip,events:Op,results:Z(G(zI)),error:Z(f())});f();const HI=I({data:nb,txSignatures:G(f())}),KI=I({type:re("published"),packageId:f(),version:f(),digest:f(),modules:G(f())}),GI=I({type:re("transferred"),sender:f(),recipient:xo,objectType:f(),objectId:f(),version:f(),digest:f()}),WI=I({type:re("mutated"),sender:f(),owner:xo,objectType:f(),objectId:f(),version:f(),previousVersion:f(),digest:f()}),VI=I({type:re("deleted"),sender:f(),objectType:f(),objectId:f(),version:f()}),XI=I({type:re("wrapped"),sender:f(),objectType:f(),objectId:f(),version:f()}),JI=I({type:re("created"),sender:f(),owner:xo,objectType:f(),objectId:f(),version:f(),digest:f()}),ib=Ce([KI,GI,WI,VI,XI,JI]),sb=I({owner:xo,coinType:f(),amount:f()}),ZI=I({digest:f(),transaction:Z(HI),effects:Z(Ip),events:Z(Op),timestampMs:Z(f()),checkpoint:Z(f()),confirmedLocalExecution:Z(Re()),objectChanges:Z(G(ib)),balanceChanges:Z(G(sb)),errors:Z(G(f()))});I({showInput:Z(Re()),showEffects:Z(Re()),showEvents:Z(Re()),showObjectChanges:Z(Re()),showBalanceChanges:Z(Re())});I({data:G(ZI),nextCursor:he(f()),hasNextPage:Re()});I({effects:Ip,events:Op,objectChanges:G(ib),balanceChanges:G(sb),input:Z(nb)});const YI=Ce([f(),I({Object:f()})]);G(YI);const QI=I({address:f(),name:f()}),e3=Ce([re("Private"),re("Public"),re("Friend")]),Rp=I({abilities:G(f())}),t3=I({constraints:Rp,isPhantom:Re()}),n3=I({TypeParameter:le()}),yd=wt([I({module:f(),package:f(),function:f()}),f()]);I({rank3Days:G(yd),rank7Days:G(yd),rank30Days:G(yd)});function ob(t){if(!t)return!1;if(typeof t=="string"||Ut(t,n3)||rb(t))return!0;if(typeof t!="object")return!1;const e=t;return!!(Ut(e.Reference,or)||Ut(e.MutableReference,or)||Ut(e.Vector,or))}const or=qi("SuiMoveNormalizedType",ob);function rb(t){if(!t||typeof t!="object")return!1;const e=t;if(!e.Struct||typeof e.Struct!="object")return!1;const n=e.Struct;return!(typeof n.address!="string"||typeof n.module!="string"||typeof n.name!="string"||!Array.isArray(n.typeArguments)||!n.typeArguments.every(i=>ob(i)))}qi("SuiMoveNormalizedStructType",rb);const i3=I({visibility:e3,isEntry:Re(),typeParameters:G(Rp),parameters:G(or),return:G(or)}),s3=I({name:f(),type:or}),o3=I({abilities:Rp,typeParameters:G(t3),fields:G(s3)}),r3=I({fileFormatVersion:le(),address:f(),name:f(),friends:G(QI),structs:Mt(f(),o3),exposedFunctions:Mt(f(),i3)});Mt(f(),r3);function ab(t){return typeof t=="object"&&"MutableReference"in t?t.MutableReference:void 0}function a3(t){return typeof t=="object"&&"Reference"in t?t.Reference:void 0}function cb(t){if(typeof t=="object"&&"Struct"in t)return t;const e=a3(t),n=ab(t);if(typeof e=="object"&&"Struct"in e)return e;if(typeof n=="object"&&"Struct"in n)return n}const c3=I({apy:le(),address:f()});I({epoch:f(),apys:G(c3)});I({value:le()});const u3=I({stakedSuiId:f(),stakeRequestEpoch:f(),stakeActiveEpoch:f(),principal:f(),status:Ce([re("Active"),re("Pending"),re("Unstaked")]),estimatedReward:Z(f())});I({validatorAddress:f(),stakingPool:f(),stakes:G(u3)});const l3=I({balance:I({value:le()}),distribution_counter:le(),current_distribution_amount:le(),stake_subsidy_period_length:le(),stake_subsidy_decrease_rate:le()});I({type:f(),fields:l3});I({value:le()});const d3=I({id:f(),size:le(),head:I({vec:G()}),tail:I({vec:G()})});I({id:f(),size:le()});I({type:f(),fields:d3});const h3=I({exchangeRates:I({id:f(),size:le()}),id:f(),pendingStake:le(),pendingPoolTokenWithdraw:le(),pendingTotalSuiWithdraw:le(),poolTokenBalance:le(),rewardsPool:I({value:le()}),activationEpoch:I({vec:G()}),deactivationEpoch:I({vec:G()}),suiBalance:le()});I({type:f(),fields:h3});const p3=G(wt([f(),f()]));I({epoch:f(),validators:p3});const ub=I({suiAddress:f(),protocolPubkeyBytes:f(),networkPubkeyBytes:f(),workerPubkeyBytes:f(),proofOfPossessionBytes:f(),operationCapId:f(),name:f(),description:f(),imageUrl:f(),projectUrl:f(),p2pAddress:f(),netAddress:f(),primaryAddress:f(),workerAddress:f(),nextEpochProtocolPubkeyBytes:he(f()),nextEpochProofOfPossession:he(f()),nextEpochNetworkPubkeyBytes:he(f()),nextEpochWorkerPubkeyBytes:he(f()),nextEpochNetAddress:he(f()),nextEpochP2pAddress:he(f()),nextEpochPrimaryAddress:he(f()),nextEpochWorkerAddress:he(f()),votingPower:f(),gasPrice:f(),commissionRate:f(),nextEpochStake:f(),nextEpochGasPrice:f(),nextEpochCommissionRate:f(),stakingPoolId:f(),stakingPoolActivationEpoch:he(f()),stakingPoolDeactivationEpoch:he(f()),stakingPoolSuiBalance:f(),rewardsPool:f(),poolTokenBalance:f(),pendingStake:f(),pendingPoolTokenWithdraw:f(),pendingTotalSuiWithdraw:f(),exchangeRatesId:f(),exchangeRatesSize:f()});I({epoch:f(),protocolVersion:f(),systemStateVersion:f(),storageFundTotalObjectStorageRebates:f(),storageFundNonRefundableBalance:f(),referenceGasPrice:f(),safeMode:Re(),safeModeStorageRewards:f(),safeModeComputationRewards:f(),safeModeStorageRebates:f(),safeModeNonRefundableStorageFee:f(),epochStartTimestampMs:f(),epochDurationMs:f(),stakeSubsidyStartEpoch:f(),maxValidatorCount:f(),minValidatorJoiningStake:f(),validatorLowStakeThreshold:f(),validatorVeryLowStakeThreshold:f(),validatorLowStakeGracePeriod:f(),stakeSubsidyBalance:f(),stakeSubsidyDistributionCounter:f(),stakeSubsidyCurrentDistributionAmount:f(),stakeSubsidyPeriodLength:f(),stakeSubsidyDecreaseRate:le(),totalStake:f(),activeValidators:G(ub),pendingActiveValidatorsId:f(),pendingActiveValidatorsSize:f(),pendingRemovals:G(f()),stakingPoolMappingsId:f(),stakingPoolMappingsSize:f(),inactivePoolsId:f(),inactivePoolsSize:f(),validatorCandidatesId:f(),validatorCandidatesSize:f(),atRiskValidators:G(wt([f(),f()])),validatorReportRecords:G(wt([f(),G(f())]))});const f3=I({coinType:f(),coinObjectId:f(),version:f(),digest:f(),balance:f(),previousTransaction:f()});I({data:G(f3),nextCursor:he(f()),hasNextPage:Re()});I({coinType:f(),coinObjectCount:le(),totalBalance:f(),lockedBalance:I({epochId:Z(le()),number:Z(le())})});I({value:f()});const g3=I({lastCheckpointId:f(),epochEndTimestamp:f(),protocolVersion:f(),referenceGasPrice:f(),totalStake:f(),storageFundReinvestment:f(),storageCharge:f(),storageRebate:f(),storageFundBalance:f(),stakeSubsidyAmount:f(),totalGasFees:f(),totalStakeRewardsDistributed:f(),leftoverStorageFundInflow:f()}),m3=I({epoch:f(),validators:G(ub),epochTotalTransactions:f(),firstCheckpointId:f(),epochStartTimestamp:f(),endOfEpochInfo:he(g3),referenceGasPrice:he(le())});I({data:G(m3),nextCursor:he(f()),hasNextPage:Re()});I({data:G(f()),hasNextPage:Re(),nextCursor:he(f())});const _3=Ce([re("DynamicField"),re("DynamicObject")]),y3=I({type:f(),value:Li()}),w3=I({name:y3,bcsName:f(),type:_3,objectType:f(),objectId:f(),version:le(),digest:f()});I({data:G(w3),nextCursor:he(f()),hasNextPage:Re()});const b3=I({computationCost:f(),storageCost:f(),storageRebate:f(),nonRefundableStorageFee:f()});f();f();I({digest:G(le())});const lb=Li();f();const v3=I({nextEpochCommittee:G(wt([f(),f()])),nextEpochProtocolVersion:f(),epochCommitments:G(lb)});I({transaction:f(),effects:f()});const T3=I({epoch:f(),sequenceNumber:f(),digest:f(),networkTotalTransactions:f(),previousDigest:Z(f()),epochRollingGasCostSummary:b3,timestampMs:f(),endOfEpochData:Z(v3),validatorSignature:f(),transactions:G(f()),checkpointCommitments:G(lb)});I({data:G(T3),nextCursor:he(f()),hasNextPage:Re()});I({currentTps:le(),tps30Days:le(),currentCheckpoint:f(),currentEpoch:f(),totalAddresses:f(),totalObjects:f(),totalPackages:f()});const A3=I({checkpoint:le(),epoch:le(),timestampMs:le(),cumulativeAddresses:le(),cumulativeActiveAddresses:le(),dailyActiveAddresses:le()});G(A3);const db="0x2",$p="0x1",k3="object",S3="ID",x3=`${db}::sui::SUI`;pi("0x6");I({decimals:le(),name:f(),symbol:f(),description:f(),iconUrl:he(f()),id:he(f())});const P3="ascii",E3="String",C3="string",B3="String",I3="option",O3="Option",R3={address:db,module:k3,name:S3},$3={address:$p,module:P3,name:E3},U3={address:$p,module:C3,name:B3},M3={address:$p,module:I3,name:O3},lc=(t,e)=>t.address===e.address&&t.module===e.module&&t.name===e.name;function D3(t){var n;const e=(n=cb(t))==null?void 0:n.Struct;return(e==null?void 0:e.address)==="0x2"&&(e==null?void 0:e.module)==="tx_context"&&(e==null?void 0:e.name)==="TxContext"}function wd(t,e){if(!(typeof e>"u")&&typeof e!==t)throw new Error(`Expect ${e} to be ${t}, received ${typeof e}`)}const q3=["Address","Bool","U8","U16","U32","U64","U128","U256"];function ch(t,e){if(typeof t=="string"&&q3.includes(t)){if(t in["U8","U16","U32","U64","U128","U256"])wd("number",e);else if(t==="Bool")wd("boolean",e);else if(t==="Address"&&(wd("string",e),e&&!Zw(e)))throw new Error("Invalid Sui Address");return t.toLowerCase()}else if(typeof t=="string")throw new Error(`Unknown pure normalized type ${JSON.stringify(t,null,2)}`);if("Vector"in t){if((e===void 0||typeof e=="string")&&t.Vector==="U8")return"string";if(e!==void 0&&!Array.isArray(e))throw new Error(`Expect ${e} to be a array, received ${typeof e}`);const n=ch(t.Vector,e?e[0]:void 0);return n===void 0?void 0:`vector<${n}>`}if("Struct"in t){if(lc(t.Struct,$3))return"string";if(lc(t.Struct,U3))return"utf8string";if(lc(t.Struct,R3))return"address";if(lc(t.Struct,M3)){const n={Vector:t.Struct.typeArguments[0]};return ch(n,e)}}}const Oo="vector",L3={kind:"TransactionKind",sender:Te.ADDRESS,gasData:"GasData",expiration:"TransactionExpiration"},N3={enums:{"Option<T>":{None:null,Some:"T"},ObjectArg:{ImmOrOwned:"SuiObjectRef",Shared:"SharedObjectRef"},CallArg:{Pure:[Oo,Te.U8],Object:"ObjectArg",ObjVec:[Oo,"ObjectArg"]},TypeTag:{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:"TypeTag",struct:"StructTag",u16:null,u32:null,u256:null},TransactionKind:{ProgrammableTransaction:"ProgrammableTransaction",ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null},TransactionExpiration:{None:null,Epoch:"unsafe_u64"},TransactionData:{V1:"TransactionDataV1"}},structs:{SuiObjectRef:{objectId:Te.ADDRESS,version:Te.U64,digest:"ObjectDigest"},SharedObjectRef:{objectId:Te.ADDRESS,initialSharedVersion:Te.U64,mutable:Te.BOOL},StructTag:{address:Te.ADDRESS,module:Te.STRING,name:Te.STRING,typeParams:[Oo,"TypeTag"]},GasData:{payment:[Oo,"SuiObjectRef"],owner:Te.ADDRESS,price:Te.U64,budget:Te.U64},SenderSignedData:{data:"TransactionData",txSignatures:[Oo,[Oo,Te.U8]]},TransactionDataV1:L3},aliases:{ObjectDigest:Te.BASE58}},Up=new Te({...rw(),types:N3});Up.registerType("utf8string",(t,e)=>{const n=Array.from(new TextEncoder().encode(e));return t.writeVec(n,(i,s)=>i.write8(s))},t=>{let e=t.readVec(n=>n.read8());return new TextDecoder().decode(new Uint8Array(e))});Up.registerType("unsafe_u64",(t,e)=>t.write64(e),t=>Number.parseInt(t.read64(),10));const j3=/^vector<(.+)>$/,F3=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/;class Wi{static parseFromStr(e,n=!1){if(e==="address")return{address:null};if(e==="bool")return{bool:null};if(e==="u8")return{u8:null};if(e==="u16")return{u16:null};if(e==="u32")return{u32:null};if(e==="u64")return{u64:null};if(e==="u128")return{u128:null};if(e==="u256")return{u256:null};if(e==="signer")return{signer:null};const i=e.match(j3);if(i)return{vector:Wi.parseFromStr(i[1],n)};const s=e.match(F3);if(s)return{struct:{address:n?tn(s[1]):s[1],module:s[2],name:s[3],typeParams:s[5]===void 0?[]:Wi.parseStructTypeArgs(s[5],n)}};throw new Error(`Encountered unexpected token when parsing type args for ${e}`)}static parseStructTypeArgs(e,n=!1){return pp(e).map(i=>Wi.parseFromStr(i,n))}static tagToString(e){if("bool"in e)return"bool";if("u8"in e)return"u8";if("u16"in e)return"u16";if("u32"in e)return"u32";if("u64"in e)return"u64";if("u128"in e)return"u128";if("u256"in e)return"u256";if("address"in e)return"address";if("signer"in e)return"signer";if("vector"in e)return`vector<${Wi.tagToString(e.vector)}>`;if("struct"in e){const n=e.struct,i=n.typeParams.map(Wi.tagToString).join(", ");return`${n.address}::${n.module}::${n.name}${i?`<${i}>`:""}`}throw new Error("Invalid TypeTag")}}const hb="Argument",Tn="vector",z3="Option",H3="CallArg",k0="TypeTag",K3="ProgrammableTransaction",uh="ProgrammableMoveCall",pb="Transaction",S0="CompressedSignature",x0="PublicKey",P0="MultiSigPublicKey",E0="MultiSigPkMap",G3="MultiSig",Mp="EnumKind",W3=[Mp,pb],ji=[Mp,hb],fb="SimpleProgrammableMoveCall",li=new Te(Up);Dp(li,"FixedArray[64]",64);Dp(li,"FixedArray[33]",33);Dp(li,"FixedArray[32]",32);li.registerStructType(K3,{inputs:[Tn,H3],transactions:[Tn,W3]}).registerEnumType(hb,{GasCoin:null,Input:{index:Te.U16},Result:{index:Te.U16},NestedResult:{index:Te.U16,resultIndex:Te.U16}}).registerStructType(uh,{package:Te.ADDRESS,module:Te.STRING,function:Te.STRING,type_arguments:[Tn,k0],arguments:[Tn,ji]}).registerEnumType(pb,{MoveCall:fb,TransferObjects:{objects:[Tn,ji],address:ji},SplitCoins:{coin:ji,amounts:[Tn,ji]},MergeCoins:{destination:ji,sources:[Tn,ji]},Publish:{modules:[Tn,[Tn,Te.U8]],dependencies:[Tn,Te.ADDRESS]},MakeMoveVec:{type:[z3,k0],objects:[Tn,ji]},Upgrade:{modules:[Tn,[Tn,Te.U8]],dependencies:[Tn,Te.ADDRESS],packageId:Te.ADDRESS,ticket:ji}}).registerEnumType(S0,{ED25519:["FixedArray[64]","u8"],Secp256k1:["FixedArray[64]","u8"],Secp256r1:["FixedArray[64]","u8"]}).registerEnumType(x0,{ED25519:["FixedArray[32]","u8"],Secp256k1:["FixedArray[33]","u8"],Secp256r1:["FixedArray[33]","u8"]}).registerStructType(E0,{pubKey:x0,weight:Te.U8}).registerStructType(P0,{pk_map:[Tn,E0],threshold:Te.U16}).registerStructType(G3,{sigs:[Tn,S0],bitmap:Te.U16,multisig_pk:P0});li.registerType([Mp,"T"],function(e,n,i,s){const r={[n.kind]:n},[a]=i;return this.getTypeInterface(a)._encodeRaw.call(this,e,r,i,s)},function(e,n,i){const[s]=n,o=this.getTypeInterface(s)._decodeRaw.call(this,e,n,i),r=Object.keys(o)[0];return{kind:r,...o[r]}},t=>{if(typeof t!="object"&&!("kind"in t))throw new Error(`EnumKind: Missing property "kind" in the input ${JSON.stringify(t)}`);return!0});li.registerType(fb,function(e,n,i,s){const[o,r,a]=n.target.split("::"),c=n.typeArguments.map(u=>Wi.parseFromStr(u,!0));return this.getTypeInterface(uh)._encodeRaw.call(this,e,{package:tn(o),module:r,function:a,type_arguments:c,arguments:n.arguments},i,s)},function(e,n,i){let s=li.getTypeInterface(uh)._decodeRaw.call(this,e,n,i);return{target:[s.package,s.module,s.function].join("::"),arguments:s.arguments,typeArguments:s.type_arguments.map(Wi.tagToString)}},t=>t.target.split("::").length===3);function Dp(t,e,n){t.registerType(e,function(s,o,r,a){if(o.length!==n)throw new Error(`Expected fixed array of length ${n}, got ${o.length}`);if(r.length!==1)throw new Error(`Expected one type parameter in a fixed array, got ${r.length}`);let[c]=typeof r[0]=="string"?[r[0],[]]:r[0];for(let u of o)this.getTypeInterface(c)._encodeRaw.call(this,s,u,r,a);return s},function(s,o,r){if(o.length!==1)throw new Error(`Expected one type parameter in a fixed array, got ${o.length}`);let a=[],[c]=typeof o[0]=="string"?[o[0],[]]:o[0];for(let u=0;u<n;u++)a.push(this.getTypeInterface(c)._decodeRaw.call(this,s,o,r));return a})}const V3=Ce([I({ImmOrOwned:vi}),I({Shared:I({objectId:f(),initialSharedVersion:Ce([un(),f()]),mutable:Re()})})]),ru=I({Pure:G(un())}),X3=I({Object:V3}),oa=Ce([ru,X3]),Vi={Pure(t,e){return{Pure:Array.from(t instanceof Uint8Array?t:li.ser(e,t,{maxSize:1/0}).toBytes())}},ObjectRef({objectId:t,digest:e,version:n}){return{Object:{ImmOrOwned:{digest:e,version:n,objectId:tn(t)}}}},SharedObjectRef({objectId:t,mutable:e,initialSharedVersion:n}){return{Object:{Shared:{mutable:e,initialSharedVersion:n,objectId:tn(t)}}}}};function C0(t){return typeof t=="string"?tn(t):"ImmOrOwned"in t.Object?tn(t.Object.ImmOrOwned.objectId):tn(t.Object.Shared.objectId)}function J3(t){return typeof t=="object"&&"Object"in t&&"Shared"in t.Object?t.Object.Shared:void 0}function Z3(t){var e;return((e=J3(t))==null?void 0:e.mutable)??!1}function Fn(t,e){return L0(t,e)}const au=Symbol("transaction-argument-type"),Y3=t=>Ce([I({None:Ce([re(!0),re(null)])}),I({Some:t})]),ya=I({kind:re("Input"),index:un(),value:Z(Li()),type:Z(Ce([re("pure"),re("object")]))}),qp=[ya,I({kind:re("GasCoin")}),I({kind:re("Result"),index:un()}),I({kind:re("NestedResult"),index:un(),resultIndex:un()})],Q3=Ce([...qp]),ao=Ce([...qp]);ao[au]={kind:"object"};const gb=t=>{const e=Ce([...qp]);return e[au]={kind:"pure",type:t},e},mb=I({kind:re("MoveCall"),target:qi("target",f().validator),typeArguments:G(f()),arguments:G(Q3)}),_b=I({kind:re("TransferObjects"),objects:G(ao),address:gb(Te.ADDRESS)}),yb=I({kind:re("SplitCoins"),coin:ao,amounts:G(gb("u64"))}),wb=I({kind:re("MergeCoins"),destination:ao,sources:G(ao)}),bb=I({kind:re("MakeMoveVec"),type:Z(Y3(Mt(f(),uu()))),objects:G(ao)}),vb=I({kind:re("Publish"),modules:G(G(un())),dependencies:G(f())}),Tb=I({kind:re("Upgrade"),modules:G(G(un())),dependencies:G(f()),packageId:f(),ticket:ao}),Ab=[mb,_b,yb,wb,vb,Tb,bb],kb=Ce([...Ab]);function e4(t){return rr(t,kb),Ab.find(e=>Ut(t,e))}const ys={MoveCall(t){return Fn({kind:"MoveCall",target:t.target,arguments:t.arguments??[],typeArguments:t.typeArguments??[]},mb)},TransferObjects(t,e){return Fn({kind:"TransferObjects",objects:t,address:e},_b)},SplitCoins(t,e){return Fn({kind:"SplitCoins",coin:t,amounts:e},yb)},MergeCoins(t,e){return Fn({kind:"MergeCoins",destination:t,sources:e},wb)},Publish({modules:t,dependencies:e}){return Fn({kind:"Publish",modules:t.map(n=>typeof n=="string"?Array.from(ki(n)):n),dependencies:e.map(n=>pi(n))},vb)},Upgrade({modules:t,dependencies:e,packageId:n,ticket:i}){return Fn({kind:"Upgrade",modules:t.map(s=>typeof s=="string"?Array.from(ki(s)):s),dependencies:e.map(s=>pi(s)),packageId:n,ticket:i},Tb)},MakeMoveVec({type:t,objects:e}){return Fn({kind:"MakeMoveVec",type:t?{Some:Wi.parseFromStr(t)}:{None:null},objects:e},bb)}};function t4(t,e){const n=Array.from(`${t}::`).map(s=>s.charCodeAt(0)),i=new Uint8Array(n.length+e.length);return i.set(n),i.set(e,n.length),N0(i,{dkLen:32})}const n4=Z(he(Ce([I({Epoch:un()}),I({None:Ce([re(!0),re(null)])})]))),B0=qi("StringEncodedBigint",t=>{if(!["string","number","bigint"].includes(typeof t))return!1;try{return BigInt(t),!0}catch{return!1}}),i4=I({budget:Z(B0),price:Z(B0),payment:Z(G(vi)),owner:Z(f())}),dc=I({version:re(1),sender:Z(f()),expiration:n4,gasConfig:i4,inputs:G(ya),transactions:G(kb)});function I0(t){return tn(t).replace("0x","")}class Ji{constructor(e){this.version=1,this.sender=e==null?void 0:e.sender,this.expiration=e==null?void 0:e.expiration,this.gasConfig=(e==null?void 0:e.gasConfig)??{},this.inputs=(e==null?void 0:e.inputs)??[],this.transactions=(e==null?void 0:e.transactions)??[]}static fromKindBytes(e){const n=li.de("TransactionKind",e),i=n==null?void 0:n.ProgrammableTransaction;if(!i)throw new Error("Unable to deserialize from bytes.");const s=Fn({version:1,gasConfig:{},inputs:i.inputs.map((o,r)=>Fn({kind:"Input",value:o,index:r,type:Ut(o,ru)?"pure":"object"},ya)),transactions:i.transactions},dc);return Ji.restore(s)}static fromBytes(e){var r;const n=li.de("TransactionData",e),i=n==null?void 0:n.V1,s=(r=i==null?void 0:i.kind)==null?void 0:r.ProgrammableTransaction;if(!i||!s)throw new Error("Unable to deserialize from bytes.");const o=Fn({version:1,sender:i.sender,expiration:i.expiration,gasConfig:i.gasData,inputs:s.inputs.map((a,c)=>Fn({kind:"Input",value:a,index:c,type:Ut(a,ru)?"pure":"object"},ya)),transactions:s.transactions},dc);return Ji.restore(o)}static restore(e){rr(e,dc);const n=new Ji;return Object.assign(n,e),n}static getDigestFromBytes(e){const n=t4("TransactionData",e);return ml(n)}build({maxSizeBytes:e=1/0,overrides:n,onlyTransactionKind:i}={}){const s=this.inputs.map(l=>(rr(l.value,oa),l.value)),o={ProgrammableTransaction:{inputs:s,transactions:this.transactions}};if(i)return li.ser("TransactionKind",o,{maxSize:e}).toBytes();const r=(n==null?void 0:n.expiration)??this.expiration,a=(n==null?void 0:n.sender)??this.sender,c={...this.gasConfig,...n==null?void 0:n.gasConfig};if(!a)throw new Error("Missing transaction sender");if(!c.budget)throw new Error("Missing gas budget");if(!c.payment)throw new Error("Missing gas payment");if(!c.price)throw new Error("Missing gas price");const u={sender:I0(a),expiration:r||{None:!0},gasData:{payment:c.payment,owner:I0(this.gasConfig.owner??a),price:BigInt(c.price),budget:BigInt(c.budget)},kind:{ProgrammableTransaction:{inputs:s,transactions:this.transactions}}};return li.ser("TransactionData",{V1:u},{maxSize:e}).toBytes()}getDigest(){const e=this.build({onlyTransactionKind:!1});return Ji.getDigestFromBytes(e)}snapshot(){return Fn(this,dc)}}var Lp=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},xt=(t,e,n)=>(Lp(t,e,"read from private field"),n?n.call(t):e.get(t)),ws=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},hc=(t,e,n,i)=>(Lp(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Un=(t,e,n)=>(Lp(t,e,"access private method"),n),_t,$c,lh,Ms,co,Np,Sb,jp,xb,Fp,Pb,zp,Eb,Uc,dh;const s4={maxPureArgumentSize:16*1024,maxTxGas:5e10,maxGasObjects:256,maxTxSizeBytes:128*1024};function o4(t){const e={kind:"Result",index:t},n=[],i=s=>n[s]??(n[s]={kind:"NestedResult",index:t,resultIndex:s});return new Proxy(e,{set(){throw new Error("The transaction result is a proxy, and does not support setting properties directly")},get(s,o){if(o in s)return Reflect.get(s,o);if(o===Symbol.iterator)return function*(){let a=0;for(;;)yield i(a),a++};if(typeof o=="symbol")return;const r=parseInt(o,10);if(!(Number.isNaN(r)||r<0))return i(r)}})}function wa(t){if(!t.client&&!t.provider)throw new Error("No provider passed to Transaction#build, but transaction data was not sufficient to build offline.");return t.client??t.provider}const O0=Symbol.for("@mysten/transaction"),bd={maxTxGas:"max_tx_gas",maxGasObjects:"max_gas_payment_objects",maxTxSizeBytes:"max_tx_size_bytes",maxPureArgumentSize:"max_pure_argument_size"},r4=1000n,a4=50,c4=(t,e)=>Array.from({length:Math.ceil(t.length/e)},(n,i)=>t.slice(i*e,i*e+e)),u4=class hh{constructor(e){ws(this,$c),ws(this,Ms),ws(this,Np),ws(this,jp),ws(this,Fp),ws(this,zp),ws(this,Uc),ws(this,_t,void 0),hc(this,_t,new Ji(e?e.blockData:void 0))}static is(e){return!!e&&typeof e=="object"&&e[O0]===!0}static fromKind(e){const n=new hh;return hc(n,_t,Ji.fromKindBytes(typeof e=="string"?ki(e):e)),n}static from(e){const n=new hh;return typeof e!="string"||!e.startsWith("{")?hc(n,_t,Ji.fromBytes(typeof e=="string"?ki(e):e)):hc(n,_t,Ji.restore(JSON.parse(e))),n}static get Transactions(){return ys}static get Inputs(){return Vi}setSender(e){xt(this,_t).sender=e}setSenderIfNotSet(e){xt(this,_t).sender||(xt(this,_t).sender=e)}setExpiration(e){xt(this,_t).expiration=e}setGasPrice(e){xt(this,_t).gasConfig.price=String(e)}setGasBudget(e){xt(this,_t).gasConfig.budget=String(e)}setGasOwner(e){xt(this,_t).gasConfig.owner=e}setGasPayment(e){xt(this,_t).gasConfig.payment=e.map(n=>j0(n,vi))}get blockData(){return xt(this,_t).snapshot()}get[O0](){return!0}get gas(){return{kind:"GasCoin"}}object(e){const n=C0(e);return xt(this,_t).inputs.find(s=>s.type==="object"&&n===C0(s.value))??Un(this,$c,lh).call(this,"object",e)}objectRef(...e){return this.object(Vi.ObjectRef(...e))}sharedObjectRef(...e){return this.object(Vi.SharedObjectRef(...e))}pure(e,n){return Un(this,$c,lh).call(this,"pure",e instanceof Uint8Array?Vi.Pure(e):n?Vi.Pure(e,n):e)}add(e){const n=xt(this,_t).transactions.push(e);return o4(n-1)}splitCoins(...e){return this.add(ys.SplitCoins(...e))}mergeCoins(...e){return this.add(ys.MergeCoins(...e))}publish(...e){return this.add(ys.Publish(...e))}upgrade(...e){return this.add(ys.Upgrade(...e))}moveCall(...e){return this.add(ys.MoveCall(...e))}transferObjects(...e){return this.add(ys.TransferObjects(...e))}makeMoveVec(...e){return this.add(ys.MakeMoveVec(...e))}serialize(){return JSON.stringify(xt(this,_t).snapshot())}async sign(e){const{signer:n,...i}=e,s=await this.build(i);return n.signTransactionBlock(s)}async build(e={}){return await Un(this,Uc,dh).call(this,e),xt(this,_t).build({maxSizeBytes:Un(this,Ms,co).call(this,"maxTxSizeBytes",e),onlyTransactionKind:e.onlyTransactionKind})}async getDigest(e={}){return await Un(this,Uc,dh).call(this,e),xt(this,_t).getDigest()}};_t=new WeakMap;$c=new WeakSet;lh=function(t,e){const n=xt(this,_t).inputs.length,i=Fn({kind:"Input",value:typeof e=="bigint"?String(e):e,index:n,type:t},ya);return xt(this,_t).inputs.push(i),i};Ms=new WeakSet;co=function(t,{protocolConfig:e,limits:n}){if(n&&typeof n[t]=="number")return n[t];if(!e)return s4[t];const i=e==null?void 0:e.attributes[bd[t]];if(!i)throw new Error(`Missing expected protocol config: "${bd[t]}"`);const s="u64"in i?i.u64:"u32"in i?i.u32:i.f64;if(!s)throw new Error(`Unexpected protocol config value found for: "${bd[t]}"`);return Number(s)};Np=new WeakSet;Sb=function(t){const e=Un(this,Ms,co).call(this,"maxPureArgumentSize",t);xt(this,_t).inputs.forEach((n,i)=>{if(Ut(n.value,ru)&&n.value.Pure.length>e)throw new Error(`Input at index ${i} is too large, max pure input size is ${e} bytes, got ${n.value.Pure.length} bytes`)})};jp=new WeakSet;xb=async function(t){if(xt(this,_t).gasConfig.payment){const s=Un(this,Ms,co).call(this,"maxGasObjects",t);if(xt(this,_t).gasConfig.payment.length>s)throw new Error(`Payment objects exceed maximum amount: ${s}`)}if(t.onlyTransactionKind||xt(this,_t).gasConfig.payment)return;const e=xt(this,_t).gasConfig.owner??xt(this,_t).sender,i=(await wa(t).getCoins({owner:e,coinType:x3})).data.filter(s=>!xt(this,_t).inputs.find(r=>Ut(r.value,oa)&&"Object"in r.value&&"ImmOrOwned"in r.value.Object?s.coinObjectId===r.value.Object.ImmOrOwned.objectId:!1)).slice(0,Un(this,Ms,co).call(this,"maxGasObjects",t)-1).map(s=>({objectId:s.coinObjectId,digest:s.digest,version:s.version}));if(!i.length)throw new Error("No valid gas coins found for the transaction.");this.setGasPayment(i)};Fp=new WeakSet;Pb=async function(t){t.onlyTransactionKind||xt(this,_t).gasConfig.price||this.setGasPrice(await wa(t).getReferenceGasPrice())};zp=new WeakSet;Eb=async function(t){const{inputs:e,transactions:n}=xt(this,_t),i=[],s=[];if(n.forEach(o=>{if(o.kind==="MoveCall"){o.arguments.some(c=>c.kind==="Input"&&!Ut(e[c.index].value,oa))&&i.push(o);return}const r=e4(o);r.schema&&Object.entries(o).forEach(([a,c])=>{if(a==="kind")return;const u=r.schema[a],l=u.type==="array",d=l?u.schema[au]:u[au];if(!d)return;const p=g=>{const b=e[g];if(!b)throw new Error(`Missing input ${c.index}`);if(!Ut(b.value,oa))if(d.kind==="object"&&typeof b.value=="string")s.push({id:b.value,input:b});else if(d.kind==="pure")b.value=Vi.Pure(b.value,d.type);else throw new Error("Unexpected input format.")};if(l)c.forEach(g=>{g.kind==="Input"&&p(g.index)});else{if(c.kind!=="Input")return;p(c.index)}})}),i.length&&await Promise.all(i.map(async o=>{const[r,a,c]=o.target.split("::"),u=await wa(t).getNormalizedMoveFunction({package:pi(r),module:a,function:c}),d=u.parameters.length>0&&D3(u.parameters.at(-1))?u.parameters.slice(0,u.parameters.length-1):u.parameters;if(d.length!==o.arguments.length)throw new Error("Incorrect number of arguments.");d.forEach((p,g)=>{const b=o.arguments[g];if(b.kind!=="Input")return;const w=e[b.index];if(Ut(w.value,oa))return;const T=w.value,E=ch(p,T);if(E){w.value=Vi.Pure(T,E);return}if(cb(p)!=null||typeof p=="object"&&"TypeParameter"in p){if(typeof T!="string")throw new Error(`Expect the argument to be an object id string, got ${JSON.stringify(T,null,2)}`);s.push({id:T,input:w,normalizedType:p});return}throw new Error(`Unknown call arg type ${JSON.stringify(p,null,2)} for value ${JSON.stringify(T,null,2)}`)})})),s.length){const o=[...new Set(s.map(({id:l})=>l))],r=c4(o,a4),a=(await Promise.all(r.map(l=>wa(t).multiGetObjects({ids:l,options:{showOwner:!0}})))).flat();let c=new Map(o.map((l,d)=>[l,a[d]]));const u=Array.from(c).filter(([l,d])=>d.error).map(([l,d])=>l);if(u.length)throw new Error(`The following input objects are invalid: ${u.join(", ")}`);s.forEach(({id:l,input:d,normalizedType:p})=>{var T;const g=c.get(l),b=(T=g.data)==null?void 0:T.owner,w=b&&typeof b=="object"&&"Shared"in b?b.Shared.initial_shared_version:void 0;if(w){const E=Z3(d.value)||p!=null&&ab(p)!=null;d.value=Vi.SharedObjectRef({objectId:l,initialSharedVersion:w,mutable:E})}else d.value=Vi.ObjectRef(PI(g))})}};Uc=new WeakSet;dh=async function(t){if(!t.onlyTransactionKind&&!xt(this,_t).sender)throw new Error("Missing transaction sender");const e=t.client||t.provider;if(!t.protocolConfig&&!t.limits&&e&&(t.protocolConfig=await e.getProtocolConfig()),await Promise.all([Un(this,Fp,Pb).call(this,t),Un(this,zp,Eb).call(this,t)]),!t.onlyTransactionKind&&(await Un(this,jp,xb).call(this,t),!xt(this,_t).gasConfig.budget)){const n=await wa(t).dryRunTransactionBlock({transactionBlock:xt(this,_t).build({maxSizeBytes:Un(this,Ms,co).call(this,"maxTxSizeBytes",t),overrides:{gasConfig:{budget:String(Un(this,Ms,co).call(this,"maxTxGas",t)),payment:[]}}})});if(n.effects.status.status!=="success")throw new Error(`Dry run failed, could not automatically determine a budget: ${n.effects.status.error}`,{cause:n});const i=r4*BigInt(this.blockData.gasConfig.price||1n),s=BigInt(n.effects.gasUsed.computationCost)+i,o=s+BigInt(n.effects.gasUsed.storageCost)-BigInt(n.effects.gasUsed.storageRebate);this.setGasBudget(o>s?o:s)}Un(this,Np,Sb).call(this,t)};let Pe=u4;var vd="router",Ko=1e4,bs=class{static buildPoolImmutables(t){const{fields:e}=t.value.fields.value;return{clmm_pool_id:ae(e.clmm_pool_id).address,booster_type:ae(e.booster_type.fields.name).source_address,pool_id:ae(e.pool_id).address,coinTypeA:ae(e.coin_type_a.fields.name).source_address,coinTypeB:ae(e.coin_type_b.fields.name).source_address}}static buildPoolState(t){const e=je(t),n=[];return e.config.fields.contents.forEach(s=>{n.push({lock_day:Number(s.fields.key),multiplier:Number(U(s.fields.value).div(Ko))})}),{basic_percent:Number(U(e.basic_percent).div(Ko)),balances:{balances_handle:e.balances.fields.id.id,size:e.balances.fields.size},config:n,lock_positions:{lock_positions_handle:e.lock_positions.fields.id.id,size:e.lock_positions.fields.size},is_open:e.is_open,index:Number(e.index),pool_id:Di(t)}}static buildLockNFT(t){const e=ae(Di(t)).address;return{lock_clmm_position:sr(t),locked_nft_id:e}}static buildLockPositionInfo(t){const e=je(t),{value:n}=e.value.fields;return{type:n.type,position_id:n.fields.position_id,start_time:Number(n.fields.start_time),lock_period:Number(n.fields.lock_period),end_time:Number(n.fields.end_time),growth_rewarder:n.fields.growth_rewarder,rewarder_owned:n.fields.rewarder_owned,is_settled:n.fields.is_settled}}static isLocked(t){return t.end_time>Date.parse(new Date().toString())/1e3}},l4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t=!1){var o;const{booster:e}=this._sdk.sdkOptions,n=`${e.package_id}_getPoolImmutables`,i=this.getCache(n,t),s=[];if(i!==void 0)s.push(...i);else{const r=[];(o=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(W(e).booster_pool_handle)).data)==null||o.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=je(u);if(l){const d=bs.buildPoolImmutables(l);this.updateCache(`${d.pool_id}_getPoolImmutable`,d,Ee),s.push(d)}}}return this.updateCache(n,s,Ee),s}async getPoolImmutable(t){const{booster:e}=this._sdk.sdkOptions,n=`${t}_getPoolImmutable`,i=this.getCache(n);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:W(e).booster_pool_handle,name:{type:"0x2::object::ID",value:t}}),o=je(s),r=bs.buildPoolImmutables(o);return this.updateCache(n,r,Ee),r}async getPools(){const t=[],n=(await this.getPoolImmutables()).map(s=>s.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});for(const s of i){const o=bs.buildPoolState(s);if(o){const r={...await this.getPoolImmutable(o.pool_id),...o};t.push(r);const a=`${r.pool_id}_getPoolObject`;this.updateCache(a,r,Ee)}}return t}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e),s=await this.getPoolImmutable(t);if(i!==void 0)return{...s,...i};const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),r=bs.buildPoolState(o),a={...s,...r};return this.updateCache(n,a,Ee),a}async getPoolHandleId(t){const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),n=je(e);return n?n.list.fields.id.id:""}async getBoosterInitConfigs(){var i;const{package_id:t}=this.sdk.sdkOptions.booster,e=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitEvent`}))==null?void 0:i.data,n={booster_config_id:"",booster_pool_handle:""};return e.length>0&&e.forEach(s=>{const o=s.parsedJson;o&&(n.booster_config_id=o.config_id)}),n.booster_pool_handle=await this.getPoolHandleId(n.booster_config_id),n}async getOwnerBoosterPositions(t,e,n){const{booster:i}=this.sdk.sdkOptions,s=[],o=[],r=`${i.package_id}::lock_nft::LockNFT<${this._sdk.ClmmSDK.Position.buildPositionType()}>`,a=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showOwner:!0},filter:{StructType:r}});for(const u of a.data)if(ae(Si(u)).source_address===r&&u.data){const d=bs.buildLockNFT(u);this.updateCache(`${d.locked_nft_id}_getBoosterPositionById`,d,Ee),d&&(e===void 0||e===d.lock_clmm_position.pool)&&s.push(d)}const c=await this.getLockPositionInfos(n,s.map(u=>u.locked_nft_id));for(const u of s)for(const l of c)if(u.lock_clmm_position.pos_object_id===l.position_id){o.push({...u,...l});break}return o}async getBoosterPosition(t,e){const n=`${e}_getBoosterPositionById`,i=this.getCache(n);let s;if(i!==void 0)s=i;else{const r=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0,showOwner:!0}});s=bs.buildLockNFT(r),this.updateCache(n,s,Ee)}const o=await this.getLockPositionInfo(t,e);return{...s,...o}}async getLockPositionInfos(t,e=[]){var o;const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(t),i=[],s=[];return(o=n.data)==null||o.forEach(r=>{e.length>0?e.includes(r.name.value)&&i.push(r.objectId):i.push(r.objectId)}),i.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showContent:!0})).forEach(a=>{const c=bs.buildLockPositionInfo(a);c&&s.push(c)}),s}async getLockPositionInfo(t,e){const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}});return bs.buildLockPositionInfo(n)}calculateXCetusRewarder(t,e,n){let i=e.basic_percent,s="0";t.forEach(a=>{a.coin_address===e.booster_type&&(console.log("find ",e.booster_type),s=a.amount_owed.toString())}),n.is_settled||e.config.forEach(a=>{a.lock_day===n.lock_period&&(i=a.multiplier)});const o=U(s).sub(n.growth_rewarder).mul(i);return U(n.rewarder_owned).add(o).toString()}lockPositionPayload(t){const{booster:e}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new Pe;return i.moveCall({target:`${e.published_at}::${vd}::lock_position`,typeArguments:[t.booster_type,t.coinTypeA,t.coinTypeB],arguments:[i.pure(W(e).booster_config_id),i.pure(W(n).global_config_id),i.pure(t.booster_pool_id),i.pure(t.clmm_pool_id),i.pure(t.clmm_position_id),i.pure(t.lock_day),i.pure(fe)]}),i}canceLockPositionPayload(t){const{booster:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${vd}::cancel_lock`,typeArguments:[t.booster_type],arguments:[n.pure(W(e).booster_config_id),n.pure(t.booster_pool_id),n.pure(t.lock_nft_id),n.pure(fe)]}),n}redeemPayload(t){const{booster:e,xcetus:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,s=new Pe,o=W(n);return s.moveCall({target:`${e.published_at}::${vd}::redeem`,typeArguments:[t.booster_type,t.coinTypeA,t.coinTypeB],arguments:[s.pure(W(e).booster_config_id),s.pure(W(i).global_config_id),s.pure(t.booster_pool_id),s.pure(t.lock_nft_id),s.pure(t.clmm_pool_id),s.pure(o.lock_manager_id),s.pure(o.xcetus_manager_id),s.pure(t.ve_nft_id),s.pure(fe)]}),s}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},In="router",Cb=1e9,An=class{static priceRealToFix(t,e,n){const i=U(e-n).toNumber();return Number(U(t).div(U(10).pow(U(i))).toString())}static priceFixToReal(t,e,n){const i=U(e-n).toNumber();return Number(U(t).mul(U(10).pow(U(i))).toString())}static raiseTotalAmount(t,e,n){const i=U(e-n).abs().toNumber();return e>n?Number(U(t.total_supply).mul(t.current_price).div(U(10).pow(U(i))).toString()):Number(U(t.total_supply).mul(t.current_price).mul(U(10).pow(U(i))).toString())}static buildLaunchPadPool(t){const e=Si(t),n=ae(e),i=je(t),s={coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],pool_address:pi(Di(t)),is_settle:i.is_settle,current_price:U(i.initialize_price).div(U(Cb)).toString(),price:i.initialize_price,min_price:"0",max_price:"0",sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,total_purchase_amount:i.reality_raise_total,total_supply:i.sale_total,min_purchase:i.min_purchase,max_purchase:i.max_purchase,complete_raise_limit:i.least_raise_amount,softcap:i.softcap,max_raise_amount:i.hardcap,sale_decimals:0,raise_decimals:0,liquidity_injection_ratio:Number(i.liquidity_rate)/1e4,is_cancel:i.is_cancel,duration_summary:{start_time:Number(i.duration_manager.fields.start_time),end_time:0,settle_end_time:0,purchase_duration:Number(i.duration_manager.fields.activity_duration),settle_duration:Number(i.duration_manager.fields.settle_duration),lock_up_duration:Number(i.duration_manager.fields.locked_duration)},white_summary:{white_handle:i.white_list.fields.users.fields.id.id,protection_hard_cap:i.white_list.fields.hard_cap_total,protection_limit_used:i.white_list.fields.purchase_total,size:Number(i.white_list.fields.users.fields.size)},unused_sale:i.unused_sale,harvest_raise:i.harvest_raise,tick_spacing:Number(i.tick_spacing),owner:i.recipient,purchase_summary:{purchase_handle:i.purchase_list.fields.id.id,size:Number(i.purchase_list.fields.size)},pool_status:"Failed"};return An.updatePoolStatus(s),s}static updatePoolStatus(t){const e=Number(U(Date.now()/1e3).toFixed(0)),{duration_summary:n}=t,i=n.start_time+n.purchase_duration,s=i+n.settle_duration;if(n.end_time=i,n.settle_end_time=s,t.is_settle)t.pool_status="Ended";else if(t.is_cancel)t.pool_status="Canceled";else if(e<n.start_time)t.pool_status="Upcoming";else if(e>n.start_time&&e<i)t.pool_status="Live";else if(e>i&&e<s){const o=t.raise_coin_amount;Number(o)<Number(t.complete_raise_limit)?t.pool_status="Failed":t.pool_status="Settle"}return t}static async calculatePoolPrice(t,e){const n=await t.ClmmSDK.CetusConfig.getTokenListByCoinTypes([e.coin_type_sale,e.coin_type_raise]),i=n[e.coin_type_sale].decimals,s=n[e.coin_type_raise].decimals;e.min_price=this.priceFixToReal(Number(U(e.softcap).div(U(e.total_supply))),i,s).toString(),e.max_price=this.priceFixToReal(Number(U(e.max_raise_amount).div(U(e.total_supply))),i,s).toString(),e.current_price=this.priceFixToReal(Number(e.current_price),i,s).toString(),e.sale_decimals=i,e.raise_decimals=s}static async getWithdrawRaise(t){return t.pool_status==="Ended"?t.harvest_raise:"0"}static async getWithdrawSale(t){return t.pool_status==="Ended"?t.unused_sale:t.sale_coin_amount}static async getHistoryWithdrawRaise(t,e){if(e.pool_status==="Ended"){if(U(e.harvest_raise).equals(U(0))){const i=await t.Launchpad.getSettleEvent(e.pool_address);i&&(e.harvest_raise=i.unused_raise)}const n=y.min(new y(e.total_purchase_amount),new y(e.max_raise_amount));return U(n.toString()).mul(1-e.liquidity_injection_ratio).toString()}return"0"}static async getHistoryWithdrawSale(t,e){if(e.pool_status==="Ended"){const n=await t.Launchpad.getSettleEvent(e.pool_address);return n&&(e.unused_sale=n.unused_sale),e.unused_sale}return"0"}static async getOverrecruitReverseAmount(t,e){const n=await t.Launchpad.getPurchaseMarks(t.ClmmSDK.senderAddress,[e.pool_address],!1);if(n.length>0){const i=n[0].purchased_raise_amount,s=(await t.Launchpad.getPurchaseAmount(e.white_summary.white_handle,t.ClmmSDK.senderAddress)).safe_purchased_amount,{protection_limit_used:o}=e.white_summary;return U(i).sub(s).div(U(e.total_purchase_amount).sub(o)).mul(U(e.total_purchase_amount).sub(e.max_raise_amount)).toString()}return"0"}static async getCanPurchaseAmount(t,e){const n=await An.getOverrecruitReverseAmount(t,e),i=await t.Launchpad.getPurchaseMarks(t.ClmmSDK.senderAddress,[e.pool_address],!1);if(i){const s=i[0].purchased_raise_amount;U(s).sub(n).div(e.current_price)}return"0"}},d4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t=[],e=0,n=100,i=!1){var l;const{package_id:s}=this._sdk.sdkOptions.launchpad;if(s===void 0)throw Error("sdk.sdkOptions.launchpad is undefined");const o=`${s}_getPoolImmutables`,r=this.getCache(o,i),a=[],c=[];if(r!==void 0&&a.push(...r),a.length===0)try{((l=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${s}::factory::CreatePoolEvent`}))==null?void 0:l.data).forEach(p=>{const g=p.parsedJson;g&&a.push({pool_address:g.pool_id,coin_type_sale:ae(g.sale_coin.name).full_address,coin_type_raise:ae(g.raise_coin.name).full_address})}),this.updateCache(o,a,Ee)}catch(d){console.log("getPoolImmutables",d)}const u=t.length>0;for(let d=0;d<a.length;d+=1){const p=a[d];if(!(u&&!t.includes(p.pool_address))){if(!u){const g=d;if(g<e||g>=e+n)continue}c.push(p)}}return c}async getPoolImmutablesWithPage(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.launchpad,i=`${n}_getPoolImmutables`,s=[],o={data:[],hasNextPage:!1},r=t==="all";if(r){const a=this.getCache(i,e);a&&s.push(...a)}if(s.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::factory::CreatePoolEvent`},t);o.hasNextPage=a.hasNextPage,o.nextCursor=a.nextCursor,a.data.forEach(c=>{const u=c.parsedJson;u&&s.push({pool_address:u.pool_id,coin_type_sale:ae(u.sale_coin.name).full_address,coin_type_raise:ae(u.raise_coin.name).full_address})})}catch(a){console.log("getPoolImmutables",a)}return o.data=s,r&&this.updateCache(i,s,Ee),o}async getPools(t=[],e=0,n=100){const i=[];let s=[];t.length>0?s=[...t]:(await this.getPoolImmutables([],e,n,!1)).forEach(a=>{s.push(a.pool_address)});const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(s,{showType:!0,showContent:!0});for(const r of o){const a=An.buildLaunchPadPool(r);await An.calculatePoolPrice(this._sdk,a),i.push(a);const c=`${a.pool_address}_getPoolObject`;this.updateCache(c,a,Ee)}return i}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e);if(i!==void 0){const r=i;return An.updatePoolStatus(r),r}const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),o=An.buildLaunchPadPool(s);return await An.calculatePoolPrice(this._sdk,o),this.updateCache(n,o),o}async getInitConfig(t=!1){var c;const e=this._sdk.sdkOptions.launchpad.package_id,n=`${e}_getInitEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=Fa(s),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:o}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",config_cap_id:""};return r.length>0&&(r.forEach(u=>{const l=u.parsedJson;if(l)switch(ae(u.type).full_address){case`${e}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.config_cap_id=l.config_cap_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,Ee)),a}async getLockNFT(t,e=!1){const n=`${t}_getLockNFT`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!s.error)return sr(s)}async getLockNFTList(t){var s;const{package_id:e}=this._sdk.ClmmSDK.sdkOptions.clmm_pool,{sdkOptions:n}=this._sdk,i=[];try{const o=(s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n.launchpad.package_id}::lock::LockNFTEvent`}))==null?void 0:s.data;for(const r of o){const a=r.parsedJson;if(a){const c={locked_time:Number(a.locked_time),end_lock_time:Number(a.end_lock_time),nft_type:a.nft_type_name.name,lock_nft_id:a.lock_nft_id,recipient:a.recipient};if(t===c.recipient&&`${e}`===ae(c.nft_type).address){const u=await this.getLockNFT(c.lock_nft_id);if(u){const l=ae(u.coin_type_a).full_address,d=ae(u.coin_type_b).full_address;i.push({...u,coin_type_a:l,coin_type_b:d,...c})}}}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPoolTransactionPayload(t){const{launchpad:e}=this.sdk.sdkOptions,n=W(e);if(this.assertLuanchpadConfig(),this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const i=An.priceRealToFix(Number(t.initialize_price),t.sale_decimals,t.raise_decimals),s=new Pe,o=U(t.total_supply).add(U(t.total_supply).mul(U(t.liquidity_rate))).toNumber(),r=await tt.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,s,BigInt(o),t.coin_type_sale),a=[s.pure(n.admin_cap_id),s.pure(n.config_cap_id),s.pure(n.pools_id),s.pure(tn(t.recipient)),s.pure((i*Cb).toString()),r,s.pure(t.total_supply.toString()),s.pure(t.min_purchase.toString()),s.pure(t.max_purchase.toString()),s.pure(t.least_raise_amount.toString()),s.pure(t.hardcap.toString()),s.pure((t.liquidity_rate*1e3).toString()),s.pure(t.start_time.toString()),s.pure(t.activity_duration.toString()),s.pure(t.settle_duration.toString()),s.pure(t.locked_duration.toString()),s.pure(t.tick_spacing.toString()),s.pure(fe)],c=[t.coin_type_sale,t.coin_type_raise];return s.moveCall({target:`${e.published_at}::${In}::create_launch_pool`,typeArguments:c,arguments:a}),s}async creatPurchasePayload(t){const{launchpad:e}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=new Pe,i=await tt.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(t.purchase_amount),t.coin_type_raise),s=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[t.pool_address],!1))[0],o=[t.coin_type_sale,t.coin_type_raise];let r;return s?r=[n.pure(t.pool_address),n.pure(W(e).config_cap_id),n.pure(s.id),i,n.pure(t.purchase_amount.toString()),n.pure(fe)]:r=[n.pure(t.pool_address),n.pure(W(e).config_cap_id),i,n.pure(t.purchase_amount.toString()),n.pure(fe)],n.moveCall({target:`${e.published_at}::${In}::${s===void 0?"create_and_purchase":"purchase"}`,typeArguments:o,arguments:r}),n}async creatClaimPayload(t){const{launchpad:e}=this.sdk.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");const n=(await this.getPurchaseMarks(this._sdk.ClmmSDK.senderAddress,[t.pool_address],!1))[0],i=new Pe,s=[t.coin_type_sale,t.coin_type_raise],o=[i.pure(t.pool_address),i.pure(W(e).config_cap_id),i.pure(n==null?void 0:n.id),i.pure(fe)];return i.moveCall({target:`${e.published_at}::${In}::claim`,typeArguments:s,arguments:o}),i}async creatSettlePayload(t){const{launchpad:e}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions;if(this._sdk.ClmmSDK.senderAddress.length===0)throw Error("this config sdk senderAddress is empty");this.assertLuanchpadConfig();const i=W(n),{clmm_args:s}=t,o=new Pe;o.setSender(this.sdk.ClmmSDK.senderAddress);const r=[t.coin_type_sale,t.coin_type_raise];if(s){const a=s.opposite?Se.priceToSqrtPriceX64(U(1).div(s.current_price),s.raise_decimals,s.sale_decimals).toString():Se.priceToSqrtPriceX64(U(s.current_price),s.sale_decimals,s.raise_decimals).toString(),c=BigInt(a)<BigInt(s.clmm_sqrt_price),u=s.opposite?c?t.coin_type_raise:t.coin_type_sale:c?t.coin_type_sale:t.coin_type_raise,l=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,u);let d=Tt.calculateTotalBalance(l);Tt.isSuiCoin(u)&&(d-=BigInt(2e8));const g=tt.buildCoinForAmount(o,l,d,u).targetCoin,b=s.opposite?c?"settle_with_reverse_clmm_only_with_a":"settle_with_reverse_clmm_only_with_b":c?"settle_only_with_a":"settle_only_with_b",w=[o.pure(t.pool_address),o.pure(W(e).config_cap_id),o.pure(s.clmm_pool_address),o.pure(i.global_config_id),o.pure(a),g,o.pure(fe)];o.moveCall({target:`${e.published_at}::${In}::${b}`,typeArguments:r,arguments:w})}else o.moveCall({target:`${e.published_at}::${In}::settle`,typeArguments:r,arguments:[o.pure(t.pool_address),o.pure(W(e).config_cap_id),o.pure(fe)]});return o}creatWithdrawPayload(t){const{launchpad:e}=this.sdk.sdkOptions,n=new Pe,i=[t.coin_type_sale,t.coin_type_raise],s=[n.object(t.pool_address),n.object(W(e).config_cap_id),n.object(fe)];return t.sale_amount>BigInt(0)&&n.moveCall({target:`${e.published_at}::${In}::withdraw_sale`,typeArguments:i,arguments:s}),t.raise_amount>BigInt(0)&&n.moveCall({target:`${e.published_at}::${In}::withdraw_raise`,typeArguments:i,arguments:s}),n}addUserToWhitelisPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new Pe,i=[t.coin_type_sale,t.coin_type_raise];return t.user_addrs.forEach(s=>{const o=[n.object(W(e).admin_cap_id),n.object(W(e).config_cap_id),n.object(t.pool_address),n.object(s),n.pure(t.safe_limit_amount),n.object(fe)];n.moveCall({target:`${e.published_at}::${In}::add_user_to_whitelist`,typeArguments:i,arguments:o})}),n}updateWhitelistCapPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new Pe,i=[t.coin_type_sale,t.coin_type_raise];return t.safe_limit_amount>0&&n.moveCall({target:`${e.published_at}::${In}::update_whitelist_member_safe_limit_amount`,typeArguments:i,arguments:[n.object(W(e).admin_cap_id),n.object(W(e).config_cap_id),n.object(t.pool_address),n.pure(t.white_list_member),n.pure(t.safe_limit_amount),n.object(fe)]}),t.hard_cap_total>0&&n.moveCall({target:`${e.published_at}::${In}::update_whitelist_hard_cap_total`,typeArguments:i,arguments:[n.object(W(e).admin_cap_id),n.object(W(e).config_cap_id),n.object(t.pool_address),n.pure(t.hard_cap_total),n.object(fe)]}),n}creatRemoveWhitelistPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new Pe,i=[t.coin_type_sale,t.coin_type_raise];return t.user_addrs.forEach(s=>{const o=[n.object(W(e).admin_cap_id),n.object(W(e).config_cap_id),n.object(t.pool_address),n.object(s),n.object(fe)];n.moveCall({target:`${e.published_at}::${In}::remove_user_from_whitelist`,typeArguments:i,arguments:o})}),n}creatCancelPoolPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new Pe,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(W(e).admin_cap_id),n.pure(W(e).config_cap_id),n.pure(t.pool_address),n.pure(fe)];return n.moveCall({target:`${e.published_at}::${In}::cancel`,typeArguments:i,arguments:s}),n}updateRecipientPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new Pe,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(W(e).admin_cap_id),n.pure(W(e).config_cap_id),n.pure(t.pool_address),n.pure(t.new_recipient),n.pure(fe)];return n.moveCall({target:`${e.published_at}::${In}::update_recipient_address`,typeArguments:i,arguments:s}),n}updatePoolDuractionPayload(t){const{launchpad:e}=this.sdk.sdkOptions;this.assertLuanchpadConfig();const n=new Pe,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(W(e).admin_cap_id),n.pure(W(e).config_cap_id),n.pure(t.pool_address),n.pure(t.activity_duration),n.pure(t.settle_duration),n.pure(t.lock_duration),n.pure(fe)];return n.moveCall({target:`${e.published_at}::${In}::update_pool_duration`,typeArguments:i,arguments:s}),n}creatUnlockNftPayload(t){const{launchpad:e}=this.sdk.sdkOptions;if(W(e)===void 0)throw Error("getPackagerConfigs(launchpad)  is null");const n=new Pe,i=[t.nft_type],s=[n.pure(t.lock_nft),n.pure(fe)];return n.moveCall({target:`${e.published_at}::lock::unlock_nft`,typeArguments:i,arguments:s}),n}async isAdminCap(t){const{launchpad:e}=this._sdk.sdkOptions;if(W(e)===void 0)throw Error("launchpad config is empty");const n=`${t}_isAdminCap`,i=this.getCache(n);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:W(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(s);const o=ro(s),r=ou(s);let a=!1;return r&&o&&ae(o).source_address===`${e.package_id}::config::AdminCap`&&(a=tn(r.AddressOwner)===tn(t)),this.updateCache(n,a,Ee),a}async isWhiteListUser(t,e){const n={type:"address",value:e};try{const i=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:n});return!!(i&&i.data)}catch{return!1}}async getPurchaseAmount(t,e){var i;const n={type:"address",value:e};try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:n}),o=je(s);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getPurchaseMarks(t,e=[],n=!0){const{launchpad:i}=this._sdk.sdkOptions,s=`${e}_getPurchaseMark`,o=this.getCache(s,n);if(!n&&o!==void 0)return o;let r=null;const a=[];for(;;){const c=await this._sdk.ClmmSDK.fullClient.getOwnedObjects({owner:t,options:{showType:!0,showContent:!0,showDisplay:!0},cursor:r});for(const u of c.data){const{fields:l}=u.data.content;if(ae(Si(u)).source_address===`${i.package_id}::pool::PurchaseMark`){console.log("fields: ",l);const p={id:l.id.id,pool_id:ae(l.pool_id).address,purchased_raise_amount:l.purchase_total,obtain_sale_amount:l.obtain_sale_amount,used_raise_amount:l.used_raise_amount};e.length>0?e.includes(p.pool_id)&&a.push(p):a.push(p)}}if(c.hasNextPage)r=c.nextCursor;else break}return this.updateCache(s,a,Ee),a}async getSettleEvent(t){const{launchpad:e}=this._sdk.sdkOptions,n=`${t}_getPurchaseMark`,i=this.getCache(n);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e.package_id}::pool::SettleEvent`});for(const o of s.data){const r=o.parsedJson;if(t===pi(r.pool_id)){const a={pool_id:r.pool_id,settle_price:r.settle_price,unused_sale:r.unused_sale,unused_raise:r.unused_raise,white_purchase_total:r.white_purchase_total};return this.updateCache(n,a,Ee),a}}}buildLaunchpadCoinType(t,e){return su(this._sdk.sdkOptions.launchpad.package_id,"pool","PoolLiquidityCoin",[t,e])}assertLuanchpadConfig(){const{launchpad:t}=this.sdk.sdkOptions;if(W(t)===void 0)throw Error("sdk getPackagerConfigs(launchpad) is null")}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},vs=class{static buildPoolImmutables(t){const{fields:e}=t.value.fields.value;return{clmm_pool_id:ae(e.clmm_pool_id).address,bonus_type:ae(e.bonus_type.fields.name).source_address,pool_id:ae(e.pool_id).address,coinTypeA:ae(e.coin_type_a.fields.name).source_address,coinTypeB:ae(e.coin_type_b.fields.name).source_address}}static buildPoolState(t){const e=je(t),n=[];return e.config.fields.contents.forEach(s=>{n.push({rate:Number(U(s.fields.key).div(Ko)),multiplier:Number(U(s.fields.value).div(Ko))})}),{balance:e.balance,config:n,is_open:e.is_open,index:Number(e.index),start_time:Number(e.start_time),interval_day:Number(e.interval_day),minimum_percent_to_reward:Number(U(e.minimum_percent_to_reward).div(Ko)),rewarders:{rewarder_handle:e.rewarders.fields.id.id,size:Number(e.rewarders.fields.size)},whale_nfts:{whale_nfts_handle:e.whale_nfts.fields.id.id,size:Number(e.whale_nfts.fields.size)},points:{point_handle:e.points.fields.id.id,size:Number(e.points.fields.size)}}}static buildMarkerPositions(t){const{contents:e}=t.value.fields.value.fields,n=[],i=t.id.id;return e.forEach(s=>{const{key:o,value:r}=s.fields,a={id:o,period_id:i,bonus_num:r.fields.bonus_num,point:r.fields.point,is_burn:r.fields.is_burn,point_after_multiplier:r.fields.point_after_multiplier,percent:Number(U(r.fields.percent).div(Ko)),fee_share_rate:0,is_redeemed:r.fields.is_redeemed};n.push(a)}),n}static buildPoolBonusInfo(t){const{fields:e,type:n}=t.value.fields.value;return{type:n,time:Number(e.time),settle_time:Number(e.settle_time),settled_num:e.settled_num,is_settled:e.is_settled,basis_bonus:e.basis_bonus,total_bonus:e.total_bonus,is_vacant:e.is_vacant,redeemed_num:e.redeemed_num}}static getBonusPercent(t,e){let n=0;for(const i of t)e>=i.rate&&i.rate>n&&(n=i.multiplier);return n}},R0="router",h4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t=!1){var o;const{maker_bonus:e}=this._sdk.sdkOptions,n=`${e.package_id}_getPoolImmutables`,i=this.getCache(n,t),s=[];if(i!==void 0)s.push(...i);else{const r=[];(o=(await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(W(e).maker_pool_handle)).data)==null||o.forEach(u=>{r.push(u.objectId)});const c=await this._sdk.ClmmSDK.fullClient.batchGetObjects(r,{showContent:!0});for(const u of c){const l=je(u);l&&s.push(vs.buildPoolImmutables(l))}}return s}async getPoolImmutable(t){const{maker_bonus:e}=this._sdk.sdkOptions,n=`${e.package_id}_getPoolImmutables`,i=this.getCache(n);if(i!==void 0){const r=i.filter(a=>t===a.pool_id);if(r.length>0)return r[0]}const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:W(e).maker_pool_handle,name:{type:"0x2::object::ID",value:t}}),o=je(s);return vs.buildPoolImmutables(o)}async getPools(){const t=[],e=await this.getPoolImmutables(),n=e.map(o=>o.pool_id),i=await this._sdk.ClmmSDK.fullClient.batchGetObjects(n,{showType:!0,showContent:!0});let s=0;for(const o of i){const r=vs.buildPoolState(o);if(r){const a={...e[s],...r};t.push(a);const c=`${a.pool_id}_getPoolObject`;this.updateCache(c,a,Ee)}s+=1}return t}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e),s=await this.getPoolImmutable(t);if(i!==void 0)return i;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),r=vs.buildPoolState(o),a={...s,...r};return this.updateCache(n,a,Ee),a}async getPoolHandleId(t){const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),n=je(e);return n?n.list.fields.id.id:""}async getMakerPoolPeriods(t,e=!1){const n=[],i=`${t.pool_id}_getMakerPoolPeriods`,s=this.getCache(i,e);return s!==void 0?s:((await this._sdk.ClmmSDK.fullClient.getDynamicFieldsByPage(t.whale_nfts.whale_nfts_handle)).data.forEach(r=>{const a={id:r.objectId,start_time:0,end_time:0,period:Number(r.name.value)};a.start_time=Number(U(t.start_time).add(U(t.interval_day).mul(24*3600).mul(a.period)).toFixed(0,ie.ROUND_DOWN)),a.end_time=Number(U(a.start_time).add(U(t.interval_day).mul(24*3600)).toFixed(0,ie.ROUND_DOWN)),n.push(a)}),this.updateCache(i,n,Ee),n)}async getMakerBonusInitConfigs(){var i;const{package_id:t}=this.sdk.sdkOptions.maker_bonus,e=(i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitEvent`}))==null?void 0:i.data,n={maker_config_id:"",maker_pool_handle:""};return e.length>0&&e.forEach(s=>{const o=s.parsedJson;o&&(n.maker_config_id=o.config_id)}),n.maker_pool_handle=await this.getPoolHandleId(n.maker_config_id),n}async getPoolMarkerPositionList(t,e,n=!1){const i={},s=[];n||e.forEach(o=>{const r=`${t}_${o.period}_getPoolMarkerPositionList`,a=this.getCache(r);a!==void 0?i[o.period]=a:(i[o.period]=[],s.push(o))});try{s.length>0&&(await this._sdk.ClmmSDK.fullClient.batchGetObjects(s.map(a=>a.id),{showContent:!0})).forEach(a=>{const c=je(a),u=vs.buildMarkerPositions(c);if(u.length>0){const{period_id:l}=u[0],d=e.filter(p=>p.id===l)[0];i[d.period]=u}});const o=[];for(const r in i)i[r].forEach(c=>{o.push(c)});if(o.length>0){const r=await this._sdk.ClmmSDK.Position.getSipmlePositionList(o.map(a=>a.id));for(const a of o)for(const c of r)if(a.id===c.pos_object_id){a.clmm_position=c;break}}}catch(o){console.log(o)}for(const o in i){const r=`${t}_${o}_getPoolMarkerPositionList`;this.updateCache(r,i[o],Ee)}return i}async updateXCetusRewarderAndFee(t,e,n){const i=await this.calculateTotalPointsAfterMultiper(t,n);for(const s of e)await this.calculateXCetusRewarder(t,s,n.period,i);return e}async calculateXCetusRewarder(t,e,n,i){const s=await this.getPoolBonusInfo(t.rewarders.rewarder_handle,n),{fee_share_rate:o}=this.calculateFeeShareRate(t,e,i),r=U(o).mul(s.total_bonus);return e.is_redeemed?e.bonus_num="0":e.bonus_num=r.toString(),e.bonus_num}calculateFeeShareRate(t,e,n){const i=vs.getBonusPercent(t.config,e.percent),s=U(e.point).mul(i),o=U(s).div(n);return e.point_after_multiplier=s.toString(),e.fee_share_rate=Number(o),{fee_share_rate:Number(o),points_after_multiper:s.toString()}}async calculateTotalPointsAfterMultiper(t,e){const n=await this.getPoolMarkerPositionList(t.whale_nfts.whale_nfts_handle,[e]);let i=U(0);const s=n[e.period];for(const o of s){const r=vs.getBonusPercent(t.config,o.percent),a=U(o.point).mul(r);i=i.add(a)}return i.toString()}async calculateAllXCetusRewarder(t){const e=this._sdk.ClmmSDK.senderAddress;let n=U(0);const i=[];for(const s of t){const o=await this._sdk.MakerModule.getMakerPoolPeriods(s),r=await this._sdk.MakerModule.getPoolMarkerPositionList(s.whale_nfts.whale_nfts_handle,o),a=[];for(const c of o){const u=r[c.period].filter(l=>{var d;return e.length===0?!1:((d=l.clmm_position)==null?void 0:d.owner)===e});u.length>0&&(await this._sdk.MakerModule.updateXCetusRewarderAndFee(s,u,c),u.forEach(l=>{var d;((d=l.clmm_position)==null?void 0:d.position_status)===Nw.Exists&&U(l.bonus_num).greaterThan(0)&&(n=n.add(l.bonus_num),a.includes(l.clmm_position.pos_object_id)||a.push(l.clmm_position.pos_object_id))}))}i.push({bonus_type:s.bonus_type,pool_id:s.pool_id,nft_ids:a})}return{claimtotal:n,claimRecord:i}}async getPoolBonusInfo(t,e,n=!1){const i=`${t}_${e}_getPoolBonusInfo`,s=this.getCache(i,n);if(s!==void 0)return s;const o=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"u64",value:e.toString()}}),r=je(o),a=vs.buildPoolBonusInfo(r);return this.updateCache(i,a,Vn),a}claimPayload(t){const{maker_bonus:e,xcetus:n}=this.sdk.sdkOptions,i=new Pe;return i.moveCall({target:`${e.published_at}::${R0}::claim`,typeArguments:[t.bonus_type],arguments:[i.pure(W(e).maker_config_id),i.pure(t.market_pool_id),i.pure(t.position_nft_id),i.pure(t.phase),i.pure(W(n).lock_manager_id),i.pure(W(n).xcetus_manager_id),i.pure(t.ve_nft_id)]}),i}claimAllPayload(t){const{maker_bonus:e,xcetus:n}=this.sdk.sdkOptions,i=new Pe;return t.whale_nfts.forEach(s=>{s.nft_ids.forEach(o=>{i.moveCall({target:`${e.published_at}::${R0}::claim_all`,typeArguments:[s.bonus_type],arguments:[i.object(W(e).maker_config_id),i.object(s.pool_id),i.object(o),i.object(W(n).lock_manager_id),i.object(W(n).xcetus_manager_id),i.object(t.ve_nft_id)]})})}),i}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},Ro="router",Td="router",ra=24*3600,cu=1e3,ri=1e11,js=class{static buildVeNFTDividendInfo(t){const e={id:t.id.id,ve_nft_id:t.name,rewards:[]};return t.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(s=>{i.push({coin_type:ae(s.fields.key.fields.name).source_address,amount:s.fields.value})}),e.rewards.push({period:Number(n.fields.key),rewards:i})}),e}static buildDividendManager(t){const e={id:t.id.id,dividends:{id:t.dividends.fields.id.id,size:t.dividends.fields.size},venft_dividends:{id:t.venft_dividends.fields.id.id,size:t.venft_dividends.fields.size},bonus_types:[],start_time:Number(t.start_time),interval_day:Number(t.interval_day),balances:{id:t.balances.fields.id.id,size:t.balances.fields.size},is_open:t.is_open};return t.bonus_types.forEach(n=>{e.bonus_types.push(ae(n.fields.name).source_address)}),e}static buildLockUpManager(t){return{id:t.id.id,balance:t.balance,treasury_manager:t.treasury_manager,extra_treasury:t.extra_treasury,lock_infos:{lock_handle_id:t.lock_infos.fields.id.id,size:Number(t.lock_infos.fields.size)},type_name:Mn(t.type_name.fields.name),min_lock_day:Number(t.min_lock_day),max_lock_day:Number(t.max_lock_day),package_version:Number(t.package_version),max_percent_numerator:Number(t.max_percent_numerator),min_percent_numerator:Number(t.min_percent_numerator)}}static buildLockCetus(t){const e=t.fields,n={id:e.id.id,type:ae(t.type).source_address,locked_start_time:Number(e.locked_start_time),locked_until_time:Number(e.locked_until_time),cetus_amount:e.balance,xcetus_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/ra,n}static getAvailableXCetus(t,e){let n=U(0);return e.forEach(i=>{n=n.add(i.xcetus_amount)}),U(t.xcetus_balance).sub(n).toString()}static getWaitUnLockCetuss(t){return t.filter(e=>!js.isLocked(e))}static getLockingCetuss(t){return t.filter(e=>js.isLocked(e))}static isLocked(t){return t.locked_until_time>Date.parse(new Date().toString())/1e3}static buildDividendRewardTypeList(t){const e=new Set;return t.forEach(n=>{n.rewards.forEach(i=>{e.add(i.coin_type)})}),Array.from(e)}static getNextStartTime(t){const e=Date.now()/1e3,{start_time:n,interval_day:i}=t,s=Math.ceil((e-n)/(i*ra));return n+s*i*ra}},p4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getOwnerVeNFT(t,e=!0){const{xcetus:n}=this.sdk.sdkOptions,i=`${t}_getLockUpManagerEvent`,s=this.getCache(i,e);if(s!==void 0)return s;let o;const r=`${n.package_id}::xcetus::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=ae(Si(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;o={...vl(c),id:l.id.id,index:l.index,type:u,xcetus_balance:l.xcetus_balance},this.updateCache(i,o,Ee)}}),o}async getOwnerLockCetuss(t){const{xcetus:e}=this.sdk.sdkOptions,n=[],i=`${e.package_id}::lock_coin::LockedCoin<${this.buileCetusCoinType()}>`,s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of s.data)if(ae(Si(o)).source_address===i&&o.data){const a=js.buildLockCetus(o.data.content);a.xcetus_amount=await this.getXCetusAmount(a.id),n.push(a)}return n}async getLockCetus(t){var n;const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}});if((n=e.data)!=null&&n.content){const i=js.buildLockCetus(e.data.content);return i.xcetus_amount=await this.getXCetusAmount(i.id),i}}async getOwnerCetusCoins(t){return await this._sdk.ClmmSDK.getOwnerCoinAssets(t,this.buileCetusCoinType())}mintVeNFTPayload(){const{xcetus:t}=this.sdk.sdkOptions,e=new Pe;return e.moveCall({target:`${t.published_at}::${Ro}::mint_venft`,typeArguments:[],arguments:[e.pure(W(t).xcetus_manager_id)]}),e}async convertPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new Pe,i=this.buileCetusCoinType(),s=await tt.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(t.amount),i);return t.venft_id===void 0?n.moveCall({target:`${e.published_at}::${Ro}::mint_and_convert`,typeArguments:[],arguments:[n.object(W(e).lock_manager_id),n.object(W(e).xcetus_manager_id),s,n.pure(t.amount)]}):n.moveCall({target:`${e.published_at}::${Ro}::convert`,typeArguments:[],arguments:[n.object(W(e).lock_manager_id),n.object(W(e).xcetus_manager_id),s,n.pure(t.amount),n.pure(t.venft_id)]}),n}redeemLockPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${Ro}::redeem_lock`,typeArguments:[],arguments:[n.pure(W(e).lock_manager_id),n.pure(W(e).xcetus_manager_id),n.pure(t.venft_id),n.pure(t.amount),n.pure(t.lock_day),n.pure(fe)]}),n}redeemPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${Ro}::redeem`,typeArguments:[],arguments:[n.pure(W(e).lock_manager_id),n.pure(W(e).xcetus_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(fe)]}),n}redeemDividendPayload(t,e){const{xcetus:n,xcetus_dividends:i}=this.sdk.sdkOptions,s=new Pe;return e.forEach(o=>{s.moveCall({target:`${n.published_at}::${Td}::redeem`,typeArguments:[o],arguments:[s.object(W(i).dividend_manager_id),s.object(t)]})}),s}redeemDividendV2Payload(t,e,n){const{xcetus_dividends:i}=this.sdk.sdkOptions;let s=new Pe;return e.filter(r=>n.includes(r)).length>0&&(s=this.redeemDividendXTokenPayload(t,s)),e.forEach(r=>{n.includes(r)||s.moveCall({target:`${i.published_at}::${Td}::redeem_v2`,typeArguments:[r],arguments:[s.object(W(i).dividend_manager_id),s.object(t),s.object(fe)]})}),s}redeemDividendXTokenPayload(t,e){const{xcetus_dividends:n,xcetus:i}=this.sdk.sdkOptions,{xcetus_manager_id:s,lock_manager_id:o}=W(i),{dividend_manager_id:r}=W(n);return e=e===void 0?new Pe:e,e.moveCall({target:`${n.published_at}::${Td}::redeem_xtoken`,typeArguments:[],arguments:[e.object(o),e.object(s),e.object(r),e.object(t),e.object(fe)]}),e}buileCetusCoinType(){return`${this.sdk.sdkOptions.cetus_faucet.package_id}::cetus::CETUS`}buileXTokenCoinType(t=this._sdk.sdkOptions.xcetus.package_id,e="xcetus",n="XCETUS"){return`${t}::${e}::${n}`}cancelRedeemPayload(t){const{xcetus:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${Ro}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(W(e).lock_manager_id),n.pure(W(e).xcetus_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(fe)]}),n}async getInitConfigs(){var r,a;const{package_id:t}=this.sdk.sdkOptions.xcetus,e=`${t}_getInitFactoryEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::xcetus::InitEvent`}))==null?void 0:r.data,s={xcetus_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(s.xcetus_manager_id=u.xcetus_manager)});const o=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::locking::InitializeEvent`}))==null?void 0:a.data;return o.length>0&&o.forEach(c=>{const u=c.parsedJson;u&&(s.lock_manager_id=u.lock_manager)}),s.lock_manager_id.length>0&&(s.lock_handle_id=(await this.getLockUpManager(s.lock_manager_id)).lock_infos.lock_handle_id),this.updateCache(e,s,Ee),s}async getLockUpManager(t=W(this.sdk.sdkOptions.xcetus).lock_manager_id,e=!1){const n=`${t}_getLockUpManager`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this.sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=js.buildLockUpManager(je(s));return this.updateCache(n,o,Ee),o}async getDividendConfigs(){var o;const{package_id:t}=this.sdk.sdkOptions.xcetus_dividends,e=`${t}_getDividendManagerEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::dividend::InitEvent`}))==null?void 0:o.data,s={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(s.dividend_manager_id=a.manager_id,s.dividend_admin_id=a.admin_id,s.dividend_settle_id=a.settle_id,this.updateCache(e,s,Ee))}),s}async getDividendManager(t=!1){const{dividend_manager_id:e}=W(this._sdk.sdkOptions.xcetus_dividends),n=`${e}_getDividendManager`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=je(s),r=js.buildDividendManager(o);return this.updateCache(n,r,Ee),r}async getXcetusManager(t=!0){const{xcetus_manager_id:e}=W(this._sdk.sdkOptions.xcetus),n=`${e}_getXcetusManager`,i=this.getCache(n,t);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=je(s),r={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(t,e){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=je(n);return js.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(W(this._sdk.sdkOptions.xcetus).lock_manager_id),i=U(ri).mul(U(n.max_lock_day).sub(U(e))).mul(U(n.max_percent_numerator).sub(U(n.min_percent_numerator))).div(U(n.max_lock_day).sub(U(n.min_lock_day))),s=U(ri).mul(U(n.max_percent_numerator)).sub(i).div(U(cu)).div(ri);return{amountOut:U(s).mul(U(t)).round().toString(),percent:s.toString()}}async reverseRedeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(W(this._sdk.sdkOptions.xcetus).lock_manager_id),i=U(ri).mul(U(n.max_lock_day).sub(U(e))).mul(U(n.max_percent_numerator).sub(U(n.min_percent_numerator))).div(U(n.max_lock_day).sub(U(n.min_lock_day))),s=U(ri).mul(U(n.max_percent_numerator)).sub(i).div(U(cu)).div(ri);return{amountOut:U(t).div(s).toFixed(0,ie.ROUND_UP),percent:s.toString()}}async getXCetusAmount(t){const{lock_handle_id:e}=W(this._sdk.sdkOptions.xcetus),n=`${t}_getXCetusAmount`,i=this.getCache(n);if(i!==void 0)return i;try{const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),o=je(s);if(o){const{xcetus_amount:r}=o.value.fields.value.fields;return this.updateCache(n,r,Ee),r}}catch{}return"0"}async getVeNftAmount(t,e){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=je(n);if(i){const{lock_amount:s,xcetus_amount:o}=i.value.fields.value.fields;return{lock_amount:s,xcetus_amount:o}}}catch{}return{lock_amount:"0",xcetus_amount:"0"}}async getPhaseDividendInfo(t,e=!1){const i=(await this.getDividendManager()).dividends.id,s=`${i}_${t}_getPhaseDividendInfo`,o=this._sdk.getCache(s,e);if(o)return o;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:t}}),a=je(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),l=c.bonus_types.map(g=>g.fields.name),d=c.bonus.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),p={id:Di(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(s,p),p}catch{}}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},f4="factory",Zn="oversubscribe_pool",Bb=1e6,Mc=1e18,$o="router",Ad="router",pc="router",$0={curve:{strategy:3,both_side:{div_width:10,ratios:[.333333,.266666,.2,.133333,.066666]},one_side:{div_width:5,ratios:[.333333,.266666,.2,.133333,.066666]}},bidAsk:{strategy:4,both_side:{div_width:10,ratios:[.172413793,.137931034,.103448276,.068965517,.034482759,.068965517,.103448276,.137931034,.172413793]},one_side:{div_width:5,ratios:[.066666667,.13333333,.2,.266666667,.333333333]}}};function g4(t){return"master_address"in t}var kd="router",m4="vaults",_4=1e4,on=class{static buildIdoPoolImmutables(t){return{pool_address:pi(t.pool_id),coin_type_sale:ae(t.sale_coin_type.name).full_address,coin_type_raise:ae(t.raise_coin_type.name).full_address,tick_spacing:Number(t.tick_spacing),total_supply:t.total_supply,min_purchase:t.min_purchase_amount,max_purchase:t.max_purchase_amount}}static buildIdoPool(t){const e=Si(t),n=ae(e),i=je(t);console.log("fields:",i);const s={pool_address:pi(i.id.id),coin_type_sale:n.type_arguments[0],coin_type_raise:n.type_arguments[1],tick_spacing:Number(i.tick_spacing),total_supply:i.total_supply,min_purchase:i.min_purchase_amount,max_purchase:i.max_purchase_amount},o={start_time:Number(i.duration_manager.fields.start_time),lock_up_duration:Number(i.duration_manager.fields.lock_up_duration),purchase_duration:Number(i.duration_manager.fields.purchase_duration),end_time:0};o.end_time=o.start_time+o.purchase_duration;const r={complete_raise_limit:i.complete_raise_limit,liquidity_injection_ratio:U(i.liquidity_injection_ratio).div(Bb).toNumber(),current_sqrt_price_min:i.current_sqrt_price_min,current_sqrt_price_max:i.current_sqrt_price_max,owner:i.owner,sale_coin_amount:i.sale_coin,raise_coin_amount:i.raise_coin,price:i.price,current_price:i.price,duration_summary:o,is_cancelled:i.is_cancelled,is_liquidity_injected:i.is_liquidity_injected,liquidity_used_raise_amount:i.liquidity_used_raise_amount,liquidity_used_sale_amount:i.liquidity_used_sale_amount,purchase_summary:{size:Number(i.purchase_manager.fields.purchases.fields.size),purchase_handle:i.purchase_manager.fields.purchases.fields.id.id},total_purchase_amount:i.total_purchase_amount,white_summary:{white_list_id:i.white_list.fields.id.id,protection_limit_used:i.white_list.fields.protection_limit_used,protection_hard_cap:i.white_list.fields.protection_hard_cap,white_handle:i.white_list.fields.addresses.fields.id.id,size:Number(i.white_list.fields.addresses.fields.size)},pool_status:"Upcoming",max_raise_amount:"",sale_decimals:0,raise_decimals:0,is_withdrawn:i.is_withdrawn};return on.updatePoolStatus(r),{...s,...r}}static is_init_period(t){return Number(U(Date.now()/1e3).toFixed(0))<t.start_time}static is_purchase_period(t){const e=Number(U(Date.now()/1e3).toFixed(0));return e>=t.start_time&&e<=t.start_time+t.purchase_duration}static is_claim_period(t){const e=Number(U(Date.now()/1e3).toFixed(0)),n=t.start_time+t.purchase_duration;return e>n}static is_can_inject_liquidity(t){return!t.is_cancelled&&t.liquidity_injection_ratio!==0&&on.is_claim_period(t.duration_summary)&&!t.is_liquidity_injected}static is_can_withdraw(t){return t.is_withdrawn?!1:on.is_sale_failed(t)?!0:(t.liquidity_injection_ratio===0||t.is_liquidity_injected)&&on.is_claim_period(t.duration_summary)}static is_sale_failed(t){return!!(t.is_cancelled||on.is_claim_period(t.duration_summary)&&U(t.total_purchase_amount).lessThan(t.complete_raise_limit))}static buildPurchaseInfo(t){return{...t.value.fields.value.fields,owner:t.name}}static calculateRedeemAmount(t,e){let n,i;if(on.is_sale_failed(t))n="0",i="0";else if(e.is_redeemed)n=e.obtained_sale_amount,i=e.used_raise_amount;else if(U(t.total_purchase_amount).lessThanOrEqualTo(t.max_raise_amount))n=U(e.purchased_raise_amount).mul(Mc).div(t.price).toString(),i=e.purchased_raise_amount;else{const o=on.redeemForSaleOversubcribe(t,e);n=o.user_obtained_sale_amount,i=o.user_used_raise_amount_ceil}n=ie.floor(n);const s=ie.floor(U(e.purchased_raise_amount).sub(i).toString());return{obtained_sale_amount:n,refunded_raise_amount:s}}static calculateWithdrawAmount(t){let e,n;const i=U(t.total_supply).mul(t.liquidity_injection_ratio);if(on.is_sale_failed(t))e="0",n=U(i).add(t.total_supply);else{const{max_raise_amount:s}=t;U(t.total_purchase_amount).greaterThanOrEqualTo(s)?(e=U(s).sub(t.liquidity_used_raise_amount).toString(),n="0"):(e=U(t.total_purchase_amount).sub(t.liquidity_used_raise_amount),n=U(t.total_supply).add(i).sub(t.liquidity_used_sale_amount).sub(on.get_sold_amount(t)))}return{obtained_raise_amount:ie.floor(e).toString(),refunded_sale_amount:ie.ceil(n).toString()}}static get_sold_amount(t){return U(t.total_purchase_amount).greaterThanOrEqualTo(t.max_raise_amount)?t.total_supply:U(t.total_purchase_amount).mul(Mc).div(t.price)}static redeemForSaleOversubcribe(t,e){const n=e.protection_raise_amount,i=U(e.purchased_raise_amount).sub(n),s=t.max_raise_amount,{protection_limit_used:o}=t.white_summary,r=U(s).sub(o),a=U(t.total_purchase_amount).sub(o),c=ie.ceil(i.mul(r).div(a).add(n)),u=ie.floor(i.mul(r).div(a).add(n));return{user_obtained_sale_amount:ie.floor(U(t.total_supply).mul(u).div(s)),user_used_raise_amount_ceil:c}}static raiseTotalAmount(t){const e=U(t.sale_decimals-t.raise_decimals).abs().toNumber();return t.sale_decimals>t.raise_decimals?U(t.total_supply).mul(t.current_price).div(U(10).pow(U(e))).toString():U(t.total_supply).mul(t.current_price).mul(U(10).pow(U(e))).toString()}static updatePoolStatus(t){const e=Number(U(Date.now()/1e3).toFixed(0)),n=t.duration_summary,i=n.start_time+n.purchase_duration;t.is_cancelled?t.pool_status="Canceled":e<n.start_time?t.pool_status="Upcoming":e>n.start_time&&e<i?t.pool_status="Live":U(t.total_purchase_amount).lessThan(t.complete_raise_limit)?t.pool_status="Failed":t.pool_status="Ended"}static async calculatePoolUiPrice(t,e){const n=await t.ClmmSDK.CetusConfig.getTokenListByCoinTypes([e.coin_type_sale,e.coin_type_raise]),i=n[e.coin_type_sale].decimals,s=n[e.coin_type_raise].decimals;e.current_price=An.priceFixToReal(Number(U(e.price).div(U(Mc)).toString()),i,s).toString(),e.sale_decimals=i,e.raise_decimals=s,e.max_raise_amount=this.raiseTotalAmount(e)}},aR=class{constructor(t){xe(this,"_sdk");this._sdk=t}async getPools(t=[],e=!1){const n=[];if(t.length>0){if(t.filter(s=>{const o=`${s}_getPool`,r=this._sdk.getCache(o,e);return r?(n.push(r),!1):!0}).length>0){const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(t,{showType:!0,showContent:!0});for(const o of s){const r=await this.buildIdoWarpPool(o);r&&n.push(r)}}}else{const i=await this._sdk.Launchpad.getPools(),s=await this._sdk.Ido.getPools();i.forEach(o=>{n.push({...o,version:"1"})}),s.forEach(o=>{n.push({...o,version:"2"})})}return n.forEach(i=>{const s=`${i.pool_address}_getPool`;this._sdk.updateCache(s,i)}),n}async getPool(t,e=!0){const n=`${t}_getPool`,i=this._sdk.getCache(n,e);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),o=await this.buildIdoWarpPool(s);return this._sdk.updateCache(n,o),o}async getJoinPools(t,e){const n=[],i=e.filter(o=>o.version==="1"),s=e.filter(o=>o.version==="2");if(i.length>0){const o=await this._sdk.Launchpad.getPurchaseMarks(t,i.map(r=>r.pool_address),!1);i.forEach(r=>{for(const a of o)if(a.pool_id===r.pool_address){n.push(r);break}})}for(const o of s)await this._sdk.Ido.getPurchaseInfo(o.purchase_summary.purchase_handle,t,!1)&&n.push(o);return n}async getOwnerPools(t,e){return e.filter(n=>n.owner===tn(t))}async creatPurchasePayload(t,e){return t.version==="1"?await this._sdk.Launchpad.creatPurchasePayload({pool_address:t.pool_address,purchase_amount:e,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise}):await this._sdk.Ido.creatPurchasePayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise,purchase_handle:t.purchase_summary.purchase_handle,raise_amount:e.toString()})}async creatRedeemPayload(t){return t.version==="1"?await this._sdk.Launchpad.creatClaimPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise}):await this._sdk.Ido.redeemPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise,purchase_handle:t.purchase_summary.purchase_handle})}async creatWithdrawPayload(t){if(t.version==="1"){const n=await An.getWithdrawSale(t),i=await An.getWithdrawRaise(t);return this._sdk.Launchpad.creatWithdrawPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise,sale_amount:BigInt(n),raise_amount:BigInt(i)})}return this._sdk.Ido.withdrawPayload({pool_address:t.pool_address,coin_type_sale:t.coin_type_sale,coin_type_raise:t.coin_type_raise})}unlockNftPayload(t,e){return t.version==="1"?this._sdk.Launchpad.creatUnlockNftPayload(e):this._sdk.Ido.unlockNftPayload({lock_nft_id:e.lock_nft,nft_type:e.nft_type})}async getLockNFTList(t){let e=[];return t.version==="1"&&(e=await this._sdk.Launchpad.getLockNFTList(t.owner)),e=await this._sdk.Ido.getLockNFTList(t.owner),e.filter(i=>i.coin_type_a===t.coin_type_sale&&i.coin_type_b===t.coin_type_raise||i.coin_type_a===t.coin_type_raise&&i.coin_type_b===t.coin_type_sale)}async isWhiteListUser(t,e){return e.version==="1"?await this._sdk.Launchpad.isWhiteListUser(e.white_summary.white_handle,t):!!await this._sdk.Ido.getWhiteProtectionLimit(e.white_summary.white_handle,t)}async getPurchaseInfo(t,e){if(e.version==="1"){const i=await this._sdk.Launchpad.getPurchaseMarks(t,[e.pool_address]);return i.length>0?i[0]:void 0}return await this._sdk.Ido.getPurchaseInfo(e.purchase_summary.purchase_handle,t)}async getwhiteProtectionInfo(t,e,n=!1){if(e.version==="1")return await this._sdk.Launchpad.getPurchaseAmount(e.white_summary.white_handle,t);const i=await this._sdk.Ido.getPurchaseInfo(e.purchase_summary.purchase_handle,t,n);if(i)return{safe_limit_amount:i.protection_raise_limit,safe_purchased_amount:i.protection_raise_amount};const s=await this._sdk.Ido.getWhiteProtectionLimit(e.white_summary.white_handle,t,!1);return s?{safe_limit_amount:s,safe_purchased_amount:"0"}:{safe_limit_amount:"0",safe_purchased_amount:"0"}}async calculateWithdrawAmount(t){if(t.version==="1"){const e=await An.getHistoryWithdrawRaise(this._sdk,t),n=await An.getHistoryWithdrawSale(this._sdk,t);return{obtained_raise_amount:e,refunded_sale_amount:n}}return on.calculateWithdrawAmount(t)}async buildIdoWarpPool(t){const e=ro(t);if(console.log(this._sdk.sdkOptions.ido.package_id,ae(e).address,"buildIdoWarpPool"),ae(e).address===this._sdk.sdkOptions.ido.package_id){const n=on.buildIdoPool(t);return await on.calculatePoolUiPrice(this._sdk,n),{...n,version:"2"}}if(ae(e).address===this._sdk.sdkOptions.launchpad.package_id){const n=An.buildLaunchPadPool(t);return await An.calculatePoolPrice(this._sdk,n),{...n,version:"1"}}}},Fs=class{static buildVeNFTDividendInfo(t){const e={id:t.id.id,ve_nft_id:t.name,rewards:[]};return t.value.fields.value.fields.dividends.fields.contents.forEach(n=>{const i=[];n.fields.value.fields.contents.forEach(s=>{i.push({coin_type:ae(s.fields.key.fields.name).source_address,amount:s.fields.value})}),e.rewards.push({period:Number(n.fields.key),rewards:i})}),e}static buildDividendManager(t){const e={id:t.id.id,dividends:{id:t.dividends.fields.id.id,size:t.dividends.fields.size},venft_dividends:{id:t.venft_dividends.fields.id.id,size:t.venft_dividends.fields.size},bonus_types:[],start_time:Number(t.start_time),interval_day:Number(t.interval_day),balances:{id:t.balances.fields.id.id,size:t.balances.fields.size},is_open:t.is_open};return t.bonus_types.forEach(n=>{e.bonus_types.push(ae(n.fields.name).source_address)}),e}static buildLockUpManager(t){return{id:t.id.id,balance:t.balance,treasury_manager:t.treasury_manager,extra_treasury:t.extra_treasury,lock_infos:{lock_handle_id:t.lock_infos.fields.id.id,size:Number(t.lock_infos.fields.size)},type_name:Mn(t.type_name.fields.name),min_lock_day:Number(t.min_lock_day),max_lock_day:Number(t.max_lock_day),package_version:Number(t.package_version),max_percent_numerator:Number(t.max_percent_numerator),min_percent_numerator:Number(t.min_percent_numerator)}}static buildLockToken(t){const e=t.fields,n={id:e.id.id,type:ae(t.type).source_address,locked_start_time:Number(e.locked_start_time),locked_until_time:Number(e.locked_until_time),token_amount:e.balance,xtoken_amount:"0",lock_day:0};return n.lock_day=(n.locked_until_time-n.locked_start_time)/ra,n}static getAvailableXToken(t,e){let n=U(0);return e.forEach(i=>{n=n.add(i.xtoken_amount)}),U(t.xtoken_balance).sub(n).toString()}static getWaitUnLockTokens(t){return t.filter(e=>!Fs.isLocked(e))}static getLockingTokens(t){return t.filter(e=>Fs.isLocked(e))}static buildDividendRewardTypeList(t){const e=new Set;return t.forEach(n=>{n.rewards.forEach(i=>{e.add(i.coin_type)})}),Array.from(e)}static isLocked(t){return t.locked_until_time>Date.parse(new Date().toString())/1e3}static getNextStartTime(t,e=ra){const n=Date.now()/1e3,{start_time:i,interval_day:s}=t,o=Math.ceil((n-i)/(s*e));return i+o*s*e}},zi=class{static getDefaultStrategyConfig(t){let e;switch(t){case 4:e=$0.bidAsk;break;default:e=$0.curve;break}return e}static geTickIndexRange(t,e,n,i){let s,o;switch(t=Se.getInitializableTickIndex(t,e),i){case"left":t>0?(o=U(t).sub(e).toNumber(),s=U(t).mul(U(1).add(n)).toDecimalPlaces(0).toNumber()):(o=U(t).sub(e).toNumber(),s=U(t).mul(U(1).sub(n)).toDecimalPlaces(0).toNumber());break;case"right":t>0?(o=U(t).mul(U(1).add(n)).toDecimalPlaces(0).toNumber(),s=U(t).add(e).toNumber()):(o=U(t).mul(U(1).sub(n)).toDecimalPlaces(0).toNumber(),s=U(t).add(e).toNumber());break;default:t>0?(s=U(t).mul(U(1).sub(n)).toDecimalPlaces(0).toNumber(),o=U(t).mul(U(1).add(n)).toDecimalPlaces(0).toNumber()):(s=U(t).mul(U(1).add(n)).toDecimalPlaces(0).toNumber(),o=U(t).mul(U(1).sub(n)).toDecimalPlaces(0).toNumber());break}if(s=Se.getInitializableTickIndex(s,e),o=Se.getInitializableTickIndex(o,e),s<oh)throw Error("Tick lower value is below the minimum allowed value.");if(o>sh)throw Error("Tick upper value is above the maximum allowed value.");return{tick_lower:s,tick_upper:o}}static getCreateLiquidityBins(t,e){let n=[];switch(e){case 4:n=zi.getCreateBidAskLiquidityBins(t);break;default:n=zi.getCreateCurveLiquidityBins(t);break}return n}static getCreateBidAskLiquidityBins(t){const e=U(Math.floor(U(t.tick_upper).sub(t.tick_lower).div(t.div_width).toNumber())).abs(),n=[],i=t.ratios;let s,o;for(let r=0;r<i.length;r++){let a,c;t.tick_upper<=t.curr_tick?(c=U(t.tick_upper).sub(e.mul(r)).toNumber(),a=U(c).sub(e).toNumber()):t.tick_lower>=t.curr_tick?(a=U(t.tick_lower).add(e.mul(r)).toNumber(),c=U(t.tick_lower).add(e.mul(r+1)).toNumber()):r===4?(a=U(t.tick_lower).add(e.mul(r)).toNumber(),c=U(a).add(e.mul(2)).toNumber()):r>4?(a=U(t.tick_lower).add(e.mul(r+1)).toNumber(),c=U(a).add(e).toNumber()):(a=U(t.tick_lower).add(e.mul(r)).toNumber(),c=U(a).add(e).toNumber()),s=Se.getInitializableTickIndex(a,t.tick_spacing),o=Se.getInitializableTickIndex(c,t.tick_spacing),n.push({tick_lower:s,tick_upper:o,ratio:i[r],liquidity:"0"})}return n}static getCreateCurveLiquidityBins(t){const e=U(Math.floor(U(t.tick_upper).sub(t.tick_lower).div(t.div_width).toNumber())).abs(),n=[],i=t.ratios;for(let s=0;s<i.length;s++){let o,r;t.tick_upper<=t.curr_tick?(r=t.tick_upper,o=U(t.tick_upper).sub(e.mul(s+1)).toNumber()):t.tick_lower>=t.curr_tick?(o=t.tick_lower,r=U(o).add(e.mul(s+1)).toNumber()):(o=U(t.curr_tick).sub(e.mul(s+1)).toNumber(),r=U(t.curr_tick).add(e.mul(s+1)).toNumber()),n.push({tick_lower:Se.getInitializableTickIndex(o,t.tick_spacing),tick_upper:Se.getInitializableTickIndex(r,t.tick_spacing),ratio:i[s],liquidity:"0"})}return n}static calculateAddLiquidityInputs(t){const e=new y(Se.tickIndexToSqrtPriceX64(t.curr_tick)),n=zi.calculateCoinRatios(t.curr_tick,t.liquidity_bins),i=t.liquidity_bins.map((s,o)=>{const r=n[o],a=U(t.coin_amount).mul(t.fix_amount_a?r.coinRatioA:r.coinRatioB).toFixed(0).toString();try{return{...It.estLiquidityAndcoinAmountFromOneAmounts(s.tick_lower,s.tick_upper,new y(a),t.fix_amount_a,!0,t.slippage,e),...s}}catch{return{coinAmountA:new y(0),coinAmountB:new y(0),tokenMaxA:new y(0),tokenMaxB:new y(0),liquidityAmount:new y(0),fix_amount_a:!t.fix_amount_a,...s}}});return zi.fixLiquidityInputs(e,t.slippage,i,!0)}static fixLiquidityInputs(t,e,n,i){const s=n.filter(r=>r.liquidityAmount.gt(Ue));if(s.length===0)return[];const o=s[0];return n.map(r=>{if(r.liquidityAmount.eq(Ue)){const a=U(o.liquidityAmount.toString()).mul(r.ratio).div(o.ratio).toFixed(0),c=Se.tickIndexToSqrtPriceX64(r.tick_lower),u=Se.tickIndexToSqrtPriceX64(r.tick_upper),l=It.getCoinAmountFromLiquidity(new y(a.toString()),t,c,u,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,liquidityAmount:new y(a.toString()),fix_amount_a:r.fix_amount_a,...gd(l,sa.fromDecimal(U(e).mul(100)),i)}}return r})}static calculateCoinRatios(t,e){const n=new y(Se.tickIndexToSqrtPriceX64(t)),i=[];let s=U(0),o=U(0);const r=e.map(u=>{const l=U(VB(100,6).toString()).mul(u.ratio).toFixed(0).toString(),d=Se.tickIndexToSqrtPriceX64(u.tick_lower),p=Se.tickIndexToSqrtPriceX64(u.tick_upper),g=It.getCoinAmountFromLiquidity(new y(l),n,d,p,!0);return s=s.add(g.coinA.toString()),o=o.add(g.coinB.toString()),{...g,liquidity:l}}),a=[],c=[];return r.forEach((u,l)=>{const d={coinRatioA:s.eq(U(0))?0:U(u.coinA.toString()).div(s).toNumber(),coinRatioB:o.eq(U(0))?0:U(u.coinB.toString()).div(o).toNumber(),liquiditys:u.liquidity,tick_lower:e[l].tick_lower,tick_upper:e[l].tick_upper};i.push(d),a.push(s.eq(U(0))?0:U(u.coinA.toString()).div(s).toNumber()),c.push(o.eq(U(0))?0:U(u.coinB.toString()).div(o).toNumber())}),i}static calculateCloseMasterLiquidityInputs(t){const e=new y(Se.tickIndexToSqrtPriceX64(t.curr_tick));return t.positions.map(i=>{const s=new y(i.liquidity),o=Se.tickIndexToSqrtPriceX64(i.tick_lower_index),r=Se.tickIndexToSqrtPriceX64(i.tick_upper_index),a=It.getCoinAmountFromLiquidity(s,e,o,r,!1),c=sa.fromDecimal(U(t.slippage).mul(100)),{tokenMaxA:u,tokenMaxB:l}=gd(a,c,!1);return{coinAmountA:a.coinA,coinAmountB:a.coinB,tokenMaxA:u,tokenMaxB:l,liquidityAmount:s,fix_amount_a:!1}})}static calculateRemoveMasterLiquidityInputs(t){const e=new y(Se.tickIndexToSqrtPriceX64(t.curr_tick)),{fix_token:n}=t;if(n){const s=t.positions.map((a,c)=>({tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,ratio:t.ratios[c]})),o=zi.calculateCoinRatios(t.curr_tick,s),r=t.positions.map((a,c)=>{const u=o[c],l=U(n.coin_amount).mul(n.fix_amount_a?u.coinRatioA:u.coinRatioB).toFixed(0).toString();try{const d=It.estLiquidityAndcoinAmountFromOneAmounts(a.tick_lower_index,a.tick_upper_index,new y(l),n.fix_amount_a,!1,t.slippage,e);return{...d,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:d.liquidityAmount.toString(),ratio:t.ratios[c]}}catch{return{coinAmountA:new y(0),coinAmountB:new y(0),tokenMaxA:new y(0),tokenMaxB:new y(0),liquidityAmount:new y(0),fix_amount_a:!n.fix_amount_a,tick_lower:a.tick_lower_index,tick_upper:a.tick_upper_index,liquidity:"0",ratio:t.ratios[c]}}});return zi.fixLiquidityInputs(e,t.slippage,r,!1)}return t.positions.map((s,o)=>{const r=t.ratios[o];let a=U(t.liquidity).mul(r).toFixed(0);U(a).greaterThan(s.liquidity)&&(a=s.liquidity);const c=Se.tickIndexToSqrtPriceX64(s.tick_lower_index),u=Se.tickIndexToSqrtPriceX64(s.tick_upper_index),l=It.getCoinAmountFromLiquidity(new y(a),e,c,u,!1),d=sa.fromDecimal(U(t.slippage).mul(100)),{tokenMaxA:p,tokenMaxB:g}=gd(l,d,!1);return{coinAmountA:l.coinA,coinAmountB:l.coinB,tokenMaxA:p,tokenMaxB:g,liquidityAmount:new y(a),fix_amount_a:!1}})}static buildMasterPosition(t){return{coin_type_a:ae(t.coin_type_a.fields.name).full_address,coin_type_b:ae(t.coin_type_b.fields.name).full_address,description:t.description,id:t.id.id,index:t.index,liquidity:t.liquidity,name:t.name,pool:t.pool,tick_lower_index:Zt(BigInt(t.tick_lower_index.fields.bits)),tick_upper_index:Zt(BigInt(t.tick_upper_index.fields.bits)),url:t.url}}static buildMasterNFT(t){const e=je(t);if(e){const n={id:e.id.id,pool_id:e.pool_id,index:Number(e.index),strategy:Number(e.strategy),tick_lower_index:Zt(BigInt(e.tick_lower_index)),tick_upper_index:Zt(BigInt(e.tick_upper_index)),positions:[],...vl(t)};return n.positions=e.positions.map(i=>zi.buildMasterPosition(i.fields)),n}}},Hi=class{static generateNextTickRange(t,e,n){const i=t-e/2,s=t+e/2;return{new_tick_lower:Hi.getValidTickIndex(i,n),new_tick_upper:Hi.getValidTickIndex(s,n)}}static calculateDepositRatio(t,e,n){const i=Se.sqrtPriceX64ToTickIndex(n);if(i<t)return{ratioA:new ie(1),ratioB:new ie(0)};if(i>e)return{ratioA:new ie(0),ratioB:new ie(1)};const s=new y(1e8),{coinAmountB:o}=It.estLiquidityAndcoinAmountFromOneAmounts(t,e,s,!0,!0,0,n),r=Se.sqrtPriceX64ToPrice(n,0,0),a=U(s.toString()).mul(r),c=a.add(o.toString()),u=a.div(c),l=U(o.toString()).div(c);return{ratioA:u,ratioB:l}}static getValidTickIndex(t,e){if(t%e===0)return t;let n;if(t>0?n=t-t%e+e:t<0?n=t+Math.abs(t)%e-e:n=t,n%e!==0)throw new Error("Assertion failed: res % tickSpacing == 0");if(Math.abs(n)<Math.abs(t))throw new Error("Assertion failed: res.abs() >= tickIndex");return n}static get_lp_amount_by_liquidity(t,e){return t.total_supply==="0"?e:U(t.total_supply).mul(e).div(t.liquidity).toFixed(0,ie.ROUND_DOWN).toString()}static get_share_liquidity_by_amount(t,e){return U(e).mul(t.liquidity).div(t.total_supply).toFixed(0,ie.ROUND_DOWN).toString()}static get_protocol_fee_amount(t,e){return U(e).mul(t.protocol_fee_rate).div(_4).toFixed(0,ie.ROUND_CEIL)}static buildPosition(t){return{coin_type_a:ae(t.coin_type_a.fields.name).full_address,coin_type_b:ae(t.coin_type_b.fields.name).full_address,description:t.description,id:t.id.id,index:t.index,liquidity:t.liquidity,name:t.name,pool:t.pool,tick_lower_index:Zt(BigInt(t.tick_lower_index.fields.bits)),tick_upper_index:Zt(BigInt(t.tick_upper_index.fields.bits)),url:t.url}}static buildPool(t){const e=je(t),n=ro(t);if(e){const i={id:e.id.id,pool_id:e.pool,protocol_fee_rate:e.protocol_fee_rate,is_pause:e.is_pause,harvest_assets:{harvest_assets_handle:e.harvest_assets.fields.id.id,size:Number(e.harvest_assets.fields.size)},positins:[],lp_token_type:ae(n).type_arguments[0],total_supply:e.lp_token_treasury.fields.total_supply.fields.value,liquidity:e.liquidity,max_quota:e.max_quota,status:e.status===1?"STATUS_RUNNING":"STATUS_REBALANCING",quota_based_type:e.quota_based_type.fields.name};return i.positins=e.positions.map(s=>Hi.buildPosition(s.fields)),i}}},Qr=class{static calculatePositionShare(t,e,n,i,s,o,r){if(e<=s||t>=o)return"0";let a=0;t<s?a=s:a=t;let c=0;e<o?c=e:c=o;const u=Se.tickIndexToSqrtPriceX64(a),l=Se.tickIndexToSqrtPriceX64(c),{coinA:d,coinB:p}=It.getCoinAmountFromLiquidity(new y(n),new y(r),u,l,!0);return U(d.toString()).mul(i).div(1e12).add(p.toString()).toString()}static buildFramsPool(t){const e=je(t);if(e)try{const n=[];return e.rewarders.forEach(s=>{n.push({reward_coin:ae(s.fields.name).full_address,last_reward_time:"",emission_per_second:"",total_allocate_point:"",allocate_point:""})}),{id:e.id.id,clmm_pool_id:e.clmm_pool_id,effective_tick_lower:Zt(BigInt(e.effective_tick_lower.fields.bits)),effective_tick_upper:Zt(BigInt(e.effective_tick_upper.fields.bits)),total_share:e.total_share,rewarders:n,positions:{positions_handle:e.positions.fields.id.id,size:e.positions.fields.size},sqrt_price:e.sqrt_price}}catch(n){console.log(n)}}static buildFramsPositionNFT(t){const e=je(t);if(e){const n=e.clmm_postion.fields;return{id:e.id.id,url:n.url,pool_id:e.pool_id,coinTypeA:ae(n.coin_type_a.fields.name).full_address,coinTypeB:ae(n.coin_type_b.fields.name).full_address,description:n.description,name:n.name,liquidity:n.liquidity,clmm_position_id:n.id.id,clmm_pool_id:n.pool,tick_lower_index:Zt(BigInt(n.tick_lower_index.fields.bits)),tick_upper_index:Zt(BigInt(n.tick_upper_index.fields.bits)),rewards:[]}}}},y4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getPoolImmutables(t="all",e=!1){const{package_id:n}=this._sdk.sdkOptions.ido,i=`${n}_getPoolImmutables`,s=this.getCache(i,e),o={data:[],hasNextPage:!1},r=[];if(s!==void 0&&r.push(...s),r.length===0)try{const a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${n}::oversubscribe_pool::CreatePoolEvent`},t);a.data.forEach(c=>{const u=c.parsedJson;if(u){const l=on.buildIdoPoolImmutables(u);r.push(l)}}),o.hasNextPage=a.hasNextPage,o.nextCursor=a.nextCursor,this.updateCache(i,r,Ee)}catch(a){console.log("getPoolImmutables",a)}return o.data=r,o}async getPools(t=[],e=!1){const n=[];let i=[];t.length>0?i=[...t]:(await this.getPoolImmutables("all",e)).data.forEach(r=>{i.push(r.pool_address)});const s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0});for(const o of s){const r=on.buildIdoPool(o);await on.calculatePoolUiPrice(this._sdk,r),n.push(r);const a=`${r.pool_address}_getPoolObject`;this.updateCache(a,r,Ee)}return n}async getPool(t,e=!0){const n=`${t}_getPoolObject`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),o=on.buildIdoPool(s);return await on.calculatePoolUiPrice(this._sdk,o),this.updateCache(n,o),o}async getIdoConfigs(t=!1){var c;const{package_id:e}=this._sdk.sdkOptions.ido,n=`${e}_getInitEvent`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showPreviousTransaction:!0}}),o=Fa(s),r=(c=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({Transaction:o}))==null?void 0:c.data,a={pools_id:"",admin_cap_id:"",package_version_id:""};return r.length>0&&(r.forEach(u=>{console.log("item: ",u);const l=u.parsedJson;if(l)switch(ae(u.type).full_address){case`${e}::config::InitConfigEvent`:a.admin_cap_id=l.admin_cap_id,a.package_version_id=l.package_version_id;break;case`${e}::factory::InitFactoryEvent`:a.pools_id=l.pools_id;break}}),this.updateCache(n,a,Ee)),a}async getPurchaseInfo(t,e,n=!0){const i=`${t}_${e}_getPurchaseInfo`,s=this.getCache(i,n);if(s)return s;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"address",value:e}}),r=on.buildPurchaseInfo(je(o));return this.updateCache(i,r,Vn),r}catch{return}}async getLockNFT(t,e=!1){const n=`${t}_getLockNFT`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(!s.error)return sr(s)}async getLockNFTList(t){var s;const{clmm_pool:e}=this._sdk.ClmmSDK.sdkOptions,{ido:n}=this._sdk.sdkOptions,i=[];try{const o=(s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{filter:{StructType:`${n.package_id}::lock::LockedNFT<${e.package_id}::position::Position>`},options:{showContent:!0}}))==null?void 0:s.data;for(const r of o){const a=je(r);if(a){const c=a.nft.fields,u={locked_at:Number(a.locked_at),lock_duration:Number(a.lock_duration),lock_nft_id:a.id.id,type:a.nft.type,...c};u.end_lock_time=u.locked_at+u.lock_duration,u.coin_type_a=ae(c.coin_type_a.fields.name).full_address,u.coin_type_b=ae(c.coin_type_b.fields.name).full_address,u.id=c.id.id,u.tick_lower_index=Zt(BigInt(c.tick_lower_index.fields.bits)),u.tick_upper_index=Zt(BigInt(c.tick_upper_index.fields.bits)),i.push(u)}}return i}catch(o){return console.log("getLockNFTList:",o),[]}}async creatPool(t){const{ido:e}=this.sdk.sdkOptions;iu(tn(t.coin_type_sale),tn(t.coin_type_raise))&&(t.price_min=U(1).div(t.price_max).toNumber(),t.price_max=U(1).div(t.price_min).toNumber());const i=An.priceRealToFix(Number(t.price),t.sale_decimals,t.raise_decimals),s=Se.priceToSqrtPriceX64(U(t.price_min),t.sale_decimals,t.raise_decimals).toString(),o=Se.priceToSqrtPriceX64(U(t.price_max),t.sale_decimals,t.raise_decimals).toString(),r=new Pe,a=U(t.total_supply).add(U(t.total_supply).mul(U(t.liquidity_injection_ratio))).toNumber(),c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,t.coin_type_sale),u=tt.buildCoinForAmount(r,c,BigInt(a),t.coin_type_sale,!1),l=[r.pure(W(e).admin_cap_id),r.pure(W(e).package_version_id),r.pure(W(e).pools_id),r.pure(tn(t.owner)),r.pure(U(i).mul(Mc).toString()),r.pure(t.total_supply),r.pure(t.complete_raise_limit),r.pure(t.min_purchase_amount),r.pure(t.max_purchase_amount),r.pure(t.start_time),r.pure(t.purchase_duration),r.pure(t.lock_up_duration),r.pure((t.liquidity_injection_ratio*Bb).toString()),r.pure(s),r.pure(o),r.pure(t.tick_spacing.toString()),u.targetCoin,r.pure(t.protection_hard_cap.toString()),r.pure(fe)],d=[t.coin_type_sale,t.coin_type_raise];return r.moveCall({target:`${e.published_at}::${f4}::create_oversubscribe_pool`,typeArguments:d,arguments:l}),r}async creatPurchasePayload(t){const{ido:e}=this.sdk.sdkOptions,n=new Pe,i=await this.getPurchaseInfo(t.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1),s=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,t.coin_type_raise),o=tt.buildCoinForAmount(n,s,BigInt(t.raise_amount),t.coin_type_raise,!1),r=[t.coin_type_sale,t.coin_type_raise];let a,c;return i?(c="purchase",a=[n.object(W(e).package_version_id),n.object(t.pool_address),n.object(i.purchase_certificate_id),n.pure(t.raise_amount.toString()),o.targetCoin,n.pure(fe)]):(c="create_certificate_and_purchase",a=[n.object(W(e).package_version_id),n.object(t.pool_address),n.pure(t.raise_amount.toString()),o.targetCoin,n.pure(fe)]),n.moveCall({target:`${e.published_at}::${Zn}::${c}`,typeArguments:r,arguments:a}),n}async redeemPayload(t){const{ido:e}=this.sdk.sdkOptions,n=await this.getPurchaseInfo(t.purchase_handle,this._sdk.ClmmSDK.senderAddress,!1);if(n===void 0)throw Error("get purchase certificate fail");const i=new Pe,s=[t.coin_type_sale,t.coin_type_raise],o=[i.pure(W(e).package_version_id),i.pure(t.pool_address),i.pure(n.purchase_certificate_id),i.pure(fe)];return i.moveCall({target:`${e.published_at}::${Zn}::redeem`,typeArguments:s,arguments:o}),i}injectLiquidityPayload(t){const{ido:e}=this.sdk.sdkOptions,{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,i=new Pe,s=[t.coin_type_sale,t.coin_type_raise],o=t.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",r=[i.pure(W(e).package_version_id),i.pure(t.pool_address),i.pure(W(n).global_config_id),i.pure(t.clmm_pool_address),i.pure(fe)];return i.moveCall({target:`${e.published_at}::${Zn}::${o}`,typeArguments:s,arguments:r}),i}unPauseInjectLiquidity(t){const{ido:e}=this.sdk.sdkOptions,{integrate:n,clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions,s=new Pe;s.moveCall({target:`${n.published_at}::${ia}::unpause_pool`,typeArguments:[t.coin_type_a,t.coin_type_b],arguments:[s.object(W(i).global_config_id),s.object(t.clmm_pool_address)]});const o=[t.coin_type_sale,t.coin_type_raise],r=t.is_reverse?"inject_liquidity_with_reverse_clmm_pool":"inject_liquidity_with_forward_clmm_pool",a=[s.object(W(e).package_version_id),s.object(t.pool_address),s.object(W(i).global_config_id),s.object(t.clmm_pool_address),s.object(fe)];return s.moveCall({target:`${e.published_at}::${Zn}::${r}`,typeArguments:o,arguments:a}),s}async findClmmPoolForLiquidity(t){let e=null,n=!1;const i=await this.sdk.ClmmSDK.Pool.getPoolImmutables();for(const s of i){if(s.coinTypeA===t.coin_type_sale&&s.coinTypeB===t.coin_type_raise&&Number(s.tickSpacing)===t.tick_spacing){e=await this._sdk.ClmmSDK.Pool.getPool(s.poolAddress);break}if(s.coinTypeA===t.coin_type_raise&&s.coinTypeB===t.coin_type_sale&&Number(s.tickSpacing)===t.tick_spacing){e=await this._sdk.ClmmSDK.Pool.getPool(s.poolAddress),n=!0;break}}return e&&(U(e.current_sqrt_price).lessThanOrEqualTo(t.current_sqrt_price_min)||U(e.current_sqrt_price).greaterThanOrEqualTo(t.current_sqrt_price_max))?(console.log("clmmPool: ",e.poolAddress),{is_reverse:n,clmmPool:null}):{is_reverse:n,clmmPool:e}}withdrawPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new Pe,i=[t.coin_type_sale,t.coin_type_raise],s=[n.object(W(e).package_version_id),n.object(t.pool_address),n.object(fe)];return n.moveCall({target:`${e.published_at}::${Zn}::withdraw`,typeArguments:i,arguments:s}),n}updateWhitelistCapPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new Pe,i=[t.coin_type_sale,t.coin_type_raise];return t.add_whites&&t.add_whites.addresses.length>0&&n.moveCall({target:`${e.published_at}::${Zn}::add_white_listed_addresses`,typeArguments:i,arguments:[n.object(W(e).admin_cap_id),n.object(W(e).package_version_id),n.object(t.pool_address),n.makeMoveVec({type:"address",objects:t.add_whites.addresses.map(s=>n.pure(pi(s),"address"))}),n.pure(t.add_whites.protection_limit),n.object(fe)]}),t.remove_whites&&t.remove_whites.length>0&&n.moveCall({target:`${e.published_at}::${Zn}::remove_white_listed_addresses`,typeArguments:i,arguments:[n.object(W(e).admin_cap_id),n.object(W(e).package_version_id),n.object(t.pool_address),n.makeMoveVec({type:"address",objects:t.remove_whites.map(s=>n.pure(pi(s),"address"))}),n.object(fe)]}),t.update_whites&&t.update_whites.forEach(s=>{n.moveCall({target:`${e.published_at}::${Zn}::update_white_listed_address`,typeArguments:i,arguments:[n.object(W(e).admin_cap_id),n.object(W(e).package_version_id),n.object(t.pool_address),n.object(s.address),n.pure(s.protection_limit),n.object(fe)]})}),n}creatCancelPoolPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new Pe,i=[t.coin_type_sale,t.coin_type_raise],s=[n.pure(W(e).admin_cap_id),n.pure(W(e).package_version_id),n.pure(t.pool_address),n.pure(fe)];return n.moveCall({target:`${e.published_at}::${Zn}::cancel`,typeArguments:i,arguments:s}),n}updatePoolOwnerPayload(t,e){const{ido:n}=this.sdk.sdkOptions;e=e===void 0?new Pe:e;const i=[t.coin_type_sale,t.coin_type_raise],s=[e.object(W(n).admin_cap_id),e.object(W(n).package_version_id),e.object(t.pool_address),e.object(t.new_owner),e.object(fe)];return e.moveCall({target:`${n.published_at}::${Zn}::update_pool_owner`,typeArguments:i,arguments:s}),e}updatePoolDuractionPayload(t,e){const{ido:n}=this.sdk.sdkOptions;e=e===void 0?new Pe:e;const i=[t.coin_type_sale,t.coin_type_raise],s=[e.object(W(n).admin_cap_id),e.object(W(n).package_version_id),e.object(t.pool_address),e.pure(t.start_time),e.pure(t.purchase_duration),e.pure(t.lock_duration),e.object(fe)];return e.moveCall({target:`${n.published_at}::${Zn}::update_pool_duration`,typeArguments:i,arguments:s}),e}updateProtectionHardCapPayload(t,e){const{ido:n}=this.sdk.sdkOptions;e=e===void 0?new Pe:e;const i=[t.coin_type_sale,t.coin_type_raise],s=[e.object(W(n).admin_cap_id),e.object(W(n).package_version_id),e.object(t.pool_address),e.pure(t.protection_hard_cap),e.object(fe)];return e.moveCall({target:`${n.published_at}::${Zn}::update_protection_hard_cap`,typeArguments:i,arguments:s}),e}unlockNftPayload(t){const{ido:e}=this.sdk.sdkOptions,n=new Pe,i=[t.nft_type],s=[n.pure(t.lock_nft_id),n.pure(fe)];return n.moveCall({target:`${e.published_at}::lock::unlock_nft`,typeArguments:i,arguments:s}),n}async isAdminCap(t){const{ido:e}=this._sdk.sdkOptions,n=`${e.package_id}_${t}_isAdminCap`,i=this.getCache(n);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:W(e).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(s);const o=ro(s),r=ou(s);let a=!1;return r&&o&&ae(o).source_address===`${e.package_id}::config::AdminCap`&&(a=tn(r.AddressOwner)===tn(t)),this.updateCache(n,a,Ee),a}async getWhiteProtectionLimit(t,e,n=!0){const i=`${t}_${e}_getWhiteProtectionLimit`,s=this._sdk.getCache(i,n);if(s)return s;try{const o=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"address",value:e}});if(o&&o.data){const r=je(o);return this._sdk.updateCache(i,r.value),r.value}return}catch{return}}async getWhiteList(t,e){var i;const n={type:"address",value:e};try{const s=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:n}),o=je(s);if(console.log(o),o)return(i=o==null?void 0:o.value)==null?void 0:i.fields}catch{}return{safe_limit_amount:"0",safe_purchased_amount:"0"}}async getAdminAddress(){const{ido:t}=this._sdk.sdkOptions,e=`${W(t).admin_cap_id}_getAdminAddress`,n=this.getCache(e);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:W(t).admin_cap_id,options:{showType:!0,showOwner:!0}});console.log(i);const s=ro(i),o=ou(i);if(o&&s&&ae(s).source_address===`${t.package_id}::config::AdminCap`){const a=tn(o.AddressOwner);return this.updateCache(e,a,Ee),a}return""}updateCache(t,e,n=Ee){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},w4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getOwnerVeNFT(t,e=!0){const{xtoken:n}=this.sdk.sdkOptions,i=`${t}_getLockUpManagerEvent`,s=this.getCache(i,e);if(s!==void 0)return s;let o;const r=`${n.package_id}::xtoken::VeNFT`;return(await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0},filter:{StructType:r}})).data.forEach(c=>{const u=ae(Si(c)).source_address;if(u===r&&c.data&&c.data.content){const{fields:l}=c.data.content;o={...vl(c),id:l.id.id,index:l.index,type:u,xtoken_balance:l.xtoken_balance},this.updateCache(i,o,Ee)}}),o}async getOwnerLockTokens(t){const{xtoken:e}=this.sdk.sdkOptions,n=[],i=`${e.package_id}::lock_coin::LockedCoin<${this.buileTokenCoinType()}>`,s=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0},filter:{StructType:i}});for(const o of s.data)if(ae(Si(o)).source_address===i&&o.data){const a=Fs.buildLockToken(o.data.content),c=await this.getLockXToken(a.id);c&&(a.xtoken_amount=c.xtoken_amount),n.push(a)}return n}async getLockToken(t){var n;const e=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}});if((n=e.data)!=null&&n.content){const i=Fs.buildLockToken(e.data.content),s=await this.getLockXToken(i.id);return s&&(i.xtoken_amount=s.xtoken_amount),i}}async getOwnerTokenCoins(t){return await this._sdk.ClmmSDK.getOwnerCoinAssets(t,this.buileTokenCoinType())}mintVeNFTPayload(){const{xtoken:t}=this.sdk.sdkOptions,e=new Pe;return e.moveCall({target:`${t.published_at}::${$o}::mint_venft`,typeArguments:[],arguments:[e.pure(W(t).xtoken_manager_id)]}),e}async convertPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new Pe,i=this.buileTokenCoinType(),s=await tt.syncBuildCoinInputForAmount(this._sdk.ClmmSDK,n,BigInt(t.amount),i);return t.venft_id===void 0?n.moveCall({target:`${e.published_at}::${$o}::mint_and_convert`,typeArguments:[],arguments:[n.object(W(e).lock_manager_id),n.object(W(e).xtoken_manager_id),s,n.pure(t.amount)]}):n.moveCall({target:`${e.published_at}::${$o}::convert`,typeArguments:[],arguments:[n.object(W(e).lock_manager_id),n.object(W(e).xtoken_manager_id),s,n.pure(t.amount),n.pure(t.venft_id)]}),n}redeemLockPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${$o}::redeem_lock`,typeArguments:[],arguments:[n.pure(W(e).lock_manager_id),n.pure(W(e).xtoken_manager_id),n.pure(t.venft_id),n.pure(t.amount),n.pure(t.lock_day),n.pure(fe)]}),n}redeemPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${$o}::redeem`,typeArguments:[],arguments:[n.pure(W(e).lock_manager_id),n.pure(W(e).xtoken_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(fe)]}),n}redeemDividendPayload(t,e){const{xtoken_dividends:n}=this.sdk.sdkOptions,i=new Pe;return e.forEach(s=>{i.moveCall({target:`${n.published_at}::${Ad}::redeem`,typeArguments:[s],arguments:[i.object(W(n).dividend_manager_id),i.object(t)]})}),i}redeemDividendV2Payload(t,e,n){const{xtoken_dividends:i}=this.sdk.sdkOptions;let s=new Pe;return e.filter(r=>n.includes(r)).length>0&&(s=this.redeemDividendXTokenPayload(t,s)),e.forEach(r=>{n.includes(r)||s.moveCall({target:`${i.published_at}::${Ad}::redeem_v2`,typeArguments:[r],arguments:[s.object(W(i).dividend_manager_id),s.object(t),s.object(fe)]})}),s}redeemDividendXTokenPayload(t,e){const{xtoken_dividends:n,xtoken:i}=this.sdk.sdkOptions,{xtoken_manager_id:s,lock_manager_id:o}=W(i),{dividend_manager_id:r}=W(n);return e=e===void 0?new Pe:e,e.moveCall({target:`${n.published_at}::${Ad}::redeem_xtoken`,typeArguments:[],arguments:[e.object(o),e.object(s),e.object(r),e.object(t),e.object(fe)]}),e}buileTokenCoinType(){return`${this.sdk.sdkOptions.token_faucet.package_id}::token::TOKEN`}buileXTokenCoinType(t=this._sdk.sdkOptions.xtoken.package_id,e="xtoken",n="XTOKEN"){return`${t}::${e}::${n}`}cancelRedeemPayload(t){const{xtoken:e}=this.sdk.sdkOptions,n=new Pe;return n.moveCall({target:`${e.published_at}::${$o}::cancel_redeem_lock`,typeArguments:[],arguments:[n.pure(W(e).lock_manager_id),n.pure(W(e).xtoken_manager_id),n.pure(t.venft_id),n.pure(t.lock_id),n.pure(fe)]}),n}async getInitConfigs(){var r,a;const{package_id:t}=this.sdk.sdkOptions.xtoken,e=`${t}_getInitFactoryEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(r=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::xtoken::InitEvent`}))==null?void 0:r.data,s={xtoken_manager_id:"",lock_manager_id:"",lock_handle_id:""};i.length>0&&i.forEach(c=>{const u=c.parsedJson;u&&(s.xtoken_manager_id=u.xtoken_manager)});const o=(a=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::locking::InitializeEvent`}))==null?void 0:a.data;return o.length>0&&o.forEach(c=>{const u=c.parsedJson;u&&(s.lock_manager_id=u.lock_manager)}),s.lock_handle_id=(await this.getLockUpManager(s.lock_manager_id)).lock_infos.lock_handle_id,this.updateCache(e,s,Ee),s}async getLockUpManager(t=W(this.sdk.sdkOptions.xtoken).lock_manager_id,e=!1){const n=`${t}_getLockUpManagerEvent`,i=this.getCache(n,e);if(i!==void 0)return i;const s=await this.sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=Fs.buildLockUpManager(je(s));return this.updateCache(n,o,Ee),o}async getLockInfoHandle(t){const e=`${t}_getLockInfoHandle`,n=this.getCache(e);if(n!==void 0)return n;let i="";const s=await this.sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0}}),o=je(s);return o&&(i=o.lock_infos.fields.id.id,this.updateCache(e,i,Ee)),i}async getDividendConfigs(){var o;const{package_id:t}=this.sdk.sdkOptions.xtoken_dividends,e=`${t}_getDividendManagerEvent`,n=this.getCache(e);if(n!==void 0)return n;const i=(o=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::dividend::InitEvent`}))==null?void 0:o.data,s={dividend_manager_id:"",dividend_admin_id:"",dividend_settle_id:""};return i.length>0&&i.forEach(r=>{const a=r.parsedJson;a&&(s.dividend_manager_id=a.manager_id,s.dividend_admin_id=a.admin_id,s.dividend_settle_id=a.settle_id,this.updateCache(e,s,Ee))}),s}async getDividendManager(t=!1){const{dividend_manager_id:e}=W(this.sdk.sdkOptions.xtoken_dividends),n=`${e}_getDividendManager`,i=this.getCache(n,t);if(i!==void 0)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=je(s),r=Fs.buildDividendManager(o);return this.updateCache(n,r,Ee),r}async getXcetusManager(t=!0){const{xtoken_manager_id:e}=W(this.sdk.sdkOptions.xtoken),n=`${e}_getXcetusManager`,i=this.getCache(n,t);if(i)return i;const s=await this._sdk.ClmmSDK.fullClient.getObject({id:e,options:{showContent:!0}}),o=je(s),r={id:o.id.id,index:Number(o.index),has_venft:{handle:o.has_venft.fields.id.id,size:o.has_venft.fields.size},nfts:{handle:o.nfts.fields.id.id,size:o.nfts.fields.size},total_locked:o.total_locked,treasury:o.treasury.fields.total_supply.fields.value};return this.updateCache(n,r),r}async getVeNFTDividendInfo(t,e){try{const n=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=je(n);return Fs.buildVeNFTDividendInfo(i)}catch{return}}async redeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=U(ri).mul(U(n.max_lock_day).sub(U(e))).mul(U(n.max_percent_numerator).sub(U(n.min_percent_numerator))).div(U(n.max_lock_day).sub(U(n.min_lock_day))),s=U(ri).mul(U(n.max_percent_numerator)).sub(i).div(U(cu)).div(ri);return{amountOut:U(s).mul(U(t)).round().toString(),percent:s.toString()}}async reverseRedeemNum(t,e){if(BigInt(t)===BigInt(0))return{amountOut:"0",percent:"0"};const n=await this.getLockUpManager(),i=U(ri).mul(U(n.max_lock_day).sub(U(e))).mul(U(n.max_percent_numerator).sub(U(n.min_percent_numerator))).div(U(n.max_lock_day).sub(U(n.min_lock_day))),s=U(ri).mul(U(n.max_percent_numerator)).sub(i).div(U(cu)).div(ri);return{amountOut:U(t).div(s).toFixed(0,ie.ROUND_UP),percent:s.toString()}}async getLockXToken(t){const{lock_handle_id:e}=W(this._sdk.sdkOptions.xtoken),n=`${t}_getXTokenAmount`,i=this.getCache(n);if(i)return i;try{const s=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:e,name:{type:"0x2::object::ID",value:t}}),o=je(s);if(o){const r=o.value.fields.value.fields;return this.updateCache(n,r,Ee),r}}catch{}}async getVeNftAmount(t,e){try{const n=await this.sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:t,name:{type:"0x2::object::ID",value:e}}),i=je(n);if(i){const{lock_amount:s,xtoken_amount:o}=i.value.fields.value.fields;return{lock_amount:s,xtoken_amount:o}}}catch{}return{lock_amount:"0",xtoken_amount:"0"}}async getPhaseDividendInfo(t,e=!1){const i=(await this.getDividendManager()).dividends.id,s=`${i}_${t}_getPhaseDividendInfo`,o=this._sdk.getCache(s,e);if(o)return o;try{const r=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:i,name:{type:"u64",value:t}}),a=je(r),c=a.value.fields.value.fields,u=c.redeemed_num.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),l=c.bonus_types.map(g=>g.fields.name),d=c.bonus.fields.contents.map(g=>({name:g.fields.key.fields.name,value:g.fields.value})),p={id:Di(r),phase:a.name,settled_num:c.settled_num,register_time:c.register_time,redeemed_num:u,is_settled:c.is_settled,bonus_types:l,bonus:d,phase_end_time:""};return this.updateCache(s,p),p}catch{}}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},b4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async addMasterLiquidity(t){var w,T;const{liquidity_stratefy:e}=this._sdk.sdkOptions,{clmm_pool:n}=this._sdk.ClmmSDK.sdkOptions,i=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);let s=U(0),o=U(0);const r=[],a=[],c=[],u=[],l=[];t.liquidity_bins.forEach((E,P)=>{const k=t.amounts_a[P],S=t.amounts_b[P],$=t.bins_fix_amount_a[P];s=s.add(k),o=o.add(S),r.push(k),a.push(S),c.push(En(BigInt(E.tick_lower)).toString()),u.push(En(BigInt(E.tick_upper)).toString()),l.push($)});const d=[t.coinTypeA,t.coinTypeB],p=new Pe,g=(w=tt.buildAddLiquidityFixTokenCoinInput(p,!t.fix_amount_a,s.toString(),t.slippage,t.coinTypeA,i,!1))==null?void 0:w.targetCoin,b=(T=tt.buildAddLiquidityFixTokenCoinInput(p,t.fix_amount_a,o.toString(),t.slippage,t.coinTypeB,i,!1))==null?void 0:T.targetCoin;return g4(t)?p.moveCall({target:`${e.published_at}::router::increase_liquidity`,typeArguments:d,arguments:[p.object(W(e).master_manger_id),p.object(t.master_address),p.object(W(n).global_config_id),p.object(t.pool_address),g,b,p.makeMoveVec({type:"u64",objects:r.map(E=>p.pure(E,"u64"))}),p.makeMoveVec({type:"u64",objects:a.map(E=>p.pure(E,"u64"))}),p.makeMoveVec({type:"bool",objects:l.map(E=>p.pure(E,"bool"))}),p.object(fe)]}):p.moveCall({target:`${e.published_at}::router::create_master_liquidity`,typeArguments:d,arguments:[p.object(W(e).master_manger_id),p.object(W(n).global_config_id),p.object(t.pool_address),g,b,p.makeMoveVec({type:"u32",objects:c.map(E=>p.pure(E,"u32"))}),p.makeMoveVec({type:"u32",objects:u.map(E=>p.pure(E,"u32"))}),p.makeMoveVec({type:"u64",objects:r.map(E=>p.pure(E,"u64"))}),p.makeMoveVec({type:"u64",objects:a.map(E=>p.pure(E,"u64"))}),p.makeMoveVec({type:"bool",objects:l.map(E=>p.pure(E,"bool"))}),p.pure(t.strategy),p.pure(En(BigInt(t.tick_lower)).toString()),p.pure(En(BigInt(t.tick_upper)).toString()),p.object(fe)]}),p}buildMasterNFTType(){return`${this._sdk.sdkOptions.liquidity_stratefy.package_id}::master_liquidity::MasterLiquidity`}async getMasterNFTList(t,e=[]){const n=[],i=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0},filter:{Package:this._sdk.sdkOptions.liquidity_stratefy.package_id}}),s=e.length>0;for(const o of i.data)if(ae(o.data.type).full_address===this.buildMasterNFTType()){const a=zi.buildMasterNFT(o);if(a){const c=`${a.id}_masterNFT`;this.updateCache(c,a,Ee),s?e.includes(a.pool_id)&&n.push(a):n.push(a)}}return n}async getMasterNFT(t,e=!1){const n="$masterId}_masterNFT",i=this.getCache(n,e);if(i)return i;try{const s=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}});if(ae(s.data.type).full_address===this.buildMasterNFTType()){const r=zi.buildMasterNFT(s);return r&&this.updateCache(n,r,Ee),r}}catch(s){console.log(s)}}async fetchMasterPositionInfos(t){var a;const e={},{clmm_pool:n,integrate:i,simulationAccount:s}=this.sdk.ClmmSDK.sdkOptions,o=new Pe;return t.forEach(c=>{c.position_ids.forEach(u=>{const l=[c.coinTypeA,c.coinTypeB],d=[o.object(W(n).global_config_id),o.object(c.pool_id),o.object(u)];o.moveCall({target:`${i.published_at}::${di}::fetch_position_fees`,arguments:d,typeArguments:l}),o.moveCall({target:`${i.published_at}::${di}::fetch_position_rewards`,arguments:[...d,o.object(fe)],typeArguments:l})})}),(a=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:o,sender:s.address})).events)==null||a.forEach(c=>{const{parsedJson:u}=c,{position_id:l}=u;let d=e[l];switch(d===void 0&&(d={position_id:l,feeOwedA:"0",feeOwedB:"0",rewarders:[]},e[l]=d),ae(c.type).name){case"FetchPositionFeesEvent":d.feeOwedA=u.fee_owned_a,d.feeOwedB=u.fee_owned_b;break;case"FetchPositionRewardsEvent":d.rewarders=u.data;break}}),e}async getLiquidityStrategyConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.liquidity_stratefy,n=`${e}_getLiquidityStrategyConfigst`,i=this.getCache(n,t);if(i!==void 0)return i;const s=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::master_liquidity::MasterLiquidityManagerCreatedEvent`})).data,o={master_manger_id:"",master_liquidity_handle:""};if(s.length>0){for(const r of s){const a=r.parsedJson;o.master_manger_id=a.id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:a.id,options:{showContent:!0}}),u=je(c);o.master_liquidity_handle=u.position_maps.fields.id.id;break}this.updateCache(n,o,Ee)}return o}removeMasterLiquidity(t){const{clmm_pool:e}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new Pe,s=[t.coinTypeA,t.coinTypeB];this.collectReward({coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collect_fee:!1,rewarder_coin_types:t.rewarder_coin_types,master_address:t.master_address,pool_address:t.pool_address},i);const o=[i.object(W(n).master_manger_id),i.object(t.pool_address),i.object(t.master_address),i.object(W(e).global_config_id),i.makeMoveVec({type:"u128",objects:t.delta_liquidities.map(r=>i.pure(r,"u128"))}),i.makeMoveVec({type:"u64",objects:t.min_amounts_a.map(r=>i.pure(r,"u64"))}),i.makeMoveVec({type:"u64",objects:t.min_amounts_b.map(r=>i.pure(r,"u64"))}),i.object(fe)];return i.moveCall({target:`${n.published_at}::${pc}::remove_liquidity`,typeArguments:s,arguments:o}),i}closeMasterLiquidity(t){const{clmm_pool:e}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:n}=this.sdk.sdkOptions,i=new Pe,s=[t.coinTypeA,t.coinTypeB];return this.collectReward({coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collect_fee:!1,rewarder_coin_types:t.rewarder_coin_types,master_address:t.master_address,pool_address:t.pool_address},i),i.moveCall({target:`${n.published_at}::${pc}::close_master_liquidity`,typeArguments:s,arguments:[i.object(W(n).master_manger_id),i.object(t.master_address),i.object(W(e).global_config_id),i.object(t.pool_address),i.makeMoveVec({type:"u64",objects:t.min_amounts_a.map(o=>i.pure(o,"u64"))}),i.makeMoveVec({type:"u64",objects:t.min_amounts_b.map(o=>i.pure(o,"u64"))}),i.object(fe)]}),i}collectFee(t,e){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;e=e===void 0?new Pe:e;const s=[t.coinTypeA,t.coinTypeB],o=[e.object(W(i).master_manger_id),e.object(t.master_address),e.object(W(n).global_config_id),e.object(t.pool_address)];return e.moveCall({target:`${i.published_at}::${pc}::collect_fee`,typeArguments:s,arguments:o}),e}collectReward(t,e){const{clmm_pool:n}=this.sdk.ClmmSDK.sdkOptions,{liquidity_stratefy:i}=this.sdk.sdkOptions;return e=e===void 0?new Pe:e,t.collect_fee&&this.collectFee({...t},e),t.rewarder_coin_types.forEach(s=>{const o=[t.coinTypeA,t.coinTypeB,s];if(e){const r=[e.object(W(i).master_manger_id),e.object(t.master_address),e.object(W(n).global_config_id),e.object(t.pool_address),e.object(W(n).global_vault_id),e.object(fe)];e.moveCall({target:`${i.published_at}::${pc}::collect_reward`,typeArguments:o,arguments:r})}}),e}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},v4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}buildCoinInput(t,e,n,i,s){const{selectedCoins:o,remainingCoins:r}=Tt.selectCoinAssetGreaterThanOrEqual(e,BigInt(i)),a=Tt.calculateTotalBalance(o);if(a<BigInt(i))throw new Error(`The amount(${a}) is Insufficient balance for ${n} , expect ${i} `);const c=a-BigInt(i);let u;if(Tt.isSuiCoin(n))u=t.splitCoins(t.gas,[t.pure(i)]);else{const[l,...d]=o.map(p=>p.coinObjectId);u=t.object(l),d.length>0?s?t.mergeCoins(u,[...d.map(p=>t.object(p)),s]):t.mergeCoins(u,[...d.map(p=>t.object(p))]):s&&t.mergeCoins(u,[s])}return{selectedUnusedAmount:c,coinInput:u,remainingCoins:r}}async deposit(t){var c,u;console.log("1110 deposit 参数: ",{params:t});const{vaults:e}=this._sdk.sdkOptions,{clmm_pool:n}=this._sdk.ClmmSDK.sdkOptions,i=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress()),s=new Pe;let o,r;if(t.swapParams){const l=await this.handleDepositSwap(t,s,i);o=l.primaryCoinAInputs,r=l.primaryCoinBInputs}else o=(c=tt.buildAddLiquidityFixTokenCoinInput(s,!t.fix_amount_a,t.amount_a,t.slippage,t.coinTypeA,i,!1))==null?void 0:c.targetCoin,r=(u=tt.buildAddLiquidityFixTokenCoinInput(s,t.fix_amount_a,t.amount_b,t.slippage,t.coinTypeB,i,!1))==null?void 0:u.targetCoin;const a=t.rewarder_coin_types?t.rewarder_coin_types.length:0;if(a>0){const l=["deposit_with_one","deposit_with_two","deposit_with_three"];s.moveCall({target:`${e.published_at}::${kd}::${l[a-1]}`,typeArguments:[t.coinTypeA,t.coinTypeB,...t.rewarder_coin_types,t.lp_token_type],arguments:[s.object(W(e).vaults_manager_id),s.object(t.vault_id),s.object(W(n).global_config_id),s.object(t.clmm_pool),s.object(W(n).global_vault_id),o,r,s.pure(t.amount_a),s.pure(t.amount_b),s.pure(t.fix_amount_a),s.object(fe)]})}else s.moveCall({target:`${e.published_at}::${kd}::deposit`,typeArguments:[t.coinTypeA,t.coinTypeB,t.lp_token_type],arguments:[s.object(W(e).vaults_manager_id),s.object(t.vault_id),s.object(W(n).global_config_id),s.object(t.clmm_pool),o,r,s.pure(t.amount_a),s.pure(t.amount_b),s.pure(t.fix_amount_a),s.object(fe)]});return s}async handleDepositSwap(t,e,n){const{clmm_pool:i,integrate:s}=this._sdk.ClmmSDK.sdkOptions,{swap_amount:o,a2b:r,route_obj:a}=t.swapParams,c=r?t.coinTypeA:t.coinTypeB,u=tt.buildCoinForAmount(e,n,BigInt(o),c,!1),l=BigInt(u.tragetCoinAmount)-BigInt(o),d=tt.buildCoinForAmount(e,n,0n,r?t.coinTypeB:t.coinTypeA,!1);let p=[];if(a){const E=await tt.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,a,u,d,"",t.slippage,e);p=r?[E.fromCoin,E.toCoin]:[E.toCoin,E.fromCoin],d.isMintZeroCoin||e.transferObjects([d.targetCoin],e.pure(this._sdk.getVerifySenderAddress()))}else{const E=Gi.getDefaultSqrtPriceLimit(r).toString();p=e.moveCall({target:`${s.published_at}::${ir}::swap`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(W(i).global_config_id),e.object(t.clmm_pool),r?u.targetCoin:d.targetCoin,r?d.targetCoin:u.targetCoin,e.pure(r),e.pure(!0),e.pure(o),e.pure(E),e.pure(!1),e.object(fe)]})}let g,b;const w=p[0],T=p[1];if(r){const E=BigInt(t.amount_a)-l;Tt.isSuiCoin(c)?(e.transferObjects([w],e.pure(this._sdk.getVerifySenderAddress())),g=e.splitCoins(e.gas,[e.pure(t.amount_a)])):E>0n?g=this.buildCoinInput(e,u.remainCoins,c,E,w).coinInput:g=w,b=T}else{g=w;const E=BigInt(t.amount_b)-l;Tt.isSuiCoin(c)?(e.transferObjects([T],e.pure(this._sdk.getVerifySenderAddress())),b=e.splitCoins(e.gas,[e.pure(t.amount_b)])):E>0n?b=this.buildCoinInput(e,u.remainCoins,c,E,T).coinInput:b=T}return{primaryCoinAInputs:g,primaryCoinBInputs:b}}async remove(t){console.log({params:t});const{vaults:e}=this.sdk.sdkOptions,{clmm_pool:n,integrate:i}=this._sdk.ClmmSDK.sdkOptions,s=new Pe,o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.getVerifySenderAddress(),t.lp_token_type),r=tt.buildCoinForAmount(s,o,BigInt(t.lp_token_amount),t.lp_token_type,!1).targetCoin,a=[t.coinTypeA,t.coinTypeB,t.lp_token_type],c=t.rewarder_coin_types.length;if(c>0){const u=["remove_with_one","remove_with_two","remove_with_three"];s.moveCall({target:`${e.published_at}::${kd}::${u[c-1]}`,typeArguments:[t.coinTypeA,t.coinTypeB,...t.rewarder_coin_types,t.lp_token_type],arguments:[s.object(W(e).vaults_manager_id),s.object(t.vault_id),s.object(W(n).global_config_id),s.object(t.clmm_pool),s.object(W(n).global_vault_id),r,s.pure(t.lp_token_amount),s.pure(t.min_amount_a),s.pure(t.min_amount_b),s.object(fe)]})}else{const u=s.moveCall({target:`${e.published_at}::${m4}::remove`,typeArguments:a,arguments:[s.object(W(e).vaults_manager_id),s.object(t.vault_id),s.object(W(n).global_config_id),s.object(t.clmm_pool),r,s.pure(t.lp_token_amount),s.pure(t.min_amount_a),s.pure(t.min_amount_b),s.object(fe)]}),l=u[0],d=u[1];if(t.swapParams){const{a2b:p,swap_amount:g,route_obj:b}=t.swapParams;if(b){const w={targetCoin:p?l:d,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},T={targetCoin:p?d:l,remainCoins:[],isMintZeroCoin:!1,tragetCoinAmount:""},E=await tt.buildAggregatorSwapReturnCoins(this._sdk.ClmmSDK,b,w,T,"",t.slippage,s),P=p?[E.fromCoin,E.toCoin]:[E.toCoin,E.fromCoin];s.moveCall({target:"0x2::coin::destroy_zero",arguments:[E.fromCoin],typeArguments:[p?t.coinTypeA:t.coinTypeB]}),p?(s.mergeCoins(P[1],[d]),s.transferObjects([P[1]],s.pure(this._sdk.getVerifySenderAddress()))):(s.mergeCoins(P[0],[l]),s.transferObjects([P[0]],s.pure(this._sdk.getVerifySenderAddress())))}else{const w=Gi.getDefaultSqrtPriceLimit(p).toString(),T=s.moveCall({target:`${i.published_at}::${ir}::swap`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[s.object(W(n).global_config_id),s.object(t.clmm_pool),l,d,s.pure(p),s.pure(!0),s.pure(g),s.pure(w),s.pure(!0),s.object(fe)]});s.transferObjects([T[0],T[1]],s.pure(this._sdk.getVerifySenderAddress()))}}else s.transferObjects([l,d],s.pure(this._sdk.getVerifySenderAddress()))}return s}async getVaultList(t="all"){const{vaults:e}=this._sdk.sdkOptions,n=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e.package_id}::vaults::CreateEvent`},t),i=n.data.map(r=>r.parsedJson.id),s=await this._sdk.ClmmSDK.fullClient.batchGetObjects(i,{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}),o=[];return s.forEach(r=>{const a=Hi.buildPool(r);a&&(this.savePoolToCache(a),o.push(a))}),n.data=o,n}savePoolToCache(t){const e=`${t.id}_mirrorPool`;this.updateCache(e,t,Ee)}readPoolFromCache(t,e=!1){const n=`${t}_mirrorPool`;return this.getCache(n,e)}async calculateMaxAvailable(t){var w;const{integrate:e,simulationAccount:n}=this.sdk.ClmmSDK.sdkOptions,i=new Pe,s=Se.tickIndexToSqrtPriceX64(t.lowerTick),o=Se.tickIndexToSqrtPriceX64(t.upperTick),r=new y(t.curSqrtPrice),a=It.getCoinAmountFromLiquidity(new y(t.input_amount),r,s,o,!1),c=[t.coinTypeA,t.coinTypeB];i.moveCall({target:`${e.published_at}::${di}::calculate_swap_result`,arguments:[i.object(t.clmm_pool),i.pure(!0),i.pure(!0),i.pure(a.coinA.toString())],typeArguments:c}),i.moveCall({target:`${e.published_at}::${di}::calculate_swap_result`,arguments:[i.object(t.clmm_pool),i.pure(!1),i.pure(!0),i.pure(a.coinB.toString())],typeArguments:c});const l=(w=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:i,sender:n.address})).events)==null?void 0:w.filter(T=>ae(T.type).name==="CalculatedSwapResultEvent");if(l.length===0)return null;const d=l[0].parsedJson.data,p=l[1].parsedJson.data,g=U(a.coinB.toString()).add(d.amount_out),b=U(a.coinA.toString()).add(p.amount_out);return{maxAmountB:g,maxAmountA:b}}async calculateRemoveSwapAmount(t,e){const n=Hi.calculateDepositRatio(t.lowerTick,t.upperTick,new y(t.curSqrtPrice)),i=t.fix_amount_a?n.ratioA:n.ratioB;console.log({fixRatio:i});let s=U(t.receive_amount).mul(i),o,r;if(t.removeLiquidity){const w=Se.tickIndexToSqrtPriceX64(t.lowerTick),T=Se.tickIndexToSqrtPriceX64(t.upperTick),E=It.getCoinAmountFromLiquidity(new y(t.removeLiquidity),new y(t.curSqrtPrice),w,T,!1);r=t.removeLiquidity,o=t.fix_amount_a?E.coinB.toString():E.coinA.toString(),s=t.fix_amount_a?U(E.coinA.toString()):U(E.coinB.toString())}else{const w=It.estLiquidityAndcoinAmountFromOneAmounts(t.lowerTick,t.upperTick,new y(s.toFixed(0)),t.fix_amount_a,!1,.2,new y(t.curSqrtPrice));r=w.liquidityAmount.toString(),o=t.fix_amount_a?w.coinAmountB.toString():w.coinAmountA.toString()}console.log({fixAmount:s,otherSideAmount:o});const a=!t.fix_amount_a,c=await this.clmmPreSwap(t.clmm_pool,t.curSqrtPrice,a,U(o),t.coinTypeA,t.coinTypeB,!0,t.priceSplitPoint,t.use_route,[{pool_id:t.clmm_pool,tick_lower:t.lowerTick,tick_upper:t.upperTick,delta_liquidity:Number(r),is_increase:!1}]);console.log({data:c,range:e});const u=s.add(c.amount_out),l=U(t.receive_amount),d=l.sub(u);if(console.log(`实际得到: ${u.toString()} , 期望得到: ${t.receive_amount}, 剩余: ${d.toString()} `),(!t.removeLiquidity||t.removeLiquidity&&e)&&d.abs().greaterThan(l.mul(.01))){const w=u.lessThan(l);let T,E;e?w?(T=U(r),E=e.right):(T=e.left,E=U(r)):(T=U(w?r:0),E=U(w?t.maxLiquidity:r));const P=U(T).add(E).div(2).toFixed(0);if(console.log({left:T.toString(),right:E.toString(),midLiquidity:P.toString()}),!e||e&&e.count<15&&T<E)return await this.calculateRemoveSwapAmount({...t,removeLiquidity:P},{left:T,right:E,count:e?e.count+1:0})}const p=c.amount_in&&c.fee_amount?new y(c.amount_in).add(new y(c.fee_amount)).toString():c.amount_in,g=c.amount_out,{is_exceed:b}=c;return{swapInAmount:p,swapOutAmount:g,liquidity:r,is_exceed:b,routeObj:c.route_obj,request_id:t.request_id}}async calculateDepositSwapAmount(t,e=!1){const n=Se.sqrtPriceX64ToTickIndex(new y(t.curSqrtPrice));console.log("1110 calculateDepositSwapAmount params: ",{...t,currentTick:n,adjustBestAmount:e});const{ratioA:i,ratioB:s}=Hi.calculateDepositRatio(t.lowerTick,t.upperTick,new y(t.curSqrtPrice)),o=U(t.input_amount).mul(t.fix_amount_a?i:s);let r=U(t.input_amount).sub(o);console.log("1110 ",{fixAmount:o.toString(),swapAmount:r.toString()});const a=t.fix_amount_a;if(r.toFixed(0)==="0")return null;const c=n<t.lowerTick||n>t.upperTick,u={clmm_pool:t.clmm_pool,curSqrtPrice:t.curSqrtPrice,a2b:a,amount_a:a?new ie(t.input_amount):new ie(0),amount_b:a?new ie(0):new ie(t.input_amount),amount_left:a?new ie(r.toFixed(0)):new ie(0),amount_right:a?new ie(t.input_amount):new ie(r.toFixed(0)),lowerTick:t.lowerTick,upperTick:t.upperTick,tick_spacing:2,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,useRoute:t.use_route,remainRate:t.remainRate?t.remainRate:.01,priceSplitPoint:t.priceSplitPoint},l=e&&n<=t.upperTick;let d=l?await this.calculateRebalance(u):await this.clmmPreSwap(t.clmm_pool,t.curSqrtPrice,a,r,t.coinTypeA,t.coinTypeB,!0,t.priceSplitPoint,t.use_route),p=d.after_sqrt_price;const g=Se.sqrtPriceX64ToTickIndex(new y(p));console.log("1110 首次计算 结果: ",{...d,currentTick:g},null,2);const b=g<t.lowerTick||g>t.upperTick;if(c!==b&&!l&&g<=t.upperTick){console.log("1110 区间发生变化, 再次进行swap: ");const{ratioA:H,ratioB:V}=Hi.calculateDepositRatio(t.lowerTick,t.upperTick,new y(p));console.log("1110 ",{newAfterRatioA:H,newAfterRatioB:V}),r=U(t.input_amount).sub(U(t.input_amount).mul(t.fix_amount_a?H:V)),u.amount_left=a?new ie(r.toFixed(0)):new ie(0),u.amount_right=a?new ie(t.input_amount):new ie(r.toFixed(0)),d=await this.calculateRebalance(u),p=d.after_sqrt_price;const z=Se.sqrtPriceX64ToTickIndex(new y(p));console.log("1110 再次计算变化后: ",{lowerTick:t.lowerTick,upperTick:t.upperTick,currentTick:z,afterSqrtPrice:p})}const{ratioA:w,ratioB:T}=Hi.calculateDepositRatio(t.lowerTick,t.upperTick,new y(p));console.log("1110 1",{afterRatioA:w,afterRatioB:T,data:d});let E=T.div(w).sub(s.div(i)).greaterThan("0");const P=d.amount_in&&d.fee_amount?new y(d.amount_in).add(new y(d.fee_amount)).toString():d.amount_in,k=d.amount_out,{is_exceed:S}=d;if(g<t.lowerTick)E=!0;else if(g>t.upperTick)E=!1;else{const H=E===a?new y(U(t.input_amount).sub(P).toString()):new y(k),V=It.estLiquidityAndcoinAmountFromOneAmounts(t.lowerTick,t.upperTick,H,E,!0,0,new y(p)),z=V.coinAmountA,X=V.coinAmountB,L=U(t.fix_amount_a?z.toString():X.toString()).add(P);console.log("1110 实际消耗:",{preAmountTotal:L.toString(),fixAmountA:E}),L.greaterThanOrEqualTo(t.input_amount)&&(E=!E)}const $={swapInAmount:P,swapOutAmount:k,afterSqrtPrice:p,is_exceed:S,fixAmountA:E,routeObj:d.route_obj,request_id:t.request_id};return console.log($),$}async calculateRebalance(t){const{clmm_pool:e,a2b:n,curSqrtPrice:i,amount_a:s,amount_b:o,lowerTick:r,upperTick:a,amount_left:c,amount_right:u,coinTypeA:l,coinTypeB:d,useRoute:p,priceSplitPoint:g,remainRate:b}=t,w=async(T,E,P)=>{const k=T.plus(E).div(2),S=await this.clmmPreSwap(e,i,n,k,l,d,!0,g,p);if(S.amount_out==="0")return S;if(S.after_sqrt_price||(S.after_sqrt_price=t.curSqrtPrice),S.is_exceed)return E=k,w(T,E,P+1);const $=n?s.sub(S.amount_in):s.add(S.amount_out),H=n?o.add(S.amount_out):o.sub(S.amount_in),V=Se.sqrtPriceX64ToTickIndex(new y(S.after_sqrt_price)),z=It.estLiquidityAndcoinAmountFromOneAmounts(r,a,new y($.toString()),!0,!0,1,new y(S.after_sqrt_price)),X=new ie(z.coinAmountA.toString()),L=new ie(z.coinAmountB.toString());if(console.log("1110 swap递归计算 ",{preRes:S,left:T.toString(),right:E.toString(),mid:k.toString(),afterPoolTickIndex:V,afterA:$.toString(),afterB:H.toString(),usedA:X.toString(),usedB:toString(),count:P}),X.toString()!==$.toString())throw new Error("usedA does not match afterA");if(H.lessThan(L))n?T=k:E=k;else{n?E=k:T=k;const B=H.sub(L),O=H.mul(b);if(console.log("1110 剩余未使用amount ",{remainingB:B.toString(),maxRemainingB:O.toString(),remainRate:b,count:P}),O.sub(B).greaterThanOrEqualTo(0))return console.log("break"),{...S,remainingB:B}}return T.greaterThan(E)||E.sub(T).lessThan(10)?S:w(T,E,P+1)};return c.greaterThanOrEqualTo(u)?w(new ie(0),c,0):w(c,u,0)}async clmmPreSwap(t,e,n,i,s,o,r,a,c,u){var E;if(c)try{const P=await this._sdk.ClmmSDK.RouterV2.getBestRouter(n?s:o,n?o:s,Number(i.toFixed(0)),r,a,"",void 0,void 0,!0,!1,u);if(!P.result)throw new Error("route unavailable");const{result:k}=P;let S=e;return k.splitPaths.forEach($=>{const H=$.basePaths.find(V=>V.poolAddress.toLowerCase()===t.toLowerCase());H&&(S=H.afterSqrtPrice.toString())}),{amount_in:k.inputAmount.toString(),amount_out:k.outputAmount.toString(),after_sqrt_price:S,is_exceed:k.isExceed,route_obj:k}}catch{throw new Error("route unavailable")}const{integrate:l,simulationAccount:d}=this.sdk.ClmmSDK.sdkOptions,p=new Pe,g=[s,o],b=[p.pure(t),p.pure(n),p.pure(r),p.pure(i.toFixed(0))];p.moveCall({target:`${l.published_at}::${di}::calculate_swap_result`,arguments:b,typeArguments:g});const T=(E=(await this.sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:p,sender:d.address})).events)==null?void 0:E.filter(P=>ae(P.type).name==="CalculatedSwapResultEvent");return T.length===0?null:T[0].parsedJson.data}async getVault(t,e=!1){const n=this.readPoolFromCache(t,e);if(n)return n;try{const i=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0,showDisplay:!0,showOwner:!0}}),s=Hi.buildPool(i);if(s)return this.savePoolToCache(s),s}catch(i){console.log(i)}}async getVaultsConfigs(t=!1){const{package_id:e}=this._sdk.sdkOptions.vaults,n=`${e}_getMirrorPoolConfigs`,i=this.getCache(n,t);if(i!==void 0)return i;const s=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::vaults::InitEvent`})).data,o={admin_cap_id:"",vaults_manager_id:"",vaults_pool_handle:""};if(s.length>0){for(const r of s){const a=r.parsedJson;o.admin_cap_id=a.admin_cap_id,o.vaults_manager_id=a.manager_id;const c=await this._sdk.ClmmSDK.fullClient.getObject({id:o.vaults_manager_id,options:{showContent:!0}}),u=je(c);o.vaults_pool_handle=u.vault_to_pool_maps.fields.id.id;break}this.updateCache(n,o,Ee)}return o}updateCache(t,e,n=Vn){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},fc=class{static buildOrderLimitEvent(t){const{events:e}=t,n=[];return e&&e.forEach(i=>{const s=ae(i.type).name;if(s==="OrderPlacedEvent"||s==="OrderCanceledEvent"||s==="FlashLoanEvent"){const o={digest:t.digest,type:s,timestampMs:t.timestampMs,parsedJson:i.parsedJson};n.push(o)}}),n}static buildLimitOrderInfo(t){const e=je(t),n=ro(t);if(e&&n)try{const i=ae(n),s={pay_coin_type:i.type_arguments[0],target_coin_type:i.type_arguments[1],balance:e.balance,canceled_ts:e.canceled_ts==="18446744073709551615"?0:Number(e.canceled_ts),id:e.id.id,obtained_amount:e.obtained_amount,owner:e.owner,rate:e.rate,expire_ts:Number(e.expire_ts),total_pay_amount:e.total_pay_amount,status:"Running",created_ts:Number(e.created_ts)};if(s.canceled_ts===0)s.status="Running";else if(Number(s.obtained_amount)===0)s.status="Cancelled";else{const o=U(s.total_pay_amount).mul(1e20).div(s.rate).toFixed(0);s.obtained_amount===o?s.status="Completed":s.status="Cancelled"}return s}catch(i){console.log(i)}}static calculateFormatRate(t,e,n){const i=20+e-n;return U(t).mul(U(10).pow(i)).toString()}static calculateRate(t,e,n){const i=20+e-n;return Number(t)/10**i}},T4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getLimitOrderTokenList(){const{limit_order:t}=this._sdk.sdkOptions,{token_list_handle:e}=W(t),{fullClient:n}=this._sdk.ClmmSDK,s=(await n.getDynamicFieldsByPage(e)).data.map(r=>r.objectId);return(await n.batchGetObjects(s,{showContent:!0})).map(r=>{const{fields:a}=r.data.content;return{coin_type:ae(a.name.fields.name).full_address,min_trade_amount:Number(a.value)}})}async getLimitOrderPoolList(){const{limit_order:t}=this._sdk.sdkOptions,{rate_orders_indexer_handle:e}=W(t),{fullClient:n}=this._sdk.ClmmSDK,s=(await n.getDynamicFieldsByPage(e)).data.map(r=>r.objectId);return(await n.batchGetObjects(s,{showContent:!0})).map(r=>{const{fields:a}=r.data.content.fields.value,c={pay_coin_type:ae(a.pay_coin.fields.name).full_address,target_coin_type:ae(a.target_coin.fields.name).full_address,indexer_id:a.indexer_id};return this._sdk.updateCache(`${c.pay_coin_type}_${c.target_coin_type}`,c.indexer_id),c})}async getPoolIndexerId(t,e){const n=this._sdk.getCache(`${t}_${e}`);try{if(n===void 0){const s=(await this.getLimitOrderPoolList()).filter(o=>o.pay_coin_type===t&&o.target_coin_type===e);if(s.length>0)return s[0].indexer_id}}catch{}return n}async getOwnerLimitOrderList(t,e){const{fullClient:n}=this._sdk.ClmmSDK,i={data:[],hasNextPage:!1};try{const s=await this.getUserIndexerHandle(t);if(!s)return i;const o=await n.getDynamicFieldsByPage(s,e);i.hasNextPage=o.hasNextPage,i.nextCursor=o.nextCursor;const r=o.data.map(u=>u.name.value),c=(await n.batchGetObjects(r,{showContent:!0})).map(u=>fc.buildLimitOrderInfo(u)).filter(u=>u!==void 0);i.data=c}catch(s){console.error("Error in getOwnerLimitOrderList:",s)}return i}async getLimitOrderConfigs(){const{package_id:t}=this._sdk.sdkOptions.limit_order,e={rate_orders_indexer_id:"",rate_orders_indexer_handle:"",global_config_id:"",token_list_handle:"",user_orders_indexer_id:"",user_orders_indexer_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::limit_order::InitEvent`})).data;if(n.length>0){const s=n[0].parsedJson;e.rate_orders_indexer_id=s.rate_orders_indexer_id,e.user_orders_indexer_id=s.user_orders_indexer_id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e.rate_orders_indexer_id,options:{showContent:!0}});e.rate_orders_indexer_handle=je(o).list.fields.id.id;const r=await this._sdk.ClmmSDK.fullClient.getObject({id:e.user_orders_indexer_id,options:{showContent:!0}});e.user_orders_indexer_handle=je(r).indexer.fields.id.id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitFactoryEvent`})).data;if(i.length>0){const s=i[0].parsedJson;e.global_config_id=s.global_config_id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e.global_config_id,options:{showContent:!0}}),r=je(o);e.token_list_handle=r.token_white_list.fields.id.id}return e}async getLimitOrder(t){const{fullClient:e}=this._sdk.ClmmSDK;try{const n=await e.getObject({id:t,options:{showContent:!0}});return fc.buildLimitOrderInfo(n)}catch(n){console.error("Error in getLimitOrder:",n);return}}async getLimitOrderLogs(t){const{fullClient:e}=this._sdk.ClmmSDK;try{const n=await e.queryTransactionBlocks({filter:{ChangedObject:t},options:{showEvents:!0}}),i=[];return n.data.forEach(s=>{i.push(...fc.buildOrderLimitEvent(s))}),i}catch(n){return console.error("Error in getLimitOrderLogs:",n),[]}}buildRateOrdersIndexerType(t){const{limit_order:e}=this._sdk.sdkOptions;return su(`${e.package_id}::limit_order::RateOrdersIndexer`,[t.pay_coin_type,t.target_coin_type])}async placeLimitOrder(t){const{limit_order:e}=this._sdk.sdkOptions,{user_orders_indexer_id:n,global_config_id:i,rate_orders_indexer_id:s}=W(e),o=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress,t.pay_coin_type),r=new Pe,a=await this.getPoolIndexerId(t.pay_coin_type,t.target_coin_type),c=tt.buildCoinForAmount(r,o,BigInt(t.pay_coin_amount),t.pay_coin_type,!1,!0);return r.moveCall({target:`${e.published_at}::limit_order::${a===void 0?"create_indexer_and_place_limit_order":"place_limit_order"}`,typeArguments:[t.pay_coin_type,t.target_coin_type],arguments:[r.object(i),a===void 0?r.object(s):r.object(a),r.object(n),c.targetCoin,r.pure(fc.calculateFormatRate(t.rate,t.pay_decimal,t.target_decimal)),r.pure(t.expired_ts),r.object(fe)]}),r}async cancelOrdersByOwner(t){const{limit_order:e}=this._sdk.sdkOptions,{global_config_id:n}=W(e),i=new Pe,s=await this.getPoolIndexerId(t.pay_coin_type,t.target_coin_type);if(s===void 0)throw Error("not found indexerId");return t.order_ids.forEach(o=>{i.moveCall({target:`${e.published_at}::limit_order::cancel_order_by_owner`,typeArguments:[t.pay_coin_type,t.target_coin_type],arguments:[i.object(n),i.object(s),i.object(o),i.object(fe)]})}),i}async getUserIndexerHandle(t){const{fullClient:e}=this._sdk.ClmmSDK,{limit_order:n}=this._sdk.sdkOptions;let i=this.getUserIndexerHandleByCache(t);if(i===void 0){const s=new Pe;s.moveCall({target:`${n.published_at}::limit_order::get_orders_indexer_by_owner`,typeArguments:[],arguments:[s.pure(t),s.object(W(n).user_orders_indexer_id)]}),i=(await e.devInspectTransactionBlock({transactionBlock:s,sender:this._sdk.ClmmSDK.sdkOptions.simulationAccount.address})).events[0].parsedJson.orders_table_id,i&&this.saveUserIndexerHandleByCache(t,i)}return i}getUserIndexerHandleByCache(t){const e=`getUserIndexerHandleByCache_${t}`;return this.getCache(e)}saveUserIndexerHandleByCache(t,e){const n=`getUserIndexerHandleByCache_${t}`;return this.updateCache(n,e)}updateCache(t,e,n=Ee){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t],i=n==null?void 0:n.isValid();if(!e&&i)return n.value;i||delete this._cache[t]}},A4=class{constructor(t){xe(this,"_sdk");xe(this,"_cache",{});this._sdk=t}get sdk(){return this._sdk}async getFramsPoolList(t="all"){const{package_id:e}=this._sdk.sdkOptions.frams,n={data:[],hasNextPage:!1};try{const i=await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${e}::pool::CreatePoolEvent`},t),s=i.data.map(o=>o.parsedJson.pool_id);if(n.hasNextPage=i.hasNextPage,n.nextCursor=i.nextCursor,s.length>0){const o=await this._sdk.ClmmSDK.fullClient.batchGetObjects(s,{showType:!0,showContent:!0});for(const r of o){const a=Qr.buildFramsPool(r);a&&(a.rewarders=await this.getFramsRewarderConfig(a.clmm_pool_id,a.rewarders.map(c=>c.reward_coin)),n.data.push(a),this.updateCache(a.id,a))}}}catch(i){console.log("getFramsPoolList error ",i)}return n}async getFramsPool(t,e=!1){const n=this.getCache(t,e);if(n)return n;const i=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showType:!0,showContent:!0}}),s=Qr.buildFramsPool(i.data);return s&&(s.rewarders=await this.getFramsRewarderConfig(s.clmm_pool_id,s.rewarders.map(o=>o.reward_coin)),this.updateCache(s.id,s)),s}async getFramsRewarderConfig(t,e,n=!1){const{frams:i}=this._sdk.sdkOptions,s=[];for(const o of e){const r=`getFramsRewarderConfig_${o}_${t}`,a=this.getCache(r,n);if(a)s.push(a);else try{const c=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:W(i).rewarder_manager_handle,name:{type:"0x1::type_name::TypeName",value:zw(o)}}),{fields:u}=c.data.content.fields.value.fields.value,l={reward_coin:o,last_reward_time:u.last_reward_time,emission_per_second:u.emission_per_second,total_allocate_point:u.total_allocate_point,allocate_point:""},d=u.pools.fields.id.id,p=await this._sdk.ClmmSDK.fullClient.getDynamicFieldObject({parentId:d,name:{type:"0x2::object::ID",value:t}}),{allocate_point:g}=p.data.content.fields.value.fields.value.fields;l.allocate_point=g,this.updateCache(r,l),s.push(l)}catch(c){console.log(c)}}return s}async getOwnedFramsPositionNFTList(t,e=!1,n="all"){const{package_id:i}=this._sdk.sdkOptions.frams,s={data:[],hasNextPage:!1},o=await this._sdk.ClmmSDK.fullClient.getOwnedObjectsByPage(t,{filter:{StructType:`${i}::pool::WrappedPositionNFT`},options:{showContent:!0}},n);s.hasNextPage=o.hasNextPage,s.nextCursor=o.nextCursor;for(const r of o.data){const a=Qr.buildFramsPositionNFT(r);a&&s.data.push(a)}if(e&&s.data.length>0){const r=await this.calculateFarmingRewards(s.data.map(a=>({pool_id:a.pool_id,position_nft_id:a.id,clmm_pool_id:a.clmm_pool_id})));s.data.forEach(a=>{r[a.id]&&(a.rewards=r[a.id])})}return s}async getFramsPositionNFT(t,e=!0){const n=await this._sdk.ClmmSDK.fullClient.getObject({id:t,options:{showContent:!0,showType:!0}}),i=Qr.buildFramsPositionNFT(n);if(e&&i){const s=await this.calculateFarmingRewards([{pool_id:i.pool_id,position_nft_id:i.id}]);s[i.id]&&(i.rewards=s[i.id])}return i}async calculateFarmingRewards(t){var r;const{frams:e}=this._sdk.sdkOptions,n=new Pe,{rewarder_manager_id:i,global_config_id:s}=W(e);t.forEach(a=>{n.moveCall({target:`${e.published_at}::router::accumulated_position_rewards`,typeArguments:[],arguments:[n.object(s),n.object(i),n.object(a.pool_id),n.object(a.position_nft_id),n.object(fe)]})});const o={};try{const c=(r=(await this._sdk.ClmmSDK.fullClient.devInspectTransactionBlock({transactionBlock:n,sender:this._sdk.ClmmSDK.senderAddress})).events)==null?void 0:r.filter(u=>ae(u.type).name==="AccumulatedPositionRewardsEvent");if(c&&c.length>0)for(let u=0;u<c.length;u+=1){const{parsedJson:l}=c[u],d=[];l.rewards.contents.forEach(p=>{d.push({rewarder_type:ae(p.key.name).full_address,rewarder_amount:p.value})}),o[l.wrapped_position_id]=d}}catch(a){console.log(a)}return o}depositPayload(t,e){const{frams:n}=this.sdk.sdkOptions;e=e||new Pe;const{global_config_id:i,rewarder_manager_id:s}=W(n);return e.moveCall({target:`${n.published_at}::router::deposit`,typeArguments:[],arguments:[e.object(i),e.object(s),e.object(t.pool_id),e.object(t.clmm_position_id),e.object(fe)]}),e}async withdrawPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{global_config_id:i,rewarder_manager_id:s}=W(n);return e=e||new Pe,e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id},e),e.moveCall({target:`${n.published_at}::router::withdraw`,typeArguments:[],arguments:[e.object(i),e.object(s),e.object(t.pool_id),e.object(t.position_nft_id),e.object(fe)]}),e}async batchHarvestPayload(t,e){e=e||new Pe;for(const n of t)await this.harvestPayload(n,e);return e}async harvestPayload(t,e){const{frams:n}=this.sdk.sdkOptions;e=e||new Pe;const i=await this.getFramsPool(t.pool_id,!1);if(i===void 0)throw Error(`not found ${t.pool_id}`);const{global_config_id:s,rewarder_manager_id:o}=W(n);if("collect_fee"in t&&(t.collect_fee||t.clmm_rewarder_types.length>0)){const a=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,a)}return i.rewarders.forEach(a=>{e&&e.moveCall({target:`${n.published_at}::router::harvest`,typeArguments:[a.reward_coin],arguments:[e.object(s),e.object(o),e.object(t.pool_id),e.object(t.position_nft_id),e.object(fe)]})}),e}async claimFeeAndClmmReward(t){const e=new Pe,n=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);return await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,n),e}async openPositionAddLiquidityStakePaylod(t){const e=new Pe,{clmm_pool:n,integrate:i}=this._sdk.ClmmSDK.sdkOptions,s=W(n),o=e.moveCall({target:`${n.published_at}::pool::open_position`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(t.clmm_pool_id),e.pure(En(BigInt(t.tick_lower)).toString()),e.pure(En(BigInt(t.tick_upper)).toString())]}),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=tt.buildCoinForAmount(e,r,BigInt(t.amount_a),t.coinTypeA,!1),c=tt.buildCoinForAmount(e,r,BigInt(t.amount_b),t.coinTypeB,!1);e.moveCall({target:`${i.published_at}::${Is}::add_liquidity_by_fix_coin`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(t.clmm_pool_id),o,a.targetCoin,c.targetCoin,e.pure(t.amount_a.toString()),e.pure(t.amount_b.toString()),e.pure(t.fix_amount_a),e.object(fe)]});const{frams:u}=this.sdk.sdkOptions,{global_config_id:l,rewarder_manager_id:d}=W(u);return e.moveCall({target:`${u.published_at}::router::deposit`,typeArguments:[],arguments:[e.object(l),e.object(d),e.object(t.pool_id),o,e.object(fe)]}),e}async addLiquidityPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new Pe;const s=W(n),o=W(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=tt.buildCoinForAmount(e,r,BigInt(t.amount_limit_a),t.coinTypeA,!1),c=tt.buildCoinForAmount(e,r,BigInt(t.amount_limit_b),t.coinTypeB,!1);if(t.collect_rewarder&&(e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id,clmm_pool_id:t.clmm_pool_id},e)),t.collect_fee||t.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,u,a.remainCoins,c.remainCoins)}return e.moveCall({target:`${n.published_at}::router::add_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),a.targetCoin,c.targetCoin,e.pure(t.amount_limit_a),e.pure(t.amount_limit_b),e.pure(t.delta_liquidity),e.object(fe)]}),e}async addLiquidityFixCoinPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new Pe;const s=W(n),o=W(i),r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress),a=tt.buildCoinForAmount(e,r,BigInt(t.amount_a),t.coinTypeA,!1),c=tt.buildCoinForAmount(e,r,BigInt(t.amount_b),t.coinTypeB,!1);if(t.collect_rewarder&&(e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id,clmm_pool_id:t.clmm_pool_id},e)),t.collect_fee||t.clmm_rewarder_types.length>0){const u=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:t.collect_fee,clmm_rewarder_types:t.clmm_rewarder_types},e,u,a.remainCoins,c.remainCoins)}return e.moveCall({target:`${n.published_at}::router::add_liquidity_fix_coin`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),a.targetCoin,c.targetCoin,e.pure(t.amount_a.toString()),e.pure(t.amount_b.toString()),e.pure(t.fix_amount_a),e.object(fe)]}),e}async removeLiquidityPayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new Pe;const s=W(n),o=W(i);if(t.collect_rewarder&&(!t.unstake||t.close_position)&&(e=await this.harvestPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id,clmm_pool_id:t.clmm_pool_id},e)),t.clmm_rewarder_types.length>0){const r=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);e=await this.buildCollectRewarderAndFeeParams({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,collectFee:!1,clmm_rewarder_types:t.clmm_rewarder_types},e,r)}if(t.close_position){if(t.clmm_position_id===void 0)throw Error("close_position need clmm_position_id");e.moveCall({target:`${n.published_at}::router::close_position`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(o.global_config_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),e.pure(t.min_amount_a),e.pure(t.min_amount_b),e.object(fe)]})}else e.moveCall({target:`${n.published_at}::router::remove_liquidity`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(s.rewarder_manager_id),e.object(t.pool_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),e.pure(t.delta_liquidity),e.pure(t.min_amount_a),e.pure(t.min_amount_b),e.object(fe)]}),t.unstake&&this.withdrawPayload({pool_id:t.pool_id,position_nft_id:t.position_nft_id});return e}async buildCollectRewarderAndFeeParams(t,e,n,i,s){i===void 0&&(i=[...n]),s===void 0&&(s=[...n]);const o=Mn(t.coinTypeA),r=Mn(t.coinTypeB);t.collectFee&&this.collectFeePayload({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB},e);const a=[];return t.clmm_rewarder_types.forEach(c=>{switch(Mn(c)){case o:a.push(tt.buildCoinForAmount(e,i,BigInt(0),c,!1).targetCoin);break;case r:a.push(tt.buildCoinForAmount(e,s,BigInt(0),c,!1).targetCoin);break;default:a.push(tt.buildCoinForAmount(e,n,BigInt(0),c,!1).targetCoin);break}}),this.collectClmmRewardPayload({clmm_pool_id:t.clmm_pool_id,position_nft_id:t.position_nft_id,clmm_rewarder_types:t.clmm_rewarder_types,coinTypeA:t.coinTypeA,coinTypeB:t.coinTypeB,reward_coins:a},e),e}collectFeePayload(t,e){const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new Pe;const s=W(n),o=W(i);return e.moveCall({target:`${n.published_at}::router::collect_fee`,typeArguments:[t.coinTypeA,t.coinTypeB],arguments:[e.object(s.global_config_id),e.object(o.global_config_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id)]}),e}async collectClmmRewardPayload(t,e){var a;const{frams:n}=this.sdk.sdkOptions,{clmm_pool:i}=this.sdk.ClmmSDK.sdkOptions;e=e||new Pe;let s=t.reward_coins;if(t.clmm_rewarder_types.length>0&&s===void 0){s=[];const c=await this._sdk.ClmmSDK.getOwnerCoinAssets(this._sdk.ClmmSDK.senderAddress);t.clmm_rewarder_types.forEach(u=>{s.push(tt.buildCoinForAmount(e,c,BigInt(0),u,!1).targetCoin)})}const o=W(n),r=W(i);return(a=t.clmm_rewarder_types)==null||a.forEach((c,u)=>{e&&e.moveCall({target:`${n.published_at}::router::collect_clmm_reward`,typeArguments:[c,t.coinTypeA,t.coinTypeB],arguments:[e.object(o.global_config_id),e.object(r.global_config_id),e.object(t.clmm_pool_id),e.object(t.position_nft_id),e.object(r.global_vault_id),s[u],e.object(fe)]})}),e}async getFrarmsConfigs(){const{package_id:t}=this._sdk.sdkOptions.frams,e={global_config_id:"",rewarder_manager_id:"",rewarder_manager_handle:""},n=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::config::InitConfigEvent`})).data;if(n.length>0){const s=n[0].parsedJson;e.global_config_id=s.global_config_id,e.admin_cap_id=s.admin_cap_id}const i=(await this._sdk.ClmmSDK.fullClient.queryEventsByPage({MoveEventType:`${t}::rewarder::InitRewarderManagerEvent`})).data;if(i.length>0){const s=i[0].parsedJson;e.rewarder_manager_id=s.id;const o=await this._sdk.ClmmSDK.fullClient.getObject({id:e.rewarder_manager_id,options:{showContent:!0}});e.rewarder_manager_handle=o.data.content.fields.rewarders.fields.id.id}return e}updateCache(t,e,n=Ee){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},k4=class{constructor(t,e){xe(this,"_cache",{});xe(this,"_sdkOptions");xe(this,"_launchpad");xe(this,"_ido");xe(this,"_xcetusModule");xe(this,"_xtokenModule");xe(this,"_boosterModule");xe(this,"_makerModule");xe(this,"_clmmSDK");xe(this,"_liquidityStrategy");xe(this,"_vaults");xe(this,"_limitOrder");xe(this,"_farmsModule");this._sdkOptions=t,this._clmmSDK=e,this._launchpad=new d4(this),this._ido=new y4(this),this._xcetusModule=new p4(this),this._xtokenModule=new w4(this),this._boosterModule=new l4(this),this._makerModule=new h4(this),this._vaults=new v4(this),this._limitOrder=new T4(this),this._farmsModule=new A4(this),this._liquidityStrategy=new b4(this),Cp(this._sdkOptions)}get ClmmSDK(){return this._clmmSDK}get sdkOptions(){return this._sdkOptions}get Launchpad(){return this._launchpad}get Ido(){return this._ido}get XToken(){return this._xtokenModule}get XCetusModule(){return this._xcetusModule}get BoosterModule(){return this._boosterModule}get MakerModule(){return this._makerModule}get LiquidityStrategy(){return this._liquidityStrategy}get Vaults(){return this._vaults}get LimitOrder(){return this._limitOrder}get Farms(){return this._farmsModule}getVerifySenderAddress(){const{senderAddress:t}=this.ClmmSDK;if(t.length===0||!Zw(t))throw Error("this clmm config sdk senderAddess is illegal");return t}updateCache(t,e,n=Ee){let i=this._cache[t];i?(i.overdueTime=bt(n),i.value=e):i=new kn(e,bt(n)),this._cache[t]=i}getCache(t,e=!1){const n=this._cache[t];if(!e&&(n!=null&&n.isValid()))return n.value;delete this._cache[t]}},Ib=k4;function S4(t){const e={fullRpcUrl:localStorage.getItem(`${t}-currentRpclocal2`)||ke[t||"Sui"].fullRpcUrl,simulationAccount:ke[t||"Sui"].simulationAccount,cetus_config:ke[t||"Sui"].cetus_config,clmm_pool:ke[t||"Sui"].clmm_pool,integrate:ke[t||"Sui"].integrate,deepbook:ke[t||"Sui"].deepbook,deepbook_endpoint_v2:ke[t||"Sui"].deepbook_endpoint_v2,aggregatorUrl:ke[t||"Sui"].aggregatorUrl,swapCountUrl:ke[t||"Sui"].swapCountUrl},n={launchpad:ke[t||"Sui"].launchpad,ido:ke[t||"Sui"].ido,xcetus:ke[t||"Sui"].xcetus,xcetus_dividends:ke[t||"Sui"].xcetus_dividends,cetus_faucet:ke[t||"Sui"].cetus_faucet,xtoken:ke[t||"Sui"].xtoken,xtoken_dividends:ke[t||"Sui"].xtoken_dividends,token_faucet:ke[t||"Sui"].token_faucet,booster:ke[t||"Sui"].booster,maker_bonus:ke[t||"Sui"].maker_bonus,liquidity_stratefy:ke[t||"Sui"].liquidity_stratefy,vaults:ke[t||"Sui"].vaults,frams:ke[t||"Sui"].frams};console.log("defaultNetworkOptions####",e);const i=Dc(new Ns(e)),s=Dc(new Ib(n,i)),o=ph(),r=Go(()=>o),a=D0(),c=Go(()=>a),u=P4();Go(()=>u),M0(()=>{r.value.address&&(i.senderAddress=r.value.address)});const{$notify:l}=ea(),d=q=>{const{$notify:j}=ea();j.success({key:q.hash+"loading",icon:Ge("img",{class:{"notify-icon":!0,"loading-animate":!0},src:c.value.theme=="default"?"/image/img-loading@2x.png":"/sui-image/img-loading.png"}),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:q.title},null)]),description:Ge("div",{class:"notification-title"},[Ge("div",{class:"notification-text",innerHTML:Rn.global.t("newAdd.confirmingTransaction")},null),Ge("a",{href:Qc(c.value.currentExplorer,"tx",window.encodeURIComponent(q.hash)),target:"_blank",innerHTML:Rn.global.t("common.viewTransaction")},null)]),duration:0,class:"ant-notification-copy ant-notification-swap"})},p=q=>{l.success({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-icon-change1"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:`${q.title} `+Rn.global.t("newAdd.success")},null)]),description:Ge("div",{class:"notification-title"},[Ge("div",{class:"notification-text",innerHTML:q.desc},null),Ge("a",{href:Qc(c.value.currentExplorer,"tx",window.encodeURIComponent(q.hash)),target:"_blank",innerHTML:Rn.global.t("common.viewTransaction")},null)]),duration:4.5,class:"ant-notification-copy ant-notification-swap"})},g=q=>{l.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:`${q} `+Rn.global.t("newAdd.failed")},null)]),description:Rn.global.t("newAdd.somethingWrong"),duration:4.5,class:"ant-notification-copy ant-notification-error"})},b=async(q,j=!1)=>{var J,Q,ne,pe;const{$notify:K}=ea();try{let ee={};if(!q.res||!((J=q==null?void 0:q.res)!=null&&J.digest)){const me=await zo(2e3);ee=await i.Pool.getSuiTransactionResponse(q.hash),console.log("0503###watchTransaction###res###",ee)}else ee=q.res;if(console.log("0411###watchTransaction###res###",ee),console.log(q,"====>params"),((ne=(Q=ee==null?void 0:ee.effects)==null?void 0:Q.status)==null?void 0:ne.status)==="success"){K.close(q.hash+"loading"),p(q);const me={walletAddress:o.address,chainName:"Sui",...q,...ee,date:new Date().getTime()+6048e5};if(j)if(console.log("0222###watchTransaction###isGetNftInfo true###res####",ee),ee.events){const se=ee.events.filter(_e=>_e.type.includes("OpenPositionEvent"));return{status:!0,nftInfo:se[0]&&((pe=se[0])==null?void 0:pe.parsedJson)}}else return{status:!0,nftInfo:ee.effects.events};return!0}else{if(ee&&ee.effects&&ee.effects.status&&ee.effects.status.status!=="success")return K.close(q.hash+"loading"),g(q.title),!1;setTimeout(()=>b(q),3e3)}}catch(ee){return console.log("watchTransaction###error###",ee),K.close(q.hash+"loading"),K.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:`${q.title} Failed`},null)]),duration:4.5,description:"Something went wrong",class:"ant-notification-copy ant-notification-error"}),!0}},w=async q=>{var J,Q,ne,pe,ee,me;q.setSenderIfNotSet(r.value.address);const j=await q.build({provider:i.fullClient}),K=await i.fullClient.dryRunTransactionBlock({transactionBlock:j});if(console.log("0503###simulate###simulateRes###",K),((Q=(J=K==null?void 0:K.effects)==null?void 0:J.status)==null?void 0:Q.status)==="failure"){console.log("0424###simulateRes###error###",(pe=(ne=K==null?void 0:K.effects)==null?void 0:ne.status)==null?void 0:pe.error);const ve=(me=(ee=K==null?void 0:K.effects)==null?void 0:ee.status)==null?void 0:me.error,se=/\("(.+?)"\)/g,_e=ve.match(se),Fe=_e&&_e[0]&&_e[0].match(/\w+/g)||"",Oe=_e&&_e[1]&&_e[1].match(/\w+/g)||"",De=ve.substr(ve.lastIndexOf("}, ")+3),it=De&&De.split(")"),Ie=it&&it[0]||"";throw Fe&&Fe[0]==="factory"&&Oe&&Oe[0]=="create_pool_internal"&&Ie==="1"?(l.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:"Transaction "+Rn.global.t("newAdd.failed")},null)]),description:"Pool is existed",duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error("pool is existed")):(l.error({icon:Ge("svg",{class:{icon:!0},"aria-hidden":!0},[Ge("use",{"xlink:href":"#icon-a-icon-Shutdown"})]),message:Ge("div",{class:"notification-title"},[Ge("span",{innerHTML:"Transaction "+Rn.global.t("newAdd.failed")},null)]),description:ve,duration:4.5,class:"ant-notification-copy ant-notification-error"}),new Error(ve))}else return K},T=q=>({transactionBlock:q,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),E=async(q,j=!1)=>{var J,Q;await zo(2e3);const K=await i.Pool.getSuiTransactionResponse(q.hash);if(((Q=(J=K==null?void 0:K.effects)==null?void 0:J.status)==null?void 0:Q.status)==="success"){l.close(q.hash+"loading"),p(q);const ne={walletAddress:o.address,chainName:"Sui",...q,...K,date:new Date().getTime()+6048e5};a.setTransactionList(ne)}},P=async q=>{try{o.setLoading(!0);const j=await i.getOwnerCoinAssets(q),K={};return j.forEach(J=>{var Q,ne;if(J&&J.coinAddress){const pe=J?J.balance.toString():"0",ee={...J,balance:pe};K[J.coinAddress]={...J,balance:(Q=K[J.coinAddress])!=null&&Q.balance?U(pe).plus(K[J.coinAddress].balance).toString():pe,objects:(ne=K[J.coinAddress])!=null&&ne.objects?[...K[J.coinAddress].objects,ee]:[ee]}}}),console.log("0411###assets###",K),o.setAssets(K),o.setLoading(!1),K}catch{o.setLoading(!1)}},k=async()=>{try{const q=await i.CetusConfig.getCoinConfigs();console.log("0907###tokenList###",q);let j=[],K=[],J=[];return q.forEach(Q=>{let ne=Q;if(Q.address.includes("::sui::SUI")){const pe=ae(Q.address).full_address;ne={...ne,address:pe}}ne.coin_priority?K.push(ne):J.push({...ne,coin_priority:"0"})}),K=K.sort((Q,ne)=>Number(Q==null?void 0:Q.coin_priority)<Number(ne==null?void 0:ne.coin_priority)?1:-1),J=J.sort((Q,ne)=>Q.symbol.charCodeAt(0)-ne.symbol.charCodeAt(0)),j=[...K,...J],console.log("0517###haveCoinPriority###",K),console.log("0517###notHaveCoinPriority###",J),console.log("0517###tokenList###",j),j}catch(q){return console.log("0517###getTokenList###error###",q),[]}},S=async q=>{var K;const j=[];try{const J=await i.Pool.getPools([]),Q=await k(),ne={};Q.forEach(ve=>{ne[ve.address]=ve});const pe=await i.CetusConfig.getClmmPoolConfigs(),ee={};pe.forEach(ve=>{ee[ve.address]=ve});let me={};try{const se=(t=="Aptos"?await fetch(`${ke.Aptos.api}/v2/sui/swap/count`).then(_e=>_e.json()):await fetch(`${ke.Sui.api}/v2/sui/swap/count`).then(_e=>_e.json())).data;me=Object.fromEntries(se.pools.map(_e=>[_e.swap_account,{..._e,apr_7day:t=="Aptos"?_e.apr_7day:_e.apr_24h}]))}catch{}console.log("0426###getLpListFromContract###poolImmutables###",J),console.log("0426###getLpListFromContract###tokenObj###",ne),console.log("0426###getLpListFromContract###lpObj###",ee),console.log("0426###getLpListFromContract###addressLpTokens###",me);for(let ve=0;ve<J.length;ve++){const se=J[ve];if(ee[se.poolAddress]||!ee[se.poolAddress]){let _e=ne[se.coinTypeA],Fe=ne[se.coinTypeB];_e||(_e=(await i.CetusConfig.getTokenListByCoinTypes([se.coinTypeA]))[se.coinTypeA]),Fe||(Fe=(await i.CetusConfig.getTokenListByCoinTypes([se.coinTypeB]))[se.coinTypeB]);let Oe=!1;st(_e.address,Fe.address)&&(Oe=!0);const De=me[se.poolAddress]?((K=me[se.poolAddress])==null?void 0:K.is_forward)===!1:Oe;let it={};ee[se.poolAddress]&&(it={...it,...ee[se.poolAddress]}),it={...it,address:se.poolAddress,coinA:_e,coinB:Fe,coin_a_address:se.coinTypeA,coin_b_address:se.coinTypeB,decimals:6,fee:Number(se.fee_rate)/1e6,tickSpacing:se.tickSpacing,symbol:`${_e==null?void 0:_e.symbol}-${Fe==null?void 0:Fe.symbol}`,name:`${_e==null?void 0:_e.symbol}-${Fe==null?void 0:Fe.symbol}`,needReverse:De},(!q||!q[se.coinTypeA]&&!q[se.coinTypeB])&&j.push(it)}}return console.log("0426###getLpListFromContract###result###",j),j}catch(J){console.log("getLpListFromContract###err##",J)}},$=async q=>{var j,K;try{const J=[],Q=await fetch(`${ke[t||"Sui"].api}/v2/sui/pools_info`).then(ee=>ee.json());if(!((j=Q==null?void 0:Q.data)!=null&&j.lp_list)){const ee=await S(q);if(ee)return ee}console.log(q,"===>newFilterCoinsObj");const ne=((K=Q==null?void 0:Q.data)==null?void 0:K.lp_list)||[];console.log("0426###getLpList###lpList###",ne),console.log("0426###getLpList###res###",Q);const pe=["0xabf2af71ab3ed7c6c3bb557b984a9158f500fc8cebce2572239d1f7690930be8","0x473ab0306ff8952d473b10bb4c3516c632edeb0725f6bb3cda6c474d0ffc883f","0xd40feebfcf7935d40c9e82c9cb437442fee6b70a4be84d94764d0d89bb28ab07"];return ne.forEach(ee=>{var _e,Fe,Oe,De;const me=(ee==null?void 0:ee.is_forward)===!1,ve=[],se=pe.includes(ee.address);if(ee.is_display_rewarder){const it=(Oe=(Fe=(_e=ee==null?void 0:ee.object)==null?void 0:_e.rewarder_manager)==null?void 0:Fe.fields)==null?void 0:Oe.rewarders;it&&it.forEach(Ie=>{var Pt,Ve,gt,Bn,ft,dt,Jn,ct,Dt;const ht=new ie((Pt=Ie==null?void 0:Ie.fields)==null?void 0:Pt.emissions_per_second).mul(ie.pow(2,-64));console.log("extractStructTagFromType###",ae((Bn=(gt=(Ve=Ie==null?void 0:Ie.fields)==null?void 0:Ve.reward_coin)==null?void 0:gt.fields)==null?void 0:Bn.name).source_address),ve.push({coinAddress:ae((Jn=(dt=(ft=Ie==null?void 0:Ie.fields)==null?void 0:ft.reward_coin)==null?void 0:dt.fields)==null?void 0:Jn.name).source_address,emissionsEveryDay:Math.floor(ht.toNumber()*60*60*24),emissions_per_second:(ct=Ie==null?void 0:Ie.fields)==null?void 0:ct.emissions_per_second,growth_global:(Dt=Ie==null?void 0:Ie.fields)==null?void 0:Dt.growth_global})}),console.log("0426###rewarders###item###",ee),console.log("0426###rewarders###",it,"###rewarderInfo###",ve)}(!q||!q[ee.coin_a.address]&&!q[ee.coin_b.address]&&!q[ae(ee.coin_a.address).full_address]&&!q[ae(ee.coin_b.address).full_address])&&J.push({...ee,coinA:{...ee.coin_a,address:ae(ee.coin_a.address).full_address},coinB:{...ee.coin_b,address:ae(ee.coin_b.address).full_address},rewarderInfo:ve,needReverse:me,is_pause:(De=ee==null?void 0:ee.object)==null?void 0:De.is_pause,isStableFarming:se})}),console.log("0426###getLpList###result###",J),J}catch(J){console.log("0426###getLpList###err###",J);const Q=await S(q);if(console.log(Q,"result===>"),Q)return Q}},H=async(q=[])=>{console.log(q,"getPoolslist##");const K=await new Ns(e).Pool.getPools(q,0,1e3);if(console.log("0330###getPools###pools###",K),q.length===0){const J={};return K.forEach(Q=>{J[Q.poolAddress]={...Q,rate:U(Q.fee_rate).div(Math.pow(10,6)).toString()}}),J}else return K},V=async q=>await new Ns(e).Pool.getPool(q),z=q=>{const j=new qb;return j.moveCall({target:`${ke[t||"Sui"].faucet.faucet_display}::${q.transactionModule}::faucet`,typeArguments:[],arguments:[j.pure(q.suplyID)]}),T(j)},X=q=>{var K,J,Q,ne,pe;let j;return q!=null&&q.digest?j={hash:q==null?void 0:q.digest,status:(J=(K=q==null?void 0:q.effects)==null?void 0:K.status)==null?void 0:J.status,res:q}:q!=null&&q.effects&&(j={hash:(Q=q==null?void 0:q.effects)==null?void 0:Q.transactionDigest,status:(pe=(ne=q==null?void 0:q.effects)==null?void 0:ne.status)==null?void 0:pe.status,res:q}),j},L=async q=>{console.log(q,"pool===>600");try{const j=await i.Pool.fetchTicks({pool_id:q.poolAddress,coinTypeA:q.coinTypeA,coinTypeB:q.coinTypeB});return console.log("0330###getTicks####sui####",j),j}catch(j){console.log("0330###getTicks Error###",j)}},B=async(q,j,K,J)=>await PB(q,j,K,J),O=q=>{var _e,Fe;const{pool:j,position:K,roundUp:J}=q,Q=Number(K.tick_lower_index),ne=Number(K.tick_upper_index),pe=Se.tickIndexToSqrtPriceX64(Q),ee=Se.tickIndexToSqrtPriceX64(ne),me=It.getCoinAmountFromLiquidity(new y(K.liquidity),new y(j.current_sqrt_price),pe,ee,J),ve=$t(me.coinA.toString(),(_e=j==null?void 0:j.coinA)==null?void 0:_e.decimals),se=$t(me.coinB.toString(),(Fe=j==null?void 0:j.coinB)==null?void 0:Fe.decimals);return{coinaAmount:ve,coinbAmount:se}},v=q=>{const{tokenA:j,tokenB:K,lowerTick:J,upperTick:Q,coinAmount:ne,iscoinA:pe,roundUp:ee,slippage:me,curSqrtPrice:ve}=q;console.log(ve.toString(),q,"==>params");const se=It.estLiquidityAndcoinAmountFromOneAmounts(J,Q,ne,pe,ee,me,ve),_e=j.decimals,Fe=K.decimals,{tokenMaxA:Oe,tokenMaxB:De,liquidityAmount:it,coinAmountA:Ie,coinAmountB:ht}=se;return console.log(Oe.toString(),"===>tokenMaxA.toString()"),console.log(De.toString(),"===>tokenMaxB.toString()"),console.log(Ie.toString(),"===>coinAmountA.toString()"),console.log(ht.toString(),"===>coinAmountB.toString()"),console.log(se,"result===>"),console.log(se.liquidityAmount.toString(),"liquidityAmount===>"),console.log(_e,"===>coinaDecimals"),{tokenMaxAOrigin:Oe.toString(),tokenMaxBOrigin:De.toString(),tokenMaxA:$t(Ie.toString(),_e),tokenMaxB:$t(ht.toString(),Fe),liquidityAmount:it}},h=async q=>{var Bn,ft,dt,Jn;const{pool:j,amount:K,fix_amount_a:J,roundUp:Q,tick_lower:ne,tick_upper:pe,index:ee,slippage:me,coinTypeC:ve,coinTypeD:se,coinTypeE:_e,curSqrtPrice:Fe,positionInfo:Oe,farmPoolInfo:De}=q,it=await V(j.poolAddress);console.log(q.curSqrtPrice.toString(),"###getAddLiquidityTransactionPayload 732 params"),console.log(it,"###newPool");const Ie=J?sn(K,j.token_a.decimals):sn(K,j.token_b.decimals),ht=Se.sqrtPriceX64ToTickIndex(new y(it.current_sqrt_price));console.log(it.current_sqrt_price.toString(),q.curSqrtPrice.toString(),"curSqrtPrice##610");let Pt,Ve;if(ht>=ne&&ht<=pe){const ct=It.estLiquidityAndcoinAmountFromOneAmounts(ne,pe,new y(Ie.toString()),J,Q,me,new y(it.current_sqrt_price));console.log(ct,ct.tokenMaxA.toNumber(),ct.tokenMaxB.toNumber(),"===>preAddResult.coinAmountA.toNumber()"),Pt=J?Ie.toNumber():ct.tokenMaxA.toNumber(),Ve=J?ct.tokenMaxB.toNumber():Ie.toNumber()}else ht>pe?(Pt=0,Ve=Ie.toNumber()):ht<ne&&(Pt=Ie.toNumber(),Ve=0);console.log(q,"===>params742"),console.log("0330###createAddLiquidityTransactionPayload###params###",{coinTypeA:j.token_a.address,coinTypeB:j.token_b.address,pool_id:j.poolAddress,tick_lower:ne<-443636?-443636:ne,tick_upper:pe>443636?443636:pe,fix_amount_a:J,amount_a:Pt,amount_b:Ve,is_open:!ee,pos_id:ee});let gt;if(((Bn=Oe==null?void 0:Oe.value)==null?void 0:Bn.positionSource)==="farming"){console.log("0103 getAddLiquidityTransactionPayload positionInfo: ",Oe);const ct=[];ve&&ct.push(ve),se&&ct.push(se),_e&&ct.push(_e),gt=await s.Farms.addLiquidityFixCoinPayload({pool_id:(ft=Oe==null?void 0:Oe.value)==null?void 0:ft.pool_id,coinTypeA:j.token_a.address,coinTypeB:j.token_b.address,position_nft_id:(dt=Oe==null?void 0:Oe.value)==null?void 0:dt.id,clmm_pool_id:(Jn=Oe==null?void 0:Oe.value)==null?void 0:Jn.clmm_pool_id,amount_a:Pt,amount_b:Ve,collect_fee:!0,collect_rewarder:!1,fix_amount_a:J,clmm_rewarder_types:ct})}else if(!ee)console.log(De,"farmPoolInfo##"),De?gt=await s.Farms.openPositionAddLiquidityStakePaylod({pool_id:De.id,coinTypeA:j.token_a.address,coinTypeB:j.token_b.address,clmm_pool_id:De.clmm_pool_id,amount_a:Pt.toString(),amount_b:Ve.toString(),fix_amount_a:J,tick_lower:ne,tick_upper:pe}):gt=await i.Position.createAddLiquidityFixTokenPayload({coinTypeA:j.token_a.address,coinTypeB:j.token_b.address,pool_id:j.poolAddress,tick_lower:ne<-443636?-443636:ne,tick_upper:pe>443636?443636:pe,fix_amount_a:J,amount_a:Pt,amount_b:Ve,is_open:!ee,pos_id:"",collect_fee:!1,rewarder_coin_types:[],slippage:me},{slippage:me,curSqrtPrice:Fe});else{const ct=[];ve&&ct.push(ve),se&&ct.push(se),_e&&ct.push(_e),gt=await i.Position.createAddLiquidityFixTokenPayload({coinTypeA:j.token_a.address,coinTypeB:j.token_b.address,pool_id:j.poolAddress,tick_lower:ne<-443636?-443636:ne,tick_upper:pe>443636?443636:pe,fix_amount_a:J,amount_a:Pt,amount_b:Ve,is_open:!ee,pos_id:ee,collect_fee:q.collect_fee,rewarder_coin_types:[...ct],slippage:me},{slippage:me,curSqrtPrice:Fe})}return console.log("0330###sui##getAddLiquidityTransactionPayload###",gt),T(gt)},_=(q,j,K)=>{const J=Se.sqrtPriceX64ToPrice(new y(q.current_sqrt_price),q.coinA.decimals,q.coinB.decimals).toNumber(),Q=K?J:1/J,ne=U(Q).minus(U(j)).div(U(Q)).mul(100);return ne.gt(100)?100:(console.log(ne.toString(),"1143"),Number(Et(ne.abs().toString(),2)))},A=async q=>{const{pool:j,a2b:K,byAmountIn:J,amount:Q}=q;console.log("0221###sui###preSwap###",q);const ne=j.coinA.decimals,pe=j.coinB.decimals,ee=j!=null&&j.current_sqrt_price?j:await V(j.address);let me;K&&J||!K&&!J?me=sn(Q,ne):me=sn(Q,pe);const ve=await i.Swap.preswap({pool:ee,current_sqrt_price:ee.current_sqrt_price,coinTypeA:ee.coinTypeA,coinTypeB:ee.coinTypeB,decimalsA:ne,decimalsB:pe,a2b:K,byAmountIn:J,amount:me.toString()});return console.log("0221###sui###preSwap###result###",ve),{...ve,estimatedAmountIn:Cs($t(ve.estimatedAmountIn.toString(),K?ne:pe),K?ne:pe),estimatedAmountOut:Cs($t(ve.estimatedAmountOut.toString(),K?pe:ne),K?pe:ne),priceImpactPct:Et(ve.priceImpactPct,2)}},C=async q=>{console.log("0412###getSwapTransactionPayload###params###",q);const{pool:j,a2b:K,byAmountIn:J,amount:Q,slippage:ne}=q,pe=j.poolAddress,ee=j.token_a.decimals,me=j.token_b.decimals;let ve;K&&J||!K&&!J?ve=sn(Q,ee):ve=sn(Q,me);const se=await i.Swap.preswap({pool:j,current_sqrt_price:j.current_sqrt_price,coinTypeA:j.coinTypeA,coinTypeB:j.coinTypeB,decimalsA:ee,decimalsB:me,a2b:K,by_amount_in:J,amount:ve.toString()}),_e=U(se.estimatedAmountOut.toString()),Fe=U(se.estimatedAmountIn.toString()),Oe=J?_e.sub(_e.mul(ne)):Fe.add(Fe.mul(ne));console.log("0221###sui###swap##params123456###",{pool_id:pe,a2b:se.aToB,by_amount_in:se.byAmountIn,amount:se.amount.toString(),amount_limit:Et(Oe.toString(),0)||"",coinTypeA:j.token_a.address,coinTypeB:j.token_b.address});const De=await i.Swap.createSwapTransactionPayload({pool_id:pe,a2b:se.aToB,by_amount_in:se.byAmountIn,amount:se.amount.toString(),amount_limit:Et(Oe.toString(),0)||"",coinTypeA:j.token_a.address,coinTypeB:j.token_b.address});return console.log("0221###sui###swap##tx###",De),T(De)},M=async(q,j)=>{const K=new Ns(e);console.log(j,"pools982");const J=Object.values(j).map(ne=>ne.address);return console.log(J,"#poolList"),await K.Position.getPositionList(q,J)},N=async(q,j,K,J="")=>{const Q=new Ns(e);return console.log(q.position_manager.positions_handle,J,"===>pool.position_manager.positions_handle, pos"),{...await Q.Position.getPosition(q.position_manager.positions_handle,J),tokenName:K,collectionName:j}},F=async q=>{const K=await new Ns(e).Position.getPositionById(q);return console.log("0503###getPositionById###result###",K),K},x=async(q,j)=>(console.log(q,j,"getTickDataByIndex"),await i.Pool.getTickDataByIndex(q,j)),m=async q=>{const{pool:j,position:K,tickLowerData:J,tickUpperData:Q}=q,ne=await V(j.poolAddress),pe=FB({clmmpool:ne,position:K,tickLower:J,tickUpper:Q}),ee=$t(pe.feeOwedA.toString(),j.token_a.decimals),me=$t(pe.feeOwedB.toString(),j.token_b.decimals);return{feeOwedA:Number(ee)>99999999999||Number(ee)<0?"0":ee,feeOwedB:Number(me)>99999999999||Number(me)<0?"0":me}},R=async q=>{const{poolAddress:j,pos:K,positionHandle:J}=q;return await i.Rewarder.posRewardersAmount(j,J,K)},ye=q=>q.pos_object_id,ce=async q=>{const{pool:j,coinTypeA:K,coinTypeB:J,coinTypeC:Q,coinTypeD:ne,coinTypeE:pe,position:ee,delta_liquidity:me,rewards_num:ve,positionInfo:se}=q;console.log("getRemoveLiquidityTransactionPayload params##",q);const _e=await V(j.poolAddress),Fe={...j,..._e},Oe=Number(ee.tick_lower_index),De=Number(ee.tick_upper_index),it=Se.tickIndexToSqrtPriceX64(Oe),Ie=Se.tickIndexToSqrtPriceX64(De),ht=It.getCoinAmountFromLiquidity(me,new y(Fe.current_sqrt_price),it,Ie,!0),Pt=U(ht.coinA.toString()).mul(U(1-q.slippage)),Ve=U(ht.coinB.toString()).mul(U(1-q.slippage)),Bn=[K,J,Q,ne,pe].filter(Jn=>!!Jn);let ft;console.log("0331###remove###params###",{coin_types:Bn,min_amount_a:Et(Pt.toString(),0),min_amount_b:Et(Ve.toString(),0),pool_id:j.poolAddress,pos_id:q.position.pos_object_id}),console.log("0331###delta_liquidity.toString()###",me.toString()),console.log("0331###position.liquidity###",ee.liquidity);const dt=[];return Q&&dt.push(Q),ne&&dt.push(ne),pe&&dt.push(pe),(se==null?void 0:se.positionSource)==="farming"?me.toString()===ee.liquidity?(console.log({pool_id:se==null?void 0:se.pool_id,coinTypeA:K,coinTypeB:J,position_nft_id:se==null?void 0:se.id,clmm_pool_id:se==null?void 0:se.clmm_pool_id,min_amount_a:Et(Pt.toString(),0)||"",min_amount_b:Et(Ve.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...dt],delta_liquidity:se==null?void 0:se.liquidity,unstake:!0,close_position:!0,clmm_position_id:q.position.clmm_position_id},"1191##"),ft=await s.Farms.removeLiquidityPayload({pool_id:se==null?void 0:se.pool_id,coinTypeA:K,coinTypeB:J,position_nft_id:se==null?void 0:se.id,clmm_pool_id:se==null?void 0:se.clmm_pool_id,min_amount_a:Et(Pt.toString(),0)||"",min_amount_b:Et(Ve.toString(),0)||"",collect_fee:!0,collect_rewarder:!0,clmm_rewarder_types:[...dt],delta_liquidity:se==null?void 0:se.liquidity,unstake:!0,close_position:!0,clmm_position_id:q.position.clmm_position_id}),console.log(ft,"result#####1210")):ft=await s.Farms.removeLiquidityPayload({pool_id:se==null?void 0:se.pool_id,coinTypeA:K,coinTypeB:J,position_nft_id:se==null?void 0:se.id,clmm_pool_id:se==null?void 0:se.clmm_pool_id,min_amount_a:Et(Pt.toString(),0)||"",min_amount_b:Et(Ve.toString(),0)||"",collect_rewarder:!1,clmm_rewarder_types:[...dt],delta_liquidity:me.toString(),unstake:!1,close_position:!1}):me.toString()===ee.liquidity?ft=await i.Position.closePositionTransactionPayload({coinTypeA:K,coinTypeB:J,min_amount_a:Et(Pt.toString(),0)||"",min_amount_b:Et(Ve.toString(),0)||"",rewarder_coin_types:[...dt],pool_id:j.poolAddress,pos_id:q.position.pos_object_id,collect_fee:!0}):(console.log(dt,"==>rewarder_coin_types"),ft=await i.Position.removeLiquidityTransactionPayload({coinTypeA:K,coinTypeB:J,delta_liquidity:me.toString(),min_amount_a:Et(Pt.toString(),0)||"",min_amount_b:Et(Ve.toString(),0)||"",pool_id:j.poolAddress,pos_id:q.position.pos_object_id,collect_fee:!0,rewarder_coin_types:[...dt]})),console.log("0331###remove###result####",ft),T(ft)},ue=async(q,j)=>{const K=[];q.coinTypeC&&K.push(q.coinTypeC),q.coinTypeD&&K.push(q.coinTypeD),q.coinTypeE&&K.push(q.coinTypeE),console.log("0423###getCollectRewarderTransactionPayload###params###",{pool_id:q.pool_address,pos_id:q.pos_index,rewarder_coin_types:[...K],coinTypeA:q.coinTypeA,coinTypeB:q.coinTypeB,collect_fee:!1}),console.log(j,"##getCollectRewarderTransactionPayload");let J;if(j.positionSource=="farming"){const Q={coinTypeA:j.coinTypeA,coinTypeB:j.coinTypeB,clmm_pool_id:j.clmm_pool_id,position_nft_id:j.id,clmm_rewarder_types:K,collect_fee:!0};J=await s.Farms.claimFeeAndClmmReward(Q)}else J=await i.Rewarder.collectRewarderTransactionPayload({pool_id:q.pool_address,pos_id:q.pos_index,rewarder_coin_types:[...K],coinTypeA:q.coinTypeA,coinTypeB:q.coinTypeB,collect_fee:q.collect_fee});return T(J)},Ne=async q=>{console.log("1130###getCollectFeeTransactionPayload###params",{pool:q.pool.poolAddress,coinTypeA:q.pool.token_a.address,coinTypeB:q.pool.token_b.address,pos_index:q.position.index});const j=await i.Position.collectFeeTransactionPayload({coinTypeA:q.pool.token_a.address,coinTypeB:q.pool.token_b.address,pool_id:q.pool.poolAddress,pos_id:q.position.pos_object_id});return console.log("1130###getCollectFeeTransactionPayload###result##",j),T(j)},Le=async()=>await i.Pool.getPoolImmutables(),st=(q,j)=>!!iu(Xp(q),Xp(j)),We=async q=>{const{coinTypeA:j,coinTypeB:K,decimalsA:J,decimalsB:Q,amountA:ne,amountB:pe,minPrice:ee,maxPrice:me,fix_amount_a:ve,tick_spacing:se,slippage:_e,price:Fe}=q;console.log(q,"###getCreatPoolTransactionPayload 1201");const Oe=Se.priceToSqrtPriceX64(U(Fe),J,Q);console.log("0407###getCreatPoolTransactionPayload###currentSqrtPrice###",Oe);const De=Se.priceToTickIndex(U(Fe),J,Q);console.log("0407###getCreatPoolTransactionPayload###currentTickIndex###",De);let it,Ie;if(ee==="0"&&me==="∞")it=Fr.getMinIndex(Number(se)),Ie=Fr.getMaxIndex(Number(se));else{const dt=Number(ee)==0?-443636:Se.priceToTickIndex(U(ee),J,Q),Jn=Se.priceToTickIndex(U(me),J,Q);it=Bc(dt,Number(se)),Ie=Bc(Jn,Number(se))}console.log("0407###getCreatPoolTransactionPayload###tick_lower###",it),console.log("0407###getCreatPoolTransactionPayload###tick_upper###",Ie);const ht=ve?sn(ne,J):sn(pe,Q);let Pt,Ve;Se.tickIndexToSqrtPriceX64(it),Se.tickIndexToSqrtPriceX64(Ie);let gt;De>=it&&De<=Ie?(gt=It.estLiquidityAndcoinAmountFromOneAmounts(it,Ie,new y(ht.toString()),ve,!0,_e,Oe),Pt=ve?ht.toString():gt.tokenMaxA.toString(),Ve=ve?gt.tokenMaxB.toString():ht.toString()):De>Ie?(Pt="0",Ve=U(pe).mul(U(Math.pow(10,Q))).toString()):De<it&&(Pt=U(ne).mul(U(Math.pow(10,J))).toString(),Ve="0"),it<-443636&&(it=Fr.getMinIndex(Number(se))),Ie>443636&&(Ie=it=Fr.getMaxIndex(Number(se))),console.log("0407####create pool params###",JSON.stringify({tick_spacing:se,initialize_sqrt_price:Oe.toString(),uri:"",fix_amount_a:ve,amount_a:Pt,amount_b:Ve,tick_lower:it,tick_upper:Ie,coinTypeA:j,coinTypeB:K}));const Bn=await i.Pool.creatPoolTransactionPayload({tick_spacing:se,initialize_sqrt_price:Oe.toString(),uri:"",fix_amount_a:ve,amount_a:Pt,amount_b:Ve,slippage:_e,tick_lower:it,tick_upper:Ie,coinTypeA:j,coinTypeB:K});console.log("0412####result###",Bn);const ft=await w(Bn);return console.log("0412####simulateRes###",ft),T(Bn)},$e=q=>{const j=q.split("0x");return"0x"+(j[1][0]==="0"?j[1].substring(1):j[1])};return{setTransations:E,showTransitionPending:d,showTransitionSuccess:p,showTransitionError:g,watchTransaction:b,getAccount:P,getTokenList:k,getLpList:$,getPools:H,getPool:V,mintCoin:z,handleTx:X,TickUtil:Fr,TickMath:Se,getNearestTickByTick:Bc,getTicks:L,getEstPositionAPRWithMulti:B,getCoinAmountFromLiquidity:O,estLiquidityAndcoinAmountFromOneAmounts:v,getAddLiquidityTransactionPayload:h,getTickDataFromUrlData:SB,getPriceImpactPct:_,preSwap:A,getSwapTransactionPayload:C,getPositionList:M,getTickDataByIndex:x,getCollectFeesQuote:m,getPosRewardersAmount:R,getNftHash:ye,getPositionInfo:N,getRemoveLiquidityTransactionPayload:ce,getCollectRewarderTransactionPayload:ue,getCollectFeeTransactionPayload:Ne,getPoolImmutables:Le,estimateLiquidityForCoinA:Zr,estimateLiquidityForCoinB:Yr,getCreatPoolTransactionPayload:We,getTokenListByCoinType:async q=>{const j=localStorage.getItem("coinMatedataLocal"),K=j?JSON.parse(j):{};try{let J=[];const Q=[];if(q&&typeof q=="string"){if(K[$e(q)])return[K[$e(q)]];J=[$e(q)]}else{const me=[];if(q.forEach(ve=>{K[$e(ve)]?Q.push(K[$e(ve)]):me.push($e(ve))}),me.length===0)return Q;J=[...me]}const ne=await i.CetusConfig.getTokenListByCoinTypes(J);console.log("0714###getTokenListByCoinType###result###",ne);const pe=[],ee={};return Object.values(ne).forEach(me=>{const ve={...me,address:ae(me.address).full_address};pe.push(ve),ee[me.address]=ve}),console.log("0714###getTokenListByCoinType###formatResult###",pe),localStorage.setItem("coinMatedataLocal",JSON.stringify({...K,...ee})),[...pe,...Q]}catch{return[]}},getIsSortedSymbols:st,getPositionById:F,d:U,getTokenBySymbol:async(q,j)=>{if(!j)return null;let K=null;console.log("getTokenBySymbol###tokensObj###",q);for(const J in q){const Q=q[J];if(Q.address.toUpperCase()===ae(j).full_address.toUpperCase()){K=Q;break}}if(!K){const J=j.split("0x"),Q="0x"+(J[1][0]==="0"?J[1].substring(1):J[1]),ne=await i.CetusConfig.getTokenListByCoinTypes([Q]);ne&&ne[Q]&&(K={...ne[Q],isSelfBuilt:!0,address:ae(j).full_address})}return K},preSwapWithMultiPool:async q=>{const{a2b:j,byAmountIn:K,amount:J,decimalsA:Q,decimalsB:ne}=q;let pe;j&&K||!j&&!K?pe=sn(J,Q):pe=sn(J,ne);const ee=await i.Swap.preSwapWithMultiPool({poolAddresses:q.poolAddresses,coinTypeA:q.coinTypeA,coinTypeB:q.coinTypeB,a2b:j,byAmountIn:K,amount:pe});return{...ee,estimatedAmountIn:Cs($t(ee.estimatedAmountIn.toString(),j?Q:ne),j?Q:ne),estimatedAmountOut:Cs($t(ee.estimatedAmountOut.toString(),j?ne:Q),j?ne:Q)}},initSwapRouter:async(q,j)=>{console.log(q,"===>paths"),console.log(j,"===>coins"),i.Router.loadGraph(j,q),console.log(i,"sdk===>1826")},getSwapRouter:async(q,j,K,J,Q,ne="",pe,ee)=>{const me=q.value.decimals,ve=j.value.decimals,se=localStorage.getItem("swapOrderSplit"),_e=localStorage.getItem("includeRoutes"),Fe=se=="open"||!se,Oe=_e=="open";let De;try{return De=await i.RouterV2.getBestRouter(q.value.address,j.value.address,K,J,Q,ne,i.senderAddress,pe,Fe,Oe,ee),{amountIn:$t(De.result.inputAmount.toString(),me),amountOut:$t(De.result.outputAmount.toString(),ve),...De.result}}catch(it){console.log(it)}},getSwapRouterPayload:async(q,j)=>{console.log(q,"===>createTxParams");const K=await i.getOwnerCoinAssets(i.senderAddress);console.log(K,"===>allCoinAsset");const J=await tt.buildAggregatorSwapTransaction(i,q,K,"",j);return T(J)},fetchPosRewardersAmount:async q=>{const j=await i.Rewarder.fetchPosRewardersAmount([q]),K=j&&j[0];return K&&K.rewarderAmountOwed},estCoinAmountsFromTotalAmount:q=>{const{lowerTick:j,upperTick:K,decimalsA:J,decimalsB:Q,curSqrtPrice:ne,totalAmount:pe,tokenPriceA:ee,tokenPriceB:me}=q;console.log(JSON.stringify({...q,curSqrtPrice:ne.toString()}),"params===>");const ve=It.estCoinAmountsFromTotalAmount(j,K,ne,pe,ee,me);console.log("coinAmounts: ",ve);const se=eu(ve.amountA.toFixed(J,ie.ROUND_UP).toString(),J),_e=eu(ve.amountB.toFixed(Q,ie.ROUND_UP).toString(),Q),Fe={coinA:new y(se),coinB:new y(_e)};return{amountA:$t(se.toString(),J),amountB:$t(_e.toString(),Q),tokenAmountsInfo:Fe}},getCreateAddLiquidityPayload:async q=>{const{curSqrtPrice:j,tickLower:K,tickUpper:J,tokenAmounts:Q,pool:ne,slippage:pe}=q;console.log(JSON.stringify(q),"####getCreateAddLiquidityPayload 1593");const ee=It.estimateLiquidityFromcoinAmounts(j,K,J,Q),me=new ie(Q.coinA.toString()).mul(1+pe),ve=new ie(Q.coinB.toString()).mul(1+pe),se={coinTypeA:ne.coinTypeA,coinTypeB:ne.coinTypeB,pool_id:ne.address,tick_lower:K,tick_upper:J,delta_liquidity:ee.toString(),max_amount_a:ie.ceil(me).toString(),max_amount_b:ie.ceil(ve).toString(),pos_id:"",rewarder_coin_types:[],collect_fee:!1};console.log(JSON.stringify(se),"==>addLiquidityPayloadParams");const _e=await i.Position.createAddLiquidityPayload(se);return T(_e)},calculateDepositRatioFixTokenA:(q,j,K)=>It.calculateDepositRatioFixTokenA(q,j,K)}}function Nn(t){let e={};return!t||t==="Aptos"?e=MP():e=S4(t),{...e}}const Xi="0x26b3bc67befc214058ca78ea9a2690298d731a2d4309485ec3d40198063c4abc",x4=[{base_symbol:`${Xi}::btc::BTC`,price:"175181.584616",quote_symbol:"USD"},{base_symbol:`${Xi}::eth::ETH`,price:"1471.343485",quote_symbol:"USD"},{base_symbol:`${Xi}::usdc::USDC`,price:"0.998772",quote_symbol:"USD"},{base_symbol:`${Xi}::usdt::USDT`,price:"0.949513",quote_symbol:"USD"},{base_symbol:`${Xi}::busd::BUSD`,price:"1",quote_symbol:"USD"},{base_symbol:"0x2::sui::SUI",price:"1",quote_symbol:"USD"}],cR=[{symbol:"USDT",name:"CetusUSDT",num:"200",amount:"200000000",transactionModule:"usdt",address:`${Xi}::usdt::USDT`,suplyID:"0x0a842204e4a64afe0da14749443754714343d1d9d246d71080bde331fc22de55",decimals:6},{symbol:"USDC",name:"CetusUSDC",num:"200",amount:"200000000",transactionModule:"usdc",address:`${Xi}::usdc::USDC`,suplyID:"0xdf6cb5a605e6f91120ac2fe925b897ca44a393b53ad33d52634263774adc9db3",decimals:6},{symbol:"ETH",name:"CetusETH",num:"0.1",amount:"100000000",transactionModule:"eth",address:`${Xi}::eth::ETH`,suplyID:"0x093839657619586c99aa4ab883df94919be0a03eff6ee8206c0d546b2853e158",decimals:8},{symbol:"BTC",name:"CetusBTC",num:"0.01",amount:"10000000",transactionModule:"btc",address:`${Xi}::btc::BTC`,suplyID:"0x9742b5d1812263e1d9fea29467c39cf860ad1aed0993867485aa1c04c720f670",decimals:8}];ie.config({precision:64,rounding:ie.ROUND_DOWN,toExpNeg:-64,toExpPos:64});function gc(t){const e={launchpad:ke[t||"Sui"].launchpad,ido:ke[t||"Sui"].ido,xcetus:ke[t||"Sui"].xcetus,xcetus_dividends:ke[t||"Sui"].xcetus_dividends,cetus_faucet:ke[t||"Sui"].cetus_faucet,xtoken:ke[t||"Sui"].xtoken,xtoken_dividends:ke[t||"Sui"].xtoken_dividends,token_faucet:ke[t||"Sui"].token_faucet,booster:ke[t||"Sui"].booster,maker_bonus:ke[t||"Sui"].maker_bonus,liquidity_stratefy:ke[t||"Sui"].liquidity_stratefy,vaults:ke[t||"Sui"].vaults,frams:ke[t||"Sui"].frams},n={fullRpcUrl:localStorage.getItem(`${t}-currentRpclocal2`)||ke[t||"Sui"].fullRpcUrl,simulationAccount:ke[t||"Sui"].simulationAccount,cetus_config:ke[t||"Sui"].cetus_config,clmm_pool:ke[t||"Sui"].clmm_pool,integrate:ke[t||"Sui"].integrate,deepbook:ke[t||"Sui"].deepbook,deepbook_endpoint_v2:ke[t||"Sui"].deepbook_endpoint_v2,aggregatorUrl:ke[t||"Sui"].aggregatorUrl},i=new cI(n),s=Dc(new Ib(e,i)),o=ph(),r=Go(()=>o);M0(()=>{r.value.address&&(i.senderAddress=r.value.address)});const a=P=>({transactionBlock:P,options:{showEffects:!0,showEvents:!0,showInput:!0,showRawInput:!0,showObjectChanges:!0,showBalanceChanges:!0}}),c=async()=>{const P=await s.Farms.getFramsPoolList();return console.log(P.data,"##poolData.data"),P.data},u=async(P,k)=>{const S=await s.Farms.getOwnedFramsPositionNFTList(s.ClmmSDK.senderAddress,P,k,!1);return console.log(S,"##nftList.data"),S&&!CP(S)?S.data?S.data:Object.values(S)[0]:[]},l=async(P,k)=>{console.log(P,k,"farmsDeposit##");const S=await s.Farms.depositPayload({pool_id:k,clmm_position_id:P.clmm_position_id});return a(S)},d=async(P,k)=>{console.log(P,k,"####positionNftId");const S=await s.Farms.withdrawPayload({pool_id:P,position_nft_id:k});return a(S)},p=async P=>await s.Farms.calculateFarmingRewards(P,!1),g=async P=>{const k=await s.Farms.harvestPayload(P);return a(k)},b=async P=>{console.log(P,"##batchHarvest");const k=await s.Farms.batchHarvestPayload(P);return a(k)},w=(P,k,S)=>{const $=P.tick_lower_index,H=P.tick_upper_index,{liquidity:V}=P,{price:z,effective_tick_lower:X,effective_tick_upper:L,total_wrapped_amount:B}=k;console.log(k,"farmPoolInfo##");const O=Qr.calculatePositionShare($,H,V,z,X,L,S);return new ie(O).div(new ie(B)).mul(100).toString()};return console.log(i,"###clmmSdk"),{getFramsPoolList:c,getOwnedFramsPositionNFTList:u,farmsDeposit:l,farmsWithdraw:d,calculateFarmingRewards:p,harvestFarms:g,batchHarvest:b,calculatePositionShare:w,fetchPosFeeAmount:async P=>{const k=await i.Position.fetchPosFeeAmount(P);return console.log("fetchPosFeeAmount:",k),[{feeOwedA:new ie(k[0].feeOwedA.toString()).div(Math.pow(10,P[0].decimalA)).toString(),feeOwedB:new ie(k[0].feeOwedB.toString()).div(Math.pow(10,P[0].decimalB)).toString()}]},getFramsPositionNFT:async P=>await s.Farms.getFramsPositionNFT(P,!0)}}const P4=Ub("pool",{state:()=>({tokens:[],tokensObj:{},pools:[],poolsObj:{},myPositions:[],addressLpTokens:{},addressTokens:{},currentPositionLoading:!1,myPositionsLoading:!0,poolsLoading:!0,RATES:{},currentPositionInfo:{},poolConfigList:[],feeOwedObj:{},rewarderObj:{},chinaTokens:[],chinaTokensObj:{},getPoolInfoSuccess:!1,recommendRangesObj:{},allTokenObj:{},isTokenLoading:!0,poolPriceConfigObj:{},defaultPoolInfo:{},poolConfigObj:{},openPool:[],routerPoolConfigObj:{},tokensWarningObj:{},currentChain:"",liquidityCurrentPoolInfo:{},positionDetailCurrentTab:"increase",positionActionAmount:{fromCoinAmount:"",toCoinAmount:""},currentPoolTab:"All",currentPoolMoreInfo:{},poolPositions:[],autoPoolNum:"--",tokenExternalPriceObj:{}}),actions:{async setLiquidityCurrentPoolInfo(t){this.liquidityCurrentPoolInfo=t},async setCurrentPoolMoreInfo(t){this.currentPoolMoreInfo=t},async setChainPoolConfigList(t){this.poolConfigList=t,this.pools=t},async setCurrentPoolTab(t){this.currentPoolTab=t},async setPoolConfigList(t,e){const i=await Nn(t).getLpList(e),s=[],o=[],r=[];i.forEach(c=>{var l,d;const u={...c,token_a:{...c==null?void 0:c.coinA,logoURI:(l=c==null?void 0:c.coinA)==null?void 0:l.logo_url},token_b:{...c==null?void 0:c.coinB,logoURI:(d=c==null?void 0:c.coinB)==null?void 0:d.logo_url},isFarming:c.is_display_rewarder&&(c.rewarder_display1||c.rewarder_display2||c.rewarder_display3),chain:t==="Aptos"?"aptos":"sui",fee_rate:c.fee*1e4,routerSymbol:[c.coin_a_address,c.coin_b_address].sort(function(p,g){return g.localeCompare(p)}).join("-")};c.is_closed||s.push(u),t=="Sui"&&!c.object.is_pause&&o.push(u),r.push(u)}),console.log("0509###setPoolConfigList###",o),this.poolConfigList=t=="Aptos"?s:o,this.poolConfigObj=t=="Aptos"?Object.fromEntries(s.map((c,u)=>[c.address,c])):Object.fromEntries(o.map((c,u)=>[c.address,c]));const a=r.filter(c=>!c.is_pause);this.openPool=a,this.routerPoolConfigObj=Object.fromEntries(a.map((c,u)=>[c.address,c]))},async getRecommendRanges(t){var n;let e=null;if(t&&t.includes("Sui")?e=await $fetch(`${ke[t].api}/v2/sui/liquidity/recommend_ranges`):e=await $fetch(`${ke.Aptos.api}/v2/liquidity/recommend_ranges`),(n=e==null?void 0:e.data)!=null&&n.list){const i=Object.fromEntries(e.data.list.map((s,o)=>[s.address,s]));this.recommendRangesObj=i,this.poolPriceConfigObj=i}else this.recommendRangesObj={},this.poolPriceConfigObj={}},async setPools(t,e){this.poolsLoading=!0,this.getPoolInfoSuccess=!1,this.poolsObj={},this.currentChain=e;const n=Nn(e);if((e==null?void 0:e.toLowerCase())==="aptos"){if(t&&t.length>0){for(let i=0;i<t.length&&e===this.currentChain;i++){const s=t[i],o=await n.getPools([s.address]);this.defaultPoolInfo[o[0].poolAddress]=o[0],this.poolsObj[o[0].poolAddress]={...s,...o[0],fee:Number(o[0].fee_rate)/1e6},this.addressLpTokens=this.poolsObj,this.poolsLoading=!1,await zo(500)}this.getPoolInfoSuccess=!0}}else if(t&&t.length>0){const i=await n.getPools([]),s={};for(let o=0;o<t.length;o++){const r=t[o];console.log(r,"==>data");const a=i[r.address];a?s[r.address]={...r,...a,fee:Number(a==null?void 0:a.fee_rate)/1e6}:s[r.address]={...r}}console.log("0605###setPools###result###",s),this.poolsObj=s,this.addressLpTokens=s,this.poolsLoading=!1,this.getPoolInfoSuccess=!0}},async setSinglePool(t,e,n){const s=await Nn(n).getPool(t.address);console.log(e,"recommendRangesInfo");const o={...t,...s,fee:s.fee_rate/1e6,type:(e==null?void 0:e.type)||""};console.log("0506###setSinglePool###result###",o),this.poolsObj[t.address]=o,console.log(this.poolsObj,"===>173"),this.addressLpTokens[t.address]=o},async updateCurrentPools(t,e){const n=Nn(e),i=this.poolsObj[t];if(console.log(i,"===>currentPool"),i){let s={};e&&e.includes("Sui")?s=await n.getPool((i==null?void 0:i.poolAddress)||(i==null?void 0:i.address)):s=await n.getPoolState(i.poolAddress,i.poolType,!1),console.log("0411###debug###newInfo####",s);const o={...this.poolsObj},r={...o[t],...s};console.log("0411###debug###newCurrentInfo####",r),o[t]={...r},console.log("0411###debug###newPoolsObj####",o),this.poolsObj=o}},async setTokens(t){const e=[];console.log("0613###setTokens####111111###",t);const n=Nn(t);console.log("0613###setTokens####22222###contract###",n);const i=await n.getTokenList();console.log("0613###setTokens####22222###res###",i),i.forEach(o=>{e.push({...o,logoURI:o.logo_url,chain:t.toLowerCase()})}),console.log(e,"result===>237"),this.tokens=e;const s=Object.fromEntries(e.map((o,r)=>[o.address,o]));s["0x2::sui::SUI"]&&!s["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]&&(s["0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"]=s["0x2::sui::SUI"]),this.tokensObj=s,this.tokensWarningObj={"0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI":{},...Object.fromEntries(e.map((o,r)=>[o.address,o]))},this.isTokenLoading=!1,console.log(this.tokensWarningObj,"===>this.tokensWarningObj ")},async setChinaTokens(t){const n=await Nn(t).getTokenListByCoinType();console.log(n,"chinares===>");const i=[];n.forEach(s=>{i.push({...s,logoURI:t=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png",logo_url:t=="Aptos"?"https://archive.cetus.zone/assets/image/default1.png":"https://archive.cetus.zone/assets/image/default2.png"})}),this.chinaTokens=i,this.chinaTokensObj=Object.fromEntries(i.map((s,o)=>[s.address,s]))},setCurrentPositionLoading(t){this.currentPositionLoading=t},setMyPositionsLoading(t){this.myPositionsLoading=t},async setRates(t){let e={};if(t&&t.includes("Sui"))try{e=await $fetch(`${ke.Sui.api}/v2/sui/price`)}catch(s){console.log("sui pric api error ###",s),e={data:{prices:x4}}}else e=await $fetch(`${ke.Aptos.api}/v2/price`);const n=e.data.prices||[],i=[];n.forEach(s=>{s.base_symbol=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?i.push({...s},{...s,base_symbol:"0x2::sui::SUI"}):i.push(s)}),this.RATES=Object.fromEntries(i.map(s=>[s.base_symbol,s])),console.log(this.RATES,"===>this.RATES")},async getMyPositons(t,e,n){console.log("0507###getMyPositons###start###",e),this.setMyPositionsLoading(!0);const i=Nn(n),s=await i.getPositionList(t,e)||[];let o=[];n=="Sui"&&(o=(await gc("Sui").getOwnedFramsPositionNFTList([],!0)).map(d=>{const p=[];let g=new ie(0);return d.rewards.forEach(b=>{var S;const w=b.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":b.rewarder_type,T=this.tokensObj[w],E=((S=this.RATES[w])==null?void 0:S.price)||0,P=new ie(b.rewarder_amount).div(new ie(Math.pow(10,T.decimals))),k=P.mul(new ie(E));g=g.add(k),P.toNumber()>0&&p.push({...b,amount:P,rewarderAmountUsd:k.toString(),address:w,symbol:T.symbol})}),{...d,rewards:p,farmingRewardTotalUsd:g.toNumber()}}),console.log("farmingPositionList:",o)),console.log("0507###getMyPositons###positionList###",s),s.length<1&&this.setMyPositionsLoading(!1);const r=o.concat(s);console.log(r,"##allPositionList");const a=[];r.forEach(u=>{var S,$,H,V;const l=e[u.pool||u.clmm_pool_id];let d,p,g,b,w="",T,E,P,k;if(console.log("allPositionList item:",u),u.liquidity&&u.liquidity!=="0"&&l){const z={creator:u.creator,collection:u.collection,name:u.name};n==="Aptos"?k=i.getNftHash(z):k=i.getNftHash(u);const X=l.token_a.decimals,L=l.token_b.decimals;console.log(l,"poolInf=====>"),l!=null&&l.current_sqrt_price&&(g=i.TickMath.sqrtPriceX64ToPrice(l==null?void 0:l.current_sqrt_price,X,L).toString(),b=new ie(1).div(i.TickMath.sqrtPriceX64ToPrice(l==null?void 0:l.current_sqrt_price,X,L)).toString()),u.tick_lower_index==i.TickUtil.getMinIndex(Number(l.tickSpacing))?d="0":d=i.TickMath.tickIndexToPrice(Number(u.tick_lower_index),X,L).toString(),u.tick_upper_index==i.TickUtil.getMaxIndex(Number(l.tickSpacing))?p="∞":(p=i.TickMath.tickIndexToPrice(Number(u.tick_upper_index),X,L).toString(),console.log("0523###maxPrice###2222###",p));const B=l.needReverse?(($=this.tokensObj[l.coinB.address])==null?void 0:$.labels)||[]:((S=this.tokensObj[l.coinA.address])==null?void 0:S.labels)||[],O=l.needReverse?((H=this.tokensObj[l.coinA.address])==null?void 0:H.labels)||[]:((V=this.tokensObj[l.coinB.address])==null?void 0:V.labels)||[],v=[...new Set(B.concat(O))],h=i.getCoinAmountFromLiquidity({pool:l,position:u,roundUp:n!="Sui"}),_=h.coinaAmount,A=h.coinbAmount;console.log(g,"===>currentPrice");const C=Number(A)+Number(_)*Number(g);let M=(Number(_)*Number(g)/C*100).toFixed(0),N=(A/C*100).toFixed(0);d=="0"&&p=="∞"&&(M="50",N="50"),l.isPause?w="Closed":Number(g)>=Number(d)&&(p==="∞"||Number(g)<=Number(p))?w="Active":(Number(g)>Number(p)||Number(g)<Number(d))&&(w="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[l.token_a.address]),console.log("0323###poolInfo.token_a.address####",l.token_a.address),console.log("0323###poolInfo.token_b.address####",l.token_b.address);let F={},x={};n==="Aptos"?(F={...l.token_a,...this.tokensObj[l.token_a.address],logoURI:this.tokensObj[l.token_a.address].logo_url},x={...l.token_b,...this.tokensObj[l.token_b.address],logoURI:this.tokensObj[l.token_b.address].logo_url}):(F=l==null?void 0:l.token_a,x=l==null?void 0:l.token_b),a.push({...l,...u,labels:v,totalAmount:C,token_a:F,token_b:x,tokenARates:T,tokenBRates:E,amountA:_,amountB:A,fromPercent:M,toPercent:N,amountUSD:P,tokenName:u.tokenName||u.name,currentStatus:w,positionLiquidity:u.liquidity,nftHash:k,currentPrice:g,currentPriceReverse:b,minPrice:$i(d,12),maxPrice:$i(p,12),positionSource:u.id?"farming":"clmm",farmingRewardTotalUsd:u.id?u.farmingRewardTotalUsd:0})}});const c=a.sort((u,l)=>l.amountUSD-u.amountUSD);this.myPositions=c,this.setMyPositionsLoading(!1),this.getPendingFees(c,n),this.getRewarderV2(c,n),console.log(c,"===>this.myPositions")},async setCurrentPositionInfo(t,e,n,i,s="",o=""){var g,b,w,T,E,P;const r=Nn(i);let a;i=="Sui"&&(a=gc(i));let c=null,u=null,l=null,d=null,p=null;if(t&&s||i==="Aptos"?(c=this.addressLpTokens&&this.addressLpTokens[t],u=await r.getPool(t),p=this.poolConfigObj[t],console.log(p,"===>poolConfig"),l={...c,...u,...p},console.log(l,"423"),d=await r.getPositionInfo(l,e,n,s)):i!=="Aptos"&&(console.log("0414###setCurrentPositionInfo###",s),d=o=="farming"?await a.getFramsPositionNFT(s):await r.getPositionById(s),console.log(d,"setCurrentPositionInfo:positionInfo"),u=o=="farming"?await r.getPool(d.clmm_pool_id):await r.getPool(d.pool),c=this.addressLpTokens&&this.addressLpTokens[d.pool||this.addressLpTokens.poolAddress],p=this.poolConfigObj[d.clmm_pool_id||d.pool],console.log(this.poolConfigObj[d.clmm_pool_id],"##this.poolConfigObj[poolAddress]"),l={...c,...u,...p},console.log("poolInfoNew:",c,u),console.log("0414###setCurrentPositionInfo###positionInfo###",d),console.log("0414###setCurrentPositionInfo###poolInfo###",l)),console.log("setCurrentPositionInfo:",l),d&&l){let k,S,$,H,V="",z,X,L,B,O,v=0,h=0,_;const A={creator:d.pool,collection:d.collectionName,name:d.name};i==="Aptos"?_=r.getNftHash(A):_=r.getNftHash(d),console.log("0329###setCurrentPositionInfo###poolInfo###",l),console.log("0329###setCurrentPositionInfo###positionInfo###",d);let C=0,M=0;if(l!=null&&l.token_a&&(l!=null&&l.token_b))C=(g=l==null?void 0:l.token_a)==null?void 0:g.decimals,M=(b=l==null?void 0:l.token_b)==null?void 0:b.decimals;else{const N=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeA))[0],F=(await r.getTokenListByCoinType(l==null?void 0:l.coinTypeB))[0];C=N==null?void 0:N.decimals,M=F==null?void 0:F.decimals,l.coinA=N,l.coinB=F,l.token_a=N,l.token_b=F}if(console.log("开始计算fee"),l){try{let ue;if(o!=="farming"){const Ne=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_lower_index)),Le=await r.getTickDataByIndex(l.ticks_handle,Number(d.tick_upper_index));ue=await r.getCollectFeesQuote({pool:l,position:d,tickLowerData:Ne,tickUpperData:Le})}else{console.log(l,l.token_a,"setCurrentPositionInfo:poolInfo");const Ne=[{poolAddress:l.poolAddress,positionId:d.clmm_position_id,coinTypeA:l.coinTypeA,coinTypeB:l.coinTypeB,decimalA:l.token_a.decimals,decimalB:l.token_b.decimals}];console.log(Ne,"params###");const Le=await a.fetchPosFeeAmount(Ne);console.log(Le,"##farmingPositionFee"),ue=Le[0]}console.log(ue,"setCurrentPositionInfo feeOwn:"),ue&&(v=Number(ue.feeOwedA),h=Number(ue.feeOwedB))}catch(ue){console.log("0314###getCollectFeesQuote###error####",ue)}console.log("0413####setCurrentPositionInfo###poolInfo###",l),$=r.TickMath.sqrtPriceX64ToPrice(l.current_sqrt_price,C,M).toString(),H=new ie(1).div(r.TickMath.sqrtPriceX64ToPrice(l==null?void 0:l.current_sqrt_price,C,M)).toString(),d.tick_lower_index==r.TickUtil.getMinIndex(Number(l.tickSpacing))?k="0":k=r.TickMath.tickIndexToPrice(Number(d.tick_lower_index),C,M).toString(),d.tick_upper_index==r.TickUtil.getMaxIndex(Number(l.tickSpacing))?S="∞":S=r.TickMath.tickIndexToPrice(Number(d.tick_upper_index),C,M).toString(),z=d.tick_lower_index,X=d.tick_upper_index;const N=r.getCoinAmountFromLiquidity({pool:l,position:d,roundUp:i!="Sui"});let F,x,m;console.log($,"===>currentPrice522"),$&&$>0&&(B=N==null?void 0:N.coinaAmount,O=N==null?void 0:N.coinbAmount,console.log(N,"===>amountInfo"),console.log($,"===>currentPrice"),m=Number(O)+Number(B)*Number($),console.log(m,"===>totalAmount"),F=(Number(B)*Number($)/m*100).toFixed(0),console.log(F,"===>fromPercent"),x=(Number(O/Number(m))*100).toFixed(0),console.log(x,"==>toPercent"));let R;const ye=N.coinaAmount*((w=this.RATES[l==null?void 0:l.token_a.address])==null?void 0:w.price),ce=N.coinbAmount*((T=this.RATES[l==null?void 0:l.token_b.address])==null?void 0:T.price);(E=this.RATES[l==null?void 0:l.token_a.address])!=null&&E.price&&((P=this.RATES[l==null?void 0:l.token_b.address])!=null&&P.price)&&(R=ye+ce),console.log(R,"==>totalAmountUSD"),l.isPause?V="Closed":Number($)>=Number(k)&&(S==="∞"||Number($)<=Number(S))?V="Active":(Number($)>Number(S)||Number($)<Number(k))&&(V="Inactive"),this.currentPositionInfo={...d,poolInfo:l,token_a:{...l.token_a,...this.tokensObj[l.token_a.address]},token_b:{...l.token_b,...this.tokensObj[l.token_b.address]},current_tick_index:l.current_tick_index,current_sqrt_price:l.current_sqrt_price,tickSpacing:l.tickSpacing,fee:l.fee,poolAddress:l.poolAddress,address:l.address,is_display_rewarder:l.is_display_rewarder,nftHash:_,feeOwedA:v,feeOwedB:h,currentStatus:V,amountA:B,amountB:O,tokenARates:ye,tokenBRates:ce,amountUSD:L,totalAmount:m,totalAmountUSD:R,currentPrice:$,currentPriceReverse:H,minPrice:$i(k,12),minTick:z,maxTick:X,maxPrice:$i(S,12),fromPercent:F||"--",toPercent:x||"--",tokenName:d.tokenName||d.name,positionSource:d.id?"farming":"clmm"},setTimeout(()=>{this.currentPositionLoading=!1},3e3),console.log("positionInfo.value",this.currentPositionInfo)}}},async getPendingFees(t,e){var o,r;const n=this.RATES,i=Nn(e);let s;e=="Sui"&&(s=gc("Sui")),console.log("0302###getPendingFees####result###",t);for(let a=0;a<t.length;a++){const c=t[a],u=await i.getPool(c.poolAddress),l={...u,token_a:(c==null?void 0:c.token_a)||this.tokensObj&&this.tokensObj[u.coinTypeA]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeA],token_b:(c==null?void 0:c.token_b)||this.tokensObj&&this.tokensObj[u.coinTypeB]||this.chinaTokensObj&&this.chinaTokensObj[u.coinTypeB]};let d;if(t[a].positionSource=="farming"){console.log("result[i]:",t[a]);const k=[{poolAddress:c.poolAddress,positionId:c.clmm_position_id,coinTypeA:c.coinTypeA,coinTypeB:c.coinTypeB,decimalA:c.token_a.decimals,decimalB:c.token_b.decimals}],S=await s.fetchPosFeeAmount(k);console.log(S,"##farmingPositionFee"),d=S[0]}else if(u){const k=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_lower_index)),S=await i.getTickDataByIndex(u.ticks_handle,Number(c.tick_upper_index));console.log("0323####getPendingFees###pool###",u),console.log("0323####getPendingFees###positionItem.collection###",c.collection),console.log("0323####getPendingFees###positionItem.tokenName###",c.tokenName),console.log("0323####getPendingFees###positionItem###",c);const $=e==="Aptos"?"":c.pos_object_id,H=await i.getPositionInfo(u,c.collection,c.tokenName,$);console.log("0302###positionInfo",H),console.log("0302###resultPool###",l),console.log(u,"pool====>654"),d=await i.getCollectFeesQuote({pool:l,position:H,tickLowerData:k,tickUpperData:S})}console.log("0330###getPendingFees###feeOwn###",d);const p=[],g=Number(d.feeOwedA),b=Number(d.feeOwedB);let w,T,E;n&&n[l.token_a.address]&&n[l.token_b.address]?(T=g*((o=n[l.token_a.address])==null?void 0:o.price),E=b*((r=n[l.token_b.address])==null?void 0:r.price),w=T+E):w="--",p.push({amount:g,amountUSD:T,...l.token_a,logoURI:l.token_a.logo_url},{amount:b,amountUSD:E,...l.token_b,logoURI:l.token_b.logo_url});const P=this.poolConfigObj&&this.poolConfigObj[u.poolAddress];console.log(P,"poolConfigInfo===>710"),this.feeOwedObj[c.tokenName]={feesResult:P.needReverse?p.reverse():p,feeOwed:w},console.log(this.feeOwedObj,"===>this.feeOwedObj"),await zo(1e3)}},async getRewarder(t,e){const n=Nn(e),i=this;console.log(t,"===>results");for(let s=0;s<t.length;s++)if(t[s].rewarder_infos&&t[s].rewarder_infos.length>0){const o=t[s];console.log(s,"i===>"),console.log(o,"===>positionItem"),console.log(o.ticks_handle,"===>positionItem.ticks_handle"),console.log(o.tick_lower_index,"===>positionItem.tick_lower_index"),console.log(o.tick_upper_index,"===>positionItem.tick_upper_index");const r=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_lower_index)),a=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_upper_index));let c=[];e==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,positionName:o.tokenName,tickLowerData:r,tickUpperData:a}):c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,pos:o.pos_object_id,positionHandle:o.position_manager.positions_handle}),console.log(c,"rewarderInfo===>");const u=[];let l=0;c.forEach((d,p)=>{var T;const g=i.tokensObj[d.coin_address].decimals,b=d.amount_owed.toString(),w=Et(new ie(b).div(Math.pow(10,g)).toString(),g);if(o[`rewarder_display${p+1}`]||Number(w)>0){const E=i.tokensObj[d.coin_address];console.log(d.amount_owed.toString(),"===>element.amount_owed.toString()");const P=(T=i.RATES[d.coin_address])==null?void 0:T.price;console.log(P,"price===>"),console.log(w,"==>amount");const k=Number(w)*P;l+=k,u.push({...d,...E,amount:w,amountUSD:k,amount_owed:d.amount_owed.toString()}),i.rewarderObj[o.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(Et(l,2)),pendingRewarder:l}}}),console.log(i.rewarderObj,"===>_this.rewarderObj"),await zo(1e3)}},async getRewarderV2(t,e){const n=Nn(e),i=this;console.log(t,"===>results");for(let s=0;s<t.length;s++){const o=t[s];if(t[s].rewarder_infos&&t[s].rewarder_infos.length>0){console.log(o,"===>positionItem");const r=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_lower_index)),a=await n.getTickDataByIndex(o.ticks_handle,Number(o.tick_upper_index));let c=[];e==="Aptos"?c=await n.getPosRewardersAmount({poolAddress:o.poolAddress,positionName:o.tokenName,tickLowerData:r,tickUpperData:a}):(console.log("###fetchPosRewardersAmount"),console.log({poolAddress:o.poolAddress,positionId:o.positionSource=="clmm"?o.pos_object_id:o.clmm_position_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos},"955##"),c=await n.fetchPosRewardersAmount({poolAddress:o.poolAddress,positionId:o.positionSource=="clmm"?o.pos_object_id:o.clmm_position_id,coinTypeA:o.coinTypeA,coinTypeB:o.coinTypeB,rewarderInfo:o.rewarder_infos}),console.log(c,"###rewarderInfo"));const u=[];let l=0;c.forEach((d,p)=>{var T;const g=i.tokensObj[d.coin_address].decimals,b=d.amount_owed.toString(),w=Et(new ie(b).div(Math.pow(10,g)).toString(),g);if(o[`rewarder_display${p+1}`]||Number(w)>0){const E=i.tokensObj[d.coin_address],P=((T=i.RATES[d.coin_address])==null?void 0:T.price)||0;console.log(P,"price===>"),console.log(w,"==>amount");const k=Number(w)*P;l+=k,u.push({...d,...E,amount:w,amountUSD:k,amount_owed:d.amount_owed.toString()}),i.rewarderObj[o.tokenName]={pendingRewarderArr:u,pendingRewarderView:Number(Et(l,2)),pendingRewarder:l}}}),await zo(1e3)}console.log(i.rewarderObj,"===>_this.rewarderObj")}},setAllTokenObj(t){console.log(t,"===>allTokenObj"),this.allTokenObj=t},async trappingTokenObj(t,e,n){const i={};t.forEach(r=>{!e[r.coinA.address]&&!i[r.coinA.address]&&(i[r.coinA.address]=r),!e[r.coinB.address]&&!i[r.coinB.address]&&(i[r.coinB.address]=r)}),console.log("trappingTokenObj###lackTokensObj####",i);const s=Nn(n),o=Object.keys(i);if(console.log("trappingTokenObj###params###",o),o.length>0){const r=await s.getTokenListByCoinType(o);console.log("trappingTokenObj###result###",r);const a={};r.forEach(c=>{a[c.address]={...c,isSelfBuilt:!0}}),this.tokensObj={...this.tokensObj,...a}}},setNewTokens(t){console.log("setNewTokens###走到这里了吗####newTokenObj###",t),this.tokensObj={...this.tokensObj,...t},console.log("setNewTokens###this.tokensObj####",this.tokensObj)},setPositionDetailCurrentTab(t){t!=this.positionDetailCurrentTab&&(this.positionActionAmount={},this.positionDetailCurrentTab=t)},setPositionActionAmount(t){this.positionActionAmount=t},async getMyPositonsByPool(t,e,n){console.log("0507###getMyPositons###start###",e),this.myPositionsLoading=!0;let i={};const s=Nn(n);if(!e.current_sqrt_price){const d=await s.getPool(e.address)||{};i={...e,...d}}let o=[],r=[];n=="Sui"&&(r=(await gc("Sui").getOwnedFramsPositionNFTList([],!0)).filter(g=>{if(g.clmm_pool_id==i.address)return g}),o=r.map(g=>{const b=[];let w=new ie(0);return g.rewards.forEach(T=>{var H;const E=T.rewarder_type=="0x0000000000000000000000000000000000000000000000000000000000000002::sui::SUI"?"0x2::sui::SUI":T.rewarder_type,P=this.tokensObj[E],k=((H=this.RATES[E])==null?void 0:H.price)||0,S=new ie(T.rewarder_amount).div(new ie(Math.pow(10,P.decimals))),$=S.mul(new ie(k));w=w.add($),S.toNumber()>0&&b.push({...T,amount:S,rewarderAmountUsd:$.toString(),address:E,symbol:P.symbol})}),{...g,rewards:b,farmingRewardTotalUsd:w.toNumber()}}),console.log("farmingPositionList:",o)),console.log(o,"###farmingPositionList");const a=await s.getPositionList(t,{[e.address]:i})||[];console.log("0507###getMyPositons###positionList###",a),console.log("###poolInfo",i),a.length<1&&this.setMyPositionsLoading(!1);const c=o.concat(a);console.log("allPositionList:",c);const u=[];c.forEach(d=>{let p,g,b,w="",T,E,P,k;if(d.liquidity&&d.liquidity!=="0"&&i){const S={creator:d.creator,collection:d.collection,name:d.name};n==="Aptos"?k=s.getNftHash(S):k=s.getNftHash(d);const $=i.token_a.decimals,H=i.token_b.decimals;console.log(i,"poolInf=====>"),b=s.TickMath.sqrtPriceX64ToPrice(i.current_sqrt_price,$,H).toString(),d.tick_lower_index==s.TickUtil.getMinIndex(Number(i.tickSpacing))?p="0":p=s.TickMath.tickIndexToPrice(Number(d.tick_lower_index),$,H).toString(),d.tick_upper_index==s.TickUtil.getMaxIndex(Number(i.tickSpacing))?g="∞":(g=s.TickMath.tickIndexToPrice(Number(d.tick_upper_index),$,H).toString(),console.log("0523###maxPrice###2222###",g));const V=s.getCoinAmountFromLiquidity({pool:i,position:d,roundUp:n!="Sui"}),z=V.coinaAmount,X=V.coinbAmount;console.log(b,"===>currentPrice");const L=Number(X)+Number(z)*Number(b);let B=(Number(z)*Number(b)/L*100).toFixed(0),O=(X/L*100).toFixed(0);p=="0"&&g=="∞"&&(B="50",O="50"),i.isPause?w="Closed":Number(b)>=Number(p)&&(g==="∞"||Number(b)<=Number(g))?w="Active":(Number(b)>Number(g)||Number(b)<Number(p))&&(w="Inactive"),console.log("0323###this.tokensObj####",this.tokensObj),console.log("0323###this.tokensObj[poolInfo.token_a.address]####",this.tokensObj[i.token_a.address]),console.log("0323###poolInfo.token_a.address####",i.token_a.address),console.log("0323###poolInfo.token_b.address####",i.token_b.address);let v={},h={};n==="Aptos"?(v={...i.token_a,...this.tokensObj[i.token_a.address],logoURI:this.tokensObj[i.token_a.address].logo_url},h={...i.token_b,...this.tokensObj[i.token_b.address],logoURI:this.tokensObj[i.token_b.address].logo_url}):(v=i==null?void 0:i.token_a,h=i==null?void 0:i.token_b),u.push({...i,...d,totalAmount:L,token_a:v,token_b:h,tokenARates:T,tokenBRates:E,amountA:z,amountB:X,fromPercent:B,toPercent:O,amountUSD:P,tokenName:d.tokenName||d.name,currentStatus:w,positionLiquidity:d.liquidity,nftHash:k,currentPrice:b,minPrice:$i(p,12),maxPrice:$i(g,12),positionSource:d.id?"farming":"clmm",farmingRewardTotalUsd:d.id?d.farmingRewardTotalUsd:0})}});const l=u.sort((d,p)=>p.liquidity-d.liquidity);console.log(l,"==>myPositionsByPool"),this.poolPositions=l,this.setMyPositionsLoading(!1),this.getPendingFees(l,n),this.getRewarderV2(l,n),console.log(l,"===>this.myPositions")},setAutoPoolNum(t){this.autoPoolNum=t},setTokenExternalPrice(t,e){this.tokenExternalPriceObj[t]=e},clearCurrentPositionInfo(){this.currentPositionInfo={}}}});export{v5 as $,J5 as A,H5 as B,It as C,nR as D,iR as E,K5 as F,rR as G,Ns as H,k4 as I,Yr as J,Zr as K,tR as L,X5 as M,pt as N,ni as O,cI as P,ae as Q,U as R,z5 as S,Se as T,Fr as U,Hi as V,on as W,js as X,aR as Y,W5 as Z,cR as _,xP as a,be as a0,pp as a1,Te as a2,rw as a3,ki as a4,Gs as a5,y as b,CP as c,$i as d,Nn as e,G5 as f,Qc as g,eR as h,sR as i,Cs as j,Y5 as k,zo as l,gc as m,Q5 as n,V5 as o,$t as p,Et as q,Z5 as r,SP as s,oR as t,P4 as u,Fo as v,jo as w,MP as x,ze as y,sn as z};
