var I=Object.defineProperty;var _=(n,t,e)=>t in n?I(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var C=(n,t,e)=>(_(n,typeof t!="symbol"?t+"":t,e),e);import{r as l,j as m,y as U,ay as F,am as T,az as k,aA as y,h as f,av as u,at as p,g as R,S as j,aB as E,aC as v,d as D,z as S,aD as N,aE as G,s as x}from"./index-7d27320c.js";const X=n=>{const{link:t,width:e="40px",height:s=" 40px",style:a,norIcon:r=F}=n,[i,d]=l.useState(!1);return m.jsxs("div",{style:{width:e,height:s,position:"relative",display:"flex",justifyContent:"center",alignItems:"center",...a},children:[m.jsx(U,{style:{width:e,height:s,backgroundColor:i?"#6E41FF":"transparent",borderRadius:"50%",opacity:i?"0.1":"1"}}),m.jsx("img",{width:"24px",height:"24px",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},src:r,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),onClick:()=>{t&&window.open(t)}})]})},O="data:image/png;base64,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";function L(n){try{const{fields:t,type:e}=n.data.content,s={id:t.id.id,bridge_id:t.bridge_id,owner:t.owner,p:t.inscription.fields.p,tick:t.inscription.fields.tick,amount:t.amount,status:T.TICKET_STATUS_CREATED,cross_i2c_id:t.cross_i2c_id,created_ts:Number(t.created_ts),accepted_ts:Number(t.accepted_ts),rejected_ts:Number(t.rejected_ts),coin:k(e).type_arguments[0],show_ts:0};switch(Number(t.status)){case 0:s.status=T.TICKET_STATUS_CREATED,s.show_ts=s.created_ts;break;case 1:s.status=T.TICKET_STATUS_ACCEPTED,s.show_ts=s.accepted_ts;break;case 2:s.status=T.TICKET_STATUS_REJECTED,s.show_ts=s.rejected_ts;break;default:break}return s}catch(t){console.log("buildTicket error",t)}}class P{constructor(){C(this,"_protocolFeeAmountCache",new y)}async getProtocolFeeAmount(){const{global_config_id:t}=f.bridge.config,e=this._protocolFeeAmountCache.get(t);if(e===void 0)try{const s=await u.getObject({id:t,options:{showContent:!0}});return Number(s.data.content.fields.protocol_fee_amount)}catch(s){console.log("getProtocolFeeAmount: error ",s)}return e||0}async getBridgeList(t="all"){const{bridge:e}=f,s={data:[],hasNextPage:!1},a=await u.getDynamicFieldsByPage(e.config.bridge_list_handle,t),r=a.data.map(i=>i.objectId);return r.length>0&&(await u.batchGetObjects(r,{showContent:!0})).forEach(d=>{const o=d.data.content.fields.value.fields.value.fields,c={id:o.bridge_id,p:o.p,tick:o.tick,coin:k(o.coin.fields.name).full_address,status:Number(o.status),statusFormat:p.BRIDGE_STATUS_ONLY_ALLOW_I2C};c.status===1?c.statusFormat=p.BRIDGE_STATUS_ONLY_ALLOW_I2C:c.status===2?c.statusFormat=p.BRIDGE_STATUS_ONLY_ALLOW_C2I:c.status===3?c.statusFormat=p.BRIDGE_STATUS_BOTH_ALLOW:c.status===0&&(c.statusFormat=p.BRIDGE_STATUS_NOT_ALLOW_EITHER),s.data.push(c)}),s.hasNextPage=a.hasNextPage,s.nextCursor=a.nextCursor,s}async getOwnerTicketList(t){var s;const e=[];try{const{bridge:a,simulationAccount:r}=f,i=new R;i.moveCall({target:`${a.published_at}::bridge::fetch_owner_tickets`,typeArguments:[],arguments:[i.object(a.config.owner_indexer_id),i.pure(t.owner),i.pure(t.cursor),i.pure(t.limit?t.limit:1e3)]});const d=await u.devInspectTransactionBlock({transactionBlock:i,sender:r.address}),o=[];if(console.log("getOwnerTicketList simulateRes: ",d),(s=d.events)==null||s.forEach(c=>{k(c.type).name==="FetchOwnerTicketIDsEvent"&&c.parsedJson.tickets.forEach(A=>{o.push(A)})}),o.length>0){const c=await u.batchGetObjects(o,{showContent:!0});for(const h of c){const A=L(h);A&&e.push(A)}}console.log("getOwnerTicketList orderList: ",e)}catch(a){console.log("getOwnerTicketList error: ",a)}return e}async getTicket(t){try{const e=await u.getObject({id:t,options:{showContent:!0}});return L(e)}catch(e){console.log("getTicket error: ",e)}}getTicketIdByTicketCreatedEvent(t){const e=t.find(s=>s.type.includes("TicketCreatedEvent"));if(e){const s=e.parsedJson;return s==null?void 0:s.ticket_id}}crossInscriptionToCoin(t,e,s,a){const{bridge:r}=f,i=[a.object(r.config.global_config_id),a.object(t.id),a.object(r.config.owner_indexer_id),a.pure(t.p),a.pure(t.tick),a.pure(e),s,a.object(j)];return a.moveCall({typeArguments:[t.coin],target:`${r.published_at}::bridge::cross_inscription_to_coin`,arguments:i}),a}async queryBridgeConfig(){const{bridge:t}=f,e={global_config_id:"",owner_indexer_id:"",bridge_list_handle:""},s=(await u.queryEventsByPage({MoveEventType:`${t.package_id}::config::InitConfigEvent`})).data;if(s.length>0){const r=s[0].parsedJson;e.global_config_id=r.global_config_id}const a=(await u.queryEventsByPage({MoveEventType:`${t.package_id}::bridge::InitEvent`})).data;if(a.length>0){const r=a[0].parsedJson;e.owner_indexer_id=r.owner_indexer_id;const i=await u.getObject({id:r.bridges_id,options:{showContent:!0}});e.bridge_list_handle=i.data.content.fields.list.fields.id.id}return e}}const w=new P,K=(n,t)=>({allBridgeList:[],saveBridgeList:e=>{n(()=>({allBridgeList:[...e]}))},gerBridgeListByStatus:e=>e.length===0?t().allBridgeList:t().allBridgeList.filter(s=>!!e.includes(s.statusFormat))}),Q=E(v(K,{name:"useBridgeStore"}));function W(n=!0,t=[]){const[e,s]=l.useState(!1),{allBridgeList:a,saveBridgeList:r,gerBridgeListByStatus:i}=Q(),[d,o]=l.useState([]),[c,h]=l.useState(0);async function A(){if(!e){s(!0);try{const g=await w.getBridgeList();console.log("fetchBridgeList res: ",g.data),r(M(g.data))}catch(g){console.log("fetchBridgeList error",g)}finally{s(!1)}}}l.useEffect(()=>{A(),n&&w.getProtocolFeeAmount().then(g=>{h(g)})},[]),l.useEffect(()=>{o(i(t))},[a]);const M=g=>g.sort((B,b)=>B.tick[0].toLowerCase()===b.tick[0].toLowerCase()?B.tick[0].toLowerCase().localeCompare(b.tick[0].toLowerCase()):B.tick.toLowerCase().localeCompare(b.tick.toLowerCase()));return{refreshLoading:e,feeAmount:c,bridgeList:d}}function Y(n){const{address:t}=D(),[e,s]=l.useState(!1),[a,r]=l.useState([]),i=async()=>{if(!t||e){s(!1);return}s(!0);try{const o=await u.getOwnerCoinBalances(t,n);console.log("fetchUserCoinBalance res",o),r([...o]),s(!1)}catch(o){s(!1),console.log("fetchUserCoinBalance error",o)}},d=l.useMemo(()=>{if(t&&n){const o=a.find(c=>S(n)===S(c.coinType));if(o)return o.totalBalance}return"0"},[t,a,n]);return l.useEffect(()=>{(!t||!n)&&r([])},[t,n]),{loading:e,fetchUserCoinBalance:i,coinBalanceList:a,coinBalanceValue:d}}const Z={coinType:G,decimals:9,name:"SUI",symbol:"SUI",description:"",iconUrl:x,id:""},z=(n,t)=>({metaDataMaps:{},saveTokenMataData:(e,s)=>{const a=t().metaDataMaps;a[e]=s,n(()=>({metaDataMaps:{...a}}))},getTokenMataData:e=>{if(N(e))return Z;const s=t().metaDataMaps,a=k(e).full_address;return s[a]}}),J=E(v(z,{name:"useMetadataStore"}));function q(n){const[t,e]=l.useState(!1),[s,a]=l.useState(void 0),{getTokenMataData:r,saveTokenMataData:i}=J(),d=async()=>{if(!(t||!n)){e(!0);try{const o=await u.getCoinMetadata({coinType:n});if(o){const c={decimals:o.decimals,name:o.name,symbol:o.symbol,description:o.description,iconUrl:o.iconUrl||O,id:o.id||"",coinType:n};i(n,c),a(c)}e(!1)}catch{e(!1)}}};return l.useEffect(()=>{if(n){const o=r(n);console.log("metaData: ",o),o?a(o):d()}},[n]),{loading:t,metaData:s}}export{X as L,Y as a,q as b,w as c,O as i,W as u};
